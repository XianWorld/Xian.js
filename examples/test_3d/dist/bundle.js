(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
        var Xian = require("../../src/xian/xian");

        Xian.globalize();

        var random = Math.random,
            randFloat = Mathf.randFloat,
            PI = Math.PI,
            sin = Math.sin,
            cos = Math.cos;

        Assets.addAssets(
            new ShaderLib.Unlit,
            new ShaderLib.VertexLit,
            new ShaderLib.Diffuse,
            new ShaderLib.Specular,
            new ShaderLib.NormalDiffuse,
            new ShaderLib.NormalSpecular,
            new ShaderLib.ParallaxDiffuse,

            new ShaderLib.ParticleUnlit,

            new ShaderLib.ReflectiveVertexLit,
            new Texture({
                name: "tex_marine_dif",
                src: "../content/images/marine_dif_spec.png"
            }),
            new Texture({
                name: "tex_marine_nor",
                src: "../content/images/marine_nor.jpg"
            }),
            new Texture({
                name: "tex_marine_spec",
                src: "../content/images/marine_spec.jpg"
            }),
            new TextureCube({
                name: "cm_sky",
                src: [
                    "../content/images/skybox_left.jpg",
                    "../content/images/skybox_right.jpg",
                    "../content/images/skybox_front.jpg",
                    "../content/images/skybox_back.jpg",
                    "../content/images/skybox_up.jpg",
                    "../content/images/skybox_down.jpg",
                ]
            })
        );
        Assets.addAssets(
            new Mesh({
                name: "mesh_odin",
                src: "../content/geometry/marine.json"
            }),
            Mesh.Cube({
                name: "mesh_cube"
            }),
            Mesh.Plane({
                name: "mesh_plane"
            }),
            Mesh.Sphere({
                name: "mesh_sphere",
            }),
            new Material({
                name: "mat_default",

                wireframe: false,
                wireframeLineWidth: 1,

                uniforms: {
                    diffuseMap: Assets.get("tex_marine_dif"),
                    normalMap: Assets.get("tex_marine_nor"),
                    specularMap: Assets.get("tex_marine_spec"),
                    normalScale: 1,
                    shininess: 30
                },

                shader: Assets.get("shader_normal_specular")
            }),
            new Material({
                name: "mat_sprite",

                uniforms: {
                    diffuseMap: Assets.get("tex_marine_nor")
                },

                shader: Assets.get("shader_unlit")
            })
        );

        game = new Game({
            debug: true
        });

        var scene = new Scene({
            name: "PlayGround",
            world: {
                ambient: new Color()
            }
        });

        var camera = new GameObject({
            components: [
                new Transform({
                    position: new Vec3(10, 10, 10)
                }),
                new Camera({
                    background: new Color()
                }),
                new OrbitControl
            ],
            tag: "Camera"
        });
        sphere = new GameObject({
            components: [
                new Transform({
                    position: new Vec3(1, 0, 0)
                }),
                new MeshFilter({
                    mesh: Assets.get("mesh_sphere"),
                    material: Assets.get("mat_default")
                })
            ],
            tag: "Mesh"
        });
        odin = new GameObject({
            components: [
                new Transform({
                    position: new Vec3(-1, 0, 0)
                }),
                new MeshFilter({
                    mesh: Assets.get("mesh_odin"),
                    material: Assets.get("mat_default")
                })
            ],
            tag: "Mesh"
        });
        cube = new GameObject({
            components: [
                new Transform({
                    position: new Vec3(-1, 0, 0)
                }),
                new MeshFilter({
                    mesh: Assets.get("mesh_cube"),
                    material: Assets.get("mat_default")
                })
            ],
            tag: "Mesh"
        });
        plane = new GameObject({
            components: [
                new Transform({
                    position: new Vec3(0, 0, 0)
                }),
                new MeshFilter({
                    mesh: Assets.get("mesh_plane"),
                    material: Assets.get("mat_default")
                })
            ],
            tag: "Mesh"
        });
        sprite = new GameObject({
            components: [
                new Transform({
                    position: new Vec3(0, 0, 1)
                }),
                new Sprite({
                    material: Assets.get("mat_default"),
                    x: 0,
                    y: 0,
                    w: 1024,
                    h: 1024
                })
            ],
            tag: "Mesh"
        });
        pointLight = new GameObject({
            components: [
                new Transform({
                    position: new Vec3(0, 0, 25)
                }),
                new MeshFilter({
                    mesh: Assets.get("mesh_sphere"),
                    material: Assets.get("mat_default")
                }),
                new Light({
                    type: Enums.LightType.Point,
                    color: new Color(1, 1, 1),
                    distance: 16,
                    energy: 5
                })
            ],
            tags: [
                "Light",
                "PointLight"
            ]
        });
        directionalLight = new GameObject({
            components: [
                new Transform({
                    position: new Vec3(10, 5, 25)
                }),
                new MeshFilter({
                    mesh: Assets.get("mesh_sphere"),
                    material: Assets.get("mat_default")
                }),
                new Light({
                    type: Enums.LightType.Directional,
                    color: new Color(1, 1, 1),
                    energy: 1
                })
            ],
            tags: [
                "Light",
                "DirectionalLight"
            ]
        });
        spotLight = new GameObject({
            components: [
                new Transform({
                    position: new Vec3(-25, -25, -25)
                }),
                new MeshFilter({
                    mesh: Assets.get("mesh_sphere"),
                    material: Assets.get("mat_default")
                }),
                new Light({
                    type: Enums.LightType.Spot,
                    color: new Color(0, 0, 1),
                    energy: 1,
                    angle: Math.PI,
                    distance: 0
                })
            ],
            tags: [
                "Light",
                "SpotLight"
            ]
        });
        hemiLight = new GameObject({
            components: [
                new Transform({
                    position: new Vec3(0, 0, 25)
                }),
                new MeshFilter({
                    mesh: Assets.get("mesh_sphere"),
                    material: Assets.get("mat_default")
                }),
                new Light({
                    type: Enums.LightType.Hemi,
                    color: new Color(1, 1, 1),
                    energy: 1
                })
            ],
            tags: [
                "Light",
                "HemiLight"
            ]
        });

        scene.addGameObjects(camera, sprite, pointLight, spotLight, directionalLight);
        game.addScene(scene);

        function addObject(s) {
            var num = random(),
                instance;

            if (num < 0.25) {
                instance = cube.clone();
            } else if (num > 0.25 && num < 0.5) {
                instance = sphere.clone();
            } else if (num > 0.5 && num < 0.75) {
                instance = odin.clone();
            } else {
                instance = plane.clone();
            }

            instance.transform.position.set(randFloat(-1, 1), randFloat(-1, 1), randFloat(-1, 1)).normalize().smul(randFloat(0, 25));
            instance.transform.rotation.rotate(randFloat(-PI, PI), randFloat(-PI, PI), randFloat(-PI, PI));

            s.addGameObject(instance);
        }

        function start() {
            game.setScene("PlayGround");
            game.setCamera(game.scene.findByTagFirst("Camera"));

            var currentScene = game.scene,
                pLight = currentScene.findByTagFirst("PointLight"),
                sLight = currentScene.findByTagFirst("SpotLight"),
                i;
            for (i = 100; i--;) addObject(currentScene);

            game.on("update", function() {
                var time = Time.time,
                    cosTime = cos(time),
                    sinTime = sin(time);

                pLight.transform.position.set(
                    cosTime * 15,
                    sinTime * 15,
                    0
                );
                sLight.transform.position.set(
                    cosTime * 15,
                    sinTime * 15,
                    sinTime * 15
                );
            });
        }

        function restart() {
            start();
        }

        AssetLoader.on("load", function() {
            Assets.get("mesh_odin").calculateTangents();
            Assets.get("mesh_sphere").calculateTangents();
            Assets.get("mesh_plane").calculateTangents();
            Assets.get("mesh_cube").calculateTangents();

            game.on("init", start).init();
        }).load();

},{"../../src/xian/xian":132}],2:[function(require,module,exports){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('is-array')

exports.Buffer = Buffer
exports.SlowBuffer = Buffer
exports.INSPECT_MAX_BYTES = 50
Buffer.poolSize = 8192 // not used by this implementation

var kMaxLength = 0x3fffffff

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Note:
 *
 * - Implementation must support adding new properties to `Uint8Array` instances.
 *   Firefox 4-29 lacked support, fixed in Firefox 30+.
 *   See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *  - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *  - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *    incorrect length in some situations.
 *
 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they will
 * get the Object implementation, which is slower but will work correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = (function () {
  try {
    var buf = new ArrayBuffer(0)
    var arr = new Uint8Array(buf)
    arr.foo = function () { return 42 }
    return 42 === arr.foo() && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        new Uint8Array(1).subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
})()

/**
 * Class: Buffer
 * =============
 *
 * The Buffer constructor returns instances of `Uint8Array` that are augmented
 * with function properties for all the node `Buffer` API functions. We use
 * `Uint8Array` so that square bracket notation works as expected -- it returns
 * a single octet.
 *
 * By augmenting the instances, we can avoid modifying the `Uint8Array`
 * prototype.
 */
function Buffer (subject, encoding, noZero) {
  if (!(this instanceof Buffer))
    return new Buffer(subject, encoding, noZero)

  var type = typeof subject

  // Find the length
  var length
  if (type === 'number')
    length = subject > 0 ? subject >>> 0 : 0
  else if (type === 'string') {
    if (encoding === 'base64')
      subject = base64clean(subject)
    length = Buffer.byteLength(subject, encoding)
  } else if (type === 'object' && subject !== null) { // assume object is array-like
    if (subject.type === 'Buffer' && isArray(subject.data))
      subject = subject.data
    length = +subject.length > 0 ? Math.floor(+subject.length) : 0
  } else
    throw new TypeError('must start with number, buffer, array or string')

  if (this.length > kMaxLength)
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
      'size: 0x' + kMaxLength.toString(16) + ' bytes')

  var buf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Preferred: Return an augmented `Uint8Array` instance for best performance
    buf = Buffer._augment(new Uint8Array(length))
  } else {
    // Fallback: Return THIS instance of Buffer (created by `new`)
    buf = this
    buf.length = length
    buf._isBuffer = true
  }

  var i
  if (Buffer.TYPED_ARRAY_SUPPORT && typeof subject.byteLength === 'number') {
    // Speed optimization -- use set if we're copying from a typed array
    buf._set(subject)
  } else if (isArrayish(subject)) {
    // Treat array-ish objects as a byte array
    if (Buffer.isBuffer(subject)) {
      for (i = 0; i < length; i++)
        buf[i] = subject.readUInt8(i)
    } else {
      for (i = 0; i < length; i++)
        buf[i] = ((subject[i] % 256) + 256) % 256
    }
  } else if (type === 'string') {
    buf.write(subject, 0, encoding)
  } else if (type === 'number' && !Buffer.TYPED_ARRAY_SUPPORT && !noZero) {
    for (i = 0; i < length; i++) {
      buf[i] = 0
    }
  }

  return buf
}

Buffer.isBuffer = function (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b))
    throw new TypeError('Arguments must be Buffers')

  var x = a.length
  var y = b.length
  for (var i = 0, len = Math.min(x, y); i < len && a[i] === b[i]; i++) {}
  if (i !== len) {
    x = a[i]
    y = b[i]
  }
  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'binary':
    case 'base64':
    case 'raw':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function (list, totalLength) {
  if (!isArray(list)) throw new TypeError('Usage: Buffer.concat(list[, length])')

  if (list.length === 0) {
    return new Buffer(0)
  } else if (list.length === 1) {
    return list[0]
  }

  var i
  if (totalLength === undefined) {
    totalLength = 0
    for (i = 0; i < list.length; i++) {
      totalLength += list[i].length
    }
  }

  var buf = new Buffer(totalLength)
  var pos = 0
  for (i = 0; i < list.length; i++) {
    var item = list[i]
    item.copy(buf, pos)
    pos += item.length
  }
  return buf
}

Buffer.byteLength = function (str, encoding) {
  var ret
  str = str + ''
  switch (encoding || 'utf8') {
    case 'ascii':
    case 'binary':
    case 'raw':
      ret = str.length
      break
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      ret = str.length * 2
      break
    case 'hex':
      ret = str.length >>> 1
      break
    case 'utf8':
    case 'utf-8':
      ret = utf8ToBytes(str).length
      break
    case 'base64':
      ret = base64ToBytes(str).length
      break
    default:
      ret = str.length
  }
  return ret
}

// pre-set for values that may exist in the future
Buffer.prototype.length = undefined
Buffer.prototype.parent = undefined

// toString(encoding, start=0, end=buffer.length)
Buffer.prototype.toString = function (encoding, start, end) {
  var loweredCase = false

  start = start >>> 0
  end = end === undefined || end === Infinity ? this.length : end >>> 0

  if (!encoding) encoding = 'utf8'
  if (start < 0) start = 0
  if (end > this.length) end = this.length
  if (end <= start) return ''

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'binary':
        return binarySlice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase)
          throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.equals = function (b) {
  if(!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max)
      str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  return Buffer.compare(this, b)
}

// `get` will be removed in Node 0.13+
Buffer.prototype.get = function (offset) {
  console.log('.get() is deprecated. Access using array indexes instead.')
  return this.readUInt8(offset)
}

// `set` will be removed in Node 0.13+
Buffer.prototype.set = function (v, offset) {
  console.log('.set() is deprecated. Access using array indexes instead.')
  return this.writeUInt8(v, offset)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new Error('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; i++) {
    var byte = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(byte)) throw new Error('Invalid hex string')
    buf[offset + i] = byte
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  var charsWritten = blitBuffer(utf8ToBytes(string), buf, offset, length)
  return charsWritten
}

function asciiWrite (buf, string, offset, length) {
  var charsWritten = blitBuffer(asciiToBytes(string), buf, offset, length)
  return charsWritten
}

function binaryWrite (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  var charsWritten = blitBuffer(base64ToBytes(string), buf, offset, length)
  return charsWritten
}

function utf16leWrite (buf, string, offset, length) {
  var charsWritten = blitBuffer(utf16leToBytes(string), buf, offset, length)
  return charsWritten
}

Buffer.prototype.write = function (string, offset, length, encoding) {
  // Support both (string, offset, length, encoding)
  // and the legacy (string, encoding, offset, length)
  if (isFinite(offset)) {
    if (!isFinite(length)) {
      encoding = length
      length = undefined
    }
  } else {  // legacy
    var swap = encoding
    encoding = offset
    offset = length
    length = swap
  }

  offset = Number(offset) || 0
  var remaining = this.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }
  encoding = String(encoding || 'utf8').toLowerCase()

  var ret
  switch (encoding) {
    case 'hex':
      ret = hexWrite(this, string, offset, length)
      break
    case 'utf8':
    case 'utf-8':
      ret = utf8Write(this, string, offset, length)
      break
    case 'ascii':
      ret = asciiWrite(this, string, offset, length)
      break
    case 'binary':
      ret = binaryWrite(this, string, offset, length)
      break
    case 'base64':
      ret = base64Write(this, string, offset, length)
      break
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      ret = utf16leWrite(this, string, offset, length)
      break
    default:
      throw new TypeError('Unknown encoding: ' + encoding)
  }
  return ret
}

Buffer.prototype.toJSON = function () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  var res = ''
  var tmp = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; i++) {
    if (buf[i] <= 0x7F) {
      res += decodeUtf8Char(tmp) + String.fromCharCode(buf[i])
      tmp = ''
    } else {
      tmp += '%' + buf[i].toString(16)
    }
  }

  return res + decodeUtf8Char(tmp)
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; i++) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function binarySlice (buf, start, end) {
  return asciiSlice(buf, start, end)
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; i++) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len;
    if (start < 0)
      start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0)
      end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start)
    end = start

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    return Buffer._augment(this.subarray(start, end))
  } else {
    var sliceLen = end - start
    var newBuf = new Buffer(sliceLen, undefined, true)
    for (var i = 0; i < sliceLen; i++) {
      newBuf[i] = this[i + start]
    }
    return newBuf
  }
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0)
    throw new RangeError('offset is not uint')
  if (offset + ext > length)
    throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUInt8 = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
      ((this[offset + 1] << 16) |
      (this[offset + 2] << 8) |
      this[offset + 3])
}

Buffer.prototype.readInt8 = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80))
    return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 4, this.length)

  return (this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16) |
      (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
      (this[offset + 1] << 16) |
      (this[offset + 2] << 8) |
      (this[offset + 3])
}

Buffer.prototype.readFloatLE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function (offset, noAssert) {
  if (!noAssert)
    checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('buffer must be a Buffer instance')
  if (value > max || value < min) throw new TypeError('value is out of bounds')
  if (offset + ext > buf.length) throw new TypeError('index out of range')
}

Buffer.prototype.writeUInt8 = function (value, offset, noAssert) {
  value = +value
  offset = offset >>> 0
  if (!noAssert)
    checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = value
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; i++) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function (value, offset, noAssert) {
  value = +value
  offset = offset >>> 0
  if (!noAssert)
    checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = value
    this[offset + 1] = (value >>> 8)
  } else objectWriteUInt16(this, value, offset, true)
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function (value, offset, noAssert) {
  value = +value
  offset = offset >>> 0
  if (!noAssert)
    checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = value
  } else objectWriteUInt16(this, value, offset, false)
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; i++) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function (value, offset, noAssert) {
  value = +value
  offset = offset >>> 0
  if (!noAssert)
    checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = value
  } else objectWriteUInt32(this, value, offset, true)
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function (value, offset, noAssert) {
  value = +value
  offset = offset >>> 0
  if (!noAssert)
    checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = value
  } else objectWriteUInt32(this, value, offset, false)
  return offset + 4
}

Buffer.prototype.writeInt8 = function (value, offset, noAssert) {
  value = +value
  offset = offset >>> 0
  if (!noAssert)
    checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = value
  return offset + 1
}

Buffer.prototype.writeInt16LE = function (value, offset, noAssert) {
  value = +value
  offset = offset >>> 0
  if (!noAssert)
    checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = value
    this[offset + 1] = (value >>> 8)
  } else objectWriteUInt16(this, value, offset, true)
  return offset + 2
}

Buffer.prototype.writeInt16BE = function (value, offset, noAssert) {
  value = +value
  offset = offset >>> 0
  if (!noAssert)
    checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = value
  } else objectWriteUInt16(this, value, offset, false)
  return offset + 2
}

Buffer.prototype.writeInt32LE = function (value, offset, noAssert) {
  value = +value
  offset = offset >>> 0
  if (!noAssert)
    checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = value
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else objectWriteUInt32(this, value, offset, true)
  return offset + 4
}

Buffer.prototype.writeInt32BE = function (value, offset, noAssert) {
  value = +value
  offset = offset >>> 0
  if (!noAssert)
    checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = value
  } else objectWriteUInt32(this, value, offset, false)
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (value > max || value < min) throw new TypeError('value is out of bounds')
  if (offset + ext > buf.length) throw new TypeError('index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert)
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert)
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function (target, target_start, start, end) {
  var source = this

  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (!target_start) target_start = 0

  // Copy 0 bytes; we're done
  if (end === start) return
  if (target.length === 0 || source.length === 0) return

  // Fatal error conditions
  if (end < start) throw new TypeError('sourceEnd < sourceStart')
  if (target_start < 0 || target_start >= target.length)
    throw new TypeError('targetStart out of bounds')
  if (start < 0 || start >= source.length) throw new TypeError('sourceStart out of bounds')
  if (end < 0 || end > source.length) throw new TypeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length)
    end = this.length
  if (target.length - target_start < end - start)
    end = target.length - target_start + start

  var len = end - start

  if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < len; i++) {
      target[i + target_start] = this[i + start]
    }
  } else {
    target._set(this.subarray(start, start + len), target_start)
  }
}

// fill(value, start=0, end=buffer.length)
Buffer.prototype.fill = function (value, start, end) {
  if (!value) value = 0
  if (!start) start = 0
  if (!end) end = this.length

  if (end < start) throw new TypeError('end < start')

  // Fill 0 bytes; we're done
  if (end === start) return
  if (this.length === 0) return

  if (start < 0 || start >= this.length) throw new TypeError('start out of bounds')
  if (end < 0 || end > this.length) throw new TypeError('end out of bounds')

  var i
  if (typeof value === 'number') {
    for (i = start; i < end; i++) {
      this[i] = value
    }
  } else {
    var bytes = utf8ToBytes(value.toString())
    var len = bytes.length
    for (i = start; i < end; i++) {
      this[i] = bytes[i % len]
    }
  }

  return this
}

/**
 * Creates a new `ArrayBuffer` with the *copied* memory of the buffer instance.
 * Added in Node 0.12. Only available in browsers that support ArrayBuffer.
 */
Buffer.prototype.toArrayBuffer = function () {
  if (typeof Uint8Array !== 'undefined') {
    if (Buffer.TYPED_ARRAY_SUPPORT) {
      return (new Buffer(this)).buffer
    } else {
      var buf = new Uint8Array(this.length)
      for (var i = 0, len = buf.length; i < len; i += 1) {
        buf[i] = this[i]
      }
      return buf.buffer
    }
  } else {
    throw new TypeError('Buffer.toArrayBuffer not supported in this browser')
  }
}

// HELPER FUNCTIONS
// ================

var BP = Buffer.prototype

/**
 * Augment a Uint8Array *instance* (not the Uint8Array class!) with Buffer methods
 */
Buffer._augment = function (arr) {
  arr.constructor = Buffer
  arr._isBuffer = true

  // save reference to original Uint8Array get/set methods before overwriting
  arr._get = arr.get
  arr._set = arr.set

  // deprecated, will be removed in node 0.13+
  arr.get = BP.get
  arr.set = BP.set

  arr.write = BP.write
  arr.toString = BP.toString
  arr.toLocaleString = BP.toString
  arr.toJSON = BP.toJSON
  arr.equals = BP.equals
  arr.compare = BP.compare
  arr.copy = BP.copy
  arr.slice = BP.slice
  arr.readUInt8 = BP.readUInt8
  arr.readUInt16LE = BP.readUInt16LE
  arr.readUInt16BE = BP.readUInt16BE
  arr.readUInt32LE = BP.readUInt32LE
  arr.readUInt32BE = BP.readUInt32BE
  arr.readInt8 = BP.readInt8
  arr.readInt16LE = BP.readInt16LE
  arr.readInt16BE = BP.readInt16BE
  arr.readInt32LE = BP.readInt32LE
  arr.readInt32BE = BP.readInt32BE
  arr.readFloatLE = BP.readFloatLE
  arr.readFloatBE = BP.readFloatBE
  arr.readDoubleLE = BP.readDoubleLE
  arr.readDoubleBE = BP.readDoubleBE
  arr.writeUInt8 = BP.writeUInt8
  arr.writeUInt16LE = BP.writeUInt16LE
  arr.writeUInt16BE = BP.writeUInt16BE
  arr.writeUInt32LE = BP.writeUInt32LE
  arr.writeUInt32BE = BP.writeUInt32BE
  arr.writeInt8 = BP.writeInt8
  arr.writeInt16LE = BP.writeInt16LE
  arr.writeInt16BE = BP.writeInt16BE
  arr.writeInt32LE = BP.writeInt32LE
  arr.writeInt32BE = BP.writeInt32BE
  arr.writeFloatLE = BP.writeFloatLE
  arr.writeFloatBE = BP.writeFloatBE
  arr.writeDoubleLE = BP.writeDoubleLE
  arr.writeDoubleBE = BP.writeDoubleBE
  arr.fill = BP.fill
  arr.inspect = BP.inspect
  arr.toArrayBuffer = BP.toArrayBuffer

  return arr
}

var INVALID_BASE64_RE = /[^+\/0-9A-z]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function isArrayish (subject) {
  return isArray(subject) || Buffer.isBuffer(subject) ||
      subject && typeof subject === 'object' &&
      typeof subject.length === 'number'
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; i++) {
    var b = str.charCodeAt(i)
    if (b <= 0x7F) {
      byteArray.push(b)
    } else {
      var start = i
      if (b >= 0xD800 && b <= 0xDFFF) i++
      var h = encodeURIComponent(str.slice(start, i+1)).substr(1).split('%')
      for (var j = 0; j < h.length; j++) {
        byteArray.push(parseInt(h[j], 16))
      }
    }
  }
  return byteArray
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; i++) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; i++) {
    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(str)
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; i++) {
    if ((i + offset >= dst.length) || (i >= src.length))
      break
    dst[i + offset] = src[i]
  }
  return i
}

function decodeUtf8Char (str) {
  try {
    return decodeURIComponent(str)
  } catch (err) {
    return String.fromCharCode(0xFFFD) // UTF 8 invalid char
  }
}

},{"base64-js":3,"ieee754":4,"is-array":5}],3:[function(require,module,exports){
var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';

;(function (exports) {
	'use strict';

  var Arr = (typeof Uint8Array !== 'undefined')
    ? Uint8Array
    : Array

	var PLUS   = '+'.charCodeAt(0)
	var SLASH  = '/'.charCodeAt(0)
	var NUMBER = '0'.charCodeAt(0)
	var LOWER  = 'a'.charCodeAt(0)
	var UPPER  = 'A'.charCodeAt(0)

	function decode (elt) {
		var code = elt.charCodeAt(0)
		if (code === PLUS)
			return 62 // '+'
		if (code === SLASH)
			return 63 // '/'
		if (code < NUMBER)
			return -1 //no match
		if (code < NUMBER + 10)
			return code - NUMBER + 26 + 26
		if (code < UPPER + 26)
			return code - UPPER
		if (code < LOWER + 26)
			return code - LOWER + 26
	}

	function b64ToByteArray (b64) {
		var i, j, l, tmp, placeHolders, arr

		if (b64.length % 4 > 0) {
			throw new Error('Invalid string. Length must be a multiple of 4')
		}

		// the number of equal signs (place holders)
		// if there are two placeholders, than the two characters before it
		// represent one byte
		// if there is only one, then the three characters before it represent 2 bytes
		// this is just a cheap hack to not do indexOf twice
		var len = b64.length
		placeHolders = '=' === b64.charAt(len - 2) ? 2 : '=' === b64.charAt(len - 1) ? 1 : 0

		// base64 is 4/3 + up to two characters of the original data
		arr = new Arr(b64.length * 3 / 4 - placeHolders)

		// if there are placeholders, only get up to the last complete 4 chars
		l = placeHolders > 0 ? b64.length - 4 : b64.length

		var L = 0

		function push (v) {
			arr[L++] = v
		}

		for (i = 0, j = 0; i < l; i += 4, j += 3) {
			tmp = (decode(b64.charAt(i)) << 18) | (decode(b64.charAt(i + 1)) << 12) | (decode(b64.charAt(i + 2)) << 6) | decode(b64.charAt(i + 3))
			push((tmp & 0xFF0000) >> 16)
			push((tmp & 0xFF00) >> 8)
			push(tmp & 0xFF)
		}

		if (placeHolders === 2) {
			tmp = (decode(b64.charAt(i)) << 2) | (decode(b64.charAt(i + 1)) >> 4)
			push(tmp & 0xFF)
		} else if (placeHolders === 1) {
			tmp = (decode(b64.charAt(i)) << 10) | (decode(b64.charAt(i + 1)) << 4) | (decode(b64.charAt(i + 2)) >> 2)
			push((tmp >> 8) & 0xFF)
			push(tmp & 0xFF)
		}

		return arr
	}

	function uint8ToBase64 (uint8) {
		var i,
			extraBytes = uint8.length % 3, // if we have 1 byte left, pad 2 bytes
			output = "",
			temp, length

		function encode (num) {
			return lookup.charAt(num)
		}

		function tripletToBase64 (num) {
			return encode(num >> 18 & 0x3F) + encode(num >> 12 & 0x3F) + encode(num >> 6 & 0x3F) + encode(num & 0x3F)
		}

		// go through the array every three bytes, we'll deal with trailing stuff later
		for (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {
			temp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
			output += tripletToBase64(temp)
		}

		// pad the end with zeros, but make sure to not forget the extra bytes
		switch (extraBytes) {
			case 1:
				temp = uint8[uint8.length - 1]
				output += encode(temp >> 2)
				output += encode((temp << 4) & 0x3F)
				output += '=='
				break
			case 2:
				temp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1])
				output += encode(temp >> 10)
				output += encode((temp >> 4) & 0x3F)
				output += encode((temp << 2) & 0x3F)
				output += '='
				break
		}

		return output
	}

	exports.toByteArray = b64ToByteArray
	exports.fromByteArray = uint8ToBase64
}(typeof exports === 'undefined' ? (this.base64js = {}) : exports))

},{}],4:[function(require,module,exports){
exports.read = function(buffer, offset, isLE, mLen, nBytes) {
  var e, m,
      eLen = nBytes * 8 - mLen - 1,
      eMax = (1 << eLen) - 1,
      eBias = eMax >> 1,
      nBits = -7,
      i = isLE ? (nBytes - 1) : 0,
      d = isLE ? -1 : 1,
      s = buffer[offset + i];

  i += d;

  e = s & ((1 << (-nBits)) - 1);
  s >>= (-nBits);
  nBits += eLen;
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8);

  m = e & ((1 << (-nBits)) - 1);
  e >>= (-nBits);
  nBits += mLen;
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8);

  if (e === 0) {
    e = 1 - eBias;
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity);
  } else {
    m = m + Math.pow(2, mLen);
    e = e - eBias;
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen);
};

exports.write = function(buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c,
      eLen = nBytes * 8 - mLen - 1,
      eMax = (1 << eLen) - 1,
      eBias = eMax >> 1,
      rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0),
      i = isLE ? 0 : (nBytes - 1),
      d = isLE ? 1 : -1,
      s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0;

  value = Math.abs(value);

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0;
    e = eMax;
  } else {
    e = Math.floor(Math.log(value) / Math.LN2);
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--;
      c *= 2;
    }
    if (e + eBias >= 1) {
      value += rt / c;
    } else {
      value += rt * Math.pow(2, 1 - eBias);
    }
    if (value * c >= 2) {
      e++;
      c /= 2;
    }

    if (e + eBias >= eMax) {
      m = 0;
      e = eMax;
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen);
      e = e + eBias;
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen);
      e = 0;
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8);

  e = (e << mLen) | m;
  eLen += mLen;
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8);

  buffer[offset + i - d] |= s * 128;
};

},{}],5:[function(require,module,exports){

/**
 * isArray
 */

var isArray = Array.isArray;

/**
 * toString
 */

var str = Object.prototype.toString;

/**
 * Whether or not the given `val`
 * is an array.
 *
 * example:
 *
 *        isArray([]);
 *        // > true
 *        isArray(arguments);
 *        // > false
 *        isArray('');
 *        // > false
 *
 * @param {mixed} val
 * @return {bool}
 */

module.exports = isArray || function (val) {
  return !! val && '[object Array]' == str.call(val);
};

},{}],6:[function(require,module,exports){
// shim for using process in browser

var process = module.exports = {};

process.nextTick = (function () {
    var canSetImmediate = typeof window !== 'undefined'
    && window.setImmediate;
    var canMutationObserver = typeof window !== 'undefined'
    && window.MutationObserver;
    var canPost = typeof window !== 'undefined'
    && window.postMessage && window.addEventListener
    ;

    if (canSetImmediate) {
        return function (f) { return window.setImmediate(f) };
    }

    var queue = [];

    if (canMutationObserver) {
        var hiddenDiv = document.createElement("div");
        var observer = new MutationObserver(function () {
            var queueList = queue.slice();
            queue.length = 0;
            queueList.forEach(function (fn) {
                fn();
            });
        });

        observer.observe(hiddenDiv, { attributes: true });

        return function nextTick(fn) {
            if (!queue.length) {
                hiddenDiv.setAttribute('yes', 'no');
            }
            queue.push(fn);
        };
    }

    if (canPost) {
        window.addEventListener('message', function (ev) {
            var source = ev.source;
            if ((source === window || source === null) && ev.data === 'process-tick') {
                ev.stopPropagation();
                if (queue.length > 0) {
                    var fn = queue.shift();
                    fn();
                }
            }
        }, true);

        return function nextTick(fn) {
            queue.push(fn);
            window.postMessage('process-tick', '*');
        };
    }

    return function nextTick(fn) {
        setTimeout(fn, 0);
    };
})();

process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

// TODO(shtylman)
process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};

},{}],7:[function(require,module,exports){
(function (global){
var Dom = require('./dom');
var Device = require('./device');

'use strict';


var w = typeof(window) !== 'undefined' ? window : global,
    addEvent = Dom.addEvent,
    removeEvent = Dom.removeEvent,
    AudioContext = (
    w.AudioContext ||
    w.webkitAudioContext ||
    w.mozAudioContext ||
    w.oAudioContext ||
    w.msAudioContext
    ),
    audioContext = null;

if (typeof(AudioContext) !== 'undefined') {
    audioContext = new AudioContext();
    var AudioContextPrototype = AudioContext.prototype;

    AudioContextPrototype.UNLOCKED = !Device.mobile;
    AudioContextPrototype.createGain || (AudioContextPrototype.createGain = AudioContextPrototype.createGainNode);
    AudioContextPrototype.createPanner || (AudioContextPrototype.createPanner = AudioContextPrototype.createPannerNode);
    AudioContextPrototype.createDelay || (AudioContextPrototype.createDelay = AudioContextPrototype.createDelayNode);
    AudioContextPrototype.createScriptProcessor || (AudioContextPrototype.createScriptProcessor = AudioContextPrototype.createJavaScriptNode);

    var OscillatorPrototype = audioContext.createOscillator().constructor.prototype,
        BufferSourceNodePrototype = audioContext.createBufferSource().constructor.prototype,
        GainPrototype = audioContext.createGain().gain.constructor.prototype;

    OscillatorPrototype.start || (OscillatorPrototype.start = OscillatorPrototype.noteOn);
    OscillatorPrototype.stop || (OscillatorPrototype.stop = OscillatorPrototype.stop);
    OscillatorPrototype.setPeriodicWave || (OscillatorPrototype.setPeriodicWave = OscillatorPrototype.setWaveTable);

    BufferSourceNodePrototype.start || (BufferSourceNodePrototype.start = BufferSourceNodePrototype.noteOn);
    BufferSourceNodePrototype.stop || (BufferSourceNodePrototype.stop = BufferSourceNodePrototype.stop);

    GainPrototype.setTargetAtTime || (GainPrototype.setTargetAtTime = GainPrototype.setTargetValueAtTime);

    var onTouchStart = function (e) {
        window.removeEventListener('touchstart', onTouchStart, false);
        var buffer = audioContext.createBuffer(1, 1, 22050),
            source = audioContext.createBufferSource();

        source.buffer = buffer;
        source.connect(audioContext.destination);
        source.start(0);

        audioContext.UNLOCKED = true;
        window.dispatchEvent(new Event('audiocontextunlock'));
    };
    window.addEventListener('touchstart', onTouchStart, false);
}

module.exports = audioContext != undefined ? audioContext : false;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./device":10,"./dom":11}],8:[function(require,module,exports){
var EventEmitter = require('./event_emitter');
'use strict';


var CLASS_ID = 0;

/**
 * @class Xian.Class
 * @extends Xian.EventEmitter
 */
function Class() {

    EventEmitter.call(this);

    this._id = ++CLASS_ID;
    this._jsonId = -1;
    this._name = '';
}

EventEmitter.extend(Class);


/**
 * returns new copy of this
 * @memberof Xian.Class
 * @return Class
 */
Class.prototype.clone = function () {

    return new this.constructor().copy(this);
};

/**
 * copies other of same class
 * @memberof Xian.Class
 * @param {Xian.Class} other
 * @return this
 */
Class.prototype.copy = function () {

    return this;
};

/**
 * clears data for GC
 * @memberof Xian.Class
 * @return this
 */
Class.prototype.clear = function () {

    return this;
};

/**
 * converts this to a JSON object
 * @memberof Xian.Class
 * @return json
 */
Class.prototype.toJSON = function (json) {
    json || (json = {});

    json._id = this._id;
    json._jsonId = this._id;
    json._className = this._className;

    return json;
};

/**
 * sets this from JSON object
 * @memberof Xian.Class
 * @return this
 */
Class.prototype.fromJSON = function (json) {

    this._jsonId = json._jsonId;

    return this;
};

/**
 * returns class name
 * @memberof Xian.Class
 * @return string
 */
Class.prototype.toString = function () {

    return this._name;
};

/**
 * @memberof Xian.Class
 * @param {constructor} child
 * @param {constructor} parent
 * @return child
 */
Class.extend = function (child, parent) {
    if (!parent) parent = this;

    child.prototype = Object.create(parent.prototype);
    child.prototype.constructor = child;

    child.extend = parent.extend;
    child.prototype._className = child._className = child.name;

    (this._children || (this._children = {}))[child.name] = child;
    child._parent = this;

    Class._classes[child.name] = child;

    if (parent.onExtend) {
        if (!child.onExtend) child.onExtend = parent.onExtend;
        parent.onExtend(child);
    }

    return child;
};

/**
 * creates new Xian.Class from json object
 * @memberof Xian.Class
 * @param {object} json
 * @return Xian.Class
 */
Class.fromJSON = function (json) {

    return new Class._classes[json._className]().fromJSON(json);
};

/**
 * creates new Xian.Class from string type
 * @memberof Xian.Class
 * @param {string} type
 * @return Xian.Class
 */
Class.create = function (type) {

    return new Class._classes[type];
};


Class._classes = {};


module.exports = Class;

},{"./event_emitter":13}],9:[function(require,module,exports){
'use strict';


var hasOwnProperty = Object.prototype.hasOwnProperty;


function Config() {

    this.debug = false;

    this.host = '127.0.0.1';
    this.port = 3000;

    this.FAKE_LAG = 0;
    this.SCENE_SYNC_RATE = 0.5;

    this.MAX_SCENE_STATES = 5;

    this.MIN_DELTA = 0.000001;
    this.MAX_DELTA = 0.25;
}


Config.prototype.fromJSON = function (json) {

    for (var key in json) {
        if (this[key] != undefined) this[key] = json[key];
    }

    return this;
};


Config.prototype.toJSON = function (json) {
    json || (json = {});

    for (var key in this) {
        if (this[key] != undefined && hasOwnProperty.call(this, key)) json[key] = this[key];
    }

    return json;
};


module.exports = new Config;

},{}],10:[function(require,module,exports){
"use strict";


function Device() {
    var userAgent = navigator.userAgent.toLowerCase(),
        audio = new Audio,
        video = document.createElement("video");

    this.userAgent = userAgent;

    this.pixelRatio = window.devicePixelRatio || 1;
    this.invPixelRatio = 1 / this.pixelRatio;

    this.browser = userAgent.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i)[1];
    this.touch = "ontouchstart" in window;
    this.mobile = /android|webos|iphone|ipad|ipod|blackberry/i.test(userAgent);

    this.pointerLock = "pointerLockElement" in document || "mozPointerLockElement" in document || "webkitPointerLockElement" in document;
    this.fullScreen = "fullscreenElement" in document || "mozFullscreenElement" in document || "webkitFullscreenElement" in document;

    this.webgl = (function () {
        var canvas = document.createElement("canvas"),
            names = ["3d", "moz-webgl", "experimental-webgl", "webkit-3d", "webgl"],
            has, i = names.length;

        while (i--) {
            has = !!canvas.getContext(names[i]);
            if (has) break;
        }

        return has;
    }());

    this.canvas = (function () {
        var canvas = document.createElement("canvas"),
            has = !!canvas.getContext("2d");

        return has;
    }());

    this.gamepads = !!navigator.getGamepads || !!navigator.webkitGetGamepads || !!navigator.webkitGamepads;

    this.audioMpeg = !!audio.canPlayType("audio/mpeg");
    this.audioOgg = !!audio.canPlayType("audio/ogg");
    this.audioMp3 = !!audio.canPlayType("audio/mp3");
    this.audioMp4 = !!audio.canPlayType("audio/mp4");

    this.videoWebm = !!video.canPlayType("video/webm");
    this.videoOgg = !!video.canPlayType("video/ogg");
    this.videoMp4 = !!video.canPlayType("video/mp4");
}


module.exports = new Device;

},{}],11:[function(require,module,exports){
"use strict";


var SPLITER = /[ ,]+/,

    WEBGL_NAMES = ["webgl", "webkit-3d", "moz-webgl", "experimental-webgl", "3d"],
    WEBGL_ATTRIBUTES = {
        alpha: true,
        antialias: true,
        depth: true,
        premultipliedAlpha: true,
        preserveDrawingBuffer: false,
        stencil: true
    };


function Dom() {
}


var EVENT_CALLBACK_ID = 0,
    EVENT_CALLBACKS = {};
Dom.prototype.addEvent = function (obj, name, callback, ctx) {
    var names = name.split(SPLITER),
        i = names.length,
        scope = ctx || obj,
        afn = function (e) {
            callback.call(scope, e || window.event);
        };

    EVENT_CALLBACKS[(callback.__EVENT_CALLBACK_ID__ = EVENT_CALLBACK_ID++)] = afn;

    while (i--) {
        name = names[i];

        if (obj.attachEvent) {
            obj.attachEvent("on" + name, afn);
        } else {
            obj.addEventListener(name, afn, false);
        }
    }
};


Dom.prototype.removeEvent = function (obj, name, callback, ctx) {
    var names = name.split(SPLITER),
        i = names.length,
        scope = ctx || obj,
        id = callback.__EVENT_CALLBACK_ID__,
        afn = EVENT_CALLBACKS[id];

    EVENT_CALLBACKS[id] = null;

    while (i--) {
        name = names[i];

        if (obj.detachEvent) {
            obj.detachEvent("on" + name, afn);
        } else {
            obj.removeEventListener(name, afn, false);
        }
    }
};


Dom.prototype.addMeta = function (id, name, content) {
    var meta = document.createElement("meta"),
        head = document.head;

    if (id) meta.id = id;
    if (name) meta.name = name;
    if (content) meta.content = content;

    head.insertBefore(meta, head.firstChild);
};


Dom.prototype.getWebGLContext = function (canvas, attributes) {
    var key, gl, i = WEBGL_NAMES.length;

    attributes || (attributes = {});
    for (key in WEBGL_ATTRIBUTES) {
        if (attributes[key] == undefined) attributes[key] = WEBGL_ATTRIBUTES[key];
    }

    while (i--) {
        try {
            gl = canvas.getContext(WEBGL_NAMES[i], attributes);
        } catch (err) {
            console.error("Dom.getWebGLContext: could not get a WebGL Context " + (err.message || ""));
        }
        if (gl) break;
    }

    if (!gl) throw "Dom.getWebGLContext: could not get a WebGL Context";

    return gl;
};


var createShader = Dom.prototype.createShader = function (gl, source, type) {
    var shader = gl.createShader(type);

    gl.shaderSource(shader, source);
    gl.compileShader(shader);

    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
        console.error("Dom.createShader: problem compiling shader " + gl.getShaderInfoLog(shader));
        gl.deleteShader(shader);
        return undefined;
    }

    return shader;
};


Dom.prototype.createProgram = function (gl, vertex, fragment) {
    var program = gl.createProgram(),
        shader;

    shader = createShader(gl, vertex, gl.VERTEX_SHADER);
    gl.attachShader(program, shader);
    gl.deleteShader(shader);

    shader = createShader(gl, fragment, gl.FRAGMENT_SHADER);
    gl.attachShader(program, shader);
    gl.deleteShader(shader);

    gl.linkProgram(program);
    gl.validateProgram(program);
    gl.useProgram(program);

    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
        console.error("Dom.createProgram: problem compiling Program " + gl.getProgramInfoLog(program));
        gl.deleteProgram(program);
        return undefined;
    }

    return program;
};


module.exports = new Dom;

},{}],12:[function(require,module,exports){
var util = require("./util");
"use strict";


var isArray = util.isArray,
    SPLITER = /[ ,]+/,
    COUNTER = 0;


function Enum(enums) {
    enums = isArray(enums) ? enums : enums.split(SPLITER);
    var i = enums.length;

    while (i--) this[enums[i]] = ++COUNTER;
}


Enum.prototype.add = function (enums) {
    enums = isArray(enums) ? enums : enums.split(SPLITER);
    var i = enums.length;

    while (i--) this[enums[i]] = ++COUNTER;

    return this;
};


Enum.prototype.in = function (num) {
    var key;

    for (key in this) {
        if (this[key] == num) return true;
    }

    return false;
};


module.exports = Enum;

},{"./util":19}],13:[function(require,module,exports){
'use strict';


var shift = Array.prototype.shift;


/**
 * @class Xian.EventEmitter
 */
function EventEmitter() {

    this._events = {};
}

/**
 * attaches function to an event
 * @memberof Xian.EventEmitter
 * @param {string} type
 * @param {function} listener
 * @param {object} ctx
 * @return this
 */
EventEmitter.prototype.on = function (type, listener, ctx) {
    var events = this._events;

    (events[type] || (events[type] = [])).push({
        listener: listener,
        ctx: ctx || this
    });

    return this;
};

/**
 * attaches function to an event, on the first call its removed
 * @memberof Xian.EventEmitter
 * @param {string} type
 * @param {function} listener
 * @param {object} ctx
 * @return this
 */
EventEmitter.prototype.once = function (type, listener, ctx) {
    var _this = this;
    ctx = ctx || this;

    function once() {
        _this.off(type, once, ctx);
        listener.apply(ctx, arguments);
    }

    return this.on(type, once, ctx);
};

/**
 * attaches function to an event on another object
 * @memberof Xian.EventEmitter
 * @param {object} obj
 * @param {string} type
 * @param {function} listener
 * @param {object} ctx
 * @return this
 */
EventEmitter.prototype.listenTo = function (obj, type, listener, ctx) {
    if (!(obj instanceof EventEmitter)) throw "Can't listen to Object, it's not a instance of EventEmitter";

    obj.on(type, listener, ctx || this);

    return this;
};

/**
 * removes function from an event
 * @memberof Xian.EventEmitter
 * @param {string} type
 * @param {function} listener
 * @param {object} ctx
 * @return this
 */
EventEmitter.prototype.off = function (type, listener, ctx) {
    var thisEvents = this._events,
        events, event,
        i;

    if (!type) {
        for (i in thisEvents)
            if ((events = thisEvents[i])) events.length = 0;
        return this;
    }

    events = thisEvents[type];
    if (!events) return this;

    if (!listener) {
        events.length = 0;
    } else {
        ctx = ctx || this;
        i = events.length;

        while (i--) {
            event = events[i];

            if (event.listener === listener && event.ctx === ctx) {
                events.splice(i, 1);
                break;
            }
        }
    }

    return this;
};

/**
 * emits event type
 * @memberof Xian.EventEmitter
 * @param {string} type
 * @return this
 */
EventEmitter.prototype.emit = function (type) {
    var events = this._events[type],
        a1, a2, a3, a4,
        length, event,
        i;

    if (!events || !events.length) return this;
    length = arguments.length;

    if (length === 1) {
        i = events.length;
        while (i--) {
            (event = events[i]).listener.call(event.ctx);
        }
    } else if (length === 2) {
        a1 = arguments[1];
        i = events.length;
        while (i--) {
            (event = events[i]).listener.call(event.ctx, a1);
        }
    } else if (length === 3) {
        a1 = arguments[1];
        a2 = arguments[2];
        i = events.length;
        while (i--) {
            (event = events[i]).listener.call(event.ctx, a1, a2);
        }
    } else if (length === 4) {
        a1 = arguments[1];
        a2 = arguments[2];
        a3 = arguments[3];
        i = events.length;
        while (i--) {
            (event = events[i]).listener.call(event.ctx, a1, a2, a3);
        }
    } else if (length === 5) {
        a1 = arguments[1];
        a2 = arguments[2];
        a3 = arguments[3];
        a4 = arguments[4];
        i = events.length;
        while (i--) {
            (event = events[i]).listener.call(event.ctx, a1, a2, a3, a4);
        }
    } else {
        shift.apply(arguments);
        i = events.length;
        while (i--) {
            (event = events[i]).listener.apply(event.ctx, arguments);
        }
    }

    return this;
};

/**
 * @memberof Xian.EventEmitter
 * @param {constructor} child
 * @param {constructor} parent
 * @return child
 */
EventEmitter.extend = function (child, parent) {
    if (!parent) parent = this;

    child.prototype = Object.create(parent.prototype);
    child.prototype.constructor = child;

    (this._children || (this._children = {}))[child.name] = child;
    child._parent = this;

    child.extend = parent.extend || this.extend;

    if (parent.onExtend) {
        if (!child.onExtend) child.onExtend = parent.onExtend;
        parent.onExtend(child);
    }

    return child;
};


module.exports = EventEmitter;

},{}],14:[function(require,module,exports){
var Device = require("./device");
var util = require("./util");
var Config = require("./config");
"use strict";


var each = util.each;


function Log() {
}


if (Device.mobile) {
    var slice = Array.prototype.slice;

    Log.prototype.debug = Log.prototype.info = Log.prototype.log = function () {
        if (!Config.debug) return;
        alert(slice.call(arguments, 0));
    };

    Log.prototype.warn = function () {
        if (!(Config.debug || Config.warn)) return;
        alert(slice.call(arguments, 0));
    };

    Log.prototype.error = function () {
        if (!(Config.debug || Config.error)) return;
        alert(slice.call(arguments, 0));
    };
} else {
    Log.prototype.debug = Log.prototype.info = Log.prototype.log = function () {
        if (!Config.debug) return;
        console.log.apply(console, arguments);
    };

    Log.prototype.warn = function () {
        if (!(Config.debug || Config.warn)) return;
        console.warn.apply(console, arguments);
    };

    Log.prototype.error = function () {
        if (!(Config.debug || Config.error)) return;
        console.error.apply(console, arguments);
    };
}


var CACHE = {};
Log.prototype.once = function () {
    if (!(Config.debug || Config.error) || CACHE[cacheKey(arguments)]) return;

    CACHE[cacheKey(arguments)] = true;
    this.error.apply(this, arguments);
};


function cacheKey(args) {
    var key = "",
        i;

    for (i = args.length; i--;) key += args[i];

    return key;
};


Log.prototype.object = function (obj, values, tabs) {
    if (!Config.debug) return "";
    var str = "";

    tabs || (tabs = "");
    values || (values = []);

    each(obj, function (value, i) {
        if (~values.indexOf(value)) return;

        var type = typeof(value),
            tmp;

        if (type === "object") {
            tmp = tabs;
            values.push(value);
            tabs += "\t";
            str += tabs + i + " = " + this.object(value, values, tabs) + "\n";
            tabs = tmp;
        } else if (type !== "function") {
            str += tabs + i + " = " + value + "\n";
        } else {
            values.push(value);
            str += tabs + value + "\n";
        }
    }, this);

    return str;
};


module.exports = new Log;

},{"./config":9,"./device":10,"./util":19}],15:[function(require,module,exports){
"use strict";


function ObjectPool(constructor) {

    this.pooled = [];
    this.objects = [];
    this.object = constructor;
}


ObjectPool.prototype.create = function () {
    var pooled = this.pooled,
        object = pooled.length ? pooled.pop() : new this.object;

    this.objects.push(object);
    return object;
};


ObjectPool.prototype.removeObject = function (object) {
    var objects = this.objects,
        pooled = this.pooled,
        index = objects.indexOf(object);

    if (index > -1) {
        pooled.push(object);
        objects.splice(index, 1);
    }

    return this;
};


ObjectPool.prototype.remove = ObjectPool.prototype.removeObjects = function () {
    var i = arguments.length;

    while (i--) this.removeObject(arguments[i]);

    return this;
};


ObjectPool.prototype.clear = function () {
    var objects = this.objects,
        pooled = this.pooled,
        i = objects.length;

    while (i--) pooled.push(objects[i]);
    objects.length = 0;

    return this;
};


ObjectPool.prototype.clearForEach = function (fn) {
    var objects = this.objects,
        pooled = this.pooled,
        object,
        i = objects.length;

    while (i--) {
        object = objects[i];

        pooled.push(object);
        fn(object);
    }
    objects.length = 0;

    return this;
};


ObjectPool.prototype.empty = function () {

    this.pooled.length = this.objects.length = 0;

    return this;
};


module.exports = ObjectPool;

},{}],16:[function(require,module,exports){
(function (global){
"use strict";


var RATE = 1000 / 60,
    w = typeof(window) !== "undefined" ? window : global;

module.exports = (
w.requestAnimationFrame ||
w.webkitRequestAnimationFrame ||
w.mozRequestAnimationFrame ||
w.oRequestAnimationFrame ||
w.msRequestAnimationFrame ||
function (callback) {

    return w.setTimeout(callback, RATE);
}
);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],17:[function(require,module,exports){
(function() {
    var io = (function(exports, global) {
        var io = exports;
        io.version = "0.9.16";
        io.protocol = 1;
        io.transports = [];
        io.j = [];
        io.sockets = {};
        io.connect = function(host, details) {
            var uri = io.util.parseUri(host),
                uuri, socket;
            if (global && global.location) {
                uri.protocol = uri.protocol || global.location.protocol.slice(0, -1);
                uri.host = uri.host || (global.document ? global.document.domain : global.location.hostname);
                uri.port = uri.port || global.location.port
            }
            uuri = io.util.uniqueUri(uri);
            var options = {
                host: uri.host,
                secure: "https" == uri.protocol,
                port: uri.port || ("https" == uri.protocol ? 443 : 80),
                query: uri.query || ""
            };
            io.util.merge(options, details);
            if (options["force new connection"] || !io.sockets[uuri]) {
                socket = new io.Socket(options)
            }
            if (!options["force new connection"] && socket) {
                io.sockets[uuri] = socket
            }
            socket = socket || io.sockets[uuri];
            return socket.of(uri.path.length > 1 ? uri.path : "")
        };
        return io
    })({}, this);
    (function(exports, global) {
        var util = exports.util = {};
        var re = /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;
        var parts = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"];
        util.parseUri = function(str) {
            var m = re.exec(str || ""),
                uri = {}, i = 14;
            while (i--) {
                uri[parts[i]] = m[i] || ""
            }
            return uri
        };
        util.uniqueUri = function(uri) {
            var protocol = uri.protocol,
                host = uri.host,
                port = uri.port;
            if ("document" in global) {
                host = host || document.domain;
                port = port || (protocol == "https" && document.location.protocol !== "https:" ? 443 : document.location.port)
            } else {
                host = host || "localhost";
                if (!port && protocol == "https") {
                    port = 443
                }
            }
            return (protocol || "http") + "://" + host + ":" + (port || 80)
        };
        util.query = function(base, addition) {
            var query = util.chunkQuery(base || ""),
                components = [];
            util.merge(query, util.chunkQuery(addition || ""));
            for (var part in query) {
                if (query.hasOwnProperty(part)) {
                    components.push(part + "=" + query[part])
                }
            }
            return components.length ? "?" + components.join("&") : ""
        };
        util.chunkQuery = function(qs) {
            var query = {}, params = qs.split("&"),
                i = 0,
                l = params.length,
                kv;
            for (; i < l; ++i) {
                kv = params[i].split("=");
                if (kv[0]) {
                    query[kv[0]] = kv[1]
                }
            }
            return query
        };
        var pageLoaded = false;
        util.load = function(fn) {
            if ("document" in global && document.readyState === "complete" || pageLoaded) {
                return fn()
            }
            util.on(global, "load", fn, false)
        };
        util.on = function(element, event, fn, capture) {
            if (element.attachEvent) {
                element.attachEvent("on" + event, fn)
            } else {
                if (element.addEventListener) {
                    element.addEventListener(event, fn, capture)
                }
            }
        };
        util.request = function(xdomain) {
            if (xdomain && "undefined" != typeof XDomainRequest && !util.ua.hasCORS) {
                return new XDomainRequest()
            }
            if ("undefined" != typeof XMLHttpRequest && (!xdomain || util.ua.hasCORS)) {
                return new XMLHttpRequest()
            }
            if (!xdomain) {
                try {
                    return new window[(["Active"].concat("Object").join("X"))]("Microsoft.XMLHTTP")
                } catch (e) {}
            }
            return null
        };
        if ("undefined" != typeof window) {
            util.load(function() {
                pageLoaded = true
            })
        }
        util.defer = function(fn) {
            if (!util.ua.webkit || "undefined" != typeof importScripts) {
                return fn()
            }
            util.load(function() {
                setTimeout(fn, 100)
            })
        };
        util.merge = function merge(target, additional, deep, lastseen) {
            var seen = lastseen || [],
                depth = typeof deep == "undefined" ? 2 : deep,
                prop;
            for (prop in additional) {
                if (additional.hasOwnProperty(prop) && util.indexOf(seen, prop) < 0) {
                    if (typeof target[prop] !== "object" || !depth) {
                        target[prop] = additional[prop];
                        seen.push(additional[prop])
                    } else {
                        util.merge(target[prop], additional[prop], depth - 1, seen)
                    }
                }
            }
            return target
        };
        util.mixin = function(ctor, ctor2) {
            util.merge(ctor.prototype, ctor2.prototype)
        };
        util.inherit = function(ctor, ctor2) {
            function f() {}
            f.prototype = ctor2.prototype;
            ctor.prototype = new f
        };
        util.isArray = Array.isArray || function(obj) {
            return Object.prototype.toString.call(obj) === "[object Array]"
        };
        util.intersect = function(arr, arr2) {
            var ret = [],
                longest = arr.length > arr2.length ? arr : arr2,
                shortest = arr.length > arr2.length ? arr2 : arr;
            for (var i = 0, l = shortest.length; i < l; i++) {
                if (~util.indexOf(longest, shortest[i])) {
                    ret.push(shortest[i])
                }
            }
            return ret
        };
        util.indexOf = function(arr, o, i) {
            for (var j = arr.length, i = i < 0 ? i + j < 0 ? 0 : i + j : i || 0; i < j && arr[i] !== o; i++) {}
            return j <= i ? -1 : i
        };
        util.toArray = function(enu) {
            var arr = [];
            for (var i = 0, l = enu.length; i < l; i++) {
                arr.push(enu[i])
            }
            return arr
        };
        util.ua = {};
        util.ua.hasCORS = "undefined" != typeof XMLHttpRequest && (function() {
            try {
                var a = new XMLHttpRequest()
            } catch (e) {
                return false
            }
            return a.withCredentials != undefined
        })();
        util.ua.webkit = "undefined" != typeof navigator && /webkit/i.test(navigator.userAgent);
        util.ua.iDevice = "undefined" != typeof navigator && /iPad|iPhone|iPod/i.test(navigator.userAgent)
    })("undefined" != typeof io ? io : module.exports, this);
    (function(exports, io) {
        exports.EventEmitter = EventEmitter;

        function EventEmitter() {}
        EventEmitter.prototype.on = function(name, fn) {
            if (!this.$events) {
                this.$events = {}
            }
            if (!this.$events[name]) {
                this.$events[name] = fn
            } else {
                if (io.util.isArray(this.$events[name])) {
                    this.$events[name].push(fn)
                } else {
                    this.$events[name] = [this.$events[name], fn]
                }
            }
            return this
        };
        EventEmitter.prototype.addListener = EventEmitter.prototype.on;
        EventEmitter.prototype.once = function(name, fn) {
            var self = this;

            function on() {
                self.removeListener(name, on);
                fn.apply(this, arguments)
            }
            on.listener = fn;
            this.on(name, on);
            return this
        };
        EventEmitter.prototype.removeListener = function(name, fn) {
            if (this.$events && this.$events[name]) {
                var list = this.$events[name];
                if (io.util.isArray(list)) {
                    var pos = -1;
                    for (var i = 0, l = list.length; i < l; i++) {
                        if (list[i] === fn || (list[i].listener && list[i].listener === fn)) {
                            pos = i;
                            break
                        }
                    }
                    if (pos < 0) {
                        return this
                    }
                    list.splice(pos, 1);
                    if (!list.length) {
                        delete this.$events[name]
                    }
                } else {
                    if (list === fn || (list.listener && list.listener === fn)) {
                        delete this.$events[name]
                    }
                }
            }
            return this
        };
        EventEmitter.prototype.removeAllListeners = function(name) {
            if (name === undefined) {
                this.$events = {};
                return this
            }
            if (this.$events && this.$events[name]) {
                this.$events[name] = null
            }
            return this
        };
        EventEmitter.prototype.listeners = function(name) {
            if (!this.$events) {
                this.$events = {}
            }
            if (!this.$events[name]) {
                this.$events[name] = []
            }
            if (!io.util.isArray(this.$events[name])) {
                this.$events[name] = [this.$events[name]]
            }
            return this.$events[name]
        };
        EventEmitter.prototype.emit = function(name) {
            if (!this.$events) {
                return false
            }
            var handler = this.$events[name];
            if (!handler) {
                return false
            }
            var args = Array.prototype.slice.call(arguments, 1);
            if ("function" == typeof handler) {
                handler.apply(this, args)
            } else {
                if (io.util.isArray(handler)) {
                    var listeners = handler.slice();
                    for (var i = 0, l = listeners.length; i < l; i++) {
                        listeners[i].apply(this, args)
                    }
                } else {
                    return false
                }
            }
            return true
        }
    })("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports);
    (function(exports, nativeJSON) {
        if (nativeJSON && nativeJSON.parse) {
            return exports.JSON = {
                parse: nativeJSON.parse,
                stringify: nativeJSON.stringify
            }
        }
        var JSON = exports.JSON = {};

        function f(n) {
            return n < 10 ? "0" + n : n
        }

        function date(d) {
            return isFinite(d.valueOf()) ? d.getUTCFullYear() + "-" + f(d.getUTCMonth() + 1) + "-" + f(d.getUTCDate()) + "T" + f(d.getUTCHours()) + ":" + f(d.getUTCMinutes()) + ":" + f(d.getUTCSeconds()) + "Z" : null
        }
        var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
            escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
            gap, indent, meta = {
                "\b": "\\b",
                "\t": "\\t",
                "\n": "\\n",
                "\f": "\\f",
                "\r": "\\r",
                '"': '\\"',
                "\\": "\\\\"
            }, rep;

        function quote(string) {
            escapable.lastIndex = 0;
            return escapable.test(string) ? '"' + string.replace(escapable, function(a) {
                var c = meta[a];
                return typeof c === "string" ? c : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4)
            }) + '"' : '"' + string + '"'
        }

        function str(key, holder) {
            var i, k, v, length, mind = gap,
                partial, value = holder[key];
            if (value instanceof Date) {
                value = date(key)
            }
            if (typeof rep === "function") {
                value = rep.call(holder, key, value)
            }
            switch (typeof value) {
                case "string":
                    return quote(value);
                case "number":
                    return isFinite(value) ? String(value) : "null";
                case "boolean":
                case "null":
                    return String(value);
                case "object":
                    if (!value) {
                        return "null"
                    }
                    gap += indent;
                    partial = [];
                    if (Object.prototype.toString.apply(value) === "[object Array]") {
                        length = value.length;
                        for (i = 0; i < length; i += 1) {
                            partial[i] = str(i, value) || "null"
                        }
                        v = partial.length === 0 ? "[]" : gap ? "[\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "]" : "[" + partial.join(",") + "]";
                        gap = mind;
                        return v
                    }
                    if (rep && typeof rep === "object") {
                        length = rep.length;
                        for (i = 0; i < length; i += 1) {
                            if (typeof rep[i] === "string") {
                                k = rep[i];
                                v = str(k, value);
                                if (v) {
                                    partial.push(quote(k) + (gap ? ": " : ":") + v)
                                }
                            }
                        }
                    } else {
                        for (k in value) {
                            if (Object.prototype.hasOwnProperty.call(value, k)) {
                                v = str(k, value);
                                if (v) {
                                    partial.push(quote(k) + (gap ? ": " : ":") + v)
                                }
                            }
                        }
                    }
                    v = partial.length === 0 ? "{}" : gap ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}" : "{" + partial.join(",") + "}";
                    gap = mind;
                    return v
            }
        }
        JSON.stringify = function(value, replacer, space) {
            var i;
            gap = "";
            indent = "";
            if (typeof space === "number") {
                for (i = 0; i < space; i += 1) {
                    indent += " "
                }
            } else {
                if (typeof space === "string") {
                    indent = space
                }
            }
            rep = replacer;
            if (replacer && typeof replacer !== "function" && (typeof replacer !== "object" || typeof replacer.length !== "number")) {
                throw new Error("JSON.stringify")
            }
            return str("", {
                "": value
            })
        };
        JSON.parse = function(text, reviver) {
            var j;

            function walk(holder, key) {
                var k, v, value = holder[key];
                if (value && typeof value === "object") {
                    for (k in value) {
                        if (Object.prototype.hasOwnProperty.call(value, k)) {
                            v = walk(value, k);
                            if (v !== undefined) {
                                value[k] = v
                            } else {
                                delete value[k]
                            }
                        }
                    }
                }
                return reviver.call(holder, key, value)
            }
            text = String(text);
            cx.lastIndex = 0;
            if (cx.test(text)) {
                text = text.replace(cx, function(a) {
                    return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4)
                })
            }
            if (/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) {
                j = eval("(" + text + ")");
                return typeof reviver === "function" ? walk({
                    "": j
                }, "") : j
            }
            throw new SyntaxError("JSON.parse")
        }
    })("undefined" != typeof io ? io : module.exports, typeof JSON !== "undefined" ? JSON : undefined);
    (function(exports, io) {
        var parser = exports.parser = {};
        var packets = parser.packets = ["disconnect", "connect", "heartbeat", "message", "json", "event", "ack", "error", "noop"];
        var reasons = parser.reasons = ["transport not supported", "client not handshaken", "unauthorized"];
        var advice = parser.advice = ["reconnect"];
        var JSON = io.JSON,
            indexOf = io.util.indexOf;
        parser.encodePacket = function(packet) {
            var type = indexOf(packets, packet.type),
                id = packet.id || "",
                endpoint = packet.endpoint || "",
                ack = packet.ack,
                data = null;
            switch (packet.type) {
                case "error":
                    var reason = packet.reason ? indexOf(reasons, packet.reason) : "",
                        adv = packet.advice ? indexOf(advice, packet.advice) : "";
                    if (reason !== "" || adv !== "") {
                        data = reason + (adv !== "" ? ("+" + adv) : "")
                    }
                    break;
                case "message":
                    if (packet.data !== "") {
                        data = packet.data
                    }
                    break;
                case "event":
                    var ev = {
                        name: packet.name
                    };
                    if (packet.args && packet.args.length) {
                        ev.args = packet.args
                    }
                    data = JSON.stringify(ev);
                    break;
                case "json":
                    data = JSON.stringify(packet.data);
                    break;
                case "connect":
                    if (packet.qs) {
                        data = packet.qs
                    }
                    break;
                case "ack":
                    data = packet.ackId + (packet.args && packet.args.length ? "+" + JSON.stringify(packet.args) : "");
                    break
            }
            var encoded = [type, id + (ack == "data" ? "+" : ""), endpoint];
            if (data !== null && data !== undefined) {
                encoded.push(data)
            }
            return encoded.join(":")
        };
        parser.encodePayload = function(packets) {
            var decoded = "";
            if (packets.length == 1) {
                return packets[0]
            }
            for (var i = 0, l = packets.length; i < l; i++) {
                var packet = packets[i];
                decoded += "\ufffd" + packet.length + "\ufffd" + packets[i]
            }
            return decoded
        };
        var regexp = /([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;
        parser.decodePacket = function(data) {
            var pieces = data.match(regexp);
            if (!pieces) {
                return {}
            }
            var id = pieces[2] || "",
                data = pieces[5] || "",
                packet = {
                    type: packets[pieces[1]],
                    endpoint: pieces[4] || ""
                };
            if (id) {
                packet.id = id;
                if (pieces[3]) {
                    packet.ack = "data"
                } else {
                    packet.ack = true
                }
            }
            switch (packet.type) {
                case "error":
                    var pieces = data.split("+");
                    packet.reason = reasons[pieces[0]] || "";
                    packet.advice = advice[pieces[1]] || "";
                    break;
                case "message":
                    packet.data = data || "";
                    break;
                case "event":
                    try {
                        var opts = JSON.parse(data);
                        packet.name = opts.name;
                        packet.args = opts.args
                    } catch (e) {}
                    packet.args = packet.args || [];
                    break;
                case "json":
                    try {
                        packet.data = JSON.parse(data)
                    } catch (e) {}
                    break;
                case "connect":
                    packet.qs = data || "";
                    break;
                case "ack":
                    var pieces = data.match(/^([0-9]+)(\+)?(.*)/);
                    if (pieces) {
                        packet.ackId = pieces[1];
                        packet.args = [];
                        if (pieces[3]) {
                            try {
                                packet.args = pieces[3] ? JSON.parse(pieces[3]) : []
                            } catch (e) {}
                        }
                    }
                    break;
                case "disconnect":
                case "heartbeat":
                    break
            }
            return packet
        };
        parser.decodePayload = function(data) {
            if (data.charAt(0) == "\ufffd") {
                var ret = [];
                for (var i = 1, length = ""; i < data.length; i++) {
                    if (data.charAt(i) == "\ufffd") {
                        ret.push(parser.decodePacket(data.substr(i + 1).substr(0, length)));
                        i += Number(length) + 1;
                        length = ""
                    } else {
                        length += data.charAt(i)
                    }
                }
                return ret
            } else {
                return [parser.decodePacket(data)]
            }
        }
    })("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports);
    (function(exports, io) {
        exports.Transport = Transport;

        function Transport(socket, sessid) {
            this.socket = socket;
            this.sessid = sessid
        }
        io.util.mixin(Transport, io.EventEmitter);
        Transport.prototype.heartbeats = function() {
            return true
        };
        Transport.prototype.onData = function(data) {
            this.clearCloseTimeout();
            if (this.socket.connected || this.socket.connecting || this.socket.reconnecting) {
                this.setCloseTimeout()
            }
            if (data !== "") {
                var msgs = io.parser.decodePayload(data);
                if (msgs && msgs.length) {
                    for (var i = 0, l = msgs.length; i < l; i++) {
                        this.onPacket(msgs[i])
                    }
                }
            }
            return this
        };
        Transport.prototype.onPacket = function(packet) {
            this.socket.setHeartbeatTimeout();
            if (packet.type == "heartbeat") {
                return this.onHeartbeat()
            }
            if (packet.type == "connect" && packet.endpoint == "") {
                this.onConnect()
            }
            if (packet.type == "error" && packet.advice == "reconnect") {
                this.isOpen = false
            }
            this.socket.onPacket(packet);
            return this
        };
        Transport.prototype.setCloseTimeout = function() {
            if (!this.closeTimeout) {
                var self = this;
                this.closeTimeout = setTimeout(function() {
                    self.onDisconnect()
                }, this.socket.closeTimeout)
            }
        };
        Transport.prototype.onDisconnect = function() {
            if (this.isOpen) {
                this.close()
            }
            this.clearTimeouts();
            this.socket.onDisconnect();
            return this
        };
        Transport.prototype.onConnect = function() {
            this.socket.onConnect();
            return this
        };
        Transport.prototype.clearCloseTimeout = function() {
            if (this.closeTimeout) {
                clearTimeout(this.closeTimeout);
                this.closeTimeout = null
            }
        };
        Transport.prototype.clearTimeouts = function() {
            this.clearCloseTimeout();
            if (this.reopenTimeout) {
                clearTimeout(this.reopenTimeout)
            }
        };
        Transport.prototype.packet = function(packet) {
            this.send(io.parser.encodePacket(packet))
        };
        Transport.prototype.onHeartbeat = function() {
            this.packet({
                type: "heartbeat"
            })
        };
        Transport.prototype.onOpen = function() {
            this.isOpen = true;
            this.clearCloseTimeout();
            this.socket.onOpen()
        };
        Transport.prototype.onClose = function() {
            this.isOpen = false;
            this.socket.onClose();
            this.onDisconnect()
        };
        Transport.prototype.prepareUrl = function() {
            var options = this.socket.options;
            return this.scheme() + "://" + options.host + ":" + options.port + "/" + options.resource + "/" + io.protocol + "/" + this.name + "/" + this.sessid
        };
        Transport.prototype.ready = function(socket, fn) {
            fn.call(this)
        }
    })("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports);
    (function(exports, io, global) {
        exports.Socket = Socket;

        function Socket(options) {
            this.options = {
                port: 80,
                secure: false,
                document: "document" in global ? document : false,
                resource: "socket.io",
                transports: io.transports,
                "connect timeout": 10000,
                "try multiple transports": true,
                "reconnect": true,
                "reconnection delay": 500,
                "reconnection limit": Infinity,
                "reopen delay": 3000,
                "max reconnection attempts": 10,
                "sync disconnect on unload": false,
                "auto connect": true,
                "flash policy port": 10843,
                "manualFlush": false
            };
            io.util.merge(this.options, options);
            this.connected = false;
            this.open = false;
            this.connecting = false;
            this.reconnecting = false;
            this.namespaces = {};
            this.buffer = [];
            this.doBuffer = false;
            if (this.options["sync disconnect on unload"] && (!this.isXDomain() || io.util.ua.hasCORS)) {
                var self = this;
                io.util.on(global, "beforeunload", function() {
                    self.disconnectSync()
                }, false)
            }
            if (this.options["auto connect"]) {
                this.connect()
            }
        }
        io.util.mixin(Socket, io.EventEmitter);
        Socket.prototype.of = function(name) {
            if (!this.namespaces[name]) {
                this.namespaces[name] = new io.SocketNamespace(this, name);
                if (name !== "") {
                    this.namespaces[name].packet({
                        type: "connect"
                    })
                }
            }
            return this.namespaces[name]
        };
        Socket.prototype.publish = function() {
            this.emit.apply(this, arguments);
            var nsp;
            for (var i in this.namespaces) {
                if (this.namespaces.hasOwnProperty(i)) {
                    nsp = this.of(i);
                    nsp.$emit.apply(nsp, arguments)
                }
            }
        };

        function empty() {}
        Socket.prototype.handshake = function(fn) {
            var self = this,
                options = this.options;

            function complete(data) {
                if (data instanceof Error) {
                    self.connecting = false;
                    self.onError(data.message)
                } else {
                    fn.apply(null, data.split(":"))
                }
            }
            var url = ["http" + (options.secure ? "s" : "") + ":/", options.host + ":" + options.port, options.resource, io.protocol, io.util.query(this.options.query, "t=" + +new Date)].join("/");
            if (this.isXDomain() && !io.util.ua.hasCORS) {
                var insertAt = document.getElementsByTagName("script")[0],
                    script = document.createElement("script");
                script.src = url + "&jsonp=" + io.j.length;
                insertAt.parentNode.insertBefore(script, insertAt);
                io.j.push(function(data) {
                    complete(data);
                    script.parentNode.removeChild(script)
                })
            } else {
                var xhr = io.util.request();
                xhr.open("GET", url, true);
                if (this.isXDomain()) {
                    xhr.withCredentials = true
                }
                xhr.onreadystatechange = function() {
                    if (xhr.readyState == 4) {
                        xhr.onreadystatechange = empty;
                        if (xhr.status == 200) {
                            complete(xhr.responseText)
                        } else {
                            if (xhr.status == 403) {
                                self.onError(xhr.responseText)
                            } else {
                                self.connecting = false;
                                !self.reconnecting && self.onError(xhr.responseText)
                            }
                        }
                    }
                };
                xhr.send(null)
            }
        };
        Socket.prototype.getTransport = function(override) {
            var transports = override || this.transports;
            for (var i = 0, transport; transport = transports[i]; i++) {
                if (io.Transport[transport] && io.Transport[transport].check(this) && (!this.isXDomain() || io.Transport[transport].xdomainCheck(this))) {
                    return new io.Transport[transport](this, this.sessionid)
                }
            }
            return null
        };
        Socket.prototype.connect = function(fn) {
            if (this.connecting) {
                return this
            }
            var self = this;
            self.connecting = true;
            this.handshake(function(sid, heartbeat, close, transports) {
                self.sessionid = sid;
                self.closeTimeout = close * 1000;
                self.heartbeatTimeout = heartbeat * 1000;
                if (!self.transports) {
                    self.transports = self.origTransports = (transports ? io.util.intersect(transports.split(","), self.options.transports) : self.options.transports)
                }
                self.setHeartbeatTimeout();

                function connect(transports) {
                    if (self.transport) {
                        self.transport.clearTimeouts()
                    }
                    self.transport = self.getTransport(transports);
                    if (!self.transport) {
                        return self.publish("connect_failed")
                    }
                    self.transport.ready(self, function() {
                        self.connecting = true;
                        self.publish("connecting", self.transport.name);
                        self.transport.open();
                        if (self.options["connect timeout"]) {
                            self.connectTimeoutTimer = setTimeout(function() {
                                if (!self.connected) {
                                    self.connecting = false;
                                    if (self.options["try multiple transports"]) {
                                        var remaining = self.transports;
                                        while (remaining.length > 0 && remaining.splice(0, 1)[0] != self.transport.name) {}
                                        if (remaining.length) {
                                            connect(remaining)
                                        } else {
                                            self.publish("connect_failed")
                                        }
                                    }
                                }
                            }, self.options["connect timeout"])
                        }
                    })
                }
                connect(self.transports);
                self.once("connect", function() {
                    clearTimeout(self.connectTimeoutTimer);
                    fn && typeof fn == "function" && fn()
                })
            });
            return this
        };
        Socket.prototype.setHeartbeatTimeout = function() {
            clearTimeout(this.heartbeatTimeoutTimer);
            if (this.transport && !this.transport.heartbeats()) {
                return
            }
            var self = this;
            this.heartbeatTimeoutTimer = setTimeout(function() {
                self.transport.onClose()
            }, this.heartbeatTimeout)
        };
        Socket.prototype.packet = function(data) {
            if (this.connected && !this.doBuffer) {
                this.transport.packet(data)
            } else {
                this.buffer.push(data)
            }
            return this
        };
        Socket.prototype.setBuffer = function(v) {
            this.doBuffer = v;
            if (!v && this.connected && this.buffer.length) {
                if (!this.options["manualFlush"]) {
                    this.flushBuffer()
                }
            }
        };
        Socket.prototype.flushBuffer = function() {
            this.transport.payload(this.buffer);
            this.buffer = []
        };
        Socket.prototype.disconnect = function() {
            if (this.connected || this.connecting) {
                if (this.open) {
                    this.of("").packet({
                        type: "disconnect"
                    })
                }
                this.onDisconnect("booted")
            }
            return this
        };
        Socket.prototype.disconnectSync = function() {
            var xhr = io.util.request();
            var uri = ["http" + (this.options.secure ? "s" : "") + ":/", this.options.host + ":" + this.options.port, this.options.resource, io.protocol, "", this.sessionid].join("/") + "/?disconnect=1";
            xhr.open("GET", uri, false);
            xhr.send(null);
            this.onDisconnect("booted")
        };
        Socket.prototype.isXDomain = function() {
            var port = global.location.port || ("https:" == global.location.protocol ? 443 : 80);
            return this.options.host !== global.location.hostname || this.options.port != port
        };
        Socket.prototype.onConnect = function() {
            if (!this.connected) {
                this.connected = true;
                this.connecting = false;
                if (!this.doBuffer) {
                    this.setBuffer(false)
                }
                this.emit("connect")
            }
        };
        Socket.prototype.onOpen = function() {
            this.open = true
        };
        Socket.prototype.onClose = function() {
            this.open = false;
            clearTimeout(this.heartbeatTimeoutTimer)
        };
        Socket.prototype.onPacket = function(packet) {
            this.of(packet.endpoint).onPacket(packet)
        };
        Socket.prototype.onError = function(err) {
            if (err && err.advice) {
                if (err.advice === "reconnect" && (this.connected || this.connecting)) {
                    this.disconnect();
                    if (this.options.reconnect) {
                        this.reconnect()
                    }
                }
            }
            this.publish("error", err && err.reason ? err.reason : err)
        };
        Socket.prototype.onDisconnect = function(reason) {
            var wasConnected = this.connected,
                wasConnecting = this.connecting;
            this.connected = false;
            this.connecting = false;
            this.open = false;
            if (wasConnected || wasConnecting) {
                this.transport.close();
                this.transport.clearTimeouts();
                if (wasConnected) {
                    this.publish("disconnect", reason);
                    if ("booted" != reason && this.options.reconnect && !this.reconnecting) {
                        this.reconnect()
                    }
                }
            }
        };
        Socket.prototype.reconnect = function() {
            this.reconnecting = true;
            this.reconnectionAttempts = 0;
            this.reconnectionDelay = this.options["reconnection delay"];
            var self = this,
                maxAttempts = this.options["max reconnection attempts"],
                tryMultiple = this.options["try multiple transports"],
                limit = this.options["reconnection limit"];

            function reset() {
                if (self.connected) {
                    for (var i in self.namespaces) {
                        if (self.namespaces.hasOwnProperty(i) && "" !== i) {
                            self.namespaces[i].packet({
                                type: "connect"
                            })
                        }
                    }
                    self.publish("reconnect", self.transport.name, self.reconnectionAttempts)
                }
                clearTimeout(self.reconnectionTimer);
                self.removeListener("connect_failed", maybeReconnect);
                self.removeListener("connect", maybeReconnect);
                self.reconnecting = false;
                delete self.reconnectionAttempts;
                delete self.reconnectionDelay;
                delete self.reconnectionTimer;
                delete self.redoTransports;
                self.options["try multiple transports"] = tryMultiple
            }

            function maybeReconnect() {
                if (!self.reconnecting) {
                    return
                }
                if (self.connected) {
                    return reset()
                }
                if (self.connecting && self.reconnecting) {
                    return self.reconnectionTimer = setTimeout(maybeReconnect, 1000)
                }
                if (self.reconnectionAttempts++ >= maxAttempts) {
                    if (!self.redoTransports) {
                        self.on("connect_failed", maybeReconnect);
                        self.options["try multiple transports"] = true;
                        self.transports = self.origTransports;
                        self.transport = self.getTransport();
                        self.redoTransports = true;
                        self.connect()
                    } else {
                        self.publish("reconnect_failed");
                        reset()
                    }
                } else {
                    if (self.reconnectionDelay < limit) {
                        self.reconnectionDelay *= 2
                    }
                    self.connect();
                    self.publish("reconnecting", self.reconnectionDelay, self.reconnectionAttempts);
                    self.reconnectionTimer = setTimeout(maybeReconnect, self.reconnectionDelay)
                }
            }
            this.options["try multiple transports"] = false;
            this.reconnectionTimer = setTimeout(maybeReconnect, this.reconnectionDelay);
            this.on("connect", maybeReconnect)
        }
    })("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports, this);
    (function(exports, io) {
        exports.SocketNamespace = SocketNamespace;

        function SocketNamespace(socket, name) {
            this.socket = socket;
            this.name = name || "";
            this.flags = {};
            this.json = new Flag(this, "json");
            this.ackPackets = 0;
            this.acks = {}
        }
        io.util.mixin(SocketNamespace, io.EventEmitter);
        SocketNamespace.prototype.$emit = io.EventEmitter.prototype.emit;
        SocketNamespace.prototype.of = function() {
            return this.socket.of.apply(this.socket, arguments)
        };
        SocketNamespace.prototype.packet = function(packet) {
            packet.endpoint = this.name;
            this.socket.packet(packet);
            this.flags = {};
            return this
        };
        SocketNamespace.prototype.send = function(data, fn) {
            var packet = {
                type: this.flags.json ? "json" : "message",
                data: data
            };
            if ("function" == typeof fn) {
                packet.id = ++this.ackPackets;
                packet.ack = true;
                this.acks[packet.id] = fn
            }
            return this.packet(packet)
        };
        SocketNamespace.prototype.emit = function(name) {
            var args = Array.prototype.slice.call(arguments, 1),
                lastArg = args[args.length - 1],
                packet = {
                    type: "event",
                    name: name
                };
            if ("function" == typeof lastArg) {
                packet.id = ++this.ackPackets;
                packet.ack = "data";
                this.acks[packet.id] = lastArg;
                args = args.slice(0, args.length - 1)
            }
            packet.args = args;
            return this.packet(packet)
        };
        SocketNamespace.prototype.disconnect = function() {
            if (this.name === "") {
                this.socket.disconnect()
            } else {
                this.packet({
                    type: "disconnect"
                });
                this.$emit("disconnect")
            }
            return this
        };
        SocketNamespace.prototype.onPacket = function(packet) {
            var self = this;

            function ack() {
                self.packet({
                    type: "ack",
                    args: io.util.toArray(arguments),
                    ackId: packet.id
                })
            }
            switch (packet.type) {
                case "connect":
                    this.$emit("connect");
                    break;
                case "disconnect":
                    if (this.name === "") {
                        this.socket.onDisconnect(packet.reason || "booted")
                    } else {
                        this.$emit("disconnect", packet.reason)
                    }
                    break;
                case "message":
                case "json":
                    var params = ["message", packet.data];
                    if (packet.ack == "data") {
                        params.push(ack)
                    } else {
                        if (packet.ack) {
                            this.packet({
                                type: "ack",
                                ackId: packet.id
                            })
                        }
                    }
                    this.$emit.apply(this, params);
                    break;
                case "event":
                    var params = [packet.name].concat(packet.args);
                    if (packet.ack == "data") {
                        params.push(ack)
                    }
                    this.$emit.apply(this, params);
                    break;
                case "ack":
                    if (this.acks[packet.ackId]) {
                        this.acks[packet.ackId].apply(this, packet.args);
                        delete this.acks[packet.ackId]
                    }
                    break;
                case "error":
                    if (packet.advice) {
                        this.socket.onError(packet)
                    } else {
                        if (packet.reason == "unauthorized") {
                            this.$emit("connect_failed", packet.reason)
                        } else {
                            this.$emit("error", packet.reason)
                        }
                    }
                    break
            }
        };

        function Flag(nsp, name) {
            this.namespace = nsp;
            this.name = name
        }
        Flag.prototype.send = function() {
            this.namespace.flags[this.name] = true;
            this.namespace.send.apply(this.namespace, arguments)
        };
        Flag.prototype.emit = function() {
            this.namespace.flags[this.name] = true;
            this.namespace.emit.apply(this.namespace, arguments)
        }
    })("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports);
    (function(exports, io, global) {
        exports.websocket = WS;

        function WS() {
            io.Transport.apply(this, arguments)
        }
        io.util.inherit(WS, io.Transport);
        WS.prototype.name = "websocket";
        WS.prototype.open = function() {
            var query = io.util.query(this.socket.options.query),
                self = this,
                Socket;
            if (!Socket) {
                Socket = global.MozWebSocket || global.WebSocket
            }
            this.websocket = new Socket(this.prepareUrl() + query);
            this.websocket.onopen = function() {
                self.onOpen();
                self.socket.setBuffer(false)
            };
            this.websocket.onmessage = function(ev) {
                self.onData(ev.data)
            };
            this.websocket.onclose = function() {
                self.onClose();
                self.socket.setBuffer(true)
            };
            this.websocket.onerror = function(e) {
                self.onError(e)
            };
            return this
        };
        if (io.util.ua.iDevice) {
            WS.prototype.send = function(data) {
                var self = this;
                setTimeout(function() {
                    self.websocket.send(data)
                }, 0);
                return this
            }
        } else {
            WS.prototype.send = function(data) {
                this.websocket.send(data);
                return this
            }
        }
        WS.prototype.payload = function(arr) {
            for (var i = 0, l = arr.length; i < l; i++) {
                this.packet(arr[i])
            }
            return this
        };
        WS.prototype.close = function() {
            this.websocket.close();
            return this
        };
        WS.prototype.onError = function(e) {
            this.socket.onError(e)
        };
        WS.prototype.scheme = function() {
            return this.socket.options.secure ? "wss" : "ws"
        };
        WS.check = function() {
            return ("WebSocket" in global && !("__addTask" in WebSocket)) || "MozWebSocket" in global
        };
        WS.xdomainCheck = function() {
            return true
        };
        io.transports.push("websocket")
    })("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports, this);
    (function(exports, io, global) {
        exports.XHR = XHR;

        function XHR(socket) {
            if (!socket) {
                return
            }
            io.Transport.apply(this, arguments);
            this.sendBuffer = []
        }
        io.util.inherit(XHR, io.Transport);
        XHR.prototype.open = function() {
            this.socket.setBuffer(false);
            this.onOpen();
            this.get();
            this.setCloseTimeout();
            return this
        };
        XHR.prototype.payload = function(payload) {
            var msgs = [];
            for (var i = 0, l = payload.length; i < l; i++) {
                msgs.push(io.parser.encodePacket(payload[i]))
            }
            this.send(io.parser.encodePayload(msgs))
        };
        XHR.prototype.send = function(data) {
            this.post(data);
            return this
        };

        function empty() {}
        XHR.prototype.post = function(data) {
            var self = this;
            this.socket.setBuffer(true);

            function stateChange() {
                if (this.readyState == 4) {
                    this.onreadystatechange = empty;
                    self.posting = false;
                    if (this.status == 200) {
                        self.socket.setBuffer(false)
                    } else {
                        self.onClose()
                    }
                }
            }

            function onload() {
                this.onload = empty;
                self.socket.setBuffer(false)
            }
            this.sendXHR = this.request("POST");
            if (global.XDomainRequest && this.sendXHR instanceof XDomainRequest) {
                this.sendXHR.onload = this.sendXHR.onerror = onload
            } else {
                this.sendXHR.onreadystatechange = stateChange
            }
            this.sendXHR.send(data)
        };
        XHR.prototype.close = function() {
            this.onClose();
            return this
        };
        XHR.prototype.request = function(method) {
            var req = io.util.request(this.socket.isXDomain()),
                query = io.util.query(this.socket.options.query, "t=" + +new Date);
            req.open(method || "GET", this.prepareUrl() + query, true);
            if (method == "POST") {
                try {
                    if (req.setRequestHeader) {
                        req.setRequestHeader("Content-type", "text/plain;charset=UTF-8")
                    } else {
                        req.contentType = "text/plain"
                    }
                } catch (e) {}
            }
            return req
        };
        XHR.prototype.scheme = function() {
            return this.socket.options.secure ? "https" : "http"
        };
        XHR.check = function(socket, xdomain) {
            try {
                var request = io.util.request(xdomain),
                    usesXDomReq = (global.XDomainRequest && request instanceof XDomainRequest),
                    socketProtocol = (socket && socket.options && socket.options.secure ? "https:" : "http:"),
                    isXProtocol = (global.location && socketProtocol != global.location.protocol);
                if (request && !(usesXDomReq && isXProtocol)) {
                    return true
                }
            } catch (e) {}
            return false
        };
        XHR.xdomainCheck = function(socket) {
            return XHR.check(socket, true)
        }
    })("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports, this);
    (function(exports, io) {
        exports.htmlfile = HTMLFile;

        function HTMLFile() {
            io.Transport.XHR.apply(this, arguments)
        }
        io.util.inherit(HTMLFile, io.Transport.XHR);
        HTMLFile.prototype.name = "htmlfile";
        HTMLFile.prototype.get = function() {
            this.doc = new window[(["Active"].concat("Object").join("X"))]("htmlfile");
            this.doc.open();
            this.doc.write("<html></html>");
            this.doc.close();
            this.doc.parentWindow.s = this;
            var iframeC = this.doc.createElement("div");
            iframeC.className = "socketio";
            this.doc.body.appendChild(iframeC);
            this.iframe = this.doc.createElement("iframe");
            iframeC.appendChild(this.iframe);
            var self = this,
                query = io.util.query(this.socket.options.query, "t=" + +new Date);
            this.iframe.src = this.prepareUrl() + query;
            io.util.on(window, "unload", function() {
                self.destroy()
            })
        };
        HTMLFile.prototype._ = function(data, doc) {
            data = data.replace(/\\\//g, "/");
            this.onData(data);
            try {
                var script = doc.getElementsByTagName("script")[0];
                script.parentNode.removeChild(script)
            } catch (e) {}
        };
        HTMLFile.prototype.destroy = function() {
            if (this.iframe) {
                try {
                    this.iframe.src = "about:blank"
                } catch (e) {}
                this.doc = null;
                this.iframe.parentNode.removeChild(this.iframe);
                this.iframe = null;
                CollectGarbage()
            }
        };
        HTMLFile.prototype.close = function() {
            this.destroy();
            return io.Transport.XHR.prototype.close.call(this)
        };
        HTMLFile.check = function(socket) {
            if (typeof window != "undefined" && (["Active"].concat("Object").join("X")) in window) {
                try {
                    var a = new window[(["Active"].concat("Object").join("X"))]("htmlfile");
                    return a && io.Transport.XHR.check(socket)
                } catch (e) {}
            }
            return false
        };
        HTMLFile.xdomainCheck = function() {
            return false
        };
        io.transports.push("htmlfile")
    })("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports);
    (function(exports, io, global) {
        exports["xhr-polling"] = XHRPolling;

        function XHRPolling() {
            io.Transport.XHR.apply(this, arguments)
        }
        io.util.inherit(XHRPolling, io.Transport.XHR);
        io.util.merge(XHRPolling, io.Transport.XHR);
        XHRPolling.prototype.name = "xhr-polling";
        XHRPolling.prototype.heartbeats = function() {
            return false
        };
        XHRPolling.prototype.open = function() {
            var self = this;
            io.Transport.XHR.prototype.open.call(self);
            return false
        };

        function empty() {}
        XHRPolling.prototype.get = function() {
            if (!this.isOpen) {
                return
            }
            var self = this;

            function stateChange() {
                if (this.readyState == 4) {
                    this.onreadystatechange = empty;
                    if (this.status == 200) {
                        self.onData(this.responseText);
                        self.get()
                    } else {
                        self.onClose()
                    }
                }
            }

            function onload() {
                this.onload = empty;
                this.onerror = empty;
                self.retryCounter = 1;
                self.onData(this.responseText);
                self.get()
            }

            function onerror() {
                self.retryCounter++;
                if (!self.retryCounter || self.retryCounter > 3) {
                    self.onClose()
                } else {
                    self.get()
                }
            }
            this.xhr = this.request();
            if (global.XDomainRequest && this.xhr instanceof XDomainRequest) {
                this.xhr.onload = onload;
                this.xhr.onerror = onerror
            } else {
                this.xhr.onreadystatechange = stateChange
            }
            this.xhr.send(null)
        };
        XHRPolling.prototype.onClose = function() {
            io.Transport.XHR.prototype.onClose.call(this);
            if (this.xhr) {
                this.xhr.onreadystatechange = this.xhr.onload = this.xhr.onerror = empty;
                try {
                    this.xhr.abort()
                } catch (e) {}
                this.xhr = null
            }
        };
        XHRPolling.prototype.ready = function(socket, fn) {
            var self = this;
            io.util.defer(function() {
                fn.call(self, socket)
            })
        };
        io.transports.push("xhr-polling")
    })("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports, this);
    (function(exports, io, global) {
        var indicator = global.document && "MozAppearance" in global.document.documentElement.style;
        exports["jsonp-polling"] = JSONPPolling;

        function JSONPPolling() {
            io.Transport["xhr-polling"].apply(this, arguments);
            this.index = io.j.length;
            var self = this;
            io.j.push(function(msg) {
                self._(msg)
            })
        }
        io.util.inherit(JSONPPolling, io.Transport["xhr-polling"]);
        JSONPPolling.prototype.name = "jsonp-polling";
        JSONPPolling.prototype.post = function(data) {
            var self = this,
                query = io.util.query(this.socket.options.query, "t=" + (+new Date) + "&i=" + this.index);
            if (!this.form) {
                var form = document.createElement("form"),
                    area = document.createElement("textarea"),
                    id = this.iframeId = "socketio_iframe_" + this.index,
                    iframe;
                form.className = "socketio";
                form.style.position = "absolute";
                form.style.top = "0px";
                form.style.left = "0px";
                form.style.display = "none";
                form.target = id;
                form.method = "POST";
                form.setAttribute("accept-charset", "utf-8");
                area.name = "d";
                form.appendChild(area);
                document.body.appendChild(form);
                this.form = form;
                this.area = area
            }
            this.form.action = this.prepareUrl() + query;

            function complete() {
                initIframe();
                self.socket.setBuffer(false)
            }

            function initIframe() {
                if (self.iframe) {
                    self.form.removeChild(self.iframe)
                }
                try {
                    iframe = document.createElement('<iframe name="' + self.iframeId + '">')
                } catch (e) {
                    iframe = document.createElement("iframe");
                    iframe.name = self.iframeId
                }
                iframe.id = self.iframeId;
                self.form.appendChild(iframe);
                self.iframe = iframe
            }
            initIframe();
            this.area.value = io.JSON.stringify(data);
            try {
                this.form.submit()
            } catch (e) {}
            if (this.iframe.attachEvent) {
                iframe.onreadystatechange = function() {
                    if (self.iframe.readyState == "complete") {
                        complete()
                    }
                }
            } else {
                this.iframe.onload = complete
            }
            this.socket.setBuffer(true)
        };
        JSONPPolling.prototype.get = function() {
            var self = this,
                script = document.createElement("script"),
                query = io.util.query(this.socket.options.query, "t=" + (+new Date) + "&i=" + this.index);
            if (this.script) {
                this.script.parentNode.removeChild(this.script);
                this.script = null
            }
            script.async = true;
            script.src = this.prepareUrl() + query;
            script.onerror = function() {
                self.onClose()
            };
            var insertAt = document.getElementsByTagName("script")[0];
            insertAt.parentNode.insertBefore(script, insertAt);
            this.script = script;
            if (indicator) {
                setTimeout(function() {
                    var iframe = document.createElement("iframe");
                    document.body.appendChild(iframe);
                    document.body.removeChild(iframe)
                }, 100)
            }
        };
        JSONPPolling.prototype._ = function(msg) {
            this.onData(msg);
            if (this.isOpen) {
                this.get()
            }
            return this
        };
        JSONPPolling.prototype.ready = function(socket, fn) {
            var self = this;
            if (!indicator) {
                return fn.call(this)
            }
            io.util.load(function() {
                fn.call(self)
            })
        };
        JSONPPolling.check = function() {
            return "document" in global
        };
        JSONPPolling.xdomainCheck = function() {
            return true
        };
        io.transports.push("jsonp-polling")
    })("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports, this);
    if (typeof define === "function" && define.amd) {
        define([], function() {
            return io
        })
    }
}());

},{}],18:[function(require,module,exports){
(function (process){
var Config = require('./config');
'use strict';


var isServer = typeof(window) === 'undefined',
    w = isServer ? {} : window,
    performance = typeof(w.performance) !== 'undefined' ? w.performance : {},
    defineProperty = Object.defineProperty,
    START_MS = Date.now(),
    START = START_MS * 0.001,
    DELTA = 1 / 60,
    FIXED_DELTA = DELTA,
    GLOBAL_FIXED = DELTA,
    SCALE = 1,
    DateNow;


if (isServer) {
    var HR_TIME = process.hrtime();

    DateNow = function () {
        var hrtime = process.hrtime(HR_TIME),
            s = hrtime[0] * 1000,
            ns = hrtime[1] * 1e-6;

        return s + ns;
    }
} else {
    DateNow = function () {
        return Date.now() - START_MS;
    }
}


performance.now || (performance.now = (
performance.webkitNow ||
performance.mozNow ||
performance.msNow ||
performance.oNow ||
DateNow
));

function now() {

    return performance.now() * 0.001;
}


function Time() {

    this.start = START;
    this.sinceStart = 0;
    this.time = 0;
    this.fps = 60;
    this.delta = DELTA;
    this.frameCount = 0;

    defineProperty(this, 'scale', {
        get: function () {
            return SCALE;
        },
        set: function (value) {
            SCALE = value;
            FIXED_DELTA = GLOBAL_FIXED * value
        }
    });

    defineProperty(this, 'fixedDelta', {
        get: function () {
            return FIXED_DELTA;
        },
        set: function (value) {
            GLOBAL_FIXED = value;
            FIXED_DELTA = GLOBAL_FIXED * SCALE;
        }
    });
}


Time.prototype.now = now;


Time.prototype.stamp = function () {

    return Date.now() * 0.001;
};


Time.prototype.stampMS = function () {

    return Date.now();
};


var frameCount = 0,
    last = -1 / 60,
    time = 0,
    delta = 1 / 60,
    fpsFrame = 0,
    fpsLast = 0,
    fpsTime = 0;

Time.prototype.update = function () {
    var MIN_DELTA = Config.MIN_DELTA,
        MAX_DELTA = Config.MAX_DELTA;

    this.frameCount = frameCount++;

    last = time;
    time = now();
    this.sinceStart = time;

    fpsTime = time;
    fpsFrame++;

    if (fpsLast + 1 < fpsTime) {
        this.fps = fpsFrame / (fpsTime - fpsLast);

        fpsLast = fpsTime;
        fpsFrame = 0;
    }

    delta = (time - last) * SCALE;
    this.delta = delta < MIN_DELTA ? MIN_DELTA : delta > MAX_DELTA ? MAX_DELTA : delta;

    this.time = time * SCALE;
};


module.exports = new Time;

}).call(this,require('_process'))
},{"./config":9,"_process":6}],19:[function(require,module,exports){
(function (process,Buffer){
"use strict";


var util = {},
    random = Math.random,

    isServer = typeof(window) === "undefined",
    cwd = isServer ? process.cwd() : window.location.href.match(/.*\//)[0],

    ObjectProto = Object.prototype,
    toString = ObjectProto.toString,
    hasOwnProperty = ObjectProto.hasOwnProperty,

    ArrayProto = Array.prototype,
    ArrayForEach = ArrayProto.forEach,

    keys = Object.keys || (Object.keys = function (obj) {
            var out = [],
                key;

            for (key in obj) {
                if (hasOwnProperty.call(obj, key)) out.push(key);
            }
            return out;
        }),

    isArray = Array.isArray || (Array.isArray = function (obj) {
            return toString.call(obj) === "[object Array]";
        }),

    SPILTER = /[ \_\-\.]+|(?=[A-Z][^A-Z])/g,
    UNDERSCORE = /([a-z])([A-Z])/g,
    FORMAT_REGEX = /%[sdj%]/g;

function isObject(obj) {

    return obj === Object(obj);
}
util.isObject = isObject;


function isArrayLike(obj) {

    return typeof(obj) === "object" && typeof(obj.length) === "number";
}
util.isArrayLike = isArrayLike;
util.isArray = isArray;


function isArguments(obj) {

    return toString.call(obj) === "[object Arguments]";
}
util.isArguments = isArguments;


function isFunction(obj) {

    return typeof(obj) === "function"
}
util.isFunction = isFunction;


function isString(obj) {

    return toString.call(obj) === "[object String]";
}
util.isString = isString;


function isNumber(obj) {

    return toString.call(obj) === "[object Number]";
}
util.isNumber = isNumber;


function isDecimal(obj) {

    return isNumber(obj) && obj % 1 !== 0;
}
util.isDecimal = isDecimal;


function isInteger(obj) {

    return isNumber(obj) && obj % 1 === 0;
}
util.isInteger = isInteger;


function isDate(obj) {

    return toString.call(obj) === "[object Date]";
}
util.isDate = isDate;


function isRegExp(obj) {

    return toString.call(obj) === "[object RegExp]";
}
util.isRegExp = isRegExp;


util.isFinite = isFinite;


util.isNaN = isNaN;


function isBoolean(obj) {

    return obj === true || obj === false || toString.call(obj) === "[object Boolean]";
}
util.isBoolean = isBoolean;


function isNull(obj) {

    return obj === null;
}
util.isNull = isNull;


function isUndefined(obj) {

    return obj === void 0;
}
util.isUndefined = isUndefined;


function has(obj, key) {

    return hasOwnProperty.call(obj, key);
}
util.has = has;


function format(fmt) {
    var i = 1,
        args = arguments,
        len = args.length;

    return String(fmt).replace(FORMAT_REGEX, function (x) {
        if (x === "%%") return "%";
        if (i >= len) return x;

        if (x === "%s") {
            return String(args[i++]);
        } else if (x === "%d") {
            return Number(args[i++]);
        } else if (x === "%j") {
            try {
                return JSON.stringify(args[i++]);
            } catch (e) {
                return "[Circular]";
            }
        } else {
            return x;
        }
    });
}
util.format = format;


function camelize(word, lowFirstLetter) {
    var parts = word.split(SPILTER),
        string = "",
        part, i, il;

    for (i = 0, il = parts.length; i < il; i++) {
        part = parts[i];
        string += part[0].toUpperCase() + part.slice(1).toLowerCase();
    }

    return lowFirstLetter ? string[0].toLowerCase() + string.slice(1) : string;
};
util.camelize = camelize;


function underscore(word) {

    return word.replace(SPILTER, "").replace(UNDERSCORE, "$1_$2").toLowerCase();
};
util.underscore = underscore;


function merge(obj, add) {
    var key;

    for (key in add) {
        if (obj[key] == undefined) obj[key] = add[key];
    }

    return obj;
};
util.merge = merge;


function override(obj, add) {
    var key;

    for (key in add) {
        if (add[key] != undefined) obj[key] = add[key];
    }

    return obj;
};
util.override = override;


function copy(obj, out) {
    var type = typeof(obj),
        key, i, il;

    if (type !== "object") return obj;

    if (isArrayLike(obj)) {
        out = [];
        for (i = 0, il = obj.length; i < il; i++) out[i] = copy(obj[i]);
    } else if (isObject(obj)) {
        out = {};
        for (key in obj) out[key] = copy(obj[key]);
    }

    return out;
};
util.copy = copy;


function clear(obj) {
    var key;

    for (key in obj) delete obj[key];

    return obj;
};
util.clear = clear;


util.keys = keys;


function arrayBufferToBase64(buffer) {
    var binary = "",
        bytes = new Uint8Array(buffer),
        len = bytes.byteLength,
        i = 0;

    for (; i < len; i++) binary += String.fromCharCode(bytes[i]);

    return isServer ? new Buffer(binary.toString(), "binary").toString("base64") : window.btoa(binary);
}
util.arrayBufferToBase64 = arrayBufferToBase64;


function base64ToArrayBuffer(str) {
    var binary = isServer ? new Buffer(str, "base64").toString("binary") : window.atob(str),
        len = binary.length,
        bytes = new Uint8Array(len).
            i = 0;

    for (; i < len; i++) bytes[i] = str.charCodeAt(i);

    return bytes.buffer;
}
util.base64ToArrayBuffer = base64ToArrayBuffer;


function uid() {
    return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(UID_REPLACER, function (c) {
        var a = 16 * random() | 0;
        return ("x" == c ? a : a & 3 | 8).toString(16);
    })
}
var UID_REPLACER = /[xy]/g;
util.uid = uid;


function each(obj, iterator, ctx) {
    if (obj == null) return;

    if (ArrayForEach && obj.forEach === ArrayForEach) {
        obj.forEach(iterator, ctx);
    } else if (obj.length === +obj.length) {
        for (var i = 0, length = obj.length; i < length; i++) {
            if (iterator.call(ctx, obj[i], i, obj) === false) return;
        }
    } else {
        var objKeys = keys(obj);

        for (var i = 0, length = objKeys.length; i < length; i++) {
            if (iterator.call(ctx, obj[objKeys[i]], objKeys[i], obj) === false) return;
        }
    }
}
util.each = each;


function normalizePath(path) {
    var parts = path.split("/"),
        directories = [],
        i = 0,
        il = parts.length,
        prev, directory;

    for (; i < il; i++) {
        directory = parts[i];

        if (directory === "" && i !== 0 && i !== il) continue;
        if (directory === "." && prev !== undefined) continue;
        if (directories.length === 1 && directories[0] === "" && (directory === "." || directory === "..")) continue;

        if (directory === ".." && directories.length && prev !== ".." && prev !== "." && prev !== undefined && (prev !== "")) {
            directories.pop();
            prev = directories[0];
        } else {
            if (prev === ".") directories.pop();
            directories.push(directory);
            prev = directory;
        }
    }
    if ((path = directories[0]) && path.indexOf(":") === path.length - 1) directories[0] += "/";

    return directories.join("/");
}
util.normalizePath = normalizePath;


function relativePath(path) {
    path || (path = "./");
    return normalizePath(require.toUrl(path));
}
util.relativePath = relativePath;


function absolutePath(path) {
    path || (path = "./");
    return normalizePath(cwd + require.toUrl(path));
}
util.absolutePath = absolutePath;


if (!isServer) {
    util.createWorker = function (fn) {
        var blobURL = URL.createObjectURL(
                new Blob([
                    "(function() {\n" +
                    "importScripts(\"" + absolutePath("odin/require.js") + "\");\n" +
                    "require.config({baseUrl: \"" + absolutePath("./") + "\"});\n" +
                    "(" + fn.toString() + ").call(this);\n" +
                    "}).call(this);"
                ], {
                    type: "application/javascript"
                })
            ),
            worker = new Worker(blobURL);

        URL.revokeObjectURL(blobURL);

        return worker;
    };

    util.ajax = function ajax(opts) {
        opts || (opts = {});
        var request = new XMLHttpRequest,
            src = opts.src,
            method = opts.method || (opts.method = "GET"),
            before = opts.before,
            success = opts.success,
            error = opts.error,
            async = opts.async != undefined ? !!opts.async : true;

        request.addEventListener("load", function () {
            var status = this.status;

            if ((status > 199 && status < 301) || status == 304) {
                if (typeof(success) === "function") success.call(this);
            } else {
                if (typeof(error) === "function") {
                    error.call(this, new Error(method + " " + src + " " + status));
                } else {
                    throw new Error(method + " " + src + " " + status);
                }
            }
        }, false);
        request.addEventListener("error", function () {
            if (typeof(error) === "function") {
                error(new Error(method + " " + src));
            } else {
                throw new Error(method + " " + src);
            }
        }, false);

        request.open(method, src, async);
        if (typeof(before) === "function") before.call(request);
        request.send();
    };
}


module.exports = util;

}).call(this,require('_process'),require("buffer").Buffer)
},{"_process":6,"buffer":2}],20:[function(require,module,exports){
var Log = require("../../base/log");
var Class = require("../../base/class");
"use strict";


var defineProperty = Object.defineProperty;


function Asset(opts) {
    opts || (opts = {});

    Class.call(this);

    this._name = opts.name != undefined ? opts.name : "Asset_" + this._id;
    this._loaded = false;

    this.json = opts.json != undefined ? !!opts.json : true;

    this.assets = undefined;
    this.load = opts.load != undefined ? !!opts.load : !!opts.src;
    this.src = opts.src;
    this.raw = opts.raw;
}

Class.extend(Asset);


defineProperty(Asset.prototype, "name", {
    get: function () {
        return this._name;
    },
    set: function (value) {
        var assets = this.assets,
            hash;

        if (assets) {
            hash = assets.hash;

            if (hash[value]) {
                Log.warn("Asset.set name: can't change name to " + value + " Assets already have an asset with same name");
                return;
            }

            delete hash[this.name];
            hash[value] = this;
        }

        this._name = value;
    }
});


Asset.prototype.copy = function (other) {

    this.sync = other.sync;
    this.json = other.json;

    this.name = other.name + "." + this._id;
    this.src = other.src;
    this.raw = other.raw;

    if (other.assets && this.assets !== other.assets) other.assets.addAsset(this);

    return this;
};


Asset.prototype.clear = function () {

    this.raw = null;
    return this;
};


Asset.prototype.destroy = function () {
    if (!this.assets) {
        Log.error("Asset.destroy: can't destroy Asset if it's not added to Assets");
        return this;
    }

    this.assets.removeAsset(this);
    this.clear();

    return this;
};


Asset.prototype.parse = function (raw) {

    this.raw = raw;
    return this;
};


Asset.prototype.toJSON = function (json, pack) {
    json = Class.prototype.toJSON.call(this, json);

    json.name = this.name;
    if (!pack) json.src = this.src;

    return json;
};


Asset.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);

    this.name = json.name;
    this.src = json.src;

    return this;
};


module.exports = Asset;

},{"../../base/class":8,"../../base/log":14}],21:[function(require,module,exports){
var Device = require("../../base/device");
var util = require("../../base/util");
var EventEmitter = require("../../base/event_emitter");
var AudioCtx = require("../../base/audio_ctx");
var Asset = require("./asset");
var Assets = require("./assets");
var Log = require("../../base/log");
"use strict";


var isArray = util.isArray,
    ajax = util.ajax,
    each = util.each;


function getExt(src) {

    return src ? (src.split(".").pop()).toLowerCase() : "none";
};


function AssetLoader() {

    EventEmitter.call(this);

    var supports = this.supports = ["json", "jpeg", "jpg", "png", "gif"];

    if (Device.audioMpeg) supports.push("mpeg");
    if (Device.audioOgg || Device.videoOgg) supports.push("ogg");
    if (Device.audioMp3) supports.push("mp3");
    if (Device.audioMp4 || Device.videoMp4) supports.push("mp4");
}

EventEmitter.extend(AssetLoader);


AssetLoader.prototype.load = function (reload) {
    var _this = this,
        count = Assets.length,
        i = count,
        fn = function (err) {
            if (err) Log.error(err);

            count--;
            if (count <= 0) _this.emit("load");
        };

    if (!count) this.emit("load");
    while (i--) this.loadAsset(Assets[i], fn, reload, true);
};


AssetLoader.prototype.loadAsset = function (asset, callback, reload, known) {
    var _this = this,
        supports = this.supports,
        src = asset.src;

    if (!known || Assets.indexOf(asset) === -1) Assets.addAsset(asset);

    if (!asset.load || !src || asset.raw && !reload) {
        asset._loaded = true;
        callback && callback()
        return;
    }
    ;

    if (isArray(src)) {
        var raw = [],
            exts = [],
            loaded = src.length,
            hasExt = false;

        each(src, function (s, i) {
            var ext = getExt(s);
            exts.push(ext);

            if (!this[ext]) {
                callback && callback(new Error("AssetLoader.load: has no loader for " + src + " of type " + ext));
                return false;
            }

            this[ext](s, function (err, data) {
                loaded--;
                raw[i] = data;

                if (err) Log.error(err);

                if (loaded <= 0) {
                    for (var j = exts.length; j--;) {
                        if (supports.indexOf(exts[i]) !== -1) {
                            hasExt = true;
                            break;
                        }
                    }

                    if (!hasExt) {
                        callback && callback(new Error("AssetLoader.load: device does not support any of the given file types " + exts));
                        return;
                    }

                    asset._loaded = true;
                    asset.parse(raw);
                    asset.emit("load", raw);
                    _this.emit("loadAsset", asset);
                    callback && callback();
                }
            });

            return true;
        }, this);
    } else {
        var ext = getExt(src);

        if (!this[ext]) {
            callback && callback(new Error("AssetLoader.load: has no loader file " + src + " of type " + ext));
            return;
        }
        if (supports.indexOf(ext) === -1) {
            callback && callback(new Error("AssetLoader.load: device does not support file " + src + " of type " + ext));
            return;
        }

        this[ext](src, function (err, raw) {
            if (err) {
                callback && callback(new Error("AssetLoader.load: " + err.message));
                return;
            }

            asset._loaded = true;
            asset.parse(raw);
            asset.emit("load", raw);
            _this.emit("loadAsset", asset);
            callback && callback();
        });
    }
};


AssetLoader.prototype.gif = AssetLoader.prototype.jpg = AssetLoader.prototype.jpeg = AssetLoader.prototype.png = function (src, callback) {
    var image = new Image;

    image.onload = function () {
        callback && callback(null, image);
    };
    image.onerror = function () {
        callback && callback(new Error("GET " + src + " 404 (Not Found)"));
    };

    image.src = src;
};


AssetLoader.prototype.json = function (src, callback) {

    ajax({
        src: src,
        before: function () {
            this.setRequestHeader("Content-Type", "application/json");
        },
        success: function () {
            var json = this.responseText;

            try {
                json = JSON.parse(this.responseText);
            } catch (err) {
                callback && callback(err);
                return;
            }

            callback && callback(null, json);
        },
        error: function (err) {
            callback && callback(err);
        }
    });
};


AssetLoader.prototype.ogg = AssetLoader.prototype.wav = AssetLoader.prototype.mp3 = AssetLoader.prototype.aac = function (src, callback) {

    ajax({
        src: src,
        before: function () {
            this.responseType = "arraybuffer";
        },
        success: function () {
            if (AudioCtx) {
                if (AudioCtx.decodeAudioData) {
                    AudioCtx.decodeAudioData(
                        this.response,
                        function success(buffer) {
                            callback && callback(null, buffer);
                        },
                        function failure() {
                            callback && callback(new Error("AudioContext Failed to parse Audio Clip"));
                        }
                    );
                } else {
                    var buffer = AudioCtx.createBuffer(this.response, false);

                    if (buffer) {
                        callback && callback(null, buffer);
                    } else {
                        callback && callback(new Error("AudioContext Failed to parse Audio Clip"));
                    }
                }
            } else {
                callback && callback(new Error("AudioContext (WebAudio API) is not supported by this browser"));
            }
        },
        error: function (err) {
            callback && callback(err);
        }
    });
};


module.exports = new AssetLoader;

},{"../../base/audio_ctx":7,"../../base/device":10,"../../base/event_emitter":13,"../../base/log":14,"../../base/util":19,"./asset":20,"./assets":22}],22:[function(require,module,exports){
var Class = require("../../base/class");
var Asset = require("./asset");
var Log = require("../../base/log");
"use strict";


function Assets() {

    Array.call(this);

    this.hash = {};
}

Assets.prototype = Object.create(Array.prototype);
Assets.prototype.constructor = Assets;


Assets.prototype.get = function (name) {
    var asset = this.hash[name];
    if (asset) return asset;

    Log.error("Assets.get: can't find asset with name " + name + ", it has not been added to Assets, use Assets.addAsset(asset)");
    return undefined;
};


Assets.prototype.addAsset = function (asset) {
    if (!(asset instanceof Asset)) {
        Log.error("Assets.addAsset: can't add passed argument, it is not an instance of Asset");
        return this;
    }
    var name = asset.name;

    if (this.hash[name]) {
        Log.error("Assets.addAsset: Assets already have Asset named " + asset.name);
        return undefined;
    }

    asset.assets = this;
    this.push(asset);
    this.hash[name] = asset;

    return asset;
};


Assets.prototype.addAssets = function () {
    var i, il;

    for (i = 0, il = arguments.length; i < il; i++) this.addAsset(arguments[i]);
};


Assets.prototype.removeAsset = function (asset) {
    var name = typeof(asset) === "string" ? asset : asset.name;
    asset = this.hash[name];

    if (!asset) {
        Log.error("Assets.removeAsset: Assets does not have an Asset named " + name);
        return undefined;
    }

    this.splice(this.indexOf(asset), 1);
    this.hash[name] = null;

    return asset;
};


Assets.prototype.removeAssets = function () {
    var i, il;

    for (i = 0, il = arguments.length; i < il; i++) this.removeAsset(arguments[i]);
};


Assets.prototype.toJSON = function (json, pack) {
    json || (json = {});
    var jsonAssets = json.assets || (json.assets = []),
        jsonAsset,
        i = this.length;

    while (i--) {
        if ((jsonAsset = this[i]).json) jsonAssets[i] = jsonAsset.toJSON(jsonAssets[i], pack);
    }

    return json;
};


Assets.prototype.fromJSON = function (json) {
    var assetsHash = this.hash,
        jsonAssets = json.assets || (json.assets = []),
        asset, jsonAsset,
        i = jsonAssets.length;

    while (i--) {
        if (!(jsonAsset = jsonAssets[i])) continue;

        if ((asset = assetsHash[jsonAsset.name])) {
            asset.fromJSON(jsonAsset);
        } else {
            this.add(Class.fromJSON(jsonAsset));
        }
    }

    return this;
};


module.exports = new Assets;

},{"../../base/class":8,"../../base/log":14,"./asset":20}],23:[function(require,module,exports){
var util = require("../../base/util");
var AudioCtx = require("../../base/audio_ctx");
var Asset = require("./asset");
"use strict";


var isArray = util.isArray,
    defineProperty = Object.defineProperty,
    arrayBufferToBase64 = util.arrayBufferToBase64,
    base64ToArrayBuffer = util.base64ToArrayBuffer;


function AudioClip(opts) {
    opts || (opts = {});

    Asset.call(this, opts);
}

Asset.extend(AudioClip);


defineProperty(AudioClip.prototype, "length", {
    get: function () {
        return this.raw ? this.raw.duration : 0;
    }
});


defineProperty(AudioClip.prototype, "samples", {
    get: function () {
        return this.raw ? this.raw.length : 0;
    }
});


defineProperty(AudioClip.prototype, "frequency", {
    get: function () {
        return this.raw ? this.raw.sampleRate : 44100;
    }
});


defineProperty(AudioClip.prototype, "channels", {
    get: function () {
        return this.raw ? this.raw.numberOfChannels : 0;
    }
});


AudioClip.prototype.parse = function (raw) {
    Asset.prototype.parse.call(this, raw);
    var i;

    if (isArray(raw)) {
        i = raw.length;
        while (i--) {
            if (raw[i]) this.raw = raw[i];
        }
    }

    return this;
};


AudioClip.prototype.getData = function (array, offset) {
    array || (array = []);

    return this.raw ? this.raw.getChannelData(array, offset) : array;
};


AudioClip.prototype.toJSON = function (json, pack) {
    json = Asset.prototype.toJSON.call(this, json, pack);

    if ((pack || !this.src) && this.raw) json.raw = arrayBufferToBase64(this.raw);

    return json;
};


AudioClip.prototype.fromJSON = function (json, pack) {
    Asset.prototype.fromJSON.call(this, json, pack);

    if ((pack || !this.src) && this.raw) this.raw = base64ToArrayBuffer(json.raw);

    return this;
};


module.exports = AudioClip;

},{"../../base/audio_ctx":7,"../../base/util":19,"./asset":20}],24:[function(require,module,exports){
var util = require("../../base/util");
var Rect = require("../../math/rect");
var Vec3 = require("../../math/vec3");
var Color = require("../../math/color");
var Asset = require("./asset");
var Assets = require("./assets");
var Enums = require("../enums");
"use strict";


var merge = util.merge;


function Material(opts) {
    opts || (opts = {});

    Asset.call(this, opts);

    this.blending = opts.blending != undefined ? opts.blending : Enums.Blending.Default;
    this.side = opts.side != undefined ? opts.side : Enums.Side.Front;

    this.wireframe = opts.wireframe != undefined ? opts.wireframe : false;
    this.wireframeLineWidth = opts.wireframeLineWidth != undefined ? opts.wireframeLineWidth : 1.0;

    this.shader = opts.shader != undefined ? opts.shader : undefined;

    this.uniforms = merge(opts.uniforms || {}, {
        diffuseColor: new Color(1.0, 1.0, 1.0),
        shininess: 8.0,
        normalScale: 1.0
    });

    this.receiveShadow = opts.receiveShadow != undefined ? !!opts.receiveShadow : true;
    this.castShadow = opts.castShadow != undefined ? !!opts.castShadow : true;

    this.needsUpdate = true;
}

Asset.extend(Material);


Material.prototype.copy = function (other) {
    Asset.prototype.copy.call(this, other);

    this.blending = other.blending;
    this.side = other.side;

    this.wireframe = other.wireframe;
    this.wireframeLineWidth = other.wireframeLineWidth;

    this.shader = other.shader;

    this.uniforms = copy(other.uniforms);

    this.receiveShadow = other.receiveShadow;
    this.castShadow = other.castShadow;

    return this;
};


Material.prototype.parse = function (raw) {
    Asset.prototype.parse.call(this, raw);

    this.fromJSON(raw);

    return this;
};


Material.prototype.clear = function () {
    Asset.prototype.clear.call(this);

    return this;
};


Material.prototype.toJSON = function (json, pack) {
    json = Asset.prototype.toJSON.call(this, json, pack);

    json.blending = this.blending;
    json.side = this.side;

    json.wireframe = this.wireframe;
    json.wireframeLineWidth = this.wireframeLineWidth;

    json.shader = this.shader != undefined ? this.shader.name : undefined;

    toJSON(this.uniforms, json.uniforms || (json.uniforms = {}));

    json.receiveShadow = this.receiveShadow;
    json.castShadow = this.castShadow;

    return json;
};


Material.prototype.fromJSON = function (json) {
    Asset.prototype.fromJSON.call(this, json);

    this.blending = json.blending;
    this.side = json.side;

    this.wireframe = json.wireframe;
    this.wireframeLineWidth = json.wireframeLineWidth;

    this.shader = json.shader != undefined ? Assets.get(json.shader) : undefined;

    fromJSON(this.uniforms, json.uniforms);

    this.receiveShadow = json.receiveShadow;
    this.castShadow = json.castShadow;

    return this;
};


function toJSON(obj, json) {
    var value, key;

    for (key in obj) {
        value = obj[key];

        if (typeof(value) !== "object") {
            json[key] = value;
        } else if (value.toJSON) {
            json[key] = value.toJSON(json[key]);
        } else {
            json[key] = value;
        }
    }

    return json;
}


function fromJSON(obj, json) {
    var classes = Class._classes,
        mathClasses = Mathf._classes,
        value, key;

    for (key in json) {
        value = json[key];

        if (typeof(value) !== "object") {
            obj[key] = value;
        } else if (mathClasses[value._className]) {
            obj[key] = Mathf.fromJSON(value);
        } else if (classes[value._className]) {
            obj[key] = Class.fromJSON(value);
        } else {
            obj[key] = value;
        }
    }
}


function copy(obj) {
    var out = {},
        classes = Class._classes,
        mathClasses = Mathf._classes,
        value, key;

    for (key in obj) {
        value = obj[key];

        if (typeof(value) !== "object") {
            out[key] = value;
        } else if (mathClasses[value._className]) {
            out[key] = new mathClasses[value._className]().copy(value);
        } else if (classes[value._className]) {
            out[key] = new classes[value._className]().copy(value);
        } else {
            out[key] = value;
        }
    }

    return out;
}


module.exports = Material;

},{"../../base/util":19,"../../math/color":102,"../../math/rect":109,"../../math/vec3":112,"../enums":73,"./asset":20,"./assets":22}],25:[function(require,module,exports){
var Asset = require("./asset");
var MeshBone = require("./mesh_bone");
var Vec2 = require("../../math/vec2");
var Vec3 = require("../../math/vec3");
var Vec4 = require("../../math/vec4");
var Color = require("../../math/color");
"use strict";


function Mesh(opts) {
    opts || (opts = {});

    Asset.call(this, opts);

    this.vertices = opts.vertices != undefined ? opts.vertices : [];

    this.normals = opts.normals != undefined ? opts.normals : [];

    this.tangents = opts.tangents != undefined ? opts.tangents : [];

    this.indices = opts.indices != undefined ? opts.indices : [];

    this.colors = opts.colors != undefined ? opts.colors : [];

    this.uvs = opts.uvs != undefined ? opts.uvs : [];
    this.uvs2 = opts.uvs2 != undefined ? opts.uvs2 : [];

    this.bones = opts.bones != undefined ? opts.bones : [];
    this.boneIndices = opts.boneIndices != undefined ? opts.boneIndices : [];
    this.boneWeights = opts.boneWeights != undefined ? opts.boneWeights : [];

    this.dynamic = opts.dynamic != undefined ? !!opts.dynamic : false;
    this.useBones = opts.useBones != undefined ? !!opts.useBones : this.bones.length > 0 ? true : false;

    this.animations = {};

    this.aabb = new AABB3;
    if (opts.vertices) this.aabb.fromPoints(this.vertices);

    this.verticesNeedUpdate = true;
    this.normalsNeedUpdate = true;
    this.tangentsNeedUpdate = true;
    this.indicesNeedUpdate = true;
    this.colorsNeedUpdate = true;
    this.uvsNeedUpdate = true;
    this.uvs2NeedUpdate = true;

    this.boneIndicesNeedUpdate = true;
    this.boneWeightsNeedUpdate = true;

    this._webglBuffersInitted = undefined;
    this._webglUsed = 0;

    this._webglVertexBuffer = undefined;
    this._webglNormalBuffer = undefined;
    this._webglTangentBuffer = undefined;
    this._webglColorBuffer = undefined;
    this._webglUvBuffer = undefined;
    this._webglUv2Buffer = undefined;

    this._webglMeshBoneIndexBuffer = undefined;
    this._webglMeshBoneWeightBuffer = undefined;

    this._webglIndexBuffer = undefined;
    this._webglLineBuffer = undefined;

    this._webglVertexArray = undefined;
    this._webglNormalArray = undefined;
    this._webglTangentArray = undefined;
    this._webglColorArray = undefined;
    this._webglUvArray = undefined;
    this._webglUv2Array = undefined;

    this._webglMeshBoneIndexArray = undefined;
    this._webglMeshBoneWeightArray = undefined;

    this._webglIndexArray = undefined;
    this._webglLineArray = undefined;

    this._webglVertexCount = undefined;
    this._webglLineCount = undefined;

    if (opts.json) this.fromJSON(opts.json);
}

Asset.extend(Mesh);


Mesh.prototype.copy = function (other) {
    Asset.prototype.copy.call(this, other);
    var vertices = this.vertices,
        otherVertices = other.vertices,
        normals = this.normals,
        otherNormals = other.normals,
        tangents = this.tangents,
        otherTangents = other.tangents,
        indices = this.indices,
        otherIndices = other.indices,
        colors = this.colors,
        otherColors = other.colors,
        uvs = this.uvs,
        otherUvs = other.uvs,
        uvs2 = this.uvs2,
        otherUv2s = other.uvs2,
        bones = this.bones,
        otherMeshBones = other.bones,
        boneIndices = this.boneIndices,
        otherMeshBoneIndices = other.boneIndices,
        boneWeights = this.boneWeights,
        otherMeshBoneWeights = other.boneWeights,
        i;

    vertices.length = otherVertices.length;
    normals.length = otherNormals.length;
    tangents.length = otherTangents.length;
    indices.length = otherIndices.length;
    colors.length = otherColors.length;
    uvs.length = otherUvs.length;
    uvs2.length = otherUv2s.length;

    bones.length = otherMeshBones.length;
    boneIndices.length = otherMeshBoneIndices.length;
    boneWeights.length = otherMeshBoneWeights.length;

    for (i = otherVertices.length; i--;) vertices[i] = (vertices[i] || new Vec3).copy(otherVertices[i]);
    for (i = otherNormals.length; i--;) normals[i] = (normals[i] || new Vec3).copy(otherNormals[i]);
    for (i = otherTangents.length; i--;) tangents[i] = (tangents[i] || new Vec4).copy(otherTangents[i]);
    for (i = otherIndices.length; i--;) indices[i] = otherIndices[i];
    for (i = otherColors.length; i--;) colors[i] = (colors[i] || new Color).copy(otherColors[i]);
    for (i = otherUvs.length; i--;) uvs[i] = (uvs[i] || new Vec2).copy(otherUvs[i]);
    for (i = otherUv2s.length; i--;) uvs2[i] = (uvs2[i] || new Vec2).copy(otherUv2s[i]);
    for (i = otherMeshBones.length; i--;) bones[i] = (bones[i] || new MeshBone).copy(otherMeshBones[i]);
    for (i = otherMeshBoneIndices.length; i--;) boneIndices[i] = otherMeshBoneIndices[i];
    for (i = otherMeshBoneWeights.length; i--;) boneWeights[i] = otherMeshBoneWeights[i];

    this.dynamic = other.dynamic;
    this.useBones = other.useBones;

    this.aabb.fromPoints(this.vertices);

    this.verticesNeedUpdate = true;
    this.normalsNeedUpdate = true;
    this.tangentsNeedUpdate = true;
    this.indicesNeedUpdate = true;
    this.colorsNeedUpdate = true;
    this.uvsNeedUpdate = true;
    this.uvs2NeedUpdate = true;
    this.boneIndicesNeedUpdate = true;
    this.boneWeightsNeedUpdate = true;

    return this;
};


Mesh.prototype.clear = function () {
    Asset.prototype.clear.call(this);

    this.vertices.length = 0;
    this.normals.length = 0;
    this.tangents.length = 0;
    this.indices.length = 0;
    this.colors.length = 0;
    this.uvs.length = 0;
    this.uvs2.length = 0;

    this.bones.length = 0;
    this.boneIndices.length = 0;
    this.boneWeights.length = 0;

    this.aabb.clear();

    this.verticesNeedUpdate = true;
    this.normalsNeedUpdate = true;
    this.tangentsNeedUpdate = true;
    this.indicesNeedUpdate = true;
    this.colorsNeedUpdate = true;
    this.uvsNeedUpdate = true;
    this.uvs2NeedUpdate = true;
    this.boneIndicesNeedUpdate = true;
    this.boneWeightsNeedUpdate = true;

    return this;
};


var EMPTY_ARRAY = [];

Mesh.prototype.parse = function (raw) {
    Asset.prototype.parse.call(this, raw);
    var vertices = this.vertices,
        normals = this.normals,
        tangents = this.tangents,
        indices = this.indices,
        colors = this.colors,
        uvs = this.uvs,
        uvs2 = this.uvs2,
        bones = this.bones,
        boneWeights = this.boneWeights,
        boneIndices = this.boneIndices,
        bone, items, item,
        i, il;

    vertices.length = normals.length = tangents.length = indices.length = colors.length = uvs.length = uvs2.length = 0;
    bones.length = boneWeights.length = boneIndices.length = 0;

    items = raw.vertices || EMPTY_ARRAY;
    for (i = 0, il = items.length; i < il; i += 3) vertices.push(new Vec3(items[i], items[i + 1], items[i + 2]));

    items = raw.normals || EMPTY_ARRAY;
    for (i = 0, il = items.length; i < il; i += 3) normals.push(new Vec3(items[i], items[i + 1], items[i + 2]));

    items = raw.tangents || EMPTY_ARRAY;
    for (i = 0, il = items.length; i < il; i += 4) tangents.push(new Vec4(items[i], items[i + 1], items[i + 2], items[i + 3]));

    items = raw.indices || raw.faces || EMPTY_ARRAY;
    for (i = 0, il = items.length; i < il; i += 3) indices.push(items[i], items[i + 1], items[i + 2]);

    items = raw.colors || EMPTY_ARRAY;
    for (i = 0, il = items.length; i < il; i += 3) colors.push(new Color(items[i], items[i + 1], items[i + 2]));

    items = raw.uvs || EMPTY_ARRAY;
    for (i = 0, il = items.length; i < il; i += 2) uvs.push(new Vec2(items[i], items[i + 1]));

    items = raw.uvs2 || EMPTY_ARRAY;
    for (i = 0, il = items.length; i < il; i += 2) uvs2.push(new Vec2(items[i], items[i + 1]));

    items = raw.bones || EMPTY_ARRAY;
    for (i = 0, il = items.length; i < il; i++) {
        item = items[i];

        bone = new MeshBone(item.parent, item.name);

        bone.position.fromArray(item.position);
        bone.rotation.fromArray(item.rotation);
        bone.scale.fromArray(item.scale);
        bone.bindPose.fromArray(item.bindPose);
        bone.skinned = !!item.skinned;

        bones.push(bone);
    }
    if (items.length) this.useBones = true;

    items = raw.boneWeights || EMPTY_ARRAY;
    for (i = 0, il = items.length; i < il; i++) boneWeights.push(items[i]);

    items = raw.boneIndices || EMPTY_ARRAY;
    for (i = 0, il = items.length; i < il; i++) boneIndices.push(items[i]);

    this.animations = raw.animations;

    this.aabb.fromPoints(this.vertices);

    this.verticesNeedUpdate = true;
    this.normalsNeedUpdate = true;
    this.tangentsNeedUpdate = true;
    this.indicesNeedUpdate = true;
    this.colorsNeedUpdate = true;
    this.uvsNeedUpdate = true;
    this.uvs2NeedUpdate = true;
    this.boneIndicesNeedUpdate = true;
    this.boneWeightsNeedUpdate = true;

    return this;
};


Mesh.prototype.transformMat3 = function (m) {
    var vertices = this.vertices,
        normals = this.normals,
        i;

    if (vertices) {
        i = vertices.length;
        while (i--) vertices[i].transformMat3(m);
        this.verticesNeedUpdate = true;
    }
    if (normals) {
        i = normals.length;
        while (i--) normals[i].transformMat3(m);
        this.normalsNeedUpdate = true;
    }

    return this;
};


Mesh.prototype.transformMat4 = function (m) {
    var vertices = this.vertices,
        normals = this.normals,
        i;

    if (vertices) {
        i = vertices.length;
        while (i--) vertices[i].transformMat4(m);
        this.verticesNeedUpdate = true;
    }
    if (normals) {
        i = normals.length;
        while (i--) normals[i].transformMat4Rotation(m);
        this.normalsNeedUpdate = true;
    }

    return this;
};


Mesh.prototype.calculateAABB = function () {

    this.aabb.fromPoints(this.vertices);
    return this;
};


Mesh.prototype.calculateNormals = function () {
    var u = new Vec3,
        v = new Vec3,
        uv = new Vec3,
        faceNormal = new Vec3;

    return function () {
        var vertices = this.vertices,
            normals = this.normals,
            indices = this.indices,
            a, b, c, va, vb, vc, i;

        for (i = vertices.length; i--;)(normals[i] || (normals[i] = new Vec3)).set(0, 0, 0);

        for (i = indices.length; i -= 3;) {
            a = indices[i];
            b = indices[i + 1];
            c = indices[i + 2];

            va = vertices[a];
            vb = vertices[b];
            vc = vertices[c];

            u.vsub(vc, vb);
            v.vsub(va, vb);

            uv.vcross(u, v);

            faceNormal.copy(uv).normalize();

            normals[a].add(faceNormal);
            normals[b].add(faceNormal);
            normals[c].add(faceNormal);
        }

        for (i = indices.length; i -= 3;) {
            normals[indices[i]].normalize();
            normals[indices[i + 1]].normalize();
            normals[indices[i + 2]].normalize();
        }

        this.normalsNeedUpdate = true;

        return this;
    };
}();


Mesh.prototype.calculateTangents = function () {
    var tan1 = [],
        tan2 = [],
        sdir = new Vec3,
        tdir = new Vec3,
        n = new Vec3,
        t = new Vec3,
        tmp1 = new Vec3,
        tmp2 = new Vec3;

    return function () {
        var indices = this.indices,
            vertices = this.vertices,
            normals = this.normals,
            tangents = this.tangents,
            uvs = this.uvs,

            v1, v2, v3,
            w1, w2, w3,

            x1, x2, y1, y2, z1, z2,
            s1, s2, t1, t2,
            a, b, c,

            r, w, i;

        for (i = vertices.length; i--;) {
            (tan1[i] || (tan1[i] = new Vec3)).set(0, 0, 0);
            (tan2[i] || (tan2[i] = new Vec3)).set(0, 0, 0);
            (tangents[i] || (tangents[i] = new Vec4)).set(0, 0, 0, 1);
        }

        for (i = vertices.length; i--;) uvs[i] = uvs[i] || (uvs[i] = new Vec2);

        for (i = indices.length; i -= 3;) {
            a = indices[i];
            b = indices[i + 1];
            c = indices[i + 2];

            v1 = vertices[a];
            v2 = vertices[b];
            v3 = vertices[c];

            w1 = uvs[a];
            w2 = uvs[b];
            w3 = uvs[c];

            x1 = v2.x - v1.x;
            x2 = v3.x - v1.x;
            y1 = v2.y - v1.y;
            y2 = v3.y - v1.y;
            z1 = v2.z - v1.z;
            z2 = v3.z - v1.z;

            s1 = w2.x - w1.x;
            s2 = w3.x - w1.x;
            t1 = w2.y - w1.y;
            t2 = w3.y - w1.y;

            r = s1 * t2 - s2 * t1;
            r = r !== 0 ? 1 / r : 0;

            sdir.set(
                (t2 * x1 - t1 * x2) * r, (t2 * y1 - t1 * y2) * r, (t2 * z1 - t1 * z2) * r
            );

            tdir.set(
                (s1 * x2 - s2 * x1) * r, (s1 * y2 - s2 * y1) * r, (s1 * z2 - s2 * z1) * r
            );

            tan1[a].add(sdir);
            tan1[b].add(sdir);
            tan1[c].add(sdir);

            tan2[a].add(tdir);
            tan2[b].add(tdir);
            tan2[c].add(tdir);
        }

        for (i = vertices.length; i--;) {
            t.copy(tan1[i]);
            n.copy(normals[i]);

            tmp1.copy(t);
            tmp1.sub(n.smul(n.dot(t))).normalize();

            n.copy(normals[i]);
            tmp2.vcross(n, t);

            w = (tmp2.dot(tan2[i]) < 0) ? -1 : 1;

            tangents[i].set(tmp1.x, tmp1.y, tmp1.z, w);
        }

        this.tangentsNeedUpdate = true;

        return this;
    };
}();


Mesh.prototype.toJSON = function (json, pack) {
    json = Asset.prototype.toJSON.call(this, json, pack);
    var vertices = this.vertices,
        jsonVertices = json.vertices || (json.vertices = []),
        normals = this.normals,
        jsonNormals = json.normals || (json.normals = []),
        tangents = this.tangents,
        jsonTangents = json.tangents || (json.tangents = []),
        indices = this.indices,
        jsonIndices = json.indices || (json.indices = []),
        colors = this.colors,
        jsonColors = json.colors || (json.colors = []),
        uvs = this.uvs,
        jsonUvs = json.uvs || (json.uvs = []),
        uvs2 = this.uvs2,
        jsonUv2s = json.uvs2 || (json.uvs2 = []),
        bones = this.bones,
        jsonMeshBones = json.bones || (json.bones = []),
        boneIndices = this.boneIndices,
        jsonMeshBoneIndices = json.boneIndices || (json.boneIndices = []),
        boneWeights = this.boneWeights,
        jsonMeshBoneWeights = json.boneWeights || (json.boneWeights = []),
        i;

    jsonVertices.length = vertices.length;
    jsonNormals.length = normals.length;
    jsonTangents.length = tangents.length;
    jsonIndices.length = indices.length;
    jsonColors.length = colors.length;
    jsonUvs.length = uvs.length;
    jsonUv2s.length = uvs2.length;

    jsonMeshBones.length = bones.length;
    jsonMeshBoneIndices.length = boneIndices.length;
    jsonMeshBoneWeights.length = boneWeights.length;

    for (i = vertices.length; i--;) jsonVertices[i] = vertices[i].toJSON(jsonVertices[i]);
    for (i = normals.length; i--;) jsonNormals[i] = normals[i].toJSON(jsonNormals[i]);
    for (i = tangents.length; i--;) jsonTangents[i] = tangents[i].toJSON(jsonTangents[i]);
    for (i = indices.length; i--;) indices[i] = jsonIndices[i];
    for (i = colors.length; i--;) jsonColors[i] = colors[i].toJSON(jsonColors[i]);
    for (i = uvs.length; i--;) jsonUvs[i] = uvs[i].toJSON(jsonUvs[i]);
    for (i = uvs2.length; i--;) jsonUv2s[i] = uvs2[i].toJSON(jsonUv2s[i]);
    for (i = bones.length; i--;) jsonMeshBones[i] = bones[i].toJSON(jsonMeshBones[i]);
    for (i = boneIndices.length; i--;) boneIndices[i] = jsonMeshBoneIndices[i];
    for (i = boneWeights.length; i--;) boneWeights[i] = jsonMeshBoneWeights[i];

    json.dynamic = this.dynamic;
    json.useBones = this.useBones;

    return json;
};


Mesh.prototype.fromJSON = function (json) {
    Asset.prototype.fromJSON.call(this, json);
    var vertices = this.vertices,
        jsonVertices = json.vertices,
        normals = this.normals,
        jsonNormals = json.normals,
        tangents = this.tangents,
        jsonTangents = json.tangents,
        indices = this.indices,
        jsonIndices = json.indices,
        colors = this.colors,
        jsonColors = json.colors,
        uvs = this.uvs,
        jsonUvs = json.uvs,
        uvs2 = this.uvs2,
        jsonUv2s = json.uvs2,
        bones = this.bones,
        jsonMeshBones = json.bones,
        boneIndices = this.boneIndices,
        jsonMeshBoneIndices = json.boneIndices,
        boneWeights = this.boneWeights,
        jsonMeshBoneWeights = json.boneWeights,
        i;

    vertices.length = jsonVertices.length;
    normals.length = jsonNormals.length;
    tangents.length = jsonTangents.length;
    indices.length = jsonIndices.length;
    colors.length = jsonColors.length;
    uvs.length = jsonUvs.length;
    uvs2.length = jsonUv2s.length;

    bones.length = jsonMeshBones.length;
    boneIndices.length = jsonMeshBoneIndices.length;
    boneWeights.length = jsonMeshBoneWeights.length;

    for (i = jsonVertices.length; i--;) vertices[i] = (vertices[i] || new Vec3).copy(jsonVertices[i]);
    for (i = jsonNormals.length; i--;) normals[i] = (normals[i] || new Vec3).copy.fromJSON(jsonNormals[i]);
    for (i = jsonTangents.length; i--;) tangents[i] = (tangents[i] || new Vec4).fromJSON(jsonTangents[i]);
    for (i = jsonIndices.length; i--;) indices[i] = jsonIndices[i];
    for (i = jsonColors.length; i--;) colors[i] = (colors[i] || new Color).fromJSON(jsonColors[i]);
    for (i = jsonUvs.length; i--;) uvs[i] = (uvs[i] || new Vec2).fromJSON(jsonUvs[i]);
    for (i = jsonUv2s.length; i--;) uvs2[i] = (uvs2[i] || new Vec2).fromJSON(jsonUv2s[i]);
    for (i = jsonMeshBones.length; i--;) bones[i] = (bones[i] || new MeshBone).fromJSON(jsonMeshBones[i]);
    for (i = jsonMeshBoneIndices.length; i--;) boneIndices[i] = jsonMeshBoneIndices[i];
    for (i = jsonMeshBoneWeights.length; i--;) boneWeights[i] = jsonMeshBoneWeights[i];

    this.dynamic = json.dynamic;
    this.useBones = json.useBones;

    this.aabb.fromPoints(this.vertices);

    this.verticesNeedUpdate = true;
    this.normalsNeedUpdate = true;
    this.tangentsNeedUpdate = true;
    this.indicesNeedUpdate = true;
    this.colorsNeedUpdate = true;
    this.uvsNeedUpdate = true;
    this.uvs2NeedUpdate = true;
    this.boneIndicesNeedUpdate = true;
    this.boneWeightsNeedUpdate = true;

    return this;
};


var PI = Math.PI,
    HALF_PI = PI * 0.5,
    TWO_PI = PI * 2,
    sin = Math.sin,
    cos = Math.cos;
Mesh.Sphere = function (opts) {
    opts || (opts = {});
    var radius = opts.radius != undefined ? opts.radius : 0.5,
        segments = (opts.segments != undefined ? floor(max(opts.segments, 3)) : 16) + 1,
        rings = (opts.rings != undefined ? floor(max(opts.rings, 3)) : 8) + 2,

        R = 1 / (rings - 1),
        S = 1 / (segments - 1),
        r, s,
        x, y, z,
        a, b, c, d,

        mesh = new Mesh(opts),
        vertices = mesh.vertices,
        normals = mesh.normals,
        uvs = mesh.uvs,
        colors = mesh.colors,
        indices = mesh.indices;

    for (r = 0; r < rings; r++) {
        for (s = 0; s < segments; s++) {
            z = sin(-HALF_PI + PI * r * R);
            x = cos(TWO_PI * s * S) * sin(PI * r * R);
            y = sin(TWO_PI * s * S) * sin(PI * r * R);

            vertices.push(new Vec3(x, y, z).smul(radius));
            normals.push(new Vec3(x, y, z));
            uvs.push(new Vec2(s * S, r * R));
            colors.push(new Vec3(s * S, r * R, 0));
        }
    }

    for (r = 0; r < rings - 1; r++) {
        for (s = 0; s < segments - 1; s++) {
            a = r * segments + s;
            b = r * segments + (s + 1);
            c = (r + 1) * segments + (s + 1);
            d = (r + 1) * segments + s;

            indices.push(a, b, c);
            indices.push(a, c, d);
        }
    }

    mesh.calculateAABB();
    mesh.load = false;
    if (opts.tangents) mesh.calculateTangents();

    return mesh;
};


Mesh.Cube = function (opts) {
    opts || (opts = {});
    var w = opts.width || 1,
        h = opts.height || 1,
        d = opts.depth || 1,
        hw = w * 0.5,
        hh = h * 0.5,
        hd = d * 0.5,
        ws = (opts.widthSegments || 1),
        hs = (opts.heightSegments || 1),
        ds = (opts.depthSegments || 1),
        mesh = new Mesh(opts);

    buildPlane(mesh, "z", "y", -1, 1, d, ds, h, hs, hw, ws);
    buildPlane(mesh, "z", "y", 1, 1, d, ds, h, hs, -hw, ws);
    buildPlane(mesh, "x", "z", 1, -1, w, ws, d, ds, hh, hs);
    buildPlane(mesh, "x", "z", 1, 1, w, ws, d, ds, -hh, hs);
    buildPlane(mesh, "x", "y", 1, 1, w, ws, h, hs, hd, ds);
    buildPlane(mesh, "x", "y", -1, 1, w, ws, h, hs, -hd, ds);

    mesh.calculateAABB();
    mesh.load = false;
    if (opts.tangents) mesh.calculateTangents();

    return mesh;
};


Mesh.Plane = function (opts) {
    opts || (opts = {});
    var w = opts.width || 1,
        h = opts.height || 1,
        ws = (opts.widthSegments || 1),
        hs = (opts.heightSegments || 1),
        mesh = new Mesh(opts);

    buildPlane(mesh, "x", "y", 1, 1, w, ws, h, hs, 0, 0);

    mesh.calculateAABB();
    mesh.load = false;
    if (opts.tangents) mesh.calculateTangents();

    return mesh;
};


function buildPlane(mesh, u, v, udir, vdir, width, ws, height, hs, depth, ds) {
    var vertices = mesh.vertices,
        normals = mesh.normals,
        indices = mesh.indices,
        uvs = mesh.uvs,
        gridX = ws,
        gridY = hs,
        width_half = width / 2,
        height_half = height / 2,
        offset = vertices.length,
        w, ix, iy;

    if ((u === "x" && v === "z") || (u === "z" && v === "x")) {
        w = "y";
        gridY = ds;
    } else if ((u === "x" && v === "y") || (u === "y" && v === "x")) {
        w = "z";
    } else if ((u === "y" && v === "z") || (u === "z" && v === "y")) {
        w = "x";
        gridX = ds;
    }

    var gridX1 = gridX + 1,
        gridY1 = gridY + 1,
        segment_width = width / gridX,
        segment_height = height / gridY,
        normal = new Vec3(),
        vertexCount = offset;

    normal[w] = depth > 0 ? 1 : -1;

    function addVertex(x, y, z) {
        var vector = new Vec3();
        vector[u] = x;
        vector[v] = y;
        vector[w] = z;
        vertices.push(vector);
    }

    for (iy = 0; iy < gridY; iy++) {
        for (ix = 0; ix < gridX; ix++) {
            addVertex(
                ((ix + 1) * segment_width - width_half) * udir, ((iy + 1) * segment_height - height_half) * vdir,
                depth
            );
            uvs.push(new Vec2((ix + 1) / gridX, 1 - (iy + 1) / gridY));

            addVertex(
                (ix * segment_width - width_half) * udir, ((iy + 1) * segment_height - height_half) * vdir,
                depth
            );
            uvs.push(new Vec2(ix / gridX, 1 - (iy + 1) / gridY));

            addVertex(
                (ix * segment_width - width_half) * udir, (iy * segment_height - height_half) * vdir,
                depth
            );
            uvs.push(new Vec2(ix / gridX, 1 - iy / gridY));

            addVertex(
                ((ix + 1) * segment_width - width_half) * udir, (iy * segment_height - height_half) * vdir,
                depth
            );
            uvs.push(new Vec2((ix + 1) / gridX, 1 - iy / gridY));

            indices.push(
                vertexCount, vertexCount + 1, vertexCount + 2,
                vertexCount, vertexCount + 2, vertexCount + 3
            );
            normals.push(normal.clone(), normal.clone(), normal.clone(), normal.clone());
            vertexCount += 4;
        }
    }
}


Mesh.MeshBone = MeshBone;


module.exports = Mesh;

},{"../../math/color":102,"../../math/vec2":111,"../../math/vec3":112,"../../math/vec4":113,"./asset":20,"./mesh_bone":26}],26:[function(require,module,exports){
var Vec3 = require("../../math/vec3");
var Quat = require("../../math/quat");
var Mat4 = require("../../math/mat4");
"use strict";


var UNKNOWN = 0;


function MeshBone(parentIndex, name) {

    this.parentIndex = parentIndex != undefined ? parentIndex : -1;
    this.name = name != undefined ? name : "MeshBone_" + UNKNOWN++;

    this.skinned = false;
    this.position = new Vec3;
    this.rotation = new Quat;
    this.scale = new Vec3;
    this.bindPose = new Mat4;
}


MeshBone.prototype.clone = function () {

    return new MeshBone().copy(this);
};


MeshBone.prototype.copy = function (other) {

    this.name = other.name;
    this.parentIndex = other.parentIndex;

    this.skinned = other.skinned;
    this.position.copy(other.position);
    this.rotation.copy(other.rotation);
    this.scale.copy(other.scale);
    this.bindPose.copy(other.bindPose);

    return this;
};


MeshBone.prototype.toJSON = function (json) {
    json || (json = {});

    json.name = this.name;
    json.parentIndex = this.parentIndex;

    json.skinned = this.skinned;
    json.position = this.position.toJSON(json.position);
    json.rotation = this.rotation.toJSON(json.rotation);
    json.scale = this.scale.toJSON(json.scale);
    json.bindPose = this.bindPose.toJSON(json.bindPose);

    return json;
};


MeshBone.prototype.fromJSON = function (json) {

    this.name = json.name;
    this.parentIndex = json.parentIndex;

    this.skinned = json.skinned;
    this.position.fromJSON(json.position);
    this.rotation.fromJSON(json.rotation);
    this.scale.fromJSON(json.scale);
    this.bindPose.fromJSON(json.bindPose);

    return this;
};


module.exports = MeshBone;

},{"../../math/mat4":106,"../../math/quat":108,"../../math/vec3":112}],27:[function(require,module,exports){
var Shader = require("../shader");
"use strict";


function Diffuse() {

    Shader.call(this, {
        name: "shader_diffuse",
        load: false,

        lights: true,
        specular: false,

        vertex: [
            "varying vec2 vUv;",

            "void main() {",
            "	vUv = uv;",
            "	gl_Position = projectionMatrix * mvPosition;",
            "}"
        ].join("\n"),

        fragment: [
            "uniform vec3 diffuseColor;",
            "uniform sampler2D diffuseMap;",

            "varying vec2 vUv;",

            "void main() {",
            "	vec3 diffuseLight = PixelLightNoSpec(normalize(vNormal));",

            "	vec4 finalColor = texture2D(diffuseMap, vUv);",
            "	finalColor.xyz *= diffuseColor;",

            "	gl_FragColor = vec4(diffuseLight * finalColor.xyz, finalColor.w);",
            "}"
        ].join("\n")
    });
}

Shader.extend(Diffuse);


module.exports = Diffuse;

},{"../shader":35}],28:[function(require,module,exports){
var Shader = require("../shader");
"use strict";


function NormalDiffuse() {

    Shader.call(this, {
        name: "shader_normal_diffuse",
        load: false,

        lights: true,
        specular: false,
        OES_standard_derivatives: true,

        vertex: [
            "varying vec2 vUv;",
            "varying vec3 vTangent;",
            "varying vec3 vBinormal;",

            "void main() {",
            "	#ifdef USE_SKINNING",
            "		vec4 boneTangent = boneMatrix * vec4( tangent.xyz, 0.0 );",
            "		vTangent = normalize( normalMatrix * boneTangent.xyz );",
            "	#else",
            "		vTangent = normalize( normalMatrix * tangent.xyz );",
            "	#endif",

            "	vUv = uv;",
            "	vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );",

            "	gl_Position = projectionMatrix * mvPosition;",
            "}"
        ].join("\n"),

        fragment: [
            "uniform vec3 diffuseColor;",
            "uniform sampler2D diffuseMap;",

            "uniform sampler2D normalMap;",
            "uniform float normalScale;",

            "varying vec2 vUv;",
            "varying vec3 vTangent;",
            "varying vec3 vBinormal;",

            "void main() {",
            "	vec3 normalTex = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;",
            "	normalTex.xy *= normalScale;",

            "	mat3 tsb = mat3( vTangent, vBinormal, vNormal );",
            "	vec3 normal = normalize(tsb * normalTex);",

            "	vec3 diffuseLight = PixelLightNoSpec(normal);",

            "	vec4 finalColor = texture2D(diffuseMap, vUv);",
            "	finalColor.xyz *= diffuseColor;",

            "	gl_FragColor = vec4(diffuseLight * finalColor.xyz, finalColor.w);",
            "}"
        ].join("\n")
    });
}

Shader.extend(NormalDiffuse);


module.exports = NormalDiffuse;

},{"../shader":35}],29:[function(require,module,exports){
var Shader = require("../shader");
"use strict";


function NormalSpecular() {

    Shader.call(this, {
        name: "shader_normal_specular",
        load: false,

        fallback: "specular",

        lights: true,
        OES_standard_derivatives: true,

        vertex: [
            "varying vec2 vUv;",
            "varying vec3 vTangent;",
            "varying vec3 vBinormal;",

            "void main() {",
            "	#ifdef USE_SKINNING",
            "		vec4 boneTangent = boneMatrix * vec4( tangent.xyz, 0.0 );",
            "		vTangent = normalize( normalMatrix * boneTangent.xyz );",
            "	#else",
            "		vTangent = normalize( normalMatrix * tangent.xyz );",
            "	#endif",

            "	vUv = uv;",
            "	vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );",

            "	gl_Position = projectionMatrix * mvPosition;",
            "}"
        ].join("\n"),

        fragment: [
            "uniform vec3 diffuseColor;",
            "uniform sampler2D diffuseMap;",

            "uniform sampler2D normalMap;",
            "uniform float normalScale;",

            "uniform float shininess;",

            "varying vec2 vUv;",
            "varying vec3 vTangent;",
            "varying vec3 vBinormal;",

            "void main() {",
            "	vec4 finalColor = texture2D(diffuseMap, vUv);",
            "	finalColor.xyz *= diffuseColor;",

            "	vec3 normalTex = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;",
            "	normalTex.xy *= normalScale;",

            "	mat3 tsb = mat3( vTangent, vBinormal, vNormal );",
            "	vec3 normal = normalize(tsb * normalTex);",

            "	vec3 diffuseLight, specularLight;",
            "	PixelLight(normal, vec3(finalColor.w), finalColor.w, shininess, diffuseLight, specularLight);",

            "	gl_FragColor = vec4(diffuseLight * finalColor.xyz + specularLight * finalColor.xyz, 1.0);",
            "}"
        ].join("\n")
    });
}

Shader.extend(NormalSpecular);


module.exports = NormalSpecular;

},{"../shader":35}],30:[function(require,module,exports){
var Shader = require("../shader");
"use strict";


function ParallexDiffuse() {

    Shader.call(this, {
        name: "shader_parallex_diffuse",
        load: false,

        lights: true,
        specular: false,
        OES_standard_derivatives: true,

        vertex: [
            "varying vec2 vUv;",
            "varying vec3 vTangent;",
            "varying vec3 vBinormal;",

            "void main() {",
            "	#ifdef USE_SKINNING",
            "		vec4 boneTangent = boneMatrix * vec4( tangent.xyz, 0.0 );",
            "		vTangent = normalize( normalMatrix * boneTangent.xyz );",
            "	#else",
            "		vTangent = normalize( normalMatrix * tangent.xyz );",
            "	#endif",

            "	vUv = uv;",
            "	vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );",

            "	gl_Position = projectionMatrix * mvPosition;",
            "}"
        ].join("\n"),

        fragment: [
            "uniform vec3 diffuseColor;",
            "uniform sampler2D diffuseMap;",

            "uniform sampler2D normalMap;",
            "uniform float normalScale;",

            "varying vec2 vUv;",
            "varying vec3 vTangent;",
            "varying vec3 vBinormal;",

            "void main() {",
            "	vec3 normalTex = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;",
            "	normalTex.xy *= normalScale;",

            "	mat3 tsb = mat3( vTangent, vBinormal, vNormal );",
            "	vec3 normal = normalize(tsb * normalTex);",

            "	vec3 diffuseLight = PixelLightNoSpec(normal);",

            "	vec4 finalColor = texture2D(diffuseMap, vUv);",
            "	finalColor.xyz *= diffuseColor;",

            "	gl_FragColor = vec4(diffuseLight * finalColor.xyz, finalColor.w);",
            "}"
        ].join("\n")
    });
}

Shader.extend(ParallexDiffuse);


module.exports = ParallexDiffuse;

},{"../shader":35}],31:[function(require,module,exports){
var Shader = require("../shader");
"use strict";


function Specular() {

    Shader.call(this, {
        name: "shader_specular",
        load: false,

        lights: true,

        vertex: [
            "varying vec2 vUv;",

            "void main() {",
            "	vUv = uv;",
            "	gl_Position = projectionMatrix * mvPosition;",
            "}"
        ].join("\n"),

        fragment: [
            "uniform vec3 diffuseColor;",
            "uniform sampler2D diffuseMap;",

            "uniform float shininess;",

            "varying vec2 vUv;",

            "void main() {",
            "	vec4 finalColor = texture2D(diffuseMap, vUv);",
            "	finalColor.xyz *= diffuseColor;",

            "	vec3 diffuseLight, specularLight;",
            "	PixelLight(normalize(vNormal), vec3(finalColor.w), finalColor.w, shininess, diffuseLight, specularLight);",

            "	gl_FragColor = vec4(diffuseLight * finalColor.xyz + specularLight * finalColor.xyz, 1.0);",
            "}"
        ].join("\n")
    });
}

Shader.extend(Specular);


module.exports = Specular;

},{"../shader":35}],32:[function(require,module,exports){
var Shader = require("../shader");
"use strict";


function Unlit() {

    Shader.call(this, {
        name: "shader_unlit",
        load: false,

        vertex: [
            "varying vec2 vUv;",

            "void main() {",
            "	vUv = uv;",
            "	gl_Position = projectionMatrix * mvPosition;",
            "}"
        ].join("\n"),

        fragment: [
            "uniform vec3 diffuseColor;",
            "uniform sampler2D diffuseMap;",

            "varying vec2 vUv;",

            "void main() {",
            "	vec4 finalColor = texture2D(diffuseMap, vUv);",
            "	finalColor.xyz *= diffuseColor;",

            "	gl_FragColor = finalColor;",
            "}"
        ].join("\n")
    });
}

Shader.extend(Unlit);


module.exports = Unlit;

},{"../shader":35}],33:[function(require,module,exports){
var Shader = require("../shader");
"use strict";


function ParticleUnlit() {

    Shader.call(this, {
        name: "shader_particle_unlit",

        vertex: [
            "void main() {",
            "	gl_Position = projectionMatrix * mvPosition;",
            "}"
        ].join("\n"),

        fragment: [
            "uniform sampler2D diffuseMap;",

            "void main() {",
            "	float c = cos(vAngle);",
            "	float s = sin(vAngle);",

            "	vec2 rotatedUV = vec2(c * (gl_PointCoord.x - 0.5) + s * (gl_PointCoord.y - 0.5) + 0.5,",
            "						  c * (gl_PointCoord.y - 0.5) - s * (gl_PointCoord.x - 0.5) + 0.5);",

            "	vec4 rotatedTexture = texture2D(diffuseMap, rotatedUV);",
            "	gl_FragColor = vec4(vParticleColor * rotatedTexture.xyz, vAlpha * rotatedTexture.w);",
            "}"
        ].join("\n")
    });
}

Shader.extend(ParticleUnlit);


module.exports = ParticleUnlit;

},{"../shader":35}],34:[function(require,module,exports){
var Shader = require("../shader");
"use strict";


function ReflectiveVertexLit() {

    Shader.call(this, {
        name: "shader_reflective_vertex_lit",
        load: false,

        lights: true,
        vertexLit: true,

        vertex: [
            "varying vec2 vUv;",
            "varying vec3 vReflect;",
            "varying vec3 vDiffuseLight;",

            "void main() {",
            "	vec3 worldNormal = normalize(mat3(modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz) * objectNormal);",
            "	vec3 cameraToVertex = normalize(worldPosition.xyz - cameraPosition);",

            "	vReflect = reflect(cameraToVertex, worldNormal);",
            "	vUv = uv;",
            "	VertexLight(transformedNormal, worldPosition.xyz, -mvPosition.xyz, vDiffuseLight);",

            "	gl_Position = projectionMatrix * mvPosition;",
            "}"
        ].join("\n"),

        fragment: [
            "uniform vec3 diffuseColor;",
            "uniform sampler2D diffuseMap;",
            "uniform samplerCube envMap;",

            "uniform float reflectivity;",
            "uniform int combine;",

            "varying vec2 vUv;",
            "varying vec3 vReflect;",
            "varying vec3 vDiffuseLight;",

            "void main() {",

            "	vec4 finalColor = texture2D(diffuseMap, vUv);",
            "	finalColor.xyz *= diffuseColor;",

            "	vec3 cubeColor = textureCube(envMap, vReflect).xyz;",

            "	if (combine == 1) {",
            "		finalColor.xyz = mix(finalColor.xyz, cubeColor, reflectivity);",
            "	} else if (combine == 2) {",
            "		finalColor.xyz += cubeColor * reflectivity;",
            "	} else {",
            "		finalColor.xyz = mix(finalColor.xyz, finalColor.xyz * cubeColor, reflectivity);",
            "	}",

            "	gl_FragColor = vec4(vDiffuseLight * finalColor.xyz, finalColor.w);",
            "}"
        ].join("\n")
    });
}

Shader.extend(ReflectiveVertexLit);


module.exports = ReflectiveVertexLit;

},{"../shader":35}],35:[function(require,module,exports){
var Asset = require("../asset");
"use strict";


function Shader(opts) {
    opts || (opts = {});

    Asset.call(this, opts);

    this.fallback = opts.fallback || "";

    this.vertex = opts.vertex || "void main(void) {}";
    this.fragment = opts.fragment || "void main(void) {}";

    this.lights = opts.lights != undefined ? opts.lights : false;
    this.specular = opts.specular != undefined ? opts.specular : true;
    this.vertexLit = opts.vertexLit != undefined ? opts.vertexLit : false;
    this.shadows = opts.shadows != undefined ? opts.shadows : false;
    this.fog = opts.fog != undefined ? opts.fog : false;

    this.OES_standard_derivatives = opts.OES_standard_derivatives != undefined ? opts.OES_standard_derivatives : false;
}

Asset.extend(Shader);


Shader.prototype.copy = function (other) {
    Asset.prototype.copy.call(this, other);

    this.fallback = other.fallback;

    this.vertex = other.vertex;
    this.fragment = other.fragment;

    this.lights = other.lights;
    this.specular = other.specular;
    this.vertexLit = other.vertexLit;
    this.shadows = other.shadows;
    this.fog = other.fog;

    this.OES_standard_derivatives = other.OES_standard_derivatives;

    return this;
};


Shader.prototype.parse = function (raw) {
    Asset.prototype.parse.call(this, raw);

    this.fromJSON(raw);

    return this;
};


Shader.prototype.clear = function () {
    Asset.prototype.clear.call(this);

    this.vertex = "";
    this.fragment = "";

    return this;
};


Shader.prototype.toJSON = function (json, pack) {
    json = Asset.prototype.toJSON.call(this, json, pack);

    json.fallback = this.fallback;

    json.vertex = this.vertex;
    json.fragment = this.fragment;

    json.lights = this.lights;
    json.specular = this.specular;
    json.vertexLit = this.vertexLit;
    json.shadows = this.shadows;
    json.fog = this.fog;

    json.OES_standard_derivatives = this.OES_standard_derivatives;

    return json;
};


Shader.prototype.fromJSON = function (json) {
    Asset.prototype.fromJSON.call(this, json);

    this.fallback = json.fallback;

    this.vertex = json.vertex;
    this.fragment = json.fragment;

    this.lights = json.lights;
    this.specular = json.specular;
    this.vertexLit = json.vertexLit;
    this.shadows = json.shadows;
    this.fog = json.fog;

    this.OES_standard_derivatives = json.OES_standard_derivatives;

    return this;
};


module.exports = Shader;

},{"../asset":20}],36:[function(require,module,exports){
var Unlit = require("./normal/unlit");
var VertexLit = require("./normal/specular");
var Diffuse = require("./normal/diffuse");
var Specular = require("./normal/specular");
var NormalDiffuse = require("./normal/normal_diffuse");
var NormalSpecular = require("./normal/normal_specular");
var ParallaxDiffuse = require("./normal/parallax_diffuse");
var ParticleUnlit = require("./particle/unlit");
var ReflectiveVertexLit = require("./reflective/reflective_vertex_lit");
"use strict";


module.exports = {
    Unlit: Unlit,
    VertexLit: VertexLit,
    Diffuse: Diffuse,
    Specular: Specular,
    NormalDiffuse: NormalDiffuse,
    NormalSpecular: NormalSpecular,
    ParallaxDiffuse: ParallaxDiffuse,

    ParticleUnlit: ParticleUnlit,

    ReflectiveVertexLit: ReflectiveVertexLit
};

},{"./normal/diffuse":27,"./normal/normal_diffuse":28,"./normal/normal_specular":29,"./normal/parallax_diffuse":30,"./normal/specular":31,"./normal/unlit":32,"./particle/unlit":33,"./reflective/reflective_vertex_lit":34}],37:[function(require,module,exports){
var Asset = require("./asset");
"use strict";


function SpriteSheet(opts) {
    opts || (opts = {});

    Asset.call(this, opts);
}

Asset.extend(SpriteSheet);


SpriteSheet.prototype.copy = function (other) {
    Asset.prototype.copy.call(this, other);
    var raw = other.raw,
        key;

    for (key in raw) this[key] = raw[key];

    return this;
};


SpriteSheet.prototype.parse = function (raw) {
    Asset.prototype.parse.call(this, raw);

    for (var key in raw) {
        if (!this[key]) {
            this[key] = raw[key];
        } else {
            Log.error("SpriteSheet.parse: invalid animation name " + key + " in file " + this.src);
        }
    }

    return this;
};


SpriteSheet.prototype.clear = function () {
    for (var key in this.raw) this[key] = null;
    Asset.prototype.clear.call(this);

    return this;
};


SpriteSheet.prototype.toJSON = function (json, pack) {
    json = Asset.prototype.toJSON.call(this, json);

    if ((pack || !this.src) && this.raw) json.raw = JSON.stringify(this.raw);

    return json;
};


SpriteSheet.prototype.fromJSON = function (json) {
    Asset.prototype.fromJSON.call(this, json);

    if (!json.src && json.raw) this.raw = JSON.parse(json.raw);
    this.parse(this.raw);

    return this;
};


module.exports = SpriteSheet;

},{"./asset":20}],38:[function(require,module,exports){
var Enums = require("../enums");
var Asset = require("./asset");
"use strict";


function Texture(opts) {
    opts || (opts = {});

    Asset.call(this, opts);

    this.width = 0;
    this.height = 0;

    this.invWidth = 0;
    this.invHeight = 0;

    this.generateMipmap = opts.generateMipmap != undefined ? !!opts.generateMipmap : true;
    this.flipY = opts.flipY != undefined ? !!opts.flipY : true;
    this.premultiplyAlpha = opts.premultiplyAlpha != undefined ? !!opts.premultiplyAlpha : false;

    this.anisotropy = opts.anisotropy != undefined ? opts.anisotropy : 1;

    this.filter = opts.filter != undefined ? opts.filter : Enums.FilterMode.Linear;
    this.format = opts.format != undefined ? opts.format : Enums.TextureFormat.RGBA;
    this.wrap = opts.wrap != undefined ? opts.wrap : Enums.TextureWrap.Repeat;

    this._webgl = undefined;
    this._webglUsed = 0;

    this.needsUpdate = true;
}

Asset.extend(Texture);


Texture.prototype.copy = function (other) {
    Asset.prototype.copy.call(this, other);

    this.width = other.width;
    this.height = other.height;

    this.invWidth = other.invWidth;
    this.invHeight = other.invHeight;

    this.generateMipmap = other.generateMipmap;
    this.flipY = other.flipY;
    this.premultiplyAlpha = other.premultiplyAlpha;

    this.anisotropy = other.anisotropy;

    this.filter = other.filter;
    this.format = other.format;
    this.wrap = other.wrap;

    return this;
};


Texture.prototype.parse = function (raw) {
    Asset.prototype.parse.call(this, raw);

    this.width = raw.width;
    this.height = raw.height;

    this.invWidth = 1 / this.width;
    this.invHeight = 1 / this.height;

    return this;
};


Texture.prototype.setMipmap = function (value) {

    this.generateMipmap = value != undefined ? !!value : !this.generateMipmap;
    this.needsUpdate = true;
};


Texture.prototype.setAnisotropy = function (value) {

    this.anisotropy = value;
    this.needsUpdate = true;
};


Texture.prototype.setFilter = function (value) {

    this.filter = value;
    this.needsUpdate = true;
};


Texture.prototype.setFormat = function (value) {

    this.format = value;
    this.needsUpdate = true;
};


Texture.prototype.setWrap = function (value) {

    this.wrap = value;
    this.needsUpdate = true;
};


Texture.prototype.toJSON = function (json, pack) {
    json = Asset.prototype.toJSON.call(this, json);

    if ((pack || !this.src) && this.raw) {
        if (typeof(window) === "undefined") {
            json.raw = this.raw;
        } else {
            var raw = this.raw,
                canvas = document.createElement("canvas"),
                ctx = canvas.getContext("2d");

            canvas.width = raw.width;
            canvas.height = raw.height;
            ctx.drawImage(raw, 0, 0);

            json.raw = canvas.toDataURL();
        }
    }

    json.width = this.width;
    json.height = this.height;

    json.invWidth = this.invWidth;
    json.invHeight = this.invHeight;

    json.generateMipmap = this.generateMipmap;
    json.flipY = this.flipY;
    json.premultiplyAlpha = this.premultiplyAlpha;

    json.anisotropy = this.anisotropy;

    json.filter = this.filter;
    json.format = this.format;
    json.wrap = this.wrap;

    return json;
};


Texture.prototype.fromJSON = function (json) {
    Asset.prototype.fromJSON.call(this, json);

    if (!json.src && json.raw) {
        if (typeof(window) === "undefined") {
            this.raw = json.raw;
        } else {
            var image = new Image;
            image.src = json.raw;
            this.raw = image;
        }
    }

    this.width = json.width;
    this.height = json.height;

    this.invWidth = json.invWidth;
    this.invHeight = json.invHeight;

    this.generateMipmap = json.generateMipmap;
    this.flipY = json.flipY;
    this.premultiplyAlpha = json.premultiplyAlpha;

    this.anisotropy = json.anisotropy;

    this.filter = json.filter;
    this.format = json.format;
    this.wrap = json.wrap;

    return this;
};


module.exports = Texture;

},{"../enums":73,"./asset":20}],39:[function(require,module,exports){
var Enums = require("../enums");
var Asset = require("./asset");
"use strict";


function TextureCube(opts) {
    opts || (opts = {});

    Asset.call(this, opts);

    this.mipmap = opts.mipmap != undefined ? !!opts.mipmap : true;
    this.flipY = opts.flipY != undefined ? !!opts.flipY : true;
    this.premultiplyAlpha = opts.premultiplyAlpha != undefined ? !!opts.premultiplyAlpha : false;

    this.anisotropy = opts.anisotropy != undefined ? opts.anisotropy : 1;

    this.filter = opts.filter != undefined ? opts.filter : Enums.FilterMode.Linear;
    this.format = opts.format != undefined ? opts.format : Enums.TextureFormat.RGBA;
    this.wrap = opts.wrap != undefined ? opts.wrap : Enums.TextureWrap.Repeat;

    this._webgl = undefined;
    this._webglUsed = 0;

    this.needsUpdate = true;
}

Asset.extend(TextureCube);


TextureCube.prototype.copy = function (other) {
    Asset.prototype.copy.call(this, other);

    this.mipmap = other.mipmap;
    this.flipY = other.flipY;
    this.premultiplyAlpha = other.premultiplyAlpha;

    this.anisotropy = other.anisotropy;

    this.filter = other.filter;
    this.format = other.format;
    this.wrap = other.wrap;

    return this;
};


TextureCube.prototype.setMipmap = function (value) {

    this.mipmap = value != undefined ? !!value : !this.mipmap;
    this.needsUpdate = true;
};


TextureCube.prototype.setAnisotropy = function (value) {

    this.anisotropy = value;
    this.needsUpdate = true;
};


TextureCube.prototype.setFilter = function (value) {

    this.filter = value;
    this.needsUpdate = true;
};


TextureCube.prototype.setFormat = function (value) {

    this.format = value;
    this.needsUpdate = true;
};


TextureCube.prototype.setWrap = function (value) {

    this.wrap = value;
    this.needsUpdate = true;
};


TextureCube.prototype.toJSON = function (json, pack) {
    json = Asset.prototype.toJSON.call(this, json);

    if ((pack || !this.src) && this.raw) {
        if (typeof(window) === "undefined") {
            json.raw = this.raw;
        } else {
            var jsonRaw = json.raw || (json.raw = []),
                raw = this.raw,
                i = 0,
                il = raw.length;

            for (; i < il; i++) jsonRaw[i] = imageToDataUrl(raw[i]);
        }
    }

    json.width = this.width;
    json.height = this.height;

    json.invWidth = this.invWidth;
    json.invHeight = this.invHeight;

    json.mipmap = this.mipmap;
    json.flipY = this.flipY;
    json.premultiplyAlpha = this.premultiplyAlpha;

    json.anisotropy = this.anisotropy;

    json.filter = this.filter;
    json.format = this.format;
    json.wrap = this.wrap;

    return json;
};


TextureCube.prototype.fromJSON = function (json) {
    Asset.prototype.fromJSON.call(this, json);

    if (!json.src && json.raw) {
        if (typeof(window) === "undefined") {
            this.raw = json.raw;
        } else {
            var jsonRaw = json.raw,
                raw = this.raw,
                i = 0,
                il = jsonRaw.length;

            for (; i < il; i++) {
                var image = new Image;
                image.src = sonRaw[i];
                raw[i] = image;
            }
        }
    }

    this.width = json.width;
    this.height = json.height;

    this.invWidth = json.invWidth;
    this.invHeight = json.invHeight;

    this.mipmap = json.mipmap;
    this.flipY = json.flipY;
    this.premultiplyAlpha = json.premultiplyAlpha;

    this.anisotropy = json.anisotropy;

    this.filter = json.filter;
    this.format = json.format;
    this.wrap = json.wrap;

    return this;
};


function imageToDataUrl(image) {
    if (typeof(window) === "undefined") return image;
    var canvas = document.createElement("canvas"),
        ctx = canvas.getContext("2d");

    canvas.width = image.width;
    canvas.height = image.height;
    ctx.drawImage(image, 0, 0);

    return canvas.toDataURL();
};


module.exports = TextureCube;

},{"../enums":73,"./asset":20}],40:[function(require,module,exports){
var ComponentManager = require("./component_manager");
"use strict";


function BoneComponentManager() {

    ComponentManager.call(this, 1000000);
}

ComponentManager.extend(BoneComponentManager);


BoneComponentManager.prototype.sortFunction = function (a, b) {

    return a.parentIndex - b.parentIndex;
};


module.exports = BoneComponentManager;

},{"./component_manager":43}],41:[function(require,module,exports){
var ComponentManager = require("./component_manager");
"use strict";


function Camera2DComponentManager() {

    ComponentManager.call(this);
}

ComponentManager.extend(Camera2DComponentManager);


Camera2DComponentManager.prototype.sortFunction = function (a, b) {

    return a._active ? 1 : b._active ? -1 : 0;
};


module.exports = Camera2DComponentManager;

},{"./component_manager":43}],42:[function(require,module,exports){
var ComponentManager = require("./component_manager");
"use strict";


function CameraComponentManager() {

    ComponentManager.call(this);
}

ComponentManager.extend(CameraComponentManager);


CameraComponentManager.prototype.sortFunction = function (a, b) {

    return a._active ? 1 : b._active ? -1 : 0;
};


module.exports = CameraComponentManager;

},{"./component_manager":43}],43:[function(require,module,exports){
var Class = require("../../base/class");
var Component = require("../components/component");
"use strict";


function ComponentManager(order) {

    Class.call(this);

    this.order = order || 0;

    this.scene = undefined;
    this.components = [];
}

Class.extend(ComponentManager);


ComponentManager.prototype.forEach = function (fn, ctx) {
    var components = this.components,
        i = 0,
        il = components.length;

    if (ctx) {
        for (; i < il; i++) fn.call(ctx, components[i], i, components);
    } else {
        for (; i < il; i++) fn(components[i], i, components);
    }
};


ComponentManager.prototype.start = function () {
    var components = this.components,
        i, il;

    for (i = 0, il = components.length; i < il; i++) components[i].start();
    for (i = 0, il = components.length; i < il; i++) components[i].emit("start");
};


ComponentManager.prototype.init = function () {
    var components = this.components,
        i, il;

    for (i = 0, il = components.length; i < il; i++) components[i].init();
    for (i = 0, il = components.length; i < il; i++) components[i].emit("init");
};


ComponentManager.prototype.update = function () {
    var components = this.components,
        i = 0,
        il = components.length,
        component;

    for (; i < il; i++)
        if ((component = components[i])) component.update();
};


ComponentManager.prototype.sort = function () {

    this.components.sort(this.sortFunction);
};


ComponentManager.prototype.sortFunction = function (a, b) {

    return a._id - b._id;
};


ComponentManager.prototype.empty = function () {

    return this.components.length === 0;
};


ComponentManager.prototype.add = function (component) {
    if (!(component instanceof Component)) {
        Log.error(this._className + ".add: can't add argument to " + this._className + ", it's not an instance of Component");
        return;
    }
    var components = this.components,
        index = components.indexOf(component);

    if (index === -1) {
        components.push(component);
    } else {
        Log.error(this._className + ".add: Component is already a member of " + this._className);
    }
};


ComponentManager.prototype.remove = function (component) {
    if (!(component instanceof Component)) {
        Log.error(this._className + ".remove: can't remove argument from " + this._className + ", it's not an instance of Component");
        return;
    }
    var components = this.components,
        index = components.indexOf(component);

    if (index !== -1) {
        components.splice(index, 1);
    } else {
        Log.error(this._className + ".remove: Component is not a member of " + this._className);
    }
};


module.exports = ComponentManager;

},{"../../base/class":8,"../components/component":54}],44:[function(require,module,exports){
var ComponentManager = require("./component_manager");
"use strict";


function LightComponentManager() {

    ComponentManager.call(this);
}

ComponentManager.extend(LightComponentManager);


LightComponentManager.prototype.sortFunction = function (a, b) {

    return a.type - b.type;
};


LightComponentManager.prototype.update = function () {

};


module.exports = LightComponentManager;

},{"./component_manager":43}],45:[function(require,module,exports){
var ComponentManager = require("./component_manager");
"use strict";


function MeshAnimationComponentManager() {

    ComponentManager.call(this, -999999);
}

ComponentManager.extend(MeshAnimationComponentManager);


module.exports = MeshAnimationComponentManager;

},{"./component_manager":43}],46:[function(require,module,exports){
var ComponentManager = require("./component_manager");
"use strict";


function MeshFilterComponentManager() {

    ComponentManager.call(this);
}

ComponentManager.extend(MeshFilterComponentManager);


MeshFilterComponentManager.prototype.sortFunction = function (a, b) {

    return a.mesh === b.mesh ? 1 : -1;
};


MeshFilterComponentManager.prototype.update = function () {

};


module.exports = MeshFilterComponentManager;

},{"./component_manager":43}],47:[function(require,module,exports){
var Class = require("../../base/class");
var Mathf = require("../../math/mathf");
var ComponentManager = require("./component_manager");
var Sprite = require("../components/sprite");
"use strict";


var clamp = Mathf.clamp;


function SpriteComponentManager() {

    Class.call(this);

    this.order = 0;

    this.scene = undefined;
    this.layers = [];
}

ComponentManager.extend(SpriteComponentManager);


SpriteComponentManager.prototype.forEach = function (fn, ctx) {
    var layers = this.layers,
        components, i, il, j, jl;

    if (ctx) {
        for (i = 0, il = layers.length; i < il; i++) {
            components = layers[i];
            if (!components) continue;
            for (j = 0, jl = components.length; j < jl; j++) fn.call(ctx, components[j], j, components);
        }
    } else {
        for (i = 0, il = layers.length; i < il; i++) {
            components = layers[i];
            if (!components) continue;
            for (j = 0, jl = components.length; j < jl; j++) fn(components[j], j, components);
        }
    }
};


SpriteComponentManager.prototype.init = function () {
    var layers = this.layers,
        components, i, il, j, jl;

    for (i = 0, il = layers.length; i < il; i++) {
        components = layers[i];
        if (!components) continue;

        for (j = 0, jl = components.length; j < jl; j++) components[j].init();
        for (j = 0, jl = components.length; j < jl; j++) components[j].emit("init");
    }
};


SpriteComponentManager.prototype.start = function () {
    var layers = this.layers,
        components, i, il, j, jl;

    for (i = 0, il = layers.length; i < il; i++) {
        components = layers[i];
        if (!components) continue;

        for (j = 0, jl = components.length; j < jl; j++) components[j].start();
        for (j = 0, jl = components.length; j < jl; j++) components[j].emit("start");
    }
};


SpriteComponentManager.prototype.update = function () {

};


SpriteComponentManager.prototype.sort = function () {
    var layers = this.layers,
        components, i, il;

    for (i = 0, il = layers.length; i < il; i++) {
        components = layers[i];
        if (!components) continue;

        components.sort(this.sortFunction);
    }
};


SpriteComponentManager.prototype.sortFunction = function (a, b) {

    return a.z - b.z;
};


SpriteComponentManager.prototype.empty = function () {
    var layers = this.layers,
        components, i, il,
        empty = true;

    for (i = 0, il = layers.length; i < il; i++) {
        components = layers[i];
        if (!components) continue;

        if (components.length !== 0) empty = false
    }

    return empty;
};


SpriteComponentManager.prototype.add = function (component) {
    if (!(component instanceof Sprite)) {
        Log.error("SpriteComponentManager.add: can't add argument to SpriteComponentManager, it's not an instance of Sprite");
        return;
    }
    var layers = this.layers,
        componentLayer = (component.layer = clamp(component.layer || 0, 0, 20)),
        components = layers[componentLayer] || (layers[componentLayer] = []),
        index = components.indexOf(component);

    if (index === -1) {
        components.push(component);
    } else {
        Log.error(this._className + ".add: Sprite is already a member of SpriteComponentManager");
    }
};


SpriteComponentManager.prototype.remove = function (component) {
    if (!(component instanceof Sprite)) {
        Log.error("SpriteComponentManager.remove: can't remove argument from SpriteComponentManager, it's not an instance of Sprite");
        return;
    }
    var layers = this.layers,
        componentLayer = (component.layer = clamp(component.layer || 0, 0, 20)),
        components = layers[componentLayer] || (layers[componentLayer] = []),
        index = components.indexOf(component);

    if (index !== -1) {
        components.splice(index, 1);
    } else {
        Log.error("SpriteComponentManager.remove: Sprite is not a member of SpriteComponentManager");
    }
};


module.exports = SpriteComponentManager;

},{"../../base/class":8,"../../math/mathf":107,"../components/sprite":69,"./component_manager":43}],48:[function(require,module,exports){
var ComponentManager = require("./component_manager");
"use strict";


function Transform2DComponentManager() {

    ComponentManager.call(this, 999999);
}

ComponentManager.extend(Transform2DComponentManager);


Transform2DComponentManager.prototype.sortFunction = function (a, b) {

    return a.depth - b.depth;
};


module.exports = Transform2DComponentManager;

},{"./component_manager":43}],49:[function(require,module,exports){
var ComponentManager = require("./component_manager");
"use strict";


function TransformComponentManager() {

    ComponentManager.call(this, 999999);
}

ComponentManager.extend(TransformComponentManager);


TransformComponentManager.prototype.sortFunction = function (a, b) {

    return a.depth - b.depth;
};


module.exports = TransformComponentManager;

},{"./component_manager":43}],50:[function(require,module,exports){
var AudioCtx = require("../../base/audio_ctx");
var Time = require("../../base/time");
var Mathf = require("../../math/mathf");
var Vec2 = require("../../math/vec2");
var Vec3 = require("../../math/vec3");
var Assets = require("../assets/assets");
var Component = require("./component");
"use strict";


var now = Time.now,
    clamp01 = Mathf.clamp01,
    defineProperty = Object.defineProperty;

function AudioSource(opts) {
    opts || (opts = {});

    Component.call(this, "AudioSource", opts);

    this.clip = opts.clip;

    this._source = undefined;
    this._gain = undefined;
    this._panner = undefined;

    this.dopplerLevel = opts.dopplerLevel != undefined ? opts.dopplerLevel : 1;
    this._loop = opts.loop != undefined ? !!opts.loop : false;

    this.maxDistance = opts.maxDistance != undefined ? opts.maxDistance : 15;
    this.minDistance = opts.minDistance != undefined ? opts.minDistance : 1;

    this.offset = opts.offset != undefined ? opts.offset : new Vec3;

    this.pitch = opts.pitch != undefined ? opts.pitch : 0;

    this.playOnStart = opts.playOnStart != undefined ? !!opts.playOnStart : false;

    this.spread = opts.spread != undefined ? opts.spread : 0;

    this.time = opts.time != undefined ? opts.time : 0;
    this._volume = opts.volume != undefined ? opts.volume : 1;

    this.playing = false;
    this.stopped = false;
    this.paused = false;

    this._startTime = 0;

    var _this = this;
    this._onended = function () {

        _this.playing = false;
        _this.time = 0;
        _this.emit("end");
    };
}

Component.extend(AudioSource);


defineProperty(AudioSource.prototype, "volume", {
    get: function () {
        return this._volume;
    },
    set: function (value) {
        this._volume = clamp01(value);
        if (this._gain) this._gain.gain.value = this._volume;
    }
});


defineProperty(AudioSource.prototype, "loop", {
    get: function () {
        return this._loop;
    },
    set: function (value) {
        this._loop = !!value;
        if (this._source) this._source.loop = this._loop;
    }
});


AudioSource.prototype.copy = function (other) {

    this.clip = other.clip;

    this.dopplerLevel = other.dopplerLevel;
    this.loop = other.loop;

    this.maxDistance = other.maxDistance;
    this.minDistance = other.minDistance;

    this.offset.copy(other.offset);
    this.panLevel = other.panLevel;

    this.pitch = other.pitch;

    this.playOnStart = other.playOnStart;

    this.spread = other.spread;

    this.time = other.time;
    this.volume = other.volume;

    this.playing = false;
    this.stopped = false;
    this.paused = false;

    return this;
};


AudioSource.prototype.clear = function () {
    Component.prototype.clear.call(this);
    if (this.playing) this.stop();

    this.clip = undefined;
    this._source = undefined;
    this._gain = undefined;
    this._panner = undefined;
};


AudioSource.prototype.start = function () {

    if (this.playOnStart) this.play();
};


var VEC2 = new Vec2,
    VEC3 = new Vec3;
AudioSource.prototype.update = function () {
    if (this.dopplerLevel === 0 || !this.playing) return;
    var transform2d, transform, camera, cameraTransform, panner;

    if (!(camera = this.gameObject.scene.game.camera)) return;
    if (!(panner = this._panner)) return;

    transform = this.transform;
    transform2d = this.transform2d;

    cameraTransform = camera.transform || camera.transform2d;

    if (transform2d) {
        VEC2.vadd(transform2d.position, this.offset);
        VEC2.sub(cameraTransform.position);
        VEC2.smul(this.dopplerLevel);

        panner.setPosition(VEC2.x, VEC2.y, camera.orthographicSize * 0.5);
    } else {
        VEC3.vadd(transform.position, this.offset);
        VEC3.sub(cameraTransform.position);
        VEC3.smul(this.dopplerLevel);

        panner.setPosition(VEC3.x, VEC3.y, VEC3.z || 0);
    }
};


AudioSource.prototype.play = function (delay, offset, duration) {
    if (!AudioCtx) return this;
    if (!AudioCtx.UNLOCKED && this._loop) {
        var _this = this,
            listener = function (e) {
                _this.play();
                window.removeEventListener("audiocontextunlock", listener, false);
            };

        window.addEventListener("audiocontextunlock", listener, false);
    }
    if (!this.clip || !this.clip.raw) return this;
    var time = this.time,
        clipLength = this.clip.length,
        maxLength = clipLength - time;

    delay || (delay = 0);
    offset || (offset = time);
    duration || (duration = clipLength);
    duration = duration > maxLength ? maxLength : duration;

    this._refresh();

    this.playing = true;
    this.stopped = false;
    this.paused = false;
    this._startTime = now();

    this.time = offset;
    this._source.start(delay, offset, duration);

    return this;
};


AudioSource.prototype.pause = function () {
    if (!AudioCtx || !this.clip || !this.clip.raw) return this;

    this.playing = false;
    this.stopped = false;
    this.paused = true;
    this.time = now() - this._startTime;

    this._source.stop(this.time);

    return this;
};


AudioSource.prototype.stop = function () {
    if (!AudioCtx || !this.clip || !this.clip.raw) return this;

    this.time = 0;
    this.playing = false;
    this.stopped = true;
    this.paused = false;

    this._source.stop(this.time);

    return this;
};


AudioSource.prototype._refresh = function () {
    var source = this._source = AudioCtx.createBufferSource(),
        gain = this._gain = AudioCtx.createGain(),
        panner;

    if (this.dopplerLevel === 0) {
        gain.connect(AudioCtx.destination);
        source.connect(gain);
    } else {
        panner = this._panner = AudioCtx.createPanner();

        gain.connect(AudioCtx.destination);
        panner.connect(gain);
        source.connect(panner);
    }

    source.buffer = this.clip.raw;
    source.onended = this._onended;

    gain.gain.value = this.volume;
    source.loop = this._loop;

    return this;
};


AudioSource.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);

    json.clip = this.clip ? this.clip.name : undefined;

    json.dopplerLevel = this.dopplerLevel;
    json.loop = this.loop;

    json.maxDistance = this.maxDistance;
    json.minDistance = this.minDistance;

    json.offset = this.offset.toJSON(json.offset);
    json.panLevel = this.panLevel;

    json.pitch = this.pitch;

    json.playOnStart = this.playOnStart;

    json.spread = this.spread;

    json.time = this.time;
    json.volume = this.volume;

    return json;
};


AudioSource.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);

    this.clip = json.clip ? Assets.get(json.clip) : undefined;

    this.dopplerLevel = json.dopplerLevel;
    this.loop = json.loop;

    this.maxDistance = json.maxDistance;
    this.minDistance = json.minDistance;

    this.offset.fromJSON(json.offset);
    this.panLevel = json.panLevel;

    this.pitch = json.pitch;

    this.playOnStart = json.playOnStart;

    this.spread = json.spread;

    this.time = json.time;
    this.volume = json.volume;

    return this;
};


module.exports = AudioSource;

},{"../../base/audio_ctx":7,"../../base/time":18,"../../math/mathf":107,"../../math/vec2":111,"../../math/vec3":112,"../assets/assets":22,"./component":54}],51:[function(require,module,exports){
var Vec3 = require("../../math/vec2");
var Quat = require("../../math/quat");
var Mat4 = require("../../math/mat4");
var Component = require("./component");
"use strict";


var UNKNOWN = 0;


function Bone(opts) {
    opts || (opts = {});

    Component.call(this, "Bone", opts);

    this.parentIndex = opts.parentIndex != undefined ? opts.parentIndex : -1;
    this.name = opts.name != undefined ? opts.name : "Bone_" + UNKNOWN++;

    this.skinned = opts.skinned != undefined ? opts.skinned : false;
    this.bindPose = opts.bindPose != undefined ? opts.bindPose : new Mat4;
    this.uniform = new Mat4;

    this.inheritPosition = opts.inheritPosition != undefined ? opts.inheritPosition : true;
    this.inheritRotation = opts.inheritRotation != undefined ? opts.inheritRotation : true;
    this.inheritScale = opts.inheritScale != undefined ? opts.inheritScale : true;
}

Component.extend(Bone);


Bone.prototype.copy = function (other) {

    this.name = other.name;
    this.parentIndex = other.parentIndex;

    this.skinned = other.skinned;
    this.bindPose.copy(other.bindPose);

    this.inheritPosition = other.inheritPosition;
    this.inheritRotation = other.inheritRotation;
    this.inheritScale = other.inheritScale;

    return this;
};


var MAT = new Mat4,
    POSITION = new Vec3,
    SCALE = new Vec3,
    ROTATION = new Quat;
Bone.prototype.update = function () {
    if (!this.skinned) return;
    var transform = this.transform,
        uniform = this.uniform,
        parent = transform.parent,
        inheritPosition = this.inheritPosition,
        inheritScale = this.inheritScale,
        inheritRotation = this.inheritRotation;

    uniform.copy(transform.matrix);

    if (parent && this.parentIndex !== -1) {
        MAT.copy(parent.bone.uniform);

        if (!inheritPosition || !inheritScale || !inheritRotation) {
            MAT.decompose(POSITION, SCALE, ROTATION);

            if (!inheritPosition) POSITION.set(0.0, 0.0, 0.0);
            if (!inheritScale) SCALE.set(1.0, 1.0, 1.0);
            if (!inheritRotation) ROTATION.set(0.0, 0.0, 0.0, 1.0);

            MAT.compose(POSITION, SCALE, ROTATION);
        }

        uniform.mmul(MAT, uniform);
    }
};


Bone.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);

    json.name = this.name;
    json.parentIndex = this.parentIndex;

    json.skinned = this.skinned;
    json.bindPose = this.bindPose.toJSON(json.bindPose);

    json.inheritPosition = this.inheritPosition;
    json.inheritRotation = this.inheritRotation;
    json.inheritScale = this.inheritScale;

    return json;
};


Bone.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);

    this.name = json.name;
    this.parentIndex = json.parentIndex;

    this.skinned = json.skinned;
    this.bindPose.fromJSON(json.bindPose);

    this.inheritPosition = json.inheritPosition;
    this.inheritRotation = json.inheritRotation;
    this.inheritScale = json.inheritScale;

    return this;
};


module.exports = Bone;

},{"../../math/mat4":106,"../../math/quat":108,"../../math/vec2":111,"./component":54}],52:[function(require,module,exports){
var Mathf = require("../../math/mathf");
var Color = require("../../math/color");
var Vec3 = require("../../math/vec3");
var Mat4 = require("../../math/mat4");
var Component = require("./component");
"use strict";


var degsToRads = Mathf.degsToRads,
    clamp = Mathf.clamp,
    EPSILON = Mathf.EPSILON;


function Camera(opts) {
    opts || (opts = {});

    Component.call(this, "Camera", opts);

    this.width = 960;
    this.height = 640;
    this.invWidth = 1 / this.width;
    this.invHeight = 1 / this.height;

    this.autoResize = opts.autoResize != undefined ? !!opts.autoResize : true;
    this.background = opts.background != undefined ? opts.background : new Color(0.5, 0.5, 0.5);

    this.aspect = this.width / this.height;
    this.fov = opts.fov != undefined ? opts.fov : 35;

    this.near = opts.near != undefined ? opts.near : 0.0625;
    this.far = opts.far != undefined ? opts.far : 16384;

    this.orthographic = opts.orthographic != undefined ? !!opts.orthographic : false;
    this.orthographicSize = opts.orthographicSize != undefined ? opts.orthographicSize : 2;

    this.minOrthographicSize = opts.minOrthographicSize != undefined ? opts.minOrthographicSize : EPSILON;
    this.maxOrthographicSize = opts.maxOrthographicSize != undefined ? opts.maxOrthographicSize : 1024;

    this.projection = new Mat4;
    this.guiProjection = new Mat4;
    this.view = new Mat4;

    this.needsUpdate = true;
    this._active = false;
}

Component.extend(Camera);


Camera.prototype.copy = function (other) {

    this.width = other.width;
    this.height = other.height;
    this.aspect = other.aspect;

    this.invWidth = 1 / this.width;
    this.invHeight = 1 / this.height;

    this.autoResize = other.autoResize;
    this.background.copy(other.background);

    this.far = other.far;
    this.near = other.near;
    this.fov = other.fov;

    this.orthographic = other.orthographic;
    this.orthographicSize = other.orthographicSize;
    this.minOrthographicSize = other.minOrthographicSize;
    this.maxOrthographicSize = other.maxOrthographicSize;

    this.needsUpdate = true;

    return this;
};


Camera.prototype.set = function (width, height) {

    this.width = width;
    this.height = height;

    this.invWidth = 1 / this.width;
    this.invHeight = 1 / this.height;

    this.aspect = width / height;
    this.needsUpdate = true;
};


Camera.prototype.setWidth = function (width) {

    this.width = width;
    this.aspect = width / this.height;

    this.invWidth = 1 / this.width;

    this.needsUpdate = true;
};


Camera.prototype.setHeight = function (height) {

    this.height = height;
    this.aspect = this.width / height;

    this.invHeight = 1 / this.height;

    this.needsUpdate = true;
};


Camera.prototype.setFov = function (value) {

    this.fov = value;
    this.needsUpdate = true;
};


Camera.prototype.setNear = function (value) {

    this.near = value;
    this.needsUpdate = true;
};


Camera.prototype.setFar = function (value) {

    this.far = value;
    this.needsUpdate = true;
};


Camera.prototype.setOrthographic = function (value) {

    this.orthographic = !!value;
    this.needsUpdate = true;
};


Camera.prototype.toggleOrthographic = function () {

    this.orthographic = !this.orthographic;
    this.needsUpdate = true;
};


Camera.prototype.setOrthographicSize = function (size) {

    this.orthographicSize = clamp(size, this.minOrthographicSize, this.maxOrthographicSize);
    this.needsUpdate = true;
};


var MAT4 = new Mat4,
    VEC3 = new Vec3;

Camera.prototype.toWorld = function (v, out) {
    out || (out = new Vec3);

    out.x = 2.0 * (v.x * this.invWidth) - 1.0;
    out.y = -2.0 * (v.y * this.invHeight) + 1.0;
    out.transformMat4(MAT4.mmul(this.projection, this.view).inverse());
    out.z = this.near;

    return out;
};


Camera.prototype.toScreen = function (v, out) {
    out || (out = new Vec2);

    VEC3.copy(v);
    VEC3.transformMat4(MAT4.mmul(this.projection, this.view));

    out.x = ((VEC3.x + 1.0) * 0.5) * this.width;
    out.y = ((1.0 - VEC3.y) * 0.5) * this.height;

    return v;
};


Camera.prototype.update = function (force) {
    if (!force && !this._active) return;

    if (this.needsUpdate) {

        if (!this.orthographic) {
            this.projection.perspective(degsToRads(this.fov), this.aspect, this.near, this.far);
        } else {
            this.orthographicSize = clamp(this.orthographicSize, this.minOrthographicSize, this.maxOrthographicSize);

            var orthographicSize = this.orthographicSize,
                right = orthographicSize * this.aspect,
                left = -right,
                top = orthographicSize,
                bottom = -top;

            this.projection.orthographic(left, right, top, bottom, this.near, this.far);
        }

        this.guiProjection.orthographic(0, this.width, 0, this.height, -1, 1);

        this.needsUpdate = false;
    }

    this.view.inverseMat((this.transform || this.transform2d).matrixWorld);
};


Camera.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);

    json.width = this.width;
    json.height = this.height;
    json.aspect = this.aspect;

    json.autoResize = this.autoResize;
    json.background = this.background.toJSON(json.background);

    json.far = this.far;
    json.near = this.near;
    json.fov = this.fov;

    json.orthographic = this.orthographic;
    json.orthographicSize = this.orthographicSize;
    json.minOrthographicSize = this.minOrthographicSize;
    json.maxOrthographicSize = this.maxOrthographicSize;

    return json;
};


Camera.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);

    this.width = json.width;
    this.height = json.height;
    this.aspect = json.aspect;

    this.autoResize = json.autoResize;
    this.background.fromJSON(json.background);

    this.far = json.far;
    this.near = json.near;
    this.fov = json.fov;

    this.orthographic = json.orthographic;
    this.orthographicSize = json.orthographicSize;
    this.minOrthographicSize = json.minOrthographicSize;
    this.maxOrthographicSize = json.maxOrthographicSize;

    this.needsUpdate = true;

    return this;
};


module.exports = Camera;

},{"../../math/color":102,"../../math/mat4":106,"../../math/mathf":107,"../../math/vec3":112,"./component":54}],53:[function(require,module,exports){
var Mathf = require("../../math/mathf");
var Color = require("../../math/color");
var Vec2 = require("../../math/vec2");
var Mat32 = require("../../math/mat32");
var Mat4 = require("../../math/mat4");
var Component = require("./component");
"use strict";


var clamp = Mathf.clamp,
    EPSILON = Mathf.EPSILON;


function Camera2D(opts) {
    opts || (opts = {});

    Component.call(this, "Camera2D", opts);

    this.width = 960;
    this.height = 640;
    this.invWidth = 1 / this.width;
    this.invHeight = 1 / this.height;

    this.autoResize = opts.autoResize != undefined ? !!opts.autoResize : true;
    this.background = opts.background != undefined ? opts.background : new Color(0.5, 0.5, 0.5);

    this.aspect = this.width / this.height;

    this.orthographicSize = opts.orthographicSize != undefined ? opts.orthographicSize : 2;

    this.minOrthographicSize = opts.minOrthographicSize != undefined ? opts.minOrthographicSize : EPSILON;
    this.maxOrthographicSize = opts.maxOrthographicSize != undefined ? opts.maxOrthographicSize : 1024;

    this.projection = new Mat4;
    this._projection = new Mat32;
    this.guiProjection = new Mat4;

    this.view = new Mat4;
    this._view = new Mat32;

    this.needsUpdate = true;
    this._active = false;
}

Component.extend(Camera2D);


Camera2D.prototype.copy = function (other) {

    this.width = other.width;
    this.height = other.height;

    this.invWidth = 1 / this.width;
    this.invHeight = 1 / this.height;

    this.autoResize = other.autoResize;
    this.background.copy(other.background);

    this.orthographicSize = other.orthographicSize;
    this.minOrthographicSize = other.minOrthographicSize;
    this.maxOrthographicSize = other.maxOrthographicSize;

    this.needsUpdate = true;

    return this;
};


Camera2D.prototype.set = function (width, height) {

    this.width = width;
    this.height = height;

    this.invWidth = 1 / this.width;
    this.invHeight = 1 / this.height;

    this.aspect = width / height;
    this.needsUpdate = true;
};


Camera2D.prototype.setWidth = function (width) {

    this.width = width;
    this.aspect = width / this.height;

    this.invWidth = 1 / this.width;

    this.needsUpdate = true;
};


Camera2D.prototype.setHeight = function (height) {

    this.height = height;
    this.aspect = this.width / height;

    this.invHeight = 1 / this.height;

    this.needsUpdate = true;
};


Camera2D.prototype.setOrthographicSize = function (size) {

    this.orthographicSize = clamp(size, this.minOrthographicSize, this.maxOrthographicSize);
    this.needsUpdate = true;
};


var MAT32 = new Mat32,
    VEC2 = new Vec2;
Camera2D.prototype.toWorld = function (v, out) {
    out || (out = new Vec2);

    out.x = 2 * (v.x * this.invWidth) - 1;
    out.y = -2 * (v.y * this.invHeight) + 1;
    out.transformMat32(MAT32.mmul(this._projection, this._view).inverse());

    return out;
};


Camera2D.prototype.toScreen = function (v, out) {
    out || (out = new Vec2);

    VEC2.copy(v).transformMat32(MAT32.mmul(this._projection, this._view));

    out.x = ((VEC2.x + 1) * 0.5) * this.width;
    out.y = ((1 - VEC2.y) * 0.5) * this.height;

    return out;
};


Camera2D.prototype.update = function () {
    if (!this._active) return;

    if (this.needsUpdate) {
        var orthographicSize = this.orthographicSize,
            right = orthographicSize * this.aspect,
            left = -right,
            top = orthographicSize,
            bottom = -top;

        this.projection.orthographic(left, right, top, bottom, -1, 1);
        this._projection.fromMat4(this.projection);
        this.needsUpdate = false;

        this.guiProjection.orthographic(0, this.width, 0, this.height, -1, 1);
    }

    this.view.inverseMat((this.transform || this.transform2d).matrixWorld);
    this._view.fromMat4(this.view);
};


Camera2D.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);

    json.width = this.width;
    json.height = this.height;

    json.autoResize = this.autoResize;
    json.background = this.background.toJSON(json.background);

    json.orthographicSize = this.orthographicSize;
    json.minOrthographicSize = this.minOrthographicSize;
    json.maxOrthographicSize = this.maxOrthographicSize;

    return json;
};


Camera2D.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);

    this.width = json.width;
    this.height = json.height;

    this.autoResize = json.autoResize;
    this.background.fromJSON(json.background);

    this.orthographicSize = json.orthographicSize;
    this.minOrthographicSize = json.minOrthographicSize;
    this.maxOrthographicSize = json.maxOrthographicSize;

    this.needsUpdate = true;

    return this;
};


module.exports = Camera2D;

},{"../../math/color":102,"../../math/mat32":105,"../../math/mat4":106,"../../math/mathf":107,"../../math/vec2":111,"./component":54}],54:[function(require,module,exports){
var Class = require("../../base/class");
var util = require("../../base/util");
var Log = require("../../base/log");
"use strict";


var camelize = util.camelize;


function Component(type, opts) {
    opts || (opts = {});
    if (!type) Log.error("Component defined without a type, use Component.call(this, \"ComponentName\", { sync: Boolean, json: Boolean })");

    Class.call(this);

    this._type = type || "UnknownComponent";
    this._name = camelize(this._type, true);

    this.sync = opts.sync != undefined ? !!opts.sync : false;
    this.json = opts.json != undefined ? !!opts.json : true;

    this.gameObject = undefined;
}

Class.extend(Component);


Component.prototype.copy = function (other) {

    this.sync = other.sync;
    this.json = other.json;

    return this;
};


Component.prototype.init = function () {

    return this;
};


Component.prototype.start = function () {

    return this;
};


Component.prototype.update = function () {

};


Component.prototype.clear = function () {

    this.off();

    return this;
};


Component.prototype.destroy = function () {
    if (!this.gameObject) {
        Log.error("Component.destroy: can't destroy Component if it's not added to a GameObject");
        return this;
    }

    this.gameObject.removeComponent(this);
    this.emit("destroy");

    this.clear();

    return this;
};


Component.prototype.remove = function () {
    if (!this.gameObject) {
        Log.error("Component.remove: can't remove Component if it's not added to a GameObject");
        return this;
    }

    this.gameObject.removeComponent(this, true);
    return this;
};


Component.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);

    json._type = this._type;
    json.sync = this.sync;
    json.json = this.json;

    return json;
};


Component.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);

    this.sync = json.sync;
    this.json = json.json;

    return this;
};


module.exports = Component;

},{"../../base/class":8,"../../base/log":14,"../../base/util":19}],55:[function(require,module,exports){
var Component = require("./component");
"use strict";


function GUIElement(type, opts) {
    opts || (opts = {});

    Component.call(this, type || "GUIElement", opts);
}

Component.extend(GUIElement);


module.exports = GUIElement;

},{"./component":54}],56:[function(require,module,exports){
var Rect = require("../../math/rect");
var Color = require("../../math/color");
var Enums = require("../enums");
var Assets = require("../assets/assets");
var GUIElement = require("./gui_element");
"use strict";


var FontStyle = Enums.FontStyle,
    TextAnchor = Enums.TextAnchor;


function GUIText(opts) {
    opts || (opts = {});

    GUIElement.call(this, "GUIText", opts);

    this.text = opts.text != undefined ? opts.text : "";

    this.font = opts.font || "Arial";
    this.fontSize = opts.fontSize || 16;
    this.fontStyle = opts.fontStyle || FontStyle.Normal;
    this.lineHeight = opts.lineHeight || 24;
    this.lineSpacing = opts.lineSpacing || 0;

    this.color = opts.color != undefined ? opts.color : new Color(1, 1, 1);
    this.offset = opts.offset != undefined ? opts.offset : new Vec2;

    this.alignment = opts.alignment || TextAnchor.MiddleLeft;
}

GUIElement.extend(GUIText);


GUIText.prototype.copy = function (other) {

    this.text = other.text;

    this.font = other.font;
    this.fontSize = other.fontSize;
    this.fontStyle = other.fontStyle;
    this.lineHeight = other.lineHeight;
    this.lineSpacing = other.lineSpacing;

    this.color.copy(other.color);
    this.offset.copy(other.offset);

    this.alignment = other.alignment;

    return this;
};


GUIText.prototype.toJSON = function (json) {
    json = GUIElement.prototype.toJSON.call(this, json);

    json.text = this.text;

    json.font = this.font;
    json.fontSize = this.fontSize;
    json.fontStyle = this.fontStyle;
    json.lineHeight = this.lineHeight;
    json.lineSpacing = this.lineSpacing;

    json.color = this.color.toJSON(json.color);
    json.offset = this.offset.toJSON(json.offset);

    json.alignment = this.alignment;

    return json;
};


GUIText.prototype.fromJSON = function (json) {
    GUIElement.prototype.fromJSON.call(this, json);

    this.text = json.text;

    this.font = json.font;
    this.fontSize = json.fontSize;
    this.fontStyle = json.fontStyle;
    this.lineHeight = json.lineHeight;
    this.lineSpacing = json.lineSpacing;

    this.color.fromJSON(json.color);
    this.offset.fromJSON(json.offset);

    this.alignment = this.alignment;

    return this;
};


module.exports = GUIText;

},{"../../math/color":102,"../../math/rect":109,"../assets/assets":22,"../enums":73,"./gui_element":55}],57:[function(require,module,exports){
var Rect = require("../../math/rect");
var Color = require("../../math/color");
var Assets = require("../assets/assets");
var GUIElement = require("./gui_element");
"use strict";


function GUITexture(opts) {
    opts || (opts = {});

    GUIElement.call(this, "GUITexture", opts);

    this.texture = opts.texture;
    this.color = opts.color != undefined ? opts.color : new Color(1, 1, 1);
    this.position = opts.position != undefined ? opts.position : new Rect;

    this.x = opts.x || 0;
    this.y = opts.y || 0;
    this.w = opts.w || 1;
    this.h = opts.h || 1;

    this.alpha = opts.alpha != undefined ? opts.alpha : 1;
}

GUIElement.extend(GUITexture);


GUITexture.prototype.copy = function (other) {

    this.texture = other.texture;
    this.color.copy(other.color);
    this.position.copy(other.position);

    this.x = other.x;
    this.y = other.y;
    this.w = other.w;
    this.h = other.h;

    this.alpha = other.alpha;

    return this;
};


GUITexture.prototype.clear = function () {
    GUIElement.prototype.clear.call(this);

    this.texture = undefined;

    return this;
};


GUITexture.prototype.toJSON = function (json) {
    json = GUIElement.prototype.toJSON.call(this, json);

    json.texture = this.texture ? this.texture.name : undefined;
    json.color = this.color.toJSON(json.color);
    json.position = this.position.toJSON(json.position);

    json.x = this.x;
    json.y = this.y;
    json.w = this.w;
    json.h = this.h;

    json.alpha = this.alpha;

    return json;
};


GUITexture.prototype.fromJSON = function (json) {
    GUIElement.prototype.fromJSON.call(this, json);

    this.texture = json.texture ? Assets.get(json.texture) : undefined;
    this.color.fromJSON(json.color);
    this.position.fromJSON(json.position);

    this.x = json.x;
    this.y = json.y;
    this.w = json.w;
    this.h = json.h;

    this.alpha = json.alpha;

    return this;
};


module.exports = GUITexture;

},{"../../math/color":102,"../../math/rect":109,"../assets/assets":22,"./gui_element":55}],58:[function(require,module,exports){
var Enums = require("../enums");
var Vec3 = require("../../math/vec3");
var Color = require("../../math/color");
var Component = require("./component");
"use strict";


var cos = Math.cos,
    defineProperty = Object.defineProperty;


function Light(opts) {
    opts || (opts = {});

    Component.call(this, "Light", opts);

    this.type = opts.type != undefined ? opts.type : Enums.LightType.Point;

    this.visible = opts.visible != undefined ? !!opts.visible : true;
    this.onlyShadow = opts.onlyShadow != undefined ? !!opts.onlyShadow : false;
    this.castShadow = opts.castShadow != undefined ? !!opts.castShadow : true;

    this.color = opts.color != undefined ? opts.color : new Color(1, 1, 1);
    this.energy = opts.energy != undefined ? opts.energy : 1;
    this.distance = opts.distance != undefined ? opts.distance : 0;

    this._angleCos = 0;
    this._angle = 0;
    this.angle = opts.angle != undefined ? opts.angle : Math.PI * 0.0625;
    this.exponent = opts.exponent != undefined ? opts.exponent : 10;

    this.target = opts.target != undefined ? opts.target : new Vec3;
}

Component.extend(Light);


defineProperty(Light.prototype, "angle", {
    get: function () {
        return this._angle;
    },
    set: function (value) {
        this._angle = value;
        this._angleCos = cos(value);
    }
});


Light.prototype.copy = function (other) {

    this.type = other.type;

    this.visible = other.visible;
    this.onlyShadow = other.onlyShadow;
    this.castShadow = other.castShadow;

    this.color.copy(other.color);
    this.energy = other.energy;
    this.distance = other.distance;
    this.angle = other.angle;

    return this;
};


Light.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);

    json.type = this.type;

    json.visible = this.visible;
    json.onlyShadow = this.onlyShadow;
    json.castShadow = this.castShadow;

    json.color = this.color.toJSON(json.color);
    json.energy = this.energy;
    json.distance = this.distance;
    json.angle = this.angle;

    return json;
};


Light.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);

    this.type = json.type;

    this.visible = json.visible;
    this.onlyShadow = json.onlyShadow;
    this.castShadow = json.castShadow;

    this.color.fromJSON(json.color);
    this.energy = json.energy;
    this.distance = json.distance;
    this.angle = json.angle;

    return this;
};


module.exports = Light;

},{"../../math/color":102,"../../math/vec3":112,"../enums":73,"./component":54}],59:[function(require,module,exports){
var Time = require("../../base/time");
var Mathf = require("../../math/mathf");
var Mat4 = require("../../math/mat4");
var Vec3 = require("../../math/vec3");
var Quat = require("../../math/quat");
var Assets = require("../assets/assets");
var Component = require("./component");
var Enums = require("../enums");
"use strict";


var clamp01 = Mathf.clamp01,
    abs = Math.abs,
    WrapMode = Enums.WrapMode;


function MeshAnimation(opts) {
    opts || (opts = {});

    Component.call(this, "MeshAnimation", opts);

    this.current = opts.current != undefined ? opts.current : "idle";
    this.mode = opts.mode != undefined ? opts.mode : WrapMode.Loop;

    this.rate = opts.rate != undefined ? opts.rate : 1 / 24;

    this._time = 0;
    this._frame = 0;
    this._lastFrame = 0;
    this._order = 1;

    this.playing = this.sheet ? true : false;
}

Component.extend(MeshAnimation);


MeshAnimation.prototype.copy = function (other) {

    this.current = other.current;
    this.mode = other.mode;

    this.rate = other.rate;

    this._time = other._time;
    this._frame = other._frame;
    this._lastFrame = other._lastFrame;
    this._order = other._order;

    this.playing = other.playing;

    return this;
};


MeshAnimation.prototype.play = function (name, mode, rate) {
    var meshFilter = this.meshFilter;
    if ((this.playing && this.current === name) || !meshFilter || !meshFilter.mesh.animations[name]) return this;

    this.current = name;
    this.rate = rate != undefined ? rate : (rate = this.rate);
    this.mode = mode || (mode = this.mode);
    this._frame = 0;
    this._lastFrame = 0;
    this._order = 1;
    this._time = 0;

    this.playing = true;
    this.emit("play", name, mode, rate);

    return this;
};


MeshAnimation.prototype.stop = function () {

    if (this.playing) this.emit("stop");
    this.playing = false;
    this._frame = 0;
    this._lastFrame = 0;
    this._order = 1;
    this._time = 0;

    return this;
};


var POSITION = new Vec3,
    LAST_POSITION = new Vec3,
    ROTATION = new Quat,
    LAST_ROTATION = new Quat,
    SCALE = new Vec3,
    LAST_SCALE = new Vec3,
    MAT4 = new Mat4;

MeshAnimation.prototype.update = function () {
    if (!this.playing) return;
    var meshFilter = this.meshFilter,
        meshBones, mesh, bonesLength, alpha = 0.0,
        boneCurrent, boneTransform, uniform, parentIndex, boneFrame, lastBoneFrame, pos, rot, scl,
        current, dt, count, length, order, frame, lastFrame, mode, frameState, lastFrameState, i;

    if (!meshFilter) return;
    meshBones = meshFilter._bones;

    mesh = meshFilter.mesh;
    if (!mesh) return;

    if (!(bonesLength = meshBones.length)) return;
    i = bonesLength;

    current = mesh.animations[this.current];
    if (!current) return;

    dt = Time.delta;
    order = this._order;
    frame = this._frame;
    lastFrame = this._lastFrame;
    mode = this.mode;

    if (!this.rate || this.rate === Infinity || this.rate < 0) {
        frame = abs(frame) % current.length;
    } else {
        this._time += dt;
        count = this._time / this.rate;
        alpha = count;

        if (count >= 1) {
            lastFrame = frame;
            alpha = 0.0;

            this._time = 0;
            length = current.length;
            frame += (order * (count | 0));

            if (mode === WrapMode.Loop) {
                frame = frame % length;
            } else if (mode === WrapMode.Once) {
                if (order > 0) {
                    if (frame >= length) {
                        frame = length - 1;
                        this.stop();
                    }
                } else {
                    if (frame < 0) {
                        frame = 0;
                        this.stop();
                    }
                }
            } else if (mode === WrapMode.PingPong) {
                if (order > 0) {
                    if (frame >= length) {
                        this._order = -1;
                        frame = length - 1;
                    }
                } else {
                    if (frame < 0) {
                        this._order = 1;
                        frame = 0;
                    }
                }
            } else if (mode === WrapMode.Clamp) {
                if (order > 0) {
                    if (frame >= length) frame = length - 1;
                } else {
                    if (frame < 0) frame = 0;
                }
            }
        }
    }

    alpha = clamp01(alpha);
    frameState = current[frame];
    lastFrameState = current[lastFrame] || frameState;

    while (i--) {
        boneCurrent = meshBones[i];

        boneTransform = boneCurrent.transform;
        uniform = boneCurrent.uniform;
        parentIndex = boneCurrent.parentIndex;
        pos = boneTransform.position;
        rot = boneTransform.rotation;
        scl = boneTransform.scale;

        boneFrame = frameState[i];
        lastBoneFrame = lastFrameState[i];

        LAST_POSITION.x = lastBoneFrame[0];
        LAST_POSITION.y = lastBoneFrame[1];
        LAST_POSITION.z = lastBoneFrame[2];

        LAST_ROTATION.x = lastBoneFrame[3];
        LAST_ROTATION.y = lastBoneFrame[4];
        LAST_ROTATION.z = lastBoneFrame[5];
        LAST_ROTATION.w = lastBoneFrame[6];

        LAST_SCALE.x = lastBoneFrame[7];
        LAST_SCALE.y = lastBoneFrame[8];
        LAST_SCALE.z = lastBoneFrame[9];

        POSITION.x = boneFrame[0];
        POSITION.y = boneFrame[1];
        POSITION.z = boneFrame[2];

        ROTATION.x = boneFrame[3];
        ROTATION.y = boneFrame[4];
        ROTATION.z = boneFrame[5];
        ROTATION.w = boneFrame[6];

        SCALE.x = boneFrame[7];
        SCALE.y = boneFrame[8];
        SCALE.z = boneFrame[9];

        pos.vlerp(LAST_POSITION, POSITION, alpha);
        rot.qlerp(LAST_ROTATION, ROTATION, alpha);
        scl.vlerp(LAST_SCALE, SCALE, alpha);
    }

    this._frame = frame;
    this._lastFrame = lastFrame;
};


MeshAnimation.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);

    json.current = this.current;
    json.mode = this.mode;

    json.rate = this.rate;

    json._time = this._time;
    json._frame = this._frame;
    json._order = this._order;

    json.playing = this.playing;

    return json;
};


MeshAnimation.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);

    this.current = json.current;
    this.mode = json.mode;

    this.rate = json.rate;

    this._time = json._time;
    this._frame = json._frame;
    this._order = json._order;

    this.playing = json.playing;

    return this;
};


module.exports = MeshAnimation;

},{"../../base/time":18,"../../math/mat4":106,"../../math/mathf":107,"../../math/quat":108,"../../math/vec3":112,"../assets/assets":22,"../enums":73,"./component":54}],60:[function(require,module,exports){
var Assets = require("../assets/assets");
var GameObject = require("../game_object");
var Component = require("./component");
var Bone = require("./bone");
"use strict";


/**
 * @class MeshFilter
 * @extends Component
 * @brief base class for handling meshes
 * @param Object options
 */
function MeshFilter(opts) {
    opts || (opts = {});

    Component.call(this, "MeshFilter", opts);

    /**
     * @property Mesh mesh
     * @memberof MeshFilter
     */
    this.mesh = opts.mesh != undefined ? opts.mesh : undefined;

    /**
     * @property Material material
     * @memberof MeshFilter
     */
    this.material = opts.material != undefined ? opts.material : undefined;


    this._bones = [];
    this._webglMeshInitted = false;
}

Component.extend(MeshFilter);


MeshFilter.prototype.copy = function (other) {

    this.mesh = other.mesh;
    this.material = other.material;

    this._bones.length = 0;
    this._webglMeshInitted = false;

    return this;
};


MeshFilter.prototype.init = function () {
    var transform = this.transform,
        bones = this._bones,
        meshBones = this.mesh.bones,
        subGameObject, meshBone, bone, parent,
        i = meshBones.length;

    if (!i) return;

    while (i--) {
        meshBone = meshBones[i];

        subGameObject = new GameObject().addComponents(
            new Bone({
                name: meshBone.name,
                parentIndex: meshBone.parentIndex,

                skinned: meshBone.skinned,
                bindPose: meshBone.bindPose
            }),
            new Transform({
                position: meshBone.position.clone(),
                rotation: meshBone.rotation.clone(),
                scale: meshBone.scale.clone()
            })
        );
        subGameObject.name = meshBone.name;
        bones[i] = subGameObject.bone;
    }

    transform.addChild(bones[0].transform);

    i = meshBones.length;
    while (i--) {
        bone = bones[i];
        parent = bones[bone.parentIndex];
        if (!parent) continue;

        parent.transform.addChild(bone.transform);
    }
};


MeshFilter.prototype.clear = function () {
    Component.prototype.clear.call(this);

    this.mesh = undefined;
    this.material = undefined;

    this._bones.length = 0;
    this._webglMeshInitted = false;

    return this;
};


MeshFilter.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);

    json.mesh = this.mesh ? this.mesh.name : undefined;
    json.material = this.material ? this.material.name : undefined;

    return json;
};


MeshFilter.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);

    this.mesh = json.mesh ? Assets.get(json.mesh) : undefined;
    this.material = json.material ? Assets.get(json.material) : undefined;

    this._bones.length = 0;
    this._webglMeshInitted = false;

    return this;
};


module.exports = MeshFilter;

},{"../assets/assets":22,"../game_object":77,"./bone":51,"./component":54}],61:[function(require,module,exports){
var Device = require("../../base/device");
var Mathf = require("../../math/mathf");
var Vec2 = require("../../math/vec2");
var Vec3 = require("../../math/vec3");
var Input = require("../input/input");
var Component = require("./component");
"use strict";


var pow = Math.pow,
    sqrt = Math.sqrt,
    sin = Math.sin,
    cos = Math.cos,
    tan = Math.tan,
    atan2 = Math.atan2,
    min = Math.min,
    max = Math.max,
    PI = Math.PI,
    MIN_POLOR = 0,
    MAX_POLOR = PI,

    degsToRads = Mathf.degsToRads,
    EPSILON = Mathf.EPSILON,

    NONE = 1,
    ROTATE = 2,
    PAN = 3;


function OrbitControl(opts) {
    opts || (opts = {});

    Component.call(this, "OrbitControl", opts);

    this.speed = opts.speed > EPSILON ? opts.speed : 1;
    this.zoomSpeed = opts.zoomSpeed > EPSILON ? opts.zoomSpeed : 2;

    this.allowZoom = opts.allowZoom != undefined ? !!opts.allowZoom : true;
    this.allowPan = opts.allowPan != undefined ? !!opts.allowPan : true;
    this.allowRotate = opts.allowRotate != undefined ? !!opts.allowRotate : true;

    this.target = opts.target || new Vec3;

    this._offset = new Vec3;
    this._pan = new Vec3;
    this._scale = 1;
    this._thetaDelta = 0;
    this._phiDelta = 0;
    this._state = NONE;
}

Component.extend(OrbitControl);


OrbitControl.prototype.copy = function () {

    return this;
};


OrbitControl.prototype.start = function () {

    if (Device.mobile) {
        Input.on("touchstart", this.onTouchStart, this);
        Input.on("touchend", this.onTouchEnd, this);
        Input.on("touchmove", this.onTouchMove, this);
    } else {
        Input.on("mouseup", this.onMouseUp, this);
        Input.on("mousedown", this.onMouseDown, this);
        Input.on("mousemove", this.onMouseMove, this);
        Input.on("mousewheel", this.onMouseWheel, this);
    }

    this.updateOrbit();

    return this;
};


OrbitControl.prototype.clear = function () {
    Component.prototype.clear.call(this);

    if (Device.mobile) {
        Input.on("touchstart", this.onTouchStart, this);
        Input.on("touchend", this.onTouchEnd, this);
        Input.on("touchmove", this.onTouchMove, this);
    } else {
        Input.off("mouseup", this.onMouseUp, this);
        Input.off("mousedown", this.onMouseDown, this);
        Input.off("mousemove", this.onMouseMove, this);
        Input.off("mousewheel", this.onMouseWheel, this);
    }

    return this;
};


OrbitControl.prototype.onTouchStart = function () {
    var length = Input.touches.length;

    if (length === 1) {
        this._state = ROTATE;
    } else if (length === 2 && this.allowPan) {
        this._state = PAN;
    } else {
        this._state = NONE;
    }
};


var LEFT_MOUSE = "mouse0",
    MIDDLE_MOUSE = "mouse1";
OrbitControl.prototype.onMouseDown = function (button) {

    if (button === LEFT_MOUSE && this.allowRotate) {
        this._state = ROTATE;
    } else if (button === MIDDLE_MOUSE && this.allowPan) {
        this._state = PAN;
    } else {
        this._state = NONE;
    }
};


OrbitControl.prototype.onTouchEnd = OrbitControl.prototype.onMouseUp = function () {

    this._state = NONE;
};


OrbitControl.prototype.onTouchMove = function () {
    var update = false,
        touch = Input.touches[0],
        delta = touch.delta,
        camera;

    if (this._state === ROTATE) {
        update = true;
        camera = this.camera;

        this._thetaDelta += 2 * PI * delta.x * camera.invWidth * this.speed;
        this._phiDelta -= 2 * PI * delta.y * camera.invHeight * this.speed;
    } else if (this._state === PAN) {
        update = true;

        this.pan(delta);
    }

    update && this.updateOrbit();
};


OrbitControl.prototype.onMouseMove = function () {
    var update = false,
        mouseDelta = Input.mouseDelta,
        camera;

    if (this._state === ROTATE) {
        update = true;
        camera = this.camera;

        this._thetaDelta += 2 * PI * mouseDelta.x * camera.invWidth * this.speed;
        this._phiDelta -= 2 * PI * mouseDelta.y * camera.invHeight * this.speed;
    } else if (this._state === PAN) {
        update = true;

        this.pan(mouseDelta);
    }

    update && this.updateOrbit();
};


OrbitControl.prototype.onMouseWheel = function (mouseWheel) {
    if (!this.allowZoom) return;
    var update = false;

    if (mouseWheel > 0) {
        update = true;
        this._scale *= pow(0.95, this.zoomSpeed);
    } else {
        update = true;
        this._scale /= pow(0.95, this.zoomSpeed);
    }

    update && this.updateOrbit();
};


OrbitControl.prototype.clear = function () {
    Component.prototype.clear.call(this);

    return this;
};


var panOffset = new Vec3;
OrbitControl.prototype.pan = function (delta) {
    var pan = this._pan,
        camera = this.camera,
        transform = this.transform,
        te = transform.matrixWorld.elements,
        position = transform.position,
        targetDistance;

    panOffset.vsub(position, this.target);
    targetDistance = panOffset.length();

    if (!camera.orthographic) {
        targetDistance *= tan(degsToRads(camera.fov * 0.5));

        panOffset.set(te[0], te[1], te[2]).smul(-2 * delta.x * targetDistance * camera.invWidth);
        pan.add(panOffset);

        panOffset.set(te[4], te[5], te[6]).smul(2 * delta.y * targetDistance * camera.invHeight);
        pan.add(panOffset);
    } else {
        targetDistance *= camera.orthographicSize * 0.5;

        panOffset.set(te[0], te[1], te[2]).smul(-2 * delta.x * targetDistance * camera.invWidth);
        pan.add(panOffset);

        panOffset.set(te[4], te[5], te[6]).smul(2 * delta.y * targetDistance * camera.invHeight);
        pan.add(panOffset);
    }
};


OrbitControl.prototype.updateOrbit = function () {
    var transform = this.transform,
        position = transform.position,
        target = this.target,
        offset = this._offset,
        pan = this._pan,
        theta, phi, radius;

    offset.vsub(position, target);
    theta = atan2(offset.x, offset.y);
    phi = atan2(sqrt(offset.x * offset.x + offset.y * offset.y), offset.z);

    theta += this._thetaDelta;
    phi += this._phiDelta;

    phi = max(MIN_POLOR, min(MAX_POLOR, phi));
    phi = max(EPSILON, min(PI - EPSILON, phi));

    radius = offset.length() * this._scale;

    target.add(pan);

    offset.x = radius * sin(phi) * sin(theta);
    offset.y = radius * sin(phi) * cos(theta);
    offset.z = radius * cos(phi);

    position.vadd(target, offset);
    transform.lookAt(target);

    this._scale = 1;
    this._thetaDelta = 0;
    this._phiDelta = 0;
    pan.set(0, 0, 0);
};


OrbitControl.prototype.setTarget = function (target) {

    this.target.copy(target);
    this.transform.lookAt(this.target);
};


module.exports = OrbitControl;

},{"../../base/device":10,"../../math/mathf":107,"../../math/vec2":111,"../../math/vec3":112,"../input/input":88,"./component":54}],62:[function(require,module,exports){
var ObjectPool = require("../../../base/object_pool");
var Class = require("../../../base/class");
var Mathf = require("../../../math/mathf");
var Vec3 = require("../../../math/vec3");
var Color = require("../../../math/color");
var Enums = require("../../enums");
var Assets = require("../../assets/assets");
var Tween = require("./tween");
var Particle = require("./particle");
"use strict";


var EmitterType = Enums.EmitterType,

    PI = Math.PI,
    TWO_PI = PI * 2,

    random = Math.random,
    randInt = Mathf.randInt,
    randFloat = Mathf.randFloat,
    clampTop = Mathf.clampTop,
    sqrt = Math.sqrt,

    PARTICLE_POOL = Emitter.PARTICLE_POOL = new ObjectPool(Particle);


function Emitter(opts) {
    opts || (opts = {});

    Class.call(this);

    this.sort = opts.sort != undefined ? opts.sort : true;

    this.positionType = opts.positionType != undefined ? opts.positionType : EmitterType.Box;
    this.velocityType = opts.velocityType != undefined ? opts.velocityType : EmitterType.Box;

    this.material = opts.material != undefined ? opts.material : undefined;

    this.positionSpread = opts.positionSpread != undefined ? opts.positionSpread : new Vec3(0.5, 0.5, 0.5);
    this.positionRadius = opts.positionRadius != undefined ? opts.positionRadius : 0.5;

    this.speed = opts.speed != undefined ? opts.speed : 0;
    this.speedSpread = opts.speedSpread != undefined ? opts.speedSpread : 0;

    this.particleSystem = undefined;

    this.worldSpace = opts.worldSpace != undefined ? opts.worldSpace : true;

    this.position = opts.position != undefined ? opts.position : new Vec3;

    this.minEmission = opts.minEmission != undefined ? opts.minEmission : 1;
    this.maxEmission = opts.maxEmission != undefined ? opts.maxEmission : 2;

    this.minLife = opts.minLife != undefined ? opts.minLife : 1;
    this.maxLife = opts.maxLife != undefined ? opts.maxLife : 2;

    this.minSize = opts.minSize != undefined ? opts.minSize : 0.1;
    this.maxSize = opts.maxSize != undefined ? opts.maxSize : 0.5;

    this.sizeTween = new Tween(opts.sizeTween);
    this.alphaTween = new Tween(opts.alphaTween);
    this.colorTween = new Tween(opts.colorTween);

    this.velocity = opts.velocity != undefined ? opts.velocity : new Vec3;
    this.velocitySpread = opts.velocitySpread != undefined ? opts.velocitySpread : new Vec3;

    this.acceleration = opts.acceleration != undefined ? opts.acceleration : new Vec3;
    this.accelerationSpread = opts.accelerationSpread != undefined ? opts.accelerationSpread : new Vec3;

    this.angularVelocity = opts.angularVelocity != undefined ? opts.angularVelocity : 0;
    this.angularVelocitySpread = opts.angularVelocitySpread != undefined ? opts.angularVelocitySpread : 0;

    this.angularAcceleration = opts.angularAcceleration != undefined ? opts.angularAcceleration : 0;
    this.angularAccelerationSpread = opts.angularAccelerationSpread != undefined ? opts.angularAccelerationSpread : 0;

    this.randomAngle = opts.randomAngle != undefined ? opts.randomAngle : true;

    this.emissionRate = opts.emissionRate != undefined ? opts.emissionRate : 1 / 60;

    this.color = opts.color != undefined ? opts.color : new Color;
    this.colorSpread = opts.colorSpread != undefined ? opts.colorSpread : new Color;

    this.time = opts.time != undefined ? opts.time : 0;
    this._time = 0;

    this.duration = opts.duration != undefined ? opts.duration : 0;

    this.loop = opts.loop != undefined ? opts.loop : true;

    this.playing = opts.playing != undefined ? opts.playing : true;
    this.emitting = opts.emitting != undefined ? opts.emitting : true;

    this.particles = [];

    this._webglInitted = undefined;

    this._webglVertexBuffer = undefined;
    this._webglParticleBuffer = undefined;
    this._webglParticleColorBuffer = undefined;

    this._webglVertexArray = undefined;
    this._webglParticleArray = undefined;
    this._webglParticleColorArray = undefined;
}

Class.extend(Emitter);


Emitter.prototype.copy = function (other) {

    this.sort = other.sort;

    this.positionType = other.positionType;
    this.velocityType = other.velocityType;

    this.material = other.material;

    this.position.copy(other.position);
    this.positionSpread.copy(other.positionSpread);
    this.positionRadius = other.positionRadius;

    this.speed = other.speed;
    this.speedSpread = other.speedSpread;

    this.worldSpace = other.worldSpace;

    this.minEmission = other.minEmission;
    this.maxEmission = other.maxEmission;

    this.minLife = other.minLife;
    this.maxLife = other.maxLife;

    this.minSize = other.minSize;
    this.maxSize = other.maxSize;

    this.sizeTween.copy(other.sizeTween);
    this.alphaTween.copy(other.alphaTween);
    this.colorTween.copy(other.colorTween);

    this.velocity.copy(other.velocity);
    this.velocitySpread.copy(other.velocitySpread);

    this.acceleration.copy(other.acceleration);
    this.accelerationSpread.copy(other.accelerationSpread);

    this.angularVelocity = other.angularVelocity;
    this.angularVelocitySpread = other.angularVelocitySpread;

    this.angularAcceleration = other.angularAcceleration;
    this.angularAccelerationSpread = other.angularAccelerationSpread;

    this.randomAngle = other.randomAngle;

    this.emissionRate = other.emissionRate;

    this.color.copy(other.color);
    this.colorSpread.copy(other.colorSpread);

    this.time = other.time;
    this._time = other._time;

    this.duration = other.duration;
    this.loop = other.loop;
    this.playing = other.playing;
    this.emitting = other.emitting;

    return this;
};


Emitter.prototype.play = function () {

    this.time = 0;
    this.playing = true;
    this.emitting = true;

    return this;
};


Emitter.prototype.clear = function () {
    var particles = this.particles,
        i = particles.length;

    this.time = 0;
    this._time = 0;
    this.playing = false;
    this.emitting = false;

    while (i--) PARTICLE_POOL.removeObject(particles[i]);
    particles.length = 0;

    return this;
};


var VEC = new Vec3;
Emitter.prototype.spawn = function (count) {
    var transform = this.particleSystem.transform || this.particleSystem.transform2d,
        transformPosition = transform.toWorld(VEC.set(0, 0, 0)),
        transformMatrix = transform.matrixWorld,

        position = this.position,
        positionSpread = this.positionSpread,
        positionRadius = this.positionRadius,

        speed = this.speed,
        speedSpread = this.speedSpread,

        particles = this.particles,
        numParticle2Ds = particles.length,

        worldSpace = this.worldSpace,
        randomAngle = this.randomAngle,

        color = this.color,
        colorSpread = this.colorSpread,
        useRandColor = colorSpread.lengthSq() > 0,

        velocity = this.velocity,
        velocitySpread = this.velocitySpread,

        acceleration = this.acceleration,
        accelerationSpread = this.accelerationSpread,

        angularVelocity = this.angularVelocity,
        angularVelocitySpread = this.angularVelocitySpread,

        angularAcceleration = this.angularAcceleration,
        angularAccelerationSpread = this.angularAccelerationSpread,

        minLife = this.minLife,
        maxLife = this.maxLife,

        minSize = this.minSize,
        maxSize = this.maxSize,

        positionType = this.positionType,
        velocityType = this.velocityType,

        limit = clampTop(numParticle2Ds + count, Emitter.MAX_PARTICLES) - numParticle2Ds,
        posx, posy, posz, vel, acc, pos, col, x, y, z, len, r, dx, dy, dz, spd, particle;

    if (positionType !== EmitterType.Box) {
        posx = randFloat(-positionSpread.x, positionSpread.x);
        posy = randFloat(-positionSpread.y, positionSpread.y);
        posz = randFloat(-positionSpread.z, positionSpread.z);
    }

    while (limit--) {
        particle = PARTICLE_POOL.create();
        pos = particle.position;
        vel = particle.velocity;
        acc = particle.acceleration;
        col = particle.color;

        col.r = color.r;
        col.g = color.g;
        col.b = color.b;

        if (useRandColor) {
            col.r += colorSpread.r * random();
            col.g += colorSpread.g * random();
            col.b += colorSpread.b * random();
            col.cnormalize();
        }

        if (worldSpace) {
            pos.x = position.x + transformPosition.x;
            pos.y = position.y + transformPosition.y;
            pos.z = position.z + transformPosition.z;
        } else {
            pos.x = position.x;
            pos.y = position.y;
            pos.z = position.z;
        }

        if (positionType === EmitterType.Box) {
            pos.x += randFloat(-positionSpread.x, positionSpread.x);
            pos.y += randFloat(-positionSpread.y, positionSpread.y);
            pos.z += randFloat(-positionSpread.z, positionSpread.z);
        } else { //EmitterType.Sphere
            x = randFloat(-1, 1);
            y = randFloat(-1, 1);
            z = randFloat(-1, 1);

            len = x * x + y * y + z * z;
            len = len !== 0 ? 1 / sqrt(len) : len;

            pos.x += posx + x * len * positionRadius;
            pos.y += posy + y * len * positionRadius;
            pos.z += posz + z * len * positionRadius;
        }

        if (velocityType === EmitterType.Box) {
            vel.x = velocity.x + randFloat(-velocitySpread.x, velocitySpread.x);
            vel.y = velocity.y + randFloat(-velocitySpread.y, velocitySpread.y);
            vel.z = velocity.z + randFloat(-velocitySpread.z, velocitySpread.z);
        } else { //EmitterType.Sphere
            if (worldSpace) {
                dx = pos.x - (position.x + transformPosition.x);
                dy = pos.y - (position.y + transformPosition.y);
                dz = pos.z - (position.z + transformPosition.z);
            } else {
                dx = pos.x - position.x;
                dy = pos.y - position.y;
                dz = pos.z - position.z;
            }
            spd = speed + randFloat(-speedSpread, speedSpread);

            r = dx * dx + dy * dy + dz * dz;
            r = r !== 0 ? 1 / sqrt(r) : r;

            vel.x = dx * r * spd;
            vel.y = dy * r * spd;
            vel.z = dz * r * spd;
        }
        vel.transformMat4Rotation(transformMatrix);

        acc.x = acceleration.x + randFloat(-accelerationSpread.x, accelerationSpread.x);
        acc.y = acceleration.y + randFloat(-accelerationSpread.y, accelerationSpread.y);
        acc.z = acceleration.z + randFloat(-accelerationSpread.z, accelerationSpread.z);

        particle.angularVelocity = angularVelocity + randFloat(-angularVelocitySpread, angularVelocitySpread);
        particle.angularAcceleration = angularAcceleration + randFloat(-angularAccelerationSpread, angularAccelerationSpread);

        particle.alpha = 1;
        particle.angle = randomAngle ? random() * TWO_PI : 0;
        particle.lifeTime = 0;
        particle.life = randFloat(minLife, maxLife);
        particle.size = randFloat(minSize, maxSize);

        particles.push(particle);
    }
};


Emitter.prototype.update = function (dt) {
    if (!this.playing) return;
    var particles = this.particles,
        sizeTween = this.sizeTween,
        alphaTween = this.alphaTween,
        colorTween = this.colorTween,
        sizeTweenUpdate = sizeTween.times.length > 0,
        alphaTweenUpdate = alphaTween.times.length > 0,
        colorTweenUpdate = colorTween.times.length > 0,
        particle, life, count,
        i;

    this.time += dt;
    this._time += dt;
    count = this._time / this.emissionRate;

    if (this.emitting && count >= 1) {
        this._time = 0;
        this.spawn(randInt(this.minEmission, this.maxEmission) * (count | 0));

        if (!this.loop && this.time > this.duration) this.emitting = false;
    }

    i = particles.length;
    while (i--) {
        particle = particles[i];
        particle.update(dt);
        life = particle.lifeTime / particle.life;

        if (sizeTweenUpdate) particle.size = sizeTween.update(life);
        if (alphaTweenUpdate) particle.alpha = alphaTween.update(life);
        if (colorTweenUpdate) colorTween.update(life, particle.color);

        if (life > 1) {
            PARTICLE_POOL.removeObject(particle);
            particles.splice(i, 1);
        }
    }

    if (!this.emitting && particles.length === 0) this.playing = false;
};


Emitter.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);

    json.type = 1;

    json.sort = this.sort;

    json.positionType = this.positionType;
    json.velocityType = this.velocityType;

    json.material = this.material ? this.material.name : undefined;

    json.position = this.position.toJSON(json.position);
    json.positionSpread = this.positionSpread.toJSON(json.positionSpread);
    json.positionRadius = this.positionRadius;

    json.speed = this.speed;
    json.speedSpread = this.speedSpread;

    json.worldSpace = this.worldSpace;

    json.minEmission = this.minEmission;
    json.maxEmission = this.maxEmission;

    json.minLife = this.minLife;
    json.maxLife = this.maxLife;

    json.minSize = this.minSize;
    json.maxSize = this.maxSize;

    json.sizeTween = this.sizeTween.toJSON(json.sizeTween);
    json.alphaTween = this.alphaTween.toJSON(json.alphaTween);
    json.colorTween = this.colorTween.toJSON(json.colorTween);

    json.velocity = this.velocity.toJSON(json.velocity);
    json.velocitySpread = this.velocitySpread.toJSON(json.velocitySpread);

    json.acceleration = this.acceleration.toJSON(json.acceleration);
    json.accelerationSpread = this.accelerationSpread.toJSON(json.accelerationSpread);

    json.angularVelocity = this.angularVelocity;
    json.angularAcceleration = this.angularAcceleration;

    json.angularVelocitySpread = this.angularVelocitySpread;
    json.randomAngle = this.randomAngle;

    json.emissionRate = this.emissionRate;

    json.color = this.color.toJSON(json.color);
    json.colorSpread = this.colorSpread.toJSON(json.colorSpread);

    json.time = this.time;
    json._time = this._time;

    json.duration = this.duration;
    json.loop = this.loop;
    json.playing = this.playing;
    json.emitting = this.emitting;

    return json;
};


Emitter.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);

    this.sort = json.sort;

    this.positionType = json.positionType;
    this.velocityType = json.velocityType;

    this.material = json.material ? Assets.hash[json.material] : undefined;

    this.position.fromJSON(json.position);
    this.positionSpread.fromJSON(json.positionSpread);
    this.positionRadius = json.positionRadius;

    this.speed = json.speed;
    this.speedSpread = json.speedSpread;

    this.worldSpace = json.worldSpace;

    this.minEmission = json.minEmission;
    this.maxEmission = json.maxEmission;

    this.minLife = json.minLife;
    this.maxLife = json.maxLife;

    this.minSize = json.minSize;
    this.maxSize = json.maxSize;

    this.sizeTween.fromJSON(json.sizeTween);
    this.alphaTween.fromJSON(json.alphaTween);
    this.colorTween.fromJSON(json.colorTween);

    this.velocity.fromJSON(json.velocity);
    this.velocitySpread.fromJSON(json.velocitySpread);

    this.acceleration.fromJSON(json.acceleration);
    this.accelerationSpread.fromJSON(json.accelerationSpread);

    this.angularVelocity = json.angularVelocity;
    this.angularAcceleration = json.angularAcceleration;

    this.angularVelocitySpread = json.angularVelocitySpread;
    this.randomAngle = json.randomAngle;

    this.emissionRate = json.emissionRate;

    this.color.fromJSON(json.color);
    this.colorSpread.fromJSON(json.colorSpread);

    this.time = json.time;
    this._time = json._time;

    this.duration = json.duration;
    this.loop = json.loop;
    this.playing = json.playing;
    this.emitting = json.emitting;

    return this;
};


Emitter.MAX_PARTICLES = 1024;


module.exports = Emitter;

},{"../../../base/class":8,"../../../base/object_pool":15,"../../../math/color":102,"../../../math/mathf":107,"../../../math/vec3":112,"../../assets/assets":22,"../../enums":73,"./particle":64,"./tween":67}],63:[function(require,module,exports){
var ObjectPool = require("../../../base/object_pool");
var Class = require("../../../base/class");
var Mathf = require("../../../math/mathf");
var Vec2 = require("../../../math/vec2");
var Color = require("../../../math/color");
var Enums = require("../../enums");
var Assets = require("../../assets/assets");
var Tween = require("./tween");
var Particle2D = require("./particle_2d");
"use strict";


var EmitterType = Enums.EmitterType,

    PI = Math.PI,
    TWO_PI = PI * 2,

    random = Math.random,
    randInt = Mathf.randInt,
    randFloat = Mathf.randFloat,
    clampTop = Mathf.clampTop,
    cos = Math.cos,
    sin = Math.sin,
    sqrt = Math.sqrt,

    PARTICLE_POOL = Emitter2D.PARTICLE_POOL = new ObjectPool(Particle2D);


function Emitter2D(opts) {
    opts || (opts = {});

    Class.call(this);

    this.positionType = opts.positionType != undefined ? opts.positionType : EmitterType.Box;
    this.velocityType = opts.velocityType != undefined ? opts.velocityType : EmitterType.Box;

    this.material = opts.material != undefined ? opts.material : undefined;

    this.positionSpread = opts.positionSpread != undefined ? opts.positionSpread : new Vec2(0.5, 0.5);
    this.positionRadius = opts.positionRadius != undefined ? opts.positionRadius : 0.5;

    this.speed = opts.speed != undefined ? opts.speed : 0;
    this.speedSpread = opts.speedSpread != undefined ? opts.speedSpread : 0;

    this.particleSystem = undefined;

    this.worldSpace = opts.worldSpace != undefined ? opts.worldSpace : true;

    this.position = opts.position != undefined ? opts.position : new Vec2;

    this.minEmission = opts.minEmission != undefined ? opts.minEmission : 1;
    this.maxEmission = opts.maxEmission != undefined ? opts.maxEmission : 2;

    this.minLife = opts.minLife != undefined ? opts.minLife : 1;
    this.maxLife = opts.maxLife != undefined ? opts.maxLife : 2;

    this.minSize = opts.minSize != undefined ? opts.minSize : 0.1;
    this.maxSize = opts.maxSize != undefined ? opts.maxSize : 0.5;

    this.sizeTween = new Tween(opts.sizeTween);
    this.alphaTween = new Tween(opts.alphaTween);
    this.colorTween = new Tween(opts.colorTween);

    this.velocity = opts.velocity != undefined ? opts.velocity : new Vec2;
    this.velocitySpread = opts.velocitySpread != undefined ? opts.velocitySpread : new Vec2;

    this.acceleration = opts.acceleration != undefined ? opts.acceleration : new Vec2;
    this.accelerationSpread = opts.accelerationSpread != undefined ? opts.accelerationSpread : new Vec2;

    this.angularVelocity = opts.angularVelocity != undefined ? opts.angularVelocity : 0;
    this.angularVelocitySpread = opts.angularVelocitySpread != undefined ? opts.angularVelocitySpread : 0;

    this.angularAcceleration = opts.angularAcceleration != undefined ? opts.angularAcceleration : 0;
    this.angularAccelerationSpread = opts.angularAccelerationSpread != undefined ? opts.angularAccelerationSpread : 0;

    this.randomAngle = opts.randomAngle != undefined ? opts.randomAngle : true;

    this.emissionRate = opts.emissionRate != undefined ? opts.emissionRate : 1 / 60;

    this.color = opts.color != undefined ? opts.color : new Color;
    this.colorSpread = opts.colorSpread != undefined ? opts.colorSpread : new Color;

    this.time = opts.time != undefined ? opts.time : 0;
    this._time = 0;

    this.duration = opts.duration != undefined ? opts.duration : 0;

    this.loop = opts.loop != undefined ? opts.loop : true;

    this.playing = opts.playing != undefined ? opts.playing : true;
    this.emitting = opts.emitting != undefined ? opts.emitting : true;

    this.particles = [];

    this._webglInitted = undefined;

    this._webglVertexBuffer = undefined;
    this._webglParticleBuffer = undefined;
    this._webglParticleColorBuffer = undefined;

    this._webglVertexArray = undefined;
    this._webglParticleArray = undefined;
    this._webglParticleColorArray = undefined;
}

Class.extend(Emitter2D);


Emitter2D.prototype.copy = function (other) {

    this.positionType = other.positionType;
    this.velocityType = other.velocityType;

    this.material = other.material;

    this.position.copy(other.position);
    this.positionSpread.copy(other.positionSpread);
    this.positionRadius = other.positionRadius;

    this.speed = other.speed;
    this.speedSpread = other.speedSpread;

    this.worldSpace = other.worldSpace;

    this.minEmission = other.minEmission;
    this.maxEmission = other.maxEmission;

    this.minLife = other.minLife;
    this.maxLife = other.maxLife;

    this.minSize = other.minSize;
    this.maxSize = other.maxSize;

    this.sizeTween.copy(other.sizeTween);
    this.alphaTween.copy(other.alphaTween);
    this.colorTween.copy(other.colorTween);

    this.velocity.copy(other.velocity);
    this.velocitySpread.copy(other.velocitySpread);

    this.acceleration.copy(other.acceleration);
    this.accelerationSpread.copy(other.accelerationSpread);

    this.angularVelocity = other.angularVelocity;
    this.angularVelocitySpread = other.angularVelocitySpread;

    this.angularAcceleration = other.angularAcceleration;
    this.angularAccelerationSpread = other.angularAccelerationSpread;

    this.randomAngle = other.randomAngle;

    this.emissionRate = other.emissionRate;

    this.color.copy(other.color);
    this.colorSpread.copy(other.colorSpread);

    this.time = other.time;
    this._time = other._time;

    this.duration = other.duration;
    this.loop = other.loop;
    this.playing = other.playing;
    this.emitting = other.emitting;

    return this;
};


Emitter2D.prototype.play = function () {

    this.time = 0;
    this.playing = true;
    this.emitting = true;

    return this;
};


Emitter2D.prototype.clear = function () {
    var particles = this.particles,
        i = particles.length;

    this.time = 0;
    this._time = 0;
    this.playing = false;
    this.emitting = false;

    while (i--) PARTICLE_POOL.removeObject(particles[i]);
    particles.length = 0;

    return this;
};


var VEC = new Vec2;
Emitter2D.prototype.spawn = function (count) {
    var transform = this.particleSystem.transform || this.particleSystem.transform2d,
        transformPosition = transform.toWorld(VEC.set(0, 0)),

        position = this.position,
        positionSpread = this.positionSpread,
        positionRadius = this.positionRadius,

        speed = this.speed,
        speedSpread = this.speedSpread,

        particles = this.particles,
        numParticle2Ds = particles.length,

        worldSpace = this.worldSpace,
        randomAngle = this.randomAngle,

        color = this.color,
        colorSpread = this.colorSpread,
        useRandColor = colorSpread.lengthSq() > 0,

        velocity = this.velocity,
        velocitySpread = this.velocitySpread,

        acceleration = this.acceleration,
        accelerationSpread = this.accelerationSpread,

        angularVelocity = this.angularVelocity,
        angularVelocitySpread = this.angularVelocitySpread,

        angularAcceleration = this.angularAcceleration,
        angularAccelerationSpread = this.angularAccelerationSpread,

        minLife = this.minLife,
        maxLife = this.maxLife,

        minSize = this.minSize,
        maxSize = this.maxSize,

        positionType = this.positionType,
        velocityType = this.velocityType,

        limit = clampTop(numParticle2Ds + count, Emitter2D.MAX_PARTICLES) - numParticle2Ds,
        posx, posy, vel, acc, pos, col, angle, u, r, dx, dy, spd, particle;

    if (positionType === EmitterType.Circle || positionType === EmitterType.CircleEdge) {
        posx = randFloat(-positionSpread.x, positionSpread.x);
        posy = randFloat(-positionSpread.y, positionSpread.y);
    }

    while (limit--) {
        particle = PARTICLE_POOL.create();
        pos = particle.position;
        vel = particle.velocity;
        acc = particle.acceleration;
        col = particle.color;

        col.r = color.r;
        col.g = color.g;
        col.b = color.b;

        if (useRandColor) {
            col.r += colorSpread.r * random();
            col.g += colorSpread.g * random();
            col.b += colorSpread.b * random();
            col.cnormalize();
        }

        if (worldSpace) {
            pos.x = position.x + transformPosition.x;
            pos.y = position.y + transformPosition.y;
        } else {
            pos.x = position.x;
            pos.y = position.y;
        }

        if (positionType === EmitterType.Box) {
            pos.x += randFloat(-positionSpread.x, positionSpread.x);
            pos.y += randFloat(-positionSpread.y, positionSpread.y);
        } else { //EmitterType.Circle
            angle = TWO_PI * random();
            u = random() + random();
            r = u > 1 ? 2 - u : u;

            pos.x += posx + r * cos(angle) * positionRadius;
            pos.y += posy + r * sin(angle) * positionRadius;
        }

        if (velocityType === EmitterType.Box) {
            vel.x = velocity.x + randFloat(-velocitySpread.x, velocitySpread.x);
            vel.y = velocity.y + randFloat(-velocitySpread.y, velocitySpread.y);
        } else { //EmitterType.Circle
            if (worldSpace) {
                dx = pos.x - (position.x + transformPosition.x);
                dy = pos.y - (position.y + transformPosition.y);
            } else {
                dx = pos.x - position.x;
                dy = pos.y - position.y;
            }
            spd = speed + randFloat(-speedSpread, speedSpread);

            r = dx * dx + dy * dy;
            r = r !== 0 ? 1 / sqrt(r) : r;

            vel.x = dx * r * spd;
            vel.y = dy * r * spd;
        }

        acc.x = acceleration.x + randFloat(-accelerationSpread.x, accelerationSpread.x);
        acc.y = acceleration.y + randFloat(-accelerationSpread.y, accelerationSpread.y);

        particle.angularVelocity = angularVelocity + randFloat(-angularVelocitySpread, angularVelocitySpread);
        particle.angularAcceleration = angularAcceleration + randFloat(-angularAccelerationSpread, angularAccelerationSpread);

        particle.alpha = 1;
        particle.angle = randomAngle ? random() * TWO_PI : 0;
        particle.lifeTime = 0;
        particle.life = randFloat(minLife, maxLife);
        particle.size = randFloat(minSize, maxSize);

        particles.push(particle);
    }
};


Emitter2D.prototype.update = function (dt) {
    if (!this.playing) return;
    var particles = this.particles,
        sizeTween = this.sizeTween,
        alphaTween = this.alphaTween,
        colorTween = this.colorTween,
        sizeTweenUpdate = sizeTween.times.length > 0,
        alphaTweenUpdate = alphaTween.times.length > 0,
        colorTweenUpdate = colorTween.times.length > 0,
        particle, life, count,
        i;

    this.time += dt;
    this._time += dt;
    count = this._time / this.emissionRate;

    if (this.emitting && count >= 1) {
        this._time = 0;
        this.spawn(randInt(this.minEmission, this.maxEmission) * (count | 0));

        if (!this.loop && this.time > this.duration) this.emitting = false;
    }

    i = particles.length;
    while (i--) {
        particle = particles[i];
        particle.update(dt);
        life = particle.lifeTime / particle.life;

        if (sizeTweenUpdate) particle.size = sizeTween.update(life);
        if (alphaTweenUpdate) particle.alpha = alphaTween.update(life);
        if (colorTweenUpdate) colorTween.update(life, particle.color);

        if (life > 1) {
            PARTICLE_POOL.removeObject(particle);
            particles.splice(i, 1);
            continue;
        }
    }

    if (!this.emitting && particles.length === 0) this.playing = false;
};


Emitter2D.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);

    json.type = 1;

    json.positionType = this.positionType;
    json.velocityType = this.velocityType;

    json.material = this.material ? this.material.name : undefined;

    json.position = this.position.toJSON(json.position);
    json.positionSpread = this.positionSpread.toJSON(json.positionSpread);
    json.positionRadius = this.positionRadius;

    json.speed = this.speed;
    json.speedSpread = this.speedSpread;

    json.worldSpace = this.worldSpace;

    json.minEmission = this.minEmission;
    json.maxEmission = this.maxEmission;

    json.minLife = this.minLife;
    json.maxLife = this.maxLife;

    json.minSize = this.minSize;
    json.maxSize = this.maxSize;

    json.sizeTween = this.sizeTween.toJSON(json.sizeTween);
    json.alphaTween = this.alphaTween.toJSON(json.alphaTween);
    json.colorTween = this.colorTween.toJSON(json.colorTween);

    json.velocity = this.velocity.toJSON(json.velocity);
    json.velocitySpread = this.velocitySpread.toJSON(json.velocitySpread);

    json.acceleration = this.acceleration.toJSON(json.acceleration);
    json.accelerationSpread = this.accelerationSpread.toJSON(json.accelerationSpread);

    json.angularVelocity = this.angularVelocity;
    json.angularAcceleration = this.angularAcceleration;

    json.angularVelocitySpread = this.angularVelocitySpread;
    json.randomAngle = this.randomAngle;

    json.emissionRate = this.emissionRate;

    json.color = this.color.toJSON(json.color);
    json.colorSpread = this.colorSpread.toJSON(json.colorSpread);

    json.time = this.time;
    json._time = this._time;

    json.duration = this.duration;
    json.loop = this.loop;
    json.playing = this.playing;
    json.emitting = this.emitting;

    return json;
};


Emitter2D.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);

    this.positionType = json.positionType;
    this.velocityType = json.velocityType;

    this.material = json.material ? Assets.get(json.material) : undefined;

    this.position.fromJSON(json.position);
    this.positionSpread.fromJSON(json.positionSpread);
    this.positionRadius = json.positionRadius;

    this.speed = json.speed;
    this.speedSpread = json.speedSpread;

    this.worldSpace = json.worldSpace;

    this.minEmission = json.minEmission;
    this.maxEmission = json.maxEmission;

    this.minLife = json.minLife;
    this.maxLife = json.maxLife;

    this.minSize = json.minSize;
    this.maxSize = json.maxSize;

    this.sizeTween.fromJSON(json.sizeTween);
    this.alphaTween.fromJSON(json.alphaTween);
    this.colorTween.fromJSON(json.colorTween);

    this.velocity.fromJSON(json.velocity);
    this.velocitySpread.fromJSON(json.velocitySpread);

    this.acceleration.fromJSON(json.acceleration);
    this.accelerationSpread.fromJSON(json.accelerationSpread);

    this.angularVelocity = json.angularVelocity;
    this.angularAcceleration = json.angularAcceleration;

    this.angularVelocitySpread = json.angularVelocitySpread;
    this.randomAngle = json.randomAngle;

    this.emissionRate = json.emissionRate;

    this.color.fromJSON(json.color);
    this.colorSpread.fromJSON(json.colorSpread);

    this.time = json.time;
    this._time = json._time;

    this.duration = json.duration;
    this.loop = json.loop;
    this.playing = json.playing;
    this.emitting = json.emitting;

    return this;
};


Emitter2D.MAX_PARTICLES = 1024;


module.exports = Emitter2D;

},{"../../../base/class":8,"../../../base/object_pool":15,"../../../math/color":102,"../../../math/mathf":107,"../../../math/vec2":111,"../../assets/assets":22,"../../enums":73,"./particle_2d":65,"./tween":67}],64:[function(require,module,exports){
var Vec3 = require("../../../math/vec3");
var Color = require("../../../math/color");
"use strict";


function Particle() {

    this.z = 1;
    this.alpha = 1;

    this.lifeTime = 0;
    this.life = 1;

    this.size = 1;

    this.color = new Color;

    this.position = new Vec3;
    this.velocity = new Vec3;
    this.acceleration = new Vec3;

    this.angle = 0;
    this.angularVelocity = 0;
    this.angularAcceleration = 0;
}


Particle.prototype.update = function (dt) {
    var pos = this.position,
        vel = this.velocity,
        acc = this.acceleration;

    pos.x += vel.x * dt;
    pos.y += vel.y * dt;
    pos.z += vel.z * dt;

    vel.x += acc.x * dt;
    vel.y += acc.y * dt;
    vel.z += acc.z * dt;

    this.angle += this.angularVelocity * dt;
    this.angularVelocity += this.angularAcceleration * dt;

    this.lifeTime += dt;
};


module.exports = Particle;

},{"../../../math/color":102,"../../../math/vec3":112}],65:[function(require,module,exports){
var Vec2 = require("../../../math/vec2");
var Color = require("../../../math/color");
"use strict";


function Particle2D() {

    this.alpha = 1;

    this.lifeTime = 0;
    this.life = 1;

    this.size = 1;

    this.color = new Color;

    this.position = new Vec2;
    this.velocity = new Vec2;
    this.acceleration = new Vec2;

    this.angle = 0;
    this.angularVelocity = 0;
    this.angularAcceleration = 0;
}


Particle2D.prototype.update = function (dt) {
    var pos = this.position,
        vel = this.velocity,
        acc = this.acceleration;

    pos.x += vel.x * dt;
    pos.y += vel.y * dt;

    vel.x += acc.x * dt;
    vel.y += acc.y * dt;

    this.angle += this.angularVelocity * dt;
    this.angularVelocity += this.angularAcceleration * dt;

    this.lifeTime += dt;
};


module.exports = Particle2D;

},{"../../../math/color":102,"../../../math/vec2":111}],66:[function(require,module,exports){
var Class = require("../../../base/class");
var Time = require("../../../base/time");
var Log = require("../../../base/log");
var Component = require("../component");
var Emitter = require("./emitter");
var Emitter2D = require("./emitter_2d");
var Tween = require("./tween");
"use strict";


/**
 * @class ParticleSystem
 * @extends Component
 * @brief 2d particle emitter
 * @param Object options
 */
function ParticleSystem(opts) {
    opts || (opts = {});

    Component.call(this, "ParticleSystem", opts);

    /**
     * @property Boolean playing
     * @memberof ParticleSystem
     */
    this.playing = opts.playing != undefined ? opts.playing : true;

    /**
     * @property Array emitters
     * @memberof ParticleSystem
     */
    this.emitters = [];
    this._emitterHash = {};
    this._emitterJSONHash = {};

    if (opts.emitter) this.addEmitter(opts.emitter);
    if (opts.emitters) this.add.apply(this, opts.emitters);
}

ParticleSystem.type = "ParticleSystem";
Component.extend(ParticleSystem);


ParticleSystem.Emitter = Emitter;
ParticleSystem.Emitter2D = Emitter2D;
ParticleSystem.Tween = Tween;


ParticleSystem.prototype.copy = function (other) {
    var emitters = this.emitters,
        otherEmitters = other.emitters,
        i = otherEmitters.length,
        j = emitters.length,
        emitter, otherEmitter;

    while (i-- > j) this.removeEmitter(emitters[i]);

    i = otherEmitters.length;
    while (i--) {
        otherEmitter = otherEmitters[i];

        if ((emitter = emitters[i])) {
            if ((emitter._className === otherEmitter._className)) {
                otherEmitters[i].copy(other);
            } else {
                this.removeEmitter(emitter);
                this.addEmitter(otherEmitter.clone());
            }
        } else {
            this.addEmitter(otherEmitter.clone());
        }
    }
    this.playing = other.playing;

    return this;
};


ParticleSystem.prototype.clear = function () {
    Component.prototype.clear.call(this);
    var emitters = this.emitters,
        i = emitters.length;
    ;

    while (i--) emitters[i].clear();
    return this;
};


ParticleSystem.prototype.addEmitter = function (emitter) {
    var emitters = this.emitters,
        index = emitters.indexOf(emitter);

    if (index === -1) {
        if (emitter.particleSystem) emitter = emitter.clone();

        emitter.particleSystem = this;
        emitters.push(emitter);
        this._emitterHash[emitter._id] = emitter;
        if (emitter._jsonId !== -1) this._emitterHash[emitter._jsonId] = emitter;
    } else {
        Log.error("ParticleSystem.addEmitter: ParticleSystem already has passed Emitter");
    }

    return this;
};


ParticleSystem.prototype.add = function () {
    var i = arguments.length;

    while (i--) this.addEmitter(arguments[i]);
    return this;
};


ParticleSystem.prototype.removeEmitter = function (emitter) {
    var emitters = this.emitters,
        index = emitters.indexOf(emitter);

    if (index !== -1) {
        emitters.splice(index, 1);
        this._emitterHash[emitter._id] = undefined;
        if (emitter._jsonId !== -1) this._emitterHash[emitter._jsonId] = undefined;

        emitter.clear();
        emitter.particleSystem = undefined;
        emitter.transform = undefined;
    } else {
        Log.error("ParticleSystem.removeEmitter: ParticleSystem does not have passed Emitter");
    }

    return this;
};


ParticleSystem.prototype.remove = function () {
    var i = arguments.length;

    while (i--) this.removeEmitter(arguments[i]);
    return this;
};


ParticleSystem.prototype.findEmitterById = function (id) {

    return this._emitterHash[id];
};


ParticleSystem.prototype.findEmitterByJSONId = function (id) {

    return this._emitterJSONHash[id];
};


/**
 * @method play
 * @memberof ParticleSystem
 */
ParticleSystem.prototype.play = function () {
    var emitters = this.emitters,
        i = emitters.length;

    while (i--) emitters[i].play();
    this.playing = true;

    return this;
};


ParticleSystem.prototype.update = function () {
    if (!this.playing) return;

    var dt = Time.delta,
        emitters = this.emitters,
        emitter, playing = false,
        i = emitters.length;

    while (i--) {
        emitter = emitters[i];
        emitter.update(dt);
        if (emitter.playing) playing = true;
    }

    this.playing = playing;
};


ParticleSystem.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);
    var emitters = this.emitters,
        jsonEmitters = json.emitters || (json.emitters = []),
        i = emitters.length;

    while (i--) {
        jsonEmitters[i] = emitters[i].toJSON(jsonEmitters[i]);
    }
    json.playing = this.playing;

    return json;
};


ParticleSystem.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);
    var jsonEmitters = json.emitters,
        emitter, jsonEmitter,
        i = jsonEmitters.length;

    while (i--) {
        jsonEmitter = jsonEmitters[i];

        if ((emitter = this.findEmitterByJSONId(jsonEmitter._id))) {
            emitter.fromJSON(jsonEmitter);
        } else {
            this.addEmitter(Class.fromJSON(jsonEmitter));
        }
    }
    this.playing = json.playing;

    return this;
};


module.exports = ParticleSystem;

},{"../../../base/class":8,"../../../base/log":14,"../../../base/time":18,"../component":54,"./emitter":62,"./emitter_2d":63,"./tween":67}],67:[function(require,module,exports){
var Class = require("../../../base/class");
var Mathf = require("../../../math/mathf");
"use strict";


function Tween(opts) {
    opts || (opts = {});

    this.times = opts.times || [];
    this.values = opts.values || [];
}


Tween.prototype.copy = function (other) {

    this.times = other.times.slice();
    this.values = other.values.slice();

    return this;
};


Tween.prototype.clear = function () {

    this.times.length = 0;
    this.values.length = 0;

    return this;
};


Tween.prototype.update = function (time, out) {
    var times = this.times,
        values = this.values,
        n = times.length,
        i = 0,
        t;

    while (i < n && time > times[i]) i++;

    if (i === 0) return values[0];
    if (i === n) return values[n - 1];

    t = (time - times[i - 1]) / (times[i] - times[i - 1]);

    if (out) return out.copy(values[i - 1]).lerp(values[i], t);
    return values[i - 1] + t * (values[i] - values[i - 1]);
};


Tween.prototype.toJSON = function (json) {
    json || (json = {});
    var times = this.times,
        values = this.values,
        jsonTimes = json.times || (json.times = []),
        jsonValues = json.values || (json.values = []),
        i;

    i = times.length;
    while (i--) jsonTimes[i] = times[i];

    i = values.length;
    while (i--) jsonValues[i] = values[i].toJSON ? values[i].toJSON(jsonValues[i]) : values[i];

    return json;
};


Tween.prototype.fromJSON = function (json) {
    var times = this.times,
        values = this.values,
        jsonTimes = json.times,
        jsonValues = json.values,
        i;

    i = jsonTimes.length;
    while (i--) times[i] = fromJSON(jsonTimes[i]);

    i = jsonValues.length;
    while (i--) values[i] = fromJSON(jsonValues[i]);

    return this;
};


function fromJSON(json) {
    var classes = Class._classes,
        mathClasses = Mathf._classes;

    if (typeof(json) !== "object") {
        return json;
    } else if (mathClasses[json._className]) {
        return Mathf.fromJSON(json);
    } else if (classes[json._className]) {
        return Class.fromJSON(json);
    } else {
        return json;
    }

    return null;
}


module.exports = Tween;

},{"../../../base/class":8,"../../../math/mathf":107}],68:[function(require,module,exports){
var Class = require("../../base/class");
var Vec2 = require("../../math/vec2");
var Vec3 = require("../../math/vec3");
var Component = require("./component");
var Phys2D = require("../../phys2d/phys2d");
"use strict";


function RigidBody2D(opts) {
    opts || (opts = {});

    Component.call(this, "RigidBody2D", opts);

    this.body = new Phys2D.P2Rigidbody(opts);
}

Class.extend(RigidBody2D, Component);


RigidBody2D.prototype.copy = function (other) {

    this.body.off("collide", onCollide, this);
    this.body.off("colliding", onColliding, this);
    this.body = other.body.clone();
    this.body.on("collide", onCollide, this);
    this.body.on("colliding", onColliding, this);

    return this;
};


RigidBody2D.prototype.clear = function () {
    Component.prototype.clear.call(this);

    this.body.off("collide", onCollide, this);
    this.body.off("colliding", onColliding, this);
    this.body.userData = undefined;
};


RigidBody2D.prototype.start = function () {
    var body = this.body,
        gameObject = this.gameObject,
        transform = gameObject.transform,
        transform2d = gameObject.transform2d;

    if (transform) {
        body.position.copy(transform.position);
        body.rotation = transform.rotation.rotationZ();
    } else {
        body.position.copy(transform2d.position);
        body.rotation = transform2d.rotation;
    }

    body.init();
    body.userData = this;
    body.on("collide", onCollide, this);
    body.on("colliding", onColliding, this);
};


var zAxis = new Vec3(0.0, 0.0, 1.0);
RigidBody2D.prototype.update = function () {
    var body = this.body,
        gameObject = this.gameObject,
        transform = gameObject.transform,
        transform2d = gameObject.transform2d;

    if (transform) {
        transform.position.copy(body.position);
        transform.rotation.fromAxisAngle(zAxis, body.rotation);
    } else {
        transform2d.position.copy(body.position);
        transform2d.rotation = body.rotation;
    }
};


RigidBody2D.prototype.applyForce = function (force, worldPoint) {

    this.body.applyForce(force, worldPoint);
};


RigidBody2D.prototype.applyTorque = function (torque) {

    this.body.applyTorque(torque);
};


RigidBody2D.prototype.applyImpulse = function (impulse, worldPoint) {

    this.body.applyImpulse(impulse, worldPoint);
};


RigidBody2D.prototype.applyVelocity = function (velocity) {

    this.body.applyVelocity(velocity);
};


RigidBody2D.prototype.applyAngularVelocity = function (angularVelocity) {

    this.body.applyAngularVelocity(angularVelocity);
};


RigidBody2D.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);

    json.body = this.body.toJSON(json.body);

    return json;
};


RigidBody2D.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);

    this.body.fromJSON(json.body);

    return this;
};


function onCollide(body, si, sj) {
    if (!body.userData) return;

    this.emit("collide", body.userData, body, si, sj);
};


function onColliding(body, si, sj) {
    if (!body.userData) return;

    this.emit("colliding", body.userData, body, si, sj);
};


module.exports = RigidBody2D;

},{"../../base/class":8,"../../math/vec2":111,"../../math/vec3":112,"../../phys2d/phys2d":131,"./component":54}],69:[function(require,module,exports){
var Enums = require("../enums");
var Component = require("./component");
var Assets = require("../assets/assets");
"use strict";


function Sprite(opts) {
    opts || (opts = {});

    Component.call(this, "Sprite", opts);

    this.visible = opts.visible != undefined ? !!opts.visible : true;
    this.blending = opts.blending != undefined ? opts.blending : Enums.Blending.Default;

    this.layer = opts.layer != undefined ? opts.layer : 0;
    this.z = opts.z != undefined ? opts.z : 0;

    this.alpha = opts.alpha != undefined ? opts.alpha : 1;

    this.material = opts.material != undefined ? opts.material : undefined;

    this.width = opts.width || 1;
    this.height = opts.height || 1;

    this.x = opts.x || 0;
    this.y = opts.y || 0;
    this.w = opts.w || 1;
    this.h = opts.h || 1;

    this._webglInitted = false;
}

Component.extend(Sprite);


Sprite.prototype.copy = function (other) {

    this.visible = other.visible;
    this.blending = other.blending;

    this.layer = other.layer;
    this.z = other.z;

    this.alpha = other.alpha;

    this.material = other.material;

    this.width = other.width;
    this.height = other.height;

    this.x = other.x;
    this.y = other.y;
    this.w = other.w;
    this.h = other.h;

    this._webglInitted = false;

    return this;
};


Sprite.prototype.clear = function () {
    Component.prototype.clear.call(this);

    this.material = undefined;
    this._webglInitted = false;

    return this;
};


Sprite.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);

    json.visible = this.visible;
    json.blending = this.blending;

    json.layer = this.layer;
    json.z = this.z;

    json.alpha = this.alpha;

    json.material = this.material ? this.material.name : undefined;

    json.width = this.width;
    json.height = this.height;

    json.x = this.x;
    json.y = this.y;
    json.w = this.w;
    json.h = this.h;

    return json;
};


Sprite.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);

    this.visible = json.visible;
    this.blending = json.blending;

    this.layer = json.layer;
    this.z = json.z;

    this.alpha = json.alpha;

    this.material = json.material ? Assets.get(json.material) : undefined;

    this.width = json.width;
    this.height = json.height;

    this.x = json.x;
    this.y = json.y;
    this.w = json.w;
    this.h = json.h;

    this._webglInitted = false;

    return this;
};


module.exports = Sprite;

},{"../assets/assets":22,"../enums":73,"./component":54}],70:[function(require,module,exports){
var Time = require("../../base/time");
var Assets = require("../assets/assets");
var Component = require("./component");
var Enums = require("../enums");
"use strict";


var abs = Math.abs,
    WrapMode = Enums.WrapMode;


/**
 * @class SpriteAnimation
 * @extends Component
 * @brief base class for handling sprite animation sheets
 * @param Object options
 */
function SpriteAnimation(opts) {
    opts || (opts = {});

    Component.call(this, "SpriteAnimation", opts);

    this.sheet = opts.sheet != undefined ? opts.sheet : undefined;

    this.current = opts.current != undefined ? opts.current : "idle";
    this.mode = opts.mode != undefined ? opts.mode : WrapMode.Loop;

    this.rate = opts.rate != undefined ? opts.rate : 1 / 24;

    this._time = 0;
    this._frame = 0;
    this._order = 1;

    this.playing = this.sheet ? true : false;
}

Component.extend(SpriteAnimation);


SpriteAnimation.prototype.copy = function (other) {

    this.sheet = other.sheet;

    this.current = other.current;
    this.mode = other.mode;

    this.rate = other.rate;

    this._time = other._time;
    this._frame = other._frame;
    this._order = other._order;

    this.playing = other.playing;

    return this;
};


SpriteAnimation.prototype.clear = function () {
    Component.prototype.clear.call(this);

    this.sheet = undefined;

    return this;
};


SpriteAnimation.prototype.play = function (name, mode, rate) {
    if (!this.sheet) return this;
    if ((this.playing && this.current === name) || !this.sheet[name]) return this;

    this.current = name;
    this.rate = rate != undefined ? rate : (rate = this.rate);
    this.mode = mode || (mode = this.mode);
    this._frame = 0;
    this._order = 1;
    this._time = 0;

    this.playing = true;
    this.emit("play", name, mode, rate);

    return this;
};


SpriteAnimation.prototype.stop = function () {

    if (this.playing) this.emit("stop");
    this.playing = false;
    this._frame = 0;
    this._order = 1;
    this._time = 0;

    return this;
};


SpriteAnimation.prototype.update = function () {
    if (!this.playing) return;
    var sprite = this.sprite,
        sheet = this.sheet,
        current = sheet[this.current],
        rate, dt, count, length, order, frame, mode, animation;

    if (!sprite || !sheet || !current) return;

    rate = this.rate;
    dt = Time.delta;
    order = this._order;
    frame = this._frame;
    mode = this.mode;

    if (!rate || rate === Infinity || rate < 0) {
        frame = abs(frame) % current.length;
    } else {
        this._time += dt;
        count = this._time / rate;

        if (count >= 1) {
            this._time = 0;
            length = current.length;
            frame += (order * (count | 0));

            if (mode === WrapMode.Loop) {
                frame = frame % length;
            } else if (mode === WrapMode.Once) {
                if (order > 0) {
                    if (frame >= length) {
                        frame = length - 1;
                        this.stop();
                    }
                } else {
                    if (frame < 0) {
                        frame = 0;
                        this.stop();
                    }
                }
            } else if (mode === WrapMode.PingPong) {
                if (order > 0) {
                    if (frame >= length) {
                        this._order = -1;
                        frame = length - 1;
                    }
                } else {
                    if (frame < 0) {
                        this._order = 1;
                        frame = 0;
                    }
                }
            } else if (mode === WrapMode.Clamp) {
                if (order > 0) {
                    if (frame >= length) frame = length - 1;
                } else {
                    if (frame < 0) frame = 0;
                }
            }
        }
    }

    animation = current[frame];
    sprite.x = animation[0];
    sprite.y = animation[1];
    sprite.w = animation[2];
    sprite.h = animation[3];

    this._frame = frame;
};


SpriteAnimation.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);

    json.sheet = this.sheet ? this.sheet.name : undefined;

    json.current = this.current;
    json.mode = this.mode;

    json.rate = this.rate;

    json._time = this._time;
    json._frame = this._frame;
    json._order = this._order;

    json.playing = this.playing;

    return json;
};


SpriteAnimation.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);

    this.sheet = json.sheet ? Assets.get(json.sheet) : undefined;

    this.current = json.current;
    this.mode = json.mode;

    this.rate = json.rate;

    this._time = json._time;
    this._frame = json._frame;
    this._order = json._order;

    this.playing = json.playing;

    return this;
};


module.exports = SpriteAnimation;

},{"../../base/time":18,"../assets/assets":22,"../enums":73,"./component":54}],71:[function(require,module,exports){
var Mathf = require("../../math/mathf");
var Vec3 = require("../../math/vec3");
var Quat = require("../../math/quat");
var Mat3 = require("../../math/mat3");
var Mat4 = require("../../math/mat4");
var Component = require("./component");
var Log = require("../../base/log");
"use strict";


var EPSILON = Mathf.EPSILON;


function Transform(opts) {
    opts || (opts = {});
    opts.sync = opts.sync != undefined ? opts.sync : true;

    Component.call(this, "Transform", opts);

    this.root = this;
    this.depth = 0;

    this.parent = undefined;
    this.children = [];

    this.position = opts.position != undefined ? opts.position : new Vec3;
    this.rotation = opts.rotation != undefined ? opts.rotation : new Quat;
    this.scale = opts.scale != undefined ? opts.scale : new Vec3(1, 1, 1);

    this.matrix = new Mat4;
    this.matrixWorld = new Mat4;

    this.modelView = new Mat4;
    this.normalMatrix = new Mat3;
}

Component.extend(Transform);


Transform.prototype.copy = function (other) {
    var children = other.children,
        i = children.length;

    this.position.copy(other.position);
    this.scale.copy(other.scale);
    this.rotation.copy(other.rotation);

    while (i--) this.addChild(children[i].gameObject.clone().transform);
    if (other.parent) other.parent.addChild(this);

    return this;
};

Transform.prototype.clear = function () {
    Component.prototype.clear.call(this);
    var children = this.children,
        i = children.length;

    while (i--) this.removeChild(children[i]);

    this.position.set(0, 0, 0);
    this.scale.set(1, 1, 1);
    this.rotation.set(0, 0, 0, 1);

    this.root = this;
    this.depth = 0;

    return this;
};


Transform.prototype.translate = function () {
    var vec = new Vec3;

    return function (translation, relativeTo) {
        vec.copy(translation);

        if (relativeTo instanceof Transform) {
            vec.transformQuat(relativeTo.rotation);
        } else if (relativeTo instanceof Quat) {
            vec.transformQuat(relativeTo);
        }

        this.position.add(vec);

        return this;
    };
}();


Transform.prototype.rotate = function () {
    var vec = new Vec3;

    return function (rotation, relativeTo) {
        vec.copy(rotation);

        if (relativeTo instanceof Transform) {
            vec.transformQuat(relativeTo.rotation);
        } else if (relativeTo instanceof Quat) {
            vec.transformQuat(relativeTo);
        }

        this.rotation.rotate(vec.x, vec.y, vec.z);

        return this;
    };
}();


Transform.prototype.lookAt = function () {
    var mat = new Mat4,
        vec = new Vec3,
        dup = new Vec3(0.0, 0.0, 1.0);

    return function (target, up) {
        up = up || dup;

        if (target instanceof Transform) {
            vec.set(0.0, 0.0, 0.0).transformMat4(target.matrixWorld);
        } else {
            vec.copy(target);
        }

        mat.lookAt(this.position, vec, up);
        this.rotation.fromMat4(mat);

        return this;
    };
}();


Transform.prototype.follow = function () {
    var target = new Vec3,
        position = new Vec3,
        delta = new Vec3;

    return function (transform, speed) {
        position.set(0.0, 0.0, 0.0).transformMat4(this.matrixWorld);
        target.set(0.0, 0.0, 0.0).transformMat4(transform.matrixWorld);

        delta.vsub(target, position);

        if (delta.lengthSq() > EPSILON) this.position.add(delta.smul(speed));

        return this;
    };
}();


Transform.prototype.addChild = function (child, others) {
    if (!(child instanceof Transform)) {
        Log.error("Transform.add: can\'t add passed argument, it is not an instance of Transform");
        return this;
    }
    var children = this.children,
        index = children.indexOf(child),
        root, depth, scene;

    if (index === -1) {
        if (child.parent) child.parent.removeChild(child);

        child.parent = this;
        children.push(child);

        root = this;
        depth = 0;

        while (root.parent) {
            root = root.parent;
            depth++;
        }
        child.root = root;
        this.root = root;

        updateDepth(this, depth);
        if (!others) {
            if (this.gameObject && (scene = this.gameObject.scene)) {
                scene.componentManagers.Transform.sort();
            }
        }
    } else {
        Log.error("Transform.add: child is not a member of this Transform");
    }

    return this;
};


Transform.prototype.addChildren = function () {
    var i, il, scene;

    for (i = 0, il = arguments.length; i < il; i++) this.addChild(arguments[i], true);
    if (this.gameObject && (scene = this.gameObject.scene)) {
        scene.componentManagers.Transform.sort();
    }
    return this;
};


Transform.prototype.removeChild = function (child, others) {
    var children = this.children,
        index = children.indexOf(child),
        root, depth, scene;

    if (index !== -1) {
        child.parent = undefined;
        children.splice(index, 1);

        root = this;
        depth = 0;

        while (root.parent) {
            root = root.parent;
            depth++;
        }
        child.root = child;
        this.root = root;

        updateDepth(this, depth);
        if (!others) {
            if (this.gameObject && (scene = this.gameObject.scene)) {
                scene.componentManagers.Transform.sort();
            }
        }
    } else {
        Log.error("Transform.remove: child is not a member of this Transform");
    }

    return this;
};


Transform.prototype.removeChildren = function () {
    var i, il, scene;

    for (i = 0, il = arguments.length; i < il; i++) this.removeChild(arguments[i], true);
    if (this.gameObject && (scene = this.gameObject.scene)) {
        scene.componentManagers.Transform.sort();
    }
    return this;
};


Transform.prototype.detachChildren = function () {
    var children = this.children,
        i = children.length;

    while (i--) this.removeChild(children[i]);
    return this;
};


Transform.prototype.hasChild = function (child) {

    return !!~this.children.indexOf(child);
};


Transform.prototype.find = function (name) {
    var children = this.children,
        child,
        i = children.length;

    while (i--) {
        child = children[i];

        if (child.gameObject.name === name) return child.gameObject;
        if ((child = child.find(name))) return child;
    }

    return undefined;
};


Transform.prototype.toWorld = function (v) {

    return v.transformMat4(this.matrixWorld);
};


Transform.prototype.toLocal = function () {
    var mat = new Mat4;

    return function (v) {

        return v.transformMat4(mat.inverseMat(this.matrixWorld));
    };
}();


Transform.prototype.update = function () {
    var matrix = this.matrix,
        parent = this.parent;

    matrix.compose(this.position, this.scale, this.rotation);

    if (parent) {
        this.matrixWorld.mmul(parent.matrixWorld, matrix);
    } else {
        this.matrixWorld.copy(matrix);
    }
};


Transform.prototype.updateMatrices = function (viewMatrix) {

    this.modelView.mmul(viewMatrix, this.matrixWorld);
    this.normalMatrix.inverseMat4(this.modelView).transpose();
};


Transform.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);
    var children = this.children,
        jsonChildren = json.children || (json.children = []),
        i = children.length;

    while (i--) jsonChildren[i] = children[i]._id;

    json.position = this.position.toJSON(json.position);
    json.scale = this.scale.toJSON(json.scale);
    json.rotation = this.rotation.toJSON(json.rotation);

    return json;
};


Transform.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);
    var children = json.children,
        i = children.length,
        child, scene;

    if (this.gameObject && (scene = this.gameObject.scene)) {
        while (i--) {
            child = scene.findComponentByJSONId(children[i]);

            if (!this.hasChild(child)) {
                this.addChild(child);
            }
        }
    } else {
        this.once("start", function () {
            var scene = this.gameObject.scene;

            while (i--) {
                child = scene.findComponentByJSONId(children[i]);

                if (!this.hasChild(child)) {
                    this.addChild(child);
                }
            }
        });
    }

    this.position.fromJSON(json.position);
    this.scale.fromJSON(json.scale);
    this.rotation.fromJSON(json.rotation);

    return this;
};


function updateDepth(transform, depth) {
    var children = transform.children,
        i = children.length;

    transform.depth = depth;

    while (i--) updateDepth(children[i], depth + 1);
}


module.exports = Transform;

},{"../../base/log":14,"../../math/mat3":104,"../../math/mat4":106,"../../math/mathf":107,"../../math/quat":108,"../../math/vec3":112,"./component":54}],72:[function(require,module,exports){
var Mathf = require("../../math/mathf");
var Vec2 = require("../../math/vec2");
var Mat32 = require("../../math/mat32");
var Mat3 = require("../../math/mat3");
var Mat4 = require("../../math/mat4");
var Component = require("./component");
var Config = require("../../base/config");
var Log = require("../../base/log");
"use strict";


var EPSILON = Mathf.EPSILON;


function Transform2D(opts) {
    opts || (opts = {});
    opts.sync = opts.sync != undefined ? opts.sync : true;

    Component.call(this, "Transform2D", opts);

    this.root = this;
    this.depth = 0;

    this.parent = undefined;
    this.children = [];

    this.position = opts.position != undefined ? opts.position : new Vec2;
    this.rotation = opts.rotation != undefined ? opts.rotation : 0;
    this.scale = opts.scale != undefined ? opts.scale : new Vec2(1, 1);

    this.matrix = new Mat4;
    this.matrixWorld = new Mat4;

    this.modelView = new Mat4;
    this.normalMatrix = new Mat3;
}

Component.extend(Transform2D);


Transform2D.prototype.copy = function (other) {
    var children = other.children,
        i = children.length;

    this.position.copy(other.position);
    this.scale.copy(other.scale);
    this.rotation = other.rotation;

    while (i--) this.addChild(children[i].gameObject.clone().transform);
    if (other.parent) other.parent.addChild(this);

    return this;
};


Transform2D.prototype.clear = function () {
    Component.prototype.clear.call(this);
    var children = this.children,
        i = children.length;

    while (i--) this.removeChild(children[i]);

    this.position.set(0, 0);
    this.scale.set(1, 1);
    this.rotation = 0;

    this.root = this;
    this.depth = 0;

    return this;
};


Transform2D.prototype.translate = function () {
    var vec = new Vec2;

    return function (translation, relativeTo) {
        vec.copy(translation);

        if (relativeTo instanceof Transform2D) {
            vec.transformAngle(relativeTo.rotation);
        } else if (relativeTo) {
            vec.transformAngle(relativeTo);
        }

        this.position.add(vec);

        return this;
    };
}();


Transform2D.prototype.rotate = function (rotation, relativeTo) {

    if (relativeTo instanceof Transform2D) {
        rotation += relativeTo.rotation;
    } else if (relativeTo) {
        rotation += relativeTo;
    }

    this.rotation += rotation;

    return this;
};


Transform2D.prototype.lookAt = function () {
    var mat = new Mat32,
        vec = new Vec2;

    return function (target) {

        if (target instanceof Transform2D) {
            vec.copy(target.position);
        } else {
            vec.copy(target);
        }

        mat.lookAt(this.position, vec);
        this.rotation = mat.getRotation();

        return this;
    };
}();


Transform2D.prototype.follow = function () {
    var target = new Vec2,
        position = new Vec2,
        delta = new Vec2;

    return function (transform, speed) {
        position.set(0, 0).transformMat4(this.matrixWorld);
        target.set(0, 0).transformMat4(transform.matrixWorld);

        delta.vsub(target, position);

        if (delta.lengthSq() > EPSILON) this.position.add(delta.smul(speed));

        return this;
    };
}();


Transform2D.prototype.addChild = function (child, others) {
    if (!(child instanceof Transform2D)) {
        Log.error("Transform2D.add: can\'t add passed argument, it is not an instance of Transform2D");
        return this;
    }
    var children = this.children,
        index = children.indexOf(child),
        root, depth, scene;

    if (index === -1) {
        if (child.parent) child.parent.remove(child);

        child.parent = this;
        children.push(child);

        root = this;
        depth = 0;

        while (root.parent) {
            root = root.parent;
            depth++;
        }
        child.root = root;
        this.root = root;

        updateDepth(this, depth);
        if (!others) {
            if (this.gameObject && (scene = this.gameObject.scene)) {
                scene.componentManagers.Transform2D.sort();
            }
        }
    } else {
        Log.error("Transform2D.add: child is not a member of this Transform2D");
    }

    return this;
};


Transform2D.prototype.addChildren = function () {
    var i, il, scene;

    for (i = 0, il = arguments.length; i < il; i++) this.addChild(arguments[i], true);
    if (this.gameObject && (scene = this.gameObject.scene)) {
        scene.componentManagers.Transform2D.sort();
    }
    return this;
};


Transform2D.prototype.removeChild = function (child, others) {
    var children = this.children,
        index = children.indexOf(child),
        root, depth, scene;

    if (index !== -1) {
        child.parent = undefined;
        children.splice(index, 1);

        root = this;
        depth = 0;

        while (root.parent) {
            root = root.parent;
            depth++;
        }
        child.root = child;
        this.root = root;

        updateDepth(this, depth);
        if (!others) {
            if (this.gameObject && (scene = this.gameObject.scene)) {
                scene.componentManagers.Transform2D.sort();
            }
        }
    } else {
        Log.error("Transform2D.remove: child is not a member of this Transform2D");
    }

    return this;
};


Transform2D.prototype.removeChildren = function () {
    var i, il, scene;

    for (i = 0, il = arguments.length; i < il; i++) this.removeChild(arguments[i], true);
    if (this.gameObject && (scene = this.gameObject.scene)) {
        scene.componentManagers.Transform2D.sort();
    }
    return this;
};


Transform2D.prototype.detachChildren = function () {
    var i = arguments.length;

    while (i--) this.removeChild(children[i]);
    return this;
};


Transform2D.prototype.hasChild = function (child) {

    return !!~this.children.indexOf(child);
};


Transform2D.prototype.find = function (name) {
    var children = this.children,
        child,
        i = children.length;

    while (i--) {
        child = children[i];

        if (child.gameObject.name === name) return child;
        if ((child = child.find(name))) return child;
    }

    return undefined;
};


Transform2D.prototype.toWorld = function (v) {

    return v.transformMat4(this.matrixWorld);
};


Transform2D.prototype.toLocal = function () {
    var mat = new Mat4;

    return function (v) {

        return v.transformMat4(mat.inverseMat(this.matrixWorld));
    };
}();


Transform2D.prototype.update = function () {
    var mat = new Mat32;

    return function () {
        var matrix = this.matrix,
            parent = this.parent;

        matrix.fromMat32(mat.compose(this.position, this.scale, this.rotation));

        if (parent) {
            this.matrixWorld.mmul(parent.matrixWorld, matrix);
        } else {
            this.matrixWorld.copy(matrix);
        }
    };
}();


Transform2D.prototype.updateMatrices = function (viewMatrix) {

    this.modelView.mmul(viewMatrix, this.matrixWorld);
    this.normalMatrix.inverseMat4(this.modelView).transpose();
};


Transform2D.prototype.toJSON = function (json) {
    json = Component.prototype.toJSON.call(this, json);
    var children = this.children,
        jsonChildren = json.children || (json.children = []),
        i = children.length;

    while (i--) jsonChildren[i] = children[i]._id;

    json.position = this.position.toJSON(json.position);
    json.scale = this.scale.toJSON(json.scale);
    json.rotation = this.rotation

    return json;
};


Transform2D.prototype.fromJSON = function (json) {
    Component.prototype.fromJSON.call(this, json);
    var children = json.children,
        i = children.length,
        child, scene;

    if (this.gameObject && (scene = this.gameObject.scene)) {
        while (i--) {
            child = scene.findComponentByJSONId(children[i]);

            if (!this.hasChild(child)) {
                this.addChild(child);
            }
        }
    } else {
        this.once("start", function () {
            var scene = this.gameObject.scene;

            while (i--) {
                child = scene.findComponentByJSONId(children[i]);

                if (!this.hasChild(child)) {
                    this.addChild(child);
                }
            }
        });
    }

    this.position.fromJSON(json.position);
    this.scale.fromJSON(json.scale);
    this.rotation = json.rotation;

    return this;
};


function updateDepth(transform, depth) {
    var children = transform.children,
        i = children.length;

    transform.depth = depth;
    while (i--) updateDepth(children[i], depth + 1);
}


module.exports = Transform2D;

},{"../../base/config":9,"../../base/log":14,"../../math/mat3":104,"../../math/mat32":105,"../../math/mat4":106,"../../math/mathf":107,"../../math/vec2":111,"./component":54}],73:[function(require,module,exports){
var Enum = require("../base/enum");
"use strict";


module.exports = {
    AxisType: new Enum("Button Mouse MouseWheel Touch Joystick"),

    Blending: new Enum("Default None Additive Subtractive Muliply Custom"),
    Side: new Enum("Front Back Both"),

    CullFace: new Enum("None Back Front FrontBack"),

    EmitterType: new Enum("Circle Box Sphere"),

    LightType: new Enum("Point Directional Spot Hemi"),

    TextClipping: new Enum("Overflow Clip"),
    TextAnchor: new Enum("Left Center Right"),

    ShadowMapType: new Enum("BasicShadowMap PCFShadowMap PCFSoftShadowMap"),

    FilterMode: new Enum("None Linear"),
    TextureFormat: new Enum("RGB RGBA Luminance Alpha LuminanceAlpha"),
    TextureWrap: new Enum("Repeat Clamp MirrorRepeat"),

    WrapMode: new Enum("Once Loop PingPong Clamp")
};

},{"../base/enum":12}],74:[function(require,module,exports){
var Class = require("../../base/class");
var Loop = require("./loop");
var Scene = require("../scene");
var GUI = require("../gui/gui");
var Log = require("./../../base/log");
"use strict";


function BaseGame() {

    Class.call(this);

    this._loop = new Loop(this.loop, this);

    this.guis = [];
    this._guiHash = {};
    this._guiJSONHash = {};
    this._guiNameHash = {};

    this.scenes = [];
    this._sceneHash = {};
    this._sceneJSONHash = {};
    this._sceneNameHash = {};
}

Class.extend(BaseGame);


BaseGame.prototype.init = function () {

    this._loop.resume();
    this.emit("init");

    return this;
};


BaseGame.prototype.clear = function () {
    var scenes = this.scenes,
        i = scenes.length;

    while (i--) this.removeScene(scenes[i], true);
    return this;
};


BaseGame.prototype.destroy = function () {

    this.emit("destroy");
    this.clear();

    return this;
};


BaseGame.prototype.addScene = function (scene) {
    if (!(scene instanceof Scene)) {
        Log.error("BaseGame.addScene: can't add argument to BaseGame, it's not an instance of Scene");
        return this;
    }
    var sceneHash = this._sceneHash,
        sceneNameHash = this._sceneNameHash,
        name = scene.name,
        id = scene._id,
        json;

    if (!sceneNameHash[name] && !sceneHash[id]) {
        json = scene.toJSON();

        sceneNameHash[name] = json;
        sceneHash[id] = json;
        this.scenes.push(json);
        if (scene._jsonId !== -1) this._sceneJSONHash[scene._jsonId] = json;

        this.emit("addScene", name);
    } else {
        Log.error("BaseGame.addScene: Scene is already a member of BaseGame");
    }

    return this;
};


BaseGame.prototype.addScenes = function () {
    var i, il;

    for (i = 0, il = arguments.length; i < il; i++) this.addScene(arguments[i]);
    return this;
};


BaseGame.prototype.removeScene = function (scene) {
    if (typeof(scene) === "string") {
        scene = this._sceneNameHash[scene];
    } else if (typeof(scene) === "number") {
        scene = this._sceneHash[scene];
    }
    var scenes = this.scenes,
        sceneHash = this._sceneHash,
        sceneNameHash = this._sceneNameHash,
        name = scene.name,
        id = scene._id,
        json;

    if (sceneNameHash[name] && sceneHash[id]) {
        json = sceneNameHash[name];

        sceneNameHash[name] = undefined;
        sceneHash[id] = undefined;
        scenes.splice(scenes.indexOf(json), 1);
        if (json._jsonId !== -1) this._sceneJSONHash[json._jsonId] = undefined;

        this.emit("removeScene", name);
    } else {
        Log.error("BaseGame.removeScene: Scene not a member of BaseGame");
    }

    return this;
};


BaseGame.prototype.removeScenes = function () {
    var i, il;

    for (i = 0, il = arguments.length; i < il; i++) this.removeScene(arguments[i]);
    return this;
};


BaseGame.prototype.addGUI = function (gui) {
    if (!(gui instanceof GUI)) {
        Log.error("BaseGame.addGUI: can't add argument to BaseGame, it's not an instance of GUI");
        return this;
    }
    var guiHash = this._guiHash,
        guiNameHash = this._guiNameHash,
        name = gui.name,
        id = gui._id,
        json;

    if (!guiNameHash[name] && !guiHash[id]) {
        json = gui.toJSON();

        guiNameHash[name] = json;
        guiHash[id] = json;
        this.guis.push(json);
        if (gui._jsonId !== -1) this._guiJSONHash[gui._jsonId] = json;

        this.emit("addGUI", name);
    } else {
        Log.error("BaseGame.addGUI: GUI is already a member of BaseGame");
    }

    return this;
};


BaseGame.prototype.addGUIs = function () {
    var i = arguments.length;

    while (i--) this.addGUI(arguments[i]);
    return this;
};


BaseGame.prototype.removeGUI = function (gui) {
    if (typeof(gui) === "string") {
        gui = this._guiNameHash[gui];
    } else if (typeof(gui) === "number") {
        gui = this._guiHash[gui];
    }
    var guis = this.guis,
        guiHash = this._guiHash,
        guiNameHash = this._guiNameHash,
        name = gui.name,
        id = gui._id,
        json;

    if (guiNameHash[name] && guiHash[id]) {
        json = guiNameHash[name];

        guiNameHash[name] = undefined;
        guiHash[id] = undefined;
        guis.splice(guis.indexOf(json), 1);
        if (json._jsonId !== -1) this._guiJSONHash[json._jsonId] = undefined;

        this.emit("removeGUI", name);
    } else {
        Log.error("BaseGame.removeGUI: GUI not a member of BaseGame");
    }

    return this;
};


BaseGame.prototype.removeGUIs = function () {
    var i = arguments.length;

    while (i--) this.removeGUI(arguments[i]);
    return this;
};


BaseGame.prototype.findSceneByName = function (name) {

    return this._sceneNameHash[name];
};


BaseGame.prototype.findSceneById = function (id) {

    return this._sceneHash[id];
};


BaseGame.prototype.findSceneByJSONId = function (id) {

    return this._sceneJSONHash[id];
};


BaseGame.prototype.pause = function () {

    this._loop.pause();
    return this;
};


BaseGame.prototype.resume = function () {

    this._loop.resume();
    return this;
};


BaseGame.prototype.loop = function () {

    this.emit("update", Time.sinceStart);
};


BaseGame.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);
    var scenes = this.scenes,
        jsonScenes = json.scenes || (json.scenes = []),
        i = scenes.length;

    while (i--) jsonScenes[i] = scenes[i];

    return json;
};


BaseGame.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);
    var jsonScenes = json.scenes,
        scene, jsonScene,
        i = jsonScenes.length;

    while (i--) {
        jsonScene = jsonScenes[i];

        if ((scene = this.findSceneByJSONId(jsonScene._id))) {
            this.removeScene(scene).addScene(jsonScene);
        } else {
            this.addScene(jsonScene);
        }
    }

    return this;
};


module.exports = BaseGame;

},{"../../base/class":8,"../gui/gui":81,"../scene":97,"./../../base/log":14,"./loop":76}],75:[function(require,module,exports){
var Class = require("../../base/class");
var Device = require("../../base/device");
var Time = require("../../base/time");
var Mathf = require("../../math/mathf");
var Config = require("./../../base/config");
var BaseGame = require("./base_game");
var Canvas = require("../renderer/canvas");
var Renderer = require("../renderer/renderer");
var GameObject = require("../game_object");
var Component = require("../components/component");
var Scene = require("../scene");
var Input = require("../input/input");
var Handler = require("../input/handler");
var Log = require("./../../base/log");
"use strict";


function Game(opts) {
    opts || (opts = {});
    Config.fromJSON(opts);

    BaseGame.call(this);

    this._handler = Handler;
    this.input = Input;

    this.gui = undefined;

    this.scene = undefined;
    this.camera = undefined;

    this.canvas = new Canvas(opts.canvas);
    this.renderer = new Renderer(opts.renderer);
}

BaseGame.extend(Game);


Game.prototype.init = function () {
    var canvas = this.canvas;

    canvas.init();
    this.renderer.init(canvas);
    Handler.setElement(canvas.element);

    this._loop.resume();
    this.emit("init");

    return this;
};


Game.prototype.start = function () {

    this.init();
    this.emit("start");

    return this;
};


Game.prototype.setGUI = function (gui) {
    if (typeof(gui) === "string") {
        gui = this._guiNameHash[gui];
    } else if (typeof(gui) === "number") {
        gui = this.guis[gui];
    }

    if (this._guiNameHash[gui.name] && this._guiHash[gui._id]) {
        if (this.gui) this.gui.destroy();

        gui = Class.fromJSON(gui);
        this.gui = gui;

        gui.game = this;

        gui.init();
        gui.emit("init");

        gui.start();
        gui.emit("start");

        this.emit("setGUI", this.gui);
    } else {
        Log.error("Game.setGUI: GUI is not a member of Game");
    }

    return this;
};


Game.prototype.setScene = function (scene) {
    if (typeof(scene) === "string") {
        scene = this._sceneNameHash[scene];
    } else if (typeof(scene) === "number") {
        scene = this.scenes[scene];
    }

    if (this._sceneNameHash[scene.name] && this._sceneHash[scene._id]) {
        if (this.scene) this.scene.destroy();

        scene = Class.fromJSON(scene);
        this.scene = scene;

        scene.game = this;

        scene.init();
        scene.emit("init");

        scene.start();
        scene.emit("start");

        this.emit("setScene", this.scene);
    } else {
        Log.error("Game.setScene: Scene is not a member of Game");
    }

    return this;
};


Game.prototype.setCamera = function (gameObject) {
    if (!(gameObject instanceof GameObject)) {
        Log.error("Game.setCamera: can't set argument to Game's Active Camera, it's not an instance of GameObject");
        return this;
    }
    var scene = this.scene,
        lastCamera = this.camera,
        index;

    if (!scene) {
        Log.error("Game.setCamera: can't set camera without an active scene, use Game.setScene first");
        return this;
    }

    index = scene.gameObjects.indexOf(gameObject);
    if (index === -1) {
        Log.warn("Game.setCamera: GameObject is not a member of the active Scene, adding it...");
        scene.addGameObject(gameObject);
    }

    this.camera = gameObject.camera || gameObject.camera2d;

    if (this.camera) {
        this.camera._active = true;
        if (lastCamera) lastCamera._active = false;

        this.emit("setCamera", this.camera);
    } else {
        Log.error("Game.setCamera: GameObject does't have a Camera or a Camera2D Component");
    }

    return this;
};


Game.prototype.loop = function () {
    var camera = this.camera,
        scene = this.scene,
        gui = this.gui,
        renderer = this.renderer;

    Time.update();
    Input.update();

    this.emit("update", Time.sinceStart);
    if (renderer && camera) {

        if (scene) {
            scene.update();
            scene.emit("update");
        }
        if (gui) {
            gui.aspect = camera.aspect;
            gui.width = camera.width;
            gui.height = camera.height;
            gui.invWidth = camera.invWidth;
            gui.invHeight = camera.invHeight;

            gui.update();
            gui.emit("update");
        }

        renderer.render(camera, scene, gui);
    }
    this.emit("lateUpdate", Time.sinceStart);
}


module.exports = Game;

},{"../../base/class":8,"../../base/device":10,"../../base/time":18,"../../math/mathf":107,"../components/component":54,"../game_object":77,"../input/handler":87,"../input/input":88,"../renderer/canvas":92,"../renderer/renderer":95,"../scene":97,"./../../base/config":9,"./../../base/log":14,"./base_game":74}],76:[function(require,module,exports){
var requestAnimationFrame = require("../../base/request_animation_frame");
var Log = require("./../../base/log");
"use strict";


function Loop(callback, ctx) {
    ctx || (ctx = this);

    this.paused = true;

    this.callback = callback;
    this.ctx = ctx || this;

    var _this = this;
    this._run = function (ms) {

        if (_this.callback) {
            _this.callback.call(ctx, ms);

            if (!_this.paused) _this._pump();
        }
    }
}


Loop.prototype.resume = function () {
    if (!this.callback) {
        Log.warn("Loop.resume: can't run loop without callback");
        return;
    }

    this.paused = false;
    this._pump();
};


Loop.prototype.pause = function () {

    this.paused = true;
};


Loop.prototype.isRunning = function () {

    return !this.paused;
};


Loop.prototype.isPaused = function () {

    return this.paused;
};


Loop.prototype._pump = function () {

    requestAnimationFrame(this._run);
};


module.exports = Loop;

},{"../../base/request_animation_frame":16,"./../../base/log":14}],77:[function(require,module,exports){
var Class = require("../base/class");
var Component = require("./components/component");
var Log = require("./../base/log");
"use strict";

/**
 * @class GameObject
 * @extends Class
 * @memberof Odin
 * @brief Base class for entities in scenes
 * @param Object options
 */
function GameObject(opts) {
    opts || (opts = {});

    Class.call(this);

    this.name = opts.name != undefined ? opts.name : "GameObject_" + this._id;

    this.scene = undefined;

    this.tags = [];

    this.components = [];
    this._componentType = {};
    this._componentHash = {};
    this._componentJSONHash = {};

    if (opts.tag) this.addTag(opts.tag);
    if (opts.tags) this.addTags.apply(this, opts.tags);

    if (opts.components) this.addComponents.apply(this, opts.components);
}

Class.extend(GameObject);


GameObject.prototype.copy = function (other) {
    var components = this.components,
        otherComponents = other.components,
        tags = other.tags,
        otherComponent, component,
        i = components.length;

    while (i--) {
        component = components[i];
        if (!other.hasComponent(component._className)) this.removeComponent(component);
    }

    i = otherComponents.length;
    while (i--) {
        otherComponent = otherComponents[i];

        if ((component = this.getComponent(otherComponent._type))) {
            component.copy(otherComponent);
        } else {
            this.addComponent(otherComponent.clone());
        }
    }

    i = tags.length;
    while (i--) this.addTag(tags[i]);

    return this;
};


GameObject.prototype.clear = function () {
    var components = this.components,
        tags = this.tags,
        componentLength = components.length,
        i;

    i = componentLength;
    while (i--) components[i].clear();

    i = tags.length;
    while (i--) this.removeTag(tags[i]);

    i = componentLength;
    while (i--) this.removeComponent(components[i]);

    this.off();

    return this;
};


GameObject.prototype.destroy = function () {
    if (!this.scene) {
        Log.error("GameObject.destroy: can't destroy GameObject if it's not added to a Scene");
        return this;
    }

    this.scene.removeGameObject(this);
    this.emit("destroy");

    this.clear();

    return this;
};


GameObject.prototype.remove = function () {
    if (!this.scene) {
        Log.error("GameObject.remove: can't remove GameObject if it's not added to a Scene");
        return this;
    }

    this.scene.removeGameObject(this);
    return this;
};


GameObject.prototype.addTag = function (tag) {
    var tags = this.tags;

    if (tags.indexOf(tag) === -1) tags.push(tag);

    return this;
};


GameObject.prototype.addTags = function () {
    var i = arguments.length;

    while (i--) this.addTag(arguments[i]);
    return this;
};


GameObject.prototype.removeTag = function (tag) {
    var tags = this.tags,
        index = tags.indexOf(tag);

    if (index !== -1) tags.splice(index, 1);

    return this;
};


GameObject.prototype.removeTags = function () {
    var i = arguments.length;

    while (i--) this.removeTag(arguments[i]);
    return this;
};


GameObject.prototype.hasTag = function (tag) {

    return this.tags.indexOf(tag) !== -1;
};


GameObject.prototype.addComponent = function (component, others) {
    if (typeof(component) === "string") component = new Class._classes[component];
    if (!(component instanceof Component)) {
        Log.error("GameObject.addComponent: can't add passed argument, it is not an instance of Component");
        return this;
    }
    var name = component._name,
        components = this.components,
        comp, i, j;


    if (!this[name]) {
        if (component.gameObject) component = component.clone();

        components.push(component);
        this._componentType[component._type] = component;
        this._componentHash[component._id] = component;
        if (component._jsonId !== -1) this._componentJSONHash[component._jsonId] = component;

        component.gameObject = this;
        this[name] = component;

        if (!others) {
            i = components.length;
            while (i--) {
                comp = components[i];
                if (!comp) continue;

                j = components.length;
                while (j--) comp[components[j]._name] = components[j];
            }

            component.init();
            component.emit("init");
        }

        this.emit("add" + component._type, component);
        this.emit("addComponent", component);
        component.emit("add", this);

        if (this.scene) this.scene._addComponent(component);
    } else {
        Log.error("GameObject.addComponent: GameObject already has a(n) " + component._type + " Component");
    }

    return this;
};


GameObject.prototype.addComponents = function () {
    var length = arguments.length,
        components = this.components,
        component, name,
        i, j;

    i = length;
    while (i--) this.addComponent(arguments[i], true);

    i = components.length;
    while (i--) {
        component = components[i];
        if (!component) continue;

        j = components.length;
        while (j--) {
            name = components[j]._name;
            component[name] = components[j];
        }
    }

    i = components.length;
    while (i--) {
        component = components[i];
        component.init();
        component.emit("init");
    }

    return this;
};


GameObject.prototype.removeComponent = function (component, clear, others) {
    if (typeof(component) === "string") component = this.getComponent(component);
    if (!(component instanceof Component)) {
        Log.error("GameObject.removeComponent: can't remove passed argument, it is not an instance of Component");
        return this;
    }
    var name = component._name,
        components = this.components,
        comp, i, j;

    if (this[name]) {
        component.emit("remove", this);
        this.emit("remove" + component._type, component);
        this.emit("removeComponent", component);

        if (!others) {
            i = components.length;
            while (i--) {
                comp = components[i];
                if (!comp) continue;

                j = components.length;
                while (j--) {
                    if (name === components[j]._name) comp[name] = undefined;
                }
            }
        }

        components.splice(components.indexOf(component), 1);
        this._componentType[component._type] = undefined;
        this._componentHash[component._id] = undefined;
        if (component._jsonId !== -1) this._componentJSONHash[component._jsonId] = undefined;

        component.gameObject = undefined;
        this[name] = undefined;

        if (this.scene) this.scene._removeComponent(component);
        if (clear) component.clear();
    } else {
        Log.error("GameObject.removeComponent: GameObject does not have a(n) " + type + " Component");
    }

    return this;
};


GameObject.prototype.removeComponents = function () {
    var length = arguments.length,
        components = this.components,
        toRemove = arguments,
        component, name,
        i, j;

    i = length;
    while (i--) this.removeComponent(arguments[i], null, true);

    i = components.length;
    while (i--) {
        component = components[i];
        if (!component) continue;

        name = component._name;
        j = toRemove.length;
        while (j--) {
            if (name === toRemove[i]._name) component[name] = undefined;
        }
    }

    return this;
};


GameObject.prototype.getComponent = function (type) {

    return this._componentType[type];
};


GameObject.prototype.hasComponent = function (type) {
    var components = this.components,
        i = components.length;
    ;

    while (i--) {
        if (components[i]._type === type) return true;
    }

    return false;
};


GameObject.prototype.find = function (name) {
    var transform = this.transform || this.transform2d,
        children, child, i;

    if (!transform) return undefined;

    children = transform.children;
    i = children.length;

    while (i--) {
        child = children[i];

        if (child.gameObject.name === name) return child.gameObject;
        if ((child = child.find(name))) return child;
    }

    return undefined;
};


GameObject.prototype.findComponentById = function (id) {

    return this._componentHash[id];
};


GameObject.prototype.findComponentByJSONId = function (id) {

    return this._componentJSONHash[id];
};


GameObject.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);
    var components = this.components,
        jsonComponents = json.components || (json.components = []),
        tags = this.tags,
        jsonTags = json.tags || (json.tags = []),
        component,
        i = components.length;

    while (i--) {
        if ((component = components[i]).json) jsonComponents[i] = component.toJSON(jsonComponents[i]);
    }
    i = tags.length;
    while (i--) jsonTags[i] = tags[i];

    json.name = this.name;

    return json;
};


GameObject.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);
    var components = this.components,
        jsonComponents = json.components || (json.components = []),
        component, jsonComponent, tag,
        tags = this.tags,
        jsonTags = json.tags || (json.tags = []),
        i = components.length,
        has, type, j;

    while (i--) {
        component = components[i];
        type = component._type;
        has = false;

        j = jsonComponents.length;
        while (j--) {
            jsonComponent = jsonComponents[i];
            if (type === jsonComponent._type) has = true;
        }

        if (!has) this.removeComponent(component);
    }

    i = jsonComponents.length;
    while (i--) {
        if (!(jsonComponent = jsonComponents[i])) continue;

        if ((component = this.findComponentByJSONId(jsonComponent._id)) || (component = this.getComponent(jsonComponent._type))) {
            component.fromJSON(jsonComponent);
        } else {
            this.addComponent(Class.fromJSON(jsonComponent));
        }
    }

    i = jsonTags.length;
    while (i--) {
        if (tags.indexOf((tag = jsonTags[i])) === -1) tags.push(tag);
    }

    this.name = json.name;

    return this;
};


module.exports = GameObject;

},{"../base/class":8,"./../base/log":14,"./components/component":54}],78:[function(require,module,exports){
var Class = require("../../../base/class");
var GUIComponent = require("../components/gui_component");
"use strict";


function GUIComponentManager(order) {

    Class.call(this);

    this.order = order || 0;

    this.gui = undefined;
    this.components = [];
}

Class.extend(GUIComponentManager);


GUIComponentManager.prototype.forEach = function (fn, ctx) {
    var components = this.components,
        i = 0,
        il = components.length;

    if (ctx) {
        for (; i < il; i++) fn.call(ctx, components[i], i, components);
    } else {
        for (; i < il; i++) fn(components[i], i, components);
    }
};


GUIComponentManager.prototype.start = function () {
    var components = this.components,
        i = 0,
        il = components.length;

    for (; i < il; i++) components[i].start();
};


GUIComponentManager.prototype.init = function () {
    var components = this.components,
        i = 0,
        il = components.length;

    for (; i < il; i++) components[i].init();
};


GUIComponentManager.prototype.update = function () {
    var components = this.components,
        i = 0,
        il = components.length;

    for (; i < il; i++) components[i].update();
};


GUIComponentManager.prototype.sort = function () {

    this.components.sort(this.sortFunction);
};


GUIComponentManager.prototype.sortFunction = function (a, b) {

    return a._id - b._id;
};


GUIComponentManager.prototype.empty = function () {

    return this.components.length === 0;
};


GUIComponentManager.prototype.add = function (component) {
    if (!(component instanceof GUIComponent)) {
        Log.error(this._className + ".add: can't add argument to " + this._className + ", it's not an instance of GUIComponent");
        return;
    }
    var components = this.components,
        index = components.indexOf(component);

    if (index === -1) {
        components.push(component);
    } else {
        Log.error(this._className + ".add: GUIComponent is already a member of " + this._className);
    }
};


GUIComponentManager.prototype.remove = function (component) {
    if (!(component instanceof GUIComponent)) {
        Log.error(this._className + ".remove: can't remove argument from " + this._className + ", it's not an instance of GUIComponent");
        return;
    }
    var components = this.components,
        index = components.indexOf(component);

    if (index !== -1) {
        components.splice(index, 1);
    } else {
        Log.error(this._className + ".remove: GUIComponent is not a member of " + this._className);
    }
};


module.exports = GUIComponentManager;

},{"../../../base/class":8,"../components/gui_component":79}],79:[function(require,module,exports){
var Class = require("../../../base/class");
var util = require("../../../base/util");
var Log = require("../../../base/log");
"use strict";


var camelize = util.camelize;


function GUIComponent(type, opts) {
    opts || (opts = {});
    if (!type) Log.error("GUIComponent defined without a type, use GUIComponent.call(this, \"GUIComponentName\", { sync: Boolean, json: Boolean })");


    Class.call(this);

    this._type = type || "UnknownGUIComponent";
    this._name = camelize(this._type, true);

    this.sync = opts.sync != undefined ? !!opts.sync : false;
    this.json = opts.json != undefined ? !!opts.json : true;

    this.guiObject = undefined;
}

Class.extend(GUIComponent);


GUIComponent.prototype.init = function () {

};


GUIComponent.prototype.start = function () {

};


GUIComponent.prototype.update = function () {

};


GUIComponent.prototype.clear = function () {

    this.off();
};


GUIComponent.prototype.destroy = function () {
    if (!this.guiObject) {
        Log.error("GUIComponent.destroy: can't destroy GUIComponent if it's not added to a GameObject");
        return this;
    }

    this.guiObject.removeGUIComponent(this, true);
    this.emit("destroy");

    this.clear();

    return this;
};


GUIComponent.prototype.remove = function () {
    if (!this.guiObject) {
        Log.error("GUIComponent.destroy: can't destroy GUIComponent if it's not added to a GameObject");
        return this;
    }

    this.guiObject.removeGUIComponent(this, true);
    return this;
};


GUIComponent.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);

    json._type = this._type;
    json.sync = this.sync;
    json.json = this.json;

    return json;
};


GUIComponent.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);

    this.sync = json.sync;
    this.json = json.json;

    return this;
};


module.exports = GUIComponent;

},{"../../../base/class":8,"../../../base/log":14,"../../../base/util":19}],80:[function(require,module,exports){
var Mathf = require("../../../math/mathf");
var Rect = require("../../../math/rect");
var Vec2 = require("../../../math/vec2");
var Mat32 = require("../../../math/mat32");
var Mat3 = require("../../../math/mat3");
var Mat4 = require("../../../math/mat4");
var GUIComponent = require("./gui_component");
var Log = require("../../../base/log");
"use strict";


var EPSILON = Mathf.EPSILON;


function GUITransform(opts) {
    opts || (opts = {});
    opts.sync = opts.sync != undefined ? opts.sync : true;

    GUIComponent.call(this, "GUITransform", opts);

    this.root = this;
    this.depth = 0;

    this.parent = undefined;
    this.children = [];

    this.position = opts.position != undefined ? opts.position : new Rect;
    this.rotation = opts.rotation != undefined ? opts.rotation : 0;
    this.scale = opts.scale != undefined ? opts.scale : new Vec2(1, 1);

    this.matrix = new Mat32;
    this.matrixWorld = new Mat32;

    this.modelView = new Mat4;
    this._matricesNeedsUpdate = false;
}

GUIComponent.extend(GUITransform);


GUITransform.prototype.copy = function (other) {
    var children = other.children,
        i = children.length;

    this.position.copy(other.position);
    this.scale.copy(other.scale);
    this.rotation = other.rotation;

    while (i--) this.addChild(children[i].guiObject.clone().guiTransform);
    if (other.parent) other.parent.addChild(this);

    this._matricesNeedsUpdate = true;

    return this;
};


GUITransform.prototype.clear = function () {
    GUIComponent.prototype.clear.call(this);
    var children = this.children,
        i = children.length;

    while (i--) this.removeChild(children[i]);

    this.position.set(0, 0, 0, 0);
    this.scale.set(1, 1);
    this.rotation = 0;

    this.root = this;
    this.depth = 0;

    this._matricesNeedsUpdate = true;

    return this;
};


GUITransform.prototype.translate = function () {
    var vec = new Vec2;

    return function (translation, relativeTo) {
        var position = this.position;

        vec.copy(translation);

        if (relativeTo instanceof GUITransform) {
            vec.transformAngle(relativeTo.rotation);
        } else if (relativeTo) {
            vec.transformAngle(relativeTo);
        }

        position.x += vec.x;
        position.y += vec.y;

        return this;
    };
}();


GUITransform.prototype.rotate = function (rotation, relativeTo) {

    if (relativeTo instanceof GUITransform) {
        rotation += relativeTo.rotation;
    } else if (relativeTo) {
        rotation += relativeTo;
    }

    this.rotation += rotation;

    return this;
};


GUITransform.prototype.lookAt = function () {
    var mat = new Mat32,
        vec = new Vec2,
        vec_2 = new Vec2;

    return function (target) {

        if (target instanceof GUITransform) {
            vec.copy(target.position);
        } else {
            vec.copy(target);
        }

        mat.lookAt(this.position.center(vec_2), vec);
        this.rotation = mat.getRotation();

        return this;
    };
}();


GUITransform.prototype.follow = function () {
    var target = new Vec2,
        pos = new Vec2,
        delta = new Vec2;

    return function (transform, speed) {
        var position = this.position;

        pos.set(0, 0).transformMat32(this.matrixWorld);
        target.set(0, 0).transformMat32(transform.matrixWorld);

        delta.vsub(target, pos);

        if (delta.lengthSq() > EPSILON) {
            position.x += delta.x * speed;
            position.y += delta.y * speed;
        }

        return this;
    };
}();


GUITransform.prototype.addChild = function (child, others) {
    if (!(child instanceof GUITransform)) {
        Log.error("GUITransform.add: can\'t add passed argument, it is not an instance of GUITransform");
        return this;
    }
    var children = this.children,
        index = children.indexOf(child),
        root, depth, gui;

    if (index === -1) {
        if (child.parent) child.parent.remove(child);

        child.parent = this;
        children.push(child);

        root = this;
        depth = 0;

        while (root.parent) {
            root = root.parent;
            depth++;
        }
        child.root = root;
        this.root = root;

        updateDepth(this, depth);
        if (!others) {
            if (this.guiObject && (gui = this.guiObject.gui)) {
                gui.componentManagers.GUITransform.sort(this.sort);
            }
        }
    } else {
        Log.error("GUITransform.add: child is not a member of this GUITransform");
    }

    return this;
};


GUITransform.prototype.addChildren = function () {
    var i, il, gui;

    for (i = 0, il = arguments.length; i < il; i++) this.addChild(arguments[i], true);
    if (this.guiObject && (gui = this.guiObject.gui)) {
        gui.componentManagers.GUITransform.sort(this.sort);
    }
    return this;
};


GUITransform.prototype.removeChild = function (child, others) {
    var children = this.children,
        index = children.indexOf(child),
        root, depth, gui;

    if (index !== -1) {
        child.parent = undefined;
        children.splice(index, 1);

        root = this;
        depth = 0;

        while (root.parent) {
            root = root.parent;
            depth++;
        }
        child.root = child;
        this.root = root;

        updateDepth(this, depth);
        if (!others) {
            if (this.guiObject && (gui = this.guiObject.gui)) {
                gui.componentManagers.GUITransform.sort(this.sort);
            }
        }
    } else {
        Log.error("GUITransform.remove: child is not a member of this GUITransform");
    }

    return this;
};


GUITransform.prototype.removeChildren = function () {
    var i, il, gui;

    for (i = 0, il = arguments.length; i < il; i++) this.removeChild(arguments[i], true);
    if (this.guiObject && (gui = this.guiObject.gui)) {
        gui.componentManagers.GUITransform.sort(this.sort);
    }
    return this;
};


GUITransform.prototype.detachChildren = function () {
    var i = arguments.length;

    while (i--) this.removeChild(children[i]);
    return this;
};


GUITransform.prototype.hasChild = function (child) {

    return !!~this.children.indexOf(child);
};


GUITransform.prototype.find = function (name) {
    var children = this.children,
        child,
        i = children.length;

    while (i--) {
        child = children[i];

        if (child.guiObject.name === name) return child;
        if ((child = child.find(name))) return child;
    }

    return undefined;
};


GUITransform.prototype.toWorld = function (v) {

    return v.transformMat32(this.matrixWorld);
};


GUITransform.prototype.toLocal = function () {
    var mat = new Mat32;

    return function (v) {

        return v.transformMat32(mat.inverseMat(this.matrixWorld));
    };
}();


GUITransform.prototype.update = function () {
    var matrix = this.matrix,
        parent = this.parent;

    matrix.compose(this.position, this.scale, this.rotation);

    if (parent) {
        this.matrixWorld.mmul(parent.matrixWorld, matrix);
    } else {
        this.matrixWorld.copy(matrix);
    }

    this._matricesNeedsUpdate = true;
};


GUITransform.prototype.updateMatrices = function () {
    var mat = new Mat4;

    return function (viewMatrix) {
        if (!this._matricesNeedsUpdate) return;

        this.modelView.mmul(viewMatrix, mat.fromMat32(this.matrixWorld));
        this._matricesNeedsUpdate = false;
    };
}();


GUITransform.prototype.toJSON = function (json) {
    json = GUIComponent.prototype.toJSON.call(this, json);
    var children = this.children,
        jsonChildren = json.children || (json.children = []),
        i = children.length;

    while (i--) jsonChildren[i] = children[i]._id;

    json.position = this.position.toJSON(json.position);
    json.scale = this.scale.toJSON(json.scale);
    json.rotation = this.rotation

    return json;
};


GUITransform.prototype.fromJSON = function (json) {
    GUIComponent.prototype.fromJSON.call(this, json);
    var children = json.children,
        i = children.length,
        child, gui;

    if (this.guiObject && (gui = this.guiObject.gui)) {
        while (i--) {
            child = gui.findGUIComponentByJSONId(children[i]);

            if (!this.hasChild(child)) {
                this.addChild(child);
            }
        }
    } else {
        this.once("start", function () {
            var gui = this.guiObject.gui;

            while (i--) {
                child = gui.findGUIComponentByJSONId(children[i]);

                if (!this.hasChild(child)) {
                    this.addChild(child);
                }
            }
        });
    }

    this.position.fromJSON(json.position);
    this.scale.fromJSON(json.scale);
    this.rotation = json.rotation;

    this._matricesNeedsUpdate = true;

    return this;
};


function updateDepth(transform, depth) {
    var children = transform.children,
        i = children.length;

    transform.depth = depth;
    while (i--) updateDepth(children[i], depth + 1);
}


module.exports = GUITransform;

},{"../../../base/log":14,"../../../math/mat3":104,"../../../math/mat32":105,"../../../math/mat4":106,"../../../math/mathf":107,"../../../math/rect":109,"../../../math/vec2":111,"./gui_component":79}],81:[function(require,module,exports){
var Class = require("../../base/class");
var GUIObject = require("./gui_object");
var GUIComponentManager = require("./component_managers/gui_component_manager");
var Log = require("../../base/log");
"use strict";


/**
 * GUIs manage GUIObjects and their GUIComponents
 * @class Odin.GUI
 * @extends Odin.Class
 * @param Object options
 */
function GUI(opts) {
    opts || (opts = {});

    Class.call(this);

    this.game = undefined;

    this.name = opts.name != undefined ? opts.name : "GUI_" + this._id;

    this.width = 960;
    this.height = 640;
    this.aspect = this.width / this.height;
    this.invWidth = 1 / this.width;
    this.invHeight = 1 / this.height;

    this.guiObjects = [];
    this._guiObjectHash = {};
    this._guiObjectJSONHash = {};

    this.componentManagers = {};
    this._componentManagerTypes = [];
    this._componentHash = {};
    this._componentJSONHash = {};

    if (opts.guiObjects) this.addGUIObjects.apply(this, opts.guiObjects);
}

Class.extend(GUI);


GUI.prototype.copy = function (other) {
    var otherGUIObjects = other.guiObjects,
        i = otherGUIObjects.length;

    this.clear();
    this.name = other.name + "." + this._id;

    while (i--) this.addGUIObject(otherGUIObjects[i].clone());

    return this;
};


GUI.prototype.init = function () {
    var guiObjects = this.guiObjects,
        i, il;

    for (i = 0, il = guiObjects.length; i < il; i++) guiObjects[i].emit("init");
};


GUI.prototype.start = function () {
    var componentManagerTypes = this._componentManagerTypes,
        guiObjects = this.guiObjects,
        i, il;

    for (i = 0, il = componentManagerTypes.length; i < il; i++) componentManagerTypes[i].start();
    for (i = 0, il = guiObjects.length; i < il; i++) guiObjects[i].emit("start");
};


GUI.prototype.update = function () {
    var componentManagerTypes = this._componentManagerTypes,
        i, il;

    for (i = 0, il = componentManagerTypes.length; i < il; i++) componentManagerTypes[i].update();
};


GUI.prototype.clear = function () {
    var guiObjects = this.guiObjects,
        i = guiObjects.length;

    while (i--) this.removeGUIObject(guiObjects[i], true);

    this.off();

    return this;
};


GUI.prototype.destroy = function () {

    this.emit("destroy");
    this.clear();

    return this;
};


GUI.prototype.addGUIObject = function (guiObject) {
    if (!(guiObject instanceof GUIObject)) {
        Log.error("GUI.addGUIObject: can't add argument to GUI, it's not an instance of GUIObject");
        return this;
    }
    var guiObjects = this.guiObjects,
        index = guiObjects.indexOf(guiObject),
        components, transform, children, child,
        i;

    if (index === -1) {
        if (guiObject.gui) guiObject.gui.removeGUIObject(guiObject);

        guiObjects.push(guiObject);
        this._guiObjectHash[guiObject._id] = guiObject;
        if (guiObject._jsonId !== -1) this._guiObjectJSONHash[guiObject._jsonId] = guiObject;

        guiObject.gui = this;

        components = guiObject.components;
        i = components.length;
        while (i--) this._addGUIComponent(components[i]);

        if ((transform = guiObject.guiTransform)) {
            i = (children = transform.children).length;

            while (i--) {
                if ((child = children[i].guiObject) && !this.hasGUIObject(child)) {
                    this.addGUIObject(child);
                }
            }
        }

        if (this.game) guiObject.emit("init");
        this.emit("addGUIObject", guiObject);
    } else {
        Log.error("GUI.addGUIObject: GUIObject is already a member of GUI");
    }

    return this;
};


GUI.prototype.addGUIObjects = function () {
    var i = 0,
        il = arguments.length;

    for (; i < il; i++) this.addGUIObject(arguments[i]);
    return this;
};


GUI.prototype._addGUIComponent = function (component) {
    if (!component) return;
    var type = component._type,
        componentManagers = this.componentManagers,
        componentManager = componentManagers[type],
        componentManagerTypes = this._componentManagerTypes,
        isNew = !componentManager;

    if (isNew) {
        componentManager = componentManagers[type] = new (Class._classes[type + "GUIComponentManager"] || GUIComponentManager);
        componentManagerTypes.push(componentManager);
        componentManagerTypes.sort(sortGUIComponentManagerTypes);
        componentManager.gui = this;
    }

    componentManager.add(component);
    componentManager.sort();

    this._componentHash[component._id] = component;
    if (component._jsonId !== -1) this._componentJSONHash[component._jsonId] = component;

    this.emit("add" + type, component);
    this.emit("addGUIComponent", component);

    if (this.game) {
        component.start();
        component.emit("start");
    }
};


function sortGUIComponentManagerTypes(a, b) {

    return a.order - b.order;
}


GUI.prototype.removeGUIObject = function (guiObject, clear) {
    if (!(guiObject instanceof GUIObject)) {
        Log.error("GUI.removeGUIObject: can't remove argument from GUI, it's not an instance of GUIObject");
        return this;
    }
    var guiObjects = this.guiObjects,
        index = guiObjects.indexOf(guiObject),
        components, transform, children, child,
        i;

    if (index !== -1) {

        guiObjects.splice(index, 1);
        this._guiObjectHash[guiObject._id] = undefined;
        if (guiObject._jsonId !== -1) this._guiObjectJSONHash[guiObject._jsonId] = undefined;

        guiObject.gui = undefined;

        components = guiObject.components;
        i = components.length;
        while (i--) this._removeGUIComponent(components[i], clear);

        if ((transform = guiObject.guiTransform)) {
            i = (children = transform.children).length;

            while (i--) {
                if ((child = children[i].guiObject) && this.hasGUIObject(child)) {
                    this.removeGUIObject(child);
                }
            }
        }

        this.emit("removeGUIObject", guiObject);
        guiObject.emit("remove", guiObject);
        if (clear) guiObject.clear();
    } else {
        Log.error("GUI.removeGUIObject: GUIObject is not a member of GUI");
    }

    return this;
};


GUI.prototype.removeGUIObjects = function () {
    var i = 0,
        il = arguments.length;

    for (; i < il; i++) this.removeGUIObject(arguments[i]);
    return this;
};


GUI.prototype._removeGUIComponent = function (component, clear) {
    if (!component) return;
    var type = component._type,
        componentManagers = this.componentManagers,
        componentManager = componentManagers[type],
        componentManagerTypes = this._componentManagerTypes;

    componentManager.remove(component);
    this._componentHash[component._id] = undefined;
    if (component._jsonId !== -1) this._componentJSONHash[component._jsonId] = undefined;

    if (componentManager.empty()) {
        componentManagers[type] = undefined;
        componentManagerTypes.splice(componentManagerTypes.indexOf(componentManager), 1);
        componentManager.gui = undefined;
    }

    this.emit("remove" + type, component);
    this.emit("removeGUIComponent", component);

    if (clear) component.clear();
};


GUI.prototype.hasGUIObject = function (guiObject) {

    return !!~this.guiObjects.indexOf(guiObject);
};


GUI.prototype.findByTag = function (tag, out) {
    out || (out = []);
    var guiObjects = this.guiObjects,
        guiObject, i = guiObjects.length;

    while (i--) {
        if ((guiObject = guiObjects[i]).hasTag(tag)) out.push(guiObject);
    }

    return out;
};


GUI.prototype.findByTagFirst = function (tag) {
    var guiObjects = this.guiObjects,
        guiObject, i = guiObjects.length;

    while (i--) {
        if ((guiObject = guiObjects[i]).hasTag(tag)) return guiObject;
    }

    return undefined;
};


GUI.prototype.findById = function (id) {

    return this._guiObjectHash[id];
};


GUI.prototype.findByJSONId = function (id) {

    return this._guiObjectJSONHash[id];
};


GUI.prototype.findGUIComponentById = function (id) {

    return this._componentHash[id];
};


GUI.prototype.findGUIComponentByJSONId = function (id) {

    return this._componentJSONHash[id];
};


GUI.prototype.find = function (name) {
    var guiObjects = this.guiObjects,
        child, i = guiObjects.length;

    while (i--) {
        child = guiObjects[i];

        if (child.name === name) return child;
        if ((child = child.find(name))) return child;
    }

    return undefined;
};


GUI.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);
    var guiObjects = this.guiObjects,
        jsonGUIObjects = json.guiObjects || (json.guiObjects = []),
        guiObject,
        i = guiObjects.length;

    json.name = this.name;

    while (i--) {
        if ((guiObject = guiObjects[i])) jsonGUIObjects[i] = guiObject.toJSON(jsonGUIObjects[i]);
    }

    return json;
};


GUI.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);
    var jsonGUIObjects = json.guiObjects,
        guiObject, jsonGUIObject,
        i = jsonGUIObjects.length;

    this.name = json.name;

    while (i--) {
        if (!(jsonGUIObject = jsonGUIObjects[i])) continue;

        if ((guiObject = this._guiObjectJSONHash[jsonGUIObject._id])) {
            guiObject.fromJSON(jsonGUIObject);
        } else {
            this.addGUIObject(Class.fromJSON(jsonGUIObject));
        }
    }

    return this;
};


module.exports = GUI;

},{"../../base/class":8,"../../base/log":14,"./component_managers/gui_component_manager":78,"./gui_object":82}],82:[function(require,module,exports){
var Class = require("../../base/class");
var GUIComponent = require("./components/gui_component");
var GUITransform = require("./components/gui_transform");
var Log = require("../../base/log");
"use strict";

/**
 * @class GUIObject
 * @extends Class
 * @memberof Odin
 * @brief Base class for entities in scenes
 * @param Object options
 */
function GUIObject(opts) {
    opts || (opts = {});

    Class.call(this);

    this.name = opts.name != undefined ? opts.name : "GUIObject_" + this._id;

    this.scene = undefined;

    this.tags = [];

    this.components = [];
    this._componentType = {};
    this._componentHash = {};
    this._componentJSONHash = {};

    if (opts.tag) this.addTag(opts.tag);
    if (opts.tags) this.addTags.apply(this, opts.tags);

    this.addGUIComponent(new GUITransform);
    if (opts.components) this.addGUIComponents.apply(this, opts.components);
}

Class.extend(GUIObject);


GUIObject.prototype.copy = function (other) {
    var components = this.components,
        otherGUIComponents = other.components,
        tags = other.tags,
        otherGUIComponent, component,
        i = components.length;

    while (i--) {
        component = components[i];
        if (!other.hasGUIComponent(component._className)) this.removeGUIComponent(component);
    }

    i = otherGUIComponents.length;
    while (i--) {
        otherGUIComponent = otherGUIComponents[i];

        if ((component = this.getGUIComponent(otherGUIComponent._type))) {
            component.copy(otherGUIComponent);
        } else {
            this.addGUIComponent(otherGUIComponent.clone());
        }
    }

    i = tags.length;
    while (i--) this.addTag(tags[i]);

    return this;
};


GUIObject.prototype.clear = function () {
    var components = this.components,
        tags = this.tags,
        componentLength = components.length,
        i;

    i = componentLength;
    while (i--) components[i].clear();

    i = tags.length;
    while (i--) this.removeTag(tags[i]);

    i = componentLength;
    while (i--) this.removeGUIComponent(components[i]);

    this.off();

    return this;
};


GUIObject.prototype.destroy = function () {
    if (!this.scene) {
        Log.error("GUIObject.destroy: can't destroy GUIObject if it's not added to a Scene");
        return this;
    }

    this.scene.removeGUIObject(this);
    this.emit("destroy");

    this.clear();

    return this;
};


GUIObject.prototype.remove = function () {
    if (!this.scene) {
        Log.error("GUIObject.remove: can't remove GUIObject if it's not added to a Scene");
        return this;
    }

    this.scene.removeGUIObject(this);
    return this;
};


GUIObject.prototype.addTag = function (tag) {
    var tags = this.tags;

    if (tags.indexOf(tag) === -1) tags.push(tag);

    return this;
};


GUIObject.prototype.addTags = function () {
    var i = arguments.length;

    while (i--) this.addTag(arguments[i]);
    return this;
};


GUIObject.prototype.removeTag = function (tag) {
    var tags = this.tags,
        index = tags.indexOf(tag);

    if (index !== -1) tags.splice(index, 1);

    return this;
};


GUIObject.prototype.removeTags = function () {
    var i = arguments.length;

    while (i--) this.removeTag(arguments[i]);
    return this;
};


GUIObject.prototype.hasTag = function (tag) {

    return this.tags.indexOf(tag) !== -1;
};


GUIObject.prototype.addGUIComponent = function (component, others) {
    if (typeof(component) === "string") component = new Class._classes[component];
    if (!(component instanceof GUIComponent)) {
        Log.error("GUIObject.addGUIComponent: can't add passed argument, it is not an instance of GUIComponent");
        return this;
    }
    var name = component._name,
        components = this.components,
        comp, i, j;


    if (!this[name]) {
        if (component.gameObject) component = component.clone();

        components.push(component);
        this._componentType[component._type] = component;
        this._componentHash[component._id] = component;
        if (component._jsonId !== -1) this._componentJSONHash[component._jsonId] = component;

        component.gameObject = this;
        this[name] = component;

        if (!others) {
            i = components.length;
            while (i--) {
                comp = components[i];
                if (!comp) continue;

                j = components.length;
                while (j--) comp[components[j]._name] = components[j];
            }

            component.init();
            component.emit("init");
        }

        this.emit("add" + component._type, component);
        this.emit("addGUIComponent", component);
        component.emit("add", this);

        if (this.scene) this.scene._addGUIComponent(component);
    } else {
        Log.error("GUIObject.addGUIComponent: GUIObject already has a(n) " + component._type + " GUIComponent");
    }

    return this;
};


GUIObject.prototype.addGUIComponents = function () {
    var length = arguments.length,
        components = this.components,
        component, name,
        i, j;

    i = length;
    while (i--) this.addGUIComponent(arguments[i], true);

    i = components.length;
    while (i--) {
        component = components[i];
        if (!component) continue;

        j = components.length;
        while (j--) {
            name = components[j]._name;
            component[name] = components[j];
        }
    }

    i = components.length;
    while (i--) {
        component = components[i];
        component.init();
        component.emit("init");
    }

    return this;
};


GUIObject.prototype.removeGUIComponent = function (component, clear, others) {
    if (typeof(component) === "string") component = this.getGUIComponent(component);
    if (!(component instanceof GUIComponent)) {
        Log.error("GUIObject.removeGUIComponent: can't remove passed argument, it is not an instance of GUIComponent");
        return this;
    }
    var name = component._name,
        components = this.components,
        comp, i, j;

    if (this[name]) {
        component.emit("remove", this);
        this.emit("remove" + component._type, component);
        this.emit("removeGUIComponent", component);

        if (!others) {
            i = components.length;
            while (i--) {
                comp = components[i];
                if (!comp) continue;

                j = components.length;
                while (j--) {
                    if (name === components[j]._name) comp[name] = undefined;
                }
            }
        }

        components.splice(components.indexOf(component), 1);
        this._componentType[component._type] = undefined;
        this._componentHash[component._id] = undefined;
        if (component._jsonId !== -1) this._componentJSONHash[component._jsonId] = undefined;

        component.gameObject = undefined;
        this[name] = undefined;

        if (this.scene) this.scene._removeGUIComponent(component);
        if (clear) component.clear();
    } else {
        Log.error("GUIObject.removeGUIComponent: GUIObject does not have a(n) " + type + " GUIComponent");
    }

    return this;
};


GUIObject.prototype.removeGUIComponents = function () {
    var length = arguments.length,
        components = this.components,
        toRemove = arguments,
        component, name,
        i, j;

    i = length;
    while (i--) this.removeGUIComponent(arguments[i], null, true);

    i = components.length;
    while (i--) {
        component = components[i];
        if (!component) continue;

        name = component._name;
        j = toRemove.length;
        while (j--) {
            if (name === toRemove[i]._name) component[name] = undefined;
        }
    }

    return this;
};


GUIObject.prototype.getGUIComponent = function (type) {

    return this._componentType[type];
};


GUIObject.prototype.hasGUIComponent = function (type) {
    var components = this.components,
        i = components.length;
    ;

    while (i--) {
        if (components[i]._type === type) return true;
    }

    return false;
};


GUIObject.prototype.find = function (name) {
    var transform = this.guiTransform,
        children, child, i;

    if (!transform) return undefined;

    children = transform.children;
    i = children.length;

    while (i--) {
        child = children[i];

        if (child.gameObject.name === name) return child.gameObject;
        if ((child = child.find(name))) return child;
    }

    return undefined;
};


GUIObject.prototype.findGUIComponentById = function (id) {

    return this._componentHash[id];
};


GUIObject.prototype.findGUIComponentByJSONId = function (id) {

    return this._componentJSONHash[id];
};


GUIObject.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);
    var components = this.components,
        jsonGUIComponents = json.components || (json.components = []),
        tags = this.tags,
        jsonTags = json.tags || (json.tags = []),
        component,
        i = components.length;

    while (i--) {
        if ((component = components[i]).json) jsonGUIComponents[i] = component.toJSON(jsonGUIComponents[i]);
    }
    i = tags.length;
    while (i--) jsonTags[i] = tags[i];

    json.name = this.name;

    return json;
};


GUIObject.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);
    var components = this.components,
        jsonGUIComponents = json.components || (json.components = []),
        component, jsonGUIComponent, tag,
        tags = this.tags,
        jsonTags = json.tags || (json.tags = []),
        i = components.length,
        has, type, j;

    while (i--) {
        component = components[i];
        type = component._type;
        has = false;

        j = jsonGUIComponents.length;
        while (j--) {
            jsonGUIComponent = jsonGUIComponents[i];
            if (type === jsonGUIComponent._type) has = true;
        }

        if (!has) this.removeGUIComponent(component);
    }

    i = jsonGUIComponents.length;
    while (i--) {
        if (!(jsonGUIComponent = jsonGUIComponents[i])) continue;

        if ((component = this.findGUIComponentByJSONId(jsonGUIComponent._id)) || (component = this.getGUIComponent(jsonGUIComponent._type))) {
            component.fromJSON(jsonGUIComponent);
        } else {
            this.addGUIComponent(Class.fromJSON(jsonGUIComponent));
        }
    }

    i = jsonTags.length;
    while (i--) {
        if (tags.indexOf((tag = jsonTags[i])) === -1) tags.push(tag);
    }

    this.name = json.name;

    return this;
};


module.exports = GUIObject;

},{"../../base/class":8,"../../base/log":14,"./components/gui_component":79,"./components/gui_transform":80}],83:[function(require,module,exports){
var Enums = require("../enums");
var Axis = require("./axis");
var Log = require("../../base/log");
"use strict";


var AxisType = Enums.AxisType;


function Axes() {

    Array.call(this);

    this.hash = {};
    this._SYNC = {};

    this.add({
        name: "horizontal",
        posButton: "right",
        negButton: "left",
        altPosButton: "d",
        altNegButton: "a",
        type: AxisType.Button
    });

    this.add({
        name: "vertical",
        posButton: "up",
        negButton: "down",
        altPosButton: "w",
        altNegButton: "s",
        type: AxisType.Button
    });

    this.add({
        name: "fire",
        posButton: "ctrl",
        negButton: "",
        altPosButton: "mouse0",
        altNegButton: "",
        type: AxisType.Button
    });

    this.add({
        name: "jump",
        posButton: "space",
        negButton: "",
        altPosButton: "mouse2",
        altNegButton: "",
        type: AxisType.Button
    });

    this.add({
        name: "mouseX",
        type: AxisType.Mouse,
        axis: "x"
    });

    this.add({
        name: "mouseY",
        type: AxisType.Mouse,
        axis: "y"
    });

    this.add({
        name: "touchX",
        type: AxisType.Touch,
        axis: "x"
    });

    this.add({
        name: "touchY",
        type: AxisType.Touch,
        axis: "y"
    });

    this.add({
        name: "mouseWheel",
        type: AxisType.MouseWheel
    });
}

Axes.prototype = Object.create(Array.prototype);
Axes.prototype.constructor = Axes;


Axes.prototype.add = function (name, opts) {
    if (typeof(name) === "object") {
        opts = name;
        name = opts.name;
    }
    if (this.hash[name]) {
        Log.error("Axes.add: Axes already have Axis named " + name + " use Axes.get(\"" + name + "\") and edit it instead");
        return undefined;
    }
    opts || (opts = {});
    opts.name = name;
    var axis = new Axis(opts);

    this.push(axis);
    this.hash[name] = axis;

    return axis;
};


Axes.prototype.get = function (name) {

    return this.hash[name];
};


Axes.prototype.toSYNC = function (json) {
    json || (json = this._SYNC);
    var jsonAxes = json.axes || (json.axes = []),
        i;

    for (i = this.length; i--;) jsonAxes[i] = this[i].toSYNC(jsonAxes[i]);
    return json;
};


Axes.prototype.fromSYNC = function (json) {
    var axisHash = this.hash,
        jsonAxes = json.axes || (json.axes = []),
        axis, jsonAxis,
        i;

    for (i = jsonAxes.length; i--;) {
        jsonAxis = jsonAxes[i];

        if ((axis = axisHash[jsonAxis.name])) {
            axis.fromSYNC(jsonAxis);
        } else {
            this.add(jsonAxis.name).fromJSON(jsonAxis);
        }
    }

    return this;
};


Axes.prototype.toJSON = function (json) {
    json || (json = {});
    var jsonAxes = json.axes || (json.axes = []),
        i;

    for (i = this.length; i--;) jsonAxes[i] = this[i].toJSON(jsonAxes[i]);
    return json;
};


Axes.prototype.fromJSON = function (json) {
    var axisHash = this.hash,
        jsonAxes = json.axes || (json.axes = []),
        axis, jsonAxis,
        i;

    for (i = jsonAxes.length; i--;) {
        jsonAxis = jsonAxes[i];

        if ((axis = axisHash[jsonAxis.name])) {
            axis.fromJSON(jsonAxis);
        } else {
            this.add(jsonAxis.name).fromJSON(jsonAxis);
        }
    }

    return this;
};


module.exports = Axes;

},{"../../base/log":14,"../enums":73,"./axis":84}],84:[function(require,module,exports){
var Enums = require("../enums");
"use strict";


var AxisType = Enums.AxisType;


function Axis(opts) {
    opts || (opts = {});

    this.name = opts.name != undefined ? opts.name : "unknown";

    this.negButton = opts.negButton != undefined ? opts.negButton : "";
    this.posButton = opts.posButton != undefined ? opts.posButton : "";

    this.altNegButton = opts.altNegButton != undefined ? opts.altNegButton : "";
    this.altPosButton = opts.altPosButton != undefined ? opts.altPosButton : "";

    this.gravity = opts.gravity != undefined ? opts.gravity : 3;
    this.sensitivity = opts.sensitivity != undefined ? opts.sensitivity : 3;

    this.dead = opts.dead != undefined ? opts.dead : 0.001;

    this.type = opts.type != undefined ? opts.type : AxisType.BUTTON;
    this.axis = opts.axis != undefined ? opts.axis : "x";
    this.index = opts.index != undefined ? opts.index : 0;

    this.joyNum = opts.joyNum != undefined ? opts.joyNum : 0;

    this.value = 0;

    this._SYNC = {};
};


Axis.prototype.toSYNC = function (json) {
    json || (json = this._SYNC);

    json.name = this.name;
    json.value = this.value;

    return json;
};


Axis.prototype.fromSYNC = function (json) {

    this.name = json.name;
    this.value = json.value;

    return this;
};


Axis.prototype.toJSON = function (json) {
    json || (json = {});

    json.name = this.name;

    json.negButton = this.negButton;
    json.posButton = this.posButton;

    json.altNegButton = this.altNegButton;
    json.altPosButton = this.altPosButton;

    json.gravity = this.gravity;
    json.sensitivity = this.sensitivity;

    json.dead = this.dead;

    json.type = this.type;
    json.axis = this.axis;
    json.index = this.index;

    json.joyNum = this.joyNum;

    json.value = this.value;

    return json;
};


Axis.prototype.fromJSON = function (json) {

    this.name = json.name;

    this.negButton = json.negButton;
    this.posButton = json.posButton;

    this.altNegButton = json.altNegButton;
    this.altPosButton = json.altPosButton;

    this.gravity = json.gravity;
    this.sensitivity = json.sensitivity;

    this.dead = json.dead;

    this.type = json.type;
    this.axis = json.axis;
    this.index = json.index;

    this.joyNum = json.joyNum;

    this.value = json.value;

    return this;
};


module.exports = Axis;

},{"../enums":73}],85:[function(require,module,exports){
"use strict";


function Button(name) {
    this.name = name;

    this.timeDown = -1;
    this.timeUp = -1;

    this.frameDown = -1;
    this.frameUp = -1;

    this.value = false;
    this._first = true;

    this._SYNC = {};
};


Button.prototype.toSYNC = function (json) {
    json || (json = this._SYNC);

    json.name = this.name;
    json.timeDown = this.timeDown;
    json.timeUp = this.timeUp;
    json.frameDown = this.frameDown;
    json.frameUp = this.frameUp;
    json.value = this.value;

    return json;
};


Button.prototype.fromSYNC = function (json) {

    this.name = json.name;
    this.timeDown = json.timeDown;
    this.timeUp = json.timeUp;
    this.frameDown = json.frameDown;
    this.frameUp = json.frameUp;
    this.value = json.value;

    return this;
};


Button.prototype.toJSON = function (json) {
    json || (json = {});

    json.name = this.name;
    json.timeDown = this.timeDown;
    json.timeUp = this.timeUp;
    json.frameDown = this.frameDown;
    json.frameUp = this.frameUp;
    json.value = this.value;

    return json;
};


Button.prototype.fromJSON = function (json) {

    this.name = json.name;
    this.timeDown = json.timeDown;
    this.timeUp = json.timeUp;
    this.frameDown = json.frameDown;
    this.frameUp = json.frameUp;
    this.value = json.value;

    return this;
};


module.exports = Button;

},{}],86:[function(require,module,exports){
var Time = require("../../base/time");
var Button = require("./button");
var Log = require("../../base/log");
"use strict";


function Buttons() {

    Array.call(this);

    this.hash = {};
    this._SYNC = {};

    this.add("mouse0");
    this.add("mouse1");
    this.add("mouse2");
}

Buttons.prototype = Object.create(Array.prototype);
Buttons.prototype.constructor = Buttons;


Buttons.prototype.add = function (name) {
    if (this.hash[name]) {
        Log.error("Buttons.add: Buttons already have Button name " + name);
        return undefined;
    }
    var button = new Button(name);

    this.push(button);
    this.hash[name] = button;

    return button;
};


Buttons.prototype.get = function (name) {

    return this.hash[name];
};


Buttons.prototype.on = function (name) {
    var button = this.hash[name] || this.add(name);

    if (button._first) {
        button.frameDown = Time.frameCount + 1;
        button.timeDown = Time.stamp();
        button._first = false;
    }
    button.value = true;

    return button;
};


Buttons.prototype.off = function (name) {
    var button = this.hash[name] || this.add(name);

    button.frameUp = Time.frameCount + 1;
    button.timeUp = Time.stamp();
    button.value = false;
    button._first = true;

    return button;
};


Buttons.prototype.toSYNC = function (json) {
    json || (json = this._SYNC);
    var jsonButtons = json.buttons || (json.buttons = []),
        i;

    for (i = this.length; i--;) jsonButtons[i] = this[i].toSYNC(jsonButtons[i]);
    return json;
};


Buttons.prototype.fromSYNC = function (json) {
    var buttonHash = this.hash,
        jsonButtons = json.buttons || (json.buttons = []),
        button, jsonButton,
        i;

    for (i = jsonButtons.length; i--;) {
        jsonButton = jsonButtons[i];

        if ((button = buttonHash[jsonButton.name])) {
            button.fromSYNC(jsonButton);
        } else {
            this.add(jsonButton.name).fromJSON(jsonButton);
        }
    }

    return this;
};


Buttons.prototype.toJSON = function (json) {
    json || (json = {});
    var jsonButtons = json.buttons || (json.buttons = []),
        i;

    for (i = this.length; i--;) jsonButtons[i] = this[i].toJSON(jsonButtons[key]);
    return json;
};


Buttons.prototype.fromJSON = function (json) {
    var buttonHash = this.hash,
        jsonButtons = json.buttons || (json.buttons = []),
        button, jsonButton,
        i;

    for (i = jsonButtons.length; i--;) {
        jsonButton = jsonButtons[i];

        if ((button = buttonHash[jsonButton.name])) {
            button.fromJSON(jsonButton);
        } else {
            this.add(jsonButton.name).fromJSON(jsonButton);
        }
    }

    return this;
};


module.exports = Buttons;

},{"../../base/log":14,"../../base/time":18,"./button":85}],87:[function(require,module,exports){
var EventEmitter = require("../../base/event_emitter");
var Dom = require("../../base/dom");
var ObjectPool = require("../../base/object_pool");
var Vec2 = require("../../math/vec2");
var Input = require("./input");
"use strict";


var min = Math.min,
    max = Math.max,

    addEvent = Dom.addEvent,
    removeEvent = Dom.removeEvent;


function Handler() {

    EventEmitter.call(this);

    this.element = undefined;
}

EventEmitter.extend(Handler);


Handler.prototype.setElement = function (element) {
    if (this.element) this.removeElement();

    this.element = element;

    addEvent(element, "mousedown mouseup mousemove mouseout mousewheel DOMMouseScroll", handleMouse, Input);
    addEvent(top, "keydown keyup", handleKeys, Input);

    addEvent(element, "touchstart touchmove touchend touchcancel", handleTouches, Input);
    addEvent(window, "devicemotion", handleDevicemotion, Input);
};


Handler.prototype.removeElement = function () {
    if (!this.element) return;
    var element = this.element;

    removeEvent(element, "mousedown mouseup mousemove mouseout mousewheel DOMMouseScroll", handleMouse, Input);
    removeEvent(top, "keydown keyup", handleKeys, Input);

    removeEvent(element, "touchstart touchmove touchend touchcancel", handleTouches, Input);
    removeEvent(window, "devicemotion", handleDevicemotion, Input);

    this.element = undefined;
};


function handleDevicemotion(e) {
    var acc = e.accelerationIncludingGravity,
        acceleration;

    if (acc && (acc.x || acc.y || acc.z)) {
        acceleration = this.acceleration;

        acceleration.x = acc.x;
        acceleration.y = acc.y;
        acceleration.z = acc.z;

        this.emit("acceleration");
    }
}


function handleTouches(e) {
    e.preventDefault();
    var type = e.type,
        touches = this.touches,
        targetTouches = e.targetTouches,
        changedTouches = e.changedTouches,
        i, il;

    if (type === "touchstart") {

        for (i = 0, il = targetTouches.length; i < il; i++) this.emit("touchstart", touches.start(i, targetTouches[i]));

    } else if (type === "touchend") {

        for (i = 0, il = changedTouches.length; i < il; i++) this.emit("touchend", touches.end(i));

    } else if (type === "touchcancel") {

        touches.cancel();
        this.emit("touchcancel");

    } else if (type === "touchmove") {

        if (this.touchesMoveNeedsUpdate) {

            for (i = 0, il = changedTouches.length; i < il; i++) this.emit("touchmove", touches.move(i, changedTouches[i]));
            this.touchesMoveNeedsUpdate = false;
        }
    }
}


var mouseFirst = false,
    mouseLast = new Vec2,
    mouseWheel = 0;

function handleMouse(e) {
    e.preventDefault();
    var type = e.type,
        button;

    if (type === "mousedown") {
        button = MOUSE_BUTTONS[e.button];

        this.buttons.on(button);
        updateMousePosition(this, e);
        this.emit("mousedown", button);

    } else if (type === "mouseup") {
        button = MOUSE_BUTTONS[e.button];

        this.buttons.off(button);
        updateMousePosition(this, e);
        this.emit("mouseup", button);

    } else if (type === "mouseout") {
        button = MOUSE_BUTTONS[e.button];

        this.buttons.off(button);
        updateMousePosition(this, e);
        this.emit("mouseout", button);

    } else if (type === "mousewheel" || type === "DOMMouseScroll") {

        mouseWheel = max(-1, min(1, (e.wheelDelta || -e.detail)));
        this.mouseWheel = mouseWheel;
        this.emit("mousewheel", mouseWheel);

    } else if (type === "mousemove") {

        if (this.mouseMoveNeedsUpdate) {

            updateMousePosition(this, e);
            this.mouseMoveNeedsUpdate = false;
            this.emit("mousemove");
        }
    }
}


function updateMousePosition(input, e) {
    var position = input.mousePosition,
        delta = input.mouseDelta,
        element = e.target || e.srcElement,
        offsetX = element.offsetLeft || 0,
        offsetY = element.offsetTop || 0,
        x = (e.pageX || e.clientX) - offsetX,
        y = (e.pageY || e.clientY) - offsetY;

    mouseLast.x = mouseFirst ? position.x : x;
    mouseLast.y = mouseFirst ? position.y : y;

    position.x = x;
    position.y = y;

    delta.x = position.x - mouseLast.x;
    delta.y = position.y - mouseLast.y;

    mouseFirst = true;
}


function handleKeys(e) {
    e.preventDefault();
    var type = e.type,
        key = KEY_CODES[e.keyCode];

    if (type === "keydown") {
        this.buttons.on(key);
        this.emit("keydown", key);
    } else if (type === "keyup") {
        this.buttons.off(key);
        this.emit("keyup", key);
    }
}

var MOUSE_BUTTONS = {
    "0": "mouse0",
    "1": "mouse1",
    "2": "mouse2"
}

var KEY_CODES = {
    8: "backspace",
    9: "tab",
    13: "enter",
    16: "shift",
    17: "ctrl",
    18: "alt",
    19: "pause",
    20: "capslock",
    27: "escape",
    32: "space",
    33: "pageup",
    34: "pagedown",
    35: "end",
    37: "left",
    38: "up",
    39: "right",
    40: "down",
    45: "insert",
    46: "delete",
    112: "f1",
    113: "f2",
    114: "f3",
    115: "f4",
    116: "f5",
    117: "f6",
    118: "f7",
    119: "f8",
    120: "f9",
    121: "f10",
    122: "f11",
    123: "f12",
    144: "numlock",
    145: "scrolllock",
    186: "semicolon",
    187: "equal",
    188: "comma",
    189: "dash",
    190: "period",
    191: "slash",
    192: "graveaccent",
    219: "openbracket",
    220: "backslash",
    221: "closebraket",
    222: "singlequote"
};

for (var i = 48; i <= 90; i++) KEY_CODES[i] = String.fromCharCode(i).toLowerCase();


module.exports = new Handler;

},{"../../base/dom":11,"../../base/event_emitter":13,"../../base/object_pool":15,"../../math/vec2":111,"./input":88}],88:[function(require,module,exports){
var EventEmitter = require("../../base/event_emitter");
var ObjectPool = require("../../base/object_pool");
var Time = require("../../base/time");
var Mathf = require("../../math/mathf");
var Vec2 = require("../../math/vec2");
var Vec3 = require("../../math/vec3");
var Enums = require("../enums");
var Buttons = require("./buttons");
var Button = require("./button");
var Axes = require("./axes");
var Axis = require("./axis");
var Touches = require("./touches");
"use strict";


var abs = Math.abs,
    sign = Mathf.sign,
    clamp = Mathf.clamp,

    AxisType = Enums.AxisType,
    MOUSE_BUTTONS = {
        "0": "mouse0",
        "1": "mouse1",
        "2": "mouse2"
    };


function Input() {

    EventEmitter.call(this);

    this.axes = new Axes;
    this.buttons = new Buttons;

    this.mouseWheel = 0;
    this.mousePosition = new Vec2;
    this.mouseDelta = new Vec2;
    this.mouseMoveNeedsUpdate = false;

    this.touches = new Touches;
    this.touchesMoveNeedsUpdate = false;
    this.acceleration = new Vec3;

    this.frameCount = 0;
    this._frameCount = undefined;

    this.time = 0;
    this._time = undefined;

    this._SYNC = {};
}

EventEmitter.extend(Input);


Input.prototype.update = function () {
    var axes = this.axes,
        buttons = this.buttons.hash,
        button, altButton,
        axis, value, type, touch, sensitivity, pos, neg, tmp, dt = Time.delta,
        i;

    this.frameCount = this._frameCount ? this._frameCount : Time.frameCount;
    this.time = this._time ? this._time : Time.stamp();

    this.mouseMoveNeedsUpdate = true;
    this.touchesMoveNeedsUpdate = true;

    for (i = axes.length; i--;) {
        axis = axes[i];
        value = axis.value;
        type = axis.type;
        sensitivity = axis.sensitivity;

        if (type === AxisType.Button) {
            button = buttons[axis.negButton];
            altButton = buttons[axis.altNegButton];
            neg = button && button.value || altButton && altButton.value;

            button = buttons[axis.posButton];
            altButton = buttons[axis.altPosButton];
            pos = button && button.value || altButton && altButton.value;

        } else if (type === AxisType.Mouse) {
            axis.value = this.mouseDelta[axis.axis];
            continue;

        } else if (type === AxisType.Touch) {
            touch = this.touches[axis.index];

            if (touch) {
                axis.value = touch.delta[axis.axis];
            } else {
                continue;
            }
        } else if (type === AxisType.MouseWheel) {
            value += this.mouseWheel;

        } else if (type === AxisType.Joystick) {

        }

        if (neg) value -= sensitivity * dt;
        if (pos) value += sensitivity * dt;

        if (!pos && !neg && value !== 0) {
            tmp = abs(value);
            value -= clamp(sign(value) * axis.gravity * dt, -tmp, tmp);
        }

        value = clamp(value, -1, 1);
        if (abs(value) <= axis.dead) value = 0;

        axis.value = value;
    }

    this.mouseWheel = 0;
};


Input.prototype.axis = function (name) {
    var axis = this.axes.hash[name];
    return axis ? axis.value : 0;
};


Input.prototype.mouseButton = function (id) {
    var button = this.buttons.hash[MOUSE_BUTTONS[id]];

    return button && button.value;
};


Input.prototype.mouseButtonDown = function (id) {
    var button = this.buttons.hash[MOUSE_BUTTONS[id]];

    return button && button.value && (button.frameDown >= this.frameCount);
};


Input.prototype.mouseButtonUp = function (id) {
    var button = this.buttons.hash[MOUSE_BUTTONS[id]];

    return button && (button.frameUp >= this.frameCount)
};


Input.prototype.anyKey = function () {
    var buttons = this.buttons,
        i;

    for (i = buttons.length; i--;) {
        if (buttons[i].value) return true;
    }
    return false;
};


Input.prototype.anyKeyDown = function () {
    var buttons = this.buttons,
        button,
        i;

    for (i = buttons.length; i--;) {
        if ((button = buttons[i]).value && (button.frameDown >= this.frameCount)) return true;
    }
    return false;
};


Input.prototype.key = function (name) {
    var button = this.buttons.hash[name];

    return button && button.value;
};


Input.prototype.keyDown = function (name) {
    var button = this.buttons.hash[name];

    return button && button.value && (button.frameDown >= this.frameCount);
};


Input.prototype.keyUp = function (name) {
    var button = this.buttons.hash[name];

    return button && (button.frameUp >= this.frameCount);
};


Input.prototype.toSYNC = function (json) {
    json || (json = this._SYNC);

    json._frameCount = Time.frameCount;
    json._time = Time.stamp();

    json.buttons = this.buttons.toSYNC(json.buttons);

    json.mousePosition = this.mousePosition.toJSON(json.mousePosition);
    json.mouseDelta = this.mouseDelta.toJSON(json.mouseDelta);

    json.acceleration = this.acceleration.toJSON(json.acceleration);
    json.touches = this.touches.toSYNC(json.touches);

    return json;
};


Input.prototype.fromSYNC = function (json) {

    this._frameCount = json._frameCount;
    this._time = json._time;

    this.buttons.fromSYNC(json.buttons);

    this.mousePosition.fromJSON(json.mousePosition);
    this.mouseDelta.fromJSON(json.mouseDelta);

    this.acceleration.fromJSON(json.acceleration);
    this.touches.fromSYNC(json.touches);

    return this;
};


Input.prototype.toJSON = function (json) {
    json || (json = {});

    json.buttons = this.buttons.toJSON(json.buttons);
    json.axes = this.axes.toJSON(json.axes);

    json.mousePosition = this.mousePosition.toJSON(json.mousePosition);
    json.mouseDelta = this.mouseDelta.toJSON(json.mouseDelta);

    json.acceleration = this.acceleration.toJSON(json.acceleration);
    json.touches = this.touches.toJSON(json.touches);

    return json;
};


Input.prototype.fromJSON = function (json) {

    this.buttons.fromJSON(json.buttons);
    this.axes.fromJSON(json.axes);

    this.mousePosition.fromJSON(json.mousePosition);
    this.mouseDelta.fromJSON(json.mouseDelta);

    this.acceleration.fromJSON(json.acceleration);
    this.touches.fromJSON(json.touches);

    return this;
};


module.exports = new Input;

},{"../../base/event_emitter":13,"../../base/object_pool":15,"../../base/time":18,"../../math/mathf":107,"../../math/vec2":111,"../../math/vec3":112,"../enums":73,"./axes":83,"./axis":84,"./button":85,"./buttons":86,"./touches":90}],89:[function(require,module,exports){
var Vec2 = require("../../math/vec2");
"use strict";


function Touch() {

    this.id = -1;

    this.radiusX = 0;
    this.radiusY = 0;
    this.rotationAngle = 0;
    this.force = 0;

    this.delta = new Vec2;
    this.position = new Vec2;

    this._last = new Vec2;
    this._first = false;

    this._SYNC = {};
};


Touch.prototype.clear = function () {

    this.id = -1;

    this.position.set(0, 0);
    this.delta.set(0, 0);
    this._last.set(0, 0);

    this.radiusX = 0;
    this.radiusY = 0;
    this.rotationAngle = 0;
    this.force = 0;

    this._first = false;

    return this;
};


Touch.prototype.fromEvent = function (e) {
    var position = this.position,
        delta = this.delta,
        last = this._last,
        first = this._first,
        element = e.target || e.srcElement,
        offsetX = element.offsetLeft,
        offsetY = element.offsetTop,
        x = (e.pageX || e.clientX) - offsetX,
        y = (e.pageY || e.clientY) - offsetY;

    last.x = first ? position.x : x;
    last.y = first ? position.y : y;

    position.x = x;
    position.y = y;

    delta.x = position.x - last.x;
    delta.y = position.y - last.y;

    this.radiusX = (e.radiusX || e.webkitRadiusX || e.mozRadiusX || e.oRadiusX || e.msRadiusX || 1);
    this.radiusY = (e.radiusY || e.webkitRadiusY || e.mozRadiusY || e.oRadiusY || e.msRadiusY || 1);
    this.rotationAngle = (e.rotationAngle || e.webkitRotationAngle || e.mozRotationAngle || e.oRotationAngle || e.msRotationAngle || 0);
    this.force = (e.force || e.webkitForce || e.mozForce || e.oForce || e.msForce || 1);

    this._first = true;

    return this;
};


Touch.prototype.toSYNC = function (json) {
    json || (json = this._SYNC);

    json.id = this.id;

    json.delta = this.delta.toJSON(json.delta);
    json.position = this.position.toJSON(json.position);

    json._last = this._last.toJSON(json._last);
    json._first = this._first;

    return json;
};


Touch.prototype.fromSYNC = function (json) {

    this.id = json.id;

    this.delta.fromJSON(json.delta);
    this.position.fromJSON(json.position);

    this._last.fromJSON(json._last);
    this._first = json._first;

    return this;
};


Touch.prototype.toJSON = function (json) {
    json || (json = {});

    json.id = this.id;

    json.delta = this.delta.toJSON(json.delta);
    json.position = this.position.toJSON(json.position);

    json._last = this._last.toJSON(json._last);
    json._first = this._first;

    return json;
};


Touch.prototype.fromJSON = function (json) {
    this.id = json.id;

    this.delta.fromJSON(json.delta);
    this.position.fromJSON(json.position);

    this._last.fromJSON(json._last);
    this._first = json._first;

    return this;
};


module.exports = Touch;

},{"../../math/vec2":111}],90:[function(require,module,exports){
var ObjectPool = require("../../base/object_pool");
var Touch = require("./touch");
"use strict";


var TOUCH_POOL = new ObjectPool(Touch),
    OBJECT_POOL = new ObjectPool(Object);


function Touches() {

    Array.call(this);
    this._SYNC = {};
}

Touches.prototype = Object.create(Array.prototype);
Touches.prototype.constructor = Touches;
Touches.TOUCH_POOL = TOUCH_POOL;


Touches.prototype.start = function (index, targetTouch) {
    var touch = TOUCH_POOL.create();

    touch.clear();
    touch.id = targetTouch.identifier;
    touch.fromEvent(targetTouch);

    this.push(touch);

    return touch;
};


Touches.prototype.end = function (index) {
    var touch = this[index];

    TOUCH_POOL.removeObject(touch);
    this.splice(index, 1);

    return touch;
};


Touches.prototype.cancel = function () {

    TOUCH_POOL.clear();
    this.length = 0;

    return this;
};


Touches.prototype.move = function (index, targetTouch) {
    var touch = this[index];

    touch.fromEvent(targetTouch);

    return touch;
};


Touches.prototype.toSYNC = function (json) {
    json || (json = this._SYNC);
    var jsonTouches = json.touches || (json.touches = []),
        i = this.length;

    jsonTouches.length = 0;
    OBJECT_POOL.clear();

    while (i--) jsonTouches[i] = this[i].toSYNC(OBJECT_POOL.create());

    return json;
};


Touches.prototype.fromSYNC = function (json) {
    var jsonTouches = json.touches,
        i = jsonTouches.length;

    this.length = 0;
    TOUCH_POOL.clear();

    while (i--) this[i] = TOUCH_POOL.create().fromSYNC(jsonTouches[i]);

    return this;
};


Touches.prototype.toJSON = function (json) {
    json || (json = {});
    var jsonTouches = json.touches || (json.touches = []),
        i;

    for (i = this.length; i--;) jsonTouches[i] = this[i].toJSON(jsonTouches[i]);
    return json;
};


Touches.prototype.fromJSON = function (json) {
    var jsonTouches = json.touches,
        touch, i, j, tl;

    for (i = jsonTouches.length, tl = this.length, j = tl; i--;) {
        if (i < tl) {
            this.splice(j--, 1);
            TOUCH_POOL.removeObject(this[j]);
        }

        if ((touch = this[i])) {
            touch.fromJSON(jsonTouches[i]);
        } else {
            this[i] = TOUCH_POOL.create().fromJSON(jsonTouches[i]);
        }
    }

    return this;
};


module.exports = Touches;

},{"../../base/object_pool":15,"./touch":89}],91:[function(require,module,exports){
var Class = require("../base/class");
var ObjectPool = require("../base/object_pool");
"use strict";


function Prefab(object) {

    Class.call(this);

    this.object = object.toJSON();
    this.objectPool = new ObjectPool(object.constructor);
}

Class.extend(Prefab);


Prefab.prototype.create = function () {
    var object = this.objectPool.create();

    object.fromJSON(this.object);
    object.on("remove", onRemove, this);

    return object;
};


Prefab.prototype.setObject = function (object) {

    this.object = object.toJSON();
    this.objectPool = new ObjectPool(object.constructor);

    return this;
};


Prefab.prototype.empty = function () {

    this.objectPool.empty();

    return this;
};


Prefab.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);

    json.object = this.object;

    return json;
};


Prefab.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);

    this.object = json.object;
    this.objectPool = new ObjectPool(Class._classes[json.object._className]);

    return this;
};


function onRemove(object) {

    this.objectPool.removeObject(object);
    object.off("remove", onRemove, this);
};


module.exports = Prefab;

},{"../base/class":8,"../base/object_pool":15}],92:[function(require,module,exports){
var EventEmitter = require("../../base/event_emitter");
var Device = require("../../base/device");
var Dom = require("../../base/dom");
var Config = require("../../base/config");
"use strict";

var addEvent = Dom.addEvent,
    removeEvent = Dom.removeEvent,
    addMeta = Dom.addMeta,
    floor = Math.floor,

    CANVAS_ID = 0,
    SCALE_REG = /-scale\s *=\s*[.0-9]+/g,
    CANVAS_STYLE = [
        "position: fixed;",
        "top: 50%;",
        "left: 50%;",
        "padding: 0px;",
        "margin: 0px;"
    ].join("\n"),
    VIEWPORT, VIEWPORT_WIDTH, VIEWPORT_HEIGHT, VIEWPORT_SCALE;

addMeta("viewport", "viewport", "initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no");
addMeta("viewport-width", "viewport", "width=device-width");
addMeta("viewport-height", "viewport", "height=device-height");

VIEWPORT = document.getElementById("viewport");
VIEWPORT_WIDTH = document.getElementById("viewport-width");
VIEWPORT_HEIGHT = document.getElementById("viewport-height");
VIEWPORT_SCALE = VIEWPORT.getAttribute("content");

function windowOnResize() {
    VIEWPORT.setAttribute("content", VIEWPORT_SCALE.replace(SCALE_REG, "-scale=" + Device.invPixelRatio));
    VIEWPORT_WIDTH.setAttribute("content", "width=" + window.innerWidth);
    VIEWPORT_HEIGHT.setAttribute("content", "height=" + window.innerHeight);
    window.scrollTo(0, 1);
}

addEvent(window, "resize orientationchange", windowOnResize);
windowOnResize();

/**
 * @class Canvas
 * @extends EventEmitter
 * @brief canvas helper
 * @param {Object} options
 */

function Canvas(opts) {
    opts || (opts = {});

    EventEmitter.call(this);

    /**
     * @property Number canvasId
     * @memberof Canvas
     */
    this.canvasId = ++CANVAS_ID;

    /**
     * @property Boolean fullScreen
     * @memberof Canvas
     */
    this.fullScreen = opts.fullScreen ? opts.fullScreen : (opts.width == undefined && opts.height == undefined) ? true : false;

    /**
     * @property String customCursor
     * @memberof Canvas
     */
    this.customCursor = opts.customCursor != undefined ? opts.customCursor : false;

    /**
     * @property Boolean hideMouse
     * @memberof Canvas
     */
    this.hideMouse = opts.hideMouse != undefined ? opts.hideMouse : false;

    /**
     * @property Number width
     * @memberof Canvas
     */
    this.width = opts.width != undefined ? opts.width : window.innerWidth;

    /**
     * @property Number height
     * @memberof Canvas
     */
    this.height = opts.height != undefined ? opts.height : window.innerHeight;

    /**
     * @property Number aspect
     * @memberof Canvas
     */
    this.aspect = this.width / this.height;

    /**
     * @property Number pixelWidth
     * @memberof Canvas
     */
    this.pixelWidth = this.width;

    /**
     * @property Number pixelHeight
     * @memberof Canvas
     */
    this.pixelHeight = this.height;

    /**
     * @property HTMLCanvasElement element
     * @memberof Canvas
     */
    this.element = undefined;
}

EventEmitter.extend(Canvas);


Canvas.prototype.init = function () {
    if (this.element) this.destroy();
    var element = document.createElement("canvas"),
        style = element.style;

    element.id = "canvas-" + this.canvasId;
    style.cssText = CANVAS_STYLE;
    style.cursor = this.customCursor ? "url(" + this.customCursor + ")" : this.hideMouse ? "none" : "default";
    document.body.appendChild(element);

    if (!Config.debug) {
        element.oncontextmenu = function () {
            return false;
        };
    }

    addEvent(window, "resize orientationchange", this.handleResize, this);

    element.requestPointerLock || (element.requestPointerLock = (
    element.webkitRequestPointerLock ||
    element.mozRequestPointerLock ||
    element.oRequestPointerLock ||
    element.msRequestPointerLock
    ));
    element.exitPointerLock || (element.exitPointerLock = (
    document.webkitExitPointerLock ||
    document.mozExitPointerLock ||
    document.oExitPointerLock ||
    document.msExitPointerLock
    ));
    element.requestFullscreen || (element.requestFullscreen = (
    element.webkitRequestFullscreen ||
    element.mozRequestFullscreen ||
    element.oRequestFullscreen ||
    element.msRequestFullscreen
    ));
    element.exitFullscreen || (element.exitFullscreen = (
    element.webkitExitFullscreen ||
    element.mozExitFullscreen ||
    element.oExitFullscreen ||
    element.msExitFullscreen
    ));

    this.element = element;
    this.handleResize();
};


Canvas.prototype.clear = function () {
    if (!this.element) return this;

    removeEvent(window, "resize orientationchange", this.handleResize, this);
    document.body.removeChild(this.element);
    this.element = undefined;

    return this;
};

/**
 * @method setFullscreen
 * @memberof Canvas
 * @brief sets fullScreen boolean
 * @param Number width
 */
Canvas.prototype.setFullscreen = function (value) {
    if (!this.element || this.fullScreen === value) return this;

    this.fullScreen = !!value;
    this.handleResize();

    return this;
};

/**
 * @method setWidth
 * @memberof Canvas
 * @brief sets width and updates aspect
 * @param Number width
 */
Canvas.prototype.setWidth = function (width) {
    if (!this.element || this.width === width) return this;

    this.width = width;
    this.fullScreen = false;
    this.aspect = this.width / this.height;

    this.handleResize();

    return this;
};

/**
 * @method setHeight
 * @memberof Canvas
 * @brief sets height and updates aspect
 * @param Number height
 */
Canvas.prototype.setHeight = function (height) {
    if (!this.element || this.height === height) return this;

    this.height = height;
    this.fullScreen = false;
    this.aspect = this.width / this.height;

    this.handleResize();

    return this;
};

/**
 * @method style
 * @memberof Canvas
 * @brief sets style of html element
 * @param String key
 * @param String value
 */
Canvas.prototype.style = function (key, value) {
    if (!this.element) return this;

    this.element.style[key] = value;
    return this;
};

/**
 * @method setBackgroundColor
 * @memberof Canvas
 * @brief sets html background color
 * @param String color
 */
Canvas.prototype.setBackgroundColor = function (color) {
    if (!this.element) return this;

    this.element.style.background = color;
    return this;
};


Canvas.prototype.handleResize = function () {
    var w = window.innerWidth,
        h = window.innerHeight,
        aspect = w / h,
        element = this.element,
        style = element.style,
        width, height;

    if (this.fullScreen) {
        width = w;
        height = h;
    } else {
        if (aspect > this.aspect) {
            width = h * this.aspect;
            height = h;
        } else {
            width = w;
            height = w / this.aspect;
        }
    }

    this.pixelWidth = floor(width);
    this.pixelHeight = floor(height);

    element.width = width;
    element.height = height;

    style.marginLeft = -floor((width + 1) * 0.5) + "px";
    style.marginTop = -floor((height + 1) * 0.5) + "px";

    style.width = floor(width) + "px";
    style.height = floor(height) + "px";

    this.emit("resize");
};


module.exports = Canvas;

},{"../../base/config":9,"../../base/device":10,"../../base/dom":11,"../../base/event_emitter":13}],93:[function(require,module,exports){
var Class = require("../../base/class");
var Enums = require("../enums");
"use strict";

/**
 * @class RenderTarget
 * @extends Class
 * @brief WebGL Render Target helper
 */

function RenderTarget(opts) {
    opts || (opts = {});

    Class.call(this);

    this.width = opts.width || 512;
    this.height = opts.height || 512;

    this.invWidth = 1 / this.width;
    this.invHeight = 1 / this.height;

    this.depthOnly = opts.depthOnly != undefined ? !!opts.depthOnly : false;
    this.depthBuffer = opts.depthBuffer != undefined ? !!opts.depthBuffer : true;
    this.stencilBuffer = opts.stencilBuffer != undefined ? !!opts.stencilBuffer : true;

    this.generateMipmap = opts.generateMipmap != undefined ? !!opts.generateMipmap : true;
    this.flipY = opts.flipY != undefined ? !!opts.flipY : true;
    this.premultiplyAlpha = opts.premultiplyAlpha != undefined ? !!opts.premultiplyAlpha : false;

    this.anisotropy = opts.anisotropy != undefined ? opts.anisotropy : 1;

    this.filter = opts.filter != undefined ? opts.filter : Enums.FilterMode.Linear;
    this.format = opts.format != undefined ? opts.format : Enums.TextureFormat.RGBA;
    this.wrap = opts.wrap != undefined ? opts.wrap : Enums.TextureWrap.Repeat;

    this._webglUsed = 0;
    this._webgl = undefined;
    this._webglFramebuffer = undefined;
    this._webglRenderbuffer = undefined;
}

Class.extend(RenderTarget);


RenderTarget.prototype.clone = function () {

    return new RenderTarget().copy(this);
};


RenderTarget.prototype.copy = function (other) {

    this.width = other.width;
    this.height = other.height;

    this.invWidth = other.invWidth;
    this.invHeight = other.invHeight;

    this.generateMipmap = other.generateMipmap;
    this.flipY = other.flipY;
    this.premultiplyAlpha = other.premultiplyAlpha;

    this.anisotropy = other.anisotropy;

    this.filter = other.filter;
    this.format = other.format;
    this.wrap = other.wrap;

    return this;
};


RenderTarget.prototype.setWidth = function (width) {

    this.width = width || this.width;
    this.needsUpdate = true;
};


RenderTarget.prototype.setHeight = function (height) {

    this.height = height || this.height;
    this.needsUpdate = true;
};


RenderTarget.prototype.setMipmap = function (value) {

    this.generateMipmap = value != undefined ? !!value : !this.generateMipmap;
    this.needsUpdate = true;
};


RenderTarget.prototype.setAnisotropy = function (value) {

    this.anisotropy = value;
    this.needsUpdate = true;
};


RenderTarget.prototype.setFilter = function (value) {

    this.filter = value;
    this.needsUpdate = true;
};


RenderTarget.prototype.setFormat = function (value) {

    this.format = value;
    this.needsUpdate = true;
};


RenderTarget.prototype.setWrap = function (value) {

    this.wrap = value;
    this.needsUpdate = true;
};


RenderTarget.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);

    json.width = this.width;
    json.height = this.height;

    json.invWidth = this.invWidth;
    json.invHeight = this.invHeight;

    json.generateMipmap = this.generateMipmap;
    json.flipY = this.flipY;
    json.premultiplyAlpha = this.premultiplyAlpha;

    json.anisotropy = this.anisotropy;

    json.filter = this.filter;
    json.format = this.format;
    json.wrap = this.wrap;

    return json;
};


RenderTarget.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);

    this.width = json.width;
    this.height = json.height;

    this.invWidth = json.invWidth;
    this.invHeight = json.invHeight;

    this.generateMipmap = json.generateMipmap;
    this.flipY = json.flipY;
    this.premultiplyAlpha = json.premultiplyAlpha;

    this.anisotropy = json.anisotropy;

    this.filter = json.filter;
    this.format = json.format;
    this.wrap = json.wrap;

    return this;
};


module.exports = RenderTarget;

},{"../../base/class":8,"../enums":73}],94:[function(require,module,exports){
var RenderTarget = require("./render_target");
"use strict";

/**
 * @class RenderTargetCube
 * @extends RenderTarget
 * @brief WebGL Render Target helper
 */

function RenderTargetCube(opts) {
    opts || (opts = {});

    RenderTarget.call(this, opts);

    this.activeCubeFace = 0;
}

RenderTarget.extend(RenderTargetCube);


RenderTargetCube.prototype.clone = function () {

    return new RenderTargetCube().copy(this);
};


RenderTargetCube.prototype.copy = function (other) {
    RenderTarget.prototype.copy.call(this, other);

    return this;
};


RenderTargetCube.prototype.toJSON = function (json) {
    json = RenderTarget.prototype.toJSON.call(this, json);

    json.activeCubeFace = this.activeCubeFace;

    return json;
};


RenderTargetCube.prototype.fromJSON = function (json) {
    RenderTarget.prototype.fromJSON.call(this, json);

    this.activeCubeFace = json.activeCubeFace;

    return this;
};


module.exports = RenderTargetCube;

},{"./render_target":93}],95:[function(require,module,exports){
var EventEmitter = require("../../base/event_emitter");
var Device = require("../../base/device");
var Dom = require("../../base/dom");
var util = require("../../base/util");

var Mathf = require("../../math/mathf");
var Color = require("../../math/color");
var Rect = require("../../math/rect");
var RectOffset = require("../../math/rect_offset");
var Vec2 = require("../../math/vec2");
var Vec3 = require("../../math/vec3");
var Vec4 = require("../../math/vec4");
var Quat = require("../../math/quat");
var Mat2 = require("../../math/mat2");
var Mat3 = require("../../math/mat3");
var Mat4 = require("../../math/mat4");

var Enums = require("../enums");
var Log = require("../../base/log");
var Config = require("../../base/config");
var RenderTarget = require("./render_target");
var RenderTargetCube = require("./render_target_cube");
var ShaderChunks = require("./shader_chunks");

var Texture = require("../assets/texture");
var TextureCube = require("../assets/texture_cube");
var MeshFilter = require("../components/mesh_filter");
var Sprite = require("../components/sprite");
var Emitter = require("../components/particle_system/emitter");
var Emitter2D = require("../components/particle_system/emitter_2d");
"use strict";


var Blending = Enums.Blending,
    ShadowMapType = Enums.ShadowMapType,
    CullFace = Enums.CullFace,
    Side = Enums.Side,

    LightType = Enums.LightType,

    FilterMode = Enums.FilterMode,
    TextureFormat = Enums.TextureFormat,
    TextureWrap = Enums.TextureWrap,

    getWebGLContext = Dom.getWebGLContext,
    addEvent = Dom.addEvent,
    removeEvent = Dom.removeEvent,

    createProgram = Dom.createProgram,

    merge = util.merge,

    max = Math.max,
    floor = Math.floor,
    clamp = Mathf.clamp,
    isPowerOfTwo = Mathf.isPowerOfTwo,

    defineProperty = Object.defineProperty,
    EMPTY_ARRAY = [];

/**
 * @class Renderer
 * @extends EventEmitter
 * @param {object} options
 */

function Renderer(opts) {
    opts || (opts = {});

    EventEmitter.call(this);

    this.autoClear = opts.autoClear != undefined ? opts.autoClear : true;
    this.autoClearColor = opts.autoClearColor != undefined ? opts.autoClearColor : true;
    this.autoClearDepth = opts.autoClearDepth != undefined ? opts.autoClearDepth : true;
    this.autoClearStencil = opts.autoClearStencil != undefined ? opts.autoClearStencil : true;

    this.shadowMapEnabled = opts.shadowMapEnabled != undefined ? opts.shadowMapEnabled : true;
    this.shadowMapAutoUpdate = opts.shadowMapAutoUpdate != undefined ? opts.shadowMapAutoUpdate : true;
    this.shadowMapType = opts.shadowMapType != undefined ? opts.shadowMapType : ShadowMapType.PCFShadowMap;
    this.shadowMapCullFace = opts.shadowMapCullFace != undefined ? opts.shadowMapCullFace : CullFace.Front;
    this.shadowMapDebug = opts.shadowMapDebug != undefined ? opts.shadowMapDebug : false;
    this.shadowMapCascade = opts.shadowMapCascade != undefined ? opts.shadowMapCascade : false;

    var _lastCamera = undefined,
        _lastResizeFn = undefined,
        _lastScene = undefined,
        _lastGUI = undefined,

        _mat4 = new Mat4,
        _projScreenMatrix = new Mat4,
        _quat = new Quat,
        _vector2 = new Vec2,
        _vector3 = new Vec3,
        _vector3_2 = new Vec3,
        _vector4 = new Vec4,
        _rect = new Rect,
        _rect_2 = new Rect,
        _rectOffset = new RectOffset,
        _color = new Color,

        _shaders = {},
        _lastBuffers = undefined,
        _spriteBuffers = undefined,

        _textTextures = {},
        _canvas2d = undefined,
        _ctx = undefined;

    /**
     * @method render
     * @memberof Renderer
     * @brief renderers scene from camera's perspective
     * @param Camera camera
     * @param Scene scene
     * @param GUI gui
     * @param RenderTarget renderTarget
     */
    function render(camera, scene, gui, renderTarget) {
        if (!_context || !camera) return;
        var lineWidth, blending, cullFace,
            background = camera.background,
            i, il;

        setRenderTarget(renderTarget);

        if (_lastClearColor.r !== background.r || _lastClearColor.g !== background.g || _lastClearColor.b !== background.b) {
            _lastClearColor.copy(background);
            _gl.clearColor(background.r, background.g, background.b, 1);
            if (!this.autoClear) clearCanvas(true, this.autoClearDepth, this.autoClearStencil);
        }
        if (_lastCamera !== camera) {

            if (camera.autoResize) {
                var w = _canvas.pixelWidth,
                    h = _canvas.pixelHeight;

                camera.set(w, h);
                setViewport(0, 0, w, h);

                if (_lastResizeFn) _canvas.off("resize", _lastResizeFn);

                _lastResizeFn = function () {
                    var w = this.pixelWidth,
                        h = this.pixelHeight;

                    camera.set(w, h);
                    setViewport(0, 0, w, h);
                };

                _canvas.on("resize", _lastResizeFn);
            } else {
                setViewport(0, 0, camera.width, camera.height);
            }

            _lastCamera = camera;
        }
        if (scene && _lastScene !== scene) {
            if (_lastScene) removeSceneEvents(_lastScene);
            addSceneEvents(scene);

            _lastScene = scene;
        }
        if (gui && _lastGUI !== gui) {
            if (_lastGUI) removeGUIEvents(_lastGUI);
            addGUIEvents(gui);

            _lastScene = gui;
        }

        _projScreenMatrix.mmul(camera.projection, camera.view);
        if (this.autoClear) clearCanvas(this.autoClearColor, this.autoClearDepth, this.autoClearStencil);

        lineWidth = _lastLineWidth;
        blending = _lastBlending;
        cullFace = _lastCullFace;

        if (scene) {
            var componentManagers = scene.componentManagers,
                ambient = scene.world.ambient,
                lights = componentManagers.Light,
                meshFilters = componentManagers.MeshFilter,
                sprites = componentManagers.Sprite,
                particleSystems = componentManagers.ParticleSystem;

            lights = lights ? lights.components : EMPTY_ARRAY;

            if (meshFilters) renderMeshFilters(camera, lights, ambient, meshFilters);
            if (sprites) renderSprites(camera, lights, ambient, sprites);
            if (particleSystems) renderParticleSystems(camera, lights, ambient, particleSystems);
        }
        if (gui) {
            var componentManagers = gui.componentManagers,
                guiContents = componentManagers.GUIContent,
                guiContent, transform;

            useDepth && setDepthTest(false);

            guiContents = guiContents ? guiContents.components : EMPTY_ARRAY;

            for (i = 0, il = guiContents.length; i < il; i++) {
                guiContent = guiContents[i];
                transform = guiContent.guiTransform;

                if (!transform) continue;

                transform.updateMatrices(camera.guiProjection);
                renderGUIContent(camera, transform, guiContent);
            }

            useDepth && setDepthTest(true);
        }

        setCullFace(cullFace);
        setBlending(blending);
        setLineWidth(lineWidth);
    };
    this.render = render;


    var _guiBuffers = undefined,
        _guiContentShader = undefined;

    function renderGUIContent(camera, transform, guiContent) {
        if (!_guiBuffers) createGUIBuffers();
        if (!_guiContentShader) createGUIContentShader();

        var force = setProgram(_guiContentShader.program),
            uniforms = _guiContentShader.uniforms,
            attributes = _guiContentShader.attributes,

            texture = guiContent.texture,
            text = guiContent.text,

            style = guiContent.style,
            styleState = style._state,
            state = style[styleState],

            innerRect = _rect.copy(transform.position),
            outerRect = _rect_2;

        if (texture) {

        } else if (text) {
            texture = createTextTexture(guiContent, innerRect, text, style, state);
            outerRect.copy(innerRect);
        } else {
            return;
        }

        if (_lastBuffers !== _guiBuffers) {
            disableAttributes();

            attributes.position.set(_guiBuffers._webglVertexBuffer);
            attributes.uv.set(_guiBuffers._webglUvBuffer);

            _lastBuffers = _guiBuffers;
        }

        style.padding.add(outerRect);
        style.margin.add(outerRect);

        uniforms.mvpMatrix.set(transform.modelView, force);
        uniforms.size.set(_vector2.set(outerRect.width, outerRect.height), force);
        uniforms.crop.set(_vector4.set(0, 0, 1, 1), force);
        uniforms.alpha.set(style.alpha, force);

        _gl.activeTexture(_gl.TEXTURE0);
        _gl.bindTexture(_gl.TEXTURE_2D, texture._webgl);
        _gl.uniform1i(uniforms.texture.location, 0);

        _gl.drawArrays(_gl.TRIANGLE_STRIP, 0, _guiBuffers._webglVertexCount);
    }


    function createTextTexture(guiContent, innerRect, text, style, state) {
        var texture = _textTextures[guiContent._id];
        if (!guiContent._needsUpdate) {
            innerRect.width = texture.width;
            innerRect.height = texture.height;
            return texture;
        }

        var canvas = _canvas2d,
            TEXTURE_2D = _gl.TEXTURE_2D,

            lineHeight = style.lineHeight,
            lineSpacing = style.lineSpacing,
            halfLineSpacing = lineSpacing * 0.5,
            fontHeight = determineFontHeight(style.font),
            ctxStyle = style.fontStyle + " " + style.fontSize + "pt " + style.font,

            maxWidth = innerRect.width,
            maxHeight = innerRect.height,
            width, height,

            lines = wwLastLines,
            line, x = 0,
            y = 0,
            i, il;

        texture = texture || (_textTextures[guiContent._id] = {});

        _ctx.font = ctxStyle;
        lineHeight = lineHeight > fontHeight ? lineHeight : fontHeight;

        if (style.wordWrap && !style.stretchWidth) {
            wordWrap(text, maxWidth, lineHeight, lineSpacing);
            width = wwLastX;
            height = wwLastY;
        } else {
            lines.length = 0;
            lines.push(text);
            width = _ctx.measureText(text).width;
            height = lineHeight + lineSpacing;
        }

        canvas.width = style.fixedWidth || width;
        canvas.height = style.fixedHeight || height;

        _ctx.font = ctxStyle;
        _ctx.fillStyle = state.text.toRGB();
        _ctx.textAlign = "left";
        _ctx.textBaseline = "top";

        for (i = 0, il = lines.length; i < il; i++) {
            line = lines[i];
            y += halfLineSpacing;
            _ctx.fillText(line, x, y);
            y += lineHeight + halfLineSpacing;
        }


        texture.width = innerRect.width = width;
        texture.height = innerRect.height = height;

        texture._webgl = texture._webgl || (texture._webgl = _gl.createTexture());

        _gl.bindTexture(TEXTURE_2D, texture._webgl);

        _gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL, 0);

        _gl.texImage2D(TEXTURE_2D, 0, _gl.RGBA, _gl.RGBA, _gl.UNSIGNED_BYTE, canvas);

        _gl.texParameteri(TEXTURE_2D, _gl.TEXTURE_MAG_FILTER, _gl.NEAREST);
        _gl.texParameteri(TEXTURE_2D, _gl.TEXTURE_MIN_FILTER, _gl.NEAREST);

        _gl.texParameteri(TEXTURE_2D, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE);
        _gl.texParameteri(TEXTURE_2D, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE);

        _gl.bindTexture(TEXTURE_2D, null);

        guiContent._needsUpdate = false;

        return texture;
    }


    var wwLastLines = [],
        wwLastX = 0,
        wwLastY = 0;

    function wordWrap(text, maxWidth, lineHeight, lineSpacing) {
        wwLastLines.length = 0;
        wwLastX = 0;
        wwLastY = lineHeight + lineSpacing;

        var words = text.split(" "),
            line = "",
            word, testLine, testWidth,
            i = 0,
            il = words.length;

        for (; i < il; i++) {
            word = words[i];
            testLine = line + word + " ";
            testWidth = _ctx.measureText(testLine).width;

            if (testWidth > maxWidth && i > 0) {
                wwLastLines.push(line);
                line = word + " ";
                wwLastY += lineHeight + lineSpacing;

                testWidth = _ctx.measureText(line).width;
                wwLastX = testWidth > wwLastX ? testWidth : wwLastX;
            } else {
                line = testLine;
            }
        }
        wwLastLines.push(line);
    }


    var heightCache = {};

    function determineFontHeight(fontStyle) {
        var result = heightCache[fontStyle];

        if (!result) {
            var body = document.body || document.getElementsByTagName("body")[0],
                dummy = document.createElement("div"),
                dummyText = document.createTextNode("M");

            dummy.appendChild(dummyText);
            dummy.setAttribute("style", "font: " + fontStyle + ";font-size:1em;line-height:1;position:absolute;top:0;left:0;padding:0;margin:0;");
            body.appendChild(dummy);

            result = dummy.offsetHeight;
            heightCache[fontStyle] = result;

            body.removeChild(dummy);
        }

        return result;
    }


    function renderMeshFilters(camera, lights, ambient, meshFilters) {
        var components = meshFilters.components,
            meshFilter, transform, i, il;

        for (i = 0, il = components.length; i < il; i++) {
            meshFilter = components[i];
            transform = meshFilter.transform || meshFilter.transform2d;

            if (!transform) continue;

            transform.updateMatrices(camera.view);
            renderMeshFilter(camera, lights, ambient, transform, meshFilter);
        }
    }

    function renderMeshFilter(camera, lights, ambient, transform, meshFilter) {
        var mesh = meshFilter.mesh,
            material = meshFilter.material,
            side, shader;

        if (!mesh || !material) return;

        setBlending(material.blending);

        side = material.side;
        if (side === Side.Front) {
            setCullFace(CullFace.Back);
        } else if (side === Side.Back) {
            setCullFace(CullFace.Front);
        } else if (side === Side.Both) {
            setCullFace();
        }

        createMeshBuffers(mesh);
        shader = createShader(mesh, material, lights);
        shader.bindMaterial(meshFilter, mesh, material, transform, camera, lights, ambient);

        if (!meshFilter._webglMeshInitted) {
            mesh._webglUsed += 1;
            shader.markAsUsed(material);
            meshFilter._webglMeshInitted = true;
        }

        if (material.wireframe) {
            setLineWidth(material.wireframeLineWidth);
            _gl.drawElements(_gl.LINES, mesh._webglLineCount, _gl.UNSIGNED_SHORT, 0);
        } else {
            _gl.drawElements(_gl.TRIANGLES, mesh._webglIndexCount, _gl.UNSIGNED_SHORT, 0);
        }
    }


    function renderSprites(camera, lights, ambient, sprites) {
        var layers = sprites.layers,
            sprite, transform, components, i, il, j, jl;

        for (i = 0, il = layers.length; i < il; i++) {
            components = layers[i];
            if (!components) continue;

            for (j = 0, jl = components.length; j < jl; j++) {
                sprite = components[j];
                transform = sprite.transform || sprite.transform2d;

                if (!transform) continue;

                transform.updateMatrices(camera.view);
                renderSprite(camera, lights, ambient, transform, sprite);
            }
        }
    }

    function renderSprite(camera, lights, ambient, transform, sprite) {
        var material = sprite.material,
            side, shader;

        if (!material) return;
        if (!_spriteBuffers) createSprite();

        setBlending(material.blending);

        side = material.side;
        if (side === Side.Front) {
            setCullFace(CullFace.Back);
        } else if (side === Side.Back) {
            setCullFace(CullFace.Front);
        } else if (side === Side.Both) {
            setCullFace();
        }

        shader = createShader(sprite, material, lights);

        if (!sprite._webglInitted) {
            shader.markAsUsed(material);
            sprite._webglInitted = true;
        }

        shader.bindMaterial(sprite, sprite, material, transform, camera, lights, ambient);

        if (material.wireframe) {
            setLineWidth(material.wireframeLineWidth);
            _gl.drawArrays(_gl.LINE_STRIP, 0, _spriteBuffers._webglVertexCount);
        } else {
            _gl.drawArrays(_gl.TRIANGLE_STRIP, 0, _spriteBuffers._webglVertexCount);
        }
    }


    function renderParticleSystems(camera, lights, ambient, particleSystems) {
        var components = particleSystems.components,
            particleSystem, transform, i, il;

        for (i = 0, il = components.length; i < il; i++) {
            particleSystem = components[i];
            transform = particleSystem.transform || particleSystem.transform2d;

            if (!transform) continue;

            transform.updateMatrices(camera.view);
            renderParticleSystem(camera, lights, ambient, transform, particleSystem);
        }
    }

    function renderParticleSystem(camera, lights, ambient, transform, particleSystem) {
        var emitters = particleSystem.emitters,
            material = particleSystem.material,
            shader, emitter,
            i = emitters.length;

        setCullFace(CullFace.Back);

        while (i--) {
            emitter = emitters[i];

            if (emitter instanceof Emitter) {
                material = emitter.material;
                if (!material) return;

                setBlending(material.blending);
                setCullFace(CullFace.Back);

                createEmitterBuffers(emitter, transform);
                shader = createShader(emitter, material, lights);
                shader.bindMaterial(particleSystem, emitter, material, transform, camera, lights, ambient);

                if (!emitter._webglInitted) {
                    shader.markAsUsed(material);
                    emitter._webglInitted = true;
                }

                _gl.drawArrays(_gl.POINTS, 0, emitter._webglParticleCount);
            } else if (emitter instanceof Emitter2D) {
                material = emitter.material;
                if (!material) return;

                setBlending(material.blending);
                setCullFace(CullFace.Back);

                createEmitter2DBuffers(emitter, transform);
                shader = createShader(emitter, material, lights);
                shader.bindMaterial(particleSystem, emitter, material, transform, camera, lights, ambient);

                if (!emitter._webglInitted) {
                    shader.markAsUsed(material);
                    emitter._webglInitted = true;
                }

                _gl.drawArrays(_gl.POINTS, 0, emitter._webglParticleCount);
            }
        }
    }

    function addSceneEvents(scene) {
        var componentManagers = scene.componentManagers,
            meshFilters = componentManagers.MeshFilter || EMPTY_ARRAY,
            sprites = componentManagers.Sprite || EMPTY_ARRAY,
            particleSystems = componentManagers.ParticleSystem || EMPTY_ARRAY,
            i;

        meshFilters.forEach(onMeshFilterAdd);
        sprites.forEach(onSpriteAdd);
        particleSystems.forEach(onParticleSystemAdd);

        scene.on("addMeshFilter", onMeshFilterAdd);
        scene.on("addSprite", onSpriteAdd);
        scene.on("addParticleSystem", onParticleSystemAdd);
    }

    function removeSceneEvents(scene) {

        scene.off("addMeshFilter", onMeshFilterAdd);
        scene.off("addSprite", onSpriteAdd);
        scene.off("addParticleSystem", onMeshFilterAdd);
    }

    function onMeshFilterAdd(meshFilter) {

        meshFilter.on("remove", onMeshFilterRemove);
    }

    function onSpriteAdd(sprite) {

        sprite.on("remove", onSpriteRemove);
    }

    function onParticleSystemAdd(particleSystem) {

        particleSystem.on("remove", onParticleSystemRemove);
    }

    function onMeshFilterRemove() {
        var mesh = this.mesh;

        deleteMeshBuffers(mesh);
        deleteShader(mesh);

        this.off("remove", onMeshFilterRemove);
    }

    function onSpriteRemove() {

        deleteShader(this);

        this.off("remove", onSpriteRemove);
    }

    function onParticleSystemRemove() {
        var emitters = this.emitters,
            emitter, i = emitters.length;

        while (i--) {
            emitter = emitters[i];

            deleteEmitterBuffers(emitter);
            deleteShader(emitter);
        }

        this.off("remove", onParticleSystemRemove);
    }

    function deleteMeshBuffers(mesh) {
        if (mesh._webglUsed > 1) {
            mesh._webglUsed -= 1;
            return;
        }

        if (mesh._webglVertexBuffer != undefined) _gl.deleteBuffer(mesh._webglVertexBuffer);
        if (mesh._webglNormalBuffer != undefined) _gl.deleteBuffer(mesh._webglNormalBuffer);
        if (mesh._webglTangentBuffer != undefined) _gl.deleteBuffer(mesh._webglTangentBuffer);
        if (mesh._webglColorBuffer != undefined) _gl.deleteBuffer(mesh._webglColorBuffer);
        if (mesh._webglUvBuffer != undefined) _gl.deleteBuffer(mesh._webglUvBuffer);
        if (mesh._webglUv2Buffer != undefined) _gl.deleteBuffer(mesh._webglUv2Buffer);

        if (mesh._webglBoneIndexBuffer != undefined) _gl.deleteBuffer(mesh._webglBoneIndexBuffer);
        if (mesh._webglBoneWeightBuffer != undefined) _gl.deleteBuffer(mesh._webglBoneWeightBuffer);

        if (mesh._webglIndexBuffer != undefined) _gl.deleteBuffer(mesh._webglIndexBuffer);
        if (mesh._webglLineBuffer != undefined) _gl.deleteBuffer(mesh._webglLineBuffer);

        mesh._webglVertexArray = mesh._webglVertexArray = undefined;
        mesh._webglNormalBuffer = mesh._webglNormalArray = undefined;
        mesh._webglTangentBuffer = mesh._webglTangentArray = undefined;
        mesh._webglColorBuffer = mesh._webglColorArray = undefined;
        mesh._webglUvBuffer = mesh._webglUvArray = undefined;
        mesh._webglUv2Buffer = mesh._webglUv2Array = undefined;

        mesh._webglBoneIndexBuffer = mesh._webglBoneIndexArray = undefined;
        mesh._webglBoneWeightBuffer = mesh._webglBoneWeightArray = undefined;

        mesh._webglIndexBuffer = mesh._webglIndexArray = undefined;
        mesh._webglLineBuffer = mesh._webglLineArray = undefined;

        mesh._webglUsed = 0;
    }

    function deleteEmitterBuffers(emitter) {

        if (emitter._webglVertexBuffer != undefined) _gl.deleteBuffer(emitter._webglVertexBuffer);
        if (emitter._webglParticleBuffer != undefined) _gl.deleteBuffer(emitter._webglParticleBuffer);
        if (emitter._webglParticleColorBuffer != undefined) _gl.deleteBuffer(emitter._webglParticleColorBuffer);

        emitter._webglVertexBuffer = emitter._webglVertexArray = undefined;
        emitter._webglParticleBuffer = emitter._webglParticleArray = undefined;
        emitter._webglParticleColorBuffer = emitter._webglParticleColorArray = undefined;
    }

    function addGUIEvents(gui) {
        var componentManagers = gui.componentManagers,
            guiContents = componentManagers.GUIContent;

        if (guiContents) guiContents.forEach(onGUIContentAdd);
        gui.on("addGUIContent", onGUIContentAdd);
    }

    function removeGUIEvents(gui) {

        gui.off("addGUIContent", onGUIContentAdd);
    }

    function onGUIContentAdd(guiContent) {

        guiContent.on("remove", onGUIContentRemove);
    }

    function onGUIContentRemove() {

        deleteShader(this);

        this.off("remove", onGUIContentRemove);
    }

    function deleteShader(obj) {
        var shader = _shaders[obj._id];
        if (!shader) return;
        var material = obj.material || obj.materials,
            i;

        if (material) {
            i = material.length;

            if (i) {
                while (i--) deleteMaterial(material[i]);
            } else {
                deleteMaterial(material);
            }
        }

        if (shader.used > 1) {
            shader.used--;
            return;
        }

        _shaders[obj._id] = undefined;
        if (shader.program) _gl.deleteProgram(shader.program);
    }

    function deleteMaterial(material) {
        var materialUniforms = material.uniforms,
            key;

        for (key in materialUniforms) deleteTexture(materialUniforms[key]);
    }

    function deleteTexture(obj) {
        if (obj instanceof Texture) {
            if (obj._webglUsed > 1) {
                obj._webglUsed -= 1;
                return;
            }

            _gl.deleteTexture(obj._webgl);
            obj._webgl = undefined;
            obj._webglUsed = 0;
        } else if (obj instanceof TextureCube) {
            if (obj._webglUsed > 1) {
                obj._webglUsed -= 1;
                return;
            }

            var j = obj._webgl.length;
            while (j--) {
                _gl.deleteTexture(obj._webgl[j]);
                obj._webgl[j] = undefined;
                obj._webglUsed = 0;
            }
        }
    }

    function createMeshBuffers(mesh) {
        if (!mesh.dynamic && mesh._webglBuffersInitted) return;
        var DRAW = mesh.dynamic ? _gl.DYNAMIC_DRAW : _gl.STATIC_DRAW,
            ARRAY_BUFFER = _gl.ARRAY_BUFFER,
            ELEMENT_ARRAY_BUFFER = _gl.ELEMENT_ARRAY_BUFFER,
            bufferArray, items, item, i, len, offset, vertexIndex;

        items = mesh.vertices || EMPTY_ARRAY;
        len = items.length;
        if (len && mesh.verticesNeedUpdate) {
            bufferArray = mesh._webglVertexArray;
            if (!bufferArray || bufferArray.length !== len * 3) {
                bufferArray = mesh._webglVertexArray = new Float32Array(len * 3);
                mesh._webglVertexCount = len;
            }

            i = len;
            while (i--) {
                item = items[i];
                offset = i * 3;

                bufferArray[offset] = item.x;
                bufferArray[offset + 1] = item.y;
                bufferArray[offset + 2] = item.z;
            }

            mesh._webglVertexBuffer = mesh._webglVertexBuffer || _gl.createBuffer();
            _gl.bindBuffer(ARRAY_BUFFER, mesh._webglVertexBuffer);
            _gl.bufferData(ARRAY_BUFFER, bufferArray, DRAW);

            mesh.verticesNeedUpdate = false;
        }

        items = mesh.normals || EMPTY_ARRAY;
        len = items.length;
        if (len && mesh.normalsNeedUpdate) {
            bufferArray = mesh._webglNormalArray;
            if (!bufferArray || bufferArray.length !== len * 3) bufferArray = mesh._webglNormalArray = new Float32Array(len * 3);

            i = len;
            while (i--) {
                item = items[i];
                offset = i * 3;

                bufferArray[offset] = item.x;
                bufferArray[offset + 1] = item.y;
                bufferArray[offset + 2] = item.z;
            }

            mesh._webglNormalBuffer = mesh._webglNormalBuffer || _gl.createBuffer();
            _gl.bindBuffer(ARRAY_BUFFER, mesh._webglNormalBuffer);
            _gl.bufferData(ARRAY_BUFFER, bufferArray, DRAW);

            mesh.normalsNeedUpdate = false;
        }

        items = mesh.tangents || EMPTY_ARRAY;
        len = items.length;
        if (len && mesh.tangentsNeedUpdate) {
            bufferArray = mesh._webglTangentArray;
            if (!bufferArray || bufferArray.length !== len * 4) bufferArray = mesh._webglTangentArray = new Float32Array(len * 4);

            i = len;
            while (i--) {
                item = items[i];
                offset = i * 4;

                bufferArray[offset] = item.x;
                bufferArray[offset + 1] = item.y;
                bufferArray[offset + 2] = item.z;
                bufferArray[offset + 3] = item.w;
            }

            mesh._webglTangentBuffer = mesh._webglTangentBuffer || _gl.createBuffer();
            _gl.bindBuffer(ARRAY_BUFFER, mesh._webglTangentBuffer);
            _gl.bufferData(ARRAY_BUFFER, bufferArray, DRAW);

            mesh.tangentsNeedUpdate = false;
        }

        items = mesh.indices || EMPTY_ARRAY;
        len = items.length;
        if (len && mesh.indicesNeedUpdate) {
            bufferArray = mesh._webglIndexArray;
            if (!bufferArray || bufferArray.length !== len) {
                bufferArray = mesh._webglIndexArray = new Uint16Array(len);
                mesh._webglIndexCount = len;
            }

            i = len;
            while (i--) bufferArray[i] = items[i];

            mesh._webglIndexBuffer = mesh._webglIndexBuffer || _gl.createBuffer();
            _gl.bindBuffer(ELEMENT_ARRAY_BUFFER, mesh._webglIndexBuffer);
            _gl.bufferData(ELEMENT_ARRAY_BUFFER, bufferArray, DRAW);

            bufferArray = mesh._webglLineArray;
            if (!bufferArray || bufferArray.length !== len * 3) {
                bufferArray = mesh._webglLineArray = new Uint16Array(len * 3);
                mesh._webglLineCount = len * 3;
            }

            i = len;
            vertexIndex = offset = 0;
            while (i--) {

                bufferArray[offset] = items[vertexIndex];
                bufferArray[offset + 1] = items[vertexIndex + 1];

                bufferArray[offset + 2] = items[vertexIndex];
                bufferArray[offset + 3] = items[vertexIndex + 2];

                bufferArray[offset + 4] = items[vertexIndex + 1];
                bufferArray[offset + 5] = items[vertexIndex + 2];

                offset += 6;
                vertexIndex += 3;
            }

            mesh._webglLineBuffer = mesh._webglLineBuffer || _gl.createBuffer();
            _gl.bindBuffer(ELEMENT_ARRAY_BUFFER, mesh._webglLineBuffer);
            _gl.bufferData(ELEMENT_ARRAY_BUFFER, bufferArray, DRAW);

            mesh.indicesNeedUpdate = false;
        }

        items = mesh.colors || EMPTY_ARRAY;
        len = items.length;
        if (len && mesh.colorsNeedUpdate) {
            bufferArray = mesh._webglColorArray;
            if (!bufferArray || bufferArray.length !== len * 3) bufferArray = mesh._webglColorArray = new Float32Array(len * 3);

            i = len;
            while (i--) {
                item = items[i];
                offset = i * 3;

                bufferArray[offset] = item.x;
                bufferArray[offset + 1] = item.y;
                bufferArray[offset + 2] = item.z;
            }

            mesh._webglColorBuffer = mesh._webglColorBuffer || _gl.createBuffer();
            _gl.bindBuffer(ARRAY_BUFFER, mesh._webglColorBuffer);
            _gl.bufferData(ARRAY_BUFFER, bufferArray, DRAW);

            mesh.colorsNeedUpdate = false;
        }

        items = mesh.uvs || EMPTY_ARRAY;
        len = items.length;
        if (len && mesh.uvsNeedUpdate) {
            bufferArray = mesh._webglUvArray;
            if (!bufferArray || bufferArray.length !== len * 2) bufferArray = mesh._webglUvArray = new Float32Array(len * 2);

            i = len;
            while (i--) {
                item = items[i];
                offset = i * 2;

                bufferArray[offset] = item.x;
                bufferArray[offset + 1] = item.y;
            }

            mesh._webglUvBuffer = mesh._webglUvBuffer || _gl.createBuffer();
            _gl.bindBuffer(ARRAY_BUFFER, mesh._webglUvBuffer);
            _gl.bufferData(ARRAY_BUFFER, bufferArray, DRAW);

            mesh.uvsNeedUpdate = false;
        }

        items = mesh.uv2s || EMPTY_ARRAY;
        len = items.length;
        if (len && mesh.uv2sNeedUpdate) {
            bufferArray = mesh._webglUv2Array;
            if (!bufferArray || bufferArray.length !== len * 2) bufferArray = mesh._webglUv2Array = new Float32Array(len * 2);

            i = len;
            while (i--) {
                item = items[i];
                offset = i * 2;

                bufferArray[offset] = item.x;
                bufferArray[offset + 1] = item.y;
            }

            mesh._webglUv2Buffer = mesh._webglUv2Buffer || _gl.createBuffer();
            _gl.bindBuffer(ARRAY_BUFFER, mesh._webglUv2Buffer);
            _gl.bufferData(ARRAY_BUFFER, bufferArray, DRAW);

            mesh.uvsNeedUpdate = false;
        }

        items = mesh.boneIndices || EMPTY_ARRAY;
        len = items.length;
        if (len && mesh.boneIndicesNeedUpdate) {
            bufferArray = mesh._webglBoneIndexArray;
            if (!bufferArray || bufferArray.length !== len) bufferArray = mesh._webglBoneIndexArray = new Float32Array(len);

            i = len;
            while (i--) bufferArray[i] = items[i];

            mesh._webglBoneIndexBuffer = mesh._webglBoneIndexBuffer || _gl.createBuffer();
            _gl.bindBuffer(ARRAY_BUFFER, mesh._webglBoneIndexBuffer);
            _gl.bufferData(ARRAY_BUFFER, bufferArray, DRAW);

            mesh.boneIndicesNeedUpdate = false;
        }

        items = mesh.boneWeights || EMPTY_ARRAY;
        len = items.length;
        if (len && mesh.boneWeightsNeedUpdate) {
            bufferArray = mesh._webglBoneWeightArray;
            if (!bufferArray || bufferArray.length !== len) bufferArray = mesh._webglBoneWeightArray = new Float32Array(len);

            i = len;
            while (i--) bufferArray[i] = items[i];

            mesh._webglBoneWeightBuffer = mesh._webglBoneWeightBuffer || _gl.createBuffer();
            _gl.bindBuffer(ARRAY_BUFFER, mesh._webglBoneWeightBuffer);
            _gl.bufferData(ARRAY_BUFFER, bufferArray, DRAW);

            mesh.boneWeightsNeedUpdate = false;
        }

        mesh._webglBuffersInitted = true;
    }


    function createEmitterBuffers(emitter, transform) {
        var MAX = Emitter.MAX_PARTICLES,

            DRAW = _gl.DYNAMIC_DRAW,
            ARRAY_BUFFER = _gl.ARRAY_BUFFER,

            positionArray, dataArray, colorArray,
            positionBuffer, dataBuffer, colorBuffer,

            particles = emitter.particles,
            particle,
            i = 0,
            len = particles.length,
            offset, position, color,
            me, x, y, z,
            m13, m23, m33, m43,
            m14, m24, m34, m44

        if (len) {
            if (emitter.sort) {
                emitter.worldSpace ? _mat4.copy(_projScreenMatrix) : _mat4.mmul(_projScreenMatrix, transform.matrixWorld);
                me = _mat4.elements;
                m13 = me[2];
                m23 = me[6];
                m33 = me[10];
                m43 = me[14];
                m14 = me[3];
                m24 = me[7];
                m34 = me[11];
                m44 = me[15];

                i = len;
                while (i--) {
                    particle = particles[i];
                    position = particle.position;
                    x = position.x;
                    y = position.y;
                    z = position.z;

                    particle.z = (m13 * x + m23 * y + m33 * z + m43) / (m14 * x + m24 * y + m34 * z + m44);
                }

                particles.sort(zSort);
            }

            positionArray = emitter._webglVertexArray || (emitter._webglVertexArray = new Float32Array(MAX * 3));
            dataArray = emitter._webglParticleArray || (emitter._webglParticleArray = new Float32Array(MAX * 3));
            colorArray = emitter._webglParticleColorArray || (emitter._webglParticleColorArray = new Float32Array(MAX * 3));

            i = len;
            while (i--) {
                particle = particles[i];
                position = particle.position;
                color = particle.color;
                offset = i * 3;

                positionArray[offset] = position.x;
                positionArray[offset + 1] = position.y;
                positionArray[offset + 2] = position.z;

                dataArray[offset] = particle.angle;
                dataArray[offset + 1] = particle.size;
                dataArray[offset + 2] = particle.alpha;

                colorArray[offset] = color.r;
                colorArray[offset + 1] = color.g;
                colorArray[offset + 2] = color.b;
            }

            positionBuffer = emitter._webglVertexBuffer || (emitter._webglVertexBuffer = _gl.createBuffer());
            _gl.bindBuffer(ARRAY_BUFFER, positionBuffer);
            _gl.bufferData(ARRAY_BUFFER, positionArray, DRAW);

            dataBuffer = emitter._webglParticleBuffer || (emitter._webglParticleBuffer = _gl.createBuffer());
            _gl.bindBuffer(ARRAY_BUFFER, dataBuffer);
            _gl.bufferData(ARRAY_BUFFER, dataArray, DRAW);

            colorBuffer = emitter._webglParticleColorBuffer || (emitter._webglParticleColorBuffer = _gl.createBuffer());
            _gl.bindBuffer(ARRAY_BUFFER, colorBuffer);
            _gl.bufferData(ARRAY_BUFFER, colorArray, DRAW);
        }

        emitter._webglParticleCount = len;
    }


    function createEmitter2DBuffers(emitter) {
        var MAX = Emitter2D.MAX_PARTICLES,

            DRAW = _gl.DYNAMIC_DRAW,
            ARRAY_BUFFER = _gl.ARRAY_BUFFER,

            positionArray, dataArray, colorArray,
            positionBuffer, dataBuffer, colorBuffer,

            particles = emitter.particles,
            particle,
            i = 0,
            len = particles.length,
            offset, position, color;

        if (len) {
            positionArray = emitter._webglVertexArray || (emitter._webglVertexArray = new Float32Array(MAX * 3));
            dataArray = emitter._webglParticleArray || (emitter._webglParticleArray = new Float32Array(MAX * 3));
            colorArray = emitter._webglParticleColorArray || (emitter._webglParticleColorArray = new Float32Array(MAX * 3));

            i = len;
            while (i--) {
                particle = particles[i];
                position = particle.position;
                color = particle.color;
                offset = i * 3;

                positionArray[offset] = position.x;
                positionArray[offset + 1] = position.y;
                positionArray[offset + 2] = 0.0;

                dataArray[offset] = particle.angle;
                dataArray[offset + 1] = particle.size;
                dataArray[offset + 2] = particle.alpha;

                colorArray[offset] = color.r;
                colorArray[offset + 1] = color.g;
                colorArray[offset + 2] = color.b;
            }

            positionBuffer = emitter._webglVertexBuffer || (emitter._webglVertexBuffer = _gl.createBuffer());
            _gl.bindBuffer(ARRAY_BUFFER, positionBuffer);
            _gl.bufferData(ARRAY_BUFFER, positionArray, DRAW);

            dataBuffer = emitter._webglParticleBuffer || (emitter._webglParticleBuffer = _gl.createBuffer());
            _gl.bindBuffer(ARRAY_BUFFER, dataBuffer);
            _gl.bufferData(ARRAY_BUFFER, dataArray, DRAW);

            colorBuffer = emitter._webglParticleColorBuffer || (emitter._webglParticleColorBuffer = _gl.createBuffer());
            _gl.bindBuffer(ARRAY_BUFFER, colorBuffer);
            _gl.bufferData(ARRAY_BUFFER, colorArray, DRAW);
        }

        emitter._webglParticleCount = len;
    }


    function zSort(a, b) {

        return b.z - a.z;
    }


    function createShader(obj, material, lights) {
        if (!material.needsUpdate && (_shaders[obj._id])) return _shaders[obj._id];

        var shader = material.shader,
            uniforms = material.uniforms,
            OES_standard_derivatives = !!_extensions.OES_standard_derivatives,
            parameters = {};

        parameters.mobile = Device.mobile;

        if (obj instanceof MeshFilter) {
            parameters.mesh = true;
        } else if (obj instanceof Sprite) {
            parameters.sprite = true;
        } else if (obj instanceof Emitter) {
            parameters.emitter = true;
            parameters.worldSpace = obj.worldSpace;
        } else if (obj instanceof Emitter2D) {
            parameters.emitter = true;
            parameters.emitter2d = true;
            parameters.worldSpace = obj.worldSpace;
        }

        parameters.useLights = shader.lights;
        parameters.useShadows = shader.shadows;
        parameters.useFog = shader.fog;
        parameters.useBones = obj.useBones && obj.bones.length > 0;
        parameters.useVertexLit = shader.vertexLit;
        parameters.useSpecular = shader.specular;

        parameters.useNormal = !!uniforms.normalMap;
        parameters.useBump = !!uniforms.bumpMap;

        parameters.positions = true;
        parameters.normals = parameters.useNormal || (obj.normals && obj.normals.length > 0);
        parameters.tangents = parameters.useNormal || (obj.tangents && obj.tangents.length > 0);
        parameters.uvs = parameters.sprite || (obj.uvs && obj.uvs.length > 0);
        parameters.colors = parameters.sprite || (obj.colors && obj.colors.length > 0);

        parameters.OES_standard_derivatives = OES_standard_derivatives && shader.OES_standard_derivatives;

        if (parameters.useBones) parameters.bones = obj.bones.length;
        allocateLights(lights, parameters);
        allocateShadows(lights, parameters);

        parameters.shadowMapEnabled = _this.shadowMapEnabled && material.receiveShadow && parameters.maxShadows > 0;
        parameters.shadowMapType = _this.shadowMapType;
        parameters.shadowMapDebug = _this.shadowMapDebug;
        parameters.shadowMapCascade = _this.shadowMapCascade;

        material.needsUpdate = false;
        return (_shaders[obj._id] = createShaderProgram(shader.vertex, shader.fragment, parameters));
    }


    function allocateLights(lights, parameters) {
        var maxPointLights = 0,
            maxDirectionalLights = 0,
            maxSpotLights = 0,
            maxHemiLights = 0,
            light, type,
            i = lights.length;

        while (i--) {
            light = lights[i];
            if (!light.visible || light.onlyShadow) continue;
            type = light.type;

            if (type === LightType.Point) {
                maxPointLights++;
            } else if (type === LightType.Directional) {
                maxDirectionalLights++;
            } else if (type === LightType.Spot) {
                maxSpotLights++;
            } else if (type === LightType.Hemi) {
                maxHemiLights++;
            }
        }

        parameters.maxPointLights = maxPointLights;
        parameters.maxDirectionalLights = maxDirectionalLights;
        parameters.maxSpotLights = maxSpotLights;
        parameters.maxHemiLights = maxHemiLights;
    }


    function allocateShadows(lights, parameters) {
        var maxShadows = 0,
            light, type,
            i = lights.length;

        while (i--) {
            light = lights[i];
            if (!light.visible || !light.castShadow) continue;
            type = light.type;

            if (type === LightType.Directional) {
                maxShadows++;
            } else if (type === LightType.Spot) {
                maxShadows++;
            }
        }

        parameters.maxShadows = maxShadows;
    }

    function createShaderProgram(vertexShader, fragmentShader, parameters) {
        var chunks = [],
            key, program, code, key;

        chunks.push(vertexShader, fragmentShader);
        for (key in parameters) chunks.push(key, parameters[key]);

        code = chunks.join();

        for (key in _shaders) {
            program = _shaders[key];

            if (program.code === code) {
                program.used++;
                return program;
            }
        }

        program = new Shader(vertexShader, fragmentShader, parameters, code).buildShader();
        return program;
    }


    var HEADER = /([\s\S]*)?(void[\s]+main)/,
        MAIN_FUNCTION = /void[\s]+main([\s]+)?(\((void)?\))([\s]+)?{([^}]*)}/,
        MAIN_SPLITER = /void[\s]+main([\s]+)?(\((void)?\))([\s]+)?{/;

    function Shader(vertex, fragment, parameters, code) {

        this.vertex = vertex;
        this.fragment = fragment;
        this.parameters = parameters;
        this.code = code;
        this.used = 0;

        this.program = undefined;
        this.attributes = undefined;
        this.uniforms = undefined;
        this._customAttributes = undefined;
        this._customUniforms = undefined;
    }

    Shader.prototype.markAsUsed = function (material) {
        this.used += 1;

        if (material) {
            var uniforms = material.uniforms,
                uniform, key;

            for (key in uniforms) {
                uniform = uniforms[key];

                if (uniform instanceof Texture) {
                    uniform._webglUsed += 1;
                } else if (uniform instanceof TextureCube) {
                    uniform._webglUsed += 1;
                }
            }
        }
    }

    Shader.prototype.bindMaterial = function (component, obj, material, transform, camera, lights, ambient) {
        var program = this.program,
            parameters = this.parameters,
            uniforms = this.uniforms,
            attributes = this.attributes,
            force = setProgram(program),
            sprite = parameters.sprite,
            texture, w, h, i, length, particleSizeRatio, bone, boneTransform, bones, uBonesPos, uBonesScl, uBonesRot;

        if (sprite) {
            if (_lastBuffers !== _spriteBuffers) {
                disableAttributes();

                attributes.position.set(_spriteBuffers._webglVertexBuffer);
                attributes.uv.set(_spriteBuffers._webglUvBuffer);

                if (attributes.normal) attributes.normal.set(_spriteBuffers._webglNormalBuffer);
                if (attributes.tangent) attributes.tangent.set(_spriteBuffers._webglTangentBuffer);

                _lastBuffers = _spriteBuffers;
            }
        } else {
            if (_lastBuffers !== obj) {
                disableAttributes();

                if (obj._webglVertexBuffer && attributes.position) attributes.position.set(obj._webglVertexBuffer);
                if (obj._webglNormalBuffer && attributes.normal) attributes.normal.set(obj._webglNormalBuffer);
                if (obj._webglTangentBuffer && attributes.tangent) attributes.tangent.set(obj._webglTangentBuffer);
                if (obj._webglColorBuffer && attributes.color) attributes.color.set(obj._webglColorBuffer);

                if (obj._webglUvBuffer && attributes.uv) attributes.uv.set(obj._webglUvBuffer);
                if (obj._webglUv2Buffer && attributes.uv2) attributes.uv2.set(obj._webglUv2Buffer);

                if (obj._webglBoneIndexBuffer && attributes.boneIndex) attributes.boneIndex.set(obj._webglBoneIndexBuffer);
                if (obj._webglBoneWeightBuffer && attributes.boneWeight) attributes.boneWeight.set(obj._webglBoneWeightBuffer);

                if (obj._webglParticleBuffer && attributes.data) attributes.data.set(obj._webglParticleBuffer);
                if (obj._webglParticleColorBuffer && attributes.particleColor) attributes.particleColor.set(obj._webglParticleColorBuffer);

                if (material.wireframe) {
                    if (obj._webglLineBuffer) _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, obj._webglLineBuffer);
                } else {
                    if (obj._webglIndexBuffer) _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, obj._webglIndexBuffer);
                }

                _lastBuffers = obj;
            }
        }

        if (sprite) {
            texture = material.uniforms.diffuseMap;
            if (!texture) throw "Shader.bind: Sprite material and shader requires diffuseMap";

            w = texture.invWidth;
            h = texture.invHeight;

            uniforms.size.set(_vector2.set(obj.width, obj.height), force);
            uniforms.crop.set(_vector4.set(obj.x * w, obj.y * h, obj.w * w, obj.h * h), force);
        }

        if (parameters.emitter && parameters.worldSpace) {
            if (uniforms.modelMatrix) uniforms.modelMatrix.set(_mat4.identity(), force);
            if (uniforms.modelViewMatrix) uniforms.modelViewMatrix.set(camera.view, force);
        } else {
            if (uniforms.modelMatrix) uniforms.modelMatrix.set(transform.matrixWorld, force);
            if (uniforms.modelViewMatrix) uniforms.modelViewMatrix.set(transform.modelView, force);
        }
        if (uniforms.particleSizeRatio) {
            particleSizeRatio = (_currentWidth < _currentHeight ? _currentWidth : _currentHeight);

            if (parameters.emitter2d || camera.camera2d || camera.orthographic) {
                particleSizeRatio *= 1.0 / (camera.orthographicSize * 2.0);
            } else {
                particleSizeRatio *= 2.0;
            }

            uniforms.particleSizeRatio.set(particleSizeRatio);
        }

        if (uniforms.projectionMatrix) uniforms.projectionMatrix.set(camera.projection, force);
        if (uniforms.viewMatrix) uniforms.viewMatrix.set(camera.view, force);
        if (uniforms.normalMatrix) uniforms.normalMatrix.set(transform.normalMatrix, force);
        if (uniforms.cameraPosition) uniforms.cameraPosition.set(_vector3.positionFromMat4((camera.transform || camera.transform2d).matrixWorld), force);
        if (uniforms.ambient) uniforms.ambient.set(ambient, force);

        if (parameters.useBones) {
            uBonesPos = uniforms.bonesPos;
            uBonesScl = uniforms.bonesScl;
            uBonesRot = uniforms.bonesRot;
            bones = component._bones;
            i = bones.length;
            while (i--) {
                bone = bones[i];
                boneTransform = bone.transform;
                _mat4.mmul(bone.uniform, bone.bindPose).decompose(_vector3, _vector3_2, _quat);

                uBonesPos[i].set(_vector3);
                uBonesScl[i].set(_vector3_2);
                uBonesRot[i].set(_quat);
            }
        }

        if (force && parameters.useLights && (length = lights.length)) {
            var maxPointLights = parameters.maxPointLights,
                maxDirectionalLights = parameters.maxDirectionalLights,
                maxSpotLights = parameters.maxSpotLights,
                maxHemiLights = parameters.maxHemiLights,

                pointLights = 0,
                pointLightColor = uniforms.pointLightColor,
                pointLightPosition = uniforms.pointLightPosition,
                pointLightDistance = uniforms.pointLightDistance,

                directionalLights = 0,
                directionalLightColor = uniforms.directionalLightColor,
                directionalLightDirection = uniforms.directionalLightDirection,

                spotLights = 0,
                spotLightColor = uniforms.spotLightColor,
                spotLightPosition = uniforms.spotLightPosition,
                spotLightDirection = uniforms.spotLightDirection,
                spotLightDistance = uniforms.spotLightDistance,
                spotLightAngleCos = uniforms.spotLightAngleCos,
                spotLightExponent = uniforms.spotLightExponent,

                hemiLights = 0,
                hemiLightColor = uniforms.hemiLightColor,
                hemiLightDirection = uniforms.hemiLightDirection,

                light, type;

            for (i = 0; i < length; i++) {
                light = lights[i];
                if (!light.visible) continue;

                type = light.type;
                _color.copy(light.color).smul(light.energy);

                if (pointLightColor.length && type === LightType.Point) {
                    if (pointLights >= maxPointLights) continue;

                    _vector3.positionFromMat4((light.transform || light.transform2d).matrixWorld);

                    pointLightColor[pointLights].set(_color, force);
                    pointLightPosition[pointLights].set(_vector3, force);
                    pointLightDistance[pointLights].set(light.distance, force);
                    pointLights++;
                } else if (directionalLightColor.length && type === LightType.Directional) {
                    if (directionalLights >= maxDirectionalLights) continue;

                    _vector3.positionFromMat4((light.transform || light.transform2d).matrixWorld).sub(light.target).normalize();
                    if (_vector3.lengthSq() === 0) continue;

                    directionalLightColor[directionalLights].set(_color, force);
                    directionalLightDirection[directionalLights].set(_vector3, force);
                    directionalLights++;

                } else if (spotLightColor.length && type === LightType.Spot) {
                    if (spotLights >= maxSpotLights) continue;

                    _vector3.positionFromMat4((light.transform || light.transform2d).matrixWorld);
                    if (_vector3.lengthSq() === 0) continue;

                    _vector3_2.copy(_vector3).sub(light.target).normalize();
                    if (_vector3_2.lengthSq() === 0) continue;

                    spotLightColor[spotLights].set(_color, force);
                    spotLightPosition[spotLights].set(_vector3, force);
                    spotLightDirection[spotLights].set(_vector3_2, force);
                    spotLightDistance[spotLights].set(light.distance, force);
                    spotLightAngleCos[spotLights].set(light._angleCos, force);
                    spotLightExponent[spotLights].set(light.exponent, force);
                    spotLights++;

                } else if (hemiLightColor.length && type === LightType.Hemi) {
                    if (hemiLights >= maxHemiLights) continue;

                    _vector3.positionFromMat4((light.transform || light.transform2d).matrixWorld).sub(light.target).normalize();
                    if (_vector3.lengthSq() === 0) continue;

                    hemiLightColor[hemiLights].set(_color, force);
                    hemiLightDirection[hemiLights].set(_vector3, force);
                    hemiLights++;
                }
            }
        }

        bindCustomUniforms(this._customUniforms, uniforms, material.name, material.uniforms, force);
        _textureIndex = 0;
    };

    function bindCustomUniforms(customUniforms, uniforms, materialName, materialUniforms, force) {
        var i = customUniforms.length,
            customUniform, uniformValue, length, name, value, j;

        while (i--) {
            customUniform = customUniforms[i];
            name = customUniform;

            uniformValue = uniforms[name];
            value = materialUniforms[name];

            if (!uniformValue) continue;
            if (!value) throw "WebGLRenderer bindShader: material " + materialName + " was not given a uniform named " + name;

            if ((length = uniformValue.length)) {
                j = length;
                while (j--) uniformValue.set(value[j], force);
            } else {
                uniformValue.set(value, force);
            }
        }
    }

    Shader.prototype.buildShader = function () {
        var parameters = this.parameters,
            vertexShader = this.vertex,
            fragmentShader = this.fragment,
            sprite = parameters.sprite,
            emitter = parameters.emitter,
            useLights = parameters.useLights,
            useShadows = parameters.useShadows,
            useFog = parameters.useFog,
            useBones = parameters.useBones,
            useVertexLit = parameters.useVertexLit,
            useSpecular = parameters.useSpecular,
            OES_standard_derivatives = parameters.OES_standard_derivatives,

            definesPrefix = [
                "precision " + _precision + " float;",
                "precision " + _precision + " int;",

                useFog ? "#define USE_FOG" : "",
                useLights ? "#define USE_LIGHTS" : "",
                useShadows ? "#define USE_SHADOWS" : "",
                useBones ? "#define USE_SKINNING" : "",
                sprite ? "#define IS_SPRITE" : "",

                useLights ? "#define MAX_DIR_LIGHTS " + parameters.maxDirectionalLights : "",
                useLights ? "#define MAX_POINT_LIGHTS " + parameters.maxPointLights : "",
                useLights ? "#define MAX_SPOT_LIGHTS " + parameters.maxSpotLights : "",
                useLights ? "#define MAX_HEMI_LIGHTS " + parameters.maxHemiLights : "",

                useShadows ? "#define MAX_SHADOWS " + parameters.maxShadows : "",
                ""
            ].join("\n"),

            vertexPrefix = [
                definesPrefix,

                "uniform mat4 modelMatrix;",
                "uniform mat4 modelViewMatrix;",
                "uniform mat4 projectionMatrix;",
                "uniform mat4 viewMatrix;",
                "uniform mat3 normalMatrix;",
                "uniform vec3 cameraPosition;",

                parameters.positions ? "attribute vec3 position;" : "",
                parameters.normals ? "attribute vec3 normal;" : "",
                parameters.tangents ? "attribute vec4 tangent;" : "",
                parameters.uvs ? "attribute vec2 uv;" : "",
                parameters.colors ? "attribute vec3 color;" : "",
                emitter ? "attribute vec3 data;" : "",

                useBones ? "attribute vec3 boneIndex;" : "",
                useBones ? "attribute vec3 boneWeight;" : "",
                useBones ? "uniform vec4 bonesRot[" + parameters.bones + "];" : "",
                useBones ? "uniform vec3 bonesScl[" + parameters.bones + "];" : "",
                useBones ? "uniform vec3 bonesPos[" + parameters.bones + "];" : ""
            ].join("\n"),

            fragmentPrefix = [
                OES_standard_derivatives ? "#extension GL_OES_standard_derivatives : enable" : "",
                definesPrefix,

                "uniform mat4 viewMatrix;",
                "uniform vec3 cameraPosition;"
            ].join("\n"),

            glVertexShader = vertexPrefix + "\n" + vertexShader,
            glFragmentShader = fragmentPrefix + "\n" + fragmentShader,

            main = "void main(void) {\n",
            footer = "\n}",

            vertexHeader = glVertexShader.match(HEADER)[1],
            vertexMain = glVertexShader.match(MAIN_FUNCTION)[5],
            fragmentHeader = glFragmentShader.match(HEADER)[1],
            fragmentMain = glFragmentShader.match(MAIN_FUNCTION)[5];

        if (sprite) {
            vertexHeader += ShaderChunks.sprite_header;
            vertexMain += ShaderChunks.sprite_vertex_after;
        }

        if (emitter) {
            vertexHeader += ShaderChunks.particle_header_vertex + ShaderChunks.particle_header;
            fragmentHeader += ShaderChunks.particle_header;
            if (parameters.emitter2d) {
                vertexMain = ShaderChunks.particle_vertex_size_2d + vertexMain;
            } else {
                vertexMain = ShaderChunks.particle_vertex_size + vertexMain;
            }
            vertexMain = ShaderChunks.particle_vertex + vertexMain;
        }

        if (OES_standard_derivatives) {
            if (parameters.useNormal) fragmentHeader += ShaderChunks.perturbNormal2Arb;
            if (parameters.useBump) fragmentHeader += ShaderChunks.dHdxy_fwd + ShaderChunks.perturbNormalArb;
        }

        if (useLights) {
            if (useVertexLit) {
                vertexHeader += ShaderChunks.lights + ShaderChunks.VertexLight;
            } else {
                vertexHeader += ShaderChunks.perPixelVaryingHeader;
                vertexMain = ShaderChunks.perPixelVaryingMain + vertexMain;

                fragmentHeader += ShaderChunks.lights + ShaderChunks.perPixelVaryingHeader;
                if (useSpecular) {
                    fragmentHeader += ShaderChunks.PixelLight;
                } else {
                    fragmentHeader += ShaderChunks.PixelLightNoSpec;
                }
            }

            if (emitter) {
                vertexMain = ShaderChunks.mvPosition_emitter + vertexMain;
                vertexMain = ShaderChunks.worldPosition_emitter + vertexMain;
            } else {
                vertexMain = (sprite ? ShaderChunks.mvPosition_sprite : ShaderChunks.mvPosition) + vertexMain;
                vertexMain = (sprite ? ShaderChunks.worldPosition_sprite : ShaderChunks.worldPosition) + vertexMain;
            }
            if (parameters.normals) vertexMain = ShaderChunks.transformedNormal + vertexMain;
        } else {
            if (emitter) {
                vertexMain = ShaderChunks.mvPosition_emitter + vertexMain;
            } else {
                vertexMain = (sprite ? ShaderChunks.mvPosition_sprite : ShaderChunks.mvPosition) + vertexMain;
            }
        }

        if (useBones) {
            vertexHeader += ShaderChunks.composeMat4;
            vertexHeader += ShaderChunks.getBoneMatrix;
            if (parameters.normals) vertexMain = ShaderChunks.boneNormal + vertexMain;
            vertexMain = ShaderChunks.bone + vertexMain;
        }

        glVertexShader = vertexHeader + main + vertexMain + footer;
        glFragmentShader = fragmentHeader + main + fragmentMain + footer;

        this.program = createProgram(_gl, glVertexShader, glFragmentShader);

        parseUniformsAttributesArrays(vertexShader, fragmentShader, (this._customAttributes = []), (this._customUniforms = []));
        parseUniformsAttributes(this.program, glVertexShader, glFragmentShader, (this.attributes = {}), (this.uniforms = {}));

        return this;
    };


    var useDepth = !opts.disableDepth,

        _this = this,

        _gl = undefined,
        _canvas = undefined,
        _element = undefined,
        _context = false,

        _extensions = undefined,

        _precision = "highp",
        _maxAnisotropy = 0,
        _maxTextures = 0,
        _maxVertexTextures = 0,
        _maxTextureSize = 0,
        _maxCubeTextureSize = 0,
        _maxRenderBufferSize = 0,

        _maxUniforms = 0,
        _maxVaryings = 0,
        _maxAttributes = 0,

        _viewportX = 0,
        _viewportY = 0,
        _viewportWidth = 1,
        _viewportHeight = 1,

        _currentWidth = 1,
        _currentHeight = 1,

        _textureIndex = 0,

        _lastClearColor = new Color,
        _lastClearAlpha = 1,
        _lastBlending = -1,
        _lastCullFace = -1,
        _cullFaceDisabled = true,
        _lastDepthTest = -1,
        _lastDepthWrite = -1,
        _lastLineWidth = -1,

        _currentFramebuffer = null,

        _enabledAttributes = undefined,
        _lastProgram = undefined,

        _attributes = merge(opts.attributes || {}, {
            alpha: true,
            antialias: true,
            depth: true,
            premultipliedAlpha: true,
            preserveDrawingBuffer: false,
            stencil: true
        });

    this.init = function (canvas) {
        if (_canvas) this.clear();

        _canvas = canvas;
        _element = canvas.element;

        _canvas2d = document.createElement("canvas");
        _ctx = _canvas2d.getContext("2d");

        initGL();
        _context = true;
        setDefaultGLState();

        addEvent(_element, "webglcontextlost", handleWebGLContextLost, this);
        addEvent(_element, "webglcontextrestored", handleWebGLContextRestored, this);

        return this;
    };


    this.clear = function () {
        if (!_canvas) return this;

        this.off();

        removeEvent(element, "webglcontextlost", handleWebGLContextLost, this);
        removeEvent(element, "webglcontextrestored", handleWebGLContextRestored, this);

        _gl = undefined
        _canvas = undefined;
        _element = undefined;
        _context = false;

        _extensions = undefined;

        _precision = "highp";
        _maxAnisotropy = 0;
        _maxTextures = 0;
        _maxVertexTextures = 0;
        _maxTextureSize = 0;
        _maxCubeTextureSize = 0;
        _maxRenderBufferSize = 0;

        _maxUniforms = 0;
        _maxVaryings = 0;
        _maxAttributes = 0;

        _viewportX = 0;
        _viewportY = 0;
        _viewportWidth = 1;
        _viewportHeight = 1;

        _textureIndex = 0;

        _lastClearColor.set(0, 0, 0);
        _lastClearAlpha = 1;
        _lastBlending = -1;
        _lastCullFace = -1;
        _cullFaceDisabled = true;
        _lastDepthTest = -1;
        _lastDepthWrite = -1;
        _lastLineWidth = -1;

        _currentFramebuffer = null;

        _enabledAttributes = undefined;
        _lastProgram = undefined;

        _shaders = {};
        _spriteBuffers = undefined;
        _lastBuffers = undefined;
        _lastCamera = undefined;
        _lastResizeFn = undefined;
        _lastScene = undefined;
        _lastGUI = undefined;

        _textTextures = {};
        _canvas2d = undefined;
        _ctx = undefined;

        _guiContentShader = undefined;
        _guiBuffers = undefined;

        return this;
    };

    defineProperty(this, "gl", {
        get: function () {
            return _gl;
        }
    });
    defineProperty(this, "canvas", {
        get: function () {
            return _canvas;
        }
    });
    defineProperty(this, "element", {
        get: function () {
            return _element;
        }
    });
    defineProperty(this, "precision", {
        get: function () {
            return _precision;
        }
    });
    defineProperty(this, "maxAnisotropy", {
        get: function () {
            return _maxAnisotropy;
        }
    });
    defineProperty(this, "maxTextures", {
        get: function () {
            return _maxTextures;
        }
    });
    defineProperty(this, "maxVertexTextures", {
        get: function () {
            return _maxVertexTextures;
        }
    });
    defineProperty(this, "maxTextureSize", {
        get: function () {
            return _maxTextureSize;
        }
    });
    defineProperty(this, "maxCubeTextureSize", {
        get: function () {
            return _maxCubeTextureSize;
        }
    });
    defineProperty(this, "maxRenderBufferSize", {
        get: function () {
            return _maxRenderBufferSize;
        }
    });
    defineProperty(this, "maxUniforms", {
        get: function () {
            return _maxUniforms;
        }
    });
    defineProperty(this, "maxVaryings", {
        get: function () {
            return _maxVaryings;
        }
    });
    defineProperty(this, "maxAttributes", {
        get: function () {
            return _maxAttributes;
        }
    });

    function createBuffer(obj, name, array) {

        obj[name] = obj[name] || _gl.createBuffer();
        _gl.bindBuffer(_gl.ARRAY_BUFFER, obj[name]);
        _gl.bufferData(_gl.ARRAY_BUFFER, array, _gl.STATIC_DRAW);
    }

    function createSprite() {
        _spriteBuffers = {};

        createBuffer(_spriteBuffers, "_webglVertexBuffer", new Float32Array([-0.5, 0.5, 0.0, -0.5, -0.5, 0.0,
            0.5, 0.5, 0.0,
            0.5, -0.5, 0.0
        ]));
        createBuffer(_spriteBuffers, "_webglUvBuffer", new Float32Array([
            0.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            1.0, 1.0
        ]));
        createBuffer(_spriteBuffers, "_webglNormalBuffer", new Float32Array([
            0.0, 0.0, 1.0,
            0.0, 0.0, 1.0,
            0.0, 0.0, 1.0,
            0.0, 0.0, 1.0,
        ]));
        createBuffer(_spriteBuffers, "_webglTangentBuffer", new Float32Array([
            0.0, 0.0, 0.0, 1.0,
            0.0, 1.0, 0.0, 1.0,
            1.0, 0.0, 0.0, 1.0,
            1.0, 1.0, 0.0, 1.0,
        ]));
        _spriteBuffers._webglVertexCount = 4;
    }

    function createGUIBuffers() {
        _guiBuffers = {};

        createBuffer(_guiBuffers, "_webglVertexBuffer", new Float32Array([
            0.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            1.0, 0.0, 0.0,
            1.0, 1.0, 0.0
        ]));
        createBuffer(_guiBuffers, "_webglUvBuffer", new Float32Array([
            0.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            1.0, 1.0
        ]));

        _guiBuffers._webglVertexCount = 4;
    }

    function createGUIContentShader() {
        var shader = _guiContentShader = new Shader,
            header = [
                "precision " + _precision + " float;",
                "precision " + _precision + " int;",
                ""
            ].join("\n"),
            vertexShader = header + guiContent_vertex,
            fragmentShader = header + guiContent_fragment;

        shader.program = createProgram(_gl, vertexShader, fragmentShader);
        parseUniformsAttributes(shader.program, vertexShader, fragmentShader, (shader.attributes = {}), (shader.uniforms = {}));
    }

    function setViewport(x, y, width, height) {
        x || (x = 0);
        y || (y = 0);
        width || (width = _canvas.pixelWidth);
        height || (height = _canvas.pixelHeight);

        if (_viewportX !== x || _viewportY !== y || _viewportWidth !== width || _viewportHeight !== height) {
            _viewportX = x;
            _viewportY = y;
            _viewportWidth = width;
            _viewportHeight = height;

            _gl.viewport(x, y, width, height);
        }
    }

    this.setViewport = setViewport;


    function setDepthTest(depthTest) {

        if (_lastDepthTest !== depthTest) {

            if (depthTest) {
                _gl.enable(_gl.DEPTH_TEST);
            } else {
                _gl.disable(_gl.DEPTH_TEST);
            }

            _lastDepthTest = depthTest;
        }
    }

    this.setDepthTest = setDepthTest;


    function setDepthWrite(depthWrite) {

        if (_lastDepthWrite !== depthWrite) {

            _gl.depthMask(depthWrite);
            _lastDepthWrite = depthWrite;
        }
    }

    this.setDepthWrite = setDepthWrite;


    function setLineWidth(width) {

        if (_lastLineWidth !== width) {

            _gl.lineWidth(width);
            _lastLineWidth = width;
        }
    }

    this.setLineWidth = setLineWidth;


    function setCullFace(cullFace) {

        if (_lastCullFace !== cullFace) {
            if (!_lastCullFace || _lastCullFace === CullFace.None) _cullFaceDisabled = true;

            if (cullFace === CullFace.Front) {
                if (_cullFaceDisabled) _gl.enable(_gl.CULL_FACE);
                _gl.cullFace(_gl.FRONT);
            } else if (cullFace === CullFace.Back) {
                if (_cullFaceDisabled) _gl.enable(_gl.CULL_FACE);
                _gl.cullFace(_gl.BACK);
            } else if (cullFace === CullFace.FrontBack) {
                if (_cullFaceDisabled) _gl.enable(_gl.CULL_FACE);
                _gl.cullFace(_gl.FRONT_AND_BACK);
            } else {
                _gl.disable(_gl.CULL_FACE);
                _lastCullFace = CullFace.None;
                return;
            }

            _lastCullFace = cullFace;
        }
    }

    this.setCullFace = setCullFace;


    function setBlending(blending) {

        if (blending !== _lastBlending) {

            if (blending === Blending.None) {
                _gl.disable(_gl.BLEND);
            } else if (blending === Blending.Additive) {
                _gl.enable(_gl.BLEND);
                _gl.blendEquation(_gl.FUNC_ADD);
                _gl.blendFunc(_gl.SRC_ALPHA, _gl.ONE);
            } else if (blending === Blending.Subtractive) {
                _gl.enable(_gl.BLEND);
                _gl.blendEquation(_gl.FUNC_ADD);
                _gl.blendFunc(_gl.ZERO, _gl.ONE_MINUS_SRC_COLOR);
            } else if (blending === Blending.Muliply) {
                _gl.enable(_gl.BLEND);
                _gl.blendEquation(_gl.FUNC_ADD);
                _gl.blendFunc(_gl.ZERO, _gl.SRC_COLOR);
            } else if (blending === Blending.Default) {
                _gl.enable(_gl.BLEND);
                _gl.blendEquationSeparate(_gl.FUNC_ADD, _gl.FUNC_ADD);
                _gl.blendFuncSeparate(_gl.SRC_ALPHA, _gl.ONE_MINUS_SRC_ALPHA, _gl.ONE, _gl.ONE_MINUS_SRC_ALPHA);
                _lastBlending = Blending.Default;
                return;
            }

            _lastBlending = blending;
        }
    }

    this.setBlending = setBlending;


    function setScissor(x, y, width, height) {

        _gl.scissor(x, y, width, height);
    };
    this.setScissor = setScissor;


    function setClearColor(color, alpha) {
        alpha || (alpha = 1);

        if (!_lastClearColor.equals(color) || alpha !== _lastClearAlpha) {

            _lastClearColor.copy(color);
            _lastClearAlpha = alpha;

            this.context.clearColor(_lastClearColor.r, _lastClearColor.g, _lastClearColor.b, _lastClearAlpha);
        }
    }

    this.setClearColor = setClearColor;


    function clearCanvas(color, depth, stencil) {
        var bits = 0;

        if (color === undefined || color) bits |= _gl.COLOR_BUFFER_BIT;
        if (depth === undefined || depth) bits |= _gl.DEPTH_BUFFER_BIT;
        if (stencil === undefined || stencil) bits |= _gl.STENCIL_BUFFER_BIT;

        _gl.clear(bits);
    }

    this.clearCanvas = clearCanvas;


    function clearColor() {

        _gl.clear(_gl.COLOR_BUFFER_BIT);
    }

    this.clearColor = clearColor;


    function clearDepth() {

        _gl.clear(_gl.DEPTH_BUFFER_BIT);
    }

    this.clearDepth = clearDepth;


    function clearStencil() {

        _gl.clear(_gl.STENCIL_BUFFER_BIT);
    }

    this.clearStencil = clearStencil;


    function setProgram(program) {

        if (_lastProgram !== program) {
            _gl.useProgram(program);
            _lastProgram = program;
            return true;
        }
        return false;
    };
    this.setProgram = setProgram;


    function enableAttribute(attribute) {

        if (_enabledAttributes[attribute] === 0) {
            _gl.enableVertexAttribArray(attribute);
            _enabledAttributes[attribute] = 1;
        }
    };
    this.enableAttribute = enableAttribute;


    function disableAttributes() {
        var i = _maxAttributes;

        while (i--) {

            if (_enabledAttributes[i] === 1) {
                _gl.disableVertexAttribArray(i);
                _enabledAttributes[i] = 0;
            }
        }
    };
    this.disableAttributes = disableAttributes;


    function setTexture(location, texture) {
        if (!texture) return;
        var index, glTexture;

        if (_textureIndex >= _maxTextures) {
            Log.warn("Renderer setTexure: using " + _textureIndex + " texture units, GPU only supports " + _maxTextures);
        }

        if ((!texture.needsUpdate || texture instanceof RenderTarget) && (glTexture = texture._webgl)) {
            index = _textureIndex++;

            _gl.activeTexture(_gl.TEXTURE0 + index);
            _gl.bindTexture(_gl.TEXTURE_2D, glTexture);
            _gl.uniform1i(location, index);

            return;
        }

        if (!texture.raw) return;

        glTexture = texture._webgl || (texture._webgl = _gl.createTexture());
        index = _textureIndex++;

        var raw = texture.raw,
            TFA = _extensions.EXT_texture_filter_anisotropic,

            isPOT = isPowerOfTwo(raw.width) && isPowerOfTwo(raw.height),
            anisotropy = clamp(texture.anisotropy || 1, 1, _maxAnisotropy),

            TEXTURE_2D = _gl.TEXTURE_2D,
            generateMipmap = texture.generateMipmap,
            filter = texture.filter,
            format = texture.format,
            wrap = texture.wrap,
            WRAP, MAG_FILTER, MIN_FILTER, FORMAT;

        if (filter === FilterMode.None) {
            MAG_FILTER = _gl.NEAREST;
            if (generateMipmap && isPOT) {
                MIN_FILTER = _gl.LINEAR_MIPMAP_NEAREST;
            } else {
                MIN_FILTER = _gl.NEAREST;
            }
        } else { //FilterMode.Linear
            MAG_FILTER = _gl.LINEAR;
            if (generateMipmap && isPOT) {
                MIN_FILTER = _gl.LINEAR_MIPMAP_LINEAR;
            } else {
                MIN_FILTER = _gl.LINEAR;
            }
        }

        if (format === TextureFormat.RGB) {
            FORMAT = _gl.RGB;
        } else if (format === TextureFormat.RGBA) {
            FORMAT = _gl.RGBA;
        } else if (format === TextureFormat.LuminanceAlpha) {
            FORMAT = _gl.LUMINANCE_ALPHA;
        } else if (format === TextureFormat.Luminance) {
            FORMAT = _gl.LUMINANCE;
        } else if (format === TextureFormat.Alpha) {
            FORMAT = _gl.ALPHA;
        }

        if (wrap === TextureWrap.Clamp) {
            WRAP = _gl.CLAMP_TO_EDGE;
        } else if (wrap === TextureWrap.MirrorRepeat) {
            WRAP = isPOT ? _gl.MIRRORED_REPEAT : _gl.CLAMP_TO_EDGE;
        } else { //TextureWrap.Repeat
            WRAP = isPOT ? _gl.REPEAT : _gl.CLAMP_TO_EDGE;
        }

        _gl.activeTexture(_gl.TEXTURE0 + index);
        _gl.bindTexture(TEXTURE_2D, glTexture);
        _gl.uniform1i(location, index);

        _gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL, texture.flipY ? 1 : 0);
        _gl.pixelStorei(_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha ? 1 : 0);

        _gl.texImage2D(TEXTURE_2D, 0, FORMAT, FORMAT, _gl.UNSIGNED_BYTE, clampToMaxSize(raw, _maxTextureSize));

        _gl.texParameteri(TEXTURE_2D, _gl.TEXTURE_MAG_FILTER, MAG_FILTER);
        _gl.texParameteri(TEXTURE_2D, _gl.TEXTURE_MIN_FILTER, MIN_FILTER);

        _gl.texParameteri(TEXTURE_2D, _gl.TEXTURE_WRAP_S, WRAP);
        _gl.texParameteri(TEXTURE_2D, _gl.TEXTURE_WRAP_T, WRAP);

        if (TFA) _gl.texParameterf(TEXTURE_2D, TFA.TEXTURE_MAX_ANISOTROPY_EXT, anisotropy);
        if (generateMipmap && isPOT) _gl.generateMipmap(TEXTURE_2D);

        texture.needsUpdate = false;
    }

    function setTextureCube(location, cubeTexture) {
        if (!cubeTexture || !cubeTexture.raw) return;
        var glTexture = cubeTexture._webgl,
            index;

        if (_textureIndex >= _maxTextures) {
            Log.warn("Renderer setTextureCube: using " + _textureIndex + " texture units, GPU only supports " + _maxTextures);
            return;
        }

        if (!cubeTexture.needsUpdate && glTexture) {
            index = _textureIndex++;

            _gl.activeTexture(_gl.TEXTURE0 + index);
            _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, glTexture);
            _gl.uniform1i(location, index);

            return;
        }

        glTexture = cubeTexture._webgl || (cubeTexture._webgl = _gl.createTexture());
        index = _textureIndex++;

        var raw = cubeTexture.raw,
            TFA = _extensions.EXT_texture_filter_anisotropic,

            first = raw[0],
            isPOT = isPowerOfTwo(first.width) && isPowerOfTwo(first.height),
            anisotropy = clamp(cubeTexture.anisotropy || 1, 1, _maxAnisotropy),

            TEXTURE_CUBE_MAP = _gl.TEXTURE_CUBE_MAP,
            TEXTURE_CUBE_MAP_POSITIVE_X = _gl.TEXTURE_CUBE_MAP_POSITIVE_X,
            UNSIGNED_BYTE = _gl.UNSIGNED_BYTE,

            generateMipmap = cubeTexture.generateMipmap,
            filter = cubeTexture.filter,
            format = cubeTexture.format,
            wrap = cubeTexture.wrap,
            WRAP, MAG_FILTER, MIN_FILTER, FORMAT;

        if (filter === FilterMode.None) {
            MAG_FILTER = _gl.NEAREST;
            if (generateMipmap && isPOT) {
                MIN_FILTER = _gl.LINEAR_MIPMAP_NEAREST;
            } else {
                MIN_FILTER = _gl.NEAREST;
            }
        } else { //FilterMode.Linear
            MAG_FILTER = _gl.LINEAR;
            if (generateMipmap && isPOT) {
                MIN_FILTER = _gl.LINEAR_MIPMAP_LINEAR;
            } else {
                MIN_FILTER = _gl.LINEAR;
            }
        }

        if (format === TextureFormat.RGB) {
            FORMAT = _gl.RGB;
        } else if (format === TextureFormat.RGBA) {
            FORMAT = _gl.RGBA;
        } else if (format === TextureFormat.LuminanceAlpha) {
            FORMAT = _gl.LUMINANCE_ALPHA;
        } else if (format === TextureFormat.Luminance) {
            FORMAT = _gl.LUMINANCE;
        } else if (format === TextureFormat.Alpha) {
            FORMAT = _gl.ALPHA;
        }

        if (wrap === TextureWrap.Clamp) {
            WRAP = _gl.CLAMP_TO_EDGE;
        } else { //TextureWrap.Repeat
            WRAP = isPOT ? _gl.REPEAT : _gl.CLAMP_TO_EDGE;
        }

        _gl.activeTexture(_gl.TEXTURE0 + index);
        _gl.bindTexture(TEXTURE_CUBE_MAP, glTexture);
        _gl.uniform1i(location, index);

        _gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL, cubeTexture.flipY ? 1 : 0);
        _gl.pixelStorei(_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, cubeTexture.premultiplyAlpha ? 1 : 0);

        _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X, 0, FORMAT, FORMAT, UNSIGNED_BYTE, clampToMaxSize(raw[0], _maxCubeTextureSize));
        _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_NEGATIVE_X, 0, FORMAT, FORMAT, UNSIGNED_BYTE, clampToMaxSize(raw[1], _maxCubeTextureSize));
        _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_Y, 0, FORMAT, FORMAT, UNSIGNED_BYTE, clampToMaxSize(raw[2], _maxCubeTextureSize));
        _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_NEGATIVE_Y, 0, FORMAT, FORMAT, UNSIGNED_BYTE, clampToMaxSize(raw[3], _maxCubeTextureSize));
        _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_Z, 0, FORMAT, FORMAT, UNSIGNED_BYTE, clampToMaxSize(raw[4], _maxCubeTextureSize));
        _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_NEGATIVE_Z, 0, FORMAT, FORMAT, UNSIGNED_BYTE, clampToMaxSize(raw[5], _maxCubeTextureSize));

        _gl.texParameteri(TEXTURE_CUBE_MAP, _gl.TEXTURE_MAG_FILTER, MAG_FILTER);
        _gl.texParameteri(TEXTURE_CUBE_MAP, _gl.TEXTURE_MIN_FILTER, MIN_FILTER);

        _gl.texParameteri(TEXTURE_CUBE_MAP, _gl.TEXTURE_WRAP_S, WRAP);
        _gl.texParameteri(TEXTURE_CUBE_MAP, _gl.TEXTURE_WRAP_T, WRAP);

        if (TFA) _gl.texParameterf(TEXTURE_CUBE_MAP, TFA.TEXTURE_MAX_ANISOTROPY_EXT, anisotropy);
        if (generateMipmap && isPOT) _gl.generateMipmap(TEXTURE_CUBE_MAP);

        cubeTexture.needsUpdate = false;
    }


    function clampToMaxSize(image, maxSize) {
        if (image.height <= maxSize && image.width <= maxSize) return image;
        var maxDim = 1 / max(image.width, image.height),
            newWidth = floor(image.width * maxSize * maxDim),
            newHeight = floor(image.height * maxSize * maxDim),
            canvas = document.createElement("canvas"),
            ctx = canvas.getContext("2d");

        canvas.width = newWidth;
        canvas.height = newHeight;
        ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, newWidth, newHeight);

        Log.once("Renderer clampToMaxSize: image height larger than machines max size (max = " + maxSize + ")");

        return canvas;
    }


    function setRenderTarget(renderTarget) {
        var isRenderTarget = !!renderTarget,
            isCube = renderTarget instanceof RenderTargetCube,
            framebuffer = null,
            width, height, vx, vy;

        if (isRenderTarget && !renderTarget._webglFramebuffer) {
            width = renderTarget.width;
            height = renderTarget.height;
            renderTarget._webgl = _gl.createTexture();

            var TFA = _extensions.EXT_texture_filter_anisotropic,
                isPOT = isPowerOfTwo(width) && isPowerOfTwo(height),
                anisotropy = clamp(renderTarget.anisotropy || 1, 1, _maxAnisotropy),

                GL_TEXTURE_TYPE = isCube ? _gl.TEXTURE_CUBE_MAP : _gl.TEXTURE_2D,
                UNSIGNED_BYTE = _gl.UNSIGNED_BYTE,
                UNSIGNED_SHORT = _gl.UNSIGNED_SHORT,
                DEPTH_COMPONENT = _gl.DEPTH_COMPONENT,

                generateMipmap = renderTarget.generateMipmap,
                filter = renderTarget.filter,
                format = renderTarget.format,
                wrap = renderTarget.wrap,
                WRAP, MAG_FILTER, MIN_FILTER, FORMAT,
                webglFramebuffer, webglRenderbuffer, depthOnly = renderTarget.depthOnly,
                i;

            if (filter === FilterMode.None) {
                MAG_FILTER = _gl.NEAREST;
                if (generateMipmap && isPOT) {
                    MIN_FILTER = _gl.LINEAR_MIPMAP_NEAREST;
                } else {
                    MIN_FILTER = _gl.NEAREST;
                }
            } else { //FilterMode.Linear
                MAG_FILTER = _gl.LINEAR;
                if (generateMipmap && isPOT) {
                    MIN_FILTER = _gl.LINEAR_MIPMAP_LINEAR;
                } else {
                    MIN_FILTER = _gl.LINEAR;
                }
            }

            if (format === TextureFormat.RGB) {
                FORMAT = _gl.RGB;
            } else if (format === TextureFormat.RGBA) {
                FORMAT = _gl.RGBA;
            } else if (format === TextureFormat.LuminanceAlpha) {
                FORMAT = _gl.LUMINANCE_ALPHA;
            } else if (format === TextureFormat.Luminance) {
                FORMAT = _gl.LUMINANCE;
            } else if (format === TextureFormat.Alpha) {
                FORMAT = _gl.ALPHA;
            }

            if (wrap === TextureWrap.Clamp) {
                WRAP = _gl.CLAMP_TO_EDGE;
            } else if (wrap === TextureWrap.MirrorRepeat) {
                WRAP = isPOT ? _gl.MIRRORED_REPEAT : _gl.CLAMP_TO_EDGE;
            } else { //TextureWrap.Repeat
                WRAP = isPOT ? _gl.REPEAT : _gl.CLAMP_TO_EDGE;
            }

            _gl.bindTexture(GL_TEXTURE_TYPE, renderTarget._webgl);

            _gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL, renderTarget.flipY ? 1 : 0);
            _gl.pixelStorei(_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, renderTarget.premultiplyAlpha ? 1 : 0);

            if (isCube) {
                webglFramebuffer = renderTarget._webglFramebuffer = [];
                webglRenderbuffer = renderTarget._webglRenderbuffer = [];

                if (renderTarget.depthOnly) {
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X, 0, DEPTH_COMPONENT, width, height, 0, DEPTH_COMPONENT, UNSIGNED_BYTE, null);
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_NEGATIVE_X, 0, DEPTH_COMPONENT, width, height, 0, DEPTH_COMPONENT, UNSIGNED_BYTE, null);
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_Y, 0, DEPTH_COMPONENT, width, height, 0, DEPTH_COMPONENT, UNSIGNED_BYTE, null);
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_NEGATIVE_Y, 0, DEPTH_COMPONENT, width, height, 0, DEPTH_COMPONENT, UNSIGNED_BYTE, null);
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_Z, 0, DEPTH_COMPONENT, width, height, 0, DEPTH_COMPONENT, UNSIGNED_BYTE, null);
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_NEGATIVE_Z, 0, DEPTH_COMPONENT, width, height, 0, DEPTH_COMPONENT, UNSIGNED_BYTE, null);
                } else {
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X, 0, FORMAT, width, height, 0, FORMAT, UNSIGNED_BYTE, null);
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_NEGATIVE_X, 0, FORMAT, width, height, 0, FORMAT, UNSIGNED_BYTE, null);
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_Y, 0, FORMAT, width, height, 0, FORMAT, UNSIGNED_BYTE, null);
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_NEGATIVE_Y, 0, FORMAT, width, height, 0, FORMAT, UNSIGNED_BYTE, null);
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_Z, 0, FORMAT, width, height, 0, FORMAT, UNSIGNED_BYTE, null);
                    _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_NEGATIVE_Z, 0, FORMAT, width, height, 0, FORMAT, UNSIGNED_BYTE, null);
                }

                _gl.texParameteri(GL_TEXTURE_TYPE, _gl.TEXTURE_MAG_FILTER, MAG_FILTER);
                _gl.texParameteri(GL_TEXTURE_TYPE, _gl.TEXTURE_MIN_FILTER, MIN_FILTER);

                _gl.texParameteri(GL_TEXTURE_TYPE, _gl.TEXTURE_WRAP_S, WRAP);
                _gl.texParameteri(GL_TEXTURE_TYPE, _gl.TEXTURE_WRAP_T, WRAP);

                i = 6;
                while (i--) {
                    webglFramebuffer[i] = _gl.createFramebuffer();
                    webglRenderbuffer[i] = _gl.createRenderbuffer();

                    setupFrameBuffer(webglFramebuffer[i], renderTarget, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i);
                    setupRenderBuffer(webglRenderbuffer[i], renderTarget);
                }
            } else {
                renderTarget._webglFramebuffer = _gl.createFramebuffer();
                renderTarget._webglRenderbuffer = _gl.createRenderbuffer();

                if (renderTarget.depthOnly) {
                    _gl.texImage2D(GL_TEXTURE_TYPE, 0, DEPTH_COMPONENT, width, height, 0, DEPTH_COMPONENT, UNSIGNED_SHORT, null);
                } else {
                    _gl.texImage2D(GL_TEXTURE_TYPE, 0, FORMAT, width, height, 0, FORMAT, UNSIGNED_BYTE, null);
                }

                _gl.texParameteri(GL_TEXTURE_TYPE, _gl.TEXTURE_MAG_FILTER, MAG_FILTER);
                _gl.texParameteri(GL_TEXTURE_TYPE, _gl.TEXTURE_MIN_FILTER, MIN_FILTER);

                _gl.texParameteri(GL_TEXTURE_TYPE, _gl.TEXTURE_WRAP_S, WRAP);
                _gl.texParameteri(GL_TEXTURE_TYPE, _gl.TEXTURE_WRAP_T, WRAP);

                setupFrameBuffer(renderTarget._webglFramebuffer, renderTarget, GL_TEXTURE_TYPE);
                setupRenderBuffer(renderTarget._webglRenderbuffer, renderTarget);
            }

            if (TFA) _gl.texParameterf(GL_TEXTURE_TYPE, TFA.TEXTURE_MAX_ANISOTROPY_EXT, anisotropy);
            if (generateMipmap && isPOT) _gl.generateMipmap(GL_TEXTURE_TYPE);

            _gl.bindTexture(GL_TEXTURE_TYPE, null);

            _gl.bindRenderbuffer(_gl.RENDERBUFFER, null);
            _gl.bindFramebuffer(_gl.FRAMEBUFFER, null);
        }

        if (isRenderTarget) {
            if (isCube) {
                framebuffer = renderTarget._webglFramebuffer[renderTarget.activeCubeFace];
            } else {
                framebuffer = renderTarget._webglFramebuffer;
            }

            vx = 0;
            vy = 0;
            width = renderTarget.width;
            height = renderTarget.height;
        } else {
            vx = _viewportX;
            vy = _viewportY;
            width = _viewportWidth;
            height = _viewportHeight;
        }

        if (framebuffer !== _currentFramebuffer) {
            _gl.bindFramebuffer(_gl.FRAMEBUFFER, framebuffer);
            setViewport(vx, vy, width, height);

            _currentFramebuffer = framebuffer;
        }

        _currentWidth = width;
        _currentHeight = height;
    }

    this.setRenderTarget = setRenderTarget;


    function setupFrameBuffer(framebuffer, renderTarget, textureTarget) {
        _gl.bindFramebuffer(_gl.FRAMEBUFFER, framebuffer);
        _gl.framebufferTexture2D(_gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, textureTarget, renderTarget._webgl, 0);
    }


    function setupRenderBuffer(renderbuffer, renderTarget) {

        _gl.bindRenderbuffer(_gl.RENDERBUFFER, renderbuffer);

        if (renderTarget.depthBuffer && !renderTarget.stencilBuffer) {

            _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height);
            _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer);
        } else if (!renderTarget.depthBuffer && renderTarget.stencilBuffer) {

            _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.STENCIL_INDEX8, renderTarget.width, renderTarget.height);
            _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer);
        } else if (renderTarget.depthBuffer && renderTarget.stencilBuffer) {

            _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height);
            _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer);
        } else {
            _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height);
        }
    };


    function handleWebGLContextLost(e) {
        e.preventDefault();
        Log.warn("Renderer: webgl context was lost");

        _context = false;
        this.emit("webglcontextlost", e);
    }


    function handleWebGLContextRestored(e) {
        Log.log("Renderer: webgl context was restored");

        initGL();
        setDefaultGLState();

        _context = true;
        this.emit("webglcontextrestored", e);
    }

    function getGPUInfo() {
        var VERTEX_SHADER = _gl.VERTEX_SHADER,
            FRAGMENT_SHADER = _gl.FRAGMENT_SHADER,
            HIGH_FLOAT = _gl.HIGH_FLOAT,
            MEDIUM_FLOAT = _gl.MEDIUM_FLOAT,

            EXT_texture_filter_anisotropic = _extensions.EXT_texture_filter_anisotropic,

            vsHighpFloat = _gl.getShaderPrecisionFormat(VERTEX_SHADER, HIGH_FLOAT),
            vsMediumpFloat = _gl.getShaderPrecisionFormat(VERTEX_SHADER, MEDIUM_FLOAT),

            fsHighpFloat = _gl.getShaderPrecisionFormat(FRAGMENT_SHADER, HIGH_FLOAT),
            fsMediumpFloat = _gl.getShaderPrecisionFormat(FRAGMENT_SHADER, MEDIUM_FLOAT),

            highpAvailable = vsHighpFloat.precision > 0 && fsHighpFloat.precision > 0,
            mediumpAvailable = vsMediumpFloat.precision > 0 && fsMediumpFloat.precision > 0,

            precision = "highp";

        if (!highpAvailable || Device.mobile) {
            if (mediumpAvailable) {
                precision = "mediump";
            } else {
                precision = "lowp";
            }
        }

        _precision = precision;
        _maxAnisotropy = EXT_texture_filter_anisotropic ? _gl.getParameter(EXT_texture_filter_anisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 1;
        _maxTextures = _gl.getParameter(_gl.MAX_TEXTURE_IMAGE_UNITS);
        _maxVertexTextures = _gl.getParameter(_gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);
        _maxTextureSize = _gl.getParameter(_gl.MAX_TEXTURE_SIZE);
        _maxCubeTextureSize = _gl.getParameter(_gl.MAX_CUBE_MAP_TEXTURE_SIZE);
        _maxRenderBufferSize = _gl.getParameter(_gl.MAX_RENDERBUFFER_SIZE);

        _maxUniforms = max(_gl.getParameter(_gl.MAX_FRAGMENT_UNIFORM_VECTORS), _gl.getParameter(_gl.MAX_VERTEX_UNIFORM_VECTORS)) * 4;
        _maxVaryings = _gl.getParameter(_gl.MAX_VARYING_VECTORS) * 4;
        _maxAttributes = _gl.getParameter(_gl.MAX_VERTEX_ATTRIBS);
    }


    function getExtensions() {
        _extensions = {};

        getExtension("EXT_texture_filter_anisotropic");

        getExtension("WEBGL_compressed_texture_s3tc");
        _extensions.WEBGL_compressed_texture_s3tc_formats = _extensions.WEBGL_compressed_texture_s3tc ? _gl.getParameter(_gl.COMPRESSED_TEXTURE_FORMATS) : null;

        getExtension("OES_standard_derivatives");
    }


    var getExtension_prefixes = ["WEBKIT", "MOZ", "O", "MS", "webkit", "moz", "o", "ms"],
        getExtension_length = getExtension_prefixes.length;

    function getExtension(name) {
        var extension = _extensions[name] || (_extensions[name] = _gl.getExtension(name));

        if (extension == undefined) {
            var i = getExtension_length;

            while (i--) {
                if ((extension = _gl.getExtension(getExtension_prefixes[i] + "_" + name))) return (_extensions[name] = extension);
            }
        }

        return extension;
    }

    this.getExtension = getExtension;


    function initGL() {
        _gl = getWebGLContext(_element, _attributes);

        _gl.getShaderPrecisionFormat || (_gl.getShaderPrecisionFormat = function () {
            return {
                rangeMin: 1,
                rangeMax: 1,
                precision: 1
            };
        });

        getExtensions();
        getGPUInfo();

        _enabledAttributes = new Uint8Array(_maxAttributes);
    }


    function setDefaultGLState() {

        _gl.clearColor(0, 0, 0, 1);
        useDepth && _gl.clearDepth(1);
        _gl.clearStencil(0);

        useDepth && setDepthTest(true);
        useDepth && _gl.depthFunc(_gl.LEQUAL);

        _gl.frontFace(_gl.CCW);

        setCullFace(CullFace.Back);
        setBlending(Blending.Default);
        setLineWidth(1);

        setViewport();
    }


    var SHADER_SPLITER = /[\n;]+/,
        ATTRIBURE = /attribute\s+([a-z]+\s+)?([A-Za-z0-9]+)\s+([a-zA-Z_0-9]+)\s*(\[\s*(.+)\s*\])?/,
        UNIFORM = /uniform\s+([a-z]+\s+)?([A-Za-z0-9]+)\s+([a-zA-Z_0-9]+)\s*(\[\s*(.+)\s*\])?/,
        DEFINE = /#define\s+([a-zA-Z_0-9]+)?\s+([0-9]+)?/;

    function parseUniformsAttributesArrays(vertexShader, fragmentShader, attributes, uniforms) {
        var src = vertexShader + fragmentShader,
            lines = src.split(SHADER_SPLITER),
            matchAttributes, matchUniforms,
            i = lines.length,
            line;

        while (i--) {
            line = lines[i];
            matchAttributes = line.match(ATTRIBURE);
            matchUniforms = line.match(UNIFORM);

            if (matchAttributes) {
                attributes.push(matchAttributes[3]);
            } else if (matchUniforms) {
                uniforms.push(matchUniforms[3]);
            }
        }
    }

    this.parseUniformsAttributesArrays = parseUniformsAttributesArrays;

    function parseUniformsAttributes(program, vertexShader, fragmentShader, attributes, uniforms) {
        var src = vertexShader + fragmentShader,
            lines = src.split(SHADER_SPLITER),
            defines = {}, matchAttributes, matchUniforms, matchDefines,
            uniformArray, name, type, location, length, line,
            i, j;

        i = lines.length;
        while (i--) {
            matchDefines = lines[i].match(DEFINE);
            if (matchDefines) defines[matchDefines[1]] = Number(matchDefines[2]);
        }

        i = lines.length;
        while (i--) {
            line = lines[i];
            matchAttributes = line.match(ATTRIBURE);
            matchUniforms = line.match(UNIFORM);

            if (matchAttributes) {
                name = matchAttributes[3];
                attributes[name] = createAttribute(matchAttributes[2], _gl.getAttribLocation(program, name));
            } else if (matchUniforms) {
                type = matchUniforms[2];
                name = matchUniforms[3];
                length = matchUniforms[5];

                if (length) {
                    length = defines[length.trim()] || length;
                    uniformArray = uniforms[name] = [];

                    j = length;
                    while (j--) uniformArray[j] = createUniform(type, _gl.getUniformLocation(program, name + "[" + j + "]"));
                } else {
                    location = _gl.getUniformLocation(program, name);
                    if (location) uniforms[name] = createUniform(type, location);
                }
            }
        }
    }

    this.parseUniformsAttributes = parseUniformsAttributes;


    function createAttribute(type, location) {
        if (location < 0) return null;

        if (type === "int") {
            return new Attribute1i(location);
        } else if (type === "float") {
            return new Attribute1f(location);
        } else if (type === "vec2") {
            return new Attribute2f(location);
        } else if (type === "vec3") {
            return new Attribute3f(location);
        } else if (type === "vec4") {
            return new Attribute4f(location);
        }

        return null;
    };


    function Attribute1i(location) {
        this.location = location;
    }

    Attribute1i.prototype.set = function (value) {
        var location = this.location;

        if (location > -1) {
            _gl.bindBuffer(_gl.ARRAY_BUFFER, value);
            enableAttribute(location);
            _gl.vertexAttribPointer(location, 1, _gl.FLOAT, false, 0, 0);
        }
    };

    function Attribute1f(location) {
        this.location = location;
    }

    Attribute1f.prototype.set = function (value) {
        var location = this.location;

        if (location > -1) {
            _gl.bindBuffer(_gl.ARRAY_BUFFER, value);
            enableAttribute(location);
            _gl.vertexAttribPointer(location, 1, _gl.FLOAT, false, 0, 0);
        }
    };

    function Attribute2f(location) {
        this.location = location;
    }

    Attribute2f.prototype.set = function (value) {
        var location = this.location;

        if (location > -1) {
            _gl.bindBuffer(_gl.ARRAY_BUFFER, value);
            enableAttribute(location);
            _gl.vertexAttribPointer(location, 2, _gl.FLOAT, false, 0, 0);
        }
    };

    function Attribute3f(location) {
        this.location = location;
    }

    Attribute3f.prototype.set = function (value) {
        var location = this.location;

        if (location > -1) {
            _gl.bindBuffer(_gl.ARRAY_BUFFER, value);
            enableAttribute(location);
            _gl.vertexAttribPointer(location, 3, _gl.FLOAT, false, 0, 0);
        }
    };

    function Attribute4f(location) {
        this.location = location;
    }

    Attribute4f.prototype.set = function (value) {
        var location = this.location;

        if (location > -1) {
            _gl.bindBuffer(_gl.ARRAY_BUFFER, value);
            enableAttribute(location);
            _gl.vertexAttribPointer(location, 4, _gl.FLOAT, false, 0, 0);
        }
    };


    function createUniform(type, location) {
        if (!location) return null;

        if (type === "int") {
            return new Uniform1i(location);
        } else if (type === "float") {
            return new Uniform1f(location);
        } else if (type === "vec2") {
            return new Uniform2f(location);
        } else if (type === "vec3") {
            return new Uniform3f(location);
        } else if (type === "vec4") {
            return new Uniform4f(location);
        } else if (type === "mat2") {
            return new UniformMatrix2fv(location);
        } else if (type === "mat3") {
            return new UniformMatrix3fv(location);
        } else if (type === "mat4") {
            return new UniformMatrix4fv(location);
        } else if (type === "sampler2D") {
            return new UniformTexture(location);
        } else if (type === "samplerCube") {
            return new UniformTextureCube(location);
        }

        return null;
    }

    function Uniform1f(location) {
        this.location = location;
        this.value = undefined;
    }

    Uniform1f.prototype.set = function (value, force) {
        if (force || this.value !== value) {
            _gl.uniform1f(this.location, value);
            this.value = value;
        }
    };

    function Uniform1i(location) {
        this.location = location;
        this.value = undefined;
    }

    Uniform1i.prototype.set = function (value, force) {
        if (force || this.value !== value) {
            _gl.uniform1i(this.location, value);
            this.value = value;
        }
    };

    function Uniform2f(location) {
        this.location = location;
        this.value = new Vec2(NaN, NaN);
    }

    Uniform2f.prototype.set = function (value, force) {
        if (force || this.value.notEquals(value)) {
            _gl.uniform2f(this.location, value.x, value.y);
            this.value.copy(value);
        }
    };

    function Uniform3f(location) {
        this.location = location;
        this.value = new Vec3(NaN, NaN, NaN);
    }

    Uniform3f.prototype.set = function (value, force) {
        if (force || this.value.notEquals(value)) {
            _gl.uniform3f(this.location, value.x, value.y, value.z);
            this.value.copy(value);
        }
    };

    function Uniform4f(location) {
        this.location = location;
        this.value = new Vec4(NaN, NaN, NaN, NaN);
    }

    Uniform4f.prototype.set = function (value, force) {
        if (force || this.value.notEquals(value)) {
            _gl.uniform4f(this.location, value.x, value.y, value.z, value.w);
            this.value.copy(value);
        }
    };

    function UniformMatrix2fv(location) {
        this.location = location;
        this.value = new Mat2(
            NaN, NaN,
            NaN, NaN
        );
    }

    UniformMatrix2fv.prototype.set = function (value, force) {
        if (force || this.value.notEquals(value)) {
            _gl.uniformMatrix2fv(this.location, false, value.elements);
            this.value.copy(value);
        }
    };

    function UniformMatrix3fv(location) {
        this.location = location;
        this.value = new Mat3(
            NaN, NaN, NaN,
            NaN, NaN, NaN,
            NaN, NaN, NaN
        );
    }

    UniformMatrix3fv.prototype.set = function (value, force) {
        if (force || this.value.notEquals(value)) {
            _gl.uniformMatrix3fv(this.location, false, value.elements);
            this.value.copy(value);
        }
    };

    function UniformMatrix4fv(location) {
        this.location = location;
        this.value = new Mat4(
            NaN, NaN, NaN, NaN,
            NaN, NaN, NaN, NaN,
            NaN, NaN, NaN, NaN,
            NaN, NaN, NaN, NaN
        );
    }

    UniformMatrix4fv.prototype.set = function (value, force) {
        if (force || this.value.notEquals(value)) {
            _gl.uniformMatrix4fv(this.location, false, value.elements);
            this.value.copy(value);
        }
    };

    function UniformTexture(location) {
        this.location = location;
    }

    UniformTexture.prototype.set = function (value) {
        setTexture(this.location, value);
    };

    function UniformTextureCube(location) {
        this.location = location;
    }

    UniformTextureCube.prototype.set = function (value) {
        setTextureCube(this.location, value);
    };
}

EventEmitter.extend(Renderer);


var guiContent_vertex = [
    "attribute vec3 position;",
    "attribute vec2 uv;",

    "uniform mat4 mvpMatrix;",
    "uniform vec2 size;",
    "uniform vec4 crop;",

    "varying vec2 vUv;",

    "void main() {",
    "	vUv.x = uv.x * crop.z + crop.x;",
    "	vUv.y = uv.y * crop.w + crop.y;",
    "	gl_Position = mvpMatrix * vec4(position.xy * size, position.z, 1.0);",
    "}"
].join("\n");

var guiContent_fragment = [
    "uniform sampler2D texture;",
    "uniform float alpha;",

    "varying vec2 vUv;",

    "void main() {",
    "	vec4 finalColor = texture2D(texture, vUv);",
    "	gl_FragColor = vec4(finalColor.xyz, finalColor.w * alpha);",
    "}"
].join("\n");


module.exports = Renderer;

},{"../../base/config":9,"../../base/device":10,"../../base/dom":11,"../../base/event_emitter":13,"../../base/log":14,"../../base/util":19,"../../math/color":102,"../../math/mat2":103,"../../math/mat3":104,"../../math/mat4":106,"../../math/mathf":107,"../../math/quat":108,"../../math/rect":109,"../../math/rect_offset":110,"../../math/vec2":111,"../../math/vec3":112,"../../math/vec4":113,"../assets/texture":38,"../assets/texture_cube":39,"../components/mesh_filter":60,"../components/particle_system/emitter":62,"../components/particle_system/emitter_2d":63,"../components/sprite":69,"../enums":73,"./render_target":93,"./render_target_cube":94,"./shader_chunks":96}],96:[function(require,module,exports){
"use strict";


var ShaderChunks = {
    dHdxy_fwd: [
        "vec2 dHdxy_fwd(sampler2D map, vec2 uv, float scale) {",

        "	vec2 dSTdx = dFdx(uv);",
        "	vec2 dSTdy = dFdy(uv);",

        "	float Hll = scale * texture2D(map, uv).x;",
        "	float dBx = scale * texture2D(map, uv + dSTdx).x - Hll;",
        "	float dBy = scale * texture2D(map, uv + dSTdy).x - Hll;",

        "	return vec2(dBx, dBy);",
        "}",
        ""
    ].join("\n"),

    perturbNormalArb: [
        "vec3 perturbNormalArb(vec3 surf_pos, vec3 surf_norm, vec2 dHdxy) {",

        "	vec3 vSigmaX = dFdx(surf_pos);",
        "	vec3 vSigmaY = dFdy(surf_pos);",
        "	vec3 vN = surf_norm;",

        "	vec3 R1 = cross(vSigmaY, vN);",
        "	vec3 R2 = cross(vN, vSigmaX);",

        "	float fDet = dot(vSigmaX, R1);",
        "	vec3 vGrad = sign(fDet) * (dHdxy.x * R1 + dHdxy.y * R2);",

        "	return normalize(abs(fDet) * surf_norm - vGrad);",
        "}",
        ""
    ].join("\n"),

    perturbNormal2Arb: [
        "vec3 perturbNormal2Arb(sampler2D map, vec2 uv, vec3 eye_pos, vec3 surf_norm, float scale) {",

        "	vec3 q0 = dFdx(eye_pos.xyz);",
        "	vec3 q1 = dFdy(eye_pos.xyz);",
        "	vec2 st0 = dFdx(uv.st);",
        "	vec2 st1 = dFdy(uv.st);",

        "	vec3 S = normalize(q0 * st1.t - q1 * st0.t);",
        "	vec3 T = normalize(-q0 * st1.s + q1 * st0.s);",
        "	vec3 N = normalize(surf_norm);",

        "	vec3 mapN = texture2D(map, uv).xyz * 2.0 - 1.0;",
        "	mapN.xy = scale * mapN.xy;",
        "	mat3 tsn = mat3(S, T, N);",

        "	return normalize(tsn * mapN);",
        "}",
        ""
    ].join("\n"),

    composeMat4: [
        "mat4 composeMat4(vec3 position, vec3 scale, vec4 rotation) {",
        "	mat4 mat;",
        "	float x = rotation.x, y = rotation.y, z = rotation.z, w = rotation.w,",

        "		x2 = x + x, y2 = y + y, z2 = z + z,",
        "		xx = x * x2, xy = x * y2, xz = x * z2,",
        "		yy = y * y2, yz = y * z2, zz = z * z2,",
        "		wx = w * x2, wy = w * y2, wz = w * z2,",

        "		sx = scale.x, sy = scale.y, sz = scale.z;",

        "	mat[0][0] = (1.0 - (yy + zz)) * sx;",
        "	mat[1][0] = (xy - wz) * sy;",
        "	mat[2][0] = (xz + wy) * sz;",

        "	mat[0][1] = (xy + wz) * sx;",
        "	mat[1][1] = (1.0 - (xx + zz)) * sy;",
        "	mat[2][1] = (yz - wx) * sz;",

        "	mat[0][2] = (xz - wy) * sx;",
        "	mat[1][2] = (yz + wx) * sy;",
        "	mat[2][2] = (1.0 - (xx + yy)) * sz;",

        "	mat[0][3] = 0.0;",
        "	mat[1][3] = 0.0;",
        "	mat[2][3] = 0.0;",

        "	mat[3][0] = position.x;",
        "	mat[3][1] = position.y;",
        "	mat[3][2] = position.z;",
        "	mat[3][3] = 1.0;",

        "	return mat;",
        "}",
        ""
    ].join("\n"),

    getBoneMatrix: [
        "#ifdef USE_SKINNING",
        "mat4 getBoneMatrix() {",
        "	mat4 result = boneWeight.x * composeMat4(bonesPos[int(boneIndex.x)], bonesScl[int(boneIndex.x)], bonesRot[int(boneIndex.x)]);",
        "	result = result + boneWeight.y * composeMat4(bonesPos[int(boneIndex.y)], bonesScl[int(boneIndex.y)], bonesRot[int(boneIndex.y)]);",
        "	result = result + boneWeight.z * composeMat4(bonesPos[int(boneIndex.z)], bonesScl[int(boneIndex.z)], bonesRot[int(boneIndex.z)]);",
        "	return result;",
        "}",
        "#endif",
        ""
    ].join("\n"),

    bone: [
        "	#ifdef USE_SKINNING",
        "		mat4 boneMatrix = getBoneMatrix();",

        "		#ifdef USE_MORPHTARGETS",
        "			vec4 boneVertex = vec4( morphed, 1.0 );",
        "		#else",
        "			vec4 boneVertex = vec4( position, 1.0 );",
        "		#endif",

        "		vec4 bone = boneMatrix * boneVertex;",
        "	#endif",
        ""
    ].join("\n"),

    boneNormal: [
        "	#ifdef USE_SKINNING",
        "		#ifdef USE_MORPHNORMALS",
        "			vec4 boneNormal = boneMatrix * vec4( morphedNormal, 0.0 );",
        "		#else",
        "			vec4 boneNormal = boneMatrix * vec4( normal, 0.0 );",
        "		#endif",
        "	#endif",
        ""
    ].join("\n"),

    transformedNormal: [
        "	#ifdef USE_SKINNING",
        "	vec3 objectNormal = boneNormal.xyz;",
        "	#endif",

        "	#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )",
        "	vec3 objectNormal = morphedNormal;",
        "	#endif",

        "	#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )",
        "	vec3 objectNormal = normal;",
        "	#endif",

        "	vec3 transformedNormal = normalMatrix * objectNormal;",
        ""
    ].join("\n"),

    worldPosition: [
        "	#ifdef USE_SKINNING",
        "	vec4 worldPosition = modelMatrix * bone;",
        "	#endif",

        "	#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )",
        "	vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );",
        "	#endif",

        "	#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )",
        "	vec4 worldPosition = modelMatrix * vec4( position, 1.0 );",
        "	#endif",
        ""
    ].join("\n"),

    worldPosition_sprite: [
        "	vec4 worldPosition = modelMatrix * vec4( position.xy * size, position.z, 1.0 );",
        ""
    ].join("\n"),

    worldPosition_emitter: [
        "	vec4 worldPosition = modelMatrix * vec4( position, 1.0 );",
        ""
    ].join("\n"),

    mvPosition: [
        "	#ifdef USE_SKINNING",
        "	vec4 mvPosition = modelViewMatrix * bone;",
        "	#endif",

        "	#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )",
        "	vec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );",
        "	#endif",

        "	#if !defined( USE_SKINNING ) && !defined( USE_MORPHTARGETS )",
        "	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",
        "	#endif",
        ""
    ].join("\n"),

    mvPosition_sprite: [
        "	vec4 mvPosition = modelViewMatrix * vec4( position.xy * size, position.z, 1.0 );",
        ""
    ].join("\n"),

    mvPosition_emitter: [
        "	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",
        ""
    ].join("\n"),

    particle_header_vertex: [
        "attribute vec3 particleColor;",
        "uniform float particleSizeRatio;",
        ""
    ].join("\n"),

    particle_header: [
        "varying float vAngle;",
        "varying float vAlpha;",
        "varying float vSize;",
        "varying vec3 vParticleColor;",
        ""
    ].join("\n"),

    particle_vertex: [
        "	vAngle = data.x;",
        "	vAlpha = data.z;",
        "	vSize = data.y;",
        "	vParticleColor = particleColor;",
        ""
    ].join("\n"),

    particle_vertex_size: [
        "	gl_PointSize = vSize * (particleSizeRatio / length(mvPosition.xyz));\n",
        ""
    ].join("\n"),

    particle_vertex_size_2d: [
        "	gl_PointSize = vSize * particleSizeRatio;\n",
        ""
    ].join("\n"),

    sprite_header: [
        "uniform vec2 size;",
        "uniform vec4 crop;",
        ""
    ].join("\n"),

    sprite_vertex_after: [
        "	vUv.x = vUv.x * crop.z + crop.x;",
        "	vUv.y = vUv.y * crop.w + crop.y;",
        ""
    ].join("\n"),

    lights: [
        "uniform vec3 ambient;",

        "#if MAX_DIR_LIGHTS > 0",

        "uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];",
        "uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];",

        "#endif",

        "#if MAX_HEMI_LIGHTS > 0",

        "uniform vec3 hemiLightColor[ MAX_HEMI_LIGHTS ];",
        "uniform vec3 hemiLightDirection[ MAX_HEMI_LIGHTS ];",

        "#endif",

        "#if MAX_POINT_LIGHTS > 0",

        "uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];",
        "uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];",
        "uniform float pointLightDistance[ MAX_POINT_LIGHTS ];",

        "#endif",

        "#if MAX_SPOT_LIGHTS > 0",

        "uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];",
        "uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];",
        "uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];",
        "uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];",
        "uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];",
        "uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];",

        "#endif",
        ""
    ].join("\n"),

    VertexLight: [
        "void VertexLight(vec3 normal, vec3 worldPosition, vec3 viewPosition, inout vec3 diffuseLight) {",

        "	#if MAX_DIR_LIGHTS > 0",
        "		for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {",

        "			vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );",
        "			vec3 dirVector = normalize( lDirection.xyz );",

        "			float dotProduct = dot( normal, dirVector );",
        "			vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );",

        "			diffuseLight += directionalLightColor[ i ] * directionalLightWeighting;",
        "		}",
        "	#endif",

        "	#if MAX_POINT_LIGHTS > 0",
        "		for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {",

        "			vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );",
        "			vec3 lVector = lPosition.xyz + viewPosition;",

        "			float lDistance = 1.0;",
        "			if ( pointLightDistance[ i ] > 0.0 ) {",
        "				lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );",
        "			}",

        "			lVector = normalize( lVector );",
        "			float dotProduct = dot( normal, lVector );",

        "			vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );",

        "			diffuseLight += pointLightColor[ i ] * pointLightWeighting * lDistance;",
        "		}",
        "	#endif",

        "	#if MAX_SPOT_LIGHTS > 0",
        "		for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {",

        "			vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );",
        "			vec3 lVector = lPosition.xyz + viewPosition;",

        "			float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition ) );",

        "			if ( spotEffect > spotLightAngleCos[ i ] ) {",

        "				spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );",

        "				float lDistance = 1.0;",
        "				if ( spotLightDistance[ i ] > 0.0 ) {",
        "					lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );",
        "				}",

        "				lVector = normalize( lVector );",

        "				float dotProduct = dot( normal, lVector );",
        "				vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );",

        "				diffuseLight += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;",
        "			}",

        "		}",
        "	#endif",

        "	#if MAX_HEMI_LIGHTS > 0",
        "		for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {",

        "			vec4 lDirection = viewMatrix * vec4( hemiLightDirection[ i ], 0.0 );",
        "			vec3 lVector = normalize( lDirection.xyz );",

        "			float dotProduct = dot( normal, lVector );",
        "			float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;",

        "			diffuseLight += hemiLightColor[ i ] * hemiDiffuseWeight;",
        "		}",
        "	#endif",

        "	diffuseLight += ambient;",
        "}",
        ""
    ].join("\n"),

    perPixelVaryingHeader: [
        "varying vec3 vWorldPosition;",
        "varying vec3 vViewPosition;",
        "varying vec3 vNormal;",
        ""
    ].join("\n"),

    perPixelVaryingMain: [
        "	vWorldPosition = worldPosition.xyz;",
        "	vViewPosition = -mvPosition.xyz;",
        "	vNormal = transformedNormal;",
    ].join("\n"),

    PixelLight: [
        "void PixelLight(vec3 normal, vec3 specularColor, float specularStrength, float shininess, inout vec3 diffuseLight, inout vec3 specularLight) {",
        "	#if MAX_DIR_LIGHTS > 0",
        "		for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {",

        "			vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );",
        "			vec3 dirVector = normalize( lDirection.xyz );",

        "			float dotProduct = dot( normal, dirVector );",
        "			vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );",

        "			diffuseLight += directionalLightColor[ i ] * directionalLightWeighting;",

        "			vec3 dirHalfVector = normalize( dirVector + vViewPosition );",
        "			float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );",
        "			float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );",
        "			float specularNormalization = ( shininess + 2.0001 ) / 8.0;",

        "			vec3 schlick = specularColor + vec3( 1.0 - specularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );",
        "			specularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * directionalLightWeighting * specularNormalization;",
        "		}",
        "	#endif",

        "	#if MAX_POINT_LIGHTS > 0",
        "		for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {",

        "			vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );",
        "			vec3 lVector = lPosition.xyz + vViewPosition;",

        "			float lDistance = 1.0;",
        "			if ( pointLightDistance[ i ] > 0.0 ) {",
        "				lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );",
        "			}",

        "			lVector = normalize( lVector );",
        "			float dotProduct = dot( normal, lVector );",

        "			vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );",

        "			diffuseLight += pointLightColor[ i ] * pointLightWeighting * lDistance;",

        "			vec3 pointHalfVector = normalize( lVector + vViewPosition );",
        "			float pointDiffuseWeight = max( dotProduct, 0.0 );",
        "			float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );",
        "			float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );",

        "			float specularNormalization = ( shininess + 2.0001 ) / 8.0;",
        "			vec3 schlick = specularColor + vec3( 1.0 - specularColor ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );",
        "			specularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;",
        "		}",
        "	#endif",

        "	#if MAX_SPOT_LIGHTS > 0",
        "		for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {",

        "			vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );",
        "			vec3 lVector = lPosition.xyz + vViewPosition;",

        "			float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );",

        "			if ( spotEffect > spotLightAngleCos[ i ] ) {",

        "				spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );",

        "				float lDistance = 1.0;",
        "				if ( spotLightDistance[ i ] > 0.0 ) {",
        "					lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );",
        "				}",

        "				lVector = normalize( lVector );",

        "				float dotProduct = dot( normal, lVector );",
        "				vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );",

        "				diffuseLight += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;",

        "				vec3 spotHalfVector = normalize( lVector + vViewPosition );",
        "				float spotDiffuseWeight = max( dotProduct, 0.0 );",
        "				float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );",
        "				float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );",

        "				float specularNormalization = ( shininess + 2.0001 ) / 8.0;",

        "				vec3 schlick = specularColor + vec3( 1.0 - specularColor ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );",
        "				specularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;",
        "			}",

        "		}",
        "	#endif",

        "	#if MAX_HEMI_LIGHTS > 0",
        "		for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {",

        "			vec4 lDirection = viewMatrix * vec4( hemiLightDirection[ i ], 0.0 );",
        "			vec3 lVector = normalize( lDirection.xyz );",

        "			float dotProduct = dot( normal, lVector );",

        "			float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;",
        "			float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;",

        "			diffuseLight += hemiLightColor[ i ] * hemiDiffuseWeight;",

        "			vec3 hemiHalfVector = normalize( lVector + vViewPosition );",
        "			float hemiDotNormalHalf = max( dot( normal, hemiHalfVector ), 0.0 );",
        "			float hemiSpecularWeight = specularStrength * max( pow( hemiDotNormalHalf, shininess ), 0.0 );",

        "			float specularNormalization = ( shininess + 2.0001 ) / 8.0;",
        "			vec3 schlick = specularColor + vec3( 1.0 - specularColor ) * pow( 1.0 - dot( lVector, hemiHalfVector ), 5.0 );",
        "			specularLight += schlick * hemiLightColor[ i ] * hemiSpecularWeight * hemiDiffuseWeight * specularNormalization;",
        "		}",
        "	#endif",

        "	diffuseLight += ambient;",
        "}",
        ""
    ].join("\n"),

    PixelLightNoSpec: [
        "vec3 PixelLightNoSpec(vec3 normal) {",
        "	vec3 diffuseLight;",

        "	#if MAX_DIR_LIGHTS > 0",
        "		for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {",

        "			vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );",
        "			vec3 dirVector = normalize( lDirection.xyz );",

        "			float dotProduct = dot( normal, dirVector );",
        "			vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );",

        "			diffuseLight += directionalLightColor[ i ] * directionalLightWeighting;",
        "		}",
        "	#endif",

        "	#if MAX_POINT_LIGHTS > 0",
        "		for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {",

        "			vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );",
        "			vec3 lVector = lPosition.xyz + vViewPosition;",

        "			float lDistance = 1.0;",
        "			if ( pointLightDistance[ i ] > 0.0 ) {",
        "				lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );",
        "			}",

        "			lVector = normalize( lVector );",
        "			float dotProduct = dot( normal, lVector );",

        "			vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );",

        "			diffuseLight += pointLightColor[ i ] * pointLightWeighting * lDistance;",
        "		}",
        "	#endif",

        "	#if MAX_SPOT_LIGHTS > 0",
        "		for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {",

        "			vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );",
        "			vec3 lVector = lPosition.xyz + vViewPosition;",

        "			float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );",

        "			if ( spotEffect > spotLightAngleCos[ i ] ) {",

        "				spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );",

        "				float lDistance = 1.0;",
        "				if ( spotLightDistance[ i ] > 0.0 ) {",
        "					lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );",
        "				}",

        "				lVector = normalize( lVector );",

        "				float dotProduct = dot( normal, lVector );",
        "				vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );",

        "				diffuseLight += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;",
        "			}",

        "		}",
        "	#endif",

        "	#if MAX_HEMI_LIGHTS > 0",
        "		for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {",

        "			vec4 lDirection = viewMatrix * vec4( hemiLightDirection[ i ], 0.0 );",
        "			vec3 lVector = normalize( lDirection.xyz );",

        "			float dotProduct = dot( normal, lVector );",

        "			float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;",
        "			float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;",

        "			diffuseLight += hemiLightColor[ i ] * hemiDiffuseWeight;",
        "		}",
        "	#endif",

        "	diffuseLight += ambient;",

        "	return diffuseLight;",
        "}",
        ""
    ].join("\n")
};


module.exports = ShaderChunks;

},{}],97:[function(require,module,exports){
var Class = require("../base/class");
var GameObject = require("./game_object");
var ComponentManager = require("./component_managers/component_manager");
var World = require("./world/world");
var Log = require("./../base/log");
"use strict";


/**
 * Scenes manage GameObjects and their Components
 * @class Odin.Scene
 * @extends Odin.Class
 * @param Object options
 */
function Scene(opts) {
    opts || (opts = {});

    Class.call(this);

    this.game = undefined;

    this.name = opts.name != undefined ? opts.name : "Scene_" + this._id;

    this.world = undefined;

    this.gameObjects = [];
    this._gameObjectHash = {};
    this._gameObjectJSONHash = {};

    this.componentManagers = {};
    this._componentManagerTypes = [];
    this._componentHash = {};
    this._componentJSONHash = {};

    this.setWorld(opts.world instanceof World ? opts.world : new World(opts.world));
    if (opts.gameObjects) this.addGameObjects.apply(this, opts.gameObjects);
}

Class.extend(Scene);


Scene.prototype.copy = function (other) {
    var otherGameObjects = other.gameObjects,
        i = otherGameObjects.length;

    this.clear();
    this.name = other.name + "." + this._id;

    while (i--) this.addGameObject(otherGameObjects[i].clone());

    return this;
};


Scene.prototype.init = function () {
    var gameObjects = this.gameObjects,
        i, il;

    this.world && this.world.init();

    for (i = 0, il = gameObjects.length; i < il; i++) gameObjects[i].emit("init");
};


Scene.prototype.start = function () {
    var componentManagerTypes = this._componentManagerTypes,
        gameObjects = this.gameObjects,
        i, il;

    this.world && this.world.start();

    for (i = 0, il = componentManagerTypes.length; i < il; i++) componentManagerTypes[i].start();
    for (i = 0, il = gameObjects.length; i < il; i++) gameObjects[i].emit("start");
};


Scene.prototype.update = function () {
    var componentManagerTypes = this._componentManagerTypes,
        componentManagerType, i, il;

    this.world && this.world.update();

    for (i = 0, il = componentManagerTypes.length; i < il; i++) {
        if ((componentManagerType = componentManagerTypes[i])) componentManagerType.update();
    }
};


Scene.prototype.clear = function () {
    var gameObjects = this.gameObjects,
        i = gameObjects.length;

    this.removeWorld();
    while (i--) this.removeGameObject(gameObjects[i], true);

    this.off();

    return this;
};


Scene.prototype.destroy = function () {

    this.emit("destroy");
    this.clear();

    return this;
};


Scene.prototype.setWorld = function (world) {
    if (this.world) this.removeWorld();

    world.scene = this;
    this.world = world;

    if (this.game) world.init();

    return this;
};


Scene.prototype.removeWorld = function () {
    if (!this.world) return this;
    var world = this.world;

    world.scene = undefined;
    this.world = undefined;

    return this;
};


Scene.prototype.addGameObject = function (gameObject) {
    if (!(gameObject instanceof GameObject)) {
        Log.error("Scene.addGameObject: can't add argument to Scene, it's not an instance of GameObject");
        return this;
    }
    var gameObjects = this.gameObjects,
        index = gameObjects.indexOf(gameObject),
        components, transform, children, child,
        i;

    if (index === -1) {
        if (gameObject.scene) gameObject.scene.removeGameObject(gameObject);

        gameObjects.push(gameObject);
        this._gameObjectHash[gameObject._id] = gameObject;
        if (gameObject._jsonId !== -1) this._gameObjectJSONHash[gameObject._jsonId] = gameObject;

        gameObject.scene = this;

        components = gameObject.components;
        i = components.length;
        while (i--) this._addComponent(components[i]);

        if ((transform = gameObject.transform || gameObject.transform2d)) {
            i = (children = transform.children).length;

            while (i--) {
                if ((child = children[i].gameObject) && !this.hasGameObject(child)) {
                    this.addGameObject(child);
                }
            }
        }

        if (this.game) gameObject.emit("init");
        this.emit("addGameObject", gameObject);
    } else {
        Log.error("Scene.addGameObject: GameObject is already a member of Scene");
    }

    return this;
};


Scene.prototype.addGameObjects = function () {
    var i = 0,
        il = arguments.length;

    for (; i < il; i++) this.addGameObject(arguments[i]);
    return this;
};


Scene.prototype._addComponent = function (component) {
    if (!component) return;
    var type = component._type,
        componentManagers = this.componentManagers,
        componentManager = componentManagers[type],
        componentManagerTypes = this._componentManagerTypes,
        isNew = !componentManager;

    if (isNew) {
        componentManager = componentManagers[type] = new (Class._classes[type + "ComponentManager"] || ComponentManager);
        componentManagerTypes.push(componentManager);
        componentManagerTypes.sort(sortComponentManagerTypes);
        componentManager.scene = this;
    }

    componentManager.add(component);
    componentManager.sort();

    this._componentHash[component._id] = component;
    if (component._jsonId !== -1) this._componentJSONHash[component._jsonId] = component;

    this.emit("add" + type, component);
    this.emit("addComponent", component);

    if (this.game) {
        component.start();
        component.emit("start");
    }
};


function sortComponentManagerTypes(a, b) {

    return a.order - b.order;
}


Scene.prototype.removeGameObject = function (gameObject, clear) {
    if (!(gameObject instanceof GameObject)) {
        Log.error("Scene.removeGameObject: can't remove argument from Scene, it's not an instance of GameObject");
        return this;
    }
    var gameObjects = this.gameObjects,
        index = gameObjects.indexOf(gameObject),
        components, transform, children, child,
        i;

    if (index !== -1) {

        gameObjects.splice(index, 1);
        this._gameObjectHash[gameObject._id] = undefined;
        if (gameObject._jsonId !== -1) this._gameObjectJSONHash[gameObject._jsonId] = undefined;

        gameObject.scene = undefined;

        components = gameObject.components;
        i = components.length;
        while (i--) this._removeComponent(components[i], clear);

        if ((transform = gameObject.transform || gameObject.transform2d)) {
            i = (children = transform.children).length;

            while (i--) {
                if ((child = children[i].gameObject) && this.hasGameObject(child)) {
                    this.removeGameObject(child);
                }
            }
        }

        this.emit("removeGameObject", gameObject);
        gameObject.emit("remove", gameObject);
        if (clear) gameObject.clear();
    } else {
        Log.error("Scene.removeGameObject: GameObject is not a member of Scene");
    }

    return this;
};


Scene.prototype.removeGameObjects = function () {
    var i = 0,
        il = arguments.length;

    for (; i < il; i++) this.removeGameObject(arguments[i]);
    return this;
};


Scene.prototype._removeComponent = function (component, clear) {
    if (!component) return;
    var type = component._type,
        componentManagers = this.componentManagers,
        componentManager = componentManagers[type],
        componentManagerTypes = this._componentManagerTypes;

    componentManager.remove(component);
    this._componentHash[component._id] = undefined;
    if (component._jsonId !== -1) this._componentJSONHash[component._jsonId] = undefined;

    if (componentManager.empty()) {
        componentManagers[type] = undefined;
        componentManagerTypes.splice(componentManagerTypes.indexOf(componentManager), 1);
        componentManager.scene = undefined;
    }

    this.emit("remove" + type, component);
    this.emit("removeComponent", component);

    if (clear) component.clear();
};


Scene.prototype.hasGameObject = function (gameObject) {

    return !!~this.gameObjects.indexOf(gameObject);
};


Scene.prototype.findByTag = function (tag, out) {
    out || (out = []);
    var gameObjects = this.gameObjects,
        gameObject, i = gameObjects.length;

    while (i--) {
        if ((gameObject = gameObjects[i]).hasTag(tag)) out.push(gameObject);
    }

    return out;
};


Scene.prototype.findByTagFirst = function (tag) {
    var gameObjects = this.gameObjects,
        gameObject, i = gameObjects.length;

    while (i--) {
        if ((gameObject = gameObjects[i]).hasTag(tag)) return gameObject;
    }

    return undefined;
};


Scene.prototype.findById = function (id) {

    return this._gameObjectHash[id];
};


Scene.prototype.findByJSONId = function (id) {

    return this._gameObjectJSONHash[id];
};


Scene.prototype.findComponentById = function (id) {

    return this._componentHash[id];
};


Scene.prototype.findComponentByJSONId = function (id) {

    return this._componentJSONHash[id];
};


Scene.prototype.find = function (name) {
    var gameObjects = this.gameObjects,
        child, i = gameObjects.length;

    while (i--) {
        child = gameObjects[i];

        if (child.name === name) return child;
        if ((child = child.find(name))) return child;
    }

    return undefined;
};


Scene.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);
    var gameObjects = this.gameObjects,
        jsonGameObjects = json.gameObjects || (json.gameObjects = []),
        gameObject,
        i = gameObjects.length;

    json.name = this.name;
    json.world = this.world.toJSON(json.world);

    while (i--) {
        if ((gameObject = gameObjects[i])) jsonGameObjects[i] = gameObject.toJSON(jsonGameObjects[i]);
    }

    return json;
};


Scene.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);
    var jsonGameObjects = json.gameObjects,
        gameObject, jsonGameObject,
        i = jsonGameObjects.length;

    this.name = json.name;

    if (this.world._className === json.world._className) {
        this.world.fromJSON(json.world);
    } else {
        this.setWorld(Class.fromJSON(json.world));
    }

    while (i--) {
        if (!(jsonGameObject = jsonGameObjects[i])) continue;

        if ((gameObject = this._gameObjectJSONHash[jsonGameObject._id])) {
            gameObject.fromJSON(jsonGameObject);
        } else {
            this.addGameObject(Class.fromJSON(jsonGameObject));
        }
    }

    return this;
};


module.exports = Scene;

},{"../base/class":8,"./../base/log":14,"./component_managers/component_manager":43,"./game_object":77,"./world/world":98}],98:[function(require,module,exports){
var Class = require("../../base/class");
var Color = require("../../math/color");
"use strict";


function World(opts) {
    opts || (opts = {});

    Class.call(this);

    this.scene = undefined;

    this.ambient = opts.ambient != undefined ? opts.ambient : new Color;
}

Class.extend(World);


World.prototype.init = function () {

};


World.prototype.start = function () {

};


World.prototype.update = function () {

};


World.prototype.clear = function () {

    return this;
};


World.prototype.destroy = function () {
    if (!this.scene) {
        Log.error("World.destroy: can't destroy World if it's not set to a Scene");
        return this;
    }

    this.scene.removeWorld();
    this.emit("destroy");

    this.clear();

    return this;
};


World.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);

    json.ambient = this.ambient.toJSON(json.ambient);

    return json;
};


World.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);

    this.ambient.fromJSON(json.ambient);

    return this;
};


module.exports = World;

},{"../../base/class":8,"../../math/color":102}],99:[function(require,module,exports){
var util = require("../../base/util");
var Time = require("../../base/time");
var Color = require("../../math/color");
var World = require("./world");
var Phys2D = require("../../phys2d/phys2d");
"use strict";


function World2D(opts) {
    opts || (opts = {});

    World.call(this, opts);

    this.space = new Phys2D.P2Space(opts.space);
}

World.extend(World2D);


World2D.prototype.init = function () {
    var space = this.space,
        scene = this.scene,
        RigidBodies = scene.componentManagers.RigidBody2D;

    function addBody(component) {

        space.addBody(component.body);
    }

    if (RigidBodies) RigidBodies.forEach(addBody);
    scene.on("addRigidBody2D", addBody);

    scene.on("removeRigidBody2D", function (component) {
        space.removeBody(component.body);
    });
};


World2D.prototype.update = function () {

    this.space.step(Time.delta);
};


World2D.prototype.clear = function () {
    World.prototype.clear.call(this);

    return this;
};


World2D.prototype.toSYNC = function (json) {
    json = World.prototype.toSYNC.call(this, json);

    return json;
};


World2D.prototype.fromSYNC = function (json) {
    World.prototype.fromSYNC.call(this, json);

    return this;
};


World2D.prototype.toJSON = function (json) {
    json = World.prototype.toJSON.call(this, json);

    json.space = this.space.toJSON(json.space);

    return json;
};


World2D.prototype.fromJSON = function (json) {
    World.prototype.fromJSON.call(this, json);

    this.space.fromJSON(json.space);

    return this;
};


module.exports = World2D;

},{"../../base/time":18,"../../base/util":19,"../../math/color":102,"../../phys2d/phys2d":131,"./world":98}],100:[function(require,module,exports){
var Mathf = require("./mathf");
var Vec2 = require("./vec2");
"use strict";


/**
 * @class AABB2
 * 2d axis aligned bounding box
 * @param Vec2 min
 * @param Vec2 max
 */
function AABB2(min, max) {

    /**
     * @property Vec2 min
     * @memberof Odin.AABB2
     */
    this.min = min || new Vec2(Infinity, Infinity);

    /**
     * @property Vec2 max
     * @memberof Odin.AABB2
     */
    this.max = max || new Vec2(-Infinity, -Infinity);
}

/**
 * @method clone
 * @memberof Odin.AABB2
 * returns new copy of this
 * @return AABB2
 */
AABB2.prototype.clone = function () {

    return new AABB2(this.min.clone(), this.max.clone());
};

/**
 * @method copy
 * @memberof Odin.AABB2
 * copies other AABB
 * @param AABB2 other
 * @return this
 */
AABB2.prototype.copy = function (other) {

    this.min.copy(other.min);
    this.max.copy(other.max);

    return this;
};

/**
 * @method set
 * @memberof Odin.AABB2
 * set min and max vectors
 * @param Vec2 min
 * @param Vec2 max
 * @return this
 */
AABB2.prototype.set = function (min, max) {

    this.min.copy(min);
    this.max.copy(max);

    return this;
};

/**
 * @method expandPoint
 * @memberof Odin.AABB2
 * @param Vec2 v
 * @return this
 */
AABB2.prototype.expandPoint = function (v) {

    this.min.min(v);
    this.max.max(v);

    return this;
};

/**
 * @method expandVec
 * @memberof Odin.AABB2
 * @param Vec2 v
 * @return this
 */
AABB2.prototype.expandVec = function (v) {

    this.min.sub(v);
    this.max.add(v);

    return this;
};

/**
 * @method expandScalar
 * @memberof Odin.AABB2
 * @param Number s
 * @return this
 */
AABB2.prototype.expandScalar = function (s) {

    this.min.ssub(s);
    this.max.sadd(s);

    return this;
};

/**
 * @method union
 * @memberof Odin.AABB2
 * joins this and another aabb
 * @param AABB2 aabb
 * @return this
 */
AABB2.prototype.union = function (other) {

    this.min.min(other.min);
    this.max.max(other.max);

    return this;
};

/**
 * @method clear
 * @memberof Odin.AABB2
 * clears aabb
 * @return this
 */
AABB2.prototype.clear = function () {

    this.min.set(Infinity, Infinity);
    this.max.set(-Infinity, -Infinity);

    return this;
};

/**
 * @method contains
 * @memberof Odin.AABB2
 * checks if AABB contains point
 * @param Vec2 point
 * @return Boolean
 */
AABB2.prototype.contains = function (point) {
    var min = this.min,
        max = this.max,
        px = point.x,
        py = point.y;

    return !(
    px < min.x || px > max.x ||
    py < min.y || py > max.y
    );
};

/**
 * @method intersects
 * @memberof Odin.AABB2
 * checks if AABB intersects AABB
 * @param AABB2 other
 * @return Boolean
 */
AABB2.prototype.intersects = function (other) {
    var aMin = this.min,
        aMax = this.max,
        bMin = other.min,
        bMax = other.max;

    return !(
    bMax.x < aMin.x || bMin.x > aMax.x ||
    bMax.y < aMin.y || bMin.y > aMax.y
    );
};

/**
 * @method fromPoints
 * @memberof Odin.AABB2
 * set min and max from array of vectors
 * @param Array points
 * @return this
 */
AABB2.prototype.fromPoints = function (points) {
    var v, i = points.length,
        minx = Infinity,
        miny = Infinity,
        maxx = -Infinity,
        maxy = -Infinity,
        min = this.min,
        max = this.max,
        x, y;

    while (i--) {
        v = points[i];
        x = v.x;
        y = v.y;

        minx = minx > x ? x : minx;
        miny = miny > y ? y : miny;

        maxx = maxx < x ? x : maxx;
        maxy = maxy < y ? y : maxy;
    }

    min.x = minx;
    min.y = miny;
    max.x = maxx;
    max.y = maxy;

    return this;
};

/**
 * @method fromCenterSize
 * @memberof Odin.AABB2
 * sets this from a center point and a size vector
 * @param Vec2 center
 * @param Vec2 size
 * @return this
 */
AABB2.prototype.fromCenterSize = function (center, size) {
    var min = this.min,
        max = this.max,
        x = center.x,
        y = center.y,
        hx = size.x * 0.5,
        hy = size.y * 0.5;

    min.x = x - hx;
    min.y = y - hy;

    max.x = x + hx;
    max.y = y + hy;

    return this;
};

/**
 * @memberof Odin.AABB2
 * @param Odin.AABB2 other
 * @return this
 */
AABB2.prototype.equals = function (other) {

    return !(!this.min.equals(other.min) || !this.max.equals(other.max));
};

/**
 * @memberof Odin.AABB2
 * @param Odin.AABB2 other
 * @return this
 */
AABB2.prototype.equals = function (other) {

    return (this.min.notEquals(other.min) || this.max.notEquals(other.max));
};

/**
 * @method fromJSON
 * @memberof Odin.AABB2
 * sets values from json object
 * @param Object json
 * @return this
 */
AABB2.prototype.fromJSON = function (json) {

    this.min.fromJSON(json.min);
    this.max.fromJSON(json.max);

    return this;
};

/**
 * @method toJSON
 * @memberof Odin.AABB2
 * returns json object
 * @return Object
 */
AABB2.prototype.toJSON = function (json) {
    json || (json = {});

    json.min = this.min.toJSON(json.min);
    json.max = this.max.toJSON(json.max);

    return json;
};

/**
 * @method toString
 * @memberof Odin.AABB2
 * converts AABB to string "AABB2( min: Vec2( -1, -1 ), max: Vec2( 1, 1 ) )"
 * @return String
 */
AABB2.prototype.toString = function () {
    var min = this.min,
        max = this.max;

    return "AABB2( min: " + min + ", max: " + max + " )";
};


module.exports = AABB2;

},{"./mathf":107,"./vec2":111}],101:[function(require,module,exports){
var Mathf = require("./mathf");
var Vec3 = require("./vec3");
"use strict";


/**
 * @class AABB3
 * 2d axis aligned bounding box
 * @param Vec3 min
 * @param Vec3 max
 */
function AABB3(min, max) {

    /**
     * @property Vec3 min
     * @memberof Odin.AABB3
     */
    this.min = min || new Vec3(Infinity, Infinity, Infinity);

    /**
     * @property Vec3 max
     * @memberof Odin.AABB3
     */
    this.max = max || new Vec3(-Infinity, -Infinity, -Infinity);
}

/**
 * @method clone
 * @memberof Odin.AABB3
 * returns new copy of this
 * @return AABB3
 */
AABB3.prototype.clone = function () {

    return new AABB3(this.min.clone(), this.max.clone());
};

/**
 * @method copy
 * @memberof Odin.AABB3
 * copies other AABB
 * @param AABB3 other
 * @return this
 */
AABB3.prototype.copy = function (other) {

    this.min.copy(other.min);
    this.max.copy(other.max);

    return this;
};

/**
 * @method set
 * @memberof Odin.AABB3
 * set min and max vectors
 * @param Vec3 min
 * @param Vec3 max
 * @return this
 */
AABB3.prototype.set = function (min, max) {

    this.min.copy(min);
    this.max.copy(max);

    return this;
};

/**
 * @method expandPoint
 * @memberof Odin.AABB3
 * @param Vec3 v
 * @return this
 */
AABB3.prototype.expandPoint = function (v) {

    this.min.min(v);
    this.max.max(v);

    return this;
};

/**
 * @method expandVec
 * @memberof Odin.AABB3
 * @param Vec3 v
 * @return this
 */
AABB3.prototype.expandVec = function (v) {

    this.min.sub(v);
    this.max.add(v);

    return this;
};

/**
 * @method expandScalar
 * @memberof Odin.AABB3
 * @param Number s
 * @return this
 */
AABB3.prototype.expandScalar = function (s) {

    this.min.ssub(s);
    this.max.sadd(s);

    return this;
};

/**
 * @method union
 * @memberof Odin.AABB3
 * joins this and another aabb
 * @param AABB3 aabb
 * @return this
 */
AABB3.prototype.union = function (other) {

    this.min.min(other.min);
    this.max.max(other.max);

    return this;
};

/**
 * @method clear
 * @memberof Odin.AABB3
 * clears aabb
 * @return this
 */
AABB3.prototype.clear = function () {

    this.min.set(Infinity, Infinity, Infinity);
    this.max.set(-Infinity, -Infinity, -Infinity);

    return this;
};

/**
 * @method contains
 * @memberof Odin.AABB3
 * checks if AABB contains point
 * @param Vec3 point
 * @return Boolean
 */
AABB3.prototype.contains = function (point) {
    var min = this.min,
        max = this.max,
        px = point.x,
        py = point.y,
        pz = point.z;

    return !(
    px < min.x || px > max.x ||
    py < min.y || py > max.y ||
    pz < min.z || pz > max.z
    );
};

/**
 * @method intersects
 * @memberof Odin.AABB3
 * checks if AABB intersects AABB
 * @param AABB3 other
 * @return Boolean
 */
AABB3.prototype.intersects = function (other) {
    var aMin = this.min,
        aMax = this.max,
        bMin = other.min,
        bMax = other.max;

    return !(
    bMax.x < aMin.x || bMin.x > aMax.x ||
    bMax.y < aMin.y || bMin.y > aMax.y ||
    bMax.z < aMin.z || bMin.z > aMax.z
    );
};

/**
 * @method fromPoints
 * @memberof Odin.AABB3
 * set min and max from array of vectors
 * @param Array points
 * @return this
 */
AABB3.prototype.fromPoints = function (points) {
    var v, i = points.length,
        minx = Infinity,
        miny = Infinity,
        minz = Infinity,
        maxx = -Infinity,
        maxy = -Infinity,
        maxz = -Infinity,
        min = this.min,
        max = this.max,
        x, y, z;

    while (i--) {
        v = points[i];
        x = v.x;
        y = v.y;
        z = v.z;

        minx = minx > x ? x : minx;
        miny = miny > y ? y : miny;
        minz = minz > z ? z : minz;

        maxx = maxx < x ? x : maxx;
        maxy = maxy < y ? y : maxy;
        maxz = maxz < z ? z : maxz;
    }

    min.x = minx;
    min.y = miny;
    min.z = minz;
    max.x = maxx;
    max.y = maxy;
    max.z = maxz;

    return this;
};

/**
 * @method fromCenterSize
 * @memberof Odin.AABB3
 * sets this from a center point and a size vector
 * @param Vec3 center
 * @param Vec3 size
 * @return this
 */
AABB3.prototype.fromCenterSize = function (center, size) {
    var min = this.min,
        max = this.max,
        x = center.x,
        y = center.y,
        z = center.z,
        hx = size.x * 0.5,
        hy = size.y * 0.5,
        hz = size.z * 0.5;

    min.x = x - hx;
    min.y = y - hy;
    min.z = z - hz;

    max.x = x + hx;
    max.y = y + hy;
    max.z = z + hz;

    return this;
};

/**
 * @memberof Odin.AABB3
 * @param Odin.AABB3 other
 * @return this
 */
AABB3.prototype.equals = function (other) {

    return !(!this.min.equals(other.min) || !this.max.equals(other.max));
};

/**
 * @memberof Odin.AABB3
 * @param Odin.AABB3 other
 * @return this
 */
AABB3.prototype.notEquals = function (other) {

    return (this.min.notEquals(other.min) || this.max.notEquals(other.max));
};

/**
 * @method fromJSON
 * @memberof Odin.AABB3
 * sets values from json object
 * @param Object json
 * @return this
 */
AABB3.prototype.fromJSON = function (json) {

    this.min.fromJSON(json.min);
    this.max.fromJSON(json.max);

    return this;
};

/**
 * @method toJSON
 * @memberof Odin.AABB3
 * returns json object
 * @return Object
 */
AABB3.prototype.toJSON = function (json) {
    json || (json = {});

    json.min = this.min.toJSON(json.min);
    json.max = this.max.toJSON(json.max);

    return json;
};

/**
 * @method toString
 * @memberof Odin.AABB3
 * converts AABB to string "AABB3( min: Vec3( -1, -1 ), max: Vec3( 1, 1 ) )"
 * @return String
 */
AABB3.prototype.toString = function () {
    var min = this.min,
        max = this.max;

    return "AABB3( min: " + min + ", max: " + max + " )";
};


module.exports = AABB3;

},{"./mathf":107,"./vec3":112}],102:[function(require,module,exports){
var Mathf = require("./mathf");
"use strict";


var sqrt = Math.sqrt,
    floor = Math.floor,
    clamp01 = Mathf.clamp01,
    defineProperty = Object.defineProperty;

/**
 * @class Color
 * rgb color, values 0.0 - 1
 * @param Number r
 * @param Number g
 * @param Number b
 */
function Color(r, g, b) {

    /**
     * @property Number r
     * @memberof Odin.Color
     */
    this.r = 0.0;

    /**
     * @property Number g
     * @memberof Odin.Color
     */
    this.g = 0.0;

    /**
     * @property Number b
     * @memberof Odin.Color
     */
    this.b = 0.0;

    this._r = 0.0;
    this._g = 0.0;
    this._b = 0.0;
    this._hex = "#000000";
    this._rgb = "rgb(0,0,0)";

    this.set(r, g, b);
}

Mathf._classes["Color"] = Color;

defineProperty(Color.prototype, "x", {
    get: function () {
        return this.r;
    },
    set: function (value) {
        this.r = value;
    }
});
defineProperty(Color.prototype, "y", {
    get: function () {
        return this.g;
    },
    set: function (value) {
        this.g = value;
    }
});
defineProperty(Color.prototype, "z", {
    get: function () {
        return this.b;
    },
    set: function (value) {
        this.b = value;
    }
});

/**
 * @method clone
 * @memberof Odin.Color
 * returns new instance of this
 * @return Color
 */
Color.prototype.clone = function () {

    return new Color(this.r, this.g, this.b);
};

/**
 * @method copy
 * @memberof Odin.Color
 * copies other
 * @param Color other
 * @return this
 */
Color.prototype.copy = function (other) {

    this.r = other.r;
    this.g = other.g;
    this.b = other.b;

    return this;
};

/**
 * @method set
 * @memberof Odin.Color
 * sets values of this
 * @param Number r
 * @param Number g
 * @param Number b
 * @return this
 */
Color.prototype.set = function (r, g, b) {
    var type = typeof(r);

    if (type === "number") {
        this.r = r;
        this.g = g;
        this.b = b;
    } else if (type === "string") {
        this.setStyle(r);
    } else if (r instanceof Color) {
        this.r = r.r;
        this.g = r.g;
        this.b = r.b;
    }

    return this;
};

/**
 * @method setRGB
 * @memberof Odin.Color
 * sets rgb values of this
 * @param Number r
 * @param Number g
 * @param Number b
 * @return this
 */
Color.prototype.setRGB = function (r, g, b) {

    this.r = r;
    this.g = g;
    this.b = b;

    return this;
};

/**
 * @method setStyle
 * @memberof Odin.Color
 * sets values of this from string
 * @param String style
 * @return this
 */
Color.prototype.setStyle = function () {
    var rgb255 = /^rgb\((\d+),(\d+),(\d+)\)$/i,
        rgb100 = /^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i,
        hex6 = /^\#([0.0-9a-f]{6})$/i,
        hex3 = /^\#([0.0-9a-f])([0.0-9a-f])([0.0-9a-f])$/i,
        hex3to6 = /#(.)(.)(.)/,
        hex3to6String = "#$1$1$2$2$3$3",
        colorName = /^(\w+)$/i,
        inv255 = 1.0 / 255.0,
        inv100 = 1.0 / 100.0;

    return function (style) {

        if (rgb255.test(style)) {
            var color = rgb255.exec(style);

            this.r = min(255, Number(color[1])) * inv255;
            this.g = min(255, Number(color[2])) * inv255;
            this.b = min(255, Number(color[3])) * inv255;

            return this;
        }

        if (rgb100.test(style)) {
            var color = rgb100.exec(style);

            this.r = min(100, Number(color[1])) * inv100;
            this.g = min(100, Number(color[2])) * inv100;
            this.b = min(100, Number(color[3])) * inv100;

            return this;
        }

        if (hex6.test(style)) {

            this.r = parseInt(style.substr(1, 2), 16) * inv255;
            this.g = parseInt(style.substr(3, 2), 16) * inv255;
            this.b = parseInt(style.substr(5, 2), 16) * inv255;

            return this;
        }

        if (hex3.test(style)) {
            style = style.replace(hex3to6, hex3to6String);

            this.r = parseInt(style.substr(1, 2), 16) * inv255;
            this.g = parseInt(style.substr(3, 2), 16) * inv255;
            this.b = parseInt(style.substr(5, 2), 16) * inv255;

            return this;
        }

        if (colorName.test(style)) {
            style = colorNames[style];

            this.r = parseInt(style.substr(1, 2), 16) * inv255;
            this.g = parseInt(style.substr(3, 2), 16) * inv255;
            this.b = parseInt(style.substr(5, 2), 16) * inv255;

            return this;
        }

        return this;
    };
}();

/**
 * @method toHEX
 * @memberof Odin.Color
 * returns this color in HEX format
 * @return Color
 */
Color.prototype.toHEX = function () {

    if (this.r !== this._r || this.g !== this._g || this.b !== this._b) {
        var hexR = singleToHEX(this.r),
            hexG = singleToHEX(this.g),
            hexB = singleToHEX(this.b);

        this._r = this.r;
        this._g = this.g;
        this._b = this.b;
        this._hex = "#" + hexR + hexG + hexB;
        this._rgb = "rgb(" + floor(clamp01(this.r) * 256) + "," + floor(clamp01(this.g) * 256) + "," + floor(clamp01(this.b) * 256) + ")";
    }

    return this._hex;
};

/**
 * @method toRGB
 * @memberof Odin.Color
 * returns this color in RGB format
 * @return Color
 */
Color.prototype.toRGB = function () {

    if (this.r !== this._r || this.g !== this._g || this.b !== this._b) {
        var r = floor(clamp01(this.r) * 256),
            g = floor(clamp01(this.g) * 256),
            b = floor(clamp01(this.b) * 256);

        this._r = this.r;
        this._g = this.g;
        this._b = this.b;
        this._rgb = "rgb(" + r + "," + g + "," + b + ")";
        this._hex = "#" + singleToHEX(this.r) + singleToHEX(this.g) + singleToHEX(this.b);
    }

    return this._rgb;
};

/**
 * @method add
 * @memberof Odin.Color
 * adds other's values to this
 * @param Color other
 * @return this
 */
Color.prototype.add = function (other) {

    this.r += other.r;
    this.g += other.g;
    this.b += other.b;

    return this;
};

/**
 * @method cadd
 * @memberof Odin.Color
 * adds a and b together saves it in this
 * @param Color a
 * @param Color b
 * @return this
 */
Color.prototype.cadd = function (a, b) {

    this.r = a.r + b.r;
    this.g = a.g + b.g;
    this.b = a.b + b.b;

    return this;
};

/**
 * @method sadd
 * @memberof Odin.Color
 * adds scalar value to this
 * @param Number s
 * @return this
 */
Color.prototype.sadd = function (s) {

    this.r += s;
    this.g += s;
    this.b += s;

    return this;
};

/**
 * @method sub
 * @memberof Odin.Color
 * subtracts other's values from this
 * @param Color other
 * @return this
 */
Color.prototype.sub = function (other) {

    this.r -= other.r;
    this.g -= other.g;
    this.b -= other.b;

    return this;
};

/**
 * @method csub
 * @memberof Odin.Color
 * subtracts b from a saves it in this
 * @param Color a
 * @param Color b
 * @return this
 */
Color.prototype.csub = function (a, b) {

    this.r = a.r - b.r;
    this.g = a.g - b.g;
    this.b = a.b - b.b;

    return this;
};

/**
 * @method ssub
 * @memberof Odin.Color
 * subtracts this by a scalar value
 * @param Number s
 * @return this
 */
Color.prototype.ssub = function (s) {

    this.r -= s;
    this.g -= s;
    this.b -= s;

    return this;
};

/**
 * @method mul
 * @memberof Odin.Color
 * muliples this's values by other's
 * @param Color other
 * @return this
 */
Color.prototype.mul = function (other) {

    this.r *= other.r;
    this.g *= other.g;
    this.b *= other.b;

    return this;
};

/**
 * @method cmul
 * @memberof Odin.Color
 * muliples a and b saves it in this
 * @param Color a
 * @param Color b
 * @return this
 */
Color.prototype.cmul = function (a, b) {

    this.r = a.r * b.r;
    this.g = a.g * b.g;
    this.b = a.b * b.b;

    return this;
};

/**
 * @method smul
 * @memberof Odin.Color
 * muliples this by a scalar value
 * @param Number s
 * @return this
 */
Color.prototype.smul = function (s) {

    this.r *= s;
    this.g *= s;
    this.b *= s;

    return this;
};

/**
 * @method div
 * @memberof Odin.Color
 * divides this's values by other's
 * @param Color other
 * @return this
 */
Color.prototype.div = function (other) {
    var x = other.r,
        y = other.g,
        z = other.b;

    this.r *= x !== 0.0 ? 1.0 / x : 0.0;
    this.g *= y !== 0.0 ? 1.0 / y : 0.0;
    this.b *= z !== 0.0 ? 1.0 / z : 0.0;

    return this;
};

/**
 * @method cdiv
 * @memberof Odin.Color
 * divides b from a saves it in this
 * @param Color a
 * @param Color b
 * @return this
 */
Color.prototype.cdiv = function (a, b) {
    var x = b.r,
        y = b.g,
        z = b.b;

    this.r = x !== 0.0 ? a.r / x : 0.0;
    this.g = y !== 0.0 ? a.g / y : 0.0;
    this.b = z !== 0.0 ? a.b / z : 0.0;

    return this;
};

/**
 * @method sdiv
 * @memberof Odin.Color
 * divides this by scalar value
 * @param Number s
 * @return this
 */
Color.prototype.sdiv = function (s) {
    s = s === 0.0 ? 0.0 : 1.0 / s;

    this.r *= s;
    this.g *= s;
    this.b *= s;

    return this;
};

/**
 * @method length
 * @memberof Odin.Color
 * returns length of this
 * @return this
 */
Color.prototype.length = function () {
    var r = this.r,
        g = this.g,
        b = this.b,
        l = r * r + g * g + b * b;

    return l > 0.0 ? 1.0 / sqrt(l) : 0.0;
};

/**
 * @method lengthSq
 * @memberof Odin.Color
 * returns length squared of this
 * @return this
 */
Color.prototype.lengthSq = function () {
    var r = this.r,
        g = this.g,
        b = this.b;

    return r * r + g * g + b * b;
};

/**
 * @method normalize
 * @memberof Odin.Color
 * returns this with a length of 1
 * @return this
 */
Color.prototype.normalize = function () {
    var r = this.r,
        g = this.g,
        b = this.b,
        l = r * r + g * g + b * b;

    l = l > 0.0 ? 1.0 / sqrt(l) : 0.0;

    this.r *= l;
    this.g *= l;
    this.b *= l;

    return this;
};

/**
 * @method cnormalize
 * @memberof Odin.Color
 * ensures that each value is no larger than 1
 * @return this
 */
Color.prototype.cnormalize = function () {
    var r = this.r,
        g = this.g,
        b = this.b;

    this.r = r > 1.0 ? 1.0 : r;
    this.g = g > 1.0 ? 1.0 : g;
    this.b = b > 1.0 ? 1.0 : b;

    return this;
};

/**
 * @method lerp
 * @memberof Odin.Color
 * linear interpolation between this and other by x
 * @param Color other
 * @param Number x
 * @return Color
 */
Color.prototype.lerp = function (other, x) {

    this.r += (other.r - this.r) * x;
    this.g += (other.g - this.g) * x;
    this.b += (other.b - this.b) * x;

    return this;
};

/**
 * @method clerp
 * @memberof Odin.Color
 * linear interpolation between a and b by x
 * @param Color a
 * @param Color b
 * @param Number x
 * @return Color
 */
Color.prototype.clerp = function (a, b, x) {
    var ax = a.r,
        ay = a.g,
        az = a.b;

    this.r = ax + (b.r - ax) * x;
    this.g = ay + (b.g - ay) * x;
    this.b = az + (b.b - az) * x;

    return this;
};

/**
 * @method min
 * @memberof Odin.Color
 * returns min values from this and other vector
 * @param Color other
 * @return Color
 */
Color.prototype.min = function (other) {
    var ar = this.r,
        ag = this.g,
        ab = this.b,
        br = other.r,
        bg = other.g,
        bb = other.b;

    this.r = br < ar ? br : ar;
    this.g = bg < ag ? bg : ag;
    this.b = bb < ab ? bb : ab;

    return this;
};

/**
 * @method max
 * @memberof Odin.Color
 * returns max values from this and other vector
 * @param Color other
 * @return Color
 */
Color.prototype.max = function (other) {
    var ar = this.r,
        ag = this.g,
        ab = this.b,
        br = other.r,
        bg = other.g,
        bb = other.b;

    this.r = br > ar ? br : ar;
    this.g = bg > ag ? bg : ag;
    this.b = bb > ab ? bb : ab;

    return this;
};

/**
 * @method fromVec2
 * @memberof Odin.Color
 * sets values from Vec2
 * @param Vec2 v
 * @return this
 */
Color.prototype.fromVec2 = function (v) {

    this.r = v.x;
    this.g = v.y;
    this.b = 0.0;

    return this;
};

/**
 * @method fromVec3
 * @memberof Odin.Color
 * sets values from Vec3
 * @param Vec3 v
 * @return this
 */
Color.prototype.fromVec3 = function (v) {

    this.r = v.x;
    this.g = v.y;
    this.b = v.z;

    return this;
};

/**
 * @method fromVec4
 * @memberof Odin.Color
 * sets values from Vec4
 * @param Vec4 v
 * @return this
 */
Color.prototype.fromVec4 = Color.prototype.fromVec3;

/**
 * @memberof Odin.Color
 * @param Odin.Color other
 * @return this
 */
Color.prototype.equals = function (other) {

    return !(
    this.r !== other.r ||
    this.g !== other.g ||
    this.b !== other.b
    );
};

/**
 * @memberof Odin.Color
 * @param Odin.Color other
 * @return this
 */
Color.prototype.notEquals = function (other) {

    return (
    this.r !== other.r ||
    this.g !== other.g ||
    this.b !== other.b
    );
};

/**
 * @method fromJSON
 * @memberof Odin.Color
 * sets values from JSON object
 * @param Object json
 * @return this
 */
Color.prototype.fromJSON = function (json) {

    this.r = json.r;
    this.g = json.g;
    this.b = json.b;

    return this;
};

/**
 * @method toJSON
 * @memberof Odin.Color
 * returns json object of this
 * @return Object
 */
Color.prototype.toJSON = function (json) {
    json || (json = {});

    json._className = "Color";
    json.r = this.r;
    json.g = this.g;
    json.b = this.b;

    return json;
};

/**
 * @method fromArray
 * @memberof Odin.Color
 * sets values from Array object
 * @param Array array
 * @return this
 */
Color.prototype.fromArray = function (array) {

    this.r = array[0];
    this.g = array[1];
    this.b = array[2];

    return this;
};

/**
 * @method toArray
 * @memberof Odin.Color
 * returns array object of this
 * @return Array
 */
Color.prototype.toArray = function (array) {
    array || (array = []);

    array[0] = this.r;
    array[1] = this.g;
    array[2] = this.b;

    return array;
};

/**
 * @method toString
 * @memberof Odin.Color
 * returns string of this
 * @return String
 */
Color.prototype.toString = function () {

    return "Color( " + this.r + ", " + this.g + ", " + this.b + " )";
};


function singleToHEX(value) {
    var str = (~~(clamp01(value) * 255)).toString(16);
    return str.length === 1 ? "0" + str : str;
}


var colorNames = Color.colorNames = {
    aliceblue: "#f0f8ff",
    antiquewhite: "#faebd7",
    aqua: "#00ffff",
    aquamarine: "#7fffd4",
    azure: "#f0ffff",
    beige: "#f5f5dc",
    bisque: "#ffe4c4",
    black: "#000000",
    blanchedalmond: "#ffebcd",
    blue: "#0000ff",
    blueviolet: "#8a2be2",
    brown: "#a52a2a",
    burlywood: "#deb887",
    cadetblue: "#5f9ea0",
    chartreuse: "#7fff00",
    chocolate: "#d2691e",
    coral: "#ff7f50",
    cornflowerblue: "#6495ed",
    cornsilk: "#fff8dc",
    crimson: "#dc143c",
    cyan: "#00ffff",
    darkblue: "#00008b",
    darkcyan: "#008b8b",
    darkgoldenrod: "#b8860b",
    darkgray: "#a9a9a9",
    darkgreen: "#006400",
    darkkhaki: "#bdb76b",
    darkmagenta: "#8b008b",
    darkolivegreen: "#556b2f",
    darkorange: "#ff8c00",
    darkorchid: "#9932cc",
    darkred: "#8b0000",
    darksalmon: "#e9967a",
    darkseagreen: "#8fbc8f",
    darkslateblue: "#483d8b",
    darkslategray: "#2f4f4f",
    darkturquoise: "#00ced1",
    darkviolet: "#9400d3",
    deeppink: "#ff1493",
    deepskyblue: "#00bfff",
    dimgray: "#696969",
    dodgerblue: "#1e90ff",
    firebrick: "#b22222",
    floralwhite: "#fffaf0",
    forestgreen: "#228b22",
    fuchsia: "#ff00ff",
    gainsboro: "#dcdcdc",
    ghostwhite: "#f8f8ff",
    gold: "#ffd700",
    goldenrod: "#daa520",
    gray: "#808080",
    green: "#008000",
    greenyellow: "#adff2f",
    grey: "#808080",
    honeydew: "#f0fff0",
    hotpink: "#ff69b4",
    indianred: "#cd5c5c",
    indigo: "#4b0082",
    ivory: "#fffff0",
    khaki: "#f0e68c",
    lavender: "#e6e6fa",
    lavenderblush: "#fff0f5",
    lawngreen: "#7cfc00",
    lemonchiffon: "#fffacd",
    lightblue: "#add8e6",
    lightcoral: "#f08080",
    lightcyan: "#e0ffff",
    lightgoldenrodyellow: "#fafad2",
    lightgrey: "#d3d3d3",
    lightgreen: "#90ee90",
    lightpink: "#ffb6c1",
    lightsalmon: "#ffa07a",
    lightseagreen: "#20b2aa",
    lightskyblue: "#87cefa",
    lightslategray: "#778899",
    lightsteelblue: "#b0c4de",
    lightyellow: "#ffffe0",
    lime: "#00ff00",
    limegreen: "#32cd32",
    linen: "#faf0e6",
    magenta: "#ff00ff",
    maroon: "#800000",
    mediumaquamarine: "#66cdaa",
    mediumblue: "#0000cd",
    mediumorchid: "#ba55d3",
    mediumpurple: "#9370d8",
    mediumseagreen: "#3cb371",
    mediumslateblue: "#7b68ee",
    mediumspringgreen: "#00fa9a",
    mediumturquoise: "#48d1cc",
    mediumvioletred: "#c71585",
    midnightblue: "#191970",
    mintcream: "#f5fffa",
    mistyrose: "#ffe4e1",
    moccasin: "#ffe4b5",
    navajowhite: "#ffdead",
    navy: "#000080",
    oldlace: "#fdf5e6",
    olive: "#808000",
    olivedrab: "#6b8e23",
    orange: "#ffa500",
    orangered: "#ff4500",
    orchid: "#da70d6",
    palegoldenrod: "#eee8aa",
    palegreen: "#98fb98",
    paleturquoise: "#afeeee",
    palevioletred: "#d87093",
    papayawhip: "#ffefd5",
    peachpuff: "#ffdab9",
    peru: "#cd853f",
    pink: "#ffc0cb",
    plum: "#dda0dd",
    powderblue: "#b0e0e6",
    purple: "#800080",
    red: "#ff0000",
    rosybrown: "#bc8f8f",
    royalblue: "#4169e1",
    saddlebrown: "#8b4513",
    salmon: "#fa8072",
    sandybrown: "#f4a460",
    seagreen: "#2e8b57",
    seashell: "#fff5ee",
    sienna: "#a0522d",
    silver: "#c0c0c0",
    skyblue: "#87ceeb",
    slateblue: "#6a5acd",
    slategray: "#708090",
    snow: "#fffafa",
    springgreen: "#00ff7f",
    steelblue: "#4682b4",
    tan: "#d2b48c",
    teal: "#008080",
    thistle: "#d8bfd8",
    tomato: "#ff6347",
    turquoise: "#40e0d0",
    violet: "#ee82ee",
    wheat: "#f5deb3",
    white: "#ffffff",
    whitesmoke: "#f5f5f5",
    yellow: "#ffff00",
    yellowgreen: "#9acd32"
};


module.exports = Color;

},{"./mathf":107}],103:[function(require,module,exports){
var Mathf = require("./mathf");
"use strict";


var cos = Math.cos,
    sin = Math.sin,
    atan2 = Math.atan2;

/**
 * @class Mat2
 * 2x2 matrix
 * @param Number m11
 * @param Number m12
 * @param Number m21
 * @param Number m22
 */
function Mat2(m11, m12, m21, m22) {
    var te = new Float32Array(4);

    /**
     * @property Float32Array elements
     * @memberof Odin.Mat2
     */
    this.elements = te;

    te[0] = m11 != undefined ? m11 : 1.0;
    te[2] = m12 || 0.0;
    te[1] = m21 || 0.0;
    te[3] = m22 != undefined ? m22 : 1.0;
}

Mathf._classes["Mat2"] = Mat2;

/**
 * @method clone
 * @memberof Odin.Mat2
 * returns new instance of this
 * @return Mat2
 */
Mat2.prototype.clone = function () {
    var te = this.elements;

    return new Mat2(
        te[0], te[1],
        te[2], te[3]
    );
};

/**
 * @method copy
 * @memberof Odin.Mat2
 * copies other
 * @param Mat2 other
 * @return this
 */
Mat2.prototype.copy = function (other) {
    var te = this.elements,
        me = other.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[2];
    te[3] = me[3];

    return this;
};

/**
 * @method set
 * @memberof Odin.Mat2
 * sets values of this
 * @param Number m11
 * @param Number m12
 * @param Number m21
 * @param Number m22
 * @return this
 */
Mat2.prototype.set = function (m11, m12, m21, m22) {
    var te = this.elements;

    te[0] = m11;
    te[2] = m12;
    te[1] = m21;
    te[3] = m22;

    return this;
};

/**
 * @method mul
 * @memberof Odin.Mat2
 * muliples this's values by other's
 * @param Mat2 other
 * @return this
 */
Mat2.prototype.mul = function (other) {
    var ae = this.elements,
        be = other.elements,

        a11 = ae[0],
        a12 = ae[2],
        a21 = ae[1],
        a22 = ae[3],

        b11 = be[0],
        b12 = be[2],
        b21 = be[1],
        b22 = be[3];

    ae[0] = a11 * b11 + a21 * b12;
    ae[1] = a12 * b11 + a22 * b12;

    ae[2] = a11 * b21 + a21 * b22;
    ae[3] = a12 * b21 + a22 * b22;

    return this;
};

/**
 * @method mmul
 * @memberof Odin.Mat2
 * muliples a and b saves it in this
 * @param Mat2 a
 * @param Mat2 b
 * @return this
 */
Mat2.prototype.mmul = function (a, b) {
    var te = this.elements,
        ae = a.elements,
        be = b.elements,

        a11 = ae[0],
        a12 = ae[2],
        a21 = ae[1],
        a22 = ae[3],

        b11 = be[0],
        b12 = be[2],
        b21 = be[1],
        b22 = be[3];

    te[0] = a11 * b11 + a21 * b12;
    te[1] = a12 * b11 + a22 * b12;

    te[2] = a11 * b21 + a21 * b22;
    te[3] = a12 * b21 + a22 * b22;

    return this;
};

/**
 * @method smul
 * @memberof Odin.Mat2
 * muliples this by a scalar value
 * @param Number s
 * @return this
 */
Mat2.prototype.smul = function (s) {
    var te = this.elements;

    te[0] *= s;
    te[1] *= s;
    te[2] *= s;
    te[3] *= s;

    return this;
};

/**
 * @method sdiv
 * @memberof Odin.Mat2
 * divides this by scalar value
 * @param Number s
 * @return this
 */
Mat2.prototype.sdiv = function (s) {
    var te = this.elements;

    s = s !== 0.0 ? 1.0 / s : 1.0;

    te[0] *= s;
    te[1] *= s;
    te[2] *= s;
    te[3] *= s;

    return this;
};

/**
 * @method identity
 * @memberof Odin.Mat2
 * identity matrix
 * @return this
 */
Mat2.prototype.identity = function () {
    var te = this.elements;

    te[0] = 1;
    te[1] = 0.0;
    te[2] = 0.0;
    te[3] = 1;

    return this;
};

/**
 * @method zero
 * @memberof Odin.Mat2
 * zero matrix
 * @return this
 */
Mat2.prototype.zero = function () {
    var te = this.elements;

    te[0] = 0.0;
    te[1] = 0.0;
    te[2] = 0.0;
    te[3] = 0.0;

    return this;
};

/**
 * @method determinant
 * @memberof Odin.Mat2
 * returns the determinant of this
 * @return this
 */
Mat2.prototype.determinant = function () {
    var te = this.elements;

    return te[0] * te[3] - te[2] * te[1];
};

/**
 * @method inverse
 * @memberof Odin.Mat2
 * returns the inverse of this
 * @return this
 */
Mat2.prototype.inverse = function () {
    var te = this.elements,

        m11 = te[0],
        m12 = te[2],
        m21 = te[1],
        m22 = te[3],

        det = m11 * m22 - m12 * m21;

    if (det === 0.0) {
        return this.identity();
    }
    det = 1.0 / det;

    te[0] = m22 * det;
    te[1] = -m12 * det;
    te[2] = -m21 * det;
    te[3] = m11 * det;

    return this;
};

/**
 * @method inverseMat
 * @memberof Odin.Mat2
 * returns the inverse of other
 * @param Mat2 other
 * @return this
 */
Mat2.prototype.inverseMat = function (other) {
    var te = this.elements,
        me = other.elements,

        m11 = me[0],
        m12 = me[2],
        m21 = me[1],
        m22 = me[3],

        det = m11 * m22 - m12 * m21;

    if (det === 0.0) {
        return this.identity();
    }
    det = 1.0 / det;

    te[0] = m22 * det;
    te[1] = -m12 * det;
    te[2] = -m21 * det;
    te[3] = m11 * det;

    return this;
};

/**
 * @method transpose
 * @memberof Odin.Mat2
 * transposes this matrix
 * @return this
 */
Mat2.prototype.transpose = function () {
    var te = this.elements,
        tmp;

    tmp = te[1];
    te[1] = te[2];
    te[2] = tmp;

    return this;
};

/**
 * @method setTrace
 * @memberof Odin.Mat2
 * sets the diagonal of matrix
 * @param Number x
 * @param Number y
 * @return this
 */
Mat2.prototype.setTrace = function (x, y) {
    var te = this.elements;

    te[0] = x;
    te[3] = y;

    return this;
};

/**
 * @method setRotation
 * @memberof Odin.Mat2
 * sets the rotation in radians this
 * @param Number angle
 * @return this
 */
Mat2.prototype.setRotation = function (angle) {
    var te = this.elements,
        c = cos(angle),
        s = sin(angle);

    te[0] = c;
    te[1] = s;
    te[2] = -s;
    te[3] = c;

    return this;
};

/**
 * @method getRotation
 * @memberof Odin.Mat2
 * returns the rotation in radians of this
 * @return Number
 */
Mat2.prototype.getRotation = function () {
    var te = this.elements;

    return atan2(te[1], te[0]);
};

/**
 * @method rotate
 * @memberof Odin.Mat2
 * rotates this by angle in radians
 * @param Number angle
 * @return this
 */
Mat2.prototype.rotate = function (angle) {
    var te = this.elements,

        m11 = te[0],
        m12 = te[2],
        m21 = te[1],
        m22 = te[3],

        s = sin(angle),
        c = sin(angle);

    te[0] = m11 * c + m12 * s;
    te[1] = m11 * -s + m12 * c;
    te[2] = m21 * c + m22 * s;
    te[3] = m21 * -s + m22 * c;

    return this;
};

/**
 * @method fromMat3
 * @memberof Odin.Mat2
 * sets this from Mat3
 * @param Mat3 m
 * @return this
 */
Mat2.prototype.fromMat3 = function (m) {
    var te = this.elements,
        me = m.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[3];
    te[3] = me[4];

    return this;
};

/**
 * @method fromMat4
 * @memberof Odin.Mat2
 * sets this from Mat4
 * @param Mat4 m
 * @return this
 */
Mat2.prototype.fromMat4 = function (m) {
    var te = this.elements,
        me = m.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[4];
    te[3] = me[5];

    return this;
};

/**
 * @memberof Odin.Mat2
 * @param Odin.Mat2 other
 * @return this
 */
Mat2.prototype.equals = function (other) {
    var ae = this.elements,
        be = other.elements;

    return !(
    ae[0] !== be[0] ||
    ae[1] !== be[1] ||
    ae[2] !== be[2] ||
    ae[3] !== be[3]
    );
};

/**
 * @memberof Odin.Mat2
 * @param Odin.Mat2 other
 * @return this
 */
Mat2.prototype.notEquals = function (other) {
    var ae = this.elements,
        be = other.elements;

    return (
    ae[0] !== be[0] ||
    ae[1] !== be[1] ||
    ae[2] !== be[2] ||
    ae[3] !== be[3]
    );
};

/**
 * @method fromJSON
 * @memberof Odin.Mat2
 * sets values from JSON object
 * @param Object json
 * @return this
 */
Mat2.prototype.fromJSON = function (json) {
    var te = this.elements,
        me = json.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[2];
    te[3] = me[3];

    return this;
};

/**
 * @method toJSON
 * @memberof Odin.Mat2
 * returns json object of this
 * @return Object
 */
Mat2.prototype.toJSON = function (json) {
    json || (json = {});
    var te = this.elements,
        je = json.elements || (json.elements = []);

    json._className = "Mat2";
    je[0] = te[0];
    je[1] = te[1];
    je[2] = te[2];
    je[3] = te[3];

    return json;
};

/**
 * @method fromArray
 * @memberof Odin.Mat2
 * sets values from Array object
 * @param Object json
 * @return this
 */
Mat2.prototype.fromArray = function (array) {
    var te = this.elements;

    te[0] = array[0];
    te[1] = array[1];
    te[2] = array[2];
    te[3] = array[3];

    return this;
};

/**
 * @method toArray
 * @memberof Odin.Mat2
 * returns array object of this
 * @return Object
 */
Mat2.prototype.toArray = function (array) {
    array || (array = []);
    var te = this.elements;

    array[0] = te[0];
    array[1] = te[1];
    array[2] = te[2];
    array[3] = te[3];

    return array;
};

/**
 * @method toString
 * @memberof Odin.Mat2
 * returns string of this
 * @return String
 */
Mat2.prototype.toString = function () {
    var te = this.elements;

    return (
    "Mat2[ " + te[0] + ", " + te[2] + "]\n" +
    "     [ " + te[1] + ", " + te[3] + "]"
    );
};


module.exports = Mat2;

},{"./mathf":107}],104:[function(require,module,exports){
var Mathf = require("./mathf");
"use strict";


var cos = Math.cos,
    sin = Math.sin;

/**
 * @class Mat3
 * 3x3 matrix
 * @param Number m11
 * @param Number m12
 * @param Number m13
 * @param Number m21
 * @param Number m22
 * @param Number m23
 * @param Number m31
 * @param Number m32
 * @param Number m33
 */
function Mat3(m11, m12, m13, m21, m22, m23, m31, m32, m33) {
    var te = new Float32Array(9);

    /**
     * @property Float32Array elements
     * @memberof Odin.Mat3
     */
    this.elements = te;

    te[0] = m11 != undefined ? m11 : 1.0;
    te[3] = m12 || 0.0;
    te[6] = m13 || 0.0;
    te[1] = m21 || 0.0;
    te[4] = m22 != undefined ? m22 : 1.0;
    te[7] = m23 || 0.0;
    te[2] = m31 || 0.0;
    te[5] = m32 || 0.0;
    te[8] = m33 != undefined ? m33 : 1.0;
}

Mathf._classes["Mat3"] = Mat3;

/**
 * @method clone
 * @memberof Odin.Mat3
 * returns new instance of this
 * @return Mat3
 */
Mat3.prototype.clone = function () {
    var te = this.elements;

    return new Mat3(
        te[0], te[3], te[6],
        te[1], te[4], te[7],
        te[2], te[5], te[8]
    );
};

/**
 * @method copy
 * @memberof Odin.Mat3
 * copies other
 * @param Mat3 other
 * @return this
 */
Mat3.prototype.copy = function (other) {
    var te = this.elements,
        me = other.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[2];
    te[3] = me[3];
    te[4] = me[4];
    te[5] = me[5];
    te[6] = me[6];
    te[7] = me[7];
    te[8] = me[8];

    return this;
};

/**
 * @method set
 * @memberof Odin.Mat3
 * sets values of this
 * @param Number m11
 * @param Number m12
 * @param Number m13
 * @param Number m21
 * @param Number m22
 * @param Number m23
 * @param Number m31
 * @param Number m32
 * @param Number m33
 * @return this
 */
Mat3.prototype.set = function (m11, m12, m13, m21, m22, m23, m31, m32, m33) {
    var te = this.elements;

    te[0] = m11;
    te[3] = m12;
    te[6] = m13;
    te[1] = m21;
    te[4] = m22;
    te[7] = m23;
    te[2] = m31;
    te[5] = m32;
    te[8] = m33;

    return this;
};

/**
 * @method mul
 * @memberof Odin.Mat3
 * muliples this's values by other's
 * @param Mat3 other
 * @return this
 */
Mat3.prototype.mul = function (other) {
    var ae = this.elements,
        be = other.elements,

        a11 = ae[0],
        a12 = ae[3],
        a13 = ae[6],
        a21 = ae[1],
        a22 = ae[4],
        a23 = ae[7],
        a31 = ae[2],
        a32 = ae[5],
        a33 = ae[8],

        b11 = be[0],
        b12 = be[3],
        b13 = be[6],
        b21 = be[1],
        b22 = be[4],
        b23 = be[7],
        b31 = be[2],
        b32 = be[5],
        b33 = be[8];

    ae[0] = a11 * b11 + a21 * b12 + a31 * b13;
    ae[3] = a12 * b11 + a22 * b12 + a32 * b13;
    ae[6] = a13 * b11 + a23 * b12 + a33 * b13;

    ae[1] = a11 * b21 + a21 * b22 + a31 * b23;
    ae[4] = a12 * b21 + a22 * b22 + a32 * b23;
    ae[7] = a13 * b21 + a23 * b22 + a33 * b23;

    ae[2] = a11 * b31 + a21 * b32 + a31 * b33;
    ae[5] = a12 * b31 + a22 * b32 + a32 * b33;
    ae[8] = a13 * b31 + a23 * b32 + a33 * b33;

    return this;
};

/**
 * @method mmul
 * @memberof Odin.Mat3
 * muliples a and b saves it in this
 * @param Mat3 a
 * @param Mat3 b
 * @return this
 */
Mat3.prototype.mmul = function (a, b) {
    var te = this.elements,
        ae = a.elements,
        be = b.elements,

        a11 = ae[0],
        a12 = ae[3],
        a13 = ae[6],
        a21 = ae[1],
        a22 = ae[4],
        a23 = ae[7],
        a31 = ae[2],
        a32 = ae[5],
        a33 = ae[8],

        b11 = be[0],
        b12 = be[3],
        b13 = be[6],
        b21 = be[1],
        b22 = be[4],
        b23 = be[7],
        b31 = be[2],
        b32 = be[5],
        b33 = be[8];

    te[0] = a11 * b11 + a21 * b12 + a31 * b13;
    te[3] = a12 * b11 + a22 * b12 + a32 * b13;
    te[6] = a13 * b11 + a23 * b12 + a33 * b13;

    te[1] = a11 * b21 + a21 * b22 + a31 * b23;
    te[4] = a12 * b21 + a22 * b22 + a32 * b23;
    te[7] = a13 * b21 + a23 * b22 + a33 * b23;

    te[2] = a11 * b31 + a21 * b32 + a31 * b33;
    te[5] = a12 * b31 + a22 * b32 + a32 * b33;
    te[8] = a13 * b31 + a23 * b32 + a33 * b33;

    return this;
};

/**
 * @method smul
 * @memberof Odin.Mat3
 * muliples this by a scalar value
 * @param Number s
 * @return this
 */
Mat3.prototype.smul = function (s) {
    var te = this.elements;

    te[0] *= s;
    te[1] *= s;
    te[2] *= s;
    te[3] *= s;
    te[4] *= s;
    te[5] *= s;
    te[6] *= s;
    te[7] *= s;
    te[8] *= s;

    return this;
};

/**
 * @method sdiv
 * @memberof Odin.Mat3
 * divides this by scalar value
 * @param Number s
 * @return this
 */
Mat3.prototype.sdiv = function (s) {
    var te = this.elements;

    s = s === 0.0 ? 0.0 : 1.0 / s;

    te[0] *= s;
    te[1] *= s;
    te[2] *= s;
    te[3] *= s;
    te[4] *= s;
    te[5] *= s;
    te[6] *= s;
    te[7] *= s;
    te[8] *= s;

    return this;
};

/**
 * @method identity
 * @memberof Odin.Mat3
 * identity matrix
 * @return this
 */
Mat3.prototype.identity = function () {
    var te = this.elements;

    te[0] = 1;
    te[1] = 0.0;
    te[2] = 0.0;
    te[3] = 0.0;
    te[4] = 1;
    te[5] = 0.0;
    te[6] = 0.0;
    te[7] = 0.0;
    te[8] = 1;

    return this;
};

/**
 * @method zero
 * @memberof Odin.Mat3
 * zero matrix
 * @return this
 */
Mat3.prototype.zero = function () {
    var te = this.elements;

    te[0] = 0.0;
    te[1] = 0.0;
    te[2] = 0.0;
    te[3] = 0.0;
    te[4] = 0.0;
    te[5] = 0.0;
    te[6] = 0.0;
    te[7] = 0.0;
    te[8] = 0.0;

    return this;
};

/**
 * @method determinant
 * @memberof Odin.Mat3
 * returns the determinant of this
 * @return this
 */
Mat3.prototype.determinant = function () {
    var te = this.elements,

        a = te[0],
        b = te[1],
        c = te[2],
        d = te[3],
        e = te[4],
        f = te[5],
        g = te[6],
        h = te[7],
        i = te[8];

    return a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;
};

/**
 * @method inverse
 * @memberof Odin.Mat3
 * returns the inverse of this
 * @return this
 */
Mat3.prototype.inverse = function () {
    var te = this.elements,
        m11 = te[0],
        m12 = te[3],
        m13 = te[6],
        m21 = te[1],
        m22 = te[4],
        m23 = te[7],
        m31 = te[2],
        m32 = te[5],
        m33 = te[8],

        m0 = m22 * m33 - m23 * m32,
        m3 = m13 * m32 - m12 * m33,
        m6 = m12 * m23 - m13 * m22,

        det = m11 * m0 + m21 * m3 + m31 * m6;

    if (det === 0.0) {
        return this.identity();
    }
    det = 1.0 / det;

    te[0] = m0 * det;
    te[1] = (m23 * m31 - m21 * m33) * det;
    te[2] = (m21 * m32 - m22 * m31) * det;

    te[3] = m3 * det;
    te[4] = (m11 * m33 - m13 * m31) * det;
    te[5] = (m12 * m31 - m11 * m32) * det;

    te[6] = m6 * det;
    te[7] = (m13 * m21 - m11 * m23) * det;
    te[8] = (m11 * m22 - m12 * m21) * det;

    return this;
};

/**
 * @method inverseMat
 * @memberof Odin.Mat3
 * returns the inverse of other
 * @param Mat3 other
 * @return this
 */
Mat3.prototype.inverseMat = function (other) {
    var te = this.elements,
        me = other.elements,
        m11 = me[0],
        m12 = me[3],
        m13 = me[6],
        m21 = me[1],
        m22 = me[4],
        m23 = me[7],
        m31 = me[2],
        m32 = me[5],
        m33 = me[8],

        m0 = m22 * m33 - m23 * m32,
        m3 = m13 * m32 - m12 * m33,
        m6 = m12 * m23 - m13 * m22,

        det = m11 * m0 + m21 * m3 + m31 * m6;

    if (det === 0.0) {
        return this.identity();
    }
    det = 1.0 / det;

    te[0] = m0 * det;
    te[1] = (m23 * m31 - m21 * m33) * det;
    te[2] = (m21 * m32 - m22 * m31) * det;

    te[3] = m3 * det;
    te[4] = (m11 * m33 - m13 * m31) * det;
    te[5] = (m12 * m31 - m11 * m32) * det;

    te[6] = m6 * det;
    te[7] = (m13 * m21 - m11 * m23) * det;
    te[8] = (m11 * m22 - m12 * m21) * det;

    return this;
};

/**
 * @method inverseMat4
 * @memberof Odin.Mat3
 * returns the inverse of a Mat4
 * @param Mat4 other
 * @return this
 */
Mat3.prototype.inverseMat4 = function (other) {
    var te = this.elements,
        me = other.elements,
        m11 = me[0],
        m12 = me[4],
        m13 = me[8],
        m21 = me[1],
        m22 = me[5],
        m23 = me[9],
        m31 = me[2],
        m32 = me[6],
        m33 = me[10],

        m0 = m22 * m33 - m23 * m32,
        m3 = m13 * m32 - m12 * m33,
        m6 = m12 * m23 - m13 * m22,

        det = m11 * m0 + m21 * m3 + m31 * m6;

    if (det === 0.0) {
        return this.identity();
    }
    det = 1.0 / det;

    te[0] = m0 * det;
    te[1] = (m23 * m31 - m21 * m33) * det;
    te[2] = (m21 * m32 - m22 * m31) * det;

    te[3] = m3 * det;
    te[4] = (m11 * m33 - m13 * m31) * det;
    te[5] = (m12 * m31 - m11 * m32) * det;

    te[6] = m6 * det;
    te[7] = (m13 * m21 - m11 * m23) * det;
    te[8] = (m11 * m22 - m12 * m21) * det;

    return this;
};

/**
 * @method transpose
 * @memberof Odin.Mat3
 * transposes this matrix
 * @return this
 */
Mat3.prototype.transpose = function () {
    var te = this.elements,
        tmp;

    tmp = te[1];
    te[1] = te[3];
    te[3] = tmp;
    tmp = te[2];
    te[2] = te[6];
    te[6] = tmp;
    tmp = te[5];
    te[5] = te[7];
    te[7] = tmp;

    return this;
};

/**
 * @method setTrace
 * @memberof Odin.Mat3
 * sets the diagonal of matrix
 * @param Vec3 v
 * @return this
 */
Mat3.prototype.setTrace = function (v) {
    var te = this.elements;

    te[0] = v.x;
    te[4] = v.y;
    te[8] = v.z;

    return this;
};

/**
 * @method scale
 * @memberof Odin.Mat3
 * scales this by vector
 * @param Vec3 v
 * @return this
 */
Mat3.prototype.scale = function (v) {
    var te = this.elements,
        x = v.x,
        y = v.y,
        z = v.z;

    te[0] *= x;
    te[3] *= y;
    te[6] *= z;
    te[1] *= x;
    te[4] *= y;
    te[7] *= z;
    te[2] *= x;
    te[5] *= y;
    te[8] *= z;

    return this;
};

/**
 * @method makeScale
 * @memberof Odin.Mat3
 * makes this a scale matrix
 * @param Number x
 * @param Number y
 * @param Number z
 * @return this
 */
Mat3.prototype.makeScale = function (x, y, z) {

    return this.set(
        x, 0.0, 0.0,
        0.0, y, 0.0,
        0.0, 0.0, z
    );
};

/**
 * @method makeRotationX
 * @memberof Odin.Mat3
 * makes this a rotation matrix along x axis
 * @param Number angle
 * @return this
 */
Mat3.prototype.makeRotationX = function (angle) {
    var c = cos(angle),
        s = sin(angle);

    return this.set(
        1, 0.0, 0.0,
        0.0, c, -s,
        0.0, s, c
    );
};

/**
 * @method makeRotationY
 * @memberof Odin.Mat3
 * makes this a rotation matrix along y axis
 * @param Number angle
 * @return this
 */
Mat3.prototype.makeRotationY = function (angle) {
    var c = cos(angle),
        s = sin(angle);

    return this.set(
        c, 0.0, s,
        0.0, 1, 0.0, -s, 0.0, c
    );
};

/**
 * @method makeRotationZ
 * @memberof Odin.Mat3
 * makes this a rotation matrix along z axis
 * @param Number angle
 * @return this
 */
Mat3.prototype.makeRotationZ = function (angle) {
    var c = cos(angle),
        s = sin(angle);

    return this.set(
        c, -s, 0.0,
        s, c, 0.0,
        0.0, 0.0, 1
    );
};

/**
 * @method fromMat2
 * @memberof Odin.Mat3
 * sets this from Mat2
 * @param Mat2 m
 * @return this
 */
Mat3.prototype.fromMat2 = function (m) {
    var te = this.elements,
        me = m.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = 0.0;
    te[3] = me[2];
    te[4] = me[3];
    te[5] = 0.0;
    te[6] = 0.0;
    te[7] = 0.0;
    te[8] = 1;

    return this;
};

/**
 * @method fromMat4
 * @memberof Odin.Mat3
 * sets this from Mat4
 * @param Mat2 m
 * @return this
 */
Mat3.prototype.fromMat4 = function (m) {
    var te = this.elements,
        me = m.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[2];
    te[3] = me[4];
    te[4] = me[5];
    te[5] = me[6];
    te[6] = me[8];
    te[7] = me[9];
    te[8] = me[10];

    return this;
};

/**
 * @method fromQuat
 * @memberof Odin.Mat3
 * sets rotation of this from quaterian
 * @param Quat q
 * @return this
 */
Mat3.prototype.fromQuat = function (q) {
    var te = this.elements,
        x = q.x,
        y = q.y,
        z = q.z,
        w = q.w,
        x2 = x + x,
        y2 = y + y,
        z2 = z + z,
        xx = x * x2,
        xy = x * y2,
        xz = x * z2,
        yy = y * y2,
        yz = y * z2,
        zz = z * z2,
        wx = w * x2,
        wy = w * y2,
        wz = w * z2;

    te[0] = 1 - (yy + zz);
    te[1] = xy + wz;
    te[2] = xz - wy;

    te[3] = xy - wz;
    te[4] = 1 - (xx + zz);
    te[5] = yz + wx;

    te[6] = xz + wy;
    te[7] = yz - wx;
    te[8] = 1 - (xx + yy);

    return this;
};

/**
 * @memberof Odin.Mat3
 * @param Odin.Mat3 other
 * @return this
 */
Mat3.prototype.equals = function (other) {
    var ae = this.elements,
        be = other.elements;

    return !(
    ae[0] !== be[0] ||
    ae[1] !== be[1] ||
    ae[2] !== be[2] ||
    ae[3] !== be[3] ||
    ae[4] !== be[4] ||
    ae[5] !== be[5] ||
    ae[6] !== be[6] ||
    ae[7] !== be[7] ||
    ae[8] !== be[8]
    );
};

/**
 * @memberof Odin.Mat3
 * @param Odin.Mat3 other
 * @return this
 */
Mat3.prototype.notEquals = function (other) {
    var ae = this.elements,
        be = other.elements;

    return (
    ae[0] !== be[0] ||
    ae[1] !== be[1] ||
    ae[2] !== be[2] ||
    ae[3] !== be[3] ||
    ae[4] !== be[4] ||
    ae[5] !== be[5] ||
    ae[6] !== be[6] ||
    ae[7] !== be[7] ||
    ae[8] !== be[8]
    );
};

/**
 * @method fromJSON
 * @memberof Odin.Mat3
 * sets values from JSON object
 * @param Object json
 * @return this
 */
Mat3.prototype.fromJSON = function (json) {
    var te = this.elements,
        me = json.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[2];
    te[3] = me[3];
    te[4] = me[4];
    te[5] = me[5];
    te[6] = me[6];
    te[7] = me[7];
    te[8] = me[8];

    return this;
};

/**
 * @method toJSON
 * @memberof Odin.Mat3
 * returns json object of this
 * @param Array array
 * @return Object
 */
Mat3.prototype.toJSON = function (json) {
    json || (json = {});
    var te = this.elements,
        je = json.elements || (json.elements = []);

    json._className = "Mat3";
    je[0] = te[0];
    je[1] = te[1];
    je[2] = te[2];
    je[3] = te[3];
    je[4] = te[4];
    je[5] = te[5];
    je[6] = te[6];
    je[7] = te[7];
    je[8] = te[8];

    return json;
};

/**
 * @method fromArray
 * @memberof Odin.Mat3
 * sets values from Array object
 * @param Object json
 * @return this
 */
Mat3.prototype.fromArray = function (array) {
    var te = this.elements;

    te[0] = array[0];
    te[1] = array[1];
    te[2] = array[2];
    te[3] = array[3];
    te[4] = array[4];
    te[5] = array[5];
    te[6] = array[6];
    te[7] = array[7];
    te[8] = array[8];

    return this;
};

/**
 * @method toArray
 * @memberof Odin.Mat3
 * returns array object of this
 * @return Object
 */
Mat3.prototype.toArray = function (array) {
    array || (array = []);
    var te = this.elements;

    array[0] = te[0];
    array[1] = te[1];
    array[2] = te[2];
    array[3] = te[3];
    array[4] = te[4];
    array[5] = te[5];
    array[6] = te[6];
    array[7] = te[7];
    array[8] = te[8];

    return array;
};

/**
 * @method toString
 * @memberof Odin.Mat3
 * returns string of this
 * @return String
 */
Mat3.prototype.toString = function () {
    var te = this.elements;

    return (
    "Mat3[" + te[0] + ", " + te[3] + ", " + te[6] + "]\n" +
    "     [" + te[1] + ", " + te[4] + ", " + te[7] + "]\n" +
    "     [" + te[2] + ", " + te[5] + ", " + te[8] + "]"
    );
};


module.exports = Mat3;

},{"./mathf":107}],105:[function(require,module,exports){
var Mathf = require("./mathf");
"use strict";


var sqrt = Math.sqrt,
    cos = Math.cos,
    sin = Math.sin,
    atan2 = Math.atan2;

/**
 * @class Mat32
 * 3x2 matrix
 * @param Number m11
 * @param Number m12
 * @param Number m13
 * @param Number m21
 * @param Number m22
 * @param Number m23
 */
function Mat32(m11, m12, m13, m21, m22, m23) {
    var te = new Float32Array(6);

    /**
     * @property Float32Array elements
     * @memberof Odin.Mat32
     */
    this.elements = te;

    te[0] = m11 != undefined ? m11 : 1.0;
    te[2] = m12 || 0.0;
    te[4] = m13 || 0.0;
    te[1] = m21 || 0.0;
    te[3] = m22 != undefined ? m22 : 1.0;
    te[5] = m23 || 0.0;
}

Mathf._classes["Mat32"] = Mat32;

/**
 * @method clone
 * @memberof Odin.Mat32
 * returns new instance of this
 * @return Mat32
 */
Mat32.prototype.clone = function () {
    var te = this.elements;

    return new Mat32(
        te[0], te[1], te[2],
        te[3], te[4], te[5]
    );
};

/**
 * @method copy
 * @memberof Odin.Mat32
 * copies other
 * @param Mat32 other
 * @return this
 */
Mat32.prototype.copy = function (other) {
    var te = this.elements,
        me = other.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[2];
    te[3] = me[3];
    te[4] = me[4];
    te[5] = me[5];

    return this;
};

/**
 * @method set
 * @memberof Odin.Mat32
 * sets values of this
 * @param Number m11
 * @param Number m12
 * @param Number m13
 * @param Number m21
 * @param Number m22
 * @param Number m23
 * @return this
 */
Mat32.prototype.set = function (m11, m12, m13, m21, m22, m23) {
    var te = this.elements;

    te[0] = m11;
    te[2] = m12;
    te[4] = m13;
    te[1] = m21;
    te[3] = m22;
    te[5] = m23;

    return this;
};

/**
 * @method mul
 * @memberof Odin.Mat32
 * muliples this's values by other's
 * @param Mat32 other
 * @return this
 */
Mat32.prototype.mul = function (other) {
    var ae = this.elements,
        be = other.elements,

        a11 = ae[0],
        a12 = ae[2],
        a13 = ae[4],
        a21 = ae[1],
        a22 = ae[3],
        a23 = ae[5],

        b11 = be[0],
        b12 = be[2],
        b13 = be[4],
        b21 = be[1],
        b22 = be[3],
        b23 = be[5];

    ae[0] = a11 * b11 + a21 * b12;
    ae[2] = a12 * b11 + a22 * b12;

    ae[1] = a11 * b21 + a21 * b22;
    ae[3] = a12 * b21 + a22 * b22;

    ae[4] = a11 * b13 + a12 * b23 + a13;
    ae[5] = a21 * b13 + a22 * b23 + a23;

    return this;
};

/**
 * @method mmul
 * @memberof Odin.Mat32
 * muliples a and b saves it in this
 * @param Mat32 a
 * @param Mat32 b
 * @return this
 */
Mat32.prototype.mmul = function (a, b) {
    var te = this.elements,
        ae = a.elements,
        be = b.elements,

        a11 = ae[0],
        a12 = ae[2],
        a13 = ae[4],
        a21 = ae[1],
        a22 = ae[3],
        a23 = ae[5],

        b11 = be[0],
        b12 = be[2],
        b13 = be[4],
        b21 = be[1],
        b22 = be[3],
        b23 = be[5];

    te[0] = a11 * b11 + a21 * b12;
    te[2] = a12 * b11 + a22 * b12;

    te[1] = a11 * b21 + a21 * b22;
    te[3] = a12 * b21 + a22 * b22;

    te[4] = a11 * b13 + a12 * b23 + a13;
    te[5] = a21 * b13 + a22 * b23 + a23;

    return this;
};

/**
 * @method smul
 * @memberof Odin.Mat32
 * muliples this by a scalar value
 * @param Number s
 * @return this
 */
Mat32.prototype.smul = function (s) {
    var te = this.elements;

    te[0] *= s;
    te[1] *= s;
    te[2] *= s;
    te[3] *= s;
    te[4] *= s;
    te[5] *= s;

    return this;
};

/**
 * @method sdiv
 * @memberof Odin.Mat32
 * divides this by scalar value
 * @param Number s
 * @return this
 */
Mat32.prototype.sdiv = function (s) {
    var te = this.elements;

    s = s !== 0.0 ? 1.0 / s : 1.0;

    te[0] *= s;
    te[1] *= s;
    te[2] *= s;
    te[3] *= s;
    te[4] *= s;
    te[5] *= s;

    return this;
};

/**
 * @method identity
 * @memberof Odin.Mat32
 * identity matrix
 * @return this
 */
Mat32.prototype.identity = function () {
    var te = this.elements;

    te[0] = 1;
    te[1] = 0.0;
    te[2] = 0.0;
    te[3] = 1;
    te[4] = 0.0;
    te[5] = 0.0;

    return this;
};

/**
 * @method zero
 * @memberof Odin.Mat32
 * zero matrix
 * @return this
 */
Mat32.prototype.zero = function () {
    var te = this.elements;

    te[0] = 0.0;
    te[1] = 0.0;
    te[2] = 0.0;
    te[3] = 0.0;
    te[4] = 0.0;
    te[5] = 0.0;

    return this;
};

/**
 * @method determinant
 * @memberof Odin.Mat32
 * returns the determinant of this
 * @return this
 */
Mat32.prototype.determinant = function () {
    var te = this.elements;

    return te[0] * te[3] - te[2] * te[1];
};

/**
 * @method inverse
 * @memberof Odin.Mat32
 * returns the inverse of this
 * @return this
 */
Mat32.prototype.inverse = function () {
    var te = this.elements,

        m11 = te[0],
        m12 = te[2],
        m13 = te[4],
        m21 = te[1],
        m22 = te[3],
        m23 = te[5],

        det = m11 * m22 - m12 * m21;

    if (det === 0.0) {
        return this.identity();
    }
    det = 1.0 / det;

    te[0] = m22 * det;
    te[1] = -m12 * det;
    te[2] = -m21 * det;
    te[3] = m11 * det;

    te[4] = (m21 * m23 - m22 * m13) * det;
    te[5] = -(m11 * m23 - m12 * m13) * det;

    return this;
};

/**
 * @method inverseMat
 * @memberof Odin.Mat32
 * returns the inverse of other
 * @param Mat32 other
 * @return this
 */
Mat32.prototype.inverseMat = function (other) {
    var te = this.elements,
        me = other.elements,

        m11 = me[0],
        m12 = me[2],
        m13 = me[4],
        m21 = me[1],
        m22 = me[3],
        m23 = me[5],

        det = m11 * m22 - m12 * m21;

    if (det === 0.0) {
        return this.identity();
    }
    det = 1.0 / det;

    te[0] = m22 * det;
    te[1] = -m12 * det;
    te[2] = -m21 * det;
    te[3] = m11 * det;

    te[4] = (m21 * m23 - m22 * m13) * det;
    te[5] = -(m11 * m23 - m12 * m13) * det;

    return this;
};

/**
 * @method transpose
 * @memberof Odin.Mat32
 * transposes this matrix
 * @return this
 */
Mat32.prototype.transpose = function () {
    var te = this.elements,
        tmp;

    tmp = te[1];
    te[1] = te[2];
    te[2] = tmp;

    return this;
};

/**
 * @method setTrace
 * @memberof Odin.Mat32
 * sets the diagonal of matrix
 * @param Number x
 * @param Number y
 * @return this
 */
Mat32.prototype.setTrace = function (x, y) {
    var te = this.elements;

    te[0] = x;
    te[3] = y;

    return this;
};

/**
 * @method lookAt
 * @memberof Odin.Mat32
 * makes matrix look from eye to target
 * @param Vec2 eye
 * @param Vec2 target
 * @return this
 */
Mat32.prototype.lookAt = function (eye, target) {
    var te = this.elements,
        x = target.x - eye.x,
        y = target.y - eye.y,
        a = atan2(y, x) - HALF_PI,
        c = cos(a),
        s = sin(a);

    te[0] = c;
    te[1] = s;
    te[2] = -s;
    te[3] = c;

    return this;
};

/**
 * @method compose
 * @memberof Odin.Mat32
 * sets matrix from position, scale, and an angle in radians
 * @param Vec2 position
 * @param Vec2 scale
 * @param Number angle
 * @return this
 */
Mat32.prototype.compose = function (position, scale, angle) {
    var te = this.elements,
        sx = scale.x,
        sy = scale.y,
        c = cos(angle),
        s = sin(angle);

    te[0] = c * sx;
    te[1] = s * sx;
    te[2] = -s * sy;
    te[3] = c * sy;

    te[4] = position.x;
    te[5] = position.y;

    return this;
};

/**
 * @method decompose
 * @memberof Odin.Mat32
 * gets matrix position, scale, and returns its angle in radians
 * @param Vec2 position
 * @param Vec2 scale
 * @return Number
 */
Mat32.prototype.decompose = function (position, scale) {
    var te = this.elements,
        m11 = te[0],
        m12 = te[1],
        sx = scale.set(m11, m12).length(),
        sy = scale.set(te[2], te[3]).length();

    position.x = te[4];
    position.y = te[5];

    scale.x = sx;
    scale.y = sy;

    return atan2(m12, m11);
};

/**
 * @method setRotation
 * @memberof Odin.Mat32
 * sets the rotation in radians this
 * @param Number angle
 * @return this
 */
Mat32.prototype.setRotation = function (angle) {
    var te = this.elements,
        c = cos(angle),
        s = sin(angle);

    te[0] = c;
    te[1] = s;
    te[2] = -s;
    te[3] = c;

    return this;
};

/**
 * @method getRotation
 * @memberof Odin.Mat32
 * returns the rotation in radians of this
 * @return Number
 */
Mat32.prototype.getRotation = function () {
    var te = this.elements;

    return atan2(te[1], te[0]);
};

/**
 * @method setPosition
 * @memberof Odin.Mat32
 * sets the position of this
 * @param Vec2 v
 * @return this
 */
Mat32.prototype.setPosition = function (v) {
    var te = this.elements;

    te[4] = v.x;
    te[5] = v.y;

    return this;
};

/**
 * @method getPosition
 * @memberof Odin.Mat32
 * gets the position of this
 * @param Vec2 v
 * @return Vec2
 */
Mat32.prototype.getPosition = function (v) {
    var te = this.elements;

    v.x = te[4];
    v.y = te[5];

    return v;
};

/**
 * @method extractPosition
 * @memberof Odin.Mat32
 * gets position from other saves it in this
 * @param Mat32 other
 * @return this
 */
Mat32.prototype.extractPosition = function (other) {
    var te = this.elements,
        me = other.elements;

    te[4] = me[4];
    te[5] = me[5];

    return this;
};

/**
 * @method extractRotation
 * @memberof Odin.Mat32
 * gets rotation from other saves it in this
 * @param Mat32 other
 * @return this
 */
Mat32.prototype.extractRotation = function (other) {
    var te = this.elements,
        me = other.elements,

        m11 = me[0],
        m12 = me[2],
        m21 = me[1],
        m22 = me[3],

        x = m11 * m11 + m21 * m21,
        y = m12 * m12 + m22 * m22,

        sx = x > 0.0 ? 1.0 / sqrt(x) : 0.0,
        sy = y > 0.0 ? 1.0 / sqrt(y) : 0.0;

    te[0] = m11 * sx;
    te[1] = m21 * sx;

    te[2] = m12 * sy;
    te[3] = m22 * sy;

    return this;
};

/**
 * @method translate
 * @memberof Odin.Mat32
 * translates matrix by vector
 * @param Vec2 v
 * @return this
 */
Mat32.prototype.translate = function (v) {
    var te = this.elements,
        x = v.x,
        y = v.y;

    te[4] = te[0] * x + te[2] * y + te[4];
    te[5] = te[1] * x + te[3] * y + te[5];

    return this;
};

/**
 * @method rotate
 * @memberof Odin.Mat32
 * rotates this by angle in radians
 * @param Number angle
 * @return this
 */
Mat32.prototype.rotate = function (angle) {
    var te = this.elements,

        m11 = te[0],
        m12 = te[2],
        m21 = te[1],
        m22 = te[3],

        s = sin(angle),
        c = sin(angle);

    te[0] = m11 * c + m12 * s;
    te[1] = m11 * -s + m12 * c;
    te[2] = m21 * c + m22 * s;
    te[3] = m21 * -s + m22 * c;

    return this;
};

/**
 * @method scale
 * @memberof Odin.Mat32
 * scales matrix by vector
 * @param Vec2 v
 * @return this
 */
Mat32.prototype.scale = function (v) {
    var te = this.elements,
        x = v.x,
        y = v.y;

    te[0] *= x;
    te[1] *= x;
    te[4] *= x;

    te[2] *= y;
    te[3] *= y;
    te[5] *= y;

    return this;
};

/**
 * @method orthographic
 * @memberof Odin.Mat32
 * makes orthographic matrix
 * @param Number left
 * @param Number right
 * @param Number bottom
 * @param Number top
 * @return Mat32
 */
Mat32.prototype.orthographic = function (left, right, top, bottom) {
    var te = this.elements,
        w = right - left,
        h = top - bottom,

        x = (right + left) / w,
        y = (top + bottom) / h;

    te[0] = 2 / w;
    te[1] = 0.0;
    te[2] = 0.0;
    te[3] = 2 / h;
    te[4] = -x;
    te[5] = -y;

    return this;
};

/**
 * @method fromMat3
 * @memberof Odin.Mat32
 * sets this from Mat3
 * @param Mat3 m
 * @return this
 */
Mat32.prototype.fromMat3 = function (m) {
    var te = this.elements,
        me = m.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[3];
    te[3] = me[4];
    te[4] = 0.0;
    te[5] = 0.0;

    return this;
};

/**
 * @method fromMat4
 * @memberof Odin.Mat32
 * sets this from Mat4
 * @param Mat4 m
 * @return this
 */
Mat32.prototype.fromMat4 = function (m) {
    var te = this.elements,
        me = m.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[4];
    te[3] = me[5];
    te[4] = me[12];
    te[5] = me[13];

    return this;
};

/**
 * @memberof Odin.Mat32
 * @param Odin.Mat32 other
 * @return this
 */
Mat32.prototype.equals = function (other) {
    var ae = this.elements,
        be = other.elements;

    return !(
    ae[0] !== be[0] ||
    ae[1] !== be[1] ||
    ae[2] !== be[2] ||
    ae[3] !== be[3] ||
    ae[4] !== be[4] ||
    ae[5] !== be[5]
    );
};

/**
 * @memberof Odin.Mat32
 * @param Odin.Mat32 other
 * @return this
 */
Mat32.prototype.notEquals = function (other) {
    var ae = this.elements,
        be = other.elements;

    return (
    ae[0] !== be[0] ||
    ae[1] !== be[1] ||
    ae[2] !== be[2] ||
    ae[3] !== be[3] ||
    ae[4] !== be[4] ||
    ae[5] !== be[5]
    );
};

/**
 * @method fromJSON
 * @memberof Odin.Mat32
 * sets values from JSON object
 * @param Object json
 * @return this
 */
Mat32.prototype.fromJSON = function (json) {
    var te = this.elements,
        me = json.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[2];
    te[3] = me[3];
    te[4] = me[4];
    te[5] = me[5];

    return this;
};

/**
 * @method toJSON
 * @memberof Odin.Mat32
 * returns json object of this
 * @return Object
 */
Mat32.prototype.toJSON = function (json) {
    json || (json = {});
    var te = this.elements,
        je = json.elements || (json.elements = []);

    json._className = "Mat32";
    je[0] = te[0];
    je[1] = te[1];
    je[2] = te[2];
    je[3] = te[3];
    je[4] = te[4];
    je[5] = te[5];

    return json;
};

/**
 * @method fromArray
 * @memberof Odin.Mat32
 * sets values from Array object
 * @param Object json
 * @return this
 */
Mat32.prototype.fromArray = function (array) {
    var te = this.elements;

    te[0] = array[0];
    te[1] = array[1];
    te[2] = array[2];
    te[3] = array[3];
    te[4] = array[4];
    te[5] = array[5];

    return this;
};

/**
 * @method toArray
 * @memberof Odin.Mat32
 * returns array object of this
 * @return Object
 */
Mat32.prototype.toArray = function (array) {
    array || (array = []);
    var te = this.elements;

    array[0] = te[0];
    array[1] = te[1];
    array[2] = te[2];
    array[3] = te[3];
    array[4] = te[4];
    array[5] = te[5];

    return array;
};

/**
 * @method toString
 * @memberof Odin.Mat32
 * returns string of this
 * @return String
 */
Mat32.prototype.toString = function () {
    var te = this.elements;

    return (
    "Mat32[ " + te[0] + ", " + te[2] + ", " + te[4] + "]\n" +
    "     [ " + te[1] + ", " + te[3] + ", " + te[5] + "]"
    );
};


module.exports = Mat32;

},{"./mathf":107}],106:[function(require,module,exports){
var Mathf = require("./mathf");
var Vec3 = require("./vec3");
"use strict";


var sqrt = Math.sqrt,
    cos = Math.cos,
    sin = Math.sin,
    tan = Math.tan;

/**
 * @class Mat4
 * 4x4 matrix
 * @param Number m11
 * @param Number m12
 * @param Number m13
 * @param Number m14
 * @param Number m21
 * @param Number m22
 * @param Number m23
 * @param Number m24
 * @param Number m31
 * @param Number m32
 * @param Number m33
 * @param Number m34
 * @param Number m41
 * @param Number m42
 * @param Number m43
 * @param Number m44
 */
function Mat4(m11, m12, m13, m14, m21, m22, m23, m24, m31, m32, m33, m34, m41, m42, m43, m44) {
    var te = new Float32Array(16);

    /**
     * @property Float32Array elements
     * @memberof Xian.Mat4
     */
    this.elements = te;

    te[0] = m11 != undefined ? m11 : 1.0;
    te[4] = m12 || 0.0;
    te[8] = m13 || 0.0;
    te[12] = m14 || 0.0;
    te[1] = m21 || 0.0;
    te[5] = m22 != undefined ? m22 : 1.0;
    te[9] = m23 || 0.0;
    te[13] = m24 || 0.0;
    te[2] = m31 || 0.0;
    te[6] = m32 || 0.0;
    te[10] = m33 != undefined ? m33 : 1.0;
    te[14] = m34 || 0.0;
    te[3] = m41 || 0.0;
    te[7] = m42 || 0.0;
    te[11] = m43 || 0.0;
    te[15] = m44 != undefined ? m44 : 1.0;
}

Mathf._classes["Mat4"] = Mat4;

/**
 * @method clone
 * @memberof Xian.Mat4
 * returns new instance of this
 * @return Mat4
 */
Mat4.prototype.clone = function () {
    var te = this.elements;

    return new Mat4(
        te[0], te[4], te[8], te[12],
        te[1], te[5], te[9], te[13],
        te[2], te[6], te[10], te[14],
        te[3], te[7], te[11], te[15]
    );
};

/**
 * @method copy
 * @memberof Xian.Mat4
 * copies other
 * @param Mat4 other
 * @return this
 */
Mat4.prototype.copy = function (other) {
    var te = this.elements,
        me = other.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[2];
    te[3] = me[3];
    te[4] = me[4];
    te[5] = me[5];
    te[6] = me[6];
    te[7] = me[7];
    te[8] = me[8];
    te[9] = me[9];
    te[10] = me[10];
    te[11] = me[11];
    te[12] = me[12];
    te[13] = me[13];
    te[14] = me[14];
    te[15] = me[15];

    return this;
};

/**
 * @method set
 * @memberof Xian.Mat4
 * sets values of this
 * @param Number m11
 * @param Number m12
 * @param Number m13
 * @param Number m14
 * @param Number m21
 * @param Number m22
 * @param Number m23
 * @param Number m24
 * @param Number m31
 * @param Number m32
 * @param Number m33
 * @param Number m34
 * @param Number m41
 * @param Number m42
 * @param Number m43
 * @param Number m44
 * @return this
 */
Mat4.prototype.set = function (m11, m12, m13, m14, m21, m22, m23, m24, m31, m32, m33, m34, m41, m42, m43, m44) {
    var te = this.elements;

    te[0] = m11;
    te[4] = m12;
    te[8] = m13;
    te[12] = m14;
    te[1] = m21;
    te[5] = m22;
    te[9] = m23;
    te[13] = m24;
    te[2] = m31;
    te[6] = m32;
    te[10] = m33;
    te[14] = m34;
    te[3] = m41;
    te[7] = m42;
    te[11] = m43;
    te[15] = m44;

    return this;
};

/**
 * @method mul
 * @memberof Xian.Mat4
 * muliples this's values by other's
 * @param Mat4 other
 * @return this
 */
Mat4.prototype.mul = function (other) {
    var ae = this.elements,
        be = other.elements,

        a11 = ae[0],
        a12 = ae[4],
        a13 = ae[8],
        a14 = ae[12],
        a21 = ae[1],
        a22 = ae[5],
        a23 = ae[9],
        a24 = ae[13],
        a31 = ae[2],
        a32 = ae[6],
        a33 = ae[10],
        a34 = ae[14],
        a41 = ae[3],
        a42 = ae[7],
        a43 = ae[11],
        a44 = ae[15],

        b11 = be[0],
        b12 = be[4],
        b13 = be[8],
        b14 = be[12],
        b21 = be[1],
        b22 = be[5],
        b23 = be[9],
        b24 = be[13],
        b31 = be[2],
        b32 = be[6],
        b33 = be[10],
        b34 = be[14],
        b41 = be[3],
        b42 = be[7],
        b43 = be[11],
        b44 = be[15];

    ae[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;
    ae[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;
    ae[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;
    ae[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;

    ae[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;
    ae[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;
    ae[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;
    ae[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;

    ae[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;
    ae[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;
    ae[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;
    ae[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;

    ae[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;
    ae[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;
    ae[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;
    ae[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;

    return this;
};

/**
 * @method mmul
 * @memberof Xian.Mat4
 * muliples a and b saves it in this
 * @param Mat4 a
 * @param Mat4 b
 * @return this
 */
Mat4.prototype.mmul = function (a, b) {
    var te = this.elements,
        ae = a.elements,
        be = b.elements,

        a11 = ae[0],
        a12 = ae[4],
        a13 = ae[8],
        a14 = ae[12],
        a21 = ae[1],
        a22 = ae[5],
        a23 = ae[9],
        a24 = ae[13],
        a31 = ae[2],
        a32 = ae[6],
        a33 = ae[10],
        a34 = ae[14],
        a41 = ae[3],
        a42 = ae[7],
        a43 = ae[11],
        a44 = ae[15],

        b11 = be[0],
        b12 = be[4],
        b13 = be[8],
        b14 = be[12],
        b21 = be[1],
        b22 = be[5],
        b23 = be[9],
        b24 = be[13],
        b31 = be[2],
        b32 = be[6],
        b33 = be[10],
        b34 = be[14],
        b41 = be[3],
        b42 = be[7],
        b43 = be[11],
        b44 = be[15];

    te[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;
    te[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;
    te[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;
    te[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;

    te[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;
    te[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;
    te[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;
    te[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;

    te[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;
    te[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;
    te[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;
    te[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;

    te[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;
    te[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;
    te[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;
    te[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;

    return this;
};

/**
 * @method smul
 * @memberof Xian.Mat4
 * muliples this by a scalar value
 * @param Number s
 * @return this
 */
Mat4.prototype.smul = function (s) {
    var te = this.elements;

    te[0] *= s;
    te[1] *= s;
    te[2] *= s;
    te[3] *= s;
    te[4] *= s;
    te[5] *= s;
    te[6] *= s;
    te[7] *= s;
    te[8] *= s;
    te[9] *= s;
    te[10] *= s;
    te[11] *= s;
    te[12] *= s;
    te[13] *= s;
    te[14] *= s;
    te[15] *= s;

    return this;
};

/**
 * @method sdiv
 * @memberof Xian.Mat4
 * divides this by scalar value
 * @param Number s
 * @return this
 */
Mat4.prototype.sdiv = function (s) {
    var te = this.elements;

    s = s !== 0.0 ? 1.0 / s : 1.0;

    te[0] *= s;
    te[1] *= s;
    te[2] *= s;
    te[3] *= s;
    te[4] *= s;
    te[5] *= s;
    te[6] *= s;
    te[7] *= s;
    te[8] *= s;
    te[9] *= s;
    te[10] *= s;
    te[11] *= s;
    te[12] *= s;
    te[13] *= s;
    te[14] *= s;
    te[15] *= s;

    return this;
};

/**
 * @method identity
 * @memberof Xian.Mat4
 * identity matrix
 * @return this
 */
Mat4.prototype.identity = function () {
    var te = this.elements;

    te[0] = 1;
    te[1] = 0.0;
    te[2] = 0.0;
    te[3] = 0.0;
    te[4] = 0.0;
    te[5] = 1;
    te[6] = 0.0;
    te[7] = 0.0;
    te[8] = 0.0;
    te[9] = 0.0;
    te[10] = 1;
    te[11] = 0.0;
    te[12] = 0.0;
    te[13] = 0.0;
    te[14] = 0.0;
    te[15] = 1;

    return this;
};

/**
 * @method zero
 * @memberof Xian.Mat4
 * zero matrix
 * @return this
 */
Mat4.prototype.zero = function () {
    var te = this.elements;

    te[0] = 0.0;
    te[1] = 0.0;
    te[2] = 0.0;
    te[3] = 0.0;
    te[4] = 0.0;
    te[5] = 0.0;
    te[6] = 0.0;
    te[7] = 0.0;
    te[8] = 0.0;
    te[9] = 0.0;
    te[10] = 0.0;
    te[11] = 0.0;
    te[12] = 0.0;
    te[13] = 0.0;
    te[14] = 0.0;
    te[15] = 0.0;

    return this;
};

/**
 * @method determinant
 * @memberof Xian.Mat4
 * returns the determinant of this
 * @return this
 */
Mat4.prototype.determinant = function () {
    var m11 = ae[0],
        m12 = ae[4],
        m13 = ae[8],
        m14 = ae[12],
        m21 = ae[1],
        m22 = ae[5],
        m23 = ae[9],
        m24 = ae[13],
        m31 = ae[2],
        m32 = ae[6],
        m33 = ae[10],
        m34 = ae[14],
        m41 = ae[3],
        m42 = ae[7],
        m43 = ae[11],
        m44 = ae[15];

    return (
    m41 * (m14 * m23 * m32 - m13 * m24 * m32 - m14 * m22 * m33 + m12 * m24 * m33 + m13 * m22 * m34 - m12 * m23 * m34) +
    m42 * (m11 * m23 * m34 - m11 * m24 * m33 + m14 * m21 * m33 - m13 * m21 * m34 + m13 * m24 * m31 - m14 * m23 * m31) +
    m43 * (m11 * m24 * m32 - m11 * m22 * m34 - m14 * m21 * m32 + m12 * m21 * m34 + m14 * m22 * m31 - m12 * m24 * m31) +
    m44 * (-m13 * m22 * m31 - m11 * m23 * m32 + m11 * m22 * m33 + m13 * m21 * m32 - m12 * m21 * m33 + m12 * m23 * m31)
    );
};

/**
 * @method inverse
 * @memberof Xian.Mat4
 * returns the inverse of this
 * @return this
 */
Mat4.prototype.inverse = function () {
    var te = this.elements,

        m11 = te[0],
        m12 = te[4],
        m13 = te[8],
        m14 = te[12],
        m21 = te[1],
        m22 = te[5],
        m23 = te[9],
        m24 = te[13],
        m31 = te[2],
        m32 = te[6],
        m33 = te[10],
        m34 = te[14],
        m41 = te[3],
        m42 = te[7],
        m43 = te[11],
        m44 = te[15],

        me0 = m23 * m34 * m42 - m24 * m33 * m42 + m24 * m32 * m43 - m22 * m34 * m43 - m23 * m32 * m44 + m22 * m33 * m44,
        me4 = m14 * m33 * m42 - m13 * m34 * m42 - m14 * m32 * m43 + m12 * m34 * m43 + m13 * m32 * m44 - m12 * m33 * m44,
        me8 = m13 * m24 * m42 - m14 * m23 * m42 + m14 * m22 * m43 - m12 * m24 * m43 - m13 * m22 * m44 + m12 * m23 * m44,
        me12 = m14 * m23 * m32 - m13 * m24 * m32 - m14 * m22 * m33 + m12 * m24 * m33 + m13 * m22 * m34 - m12 * m23 * m34,

        det = m11 * me0 + m21 * me4 + m31 * me8 + m41 * me12;

    if (det === 0.0) {
        return this.identity();
    }
    det = 1.0 / det;

    te[0] = me0 * det;
    te[4] = me4 * det;
    te[8] = me8 * det;
    te[12] = me12 * det;
    te[1] = (m24 * m33 * m41 - m23 * m34 * m41 - m24 * m31 * m43 + m21 * m34 * m43 + m23 * m31 * m44 - m21 * m33 * m44) * det;
    te[5] = (m13 * m34 * m41 - m14 * m33 * m41 + m14 * m31 * m43 - m11 * m34 * m43 - m13 * m31 * m44 + m11 * m33 * m44) * det;
    te[9] = (m14 * m23 * m41 - m13 * m24 * m41 - m14 * m21 * m43 + m11 * m24 * m43 + m13 * m21 * m44 - m11 * m23 * m44) * det;
    te[13] = (m13 * m24 * m31 - m14 * m23 * m31 + m14 * m21 * m33 - m11 * m24 * m33 - m13 * m21 * m34 + m11 * m23 * m34) * det;
    te[2] = (m22 * m34 * m41 - m24 * m32 * m41 + m24 * m31 * m42 - m21 * m34 * m42 - m22 * m31 * m44 + m21 * m32 * m44) * det;
    te[6] = (m14 * m32 * m41 - m12 * m34 * m41 - m14 * m31 * m42 + m11 * m34 * m42 + m12 * m31 * m44 - m11 * m32 * m44) * det;
    te[10] = (m12 * m24 * m41 - m14 * m22 * m41 + m14 * m21 * m42 - m11 * m24 * m42 - m12 * m21 * m44 + m11 * m22 * m44) * det;
    te[14] = (m14 * m22 * m31 - m12 * m24 * m31 - m14 * m21 * m32 + m11 * m24 * m32 + m12 * m21 * m34 - m11 * m22 * m34) * det;
    te[3] = (m23 * m32 * m41 - m22 * m33 * m41 - m23 * m31 * m42 + m21 * m33 * m42 + m22 * m31 * m43 - m21 * m32 * m43) * det;
    te[7] = (m12 * m33 * m41 - m13 * m32 * m41 + m13 * m31 * m42 - m11 * m33 * m42 - m12 * m31 * m43 + m11 * m32 * m43) * det;
    te[11] = (m13 * m22 * m41 - m12 * m23 * m41 - m13 * m21 * m42 + m11 * m23 * m42 + m12 * m21 * m43 - m11 * m22 * m43) * det;
    te[15] = (m12 * m23 * m31 - m13 * m22 * m31 + m13 * m21 * m32 - m11 * m23 * m32 - m12 * m21 * m33 + m11 * m22 * m33) * det;

    return this;
};

/**
 * @method inverseMat
 * @memberof Xian.Mat4
 * returns the inverse of other
 * @param Mat4 other
 * @return this
 */
Mat4.prototype.inverseMat = function (other) {
    var te = this.elements,
        me = other.elements,

        m11 = me[0],
        m12 = me[4],
        m13 = me[8],
        m14 = me[12],
        m21 = me[1],
        m22 = me[5],
        m23 = me[9],
        m24 = me[13],
        m31 = me[2],
        m32 = me[6],
        m33 = me[10],
        m34 = me[14],
        m41 = me[3],
        m42 = me[7],
        m43 = me[11],
        m44 = me[15],

        me0 = m23 * m34 * m42 - m24 * m33 * m42 + m24 * m32 * m43 - m22 * m34 * m43 - m23 * m32 * m44 + m22 * m33 * m44,
        me4 = m14 * m33 * m42 - m13 * m34 * m42 - m14 * m32 * m43 + m12 * m34 * m43 + m13 * m32 * m44 - m12 * m33 * m44,
        me8 = m13 * m24 * m42 - m14 * m23 * m42 + m14 * m22 * m43 - m12 * m24 * m43 - m13 * m22 * m44 + m12 * m23 * m44,
        me12 = m14 * m23 * m32 - m13 * m24 * m32 - m14 * m22 * m33 + m12 * m24 * m33 + m13 * m22 * m34 - m12 * m23 * m34,

        det = m11 * me0 + m21 * me4 + m31 * me8 + m41 * me12;

    if (det === 0.0) {
        return this.identity();
    }
    det = 1.0 / det;

    te[0] = me0 * det;
    te[4] = me4 * det;
    te[8] = me8 * det;
    te[12] = me12 * det;
    te[1] = (m24 * m33 * m41 - m23 * m34 * m41 - m24 * m31 * m43 + m21 * m34 * m43 + m23 * m31 * m44 - m21 * m33 * m44) * det;
    te[5] = (m13 * m34 * m41 - m14 * m33 * m41 + m14 * m31 * m43 - m11 * m34 * m43 - m13 * m31 * m44 + m11 * m33 * m44) * det;
    te[9] = (m14 * m23 * m41 - m13 * m24 * m41 - m14 * m21 * m43 + m11 * m24 * m43 + m13 * m21 * m44 - m11 * m23 * m44) * det;
    te[13] = (m13 * m24 * m31 - m14 * m23 * m31 + m14 * m21 * m33 - m11 * m24 * m33 - m13 * m21 * m34 + m11 * m23 * m34) * det;
    te[2] = (m22 * m34 * m41 - m24 * m32 * m41 + m24 * m31 * m42 - m21 * m34 * m42 - m22 * m31 * m44 + m21 * m32 * m44) * det;
    te[6] = (m14 * m32 * m41 - m12 * m34 * m41 - m14 * m31 * m42 + m11 * m34 * m42 + m12 * m31 * m44 - m11 * m32 * m44) * det;
    te[10] = (m12 * m24 * m41 - m14 * m22 * m41 + m14 * m21 * m42 - m11 * m24 * m42 - m12 * m21 * m44 + m11 * m22 * m44) * det;
    te[14] = (m14 * m22 * m31 - m12 * m24 * m31 - m14 * m21 * m32 + m11 * m24 * m32 + m12 * m21 * m34 - m11 * m22 * m34) * det;
    te[3] = (m23 * m32 * m41 - m22 * m33 * m41 - m23 * m31 * m42 + m21 * m33 * m42 + m22 * m31 * m43 - m21 * m32 * m43) * det;
    te[7] = (m12 * m33 * m41 - m13 * m32 * m41 + m13 * m31 * m42 - m11 * m33 * m42 - m12 * m31 * m43 + m11 * m32 * m43) * det;
    te[11] = (m13 * m22 * m41 - m12 * m23 * m41 - m13 * m21 * m42 + m11 * m23 * m42 + m12 * m21 * m43 - m11 * m22 * m43) * det;
    te[15] = (m12 * m23 * m31 - m13 * m22 * m31 + m13 * m21 * m32 - m11 * m23 * m32 - m12 * m21 * m33 + m11 * m22 * m33) * det;

    return this;
};

/**
 * @method transpose
 * @memberof Xian.Mat4
 * transposes this matrix
 * @return this
 */
Mat4.prototype.transpose = function () {
    var te = this.elements,
        tmp;

    tmp = te[1];
    te[1] = te[4];
    te[4] = tmp;
    tmp = te[2];
    te[2] = te[8];
    te[8] = tmp;
    tmp = te[6];
    te[6] = te[9];
    te[9] = tmp;

    tmp = te[3];
    te[3] = te[12];
    te[12] = tmp;
    tmp = te[7];
    te[7] = te[13];
    te[13] = tmp;
    tmp = te[11];
    te[11] = te[14];
    te[14] = tmp;

    return this;
};

/**
 * @method setTrace
 * @memberof Xian.Mat4
 * sets the diagonal of matrix
 * @param Vec4 v
 * @return this
 */
Mat4.prototype.setTrace = function (v) {
    var te = this.elements,
        w = v.w;

    te[0] = v.x;
    te[5] = v.y;
    te[10] = v.z;
    te[15] = w != undefined ? w : 1.0;

    return this;
};

/**
 * @method lookAt
 * @memberof Xian.Mat4
 * makes matrix look from eye at target along up vector
 * @param Vec3 eye
 * @param Vec3 target
 * @param Vec3 up
 * @return this
 */
Mat4.prototype.lookAt = function () {
    var dup = new Vec3(0.0, 0.0, 1.0),
        x = new Vec3,
        y = new Vec3,
        z = new Vec3;

    return function (eye, target, up) {
        up || (up = dup);
        var te = this.elements;

        z.vsub(eye, target).normalize();
        if (z.length() === 0.0) z.z = 1.0;

        x.vcross(up, z).normalize();

        if (x.length() === 0.0) {
            z.x += 0.000001;
            x.vcross(up, z).normalize();
        }

        y.vcross(z, x);


        te[0] = x.x;
        te[4] = y.x;
        te[8] = z.x;
        te[1] = x.y;
        te[5] = y.y;
        te[9] = z.y;
        te[2] = x.z;
        te[6] = y.z;
        te[10] = z.z;

        return this;
    };
}();

/**
 * @method compose
 * @memberof Xian.Mat4
 * sets matrix from position, scale, and quaternion
 * @param Vec3 position
 * @param Vec3 scale
 * @param Quat rotation
 * @return this
 */
Mat4.prototype.compose = function (position, scale, rotation) {
    var te = this.elements,
        x = rotation.x,
        y = rotation.y,
        z = rotation.z,
        w = rotation.w,
        x2 = x + x,
        y2 = y + y,
        z2 = z + z,
        xx = x * x2,
        xy = x * y2,
        xz = x * z2,
        yy = y * y2,
        yz = y * z2,
        zz = z * z2,
        wx = w * x2,
        wy = w * y2,
        wz = w * z2,

        sx = scale.x,
        sy = scale.y,
        sz = scale.z;

    te[0] = (1.0 - (yy + zz)) * sx;
    te[4] = (xy - wz) * sy;
    te[8] = (xz + wy) * sz;

    te[1] = (xy + wz) * sx;
    te[5] = (1.0 - (xx + zz)) * sy;
    te[9] = (yz - wx) * sz;

    te[2] = (xz - wy) * sx;
    te[6] = (yz + wx) * sy;
    te[10] = (1.0 - (xx + yy)) * sz;

    te[3] = 0.0;
    te[7] = 0.0;
    te[11] = 0.0;

    te[12] = position.x;
    te[13] = position.y;
    te[14] = position.z;
    te[15] = 1.0;

    return this;
};

/**
 * @method decompose
 * @memberof Xian.Mat4
 * gets matrix position, scale, quaternion
 * @param Vec3 position
 * @param Vec3 scale
 * @param Quat quaternion
 * @return this
 */
Mat4.prototype.decompose = function (position, scale, quaternion) {
    var te = this.elements,

        m11 = te[0],
        m12 = te[4],
        m13 = te[8],
        m21 = te[1],
        m22 = te[5],
        m23 = te[9],
        m31 = te[2],
        m32 = te[6],
        m33 = te[10],
        trace, x = 0.0,
        y = 0.0,
        z = 0.0,
        w = 1,
        s,

        sx = scale.set(m11, m21, m31).length(),
        sy = scale.set(m12, m22, m32).length(),
        sz = scale.set(m13, m23, m33).length(),

        invSx = 1 / sx,
        invSy = 1 / sy,
        invSz = 1 / sz;

    scale.x = sx;
    scale.y = sy;
    scale.z = sz;

    position.x = te[12];
    position.y = te[13];
    position.z = te[14];

    m11 *= invSx;
    m12 *= invSy;
    m13 *= invSz;
    m21 *= invSx;
    m22 *= invSy;
    m23 *= invSz;
    m31 *= invSx;
    m32 *= invSy;
    m33 *= invSz;

    trace = m11 + m22 + m33;

    if (trace > 0.0) {
        s = 0.5 / sqrt(trace + 1.0);

        w = 0.25 / s;
        x = (m32 - m23) * s;
        y = (m13 - m31) * s;
        z = (m21 - m12) * s;
    } else if (m11 > m22 && m11 > m33) {
        s = 2.0 * sqrt(1.0 + m11 - m22 - m33);

        w = (m32 - m23) / s;
        x = 0.25 * s;
        y = (m12 + m21) / s;
        z = (m13 + m31) / s;
    } else if (m22 > m33) {
        s = 2.0 * sqrt(1.0 + m22 - m11 - m33);

        w = (m13 - m31) / s;
        x = (m12 + m21) / s;
        y = 0.25 * s;
        z = (m23 + m32) / s;
    } else {
        s = 2.0 * sqrt(1.0 + m33 - m11 - m22);

        w = (m21 - m12) / s;
        x = (m13 + m31) / s;
        y = (m23 + m32) / s;
        z = 0.25 * s;
    }

    quaternion.x = x;
    quaternion.y = y;
    quaternion.w = w;
    quaternion.z = z;

    return this;
};

/**
 * @method setPosition
 * @memberof Xian.Mat4
 * sets position of matrix
 * @param Vec3 v
 * @return this
 */
Mat4.prototype.setPosition = function (v) {
    var te = this.elements,
        z = v.z;

    te[12] = v.x;
    te[13] = v.y;
    te[14] = z != undefined ? z : 0.0;

    return this;
};

/**
 * @method extractPosition
 * @memberof Xian.Mat4
 * gets position from other saves it in this
 * @param Mat4 other
 * @return this
 */
Mat4.prototype.extractPosition = function (other) {
    var te = this.elements,
        me = other.elements;

    te[12] = me[12];
    te[13] = me[13];
    te[14] = me[14];

    return this;
};

/**
 * @method extractRotation
 * @memberof Xian.Mat4
 * gets rotation from other saves it in this
 * @param Mat4 other
 * @return this
 */
Mat4.prototype.extractRotation = function () {
    var vec = new Vec3();

    return function (other) {
        var te = this.elements,
            me = other.elements,

            lx = vec.set(me[0], me[1], me[2]).lengthSq(),
            ly = vec.set(me[4], me[5], me[6]).lengthSq(),
            lz = vec.set(me[8], me[9], me[10]).lengthSq(),

            scaleX = lx > 0.0 ? 1.0 / sqrt(lx) : 0.0,
            scaleY = ly > 0.0 ? 1.0 / sqrt(ly) : 0.0,
            scaleZ = lz > 0.0 ? 1.0 / sqrt(lz) : 0.0;

        te[0] = me[0] * scaleX;
        te[1] = me[1] * scaleX;
        te[2] = me[2] * scaleX;

        te[4] = me[4] * scaleY;
        te[5] = me[5] * scaleY;
        te[6] = me[6] * scaleY;

        te[8] = me[8] * scaleZ;
        te[9] = me[9] * scaleZ;
        te[10] = me[10] * scaleZ;

        return this;
    };
}();

/**
 * @method extractRotationScale
 * @memberof Xian.Mat4
 * gets rotation with scale from other saves it in this
 * @param Mat4 other
 * @return this
 */
Mat4.prototype.extractRotationScale = function (other) {
    var te = this.elements,
        me = other.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[2];

    te[4] = me[4];
    te[5] = me[5];
    te[6] = me[6];

    te[8] = me[8];
    te[9] = me[9];
    te[10] = me[10];

    return this;
};

/**
 * @method translate
 * @memberof Xian.Mat4
 * translates matrix by vector
 * @param Vec3 v
 * @return this
 */
Mat4.prototype.translate = function (v) {
    var te = this.elements,
        x = v.x,
        y = v.y,
        z = v.z || 0.0;

    te[12] = te[0] * x + te[4] * y + te[8] * z + te[12];
    te[13] = te[1] * x + te[5] * y + te[9] * z + te[13];
    te[14] = te[2] * x + te[6] * y + te[10] * z + te[14];
    te[15] = te[3] * x + te[7] * y + te[11] * z + te[15];

    return this;
};

/**
 * @method scale
 * @memberof Xian.Mat4
 * scales matrix by vector
 * @param Vec3 v
 * @return this
 */
Mat4.prototype.scale = function (v) {
    var te = this.elements,
        x = v.x,
        y = v.y,
        z = v.z;

    te[0] *= x;
    te[4] *= y;
    te[8] *= z;
    te[1] *= x;
    te[5] *= y;
    te[9] *= z;
    te[2] *= x;
    te[6] *= y;
    te[10] *= z;
    te[3] *= x;
    te[7] *= y;
    te[11] *= z;

    return this;
};

/**
 * @method rotateX
 * @memberof Xian.Mat4
 * rotates matrix along x axis by angle
 * @param Number angle
 * @return this
 */
Mat4.prototype.rotateX = function (angle) {
    var te = this.elements,
        m12 = te[4],
        m22 = te[5],
        m32 = te[6],
        m42 = te[7],
        m13 = te[8],
        m23 = te[9],
        m33 = te[10],
        m43 = te[11],
        c = cos(angle),
        s = sin(angle);

    te[4] = c * m12 + s * m13;
    te[5] = c * m22 + s * m23;
    te[6] = c * m32 + s * m33;
    te[7] = c * m42 + s * m43;

    te[8] = c * m13 - s * m12;
    te[9] = c * m23 - s * m22;
    te[10] = c * m33 - s * m32;
    te[11] = c * m43 - s * m42;

    return this;
};

/**
 * @method rotateY
 * @memberof Xian.Mat4
 * rotates matrix along y axis by angle
 * @param Number angle
 * @return this
 */
Mat4.prototype.rotateY = function (angle) {
    var te = this.elements,
        m11 = te[0],
        m21 = te[1],
        m31 = te[2],
        m41 = te[3],
        m13 = te[8],
        m23 = te[9],
        m33 = te[10],
        m43 = te[11],
        c = cos(angle),
        s = sin(angle);

    te[0] = c * m11 - s * m13;
    te[1] = c * m21 - s * m23;
    te[2] = c * m31 - s * m33;
    te[3] = c * m41 - s * m43;

    te[8] = c * m13 + s * m11;
    te[9] = c * m23 + s * m21;
    te[10] = c * m33 + s * m31;
    te[11] = c * m43 + s * m41;

    return this;
};

/**
 * @method rotateZ
 * @memberof Xian.Mat4
 * rotates matrix along z axis by angle
 * @param Number angle
 * @return this
 */
Mat4.prototype.rotateZ = function (angle) {
    var te = this.elements,
        m11 = te[0],
        m21 = te[1],
        m31 = te[2],
        m41 = te[3],
        m12 = te[4],
        m22 = te[5],
        m32 = te[6],
        m42 = te[7],
        c = cos(angle),
        s = sin(angle);

    te[0] = c * m11 + s * m12;
    te[1] = c * m21 + s * m22;
    te[2] = c * m31 + s * m32;
    te[3] = c * m41 + s * m42;

    te[4] = c * m12 - s * m11;
    te[5] = c * m22 - s * m21;
    te[6] = c * m32 - s * m31;
    te[7] = c * m42 - s * m41;

    return this;
};

/**
 * @method makeTranslation
 * @memberof Xian.Mat4
 * makes this a translation matrix
 * @param Number x
 * @param Number y
 * @param Number z
 * @return this
 */
Mat4.prototype.makeTranslation = function (x, y, z) {

    return this.set(
        1, 0.0, 0.0, x,
        0.0, 1, 0.0, y,
        0.0, 0.0, 1, z,
        0.0, 0.0, 0.0, 1
    );
};

/**
 * @method makeScale
 * @memberof Xian.Mat4
 * makes this a scale matrix
 * @param Number x
 * @param Number y
 * @param Number z
 * @return this
 */
Mat4.prototype.makeScale = function (x, y, z) {

    return this.set(
        x, 0.0, 0.0, 0.0,
        0.0, y, 0.0, 0.0,
        0.0, 0.0, z, 0.0,
        0.0, 0.0, 0.0, 1
    );
};

/**
 * @method makeRotationX
 * @memberof Xian.Mat4
 * makes this a rotation matrix along x axis
 * @param Number angle
 * @return this
 */
Mat4.prototype.makeRotationX = function (angle) {
    var c = cos(angle),
        s = sin(angle);

    return this.set(
        1, 0.0, 0.0, 0.0,
        0.0, c, -s, 0.0,
        0.0, s, c, 0.0,
        0.0, 0.0, 0.0, 1
    );
};

/**
 * @method makeRotationY
 * @memberof Xian.Mat4
 * makes this a rotation matrix along y axis
 * @param Number angle
 * @return this
 */
Mat4.prototype.makeRotationY = function (angle) {
    var c = cos(angle),
        s = sin(angle);

    return this.set(
        c, 0.0, s, 0.0,
        0.0, 1, 0.0, 0.0, -s, 0.0, c, 0.0,
        0.0, 0.0, 0.0, 1
    );
};

/**
 * @method makeRotationZ
 * @memberof Xian.Mat4
 * makes this a rotation matrix along z axis
 * @param Number angle
 * @return this
 */
Mat4.prototype.makeRotationZ = function (angle) {
    var c = cos(angle),
        s = sin(angle);

    return this.set(
        c, -s, 0.0, 0.0,
        s, c, 0.0, 0.0,
        0.0, 0.0, 1, 0.0,
        0.0, 0.0, 0.0, 1
    );
};

/**
 * @method frustum
 * @memberof Xian.Mat4
 * makes frustum matrix
 * @param Number left
 * @param Number right
 * @param Number bottom
 * @param Number top
 * @param Number near
 * @param Number far
 * @return this
 */
Mat4.prototype.frustum = function (left, right, top, bottom, near, far) {
    var te = this.elements,
        x = 2 * near / (right - left),
        y = 2 * near / (top - bottom),

        a = (right + left) / (right - left),
        b = (top + bottom) / (top - bottom),
        c = -(far + near) / (far - near),
        d = -2 * far * near / (far - near);

    te[0] = x;
    te[4] = 0.0;
    te[8] = a;
    te[12] = 0.0;
    te[1] = 0.0;
    te[5] = y;
    te[9] = b;
    te[13] = 0.0;
    te[2] = 0.0;
    te[6] = 0.0;
    te[10] = c;
    te[14] = d;
    te[3] = 0.0;
    te[7] = 0.0;
    te[11] = -1;
    te[15] = 0.0;

    return this;
};

/**
 * @method perspective
 * @memberof Xian.Mat4
 * makes perspective matrix
 * @param Number fov
 * @param Number aspect
 * @param Number near
 * @param Number far
 * @return this
 */
Mat4.prototype.perspective = function (fov, aspect, near, far) {
    var ymax = near * tan(fov * 0.5),
        ymin = -ymax,
        xmin = ymin * aspect,
        xmax = ymax * aspect;

    return this.frustum(xmin, xmax, ymax, ymin, near, far);
};

/**
 * @method orthographic
 * @memberof Xian.Mat4
 * makes orthographic matrix
 * @param Number left
 * @param Number right
 * @param Number bottom
 * @param Number top
 * @param Number near
 * @param Number far
 * @return this
 */
Mat4.prototype.orthographic = function (left, right, top, bottom, near, far) {
    var te = this.elements,
        w = right - left,
        h = top - bottom,
        p = far - near,

        x = (right + left) / w,
        y = (top + bottom) / h,
        z = (far + near) / p;

    te[0] = 2 / w;
    te[1] = 0.0;
    te[2] = 0.0;
    te[3] = 0.0;
    te[4] = 0.0;
    te[5] = 2 / h;
    te[6] = 0.0;
    te[7] = 0.0
    te[8] = 0.0;
    te[9] = 0.0;
    te[10] = -2 / p;
    te[11] = 0.0;
    te[12] = -x;
    te[13] = -y;
    te[14] = -z;
    te[15] = 1;

    return this;
};

/**
 * @method fromMat2
 * @memberof Xian.Mat4
 * sets this from Mat2
 * @param Mat2 m
 * @return this
 */
Mat4.prototype.fromMat2 = function (m) {
    var te = this.elements,
        me = m.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = 0.0;
    te[3] = 0.0;
    te[4] = me[2];
    te[5] = me[3];
    te[6] = 0.0;
    te[7] = 0.0;
    te[8] = 0.0;
    te[9] = 0.0;
    te[10] = 1;
    te[11] = 0.0;
    te[12] = 0.0;
    te[13] = 0.0;
    te[14] = 0.0;
    te[15] = 1;

    return this;
};

/**
 * @method fromMat32
 * @memberof Xian.Mat4
 * sets this from Mat32
 * @param Mat32 m
 * @return this
 */
Mat4.prototype.fromMat32 = function (m) {
    var te = this.elements,
        me = m.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = 0.0;
    te[3] = 0.0;
    te[4] = me[2];
    te[5] = me[3];
    te[6] = 0.0;
    te[7] = 0.0;
    te[8] = 0.0;
    te[9] = 0.0;
    te[10] = 1;
    te[11] = 0.0;
    te[12] = me[4];
    te[13] = me[5];
    te[14] = 0.0;
    te[15] = 1;

    return this;
};

/**
 * @method fromMat3
 * @memberof Xian.Mat4
 * sets this from Mat3
 * @param Mat3 m
 * @return this
 */
Mat4.prototype.fromMat3 = function (m) {
    var te = this.elements,
        me = m.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[2];
    te[3] = 0.0;
    te[4] = me[3];
    te[5] = me[4];
    te[6] = me[5];
    te[7] = 0.0;
    te[8] = me[6];
    te[9] = me[7];
    te[10] = me[8];
    te[11] = 0.0;
    te[12] = 0.0;
    te[13] = 0.0;
    te[14] = 0.0;
    te[15] = 1;

    return this;
};

/**
 * @method fromQuat
 * @memberof Xian.Mat4
 * sets rotation of this from quaterian
 * @param Quat q
 * @return this
 */
Mat4.prototype.fromQuat = function (q) {
    var te = this.elements,
        x = q.x,
        y = q.y,
        z = q.z,
        w = q.w,
        x2 = x + x,
        y2 = y + y,
        z2 = z + z,
        xx = x * x2,
        xy = x * y2,
        xz = x * z2,
        yy = y * y2,
        yz = y * z2,
        zz = z * z2,
        wx = w * x2,
        wy = w * y2,
        wz = w * z2;

    te[0] = 1 - (yy + zz);
    te[4] = xy - wz;
    te[8] = xz + wy;

    te[1] = xy + wz;
    te[5] = 1 - (xx + zz);
    te[9] = yz - wx;

    te[2] = xz - wy;
    te[6] = yz + wx;
    te[10] = 1 - (xx + yy);

    te[3] = 0.0;
    te[7] = 0.0;
    te[11] = 0.0;

    te[12] = 0.0;
    te[13] = 0.0;
    te[14] = 0.0;
    te[15] = 1;

    return this;
};

/**
 * @memberof Xian.Mat4
 * @param Xian.Mat4 other
 * @return this
 */
Mat4.prototype.equals = function (other) {
    var ae = this.elements,
        be = other.elements;

    return !(
    ae[0] !== be[0] ||
    ae[1] !== be[1] ||
    ae[2] !== be[2] ||
    ae[3] !== be[3] ||
    ae[4] !== be[4] ||
    ae[5] !== be[5] ||
    ae[6] !== be[6] ||
    ae[7] !== be[7] ||
    ae[8] !== be[8] ||
    ae[9] !== be[9] ||
    ae[10] !== be[10] ||
    ae[11] !== be[11] ||
    ae[12] !== be[12] ||
    ae[13] !== be[13] ||
    ae[14] !== be[14] ||
    ae[15] !== be[15]
    );
};

/**
 * @memberof Xian.Mat4
 * @param Xian.Mat4 other
 * @return this
 */
Mat4.prototype.notEquals = function (other) {
    var ae = this.elements,
        be = other.elements;

    return (
    ae[0] !== be[0] ||
    ae[1] !== be[1] ||
    ae[2] !== be[2] ||
    ae[3] !== be[3] ||
    ae[4] !== be[4] ||
    ae[5] !== be[5] ||
    ae[6] !== be[6] ||
    ae[7] !== be[7] ||
    ae[8] !== be[8] ||
    ae[9] !== be[9] ||
    ae[10] !== be[10] ||
    ae[11] !== be[11] ||
    ae[12] !== be[12] ||
    ae[13] !== be[13] ||
    ae[14] !== be[14] ||
    ae[15] !== be[15]
    );
};

/**
 * @method fromJSON
 * @memberof Xian.Mat4
 * sets values from JSON object
 * @param Object json
 * @return this
 */
Mat4.prototype.fromJSON = function (json) {
    var te = this.elements,
        me = json.elements;

    te[0] = me[0];
    te[1] = me[1];
    te[2] = me[2];
    te[3] = me[3];
    te[4] = me[4];
    te[5] = me[5];
    te[6] = me[6];
    te[7] = me[7];
    te[8] = me[8];
    te[9] = me[9];
    te[10] = me[10];
    te[11] = me[11];
    te[12] = me[12];
    te[13] = me[13];
    te[14] = me[14];
    te[15] = me[15];

    return this;
};

/**
 * @method toJSON
 * @memberof Xian.Mat4
 * returns json object of this
 * @return Object
 */
Mat4.prototype.toJSON = function (json) {
    json || (json = {});
    var te = this.elements,
        je = json.elements || (json.elements = []);

    json._className = "Mat4";
    je[0] = te[0];
    je[1] = te[1];
    je[2] = te[2];
    je[3] = te[3];
    je[4] = te[4];
    je[5] = te[5];
    je[6] = te[6];
    je[7] = te[7];
    je[8] = te[8];
    je[9] = te[9];
    je[10] = te[10];
    je[11] = te[11];
    je[12] = te[12];
    je[13] = te[13];
    je[14] = te[14];
    je[15] = te[15];

    return json;
};

/**
 * @method fromArray
 * @memberof Xian.Mat4
 * sets values from Array object
 * @param Object json
 * @return this
 */
Mat4.prototype.fromArray = function (array) {
    var te = this.elements;

    te[0] = array[0];
    te[1] = array[1];
    te[2] = array[2];
    te[3] = array[3];
    te[4] = array[4];
    te[5] = array[5];
    te[6] = array[6];
    te[7] = array[7];
    te[8] = array[8];
    te[9] = array[9];
    te[10] = array[10];
    te[11] = array[11];
    te[12] = array[12];
    te[13] = array[13];
    te[14] = array[14];
    te[15] = array[15];

    return this;
};

/**
 * @method toArray
 * @memberof Xian.Mat4
 * returns array object of this
 * @return Object
 */
Mat4.prototype.toArray = function (array) {
    array || (array = []);
    var te = this.elements;

    array[0] = te[0];
    array[1] = te[1];
    array[2] = te[2];
    array[3] = te[3];
    array[4] = te[4];
    array[5] = te[5];
    array[6] = te[6];
    array[7] = te[7];
    array[8] = te[8];
    array[9] = te[9];
    array[10] = te[10];
    array[11] = te[11];
    array[12] = te[12];
    array[13] = te[13];
    array[14] = te[14];
    array[15] = te[15];

    return array;
};

/**
 * @method toString
 * @memberof Xian.Mat4
 * returns string of this
 * @return String
 */
Mat4.prototype.toString = function () {
    var te = this.elements;

    return (
    "Mat4[" + te[0] + ", " + te[4] + ", " + te[8] + ", " + te[12] + "]\n" +
    "     [" + te[1] + ", " + te[5] + ", " + te[9] + ", " + te[13] + "]\n" +
    "     [" + te[2] + ", " + te[6] + ", " + te[10] + ", " + te[14] + "]\n" +
    "     [" + te[3] + ", " + te[7] + ", " + te[11] + ", " + te[15] + "]"
    );
};


module.exports = Mat4;

},{"./mathf":107,"./vec3":112}],107:[function(require,module,exports){
"use strict";


var random = Math.random,
    abs = Math.abs,
    cos = Math.cos,
    pow = Math.pow,
    floor = Math.floor,
    ceil = Math.ceil,
    atan2 = Math.atan2,
    EPSILON = 0.000001,
    PI = 3.1415926535897932384626433832795028841968,
    TWO_PI = PI * 2,
    HALF_PI = PI * 0.5,
    TO_RADS = PI / 180.0,
    TO_DEGS = 180.0 / PI,
    keys = Object.keys,
    modulo, clamp01, standardRadian, standardAngle, radsToDegs;


/**
 * @class Mathf
 * collection of common math functions
 */
function Mathf() {

    /**
     * @property Number PI
     * The infamous 3.14159265358979323846264338327950.028841968
     * @memberof Odin.Mathf
     */
    this.PI = PI;

    /**
     * @property Number TWO_PI
     * 2 * PI
     * @memberof Odin.Mathf
     */
    this.TWO_PI = TWO_PI;

    /**
     * @property Number HALF_PI
     * PI / 2
     * @memberof Odin.Mathf
     */
    this.HALF_PI = HALF_PI;

    /**
     * @property Number EPSILON
     * A small number value
     * @memberof Odin.Mathf
     */
    this.EPSILON = EPSILON;

    /**
     * @property Number TO_RADS
     * Degrees to radians conversion constant
     * @memberof Odin.Mathf
     */
    this.TO_RADS = TO_RADS;

    /**
     * @property Number TO_DEGS
     * Radians to degrees conversion constant
     * @memberof Odin.Mathf
     */
    this.TO_DEGS = TO_DEGS;
}

Mathf.prototype._classes = {};

Mathf.prototype.acos = Math.acos;
Mathf.prototype.asin = Math.asin;
Mathf.prototype.atan = Math.atan;
Mathf.prototype.atan2 = Math.atan2;

Mathf.prototype.cos = Math.cos;
Mathf.prototype.sin = Math.sin;
Mathf.prototype.tan = Math.tan;

Mathf.prototype.abs = Math.abs;
Mathf.prototype.ceil = Math.ceil;
Mathf.prototype.exp = Math.exp;
Mathf.prototype.floor = Math.floor;
Mathf.prototype.log = Math.log;
Mathf.prototype.max = Math.max;
Mathf.prototype.min = Math.min;
Mathf.prototype.pow = Math.pow;
Mathf.prototype.random = Math.random;
Mathf.prototype.round = Math.round;
Mathf.prototype.sqrt = Math.sqrt;

/**
 * @method equals
 * @memberof Odin.Mathf
 * returns if a = b within some value, defaults to Mathf.EPSILON
 * @param Number a
 * @param Number b
 * @param Number e
 * @return Boolean
 */
Mathf.prototype.equals = function (a, b, e) {

    return abs(a - b) < (e || EPSILON);
};

/**
 * @method modulo
 * @memberof Odin.Mathf
 * returns remainder of a / b
 * @param Number a
 * @param Number b
 * @return Number
 */
Mathf.prototype.modulo = modulo = function (a, b) {
    var r = a % b;

    return (r * b < 0.0) ? r + b : r;
};

/**
 * @method standardRadian
 * @memberof Odin.Mathf
 * convertes x to radian where 0.0 <= x < 2PI
 * @param Number x
 * @return Number
 */
Mathf.prototype.standardRadian = standardRadian = function (x) {

    return modulo(x, TWO_PI);
};

/**
 * @method standardAngle
 * @memberof Odin.Mathf
 * convertes x to angle where 0.0 <= x < 360.0
 * @param Number x
 * @return Number
 */
Mathf.prototype.standardAngle = standardAngle = function (x) {

    return modulo(x, 360.0);
};

/**
 * @method sign
 * @memberof Odin.Mathf
 * gets sign of x
 * @param Number x
 * @return Number
 */
Mathf.prototype.sign = function (x) {

    return x < 0 ? -1 : 1;
};

/**
 * @method clamp
 * @memberof Odin.Mathf
 * clamp x between min and max
 * @param Number x
 * @param Number min
 * @param Number max
 * @return Number
 */
Mathf.prototype.clamp = function (x, min, max) {

    return x < min ? min : x > max ? max : x;
};

/**
 * @method clampBottom
 * @memberof Odin.Mathf
 * clamp x between min and Infinity
 * @param Number x
 * @param Number min
 * @return Number
 */
Mathf.prototype.clampBottom = function (x, min) {

    return x < min ? min : x;
};

/**
 * @method clampTop
 * @memberof Odin.Mathf
 * clamp x between -Infinity and max
 * @param Number x
 * @param Number max
 * @return Number
 */
Mathf.prototype.clampTop = function (x, max) {

    return x > max ? max : x;
};

/**
 * @method clamp01
 * @memberof Odin.Mathf
 * clamp x between 0.0 and 1
 * @param Number x
 * @return Number
 */
Mathf.prototype.clamp01 = clamp01 = function (x) {

    return x < 0.0 ? 0.0 : x > 1 ? 1 : x;
};

/**
 * @method truncate
 * @memberof Odin.Mathf
 * truncate x to have n number of decial places
 * @param Number x
 * @param Number n
 * @return Number
 */
Mathf.prototype.truncate = function (x, n) {
    var p = pow(10.0, n),
        num = x * p;

    return (num < 0.0 ? ceil(num) : floor(num)) / p;
};

/**
 * @method lerp
 * @memberof Odin.Mathf
 * linear interpolation between a and b by x
 * @param Number a
 * @param Number b
 * @param Number x
 * @return Number
 */
Mathf.prototype.lerp = function (a, b, x) {

    return a + (b - a) * x;
};

/**
 * @method lerpAngle
 * @memberof Odin.Mathf
 * linear interpolation between a and b by x insures 0.0 <= x < 2PI
 * @param Number a
 * @param Number b
 * @param Number x
 * @return Number
 */
Mathf.prototype.lerpAngle = function (a, b, x) {

    return standardRadian(a + (b - a) * x);
};

/**
 * @method cosLerp
 * @memberof Odin.Mathf
 * cosine interpolation between a and b by x
 * @param Number a
 * @param Number b
 * @param Number x
 * @return Number
 */
Mathf.prototype.lerpCos = function (a, b, x) {
    var ft = x * PI,
        f = (1.0 - cos(ft)) * 0.5;

    return a * (1.0 - f) + b * f;
};

/**
 * @method lerpCubic
 * @memberof Odin.Mathf
 * cubic interpolation between v1 and v2 by x
 * @param Number v0
 * @param Number v1
 * @param Number v2
 * @param Number v3
 * @param Number x
 * @return Number
 */
Mathf.prototype.lerpCubic = function (v0, v1, v2, v3, x) {
    v0 || (v0 = v1);
    v3 || (v3 = v2);
    var P = (v3 - v2) - (v0 - v1),
        Q = (v0 - v1) - P,
        R = v2 - v0,
        S = v1,

        Px = P * x,
        Qx = Q * x,
        Rx = R * x;

    return (Px * Px * Px) + (Qx * Qx) + Rx + S;
};

/**
 * smooth step, if input is between min and max this returns a value proportionately between 0.0 and 1
 * @method smoothStep
 * @memberof Odin.Mathf
 * @param Number x
 * @param Number min
 * @param Number max
 * @return Number
 */
Mathf.prototype.smoothStep = function (x, min, max) {
    if (x <= min) return 0.0;
    if (x >= max) return 1;

    x = (x - min) / (max - min);

    return x * x * (3 - 2 * x);
};

/**
 * @method smootherStep
 * @memberof Odin.Mathf
 * smoother step, if input is between min and max this returns a value proportionately between 0.0 and 1
 * @param Number x
 * @param Number min
 * @param Number max
 * @return Number
 */
Mathf.prototype.smootherStep = function (x, min, max) {
    if (x <= min) return 0.0;
    if (x >= max) return 1;

    x = (x - min) / (max - min);

    return x * x * x * (x * (x * 6 - 15) + 10.0);
};

/**
 * @method pingPong
 * @memberof Odin.Mathf
 * PingPongs the value x, so that it is never larger than length and never smaller than 0.0.
 * @param Number x
 * @param Number length
 * @return Number
 */
Mathf.prototype.pingPong = function (x, length) {
    length || (length = 1);

    return length - abs(x % (2 * length) - length);
};

/**
 * @method degsToRads
 * @memberof Odin.Mathf
 * convertes degrees to radians
 * @param Number x
 * @return Number
 */
Mathf.prototype.degsToRads = function (x) {

    return standardRadian(x * TO_RADS);
};

/**
 * @method radsToDegs
 * @memberof Odin.Mathf
 * convertes radians to degrees
 * @param Number x
 * @return Number
 */
Mathf.prototype.radsToDegs = radsToDegs = function (x) {

    return standardAngle(x * TO_DEGS);
};

/**
 * @method randInt
 * @memberof Odin.Mathf
 * returns random number between min and max
 * @param Number min
 * @param Number max
 * @return Number
 */
Mathf.prototype.randInt = function (min, max) {

    return floor(min + (random() * (max + 1 - min)));
};

/**
 * @method randFloat
 * @memberof Odin.Mathf
 * returns random number between min and max
 * @param Number min
 * @param Number max
 * @return Number
 */
Mathf.prototype.randFloat = function (min, max) {

    return min + (random() * (max - min));
};

/**
 * @method randSign
 * @memberof Odin.Mathf
 * returns either -1 or 1
 * @param Number min
 * @param Number max
 * @return Number
 */
Mathf.prototype.randSign = function () {

    return random() < 0.5 ? 1 : -1;
};

/**
 * @method randChoice
 * @memberof Odin.Mathf
 * returns random item from array
 * @param Array array
 * @return Number
 */
Mathf.prototype.randChoice = function (array) {

    return array[(random() * array.length) | 0.0];
};

/**
 * @method shuffle
 * @memberof Odin.Mathf
 * shuffles array
 * @param Array array
 * @return Array
 */
Mathf.prototype.shuffle = function (array) {

    for (var j, x, i = array.length; i; j = (random() * i) | 0.0, x = array[--i], array[i] = array[j], array[j] = x);
    return array;
};

/**
 * @method randArg
 * @memberof Odin.Mathf
 * returns random argument from arguments
 * @return Number
 */
Mathf.prototype.randArg = function () {

    return arguments[(random() * arguments.length) | 0.0];
};

/**
 * @method randChoiceObject
 * @memberof Odin.Mathf
 * returns random key from object
 * @param Object obj
 * @return Number
 */
Mathf.prototype.randChoiceObject = function (obj) {
    var array = keys(obj);

    return array[(random() * array.length) | 0.0];
};

/**
 * @method isPowerOfTwo
 * @memberof Odin.Mathf
 * checks if x is a power of 2
 * @param Number x
 * @return Number
 */
Mathf.prototype.isPowerOfTwo = function (x) {

    return (x & -x) === x;
};

/**
 * @method floorPowerOfTwo
 * @memberof Odin.Mathf
 * returns number's floor power of 2
 * @param Number x
 * @return Number
 */
Mathf.prototype.floorPowerOfTwo = function (x) {
    var i = 2,
        prev;

    while (i < x) {
        prev = i;
        i *= 2;
    }

    return prev;
};

/**
 * @method ceilPowerOfTwo
 * @memberof Odin.Mathf
 * returns number's ceil power of 2
 * @param Number x
 * @return Number
 */
Mathf.prototype.ceilPowerOfTwo = function (x) {
    var i = 2;

    while (i < x) {
        i *= 2;
    }

    return i;
};

/**
 * @method fromJSON
 * @memberof Odin.Mathf
 * returns Math class based on json _className
 * @param Object json
 * @return MATH_CLASS
 */
Mathf.prototype.fromJSON = function (json) {

    return new this._classes[json._className]().fromJSON(json);
};


/**
 * @method directionAngle
 * @memberof Odin.Mathf
 * returns direction string of an angle in radians
 * @param Number x
 * @param Number y
 * @return String
 */

var n225 = 0.39269908169872414,
    n675 = 1.1780972450961724,
    n1125 = 1.9634954084936207,
    n1575 = 2.748893571891069,
    n2025 = 3.5342917352885173,
    n2475 = 4.319689898685966,
    n2925 = 5.105088062083414,
    n3375 = 5.8904862254808625,

    RIGHT = "right",
    UP_RIGHT = "up_right",
    UP = "up",
    UP_LEFT = "up_left",
    LEFT = "left",
    DOWN_LEFT = "down_left",
    DOWN = "down",
    DOWN_RIGHT = "down_right";

Mathf.prototype.directionAngle = function (a) {
    a = standardRadian(a);

    if (a >= n3375 && a < n225) return RIGHT;
    if (a >= n225 && a < n675) return UP_RIGHT;
    if (a >= n675 && a < n1125) return UP;
    if (a >= n1125 && a < n1575) return UP_LEFT;
    if (a >= n1575 && a < n2025) return LEFT;
    if (a >= n2025 && a < n2475) return DOWN_LEFT;
    if (a >= n2475 && a < n2925) return DOWN;
    if (a >= n2925 && a < n3375) return DOWN_RIGHT;

    return RIGHT;
};

/**
 * @method direction
 * @memberof Odin.Mathf
 * returns direction string from an x and a y coordinate
 * @param Number x
 * @param Number y
 * @return String
 */
Mathf.prototype.direction = function (x, y) {
    var a = standardRadian(atan2(y, x));

    if (a >= n3375 && a < n225) return RIGHT;
    if (a >= n225 && a < n675) return UP_RIGHT;
    if (a >= n675 && a < n1125) return UP;
    if (a >= n1125 && a < n1575) return UP_LEFT;
    if (a >= n1575 && a < n2025) return LEFT;
    if (a >= n2025 && a < n2475) return DOWN_LEFT;
    if (a >= n2475 && a < n2925) return DOWN;
    if (a >= n2925 && a < n3375) return DOWN_RIGHT;

    return RIGHT;
};


module.exports = new Mathf;

},{}],108:[function(require,module,exports){
var Mathf = require("./mathf");
var Vec3 = require("./vec3");
"use strict";


var abs = Math.abs,
    sqrt = Math.sqrt,
    acos = Math.acos,
    sin = Math.sin,
    cos = Math.cos,
    EPSILON = Mathf.EPSILON;

/**
 * @class Quat
 * quaternion
 * @param Number x
 * @param Number y
 * @param Number z
 * @param Number w
 */
function Quat(x, y, z, w) {

    /**
     * @property Number x
     * @memberof Odin.Quat
     */
    this.x = x || 0.0;

    /**
     * @property Number y
     * @memberof Odin.Quat
     */
    this.y = y || 0.0;

    /**
     * @property Number z
     * @memberof Odin.Quat
     */
    this.z = z || 0.0;

    /**
     * @property Number w
     * @memberof Odin.Quat
     */
    this.w = w != undefined ? w : 1.0;
}

Mathf._classes["Quat"] = Quat;

/**
 * @method clone
 * @memberof Odin.Quat
 * returns new instance of this
 * @return Quat
 */
Quat.prototype.clone = function () {

    return new Quat(this.x, this.y, this.z, this.w);
};

/**
 * @method copy
 * @memberof Odin.Quat
 * copies other
 * @param Quat other
 * @return this
 */
Quat.prototype.copy = function (other) {

    this.x = other.x;
    this.y = other.y;
    this.z = other.z;
    this.w = other.w;

    return this;
};

/**
 * @method set
 * @memberof Odin.Quat
 * sets values of this
 * @param Number x
 * @param Number y
 * @param Number z
 * @param Number w
 * @return this
 */
Quat.prototype.set = function (x, y, z, w) {

    this.x = x;
    this.y = y;
    this.z = z;
    this.w = w;

    return this;
};

/**
 * @method mul
 * @memberof Odin.Quat
 * muliples this's values by other's
 * @param Quat other
 * @return this
 */
Quat.prototype.mul = function (other) {
    var ax = this.x,
        ay = this.y,
        az = this.z,
        aw = this.w,
        bx = other.x,
        by = other.y,
        bz = other.z,
        bw = other.w;

    this.x = ax * bw + aw * bx + ay * bz - az * by;
    this.y = ay * bw + aw * by + az * bx - ax * bz;
    this.z = az * bw + aw * bz + ax * by - ay * bx;
    this.w = aw * bw - ax * bx - ay * by - az * bz;

    return this;
};

/**
 * @method qmul
 * @memberof Odin.Quat
 * muliples a and b saves it in this
 * @param Quat a
 * @param Quat b
 * @return this
 */
Quat.prototype.qmul = function (a, b) {
    var ax = a.x,
        ay = a.y,
        az = a.z,
        aw = a.w,
        bx = b.x,
        by = b.y,
        bz = b.z,
        bw = b.w;

    this.x = ax * bw + aw * bx + ay * bz - az * by;
    this.y = ay * bw + aw * by + az * bx - ax * bz;
    this.z = az * bw + aw * bz + ax * by - ay * bx;
    this.w = aw * bw - ax * bx - ay * by - az * bz;

    return this;
};

/**
 * @method div
 * @memberof Odin.Quat
 * divides this's values by other's
 * @param Quat other
 * @return this
 */
Quat.prototype.div = function (other) {
    var ax = this.x,
        ay = this.y,
        az = this.z,
        aw = this.w,
        bx = -other.x,
        by = -other.y,
        bz = -other.z,
        bw = other.w;

    this.x = ax * bw + aw * bx + ay * bz - az * by;
    this.y = ay * bw + aw * by + az * bx - ax * bz;
    this.z = az * bw + aw * bz + ax * by - ay * bx;
    this.w = aw * bw - ax * bx - ay * by - az * bz;

    return this;
};

/**
 * @method qdiv
 * @memberof Odin.Quat
 * divides b from a saves it in this
 * @param Quat a
 * @param Quat b
 * @return this
 */
Quat.prototype.qdiv = function (a, b) {
    var ax = a.x,
        ay = a.y,
        az = a.z,
        aw = a.w,
        bx = -b.x,
        by = -b.y,
        bz = -b.z,
        bw = b.w;

    this.x = ax * bw + aw * bx + ay * bz - az * by;
    this.y = ay * bw + aw * by + az * bx - ax * bz;
    this.z = az * bw + aw * bz + ax * by - ay * bx;
    this.w = aw * bw - ax * bx - ay * by - az * bz;

    return this;
};

/**
 * @method length
 * @memberof Odin.Quat
 * returns the length of this
 * @return Number
 */
Quat.prototype.length = function () {
    var x = this.x,
        y = this.y,
        z = this.z,
        w = this.w,
        lsq = x * x + y * y + z * z + w * w;

    return lsq > 0.0 ? sqrt(lsq) : 0.0;
};

/**
 * @method lengthSq
 * @memberof Odin.Quat
 * returns the squared length of this
 * @return Number
 */
Quat.prototype.lengthSq = function () {
    var x = this.x,
        y = this.y,
        z = this.z,
        w = this.w;

    return x * x + y * y + z * z + w * w;
};

/**
 * @method normalize
 * @memberof Odin.Quat
 * returns this with a length of 1
 * @return this
 */
Quat.prototype.normalize = function () {
    var x = this.x,
        y = this.y,
        z = this.z,
        w = this.w,
        l = x * x + y * y + z * z + w * w;

    l = l > 0.0 ? 1.0 / sqrt(l) : 0.0;

    this.x *= l;
    this.y *= l;
    this.z *= l;
    this.w *= l;

    return this;
};

/**
 * @method inverse
 * @memberof Odin.Quat
 * returns the inverse of this
 * @return this
 */
Quat.prototype.inverse = function () {
    var x = this.x,
        y = this.y,
        z = this.z,
        w = this.w,
        d = x * x + y * y + z * z + w * w,
        invD = d > 0.0 ? 1.0 / d : 0.0;

    this.x *= -invD;
    this.y *= -invD;
    this.z *= -invD;
    this.w *= invD;

    return this;
};

/**
 * @method inverseQuat
 * @memberof Odin.Quat
 * returns the inverse of other
 * @param Quat other
 * @return this
 */
Quat.prototype.inverseQuat = function (other) {
    var x = other.x,
        y = other.y,
        z = other.z,
        w = other.w,
        d = x * x + y * y + z * z + w * w,
        invD = d > 0.0 ? 1.0 / d : 0.0;

    this.x = -x * invD;
    this.y = -y * invD;
    this.z = -z * invD;
    this.w = w * invD;

    return this;
};

/**
 * @method conjugate
 * @memberof Odin.Quat
 * this faster than inverse, if quat is normalized and produces the same result
 * @return this
 */
Quat.prototype.conjugate = function () {

    this.x = -this.x;
    this.y = -this.y;
    this.z = -this.z;

    return this;
};

/**
 * @method calculateW
 * @memberof Odin.Quat
 * calculates w component of quat
 * @return this
 */
Quat.prototype.calculateW = function () {
    var x = this.x,
        y = this.y,
        z = this.z;

    this.w = -sqrt(abs(1 - x * x - y * y - z * z));

    return this;
};

/**
 * @method lerp
 * @memberof Odin.Quat
 * linear interpolation between this and other by x
 * @param Quat other
 * @param Number x
 * @return this
 */
Quat.prototype.lerp = function (other, x) {

    this.x += (other.x - this.x) * x;
    this.y += (other.y - this.y) * x;
    this.z += (other.z - this.z) * x;
    this.w += (other.w - this.w) * x;

    return this;
};

/**
 * @method qlerp
 * @memberof Odin.Quat
 * linear interpolation between a and b by x
 * @param Quat a
 * @param Quat b
 * @param Number x
 * @return this
 */
Quat.prototype.qlerp = function (a, b, x) {
    var ax = a.x,
        ay = a.y,
        az = a.z,
        aw = a.w;

    this.x = ax + (b.x - ax) * x;
    this.y = ay + (b.y - ay) * x;
    this.z = az + (b.z - az) * x;
    this.w = aw + (b.w - aw) * x;

    return this;
};

/**
 * @method nlerp
 * @memberof Odin.Quat
 * faster but less accurate than slerp
 * @param Quat other
 * @param Number x
 * @return this
 */
Quat.prototype.nlerp = function (other, x) {

    this.x += (other.x - this.x) * x;
    this.y += (other.y - this.y) * x;
    this.z += (other.z - this.z) * x;
    this.w += (other.w - this.w) * x;

    return this.normalize();
};

/**
 * @method qnlerp
 * @memberof Odin.Quat
 * faster but less accurate than qslerp
 * @param Quat a
 * @param Quat b
 * @param Number x
 * @return this
 */
Quat.prototype.qnlerp = function (a, b, x) {
    var ax = a.x,
        ay = a.y,
        az = a.z,
        aw = a.w;

    this.x = ax + (b.x - ax) * x;
    this.y = ay + (b.y - ay) * x;
    this.z = az + (b.z - az) * x;
    this.w = aw + (b.w - aw) * x;

    return this.normalize();
};

/**
 * @method slerp
 * @memberof Odin.Quat
 * spherical linear Interpolation of this and other by x
 * @param Quat other
 * @param Number x
 * @return this
 */
Quat.prototype.slerp = function (other, x) {
    var ax = this.x,
        ay = this.y,
        az = this.z,
        aw = this.w,
        bx = other.x,
        by = other.y,
        bz = other.z,
        bw = other.w,

        omega, sinom, scale0, scale1,
        cosom = ax * bx + ay * by + az * bz + aw * bw;

    if (cosom < 0.0) {
        cosom *= -1;
        bx *= -1;
        by *= -1;
        bz *= -1;
        bw *= -1;
    }

    if (1 - cosom > EPSILON) {
        omega = acos(cosom);
        sinom = 1 / sin(omega);
        scale0 = sin((1 - x) * omega) * sinom;
        scale1 = sin(x * omega) * sinom;
    } else {
        scale0 = 1 - x;
        scale1 = x;
    }

    this.x = scale0 * ax + scale1 * bx;
    this.y = scale0 * ay + scale1 * by;
    this.z = scale0 * az + scale1 * bz;
    this.w = scale0 * aw + scale1 * bw;

    return this;
};

/**
 * @method qslerp
 * @memberof Odin.Quat
 * spherical linear Interpolation between a and b by x
 * @param Quat a
 * @param Quat b
 * @param Number x
 * @return this
 */
Quat.prototype.qslerp = function (a, b, x) {
    var ax = a.x,
        ay = a.y,
        az = a.z,
        aw = a.w,
        bx = b.x,
        by = b.y,
        bz = b.z,
        bw = b.w,

        omega, sinom, scale0, scale1,
        cosom = ax * bx + ay * by + az * bz + aw * bw;

    if (cosom < 0.0) {
        cosom *= -1;
        bx *= -1;
        by *= -1;
        bz *= -1;
        bw *= -1;
    }

    if (1 - cosom > EPSILON) {
        omega = acos(cosom);
        sinom = 1 / sin(omega);
        scale0 = sin((1 - x) * omega) * sinom;
        scale1 = sin(x * omega) * sinom;
    } else {
        scale0 = 1 - x;
        scale1 = x;
    }

    this.x = scale0 * ax + scale1 * bx;
    this.y = scale0 * ay + scale1 * by;
    this.z = scale0 * az + scale1 * bz;
    this.w = scale0 * aw + scale1 * bw;

    return this;
};

/**
 * @method qdot
 * @memberof Odin.Quat
 * dot product of two quats, can be called as a static function Quat.qdot( a, b )
 * @param Quat a
 * @param Quat b
 * @return Number
 */
Quat.qdot = Quat.prototype.qdot = function (a, b) {

    return a.x * b.x + a.y * b.y + a.z * b.z + a.w * b.w;
};

/**
 * @method dot
 * @memberof Odin.Quat
 * dot product of this and other
 * @param Quat other
 * @return Number
 */
Quat.prototype.dot = function (other) {

    return this.x * other.x + this.y * other.y + this.z * other.z + this.w * other.w;
};

/**
 * @method rotationX
 * @memberof Odin.Quat
 * gets quat's x rotation as an eular angle
 * @param Number angle
 * @return this
 */
Quat.prototype.rotationX = function () {
    var w = this.w;

    return this.x / sqrt(1 - (w * w));
};

/**
 * @method rotationY
 * @memberof Odin.Quat
 * gets quat's y rotation as an eular angle
 * @param Number angle
 * @return this
 */
Quat.prototype.rotationY = function () {
    var w = this.w;

    return this.y / sqrt(1 - (w * w));
};

/**
 * @method rotationZ
 * @memberof Odin.Quat
 * gets quat's z rotation as an eular angle
 * @param Number angle
 * @return this
 */
Quat.prototype.rotationZ = function () {
    var w = this.w;

    return this.z / sqrt(1 - (w * w));
};

/**
 * @method rotateX
 * @memberof Odin.Quat
 * sets quat's x rotation
 * @param Number angle
 * @return this
 */
Quat.prototype.rotateX = function (angle) {
    var halfAngle = angle * 0.5,
        x = this.x,
        y = this.y,
        z = this.z,
        w = this.w,
        s = sin(halfAngle),
        c = cos(halfAngle);

    this.x = x * c + w * s;
    this.y = y * c + z * s;
    this.z = z * c - y * s;
    this.w = w * c - x * s;

    return this;
};

/**
 * @method rotateY
 * @memberof Odin.Quat
 * sets quat's y rotation
 * @param Number angle
 * @return this
 */
Quat.prototype.rotateY = function (angle) {
    var halfAngle = angle * 0.5,
        x = this.x,
        y = this.y,
        z = this.z,
        w = this.w,
        s = sin(halfAngle),
        c = cos(halfAngle);

    this.x = x * c - z * s;
    this.y = y * c + w * s;
    this.z = z * c + x * s;
    this.w = w * c - y * s;

    return this;
};

/**
 * @method rotateZ
 * @memberof Odin.Quat
 * sets quat's z rotation
 * @param Number angle
 * @return this
 */
Quat.prototype.rotateZ = function (angle) {
    var halfAngle = angle * 0.5,
        x = this.x,
        y = this.y,
        z = this.z,
        w = this.w,
        s = sin(halfAngle),
        c = cos(halfAngle);

    this.x = x * c + y * s;
    this.y = y * c - x * s;
    this.z = z * c + w * s;
    this.w = w * c - z * s;

    return this;
};

/**
 * @method rotate
 * @memberof Odin.Quat
 * rotates quat by z then x then y in that order
 * @param Number x
 * @param Number y
 * @param Number z
 * @return this
 */
Quat.prototype.rotate = function (x, y, z) {

    this.rotateZ(z);
    this.rotateX(x);
    this.rotateY(y);

    return this;
};

/**
 * @method lookRotation
 * @memberof Odin.Quat
 * creates a rotation with the specified forward and upwards directions
 * @param Vec3 forward
 * @param Vec3 up
 * @return this
 */
Quat.prototype.lookRotation = function (forward, up) {
    var fx = forward.x,
        fy = forward.y,
        fz = forward.z,
        ux = up.x,
        uy = up.y,
        uz = up.z,

        ax = uy * fz - uz * fy,
        ay = uz * fx - ux * fz,
        az = ux * fy - uy * fx,

        d = (1.0 + ux * fx + uy * fy + uz * fz) * 2.0,
        dsq = d * d,
        s = 1.0 / dsq;

    this.x = ax * s;
    this.y = ay * s;
    this.z = az * s;
    this.w = dsq * 0.5;

    return this;
};

/**
 * @method fromAxisAngle
 * @memberof Odin.Quat
 * sets quat from axis and angle
 * @param Vec3 axis
 * @param Number angle
 * @return this
 */
Quat.prototype.fromAxisAngle = function (axis, angle) {
    var halfAngle = angle * 0.5,
        s = sin(halfAngle);

    this.x = axis.x * s;
    this.y = axis.y * s;
    this.z = axis.z * s;
    this.w = cos(halfAngle);

    return this;
};

/**
 * @method fromVec3s
 * @memberof Odin.Quat
 * sets quat from two vectors
 * @param Vec3 u
 * @param Vec3 v
 * @return this
 */
Quat.prototype.fromVec3s = function () {
    var a = new Vec3;

    return function (u, v) {
        a.vcross(u, v);

        this.x = a.x;
        this.y = a.y;
        this.z = a.z;
        this.w = sqrt(u.lengthSq() * v.lengthSq()) + u.dot(v);

        return this.normalize();
    };
}();

/**
 * @method fromMat3
 * @memberof Odin.Quat
 * sets values from Mat3
 * @param Mat3 m
 * @return this
 */
Quat.prototype.fromMat3 = function (m) {
    var te = m.elements,
        m11 = te[0],
        m12 = te[3],
        m13 = te[6],
        m21 = te[1],
        m22 = te[4],
        m23 = te[7],
        m31 = te[2],
        m32 = te[5],
        m33 = te[8],
        trace = m11 + m22 + m33,
        s, invS;

    if (trace > 0.0) {
        s = 0.5 / sqrt(trace + 1.0);

        this.w = 0.25 / s;
        this.x = (m32 - m23) * s;
        this.y = (m13 - m31) * s;
        this.z = (m21 - m12) * s;
    } else if (m11 > m22 && m11 > m33) {
        s = 2.0 * sqrt(1.0 + m11 - m22 - m33);
        invS = 1.0 / s;

        this.w = (m32 - m23) * invS;
        this.x = 0.25 * s;
        this.y = (m12 + m21) * invS;
        this.z = (m13 + m31) * invS;
    } else if (m22 > m33) {
        s = 2.0 * sqrt(1.0 + m22 - m11 - m33);
        invS = 1.0 / s;

        this.w = (m13 - m31) * invS;
        this.x = (m12 + m21) * invS;
        this.y = 0.25 * s;
        this.z = (m23 + m32) * invS;
    } else {
        s = 2.0 * sqrt(1.0 + m33 - m11 - m22);
        invS = 1.0 / s;

        this.w = (m21 - m12) * invS;
        this.x = (m13 + m31) * invS;
        this.y = (m23 + m32) * invS;
        this.z = 0.25 * s;
    }

    return this;
};

/**
 * @method fromMat4
 * @memberof Odin.Quat
 * sets values from Mat4
 * @param Mat4 m
 * @return this
 */
Quat.prototype.fromMat4 = function (m) {
    var te = m.elements,
        m11 = te[0],
        m12 = te[4],
        m13 = te[8],
        m21 = te[1],
        m22 = te[5],
        m23 = te[9],
        m31 = te[2],
        m32 = te[6],
        m33 = te[10],
        trace = m11 + m22 + m33,
        s, invS;

    if (trace > 0.0) {
        s = 0.5 / sqrt(trace + 1);

        this.w = 0.25 / s;
        this.x = (m32 - m23) * s;
        this.y = (m13 - m31) * s;
        this.z = (m21 - m12) * s;
    } else if (m11 > m22 && m11 > m33) {
        s = 2.0 * sqrt(1.0 + m11 - m22 - m33);
        invS = 1.0 / s;

        this.w = (m32 - m23) * invS;
        this.x = 0.25 * s;
        this.y = (m12 + m21) * invS;
        this.z = (m13 + m31) * invS;
    } else if (m22 > m33) {
        s = 2.0 * sqrt(1.0 + m22 - m11 - m33);
        invS = 1.0 / s;

        this.w = (m13 - m31) * invS;
        this.x = (m12 + m21) * invS;
        this.y = 0.25 * s;
        this.z = (m23 + m32) * invS;
    } else {
        s = 2.0 * sqrt(1.0 + m33 - m11 - m22);
        invS = 1.0 / s;

        this.w = (m21 - m12) * invS;
        this.x = (m13 + m31) * invS;
        this.y = (m23 + m32) * invS;
        this.z = 0.25 * s;
    }

    return this;
};

/**
 * @method fromArray
 * @memberof Odin.Quat
 * sets values from array
 * @param Array array
 * @return this
 */
Quat.prototype.fromArray = function (array) {

    this.x = array[0];
    this.y = array[1];
    this.z = array[2];
    this.w = array[3];

    return this;
};

/**
 * @memberof Odin.Quat
 * @param Odin.Quat other
 * @return this
 */
Quat.prototype.equals = function (other) {

    return !(
    this.x !== other.x ||
    this.y !== other.y ||
    this.z !== other.z ||
    this.w !== other.w
    );
};

/**
 * @method fromJSON
 * @memberof Odin.Quat
 * sets values from JSON object
 * @param Object json
 * @return this
 */
Quat.prototype.fromJSON = function (json) {

    this.x = json.x;
    this.y = json.y;
    this.z = json.z;
    this.w = json.w;

    return this;
};

/**
 * @method toArray
 * @memberof Odin.Quat
 * returns array of this
 * @return Object
 */
Quat.prototype.toArray = function (array) {
    array || (array = []);

    array[0] = this.x;
    array[1] = this.y;
    array[2] = this.z;
    array[3] = this.w;

    return array;
};

/**
 * @method toJSON
 * @memberof Odin.Quat
 * returns json object of this
 * @return Object
 */
Quat.prototype.toJSON = function (json) {
    json || (json = {});

    json._className = "Quat";
    json.x = this.x;
    json.y = this.y;
    json.z = this.z;
    json.w = this.w;

    return json;
};

/**
 * @method toString
 * @memberof Odin.Quat
 * returns string of this
 * @return String
 */
Quat.prototype.toString = function () {

    return "Quat( " + this.x + ", " + this.y + ", " + this.z + ", " + this.w + " )";
};


module.exports = Quat;

},{"./mathf":107,"./vec3":112}],109:[function(require,module,exports){
"use strict";


var defineProperty = Object.defineProperty;


function Rect(x, y, width, height) {

    this._x = x || 0.0;
    this._y = y || 0.0;
    this._width = width || 0.0;
    this._height = height || 0.0;

    this._xMin = this._x;
    this._xMax = this._x + this._width;
    this._yMin = this._y;
    this._yMax = this._y + this._height;
}

defineProperty(Rect.prototype, "x", {
    get: function () {
        return this._x;
    },
    set: function (value) {
        this._x = value;
        this._xMin = value;
        this._xMax = value + this._width;
    }
});
defineProperty(Rect.prototype, "y", {
    get: function () {
        return this._y;
    },
    set: function (value) {
        this._y = value;
        this._yMin = value;
        this._yMax = value + this._height;
    }
});
defineProperty(Rect.prototype, "width", {
    get: function () {
        return this._width;
    },
    set: function (value) {
        this._width = value;
        this._xMax = this._xMin + value;
    }
});
defineProperty(Rect.prototype, "height", {
    get: function () {
        return this._height;
    },
    set: function (value) {
        this._height = value;
        this._yMax = this._yMin + value;
    }
});
defineProperty(Rect.prototype, "xMin", {
    get: function () {
        return this._xMin;
    },
    set: function (value) {
        this._xMin = value;
        this._x = value;
        this._width = this._xMax - this._xMin;
        this._xMax = value + this._width;
    }
});
defineProperty(Rect.prototype, "xMax", {
    get: function () {
        return this._xMax;
    },
    set: function (value) {
        this._xMax = value;
        this._width = value - this._xMin;
    }
});
defineProperty(Rect.prototype, "yMin", {
    get: function () {
        return this._yMin;
    },
    set: function (value) {
        this._yMin = value;
        this._y = value;
        this._height = this._yMax - this._yMin;
        this._yMax = value + this._height;
    }
});
defineProperty(Rect.prototype, "yMax", {
    get: function () {
        return this._yMax;
    },
    set: function (value) {
        this._yMax = value;
        this._height = value - this._yMin;
    }
});
defineProperty(Rect.prototype, "z", {
    get: function () {
        return this.width;
    },
    set: function (value) {
        this.width = value;
    }
});
defineProperty(Rect.prototype, "w", {
    get: function () {
        return this.height;
    },
    set: function (value) {
        this.height = value;
    }
});


Rect.prototype.clone = function () {

    return new Rect(this.x, this.y, this.width, this.height);
};


Rect.prototype.copy = function (other) {

    this._x = other._x;
    this._y = other._y;
    this._width = other._width;
    this._height = other._height;

    this._xMin = other._xMin;
    this._xMax = other._xMax;
    this._yMin = other._yMin;
    this._yMax = other._yMax;

    return this;
};


Rect.prototype.set = function (x, y, width, height) {

    this.x = x;
    this.y = y;
    this.width = width;
    this.height = height;

    return this;
};


Rect.prototype.center = function (v) {

    v.x = this._x + this._width * 0.5;
    v.y = this._y + this._height * 0.5;

    return v;
};


Rect.prototype.intersects = function (rect) {

    return !(
    rect._xMax < this._xMin || rect._xMin > this._xMax ||
    rect._yMax < this._yMin || rect._yMin > this._yMax
    );
};


Rect.prototype.contains = function (point) {
    var x = point.x,
        y = point.y;

    return !(
    x < this._xMin || x > this._xMax ||
    y < this._yMin || y > this._yMax
    );
};


Rect.prototype.toJSON = function (json) {
    json || (json = {});

    json.x = this._x;
    json.y = this._y;
    json.width = this._width;
    json.height = this._height;

    return json;
};


Rect.prototype.fromJSON = function (json) {

    this.x = json.x;
    this.y = json.y;
    this.width = json.width;
    this.height = json.height;

    return this;
};


Rect.prototype.toString = function () {

    return "Rect( " + this._x + ", " + this._y + ", " + this._width + ", " + this._height + " )";
};


module.exports = Rect;

},{}],110:[function(require,module,exports){
"use strict";


var defineProperty = Object.defineProperty;


function RectOffset(left, right, top, bottom) {

    this.left = left || 0.0;
    this.right = right || 0.0;
    this.top = top || 0.0;
    this.bottom = bottom || 0.0;
}


defineProperty(RectOffset.prototype, "horizontal", {
    get: function () {

        return this.left + this.right;
    }
});


defineProperty(RectOffset.prototype, "vertical", {
    get: function () {

        return this.top + this.bottom;
    }
});


RectOffset.prototype.clone = function () {

    return new RectOffset(this.left, this.right, this.top, this.bottom);
};


RectOffset.prototype.copy = function (other) {

    this.left = other.left;
    this.right = other.right;
    this.top = other.top;
    this.bottom = other.bottom;

    return this;
};


RectOffset.prototype.set = function (left, right, top, bottom) {

    this.left = left;
    this.right = right;
    this.top = top;
    this.bottom = bottom;

    return this;
};


RectOffset.prototype.add = function (rect) {

    rect.xMin -= this.left;
    rect.xMax += this.right;
    rect.yMin -= this.top;
    rect.yMax += this.bottom;

    return rect;
};


RectOffset.prototype.sub = function (rect) {

    rect.xMin += this.left;
    rect.xMax -= this.right;
    rect.yMin += this.top;
    rect.yMax -= this.bottom;

    return rect;
};


RectOffset.prototype.toJSON = function (json) {
    json || (json = {});

    json.left = this.left;
    json.right = this.right;
    json.top = this.top;
    json.bottom = this.bottom;

    return json;
};


RectOffset.prototype.fromJSON = function (json) {

    this.left = json.left;
    this.right = json.right;
    this.top = json.top;
    this.bottom = json.bottom;

    return this;
};


RectOffset.prototype.toString = function () {

    return "RectOffset( " + this.left + ", " + this.right + ", " + this.top + ", " + this.bottom + " )";
};


module.exports = RectOffset;

},{}],111:[function(require,module,exports){
var Mathf = require("./mathf");
"use strict";


var sqrt = Math.sqrt;

/**
 * @class Vec2
 * 2d vector
 * @param Number x
 * @param Number y
 */
function Vec2(x, y) {

    /**
     * @property Number x
     * @memberof Xian.Vec2
     */
    this.x = x || 0.0;

    /**
     * @property Number y
     * @memberof Xian.Vec2
     */
    this.y = y || 0.0;
}

Mathf._classes["Vec2"] = Vec2;

/**
 * @method clone
 * @memberof Xian.Vec2
 * returns new instance of this
 * @return Vec2
 */
Vec2.prototype.clone = function () {

    return new Vec2(this.x, this.y);
};

/**
 * @method copy
 * @memberof Xian.Vec2
 * copies other
 * @param Vec2 other
 * @return this
 */
Vec2.prototype.copy = function (other) {

    this.x = other.x;
    this.y = other.y;

    return this;
};

/**
 * @method set
 * @memberof Xian.Vec2
 * sets values of this
 * @param Number x
 * @param Number y
 * @return this
 */
Vec2.prototype.set = function (x, y) {

    this.x = x;
    this.y = y;

    return this;
};

/**
 * @method add
 * @memberof Xian.Vec2
 * adds other's values to this
 * @param Vec2 other
 * @return this
 */
Vec2.prototype.add = function (other) {

    this.x += other.x;
    this.y += other.y;

    return this;
};

/**
 * @method vadd
 * @memberof Xian.Vec2
 * adds a and b together saves it in this
 * @param Vec2 a
 * @param Vec2 b
 * @return this
 */
Vec2.prototype.vadd = function (a, b) {

    this.x = a.x + b.x;
    this.y = a.y + b.y;

    return this;
};

/**
 * @method sadd
 * @memberof Xian.Vec2
 * adds scalar value to this
 * @param Number s
 * @return this
 */
Vec2.prototype.sadd = function (s) {

    this.x += s;
    this.y += s;

    return this;
};

/**
 * @method sub
 * @memberof Xian.Vec2
 * subtracts other's values from this
 * @param Vec2 other
 * @return this
 */
Vec2.prototype.sub = function (other) {

    this.x -= other.x;
    this.y -= other.y;

    return this;
};

/**
 * @method vsub
 * @memberof Xian.Vec2
 * subtracts b from a saves it in this
 * @param Vec2 a
 * @param Vec2 b
 * @return this
 */
Vec2.prototype.vsub = function (a, b) {

    this.x = a.x - b.x;
    this.y = a.y - b.y;

    return this;
};

/**
 * @method ssub
 * @memberof Xian.Vec2
 * subtracts this by a scalar value
 * @param Number s
 * @return this
 */
Vec2.prototype.ssub = function (s) {

    this.x -= s;
    this.y -= s;

    return this;
};

/**
 * @method mul
 * @memberof Xian.Vec2
 * muliples this's values by other's
 * @param Vec2 other
 * @return this
 */
Vec2.prototype.mul = function (other) {

    this.x *= other.x;
    this.y *= other.y;

    return this;
};

/**
 * @method vmul
 * @memberof Xian.Vec2
 * muliples a and b saves it in this
 * @param Vec2 a
 * @param Vec2 b
 * @return this
 */
Vec2.prototype.vmul = function (a, b) {

    this.x = a.x * b.x;
    this.y = a.y * b.y;

    return this;
};

/**
 * @method smul
 * @memberof Xian.Vec2
 * muliples this by a scalar value
 * @param Number s
 * @return this
 */
Vec2.prototype.smul = function (s) {

    this.x *= s;
    this.y *= s;

    return this;
};

/**
 * @method div
 * @memberof Xian.Vec2
 * divides this's values by other's
 * @param Vec2 other
 * @return this
 */
Vec2.prototype.div = function (other) {
    var x = other.x,
        y = other.y;

    this.x *= x !== 0.0 ? 1.0 / x : 0.0;
    this.y *= y !== 0.0 ? 1.0 / y : 0.0;

    return this;
};

/**
 * @method vdiv
 * @memberof Xian.Vec2
 * divides b from a saves it in this
 * @param Vec2 a
 * @param Vec2 b
 * @return this
 */
Vec2.prototype.vdiv = function (a, b) {
    var x = b.x,
        y = b.y;

    this.x = x !== 0.0 ? a.x / x : 0.0;
    this.y = y !== 0.0 ? a.y / y : 0.0;

    return this;
};

/**
 * @method sdiv
 * @memberof Xian.Vec2
 * divides this by scalar value
 * @param Number s
 * @return this
 */
Vec2.prototype.sdiv = function (s) {
    s = s === 0.0 ? 0.0 : 1.0 / s;

    this.x *= s;
    this.y *= s;

    return this;
};

/**
 * @method length
 * @memberof Xian.Vec2
 * returns the length of this
 * @return Number
 */
Vec2.prototype.length = function () {
    var x = this.x,
        y = this.y,
        lsq = x * x + y * y;

    if (lsq === 1) return 1;

    return lsq > 0.0 ? sqrt(lsq) : 0.0;
};

/**
 * @method lengthSq
 * @memberof Xian.Vec2
 * returns the squared length of this
 * @return Number
 */
Vec2.prototype.lengthSq = function () {
    var x = this.x,
        y = this.y;

    return x * x + y * y;
};

/**
 * @method setLength
 * @memberof Xian.Vec2
 * sets this so its magnitude is equal to length
 * @param Number length
 * @return Vec2
 */
Vec2.prototype.setLength = function (length) {
    var x = this.x,
        y = this.y,
        l = x * x + y * y;

    if (l === 1) {
        this.x *= length;
        this.y *= length;

        return this;
    }

    l = l > 0.0 ? 1.0 / sqrt(l) : 0.0;

    this.x *= l * length;
    this.y *= l * length;

    return this;
};

/**
 * @method normalize
 * @memberof Xian.Vec2
 * returns this with a length of 1
 * @return this
 */
Vec2.prototype.normalize = function () {
    var x = this.x,
        y = this.y,
        l = x * x + y * y;

    if (l === 1) return this;

    l = l > 0.0 ? 1.0 / sqrt(l) : 0.0;

    this.x *= l;
    this.y *= l;

    return this;
};

/**
 * @method orthoNormalize
 * @memberof Xian.Vec2
 * returns makes vectors normalized and orthogonal to each other
 * @param Vec2 a
 * @param Vec2 b
 * @param Vec2 c
 * @return this
 */
Vec2.prototype.orthoNormalize = function (a, b, c) {
    if (a.lengthSq() !== 1.0) a.normalize();
    c.vcross(a, b);
    if (a.lengthSq() === 0.0) return;
    c.normalize();
    b.vcross(c, a);
};

/**
 * @method inverse
 * @memberof Xian.Vec2
 * returns the inverse of this
 * @return this
 */
Vec2.prototype.inverse = function () {

    this.x *= -1;
    this.y *= -1;

    return this;
};

/**
 * @method inverseVec
 * @memberof Xian.Vec2
 * returns the inverse of other
 * @param Vec2 other
 * @return this
 */
Vec2.prototype.inverseVec = function (other) {

    this.x = -other.x;
    this.y = -other.y;

    return this;
};

/**
 * @method lerp
 * @memberof Xian.Vec2
 * linear interpolation between this and other by x
 * @param Vec2 other
 * @param Number x
 * @return Vec2
 */
Vec2.prototype.lerp = function (other, x) {

    this.x += (other.x - this.x) * x;
    this.y += (other.y - this.y) * x;

    return this;
};

/**
 * @method vlerp
 * @memberof Xian.Vec2
 * linear interpolation between a and b by x
 * @param Vec2 a
 * @param Vec2 b
 * @param Number x
 * @return Vec2
 */
Vec2.prototype.vlerp = function (a, b, x) {
    var ax = a.x,
        ay = a.y;

    this.x = ax + (b.x - ax) * x;
    this.y = ay + (b.y - ay) * x;

    return this;
};

/**
 * @method vdot
 * @memberof Xian.Vec2
 * dot product of two vectors, can be called as a static function Vec2.vdot( a, b )
 * @param Vec2 a
 * @param Vec2 b
 * @return Number
 */
Vec2.vdot = Vec2.prototype.vdot = function (a, b) {

    return a.x * b.x + a.y * b.y;
};

/**
 * @method dot
 * @memberof Xian.Vec2
 * dot product of this and other vector
 * @param Vec2 other
 * @return Number
 */
Vec2.prototype.dot = function (other) {

    return this.x * other.x + this.y * other.y;
};

/**
 * @method vcross
 * @memberof Xian.Vec2
 * cross product between a vector and b vector, can be called as a static function Vec2.vcross( a, b )
 * @param Vec2 a
 * @param Vec2 b
 * @return Number
 */
Vec2.vcross = Vec2.prototype.vcross = function (a, b) {

    return a.x * b.y - a.y * b.x;
};

/**
 * @method cross
 * @memberof Xian.Vec2
 * cross product between this vector and other
 * @param Vec2 other
 * @return Number
 */
Vec2.prototype.cross = function (other) {

    return this.x * other.y - this.y * other.x;
};

/**
 * @method perp
 * @memberof Xian.Vec2
 * @param Vec2 other
 * @return Number
 */
Vec2.prototype.perp = function () {
    var x = this.x,
        y = this.y;

    this.x = -y;
    this.y = x;

    return this;
};

/**
 * @method min
 * @memberof Xian.Vec2
 * returns min values from this and other vector
 * @param Vec2 other
 * @return this
 */
Vec2.prototype.min = function (other) {
    var ax = this.x,
        ay = this.y,
        bx = other.x,
        by = other.y;

    this.x = bx < ax ? bx : ax;
    this.y = by < ay ? by : ay;

    return this;
};

/**
 * @method max
 * @memberof Xian.Vec2
 * returns max values from this and other vector
 * @param Vec2 other
 * @return this
 */
Vec2.prototype.max = function (other) {
    var ax = this.x,
        ay = this.y,
        bx = other.x,
        by = other.y;

    this.x = bx > ax ? bx : ax;
    this.y = by > ay ? by : ay;

    return this;
};

/**
 * @method clamp
 * @memberof Xian.Vec2
 * clamp values between min and max's values
 * @param Vec2 min
 * @param Vec2 max
 * @return this
 */
Vec2.prototype.clamp = function (min, max) {
    var x = this.x,
        y = this.y,
        minx = min.x,
        miny = min.y,
        maxx = max.x,
        maxy = max.y;

    this.x = x < minx ? minx : x > maxx ? maxx : x;
    this.y = y < miny ? miny : y > maxy ? maxy : y;

    return this;
};

/**
 * @method transformAngle
 * @memberof Xian.Vec2
 * transforms this with angle
 * @param Mat2 m
 * @return this
 */
Vec2.prototype.transformAngle = function (a) {
    var x = this.x,
        y = this.y,
        c = cos(a),
        s = sin(a);

    this.x = x * c - y * s;
    this.y = x * s + y * c;

    return this;
};

/**
 * @method transformMat2
 * @memberof Xian.Vec2
 * transforms this with Mat2
 * @param Mat2 m
 * @return this
 */
Vec2.prototype.transformMat2 = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y;

    this.x = x * me[0] + y * me[2];
    this.y = x * me[1] + y * me[3];

    return this;
};

/**
 * @method untransformMat2
 * @memberof Xian.Vec2
 * untransforms this with Mat2
 * @param Mat2 m
 * @return this
 */
Vec2.prototype.untransformMat2 = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y;

    this.x = x * me[0] + y * me[1];
    this.y = x * me[2] + y * me[3];

    return this;
};

/**
 * @method transformMat32
 * @memberof Xian.Vec2
 * transforms this with Mat32
 * @param Mat32 m
 * @return this
 */
Vec2.prototype.transformMat32 = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y;

    this.x = x * me[0] + y * me[2] + me[4];
    this.y = x * me[1] + y * me[3] + me[5];

    return this;
};

/**
 * @method untransformMat32
 * @memberof Xian.Vec2
 * untransforms this with Mat32
 * @param Mat32 m
 * @return this
 */
Vec2.prototype.untransformMat32 = function (m) {
    var me = m.elements,
        x = this.x - me[4],
        y = this.y - me[5];

    this.x = x * me[0] + y * me[1];
    this.y = x * me[2] + y * me[3];

    return this;
};

/**
 * @method transformMat3
 * @memberof Xian.Vec2
 * transforms this with Mat3
 * @param Mat3 m
 * @return this
 */
Vec2.prototype.transformMat3 = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y;

    this.x = x * me[0] + y * me[3] + me[6];
    this.y = x * me[1] + y * me[4] + me[7];

    return this;
};

/**
 * @method transformMat4
 * @memberof Xian.Vec2
 * transforms this with Mat4
 * @param Mat4 m
 * @return this
 */
Vec2.prototype.transformMat4 = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y;

    this.x = x * me[0] + y * me[4] + me[12];
    this.y = x * me[1] + y * me[5] + me[13];

    return this;
};

/**
 * @method transformProjection
 * @memberof Xian.Vec3
 * transforms this with Mat4 projection matrix
 * @param Mat4 m
 * @return this
 */
Vec2.prototype.transformProjection = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y,
        d = 1 / (me[3] * x + me[7] * y + me[11] * z + me[15]);

    this.x = (me[0] * x + me[4] * y + me[12]) * d;
    this.y = (me[1] * x + me[5] * y + me[13]) * d;

    return this;
};

/**
 * @method fromVec3
 * @memberof Xian.Vec2
 * sets values from Vec3
 * @param Vec3 v
 * @return this
 */
Vec2.prototype.fromVec3 = function (v) {

    this.x = v.x;
    this.y = v.y;

    return this;
};

/**
 * @method fromVec4
 * @memberof Xian.Vec2
 * sets values from Vec4
 * @param Vec4 v
 * @return this
 */
Vec2.prototype.fromVec4 = function (v) {

    this.x = v.x;
    this.y = v.y;

    return this;
};

/**
 * @method positionFromMat32
 * @memberof Xian.Vec2
 * sets position from Mat32
 * @param Mat32 m
 * @return this
 */
Vec2.prototype.positionFromMat32 = function (m) {
    var me = m.elements;

    this.x = me[4];
    this.y = me[5];

    return this;
};

/**
 * @method positionFromMat4
 * @memberof Xian.Vec2
 * sets position from Mat4
 * @param Mat4 m
 * @return this
 */
Vec2.prototype.positionFromMat4 = function (m) {
    var me = m.elements;

    this.x = me[12];
    this.y = me[13];

    return this;
};

/**
 * @method scaleFromMat2
 * @memberof Xian.Vec2
 * sets this from Mat2 scale
 * @param Mat2 m
 * @return this
 */
Vec2.prototype.scaleFromMat2 = function (m) {
    var me = m.elements,
        x = this.set(me[0], m[2]).length(),
        y = this.set(me[1], m[3]).length();

    this.x = x;
    this.y = y;

    return this;
};

/**
 * @method scaleFromMat32
 * @memberof Xian.Vec2
 * sets this from Mat32 scale
 * @param Mat32 m
 * @return this
 */
Vec2.prototype.scaleFromMat32 = Vec2.prototype.scaleFromMat2;

/**
 * @memberof Xian.Vec2
 * @param Xian.Vec2 other
 * @return this
 */
Vec2.prototype.equals = function (other) {

    return !(
    this.x !== other.x ||
    this.y !== other.y
    );
};

/**
 * @memberof Xian.Vec2
 * @param Xian.Vec2 other
 * @return this
 */
Vec2.prototype.notEquals = function (other) {

    return (
    this.x !== other.x ||
    this.y !== other.y
    );
};

/**
 * @method fromJSON
 * @memberof Xian.Vec2
 * sets values from JSON object
 * @param Object json
 * @return this
 */
Vec2.prototype.fromJSON = function (json) {

    this.x = json.x;
    this.y = json.y;

    return this;
};

/**
 * @method toJSON
 * @memberof Xian.Vec2
 * returns json object of this
 * @return Object
 */
Vec2.prototype.toJSON = function (json) {
    json || (json = {});

    json._className = "Vec2";
    json.x = this.x;
    json.y = this.y;

    return json;
};

/**
 * @method fromArray
 * @memberof Xian.Vec2
 * sets values from Array object
 * @param Array array
 * @return this
 */
Vec2.prototype.fromArray = function (array) {

    this.x = array[0];
    this.y = array[1];

    return this;
};

/**
 * @method toArray
 * @memberof Xian.Vec2
 * returns array object of this
 * @return Array
 */
Vec2.prototype.toArray = function (array) {
    array || (array = []);

    array[0] = this.x;
    array[1] = this.y;

    return array;
};

/**
 * @method toString
 * @memberof Xian.Vec2
 * returns string of this
 * @return String
 */
Vec2.prototype.toString = function () {

    return "Vec2( " + this.x + ", " + this.y + " )";
};


module.exports = Vec2;

},{"./mathf":107}],112:[function(require,module,exports){
var Mathf = require("./mathf");
"use strict";


var sqrt = Math.sqrt;

/**
 * @class Vec3
 * 3d vector
 * @param Number x
 * @param Number y
 * @param Number z
 */
function Vec3(x, y, z) {

    /**
     * @property Number x
     * @memberof Odin.Vec3
     */
    this.x = x || 0.0;

    /**
     * @property Number y
     * @memberof Odin.Vec3
     */
    this.y = y || 0.0;

    /**
     * @property Number z
     * @memberof Odin.Vec3
     */
    this.z = z || 0.0;
}

Mathf._classes["Vec3"] = Vec3;

/**
 * @method clone
 * @memberof Odin.Vec3
 * returns new instance of this
 * @return Vec3
 */
Vec3.prototype.clone = function () {

    return new Vec3(this.x, this.y, this.z);
};

/**
 * @method copy
 * @memberof Odin.Vec3
 * copies other
 * @param Vec3 other
 * @return this
 */
Vec3.prototype.copy = function (other) {

    this.x = other.x;
    this.y = other.y;
    this.z = other.z;

    return this;
};

/**
 * @method set
 * @memberof Odin.Vec3
 * sets values of this
 * @param Number x
 * @param Number y
 * @param Number z
 * @return this
 */
Vec3.prototype.set = function (x, y, z) {

    this.x = x;
    this.y = y;
    this.z = z;

    return this;
};

/**
 * @method add
 * @memberof Odin.Vec3
 * adds other's values to this
 * @param Vec3 other
 * @return this
 */
Vec3.prototype.add = function (other) {

    this.x += other.x;
    this.y += other.y;
    this.z += other.z;

    return this;
};

/**
 * @method vadd
 * @memberof Odin.Vec3
 * adds a and b together saves it in this
 * @param Vec3 a
 * @param Vec3 b
 * @return this
 */
Vec3.prototype.vadd = function (a, b) {

    this.x = a.x + b.x;
    this.y = a.y + b.y;
    this.z = a.z + b.z;

    return this;
};

/**
 * @method sadd
 * @memberof Odin.Vec3
 * adds scalar value to this
 * @param Number s
 * @return this
 */
Vec3.prototype.sadd = function (s) {

    this.x += s;
    this.y += s;
    this.z += s;

    return this;
};

/**
 * @method sub
 * @memberof Odin.Vec3
 * subtracts other's values from this
 * @param Vec3 other
 * @return this
 */
Vec3.prototype.sub = function (other) {

    this.x -= other.x;
    this.y -= other.y;
    this.z -= other.z;

    return this;
};

/**
 * @method vsub
 * @memberof Odin.Vec3
 * subtracts b from a saves it in this
 * @param Vec3 a
 * @param Vec3 b
 * @return this
 */
Vec3.prototype.vsub = function (a, b) {

    this.x = a.x - b.x;
    this.y = a.y - b.y;
    this.z = a.z - b.z;

    return this;
};

/**
 * @method ssub
 * @memberof Odin.Vec3
 * subtracts this by a scalar value
 * @param Number s
 * @return this
 */
Vec3.prototype.ssub = function (s) {

    this.x -= s;
    this.y -= s;
    this.z -= s;

    return this;
};

/**
 * @method mul
 * @memberof Odin.Vec3
 * muliples this's values by other's
 * @param Vec3 other
 * @return this
 */
Vec3.prototype.mul = function (other) {

    this.x *= other.x;
    this.y *= other.y;
    this.z *= other.z;

    return this;
};

/**
 * @method vmul
 * @memberof Odin.Vec3
 * muliples a and b saves it in this
 * @param Vec3 a
 * @param Vec3 b
 * @return this
 */
Vec3.prototype.vmul = function (a, b) {

    this.x = a.x * b.x;
    this.y = a.y * b.y;
    this.z = a.z * b.z;

    return this;
};

/**
 * @method smul
 * @memberof Odin.Vec3
 * muliples this by a scalar value
 * @param Number s
 * @return this
 */
Vec3.prototype.smul = function (s) {

    this.x *= s;
    this.y *= s;
    this.z *= s;

    return this;
};

/**
 * @method div
 * @memberof Odin.Vec3
 * divides this's values by other's
 * @param Vec3 other
 * @return this
 */
Vec3.prototype.div = function (other) {
    var x = other.x,
        y = other.y,
        z = other.z;

    this.x *= x !== 0.0 ? 1.0 / x : 0.0;
    this.y *= y !== 0.0 ? 1.0 / y : 0.0;
    this.z *= z !== 0.0 ? 1.0 / z : 0.0;

    return this;
};

/**
 * @method vdiv
 * @memberof Odin.Vec3
 * divides b from a saves it in this
 * @param Vec3 a
 * @param Vec3 b
 * @return this
 */
Vec3.prototype.vdiv = function (a, b) {
    var x = b.x,
        y = b.y,
        z = b.z;

    this.x = x !== 0.0 ? a.x / x : 0.0;
    this.y = y !== 0.0 ? a.y / y : 0.0;
    this.z = z !== 0.0 ? a.z / z : 0.0;

    return this;
};

/**
 * @method sdiv
 * @memberof Odin.Vec3
 * divides this by scalar value
 * @param Number s
 * @return this
 */
Vec3.prototype.sdiv = function (s) {
    s = s === 0.0 ? 0.0 : 1.0 / s;

    this.x *= s;
    this.y *= s;
    this.z *= s;

    return this;
};

/**
 * @method length
 * @memberof Odin.Vec3
 * returns the length of this
 * @return Number
 */
Vec3.prototype.length = function () {
    var x = this.x,
        y = this.y,
        z = this.z,
        lsq = x * x + y * y + z * z;

    if (lsq === 1) return 1;

    return lsq === 0.0 ? 0.0 : sqrt(lsq);
};

/**
 * @method lengthSq
 * @memberof Odin.Vec3
 * returns the squared length of this
 * @return Number
 */
Vec3.prototype.lengthSq = function () {
    var x = this.x,
        y = this.y,
        z = this.z;

    return x * x + y * y + z * z;
};

/**
 * @method setLength
 * @memberof Odin.Vec3
 * sets this so its magnitude is equal to length
 * @param Number length
 * @return Vec3
 */
Vec3.prototype.setLength = function (length) {
    var x = this.x,
        y = this.y,
        z = this.z,
        l = x * x + y * y + z * z;

    if (l === 1) {
        this.x *= length;
        this.y *= length;
        this.z *= length;

        return this;
    }

    l = l > 0.0 ? 1.0 / sqrt(l) : 0.0;

    this.x *= l * length;
    this.y *= l * length;
    this.z *= l * length;

    return this;
};

/**
 * @method normalize
 * @memberof Odin.Vec3
 * returns this with a length of 1
 * @return this
 */
Vec3.prototype.normalize = function () {
    var x = this.x,
        y = this.y,
        z = this.z,
        l = x * x + y * y + z * z;

    if (l === 1) return this;

    l = l > 0.0 ? 1.0 / sqrt(l) : 0.0;

    this.x *= l;
    this.y *= l;
    this.z *= l;

    return this;
};

/**
 * @method orthoNormalize
 * @memberof Odin.Vec3
 * returns makes vectors normalized and orthogonal to each other
 * @param Vec3 a
 * @param Vec3 b
 * @param Vec3 c
 * @return this
 */
Vec3.prototype.orthoNormalize = function (a, b, c) {
    if (a.lengthSq() !== 1.0) a.normalize();
    c.vcross(a, b);
    if (a.lengthSq() === 0.0) return;
    c.normalize();
    b.vcross(c, a);
};

/**
 * @method inverse
 * @memberof Odin.Vec3
 * returns the inverse of this
 * @return this
 */
Vec3.prototype.inverse = function () {

    this.x *= -1;
    this.y *= -1;
    this.z *= -1;

    return this;
};

/**
 * @method inverseVec
 * @memberof Odin.Vec3
 * returns the inverse of other
 * @param Vec3 other
 * @return this
 */
Vec3.prototype.inverseVec = function (other) {

    this.x = -other.x;
    this.y = -other.y;
    this.z = -(other.z || 0);

    return this;
};

/**
 * @method lerp
 * @memberof Odin.Vec3
 * linear interpolation between this and other by x
 * @param Vec3 other
 * @param Number x
 * @return Vec3
 */
Vec3.prototype.lerp = function (other, x) {

    this.x += (other.x - this.x) * x;
    this.y += (other.y - this.y) * x;
    this.z += (other.z - this.z) * x;

    return this;
};

/**
 * @method vlerp
 * @memberof Odin.Vec3
 * linear interpolation between a and b by x
 * @param Vec3 a
 * @param Vec3 b
 * @param Number x
 * @return Vec3
 */
Vec3.prototype.vlerp = function (a, b, x) {
    var ax = a.x,
        ay = a.y,
        az = a.z;

    this.x = ax + (b.x - ax) * x;
    this.y = ay + (b.y - ay) * x;
    this.z = az + (b.z - az) * x;

    return this;
};

/**
 * @method vdot
 * @memberof Odin.Vec3
 * dot product of two vectors, can be called as a static function Vec3.vdot( a, b )
 * @param Vec3 a
 * @param Vec3 b
 * @return Number
 */
Vec3.vdot = Vec3.prototype.vdot = function (a, b) {

    return a.x * b.x + a.y * b.y + a.z * b.z;
};

/**
 * @method dot
 * @memberof Odin.Vec3
 * dot product of this and other vector
 * @param Vec3 other
 * @return Number
 */
Vec3.prototype.dot = function (other) {

    return this.x * other.x + this.y * other.y + this.z * other.z;
};

/**
 * @method vcross
 * @memberof Odin.Vec3
 * cross product between a vector and b vector, can be called as a static function Vec3.vcross( a, b )
 * @param Vec3 a
 * @param Vec3 b
 * @return Number
 */
Vec3.vcross = Vec3.prototype.vcross = function (a, b) {
    var ax = a.x,
        ay = a.y,
        az = a.z,
        bx = b.x,
        by = b.y,
        bz = b.z;

    this.x = ay * bz - az * by;
    this.y = az * bx - ax * bz;
    this.z = ax * by - ay * bx;

    return this;
};

/**
 * @method cross
 * @memberof Odin.Vec3
 * cross product between this vector and other
 * @param Vec3 other
 * @return Number
 */
Vec3.prototype.cross = function (other) {
    var ax = this.x,
        ay = this.y,
        az = this.z,
        bx = other.x,
        by = other.y,
        bz = other.z;

    this.x = ay * bz - az * by;
    this.y = az * bx - ax * bz;
    this.z = ax * by - ay * bx;

    return this;
};

/**
 * @method min
 * @memberof Odin.Vec3
 * returns min values from this and other vector
 * @param Vec3 other
 * @return this
 */
Vec3.prototype.min = function (other) {
    var ax = this.x,
        ay = this.y,
        az = this.z,
        bx = other.x,
        by = other.y,
        bz = other.z;

    this.x = bx < ax ? bx : ax;
    this.y = by < ay ? by : ay;
    this.z = bz < az ? bz : az;

    return this;
};

/**
 * @method max
 * @memberof Odin.Vec3
 * returns max values from this and other vector
 * @param Vec3 other
 * @return this
 */
Vec3.prototype.max = function (other) {
    var ax = this.x,
        ay = this.y,
        az = this.z,
        bx = other.x,
        by = other.y,
        bz = other.z;

    this.x = bx > ax ? bx : ax;
    this.y = by > ay ? by : ay;
    this.z = bz > az ? bz : az;

    return this;
};

/**
 * @method clamp
 * @memberof Odin.Vec3
 * clamp values between min and max's values
 * @param Vec3 min
 * @param Vec3 max
 * @return this
 */
Vec3.prototype.clamp = function (min, max) {
    var x = this.x,
        y = this.y,
        z = this.z,
        minx = min.x,
        miny = min.y,
        minz = min.z,
        maxx = max.x,
        maxy = max.y,
        maxz = max.z;

    this.x = x < minx ? minx : x > maxx ? maxx : x;
    this.y = y < miny ? miny : y > maxy ? maxy : y;
    this.z = z < minz ? minz : z > maxz ? maxz : z;

    return this;
};

/**
 * @method transformMat3
 * @memberof Odin.Vec3
 * transforms this with Mat3
 * @param Mat3 m
 * @return this
 */
Vec3.prototype.transformMat3 = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y,
        z = this.z;

    this.x = x * me[0] + y * me[3] + z * me[6];
    this.y = x * me[1] + y * me[4] + z * me[7];
    this.z = x * me[2] + y * me[5] + z * me[8];

    return this;
};

/**
 * @method transformMat4
 * @memberof Odin.Vec3
 * transforms this with Mat4
 * @param Mat4 m
 * @return this
 */
Vec3.prototype.transformMat4 = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y,
        z = this.z;

    this.x = x * me[0] + y * me[4] + z * me[8] + me[12];
    this.y = x * me[1] + y * me[5] + z * me[9] + me[13];
    this.z = x * me[2] + y * me[6] + z * me[10] + me[14];

    return this;
};

/**
 * @method transformMat4
 * @memberof Odin.Vec3
 * transforms this with Mat4
 * @param Mat4 m
 * @return this
 */
Vec3.prototype.transformMat4Rotation = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y,
        z = this.z;

    this.x = x * me[0] + y * me[4] + z * me[8];
    this.y = x * me[1] + y * me[5] + z * me[9];
    this.z = x * me[2] + y * me[6] + z * me[10];

    return this;
};

/**
 * @method transformProjection
 * @memberof Odin.Vec3
 * transforms this with Mat4 projection matrix
 * @param Mat4 m
 * @return this
 */
Vec3.prototype.transformProjection = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y,
        z = this.z,
        d = 1 / (me[3] * x + me[7] * y + me[11] * z + me[15]);

    this.x = (me[0] * x + me[4] * y + me[8] * z + me[12]) * d;
    this.y = (me[1] * x + me[5] * y + me[9] * z + me[13]) * d;
    this.z = (me[2] * x + me[6] * y + me[10] * z + me[14]) * d;

    return this;
};

/**
 * @method transformQuat
 * @memberof Odin.Vec3
 * transforms this with Quat
 * @param Quat q
 * @return this
 */
Vec3.prototype.transformQuat = function (q) {
    var x = this.x,
        y = this.y,
        z = this.z,
        qx = q.x,
        qy = q.y,
        qz = q.z,
        qw = q.w,

        ix = qw * x + qy * z - qz * y,
        iy = qw * y + qz * x - qx * z,
        iz = qw * z + qx * y - qy * x,
        iw = -qx * x - qy * y - qz * z;

    this.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;
    this.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;
    this.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;

    return this;
};

/**
 * @method fromVec2
 * @memberof Odin.Vec3
 * sets values from Vec2
 * @param Vec2 v
 * @return this
 */
Vec3.prototype.fromVec2 = function (v) {

    this.x = v.x;
    this.y = v.y;
    this.z = 0.0;

    return this;
};

/**
 * @method fromVec4
 * @memberof Odin.Vec3
 * sets position from Vec4
 * @param Vec4 v
 * @return this
 */
Vec3.prototype.fromVec4 = function (v) {

    this.x = v.x;
    this.y = v.y;
    this.z = v.z;

    return this;
};

/**
 * @method positionFromMat4
 * @memberof Odin.Vec3
 * sets position from Mat4
 * @param Mat4 m
 * @return this
 */
Vec3.prototype.positionFromMat4 = function (m) {
    var me = m.elements;

    this.x = me[12];
    this.y = me[13];
    this.z = me[14];

    return this;
};

/**
 * @method scaleFromMat3
 * @memberof Odin.Vec3
 * sets this from Mat3 scale
 * @param Mat3 m
 * @return this
 */
Vec3.prototype.scaleFromMat3 = function (m) {
    var me = m.elements,
        x = this.set(me[0], me[3], me[6]).length(),
        y = this.set(me[1], me[4], me[7]).length(),
        z = this.set(me[2], me[5], me[8]).length();

    this.x = x;
    this.y = y;
    this.z = z;

    return this;
};

/**
 * @method scaleFromMat4
 * @memberof Odin.Vec3
 * sets this from Mat4 scale
 * @param Mat4 m
 * @return this
 */
Vec3.prototype.scaleFromMat4 = function (m) {
    var me = m.elements,
        x = this.set(me[0], me[4], me[8]).length(),
        y = this.set(me[1], me[5], me[9]).length(),
        z = this.set(me[2], me[6], me[10]).length();

    this.x = x;
    this.y = y;
    this.z = z;

    return this;
};

/**
 * @memberof Odin.Vec3
 * @param Odin.Vec3 other
 * @return this
 */
Vec3.prototype.equals = function (other) {

    return !(
    this.x !== other.x ||
    this.y !== other.y ||
    this.z !== other.z
    );
};

/**
 * @memberof Odin.Vec3
 * @param Odin.Vec3 other
 * @return this
 */
Vec3.prototype.notEquals = function (other) {

    return (
    this.x !== other.x ||
    this.y !== other.y ||
    this.z !== other.z
    );
};

/**
 * @method fromJSON
 * @memberof Odin.Vec3
 * sets values from JSON object
 * @param Object json
 * @return this
 */
Vec3.prototype.fromJSON = function (json) {

    this.x = json.x;
    this.y = json.y;
    this.z = json.z;

    return this;
};

/**
 * @method toJSON
 * @memberof Odin.Vec3
 * returns json object of this
 * @return Object
 */
Vec3.prototype.toJSON = function (json) {
    json || (json = {});

    json._className = "Vec3";
    json.x = this.x;
    json.y = this.y;
    json.z = this.z;

    return json;
};

/**
 * @method fromArray
 * @memberof Odin.Vec3
 * sets values from Array object
 * @param Array array
 * @return this
 */
Vec3.prototype.fromArray = function (array) {

    this.x = array[0];
    this.y = array[1];
    this.z = array[2];

    return this;
};

/**
 * @method toArray
 * @memberof Odin.Vec3
 * returns array object of this
 * @return Array
 */
Vec3.prototype.toArray = function (array) {
    array || (array = []);

    array[0] = this.x;
    array[1] = this.y;
    array[2] = this.z;

    return array;
};

/**
 * @method toString
 * @memberof Odin.Vec3
 * returns string of this
 * @return String
 */
Vec3.prototype.toString = function () {

    return "Vec3( " + this.x + ", " + this.y + ", " + this.z + " )";
};


module.exports = Vec3;

},{"./mathf":107}],113:[function(require,module,exports){
var Mathf = require("./mathf");
"use strict";


var sqrt = Math.sqrt;

/**
 * @class Vec4
 * 3d vector
 * @param Number x
 * @param Number y
 * @param Number z
 * @param Number w
 */
function Vec4(x, y, z, w) {

    /**
     * @property Number x
     * @memberof Odin.Vec4
     */
    this.x = x || 0.0;

    /**
     * @property Number y
     * @memberof Odin.Vec4
     */
    this.y = y || 0.0;

    /**
     * @property Number z
     * @memberof Odin.Vec4
     */
    this.z = z || 0.0;

    /**
     * @property Number w
     * @memberof Odin.Vec4
     */
    this.w = w != undefined ? w : 1.0;
}

Mathf._classes["Vec4"] = Vec4;

/**
 * @method clone
 * @memberof Odin.Vec4
 * returns new instance of this
 * @return Vec4
 */
Vec4.prototype.clone = function () {

    return new Vec4(this.x, this.y, this.z, this.w);
};

/**
 * @method copy
 * @memberof Odin.Vec4
 * copies other
 * @param Vec4 other
 * @return this
 */
Vec4.prototype.copy = function (other) {

    this.x = other.x;
    this.y = other.y;
    this.z = other.z;
    this.w = other.w;

    return this;
};

/**
 * @method set
 * @memberof Odin.Vec4
 * sets values of this
 * @param Number x
 * @param Number y
 * @param Number z
 * @param Number w
 * @return this
 */
Vec4.prototype.set = function (x, y, z, w) {

    this.x = x;
    this.y = y;
    this.z = z;
    this.w = w;

    return this;
};

/**
 * @method add
 * @memberof Odin.Vec4
 * adds other's values to this
 * @param Vec4 other
 * @return this
 */
Vec4.prototype.add = function (other) {

    this.x += other.x;
    this.y += other.y;
    this.z += other.z;
    this.w += other.w;

    return this;
};

/**
 * @method vadd
 * @memberof Odin.Vec4
 * adds a and b together saves it in this
 * @param Vec4 a
 * @param Vec4 b
 * @return this
 */
Vec4.prototype.vadd = function (a, b) {

    this.x = a.x + b.x;
    this.y = a.y + b.y;
    this.z = a.z + b.z;
    this.w = a.w + b.w;

    return this;
};

/**
 * @method sadd
 * @memberof Odin.Vec4
 * adds scalar value to this
 * @param Number s
 * @return this
 */
Vec4.prototype.sadd = function (s) {

    this.x += s;
    this.y += s;
    this.z += s;
    this.w += s;

    return this;
};

/**
 * @method sub
 * @memberof Odin.Vec4
 * subtracts other's values from this
 * @param Vec4 other
 * @return this
 */
Vec4.prototype.sub = function (other) {

    this.x -= other.x;
    this.y -= other.y;
    this.z -= other.z;
    this.w -= other.w;

    return this;
};

/**
 * @method vsub
 * @memberof Odin.Vec4
 * subtracts b from a saves it in this
 * @param Vec4 a
 * @param Vec4 b
 * @return this
 */
Vec4.prototype.vsub = function (a, b) {

    this.x = a.x - b.x;
    this.y = a.y - b.y;
    this.z = a.z - b.z;
    this.w = a.w - b.w;

    return this;
};

/**
 * @method ssub
 * @memberof Odin.Vec4
 * subtracts this by a scalar value
 * @param Number s
 * @return this
 */
Vec4.prototype.ssub = function (s) {

    this.x -= s;
    this.y -= s;
    this.z -= s;
    this.w -= s;

    return this;
};

/**
 * @method mul
 * @memberof Odin.Vec4
 * muliples this's values by other's
 * @param Vec4 other
 * @return this
 */
Vec4.prototype.mul = function (other) {

    this.x *= other.x;
    this.y *= other.y;
    this.z *= other.z;
    this.w *= other.w;

    return this;
};

/**
 * @method vmul
 * @memberof Odin.Vec4
 * muliples a and b saves it in this
 * @param Vec4 a
 * @param Vec4 b
 * @return this
 */
Vec4.prototype.vmul = function (a, b) {

    this.x = a.x * b.x;
    this.y = a.y * b.y;
    this.z = a.z * b.z;
    this.w = a.w * b.w;

    return this;
};

/**
 * @method smul
 * @memberof Odin.Vec4
 * muliples this by a scalar value
 * @param Number s
 * @return this
 */
Vec4.prototype.smul = function (s) {

    this.x *= s;
    this.y *= s;
    this.z *= s;
    this.w *= s;

    return this;
};

/**
 * @method div
 * @memberof Odin.Vec4
 * divides this's values by other's
 * @param Vec4 other
 * @return this
 */
Vec4.prototype.div = function (other) {
    var x = other.x,
        y = other.y,
        z = other.z,
        w = other.w;

    this.x *= x !== 0.0 ? 1.0 / x : 0.0;
    this.y *= y !== 0.0 ? 1.0 / y : 0.0;
    this.z *= z !== 0.0 ? 1.0 / z : 0.0;
    this.w *= w !== 0.0 ? 1.0 / w : 0.0;

    return this;
};

/**
 * @method vdiv
 * @memberof Odin.Vec4
 * divides b from a saves it in this
 * @param Vec4 a
 * @param Vec4 b
 * @return this
 */
Vec4.prototype.vdiv = function (a, b) {
    var x = b.x,
        y = b.y,
        z = b.z,
        w = b.w;

    this.x = x !== 0.0 ? a.x / x : 0.0;
    this.y = y !== 0.0 ? a.y / y : 0.0;
    this.z = z !== 0.0 ? a.z / z : 0.0;
    this.w = w !== 0.0 ? a.w / w : 0.0;

    return this;
};

/**
 * @method sdiv
 * @memberof Odin.Vec4
 * divides this by scalar value
 * @param Number s
 * @return this
 */
Vec4.prototype.sdiv = function (s) {
    s = s === 0.0 ? 0.0 : 1.0 / s;

    this.x *= s;
    this.y *= s;
    this.z *= s;
    this.w *= s;

    return this;
};

/**
 * @method length
 * @memberof Odin.Vec4
 * returns the length of this
 * @return Number
 */
Vec4.prototype.length = function () {
    var x = this.x,
        y = this.y,
        z = this.z,
        w = this.w,
        lsq = x * x + y * y + z * z + w * w;

    if (lsq === 1) return 1;

    return lsq > 0.0 ? sqrt(lsq) : 0.0;
};

/**
 * @method lengthSq
 * @memberof Odin.Vec4
 * returns the squared length of this
 * @return Number
 */
Vec4.prototype.lengthSq = function () {
    var x = this.x,
        y = this.y,
        z = this.z,
        w = this.w;

    return x * x + y * y + z * z + w * w;
};

/**
 * @method setLength
 * @memberof Odin.Vec4
 * sets this so its magnitude is equal to length
 * @param Number length
 * @return Vec4
 */
Vec4.prototype.setLength = function (length) {
    var x = this.x,
        y = this.y,
        z = this.z,
        w = this.w,
        l = x * x + y * y + z * z + w * w;

    if (l === 1) {
        this.x *= length;
        this.y *= length;
        this.z *= length;
        this.w *= length;

        return this;
    }

    l = l > 0.0 ? 1.0 / sqrt(l) : 0.0;

    this.x *= l * length;
    this.y *= l * length;
    this.z *= l * length;
    this.w *= l * length;

    return this;
};

/**
 * @method normalize
 * @memberof Odin.Vec4
 * returns this with a length of 1
 * @return this
 */
Vec4.prototype.normalize = function () {
    var x = this.x,
        y = this.y,
        z = this.z,
        w = this.w,
        l = x * x + y * y + z * z + w * w;

    if (l === 1) return this;

    l = l > 0.0 ? 1.0 / sqrt(l) : 0.0;

    this.x *= l;
    this.y *= l;
    this.z *= l;
    this.w *= l;

    return this;
};

/**
 * @method orthoNormalize
 * @memberof Odin.Vec4
 * returns makes vectors normalized and orthogonal to each other
 * @param Vec4 a
 * @param Vec4 b
 * @param Vec4 c
 * @return this
 */
Vec4.prototype.orthoNormalize = function (a, b, c) {
    if (a.lengthSq() !== 1.0) a.normalize();
    c.vcross(a, b);
    if (a.lengthSq() === 0.0) return;
    c.normalize();
    b.vcross(c, a);
};

/**
 * @method inverse
 * @memberof Odin.Vec4
 * returns the inverse of this
 * @return this
 */
Vec4.prototype.inverse = function () {

    this.x *= -1;
    this.y *= -1;
    this.z *= -1;
    this.w *= -1;

    return this;
};

/**
 * @method inverseVec
 * @memberof Odin.Vec4
 * returns the inverse of other
 * @param Vec4 other
 * @return this
 */
Vec4.prototype.inverseVec = function (other) {

    this.x = -other.x;
    this.y = -other.y;
    this.z = -(other.z || 0);
    this.w = -(other.w || 0);

    return this;
};

/**
 * @method lerp
 * @memberof Odin.Vec4
 * linear interpolation between this and other by x
 * @param Vec4 other
 * @param Number x
 * @return Vec4
 */
Vec4.prototype.lerp = function (other, x) {

    this.x += (other.x - this.x) * x;
    this.y += (other.y - this.y) * x;
    this.z += (other.z - this.z) * x;
    this.w += (other.w - this.w) * x;

    return this;
};

/**
 * @method vlerp
 * @memberof Odin.Vec4
 * linear interpolation between a and b by x
 * @param Vec4 a
 * @param Vec4 b
 * @param Number x
 * @return Vec4
 */
Vec4.prototype.vlerp = function (a, b, x) {
    var ax = a.x,
        ay = a.y,
        az = a.z,
        aw = a.w;

    this.x = ax + (b.x - ax) * x;
    this.y = ay + (b.y - ay) * x;
    this.z = az + (b.z - az) * x;
    this.w = aw + (b.w - aw) * x;

    return this;
};

/**
 * @method vdot
 * @memberof Odin.Vec4
 * dot product of two vectors, can be called as a static function Vec4.vdot( a, b )
 * @param Vec4 a
 * @param Vec4 b
 * @return Number
 */
Vec4.vdot = Vec4.prototype.vdot = function (a, b) {

    return a.x * b.x + a.y * b.y + a.z * b.z + a.w * b.w;
};

/**
 * @method dot
 * @memberof Odin.Vec4
 * dot product of this and other vector
 * @param Vec4 other
 * @return Number
 */
Vec4.prototype.dot = function (other) {

    return this.x * other.x + this.y * other.y + this.z * other.z + this.w * other.w;
};

/**
 * @method min
 * @memberof Odin.Vec4
 * returns min values from this and other vector
 * @param Vec4 other
 * @return this
 */
Vec4.prototype.min = function (other) {
    var ax = this.x,
        ay = this.y,
        az = this.z,
        aw = this.w,
        bx = other.x,
        by = other.y,
        bz = other.z,
        bw = this.w;

    this.x = bx < ax ? bx : ax;
    this.y = by < ay ? by : ay;
    this.z = bz < az ? bz : az;
    this.w = bw < aw ? bw : aw;

    return this;
};

/**
 * @method max
 * @memberof Odin.Vec4
 * returns max values from this and other vector
 * @param Vec4 other
 * @return this
 */
Vec4.prototype.max = function (other) {
    var ax = this.x,
        ay = this.y,
        az = this.z,
        aw = this.w,
        bx = other.x,
        by = other.y,
        bz = other.z,
        bw = this.w;

    this.x = bx > ax ? bx : ax;
    this.y = by > ay ? by : ay;
    this.z = bz > az ? bz : az;
    this.w = bw > aw ? bw : aw;

    return this;
};

/**
 * @method clamp
 * @memberof Odin.Vec4
 * clamp values between min and max's values
 * @param Vec4 min
 * @param Vec4 max
 * @return this
 */
Vec4.prototype.clamp = function (min, max) {
    var x = this.x,
        y = this.y,
        z = this.z,
        w = this.w,
        minx = min.x,
        miny = min.y,
        minz = min.z,
        minw = min.w,
        maxx = max.x,
        maxy = max.y,
        maxz = max.z,
        maxw = maxw;

    this.x = x < minx ? minx : x > maxx ? maxx : x;
    this.y = y < miny ? miny : y > maxy ? maxy : y;
    this.z = z < minz ? minz : z > maxz ? maxz : z;
    this.w = w < minw ? minw : w > maxw ? maxw : w;

    return this;
};

/**
 * @method transformMat4
 * @memberof Odin.Vec4
 * transforms this with Mat4
 * @param Mat4 m
 * @return this
 */
Vec4.prototype.transformMat4 = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y,
        z = this.z,
        w = this.w;

    this.x = x * me[0] + y * me[4] + z * me[8] + w * me[12];
    this.y = x * me[1] + y * me[5] + z * me[9] + w * me[13];
    this.z = x * me[2] + y * me[6] + z * me[10] + w * me[14];
    this.w = x * me[3] + y * me[7] + z * me[11] + w * me[15];

    return this;
};

/**
 * @method transformProjection
 * @memberof Odin.Vec3
 * transforms this with Mat4 projection matrix
 * @param Mat4 m
 * @return this
 */
Vec4.prototype.transformProjection = function (m) {
    var me = m.elements,
        x = this.x,
        y = this.y,
        z = this.z,
        w = this.w,
        d = 1 / (me[3] * x + me[7] * y + me[11] * z + me[15]);

    this.x = (me[0] * x + me[4] * y + me[8] * z + me[12] * w) * d;
    this.y = (me[1] * x + me[5] * y + me[9] * z + me[13] * w) * d;
    this.z = (me[2] * x + me[6] * y + me[10] * z + me[14] * w) * d;
    this.w = (me[3] * x + me[7] * y + me[11] * z + me[15] * w) * d;

    return this;
};

/**
 * @method fromVec2
 * @memberof Odin.Vec4
 * sets values from Vec2
 * @param Vec2 v
 * @return this
 */
Vec4.prototype.fromVec2 = function (v) {

    this.x = v.x;
    this.y = v.y;
    this.z = 0.0;
    this.w = 1;

    return this;
};

/**
 * @method fromVec3
 * @memberof Odin.Vec4
 * sets values from Vec3
 * @param Vec3 v
 * @return this
 */
Vec4.prototype.fromVec3 = function (v) {

    this.x = v.x;
    this.y = v.y;
    this.z = v.z;
    this.w = 1;

    return this;
};

/**
 * @method fromRect
 * @memberof Odin.Vec4
 * sets values from Rect
 * @param Vec3 v
 * @return this
 */
Vec4.prototype.fromRect = function (rect) {

    this.x = rect.x;
    this.y = rect.y;
    this.z = rect.width;
    this.w = rect.height;

    return this;
};

/**
 * @method positionFromMat4
 * @memberof Odin.Vec4
 * sets position from Mat4
 * @param Mat4 m
 * @return this
 */
Vec4.prototype.positionFromMat4 = function (m) {
    var me = m.elements;

    this.x = me[12];
    this.y = me[13];
    this.z = me[14];
    this.w = me[15];

    return this;
};

/**
 * @memberof Odin.Vec4
 * @param Odin.Vec4 other
 * @return this
 */
Vec4.prototype.equals = function (other) {

    return !(
    this.x !== other.x ||
    this.y !== other.y ||
    this.z !== other.z ||
    this.w !== other.w
    );
};

/**
 * @memberof Odin.Vec4
 * @param Odin.Vec4 other
 * @return this
 */
Vec4.prototype.notEquals = function (other) {

    return (
    this.x !== other.x ||
    this.y !== other.y ||
    this.z !== other.z ||
    this.w !== other.w
    );
};

/**
 * @method fromJSON
 * @memberof Odin.Vec4
 * sets values from JSON object
 * @param Object json
 * @return this
 */
Vec4.prototype.fromJSON = function (json) {

    this.x = json.x;
    this.y = json.y;
    this.z = json.z;
    this.w = json.w;

    return this;
};

/**
 * @method toJSON
 * @memberof Odin.Vec4
 * returns json object of this
 * @return Object
 */
Vec4.prototype.toJSON = function (json) {
    json || (json = {});

    json._className = "Vec4";
    json.x = this.x;
    json.y = this.y;
    json.z = this.z;
    json.w = this.w;

    return json;
};

/**
 * @method fromArray
 * @memberof Odin.Vec4
 * sets values from Array object
 * @param Array array
 * @return this
 */
Vec4.prototype.fromArray = function (array) {

    this.x = array[0];
    this.y = array[1];
    this.z = array[2];
    this.w = array[3];

    return this;
};

/**
 * @method toArray
 * @memberof Odin.Vec4
 * returns array object of this
 * @return Array
 */
Vec4.prototype.toArray = function (array) {
    array || (array = []);

    array[0] = this.x;
    array[1] = this.y;
    array[2] = this.z;
    array[3] = this.w;

    return array;
};

/**
 * @method toString
 * @memberof Odin.Vec4
 * returns string of this
 * @return String
 */
Vec4.prototype.toString = function () {

    return "Vec4( " + this.x + ", " + this.y + ", " + this.z + ", " + this.w + " )";
};


module.exports = Vec4;

},{"./mathf":107}],114:[function(require,module,exports){
var P2Enums = require("../p2enums");
"use strict";


var MotionState = P2Enums.MotionState,
    SleepState = P2Enums.SleepState;


function P2Broadphase() {
}


P2Broadphase.prototype.collisions = function (bodies, pairsi, pairsj) {
    var length = bodies.length,
        bi, bj, shapesi, shapesj, length, si, sj,
        i = length,
        j, k, l;

    pairsi.length = pairsj.length = 0;

    while (i--) {
        j = 0;
        while (j !== i) {
            bi = bodies[i];
            bj = bodies[j];
            j++;

            if ((bi.motionState !== MotionState.Dynamic && bj.motionState !== MotionState.Dynamic) || (bi.sleepState === SleepState.Sleeping && bj.sleepState === SleepState.Sleeping)) {
                continue;
            }

            shapesi = bi.shapes;
            shapesj = bj.shapes;

            if (!bi.aabb.intersects(bj.aabb)) continue;

            k = shapesi.length;
            length = shapesj.length;
            while (k--) {
                l = length;
                while (l--) {
                    si = shapesi[k];
                    sj = shapesj[l];
                    if ((si.filterGroup & sj.filterMask) === 0 || (sj.filterGroup & si.filterMask) === 0) continue;

                    if (si.aabb.intersects(sj.aabb)) {
                        pairsi.push(si);
                        pairsj.push(sj);
                    }
                }
            }
        }
    }
};


P2Broadphase.prototype.toJSON = function (json) {
    json || (json = {});

    return json;
};


P2Broadphase.prototype.fromJSON = function () {

    return this;
};


module.exports = P2Broadphase;

},{"../p2enums":128}],115:[function(require,module,exports){
var P2Enums = require("../p2enums");
"use strict";


var floor = Math.floor,
    defineProperty = Object.defineProperty,
    MotionState = P2Enums.MotionState,
    SleepState = P2Enums.SleepState;


function Cell(counter) {
    Array.call(this);
    this._counter = counter;
}

Cell.prototype = Object.create(Array.prototype);
Cell.prototype.constructor = Cell;


function P2BroadphaseSpatialHash(opts) {
    opts || (opts = {});

    this._cellSize = 0;
    this._inverseCellSize = 0;

    this.cells = {};
    this.cellDeathFrameCount = opts.cellDeathFrameCount != undefined ? opts.cellDeathFrameCount : 300;
    this.cellSize = opts.cellSize != undefined ? opts.cellSize : 1;
}


defineProperty(P2BroadphaseSpatialHash.prototype, "cellSize", {
    get: function () {
        return this._cellSize;
    },
    set: function (value) {
        value = value >= 1 ? value : 1;

        this._cellSize = floor(value);
        this._inverseCellSize = 1 / this._cellSize;
    }
});


P2BroadphaseSpatialHash.prototype.collisions = function (bodies, pairsi, pairsj) {
    var cells = this.cells,
        cellSize = this._cellSize,
        cellDeathFrameCount = this.cellDeathFrameCount,
        inverseCellSize = this._inverseCellSize,
        aabb, min, max, minx, miny, body, position, shapes, shape, x, y,
        cell, key, si, sj, bi, bj, i, j, k, l;

    for (key in cells) {
        cell = cells[key];
        if (cell.length === 0) {
            if (cell._counter-- <= 0) delete cells[key];
        } else {
            cell._counter = cellDeathFrameCount;
        }
        cell.length = 0;
    }
    pairsi.length = pairsj.length = 0;

    i = bodies.length;
    while (i--) {
        body = bodies[i];
        shapes = body.shapes;
        j = shapes.length;
        while (j--) {
            shape = shapes[j];
            aabb = shape.aabb;
            min = aabb.min;
            max = aabb.max;
            minx = (min.x * inverseCellSize | 0) * cellSize;
            miny = (min.y * inverseCellSize | 0) * cellSize;

            x = minx + ((max.x - min.x) * inverseCellSize | 0) * cellSize;
            y = miny + ((max.y - min.y) * inverseCellSize | 0) * cellSize;

            for (k = minx; k <= x; k += cellSize) {
                for (l = miny; l <= y; l += cellSize) {
                    key = k + ":" + l;
                    (cells[key] || (cells[key] = new Cell(cellDeathFrameCount))).push(shape);
                }
            }
        }
    }

    for (key in cells) {
        cell = cells[key];
        i = cell.length;

        while (i--) {
            j = 0;
            while (j !== i) {
                si = cell[i];
                sj = cell[j];
                j++;

                bi = si.body;
                bj = sj.body;

                if (bi && bj) {
                    if (!bi.aabb.intersects(bj.aabb)) continue;

                    if ((bi.motionState !== MotionState.Dynamic && bj.motionState !== MotionState.Dynamic) || (bi.sleepState === SleepState.Sleeping && bj.sleepState === SleepState.Sleeping)) {
                        continue;
                    }
                    if ((si.filterGroup & sj.filterMask) === 0 || (sj.filterGroup & si.filterMask) === 0) continue;
                }

                pairsi.push(si);
                pairsj.push(sj);
            }
        }
    }
};


P2BroadphaseSpatialHash.prototype.toJSON = function (json) {
    json || (json = {});

    json.cellSize = this.cellSize;
    json.cellDeathFrameCount = this.cellDeathFrameCount;

    return json;
};


P2BroadphaseSpatialHash.prototype.fromJSON = function (json) {

    this.cellSize = json.cellSize;
    this.cellDeathFrameCount = json.cellDeathFrameCount;

    return this;
};


module.exports = P2BroadphaseSpatialHash;

},{"../p2enums":128}],116:[function(require,module,exports){
var ObjectPool = require("../../base/object_pool");
var Mathf = require("../../math/mathf");
var Vec2 = require("../../math/vec2");
var P2Enums = require("../p2enums");
var P2Contact = require("../constraints/p2contact");
"use strict";


var min = Math.min,
    abs = Math.abs,
    sqrt = Math.sqrt,

    EPSILON = Mathf.EPSILON,

    BodyType = P2Enums.BodyType,
    ShapeType = P2Enums.ShapeType,

    CONTACT_POOL = new ObjectPool(P2Contact);


function clearContact(contact) {

    contact.bi = contact.bj = undefined;
}

function createContact(bi, bj, e, u, nx, ny, px, py, s, contacts) {
    var c = CONTACT_POOL.create(),
        n = c.n,
        p = c.p;

    c.bi = bi;
    c.bj = bj;

    c.e = e;
    c.u = u;

    n.x = nx;
    n.y = ny;

    p.x = px;
    p.y = py;

    c.s = s;

    contacts.push(c);
}

function circle2Circle(si, sj, xix, xiy, ri, xjx, xjy, rj, contacts) {
    var dx = xjx - xix,
        dy = xjy - xiy,
        dist = dx * dx + dy * dy,
        invDist, separation = 0.0,
        r = ri + rj,
        nx, ny;

    if (dist > r * r) return;
    if (!collide(si, sj)) return;

    if (dist < EPSILON) {
        nx = 0.0;
        ny = 1.0;
        invDist = 0.0;
        separation = -r;
    } else {
        dist = sqrt(dist);
        invDist = 1.0 / dist;

        nx = dx * invDist;
        ny = dy * invDist;

        separation = dist - r;
    }

    createContact(
        si.body,
        sj.body,
        1.0 + min(si.elasticity, sj.elasticity),
        min(si.friction, sj.friction),
        nx,
        ny,
        xjx - rj * nx,
        xjy - rj * ny,
        separation,
        contacts
    );
}

function P2Nearphase() {
}

P2Nearphase.CONTACT_POOL = CONTACT_POOL;


P2Nearphase.prototype.collisions = function (pairsi, pairsj, contacts) {
    var si, sj,
        i = pairsi.length;

    contacts.length = 0;
    CONTACT_POOL.clearForEach(clearContact);

    while (i--) {
        si = pairsi[i];
        sj = pairsj[i];

        collisionType(si, sj, contacts);
    }
};


function collide(si, sj) {
    var bi = si.body,
        bj = sj.body,
        i = bi._index,
        j = bj._index,
        space = bi.space || bj.space;

    if (!space) return false;
    space.collisionMatrixSet(i, j, 1, true);

    if (space.collisionMatrixGet(i, j, true) !== space.collisionMatrixGet(i, j, false)) {
        bi.wake();
        bj.wake();

        bi.emit("collide", bj, si, sj);
        bj.emit("collide", bi, sj, si);
    } else {
        bi.wake();
        bj.wake();

        bi.emit("colliding", bj, si, sj);
        bj.emit("colliding", bi, sj, si);
    }

    if (si.isTrigger || sj.isTrigger) return false;

    return true;
}


function circleCircle(si, sj, contacts) {
    var xi = si.position,
        xj = sj.position;

    circle2Circle(
        si,
        sj,
        xi.x, xi.y, si.radius,
        xj.x, xj.y, sj.radius,
        contacts
    );
}


function segmentCircle(si, sj, contacts) {
    var ri = si.radius,
        a = si._a,
        b = si._b,
        n = si._normal,
        ax = a.x,
        ay = a.y,
        bx = b.x,
        by = b.y,
        nx = n.x,
        ny = n.y,

        xj = sj.position,
        xjx = xj.x,
        xjy = xj.y,
        rj = sj.radius,
        r = ri + rj,

        dn = (nx * xjx + ny * xjy) - (ax * nx + ay * ny),
        dist = abs(dn),
        dt, dta, dtb, dx, dy, invDist;

    if (dist > r) return;

    dt = xjx * ny - xjy * nx;
    dta = ax * ny - ay * nx;
    dtb = bx * ny - by * nx;

    if (dt <= dta) {
        if (dt < dta - r) return;

        dx = xjx - ax;
        dy = xjy - ay;

        dist = dx * dx + dy * dy;
        if (dist > r * r) return;

        dist = dist === 0.0 ? 0.0 : sqrt(dist);
        invDist = dist === 0.0 ? 0.0 : 1.0 / dist;

        nx = dx * invDist;
        ny = dy * invDist;
    } else if (dt > dtb) {
        if (dt > dtb + r) return;

        dx = xjx - bx;
        dy = xjy - by;

        dist = dx * dx + dy * dy;
        if (dist > r * r) return;

        dist = dist === 0.0 ? 0.0 : sqrt(dist);
        invDist = dist === 0.0 ? 0.0 : 1.0 / dist;

        nx = dx * invDist;
        ny = dy * invDist;
    } else {
        if (dn < 0.0) {
            nx = -nx;
            ny = -ny;
        }
    }
    if (!collide(si, sj)) return;

    createContact(
        si.body,
        sj.body,
        1.0 + min(si.elasticity, sj.elasticity),
        min(si.friction, sj.friction),
        nx,
        ny,
        xjx - r * nx,
        xjy - r * ny,
        dist - r,
        contacts
    );
}


function segmentSegment(si, sj, contacts) {
    var ai = si._a,
        aix = ai.x,
        aiy = ai.y,
        bi = si._b,
        bix = bi.x,
        biy = bi.y,
        ri = si.radius,

        aj = sj._a,
        ajx = aj.x,
        ajy = aj.y,
        bj = sj._b,
        bjx = bj.x,
        bjy = bj.y,
        rj = sj.radius,
        d0, d1, d2, d3, mi, mj, m, s, t, ux, uy, vx, vy, amx, amy, bmx, bmy;

    segmentSegmentArray[0] = d0 = segmentPointDistanceSq(aix, aiy, bix, biy, ajx, ajy);
    segmentSegmentArray[1] = d1 = segmentPointDistanceSq(aix, aiy, bix, biy, bjx, bjy);
    segmentSegmentArray[2] = d2 = segmentPointDistanceSq(ajx, ajy, bjx, bjy, aix, aiy);
    segmentSegmentArray[3] = d3 = segmentPointDistanceSq(ajx, ajy, bjx, bjy, bix, biy);

    mi = d0 < d1 ? 0 : 1;
    mj = d2 < d3 ? 2 : 3;
    m = segmentSegmentArray[mi] < segmentSegmentArray[mj] ? mi : mj;

    ux = bix - aix;
    uy = biy - aiy;
    vx = bjx - ajx;
    vy = bjy - ajy;

    if (m === 0) {
        s = ((ajx - aix) * ux + (ajy - aiy) * uy) / (ux * ux + uy * uy);
        s = s < 0 ? 0 : (s > 1 ? 1 : s);
        t = 0;
    } else if (m === 1) {
        s = ((bjx - aix) * ux + (bjy - aiy) * uy) / (ux * ux + uy * uy);
        s = s < 0 ? 0 : (s > 1 ? 1 : s);
        t = 1;
    } else if (m === 2) {
        s = 0;
        t = ((aix - ajx) * vx + (aiy - ajy) * vy) / (vx * vx + vy * vy);
        t = t < 0 ? 0 : (t > 1 ? 1 : t);
    } else if (m === 3) {
        s = 1;
        t = ((bix - ajx) * vx + (biy - ajy) * vy) / (vx * vx + vy * vy);
        t = t < 0 ? 0 : (t > 1 ? 1 : t);
    }

    amx = aix + (ux * s);
    amy = aiy + (uy * s);
    bmx = ajx + (vx * t);
    bmy = ajy + (vy * t);

    circle2Circle(
        si,
        sj,
        amx, amy, ri,
        bmx, bmy, rj,
        contacts
    );
}


function convexSegment(si, sj, contacts) {
    var vertices = si._vertices,
        normals = si._normals,

        a = sj._a,
        ax = a.x,
        ay = a.y,
        b = sj._b,
        bx = b.x,
        by = b.y,
        nj = sj._normal,
        radius = sj.radius,
        njx = nj.x,
        njy = nj.y,

        segD = njx * ax + njy * ay,
        minNorm = valueOnAxis(vertices, njx, njy, segD) - radius,
        minNeg = valueOnAxis(vertices, -njx, -njy, -segD) - radius,
        index = -1,
        polyMin = -Infinity,
        v, n, dist, i, vax, vay, vbx, vby, u, e, nx, ny, count = 0;

    if (minNeg > 0 || minNorm > 0) return;

    i = vertices.length;
    while (i--) {
        v = vertices[i];
        n = normals[i];
        nx = n.x;
        ny = n.y;
        dist = segmentValueOnAxis(ax, ay, bx, by, radius, nx, ny, (nx * v.x + ny * v.y));

        if (dist > 0.0) {
            return;
        } else if (dist > polyMin) {
            polyMin = dist;
            index = i;
        }
    }

    if (index === -1) return;
    if (!collide(si, sj)) return;

    e = 1.0 + min(si.elasticity, sj.elasticity);
    u = min(si.friction, sj.friction);

    n = normals[index];
    nx = n.x;
    ny = n.y;

    vax = ax + (-nx * radius);
    vay = ay + (-ny * radius);

    vbx = bx + (-nx * radius);
    vby = by + (-ny * radius);

    if (contains(vertices, normals, vax, vay)) {
        createContact(
            si.body,
            sj.body,
            e,
            u,
            nx,
            ny,
            vax,
            vay,
            polyMin,
            contacts
        );
        count++;
    }
    if (contains(vertices, normals, vbx, vby)) {
        createContact(
            si.body,
            sj.body,
            e,
            u,
            nx,
            ny,
            vbx,
            vby,
            polyMin,
            contacts
        );
        count++;
    }

    if (minNorm >= polyMin || minNeg >= polyMin) {
        if (minNorm > minNeg) {
            count += pointsBehindSegment(si, sj, e, u, ax, ay, bx, by, radius, nx, ny, minNorm, 1, contacts);
        } else {
            count += pointsBehindSegment(si, sj, e, u, ax, ay, bx, by, radius, nx, ny, minNeg, -1, contacts);
        }
    }
}

var segmentSegmentArray = [0.0, 0.0, 0.0, 0.0];

function pointsBehindSegment(si, sj, e, u, ax, ay, bx, by, radius, nx, ny, dist, coef, contacts) {
    var dta = nx * ay - ny * ax,
        dtb = nx * by - ny * bx,
        vertices = si._vertices,
        i = vertices.length,
        v, vx, vy, dt,
        count = 0;

    nx *= coef;
    ny *= coef;

    while (i--) {
        v = vertices[i]
        vx = v.x;
        vy = v.y;

        if ((vx * nx + vy * ny) < (nx * ax + ny * ay) * coef + radius) {
            dt = nx * vy - ny * vx;
            if (dta >= dt && dt >= dtb) {
                createContact(
                    si.body,
                    sj.body,
                    e,
                    u,
                    nx,
                    ny,
                    vx,
                    vy,
                    dist,
                    contacts
                );
                count++;
            }
        }
    }

    return count;
}

function segmentPointDistanceSq(ax, ay, bx, by, px, py) {
    var wx = px - ax,
        wy = py - ay,
        dx = bx - ax,
        dy = by - ay,

        proj = wx * dx + wy * dy,
        vsq;

    if (proj <= 0.0) return wx * wx + wy * wy;

    vsq = dx * dx + dy * dy;
    if (proj >= vsq) return (wx * wx + wy * wy) - 2 * proj + vsq;


    return (wx * wx + wy * wy) - proj * proj / vsq;
}

function segmentValueOnAxis(ax, ay, bx, by, r, nx, ny, d) {
    var a = (nx * ax + ny * ay) - r,
        b = (nx * bx + ny * by) - r;

    return min(a, b) - d;
}


function convexCircle(si, sj, contacts) {
    var vertices = si._vertices,
        normals = si._normals,
        xj = sj.position,
        xjx = xj.x,
        xjy = xj.y,
        radius = sj.radius,

        vertex, normal, s, separation = -Infinity,
        index = -1,
        v1, v2, v1x, v1y, v2x, v2y, ex, ey, dx, dy, u, dist, invDist,

        nx, ny,
        i = vertices.length;

    while (i--) {
        vertex = vertices[i];
        normal = normals[i];
        s = normal.x * (xjx - vertex.x) + normal.y * (xjy - vertex.y);

        if (s > radius) return;

        if (s > separation) {
            separation = s;
            index = i;
        }
    }

    if (index === -1) return;

    normal = normals[index];
    nx = normal.x;
    ny = normal.y;

    v1 = vertices[index];
    v1x = v1.x;
    v1y = v1.y;
    v2 = vertices[index + 1] || vertices[0];
    v2x = v2.x;
    v2y = v2.y;

    ex = v2x - v1x;
    ey = v2y - v1y;

    dx = xjx - v1x;
    dy = xjy - v1y;

    u = (ex * dx + ey * dy) / (ex * ex + ey * ey);

    if (u < 0.0) {
        dx = xjx - v1x;
        dy = xjy - v1y;

        dist = dx * dx + dy * dy;
        if (dist > radius * radius) return;

        dist = sqrt(dist);
        invDist = dist > 0.0 ? 1.0 / dist : 0.0;

        nx = dx * invDist;
        ny = dy * invDist;
    } else if (u > 1.0) {
        dx = xjx - v2x;
        dy = xjy - v2y;

        dist = dx * dx + dy * dy;
        if (dist > radius * radius) return;

        dist = sqrt(dist);
        invDist = dist > 0.0 ? 1.0 / dist : 0.0;

        nx = dx * invDist;
        ny = dy * invDist;
    } else {
        normal = normals[index];
        nx = normal.x;
        ny = normal.y;

        dist = separation;
    }
    if (!collide(si, sj)) return;

    createContact(
        si.body,
        sj.body,
        1.0 + min(si.elasticity, sj.elasticity),
        min(si.friction, sj.friction),
        nx,
        ny,
        xjx - radius * nx,
        xjy - radius * ny,
        dist - radius,
        contacts
    );
}


function contains(vertices, normals, px, py) {
    var n, nx, ny, v, vx, vy,
        i = vertices.length;

    while (i--) {
        n = normals[i];
        nx = n.x;
        ny = n.y;
        v = vertices[i];
        vx = v.x;
        vy = v.y;

        if ((nx * px + ny * py) - (nx * vx + ny * vy) > 0) return false;
    }

    return true;
}


function findContacts(si, sj, normal, dist, contacts) {
    if (!collide(si, sj)) return;
    var verticesi = si._vertices,
        normalsi = si._normals,
        verticesj = sj._vertices,
        normalsj = sj._normals,
        v, vx, vy,
        nx = normal.x,
        ny = normal.y,

        e = 1.0 + min(si.elasticity, sj.elasticity),
        u = min(si.friction, sj.friction),

        i;

    i = verticesi.length;
    while (i--) {
        v = verticesi[i];
        vx = v.x;
        vy = v.y;

        if (contains(verticesj, normalsj, vx, vy)) {
            createContact(
                si.body,
                sj.body,
                e,
                u,
                nx,
                ny,
                vx,
                vy,
                dist,
                contacts
            );
        }
    }

    i = verticesj.length;
    while (i--) {
        v = verticesj[i];
        vx = v.x;
        vy = v.y;

        if (contains(verticesi, normalsi, vx, vy)) {
            createContact(
                si.body,
                sj.body,
                e,
                u,
                nx,
                ny,
                vx,
                vy,
                dist,
                contacts
            );
        }
    }
}


function valueOnAxis(vertices, nx, ny, d) {
    var v, m = Infinity,
        i = vertices.length;

    while (i--) {
        v = vertices[i];
        m = min(m, nx * v.x + ny * v.y);
    }

    return m - d;
}


var lastMinMSA = 0.0;

function findMSA(si, sj) {
    var verticesi = si._vertices,
        normalsi = si._normals,
        counti = normalsi.length,
        verticesj = sj._vertices,

        n, v, dist, min = -Infinity,
        index = -1,
        i = counti;

    while (i--) {
        n = normalsi[i];
        v = verticesi[i];

        dist = valueOnAxis(verticesj, n.x, n.y, (n.x * v.x + n.y * v.y));

        if (dist > 0.0) return -1;

        if (dist > min) {
            min = dist;
            index = i;
        }
    }

    lastMinMSA = min;
    return index;
}


function convexConvex(si, sj, contacts) {
    var indexi, mini, indexj, minj;

    indexi = findMSA(si, sj);
    if (indexi < 0) return;
    mini = lastMinMSA;

    indexj = findMSA(sj, si);
    if (indexj < 0) return;
    minj = lastMinMSA;

    if (mini > minj) {
        findContacts(si, sj, si._normals[indexi], mini, contacts);
    } else {
        findContacts(sj, si, sj._normals[indexj], minj, contacts);
    }
}


function collisionType(si, sj, contacts) {
    var siType = si.type,
        sjType = sj.type;

    if (siType === ShapeType.Circle) {

        if (sjType === ShapeType.Circle) {
            circleCircle(si, sj, contacts);
        } else if (sjType === ShapeType.Segment) {
            segmentCircle(sj, si, contacts);
        } else if (sjType === ShapeType.Convex) {
            convexCircle(sj, si, contacts);
        }
    } else if (siType === ShapeType.Convex) {

        if (sjType === ShapeType.Circle) {
            convexCircle(si, sj, contacts);
        } else if (sjType === ShapeType.Segment) {
            convexSegment(si, sj, contacts);
        } else if (sjType === ShapeType.Convex) {
            convexConvex(si, sj, contacts);
        }
    } else if (siType === ShapeType.Segment) {

        if (sjType === ShapeType.Circle) {
            segmentCircle(si, sj, contacts);
        } else if (sjType === ShapeType.Segment) {
            segmentSegment(si, sj, contacts);
        } else if (sjType === ShapeType.Convex) {
            convexSegment(sj, si, contacts);
        }
    }
}


module.exports = P2Nearphase;

},{"../../base/object_pool":15,"../../math/mathf":107,"../../math/vec2":111,"../constraints/p2contact":118,"../p2enums":128}],117:[function(require,module,exports){
var EventEmitter = require("../../base/event_emitter");
"use strict";

/**
 * @class P2Constraint
 * @extends Class
 * @brief 2d contact equation
 */
function P2Constraint(bi, bj) {

    EventEmitter.call(this);

    /**
     * @property P2Body bj
     * @memberof P2Constraint
     */
    this.bi = bi;

    /**
     * @property P2Body bj
     * @memberof P2Constraint
     */
    this.bj = bj;

    /**
     * @property Array equations
     * @memberof P2Constraint
     */
    this.equations = [];
}

EventEmitter.extend(P2Constraint);


P2Constraint.prototype.update = function () {

};


module.exports = P2Constraint;

},{"../../base/event_emitter":13}],118:[function(require,module,exports){
var Class = require("../../base/class");
var Mathf = require("../../math/mathf");
var Vec2 = require("../../math/vec2");
var P2Equation = require("../constraints/p2equation");
"use strict";


/**
 * @class P2Contact
 * @extends P2Equation
 * @brief 2d contact equation
 */
function P2Contact() {

    P2Equation.call(this);

    this.minForce = 0.0;

    /**
     * @property Vec2 p
     * @memberof P2Contact
     */
    this.p = new Vec2;

    /**
     * @property Vec2 n
     * @memberof P2Contact
     */
    this.n = new Vec2;

    /**
     * @property Number s
     * @memberof P2Contact
     */
    this.s = 0.0;

    /**
     * @property Number e
     * @memberof P2Contact
     */
    this.e = 1.0;

    /**
     * @property Number u
     * @memberof P2Contact
     */
    this.u = 1.0;

    this.ri = new Vec2;
    this.rj = new Vec2;

    this.rixn = 0;
    this.rjxn = 0;
}

P2Equation.extend(P2Contact);


P2Contact.prototype.init = function (h) {
    var bi = this.bi,
        bj = this.bj,

        p = this.p,
        px = p.x,
        py = p.y,
        n = this.n,
        nx = n.x,
        ny = n.y,

        xi = bi.position,
        xj = bj.position,

        ri = this.ri,
        rix = px - xi.x,
        riy = py - xi.y,

        rj = this.rj,
        rjx = px - xj.x,
        rjy = py - xj.y,

        rixn = rix * ny - riy * nx,
        rjxn = rjx * ny - rjy * nx;

    ri.x = rix;
    ri.y = riy;

    rj.x = rjx;
    rj.y = rjy;

    this.rixn = rixn;
    this.rjxn = rjxn;

    this.lambda = 0;
    this.calculateB(h);
    this.calculateC();
};


P2Contact.prototype.calculateB = function (h) {
    var bi = this.bi,
        bj = this.bj,

        n = this.n,
        nx = n.x,
        ny = n.y,

        vi = bi.velocity,
        wi = bi.angularVelocity,
        fi = bi.force,
        ti = bi.torque,
        invMi = bi.invMass,
        invIi = bi.invInertia,

        vj = bj.velocity,
        wj = bj.angularVelocity,
        fj = bj.force,
        tj = bj.torque,
        invMj = bj.invMass,
        invIj = bj.invInertia,

        ri = this.ri,
        rix = ri.x,
        riy = ri.y,
        rj = this.rj,
        rjx = rj.x,
        rjy = rj.y,

        e = this.e,

        Gq = this.s,

        GWx = vj.x + (-wj * rjy) - vi.x - (-wi * riy),
        GWy = vj.y + (wj * rjx) - vi.y - (wi * rix),
        GW = e * GWx * nx + e * GWy * ny,

        GiMfx = fj.x * invMj + (-tj * invIj * rjy) - fi.x * invMi - (-ti * invIi * riy),
        GiMfy = fj.y * invMj + (tj * invIj * rjx) - fi.y * invMi - (ti * invIi * rix),
        GiMf = GiMfx * nx + GiMfy * ny;

    this.B = -this.a * Gq - this.b * GW - h * GiMf;
};


P2Contact.prototype.calculateC = function () {
    var bi = this.bi,
        bj = this.bj,

        rixn = this.rixn,
        rjxn = this.rjxn,

        invIi = bi.invInertia,
        invIj = bj.invInertia,

        C = bi.invMass + bj.invMass + this.epsilon + invIi * rixn * rixn + invIj * rjxn * rjxn;

    this.invC = C === 0 ? 0 : 1 / C;
};


P2Contact.prototype.calculateGWlambda = function () {
    var bi = this.bi,
        bj = this.bj,

        n = this.n,

        vlambdai = bi.vlambda,
        wlambdai = bi.wlambda,
        vlambdaj = bj.vlambda,
        wlambdaj = bj.wlambda,

        ulambdax = vlambdaj.x - vlambdai.x,
        ulambday = vlambdaj.y - vlambdai.y,

        GWlambda = ulambdax * n.x + ulambday * n.y;

    if (wlambdai != undefined) GWlambda -= wlambdai * this.rixn;
    if (wlambdaj != undefined) GWlambda += wlambdaj * this.rjxn;

    return GWlambda;
};


P2Contact.prototype.addToLambda = function (deltaLambda) {
    var bi = this.bi,
        bj = this.bj,

        n = this.n,
        nx = n.x,
        ny = n.y,

        invMi = bi.invMass,
        vlambdai = bi.vlambda,
        invMj = bj.invMass,
        vlambdaj = bj.vlambda;

    vlambdai.x -= deltaLambda * invMi * nx;
    vlambdai.y -= deltaLambda * invMi * ny;

    vlambdaj.x += deltaLambda * invMj * nx;
    vlambdaj.y += deltaLambda * invMj * ny;

    if (bi.wlambda != undefined) bi.wlambda -= deltaLambda * bi.invInertia * this.rixn;
    if (bj.wlambda != undefined) bj.wlambda += deltaLambda * bj.invInertia * this.rjxn;
};


module.exports = P2Contact;

},{"../../base/class":8,"../../math/mathf":107,"../../math/vec2":111,"../constraints/p2equation":120}],119:[function(require,module,exports){
var P2Constraint = require("./p2constraint");
var P2Contact = require("./p2contact");
"use strict";


var sqrt = Math.sqrt;


/**
 * @class P2DistanceConstraint
 * @extends P2Constraint
 * @brief 2d contact equation
 */
function P2DistanceConstraint(bi, bj, distance, maxForce) {

    P2Constraint.call(this, bi, bj);

    this.distance = distance || (distance = 1);
    maxForce || (maxForce = 1e6);

    var distanceEquation = this._distanceEquation = new P2Contact();
    distanceEquation.bi = bi;
    distanceEquation.bj = bj;
    distanceEquation.minForce = -maxForce;
    distanceEquation.maxForce = maxForce;
    console.log(distanceEquation);

    this.equations.push(distanceEquation);
}

P2Constraint.extend(P2DistanceConstraint);


P2DistanceConstraint.prototype.update = function () {
    var distanceEquation = this._distanceEquation,
        distance = this.distance,
        bi = this.bi,
        bj = this.bj,
        n = distanceEquation.n,
        ri = distanceEquation.ri,
        rj = distanceEquation.rj,
        xi = bi.position,
        xj = bj.position,
        nx = xj.x - xi.x,
        ny = xj.y - xi.y,
        len = nx * nx + ny * ny,
        invLen = len === 0 ? 0 : 1 / (len = sqrt(len))

    nx *= invLen;
    ny *= invLen;
    n.x = nx;
    n.y = ny;

    ri.x = nx * distance * 0.5;
    ri.y = ny * distance * 0.5;

    rj.x = nx * distance * -0.5;
    rj.y = ny * distance * -0.5;
};


module.exports = P2DistanceConstraint;

},{"./p2constraint":117,"./p2contact":118}],120:[function(require,module,exports){
var EventEmitter = require("../../base/event_emitter");
"use strict";

/**
 * @class P2Equation
 * @extends Class
 * @brief 2d contact equation
 */
function P2Equation() {

    EventEmitter.call(this);

    /**
     * @property P2Body bj
     * @memberof P2Equation
     */
    this.bi = undefined;

    /**
     * @property P2Body bj
     * @memberof P2Equation
     */
    this.bj = undefined;

    /**
     * @property Number minForce
     * @memberof P2Equation
     */
    this.minForce = -Number.MAX_VALUE;

    /**
     * @property Number maxForce
     * @memberof P2Equation
     */
    this.maxForce = Number.MAX_VALUE;

    /**
     * @property Number relaxation
     * @brief number of timesteps it takesto stabilize the constraint
     * @memberof P2Equation
     */
    this.relaxation = 4;

    /**
     * @property Number stiffness
     * @brief spring constant
     * @memberof P2Equation
     */
    this.stiffness = 1e6;

    this.a = 0;
    this.b = 0;
    this.epsilon = 0;

    this.lambda = 0;
    this.B = 0;
    this.invC = 0;
}

EventEmitter.extend(P2Equation);


P2Equation.prototype.updateConstants = function (h) {
    var k = this.stiffness,
        d = this.relaxation;

    this.a = 4.0 / (h * (1.0 + 4.0 * d));
    this.b = (4.0 * d) / (1.0 + 4.0 * d);
    this.epsilon = 4.0 / (h * h * k * (1.0 + 4.0 * d));
};


module.exports = P2Equation;

},{"../../base/event_emitter":13}],121:[function(require,module,exports){
var Class = require("../../base/class");
var Mathf = require("../../math/mathf");
var Vec2 = require("../../math/vec2");
var P2Equation = require("./p2equation");
"use strict";


/**
 * @class P2Friction
 * @extends P2Equation
 * @brief 2d contact equation
 */
function P2Friction() {

    P2Equation.call(this);

    /**
     * @property Vec2 p
     * @memberof P2Friction
     */
    this.p = new Vec2;

    /**
     * @property Vec2 t
     * @memberof P2Friction
     */
    this.t = new Vec2;

    this.ri = new Vec2;
    this.rj = new Vec2;

    this.rixt = 0;
    this.rjxt = 0;
}

P2Equation.extend(P2Friction);


P2Friction.prototype.init = function (h) {
    var bi = this.bi,
        bj = this.bj,

        p = this.p,
        px = p.x,
        py = p.y,
        t = this.t,
        tx = t.x,
        ty = t.y,

        xi = bi.position,
        xj = bj.position,

        ri = this.ri,
        rix = px - xi.x,
        riy = py - xi.y,

        rj = this.rj,
        rjx = px - xj.x,
        rjy = py - xj.y,

        rixt = rix * ty - riy * tx,
        rjxt = rjx * ty - rjy * tx;

    ri.x = rix;
    ri.y = riy;

    rj.x = rjx;
    rj.y = rjy;

    this.rixt = rixt;
    this.rjxt = rjxt;

    this.lambda = 0;
    this.calculateB(h);
    this.calculateC();
};


P2Friction.prototype.calculateB = function (h) {
    var bi = this.bi,
        bj = this.bj,

        t = this.t,
        tx = t.x,
        ty = t.y,

        vi = bi.velocity,
        wi = bi.angularVelocity,
        fi = bi.force,
        ti = bi.torque,
        invMi = bi.invMass,
        invIi = bi.invInertia,

        vj = bj.velocity,
        wj = bj.angularVelocity,
        fj = bj.force,
        tj = bj.torque,
        invMj = bj.invMass,
        invIj = bj.invInertia,

        ri = this.ri,
        rix = ri.x,
        riy = ri.y,
        rj = this.rj,
        rjx = rj.x,
        rjy = rj.y,

        Gq = 0,

        GWx = vj.x + (-wj * rjy) - vi.x - (-wi * riy),
        GWy = vj.y + (wj * rjx) - vi.y - (wi * rix),
        GW = GWx * tx + GWy * ty,

        GiMfx = fj.x * invMj + (-tj * invIj * rjy) - fi.x * invMi - (-ti * invIi * riy),
        GiMfy = fj.y * invMj + (tj * invIj * rjx) - fi.y * invMi - (ti * invIi * rix),
        GiMf = GiMfx * tx + GiMfy * ty;

    this.B = -this.a * Gq - this.b * GW - h * GiMf;
};


P2Friction.prototype.calculateC = function () {
    var bi = this.bi,
        bj = this.bj,

        rixt = this.rixt,
        rjxt = this.rjxt,

        invIi = bi.invInertia,
        invIj = bj.invInertia,

        C = bi.invMass + bj.invMass + this.epsilon + invIi * rixt * rixt + invIj * rjxt * rjxt;

    this.invC = C === 0 ? 0 : 1 / C;
};


P2Friction.prototype.calculateGWlambda = function () {
    var bi = this.bi,
        bj = this.bj,

        t = this.t,

        vlambdai = bi.vlambda,
        wlambdai = bi.wlambda,
        vlambdaj = bj.vlambda,
        wlambdaj = bj.wlambda,

        ulambdax = vlambdaj.x - vlambdai.x,
        ulambday = vlambdaj.y - vlambdai.y,

        GWlambda = ulambdax * t.x + ulambday * t.y;

    if (wlambdai != undefined) GWlambda -= wlambdai * this.rixt;
    if (wlambdaj != undefined) GWlambda += wlambdaj * this.rjxt;

    return GWlambda;
};


P2Friction.prototype.addToLambda = function (deltaLambda) {
    var bi = this.bi,
        bj = this.bj,

        t = this.t,
        tx = t.x,
        ty = t.y,

        invMi = bi.invMass,
        vlambdai = bi.vlambda,
        invMj = bj.invMass,
        vlambdaj = bj.vlambda;

    vlambdai.x -= deltaLambda * invMi * tx;
    vlambdai.y -= deltaLambda * invMi * ty;

    vlambdaj.x += deltaLambda * invMj * tx;
    vlambdaj.y += deltaLambda * invMj * ty;

    if (bi.wlambda != undefined) bi.wlambda -= deltaLambda * bi.invInertia * this.rixt;
    if (bj.wlambda != undefined) bj.wlambda += deltaLambda * bj.invInertia * this.rjxt;
};


module.exports = P2Friction;

},{"../../base/class":8,"../../math/mathf":107,"../../math/vec2":111,"./p2equation":120}],122:[function(require,module,exports){
var Class = require("../../base/class");
var P2Enums = require("../p2enums");
var P2Shape = require("./p2shape");
"use strict";


var ShapeType = P2Enums.ShapeType,

    abs = Math.abs,
    PI = Math.PI;


function P2Circle(opts) {
    opts || (opts = {});

    P2Shape.call(this, opts);

    this.type = ShapeType.Circle;
    this.radius = opts.radius != undefined ? abs(opts.radius) : 0.5;
}

P2Shape.extend(P2Circle);


P2Circle.prototype.copy = function (other) {
    P2Shape.prototype.copy.call(this, other);

    this.radius = other.radius;

    return this;
};


P2Circle.prototype.pointQuery = function (p) {
    var x = this.position,
        dx = x.x - p.x,
        dy = x.y - p.y,
        r = this.radius;

    return (dx * dx + dy * dy) < r * r;
};


P2Circle.prototype.centroid = function (v) {
    var localPosition = this.localPosition;

    v.x = localPosition.x;
    v.y = localPosition.y;

    return v;
};


P2Circle.prototype.area = function () {
    var r = this.radius;

    return PI * (r * r);
};


P2Circle.prototype.inertia = function (mass) {
    var r = this.radius,
        localPosition = this.localPosition,
        lx = localPosition.x,
        ly = localPosition.y;

    return mass * ((r * r * 0.5) + (lx * lx + ly * ly));
};


P2Circle.prototype.update = function (matrix) {
    var localMatrix = this.matrix,
        matrixWorld = this.matrixWorld,
        localPosition = this.localPosition,
        pos = this.position,
        r = this.radius,
        aabb = this.aabb,
        min = aabb.min,
        max = aabb.max,
        x, y;

    localMatrix.setRotation(this.localRotation);
    localMatrix.setPosition(localPosition);
    matrixWorld.mmul(matrix, localMatrix);

    pos.x = localPosition.x;
    pos.y = localPosition.y;
    pos.transformMat32(matrix);
    x = pos.x;
    y = pos.y;

    min.x = x - r;
    min.y = y - r;
    max.x = x + r;
    max.y = y + r;
};


P2Circle.prototype.toJSON = function (json) {
    json = P2Shape.prototype.toJSON.call(this, json);

    json.radius = this.radius;

    return json;
};


P2Circle.prototype.fromJSON = function (json) {
    P2Shape.prototype.fromJSON.call(this, json);

    this.radius = json.radius;

    return this;
};


module.exports = P2Circle;

},{"../../base/class":8,"../p2enums":128,"./p2shape":127}],123:[function(require,module,exports){
var Vec2 = require("../../math/vec2");
var Log = require("../../base/log");
var P2Enums = require("../p2enums");
var P2Shape = require("./p2shape");
"use strict";


var ShapeType = P2Enums.ShapeType;


function P2Convex(opts) {
    opts || (opts = {});

    P2Shape.call(this, opts);

    this.type = ShapeType.Convex;

    this.vertices = opts.vertices != undefined ? opts.vertices : [
        new Vec2(0.5, 0.5),
        new Vec2(-0.5, 0.5),
        new Vec2(-0.5, -0.5),
        new Vec2(0.5, -0.5)
    ];

    if (!P2Convex.validateVertices(this.vertices)) {
        log.warn("P2Convex.constructor: passed vertices are invalid, creating convex hull from vertices with gift wrapping algorithm");
        this.vertices = P2Convex.createConvexHull(this.vertices);
    }

    this.normals = [];

    this._vertices = [];
    this._normals = [];

    var vertices = this.vertices,
        wverts = this._vertices,
        normals = this.normals,
        wnorms = this._normals,
        v1, v2,
        i;

    i = vertices.length;
    while (i--) {
        v1 = vertices[i];
        v2 = vertices[i + 1] || vertices[0];

        normals[i] = new Vec2(v2.y - v1.y, -(v2.x - v1.x)).normalize();

        wverts[i] = new Vec2(v1);
        wnorms[i] = new Vec2(normals[i]);
    }
}

P2Shape.extend(P2Convex);


P2Convex.prototype.copy = function (other) {
    P2Shape.prototype.copy.call(this, other);
    var vertices = other.vertices,
        normals = other.normals,
        i;

    this.vertices.length = this.normals.length = this._vertices.length = this._normals.length = 0;

    i = vertices.length;
    while (i--) this.vertices[i] = vertices[i].clone();

    i = normals.length;
    while (i--) this.normals[i] = normals[i].clone();

    return this;
};


P2Convex.prototype.pointQuery = function (p) {
    if (!this.aabb.contains(p)) return false;
    var vertices = this._vertices,
        normals = this._normals,
        px = p.x,
        py = p.y,
        n, nx, ny, v, vx, vy,
        i = vertices.length;
    ;

    while (i--) {
        n = normals[i];
        nx = n.x;
        ny = n.y;
        v = vertices[i];
        vx = v.x;
        vy = v.y;

        if ((nx * px + ny * py) - (nx * vx + ny * vy) > 0) return false;
    }

    return true;
}


P2Convex.prototype.centroid = function () {
    var v1 = new Vec2,
        v2 = new Vec2,
        vsum = new Vec2;

    return function (v) {
        var localPosition = this.localPosition,
            vertices = this.vertices,
            len = vertices.length,
            v1x, v1y, v2x, v2y, area = 0,
            cross,
            i = len;

        vsum.x = vsum.y = 0;

        while (i--) {
            v1.vadd(localPosition, vertices[i]);
            v2.vadd(localPosition, vertices[(i + 1) % len]);

            v1x = v1.x;
            v1y = v1.y;
            v2x = v2.x;
            v2y = v2.y;

            cross = v1x * v2y - v1y * v2x;
            area += cross;

            vsum.x += (v1x + v2x) * cross;
            vsum.y += (v1y + v2y) * cross;
        }

        return v.copy(vsum).smul(1 / (3 * area));
    };
}();


P2Convex.prototype.area = function () {
    var vertices = this.vertices,
        len = vertices.length,
        v1, v2, area = 0,
        i = len;

    while (i--) {
        v1 = vertices[i];
        v2 = vertices[(i + 1) % len];

        area += v1.x * v2.y - v1.y * v2.x;
    }

    return area * 0.5;
};


P2Convex.prototype.inertia = function () {
    var v1 = new Vec2,
        v2 = new Vec2;

    return function (mass) {
        var localPosition = this.localPosition,
            vertices = this.vertices,
            len = vertices.length,
            v1x, v1y, v2x, v2y, a = 0,
            b = 0,
            sum1 = 0,
            sum2 = 0,
            i = len;

        while (i--) {
            v1.vadd(localPosition, vertices[i]);
            v2.vadd(localPosition, vertices[(i + 1) % len]);

            v1x = v1.x;
            v1y = v1.y;
            v2x = v2.x;
            v2y = v2.y;

            a = v2x * v1y - v2y * v1x;
            b = (v1x * v1x + v1y * v1y) + (v1x * v2x + v1y * v2y) + (v2x * v2x + v2y * v2y);

            sum1 += a * b;
            sum2 += a;
        }

        return (mass * sum1) / (6 * sum2);
    };
}();


P2Convex.prototype.update = function (matrix) {
    var localMatrix = this.matrix,
        matrixWorld = this.matrixWorld,
        localPos = this.localPosition,

        vertices = this.vertices,
        normals = this.normals,
        pos = this.position,

        aabb = this.aabb,
        min = aabb.min,
        max = aabb.max,
        minx = Infinity,
        miny = Infinity,
        maxx = -Infinity,
        maxy = -Infinity,

        wnorms = this._normals,
        wnorm, wverts = this._vertices,
        wvert, x, y,
        i = vertices.length;

    localMatrix.setRotation(this.localRotation);
    localMatrix.setPosition(localPos);
    matrixWorld.mmul(matrix, localMatrix);

    pos.x = localPos.x;
    pos.y = localPos.y;
    pos.transformMat32(matrix);

    while (i--) {
        wvert = wverts[i] || (wverts[i] = new Vec2);
        wnorm = wnorms[i] || (wnorms[i] = new Vec2);

        wnorm.copy(normals[i]).transformMat2(matrixWorld);
        wvert.copy(vertices[i]).transformMat32(matrixWorld);
        x = wvert.x;
        y = wvert.y;

        minx = x < minx ? x : minx;
        miny = y < miny ? y : miny;

        maxx = x > maxx ? x : maxx;
        maxy = y > maxy ? y : maxy;
    }

    min.x = minx;
    min.y = miny;
    max.x = maxx;
    max.y = maxy;
};


P2Convex.prototype.toJSON = function (json) {
    json = P2Shape.prototype.toJSON.call(this, json);
    var vertices = this.vertices,
        normals = this.normals,
        jsonVertices = json.vertices || (json.vertices = []),
        jsonNormals = json.normals || (json.normals = []),
        i;

    i = vertices.length;
    while (i--) jsonVertices[i] = vertices[i].toJSON(jsonVertices[i]);

    i = normals.length;
    while (i--) jsonNormals[i] = normals[i].toJSON(jsonNormals[i]);

    return json;
};


P2Convex.prototype.fromJSON = function (json) {
    P2Shape.prototype.fromJSON.call(this, json);
    var vertices = this.vertices,
        normals = this.normals,
        jsonVertices = json.vertices,
        jsonNormals = json.normals,
        verticesLength = jsonVertices.length,
        normalsLength = jsonNormals.length,
        i;

    vertices.length = this._vertices.length = verticesLength;
    normals.length = this._normals.length = normalsLength;

    i = verticesLength;
    while (i--) vertices[i] = (vertices[i] || new Vec2()).fromJSON(jsonVertices[i]);

    i = normalsLength;
    while (i--) normals[i] = (normals[i] || new Vec2()).fromJSON(jsonNormals[i]);

    return this;
};


P2Convex.validateVertices = P2Convex.prototype.validateVertices = function (vertices) {
    var len = vertices.length,
        a, b, bx, by, c, abx, aby, bcx, bcy,
        i;

    for (i = 0; i < len; i++) {
        a = vertices[i];
        b = vertices[(i + 1) % len];
        bx = b.x;
        by = b.y;
        c = vertices[(i + 2) % len];

        abx = bx - a.x;
        aby = by - a.y;
        bcx = c.x - bx;
        bcy = c.y - by;

        if ((bcx * aby - bcy * abx) > 0) return false;
    }

    return true;
};


P2Convex.createConvexHull = P2Convex.prototype.createConvexHull = function () {
    var hull = [],
        r = new Vec2;

    return function (points) {
        var rmi = 0,
            rmx = -Infinity,
            n = points.length,
            v, vx, vy,
            ih, ie, m = 0,
            c, newPoints = [],
            failed = false,
            i;

        for (i = n; i--;) {
            v = points[i];
            vx = v.x;
            vy = v.y;

            if (vx > rmx || (vx == rmx && vy < points[rmi].y)) {
                rmi = i;
                rmx = vx;
            }
        }

        hull.length = 0;
        ih = rmi;

        while (true) {
            hull[m] = ih;

            ie = 0;
            for (i = 1; i < n; i++) {
                if (ie === ih) {
                    ie = i;
                    continue;
                }

                r.vsub(points[ie], points[hull[m]]);
                v.vsub(points[i], points[hull[m]]);
                c = v.cross(r);

                if (c < 0) ie = i;

                if (c === 0 && v.lenSq() > r.lenSq()) {
                    ie = i;
                }
            }

            m++;
            ih = ie;

            if (m > n) {
                failed = true;
                break;
            }
            if (ie === rmi) break;
        }

        if (failed) {
            Log.warn("P2Convex.constructor: gift wrapping algorithm failed");
            return [
                new Vec2(0.5, 0.5),
                new Vec2(-0.5, 0.5),
                new Vec2(-0.5, -0.5),
                new Vec2(0.5, -0.5)
            ];
        }

        for (i = m; i--;) {
            newPoints.push(points[hull[i]]);
        }

        if (!P2Convex.validateVertices(newPoints)) {
            Log.warn("P2Convex.constructor: gift wrapping algorithm failed");
            return [
                new Vec2(0.5, 0.5),
                new Vec2(-0.5, 0.5),
                new Vec2(-0.5, -0.5),
                new Vec2(0.5, -0.5)
            ];
        }

        return newPoints;
    };
}();


module.exports = P2Convex;

},{"../../base/log":14,"../../math/vec2":111,"../p2enums":128,"./p2shape":127}],124:[function(require,module,exports){
var Vec2 = require("../../math/vec2");
var P2Convex = require("./p2convex");
"use strict";


function P2Rect(opts) {
    opts || (opts = {});

    var extents = opts.extents || new Vec2(0.5, 0.5),
        x = extents.x,
        y = extents.y;

    opts.vertices = [
        new Vec2(x, y),
        new Vec2(-x, y),
        new Vec2(-x, -y),
        new Vec2(x, -y)
    ];

    P2Convex.call(this, opts);

    this.extents = extents;
}

P2Convex.extend(P2Rect);


P2Rect.prototype.toJSON = function (json) {
    json = P2Convex.prototype.toJSON.call(this, json);

    json.extents = this.extents.toJSON(json.extents);

    return json;
};


P2Rect.prototype.fromJSON = function (json) {
    P2Convex.prototype.fromJSON.call(this, json);

    this.extents.fromJSON(json.extents);

    return this;
};


module.exports = P2Rect;

},{"../../math/vec2":111,"./p2convex":123}],125:[function(require,module,exports){
var Class = require("../../base/class");
var AABB2 = require("../../math/aabb2");
var Vec2 = require("../../math/vec2");
var Mat32 = require("../../math/mat32");
var Log = require("../../base/log");
var P2Enums = require("../p2enums");
"use strict";


var TWO_PI = Math.PI * 2,
    pow = Math.pow,

    BodyType = P2Enums.BodyType,
    MotionState = P2Enums.MotionState,
    SleepState = P2Enums.SleepState;


function P2Rigidbody(opts) {
    opts || (opts = {});

    Class.call(this, opts);

    this.type = BodyType.RigidBody;
    this._index = -1;

    this.space = undefined;

    this.position = opts.position != undefined ? opts.position : new Vec2;
    this.velocity = opts.velocity != undefined ? opts.velocity : new Vec2;
    this.force = new Vec2;

    this.rotation = opts.rotation != undefined ? opts.rotation : 0;
    this.angularVelocity = opts.angularVelocity != undefined ? opts.angularVelocity : 0;
    this.torque = 0;

    this.linearDamping = opts.linearDamping != undefined ? opts.linearDamping : 0.01;
    this.angularDamping = opts.angularDamping != undefined ? opts.angularDamping : TWO_PI * 0.01;

    this.matrix = new Mat32();
    this.aabb = new AABB2;

    this.mass = opts.mass != undefined ? opts.mass : 0.0;
    this.invMass = this.mass > 0.0 ? 1.0 / this.mass : 0.0;

    this.inertia = 0;
    this.invInertia = 0;

    this.shapes = [];

    this.motionState = opts.motionState != undefined ? opts.motionState : MotionState.Static;

    this.allowSleep = opts.allowSleep != undefined ? !!opts.allowSleep : true;
    this.sleepState = SleepState.Awake;

    this.sleepVelocityLimit = opts.sleepVelocityLimit != undefined ? !!opts.sleepVelocityLimit : 0.01;
    this.sleepTimeLimit = opts.sleepTimeLimit != undefined ? !!opts.sleepTimeLimit : 1.0;
    this.sleepAngularVelocityLimit = opts.sleepAngularVelocityLimit != undefined ? !!opts.sleepAngularVelocityLimit : TWO_PI * 0.01;

    this.userData = undefined;

    this._sleepTime = 0.0;
    this._lastSleepyTime = 0.0;

    this.vlambda = new Vec2;
    this.wlambda = 0;

    if (opts.shape) this.addShape(opts.shape);
    if (opts.shapes) this.addShapes.apply(this, opts.shapes);
}

Class.extend(P2Rigidbody);


P2Rigidbody.prototype.copy = function (other) {
    var shapes = other.shapes,
        i = shapes.length;

    this.clear();

    this.motionState = other.motionState;

    this.position.copy(other.position);
    this.velocity.copy(other.velocity);
    this.force.copy(other.force);

    this.linearDamping = other.linearDamping;

    this.mass = other.mass;
    this.invMass = other.invMass;

    this.allowSleep = other.allowSleep;
    this.sleepState = other.sleepState;

    this.rotation = other.rotation;
    this.angularVelocity = other.angularVelocity;
    this.torque = other.torque;

    this.angularDamping = other.angularDamping;

    while (i--) this.addShape(shapes[i].clone());

    return this;
};


var VEC2_SCALE = new Vec2(1.0, 1.0);
P2Rigidbody.prototype.init = function () {
    var shapes = this.shapes,
        matrix = this.matrix,
        aabb = this.aabb,
        shape,
        i = shapes.length;

    matrix.compose(this.position, VEC2_SCALE, this.rotation);
    aabb.clear();

    while (i--) {
        shape = shapes[i];
        shape.update(matrix);
        aabb.union(shape.aabb);
    }

    this.resetMassData();
};


P2Rigidbody.prototype.update = function (dt) {
    if (this.motionState === MotionState.Static) return;
    var shapes = this.shapes,
        force = this.force,
        invMass = this.invMass,
        pos = this.position,
        vel = this.velocity,
        linearDamping = pow(1 - this.linearDamping, dt),
        matrix = this.matrix,
        aabb = this.aabb,
        shape,
        i;

    vel.x += force.x * invMass * dt;
    vel.y += force.y * invMass * dt;
    this.angularVelocity += this.torque * this.invInertia * dt;

    force.x = force.y = this.torque = 0;

    vel.x *= linearDamping;
    vel.y *= linearDamping;

    this.angularVelocity *= pow(1 - this.angularDamping, dt);

    if (this.sleepState !== SleepState.Sleeping) {

        pos.x += vel.x * dt;
        pos.y += vel.y * dt;

        this.rotation += this.angularVelocity * dt;

        matrix.compose(pos, VEC2_SCALE, this.rotation);
        aabb.clear();

        i = shapes.length;
        while (i--) {
            shape = shapes[i];
            shape.update(matrix);
            aabb.union(shape.aabb);
        }
    }
};


P2Rigidbody.prototype.clear = function () {
    var shapes = this.shapes,
        i = shapes.length;

    while (i--) this.removeShape(shapes[i]);

    return this;
};


P2Rigidbody.prototype.applyForce = function (force, worldPoint) {
    if (this.motionState === MotionState.Static) return;
    if (this.sleepState === SleepState.Sleeping) this.wake();
    var pos = this.position,
        f = this.force,
        fx = force.x,
        fy = force.y,
        px, py;

    worldPoint = worldPoint || pos;

    px = worldPoint.x - pos.x;
    py = worldPoint.y - pos.y;

    f.x += fx;
    f.y += fy;

    this.torque += px * fy - py * fx;
};


P2Rigidbody.prototype.applyTorque = function (torque) {
    if (this.motionState === MotionState.Static) return;
    if (this.sleepState === SleepState.Sleeping) this.wake();

    this.torque += torque;
};


P2Rigidbody.prototype.applyImpulse = function (impulse, worldPoint) {
    if (this.motionState === MotionState.Static) return;
    if (this.sleepState === SleepState.Sleeping) this.wake();
    var pos = this.position,
        invMass = this.invMass,
        velocity = this.velocity,
        ix = impulse.x,
        iy = impulse.y,
        px, py;

    worldPoint = worldPoint || pos;

    px = worldPoint.x - pos.x;
    py = worldPoint.y - pos.y;

    velocity.x += ix * invMass;
    velocity.y += iy * invMass;

    this.angularVelocity += (px * iy - py * ix) * this.invInertia;
};


P2Rigidbody.prototype.applyVelocity = function (velocity) {
    if (this.motionState === MotionState.Static) return;
    if (this.sleepState === SleepState.Sleeping) this.wake();
    var vel = this.velocity;

    vel.x += velocity.x;
    vel.y += velocity.y;
};


P2Rigidbody.prototype.applyAngularVelocity = function (angularVelocity) {
    if (this.motionState === MotionState.Static) return;
    if (this.sleepState === SleepState.Sleeping) this.wake();

    this.angularVelocity += angularVelocity;
};


var totalCentroid = new Vec2,
    centroid = new Vec2;
P2Rigidbody.prototype.resetMassData = function () {
    if (this.motionState !== MotionState.Dynamic) return;
    var shapes = this.shapes,
        shape,
        totalMass = 0,
        totalInertia = 0,
        mass, inertia,
        i;

    totalCentroid.x = totalCentroid.y = 0;

    i = shapes.length;
    while (i--) {
        shape = shapes[i];

        shape.centroid(centroid);
        mass = shape.area() * shape.density;
        inertia = shape.inertia(mass);

        totalCentroid.add(centroid.smul(mass));
        totalMass += mass;
        totalInertia += inertia;
    }

    centroid.copy(totalCentroid.sdiv(totalMass));

    this.setMass(totalMass);
    this.setInertia(totalInertia - totalMass * centroid.lengthSq());
};


P2Rigidbody.prototype.setMotionState = function (motionState) {
    if (this.motionState === motionState) return;

    this.motionState = motionState;

    this.velocity.set(0, 0);
    this.force.set(0, 0);
    this.angularVelocity = this.torque = 0;

    this.wake();
};


P2Rigidbody.prototype.setInertia = function (inertia) {

    this.inertia = inertia;
    this.invInertia = inertia > 0.0 ? 1.0 / inertia : 0.0;
};


P2Rigidbody.prototype.setMass = function (mass) {

    this.mass = mass;
    this.invMass = mass > 0.0 ? 1.0 / mass : 0.0;
};


P2Rigidbody.prototype.isAwake = function () {

    return this.sleepState === SleepState.Awake;
};


P2Rigidbody.prototype.isSleepy = function () {

    return this.sleepState === SleepState.Sleepy;
};


P2Rigidbody.prototype.isSleeping = function () {

    return this.sleepState === SleepState.Sleeping;
};


P2Rigidbody.prototype.isStatic = function () {

    return this.motionState === MotionState.Static;
};


P2Rigidbody.prototype.isDynamic = function () {

    return this.motionState === MotionState.Dynamic;
};


P2Rigidbody.prototype.isKinematic = function () {

    return this.motionState === MotionState.Kinematic;
};


P2Rigidbody.prototype.wake = function () {

    if (this.sleepState === SleepState.Sleeping) this.emit("wake");
    this.sleepState = SleepState.Awake;
};


P2Rigidbody.prototype.sleep = function () {

    if (this.sleepState !== SleepState.Sleeping) this.emit("sleep");
    this.sleepState = SleepState.Sleeping;
};


P2Rigidbody.prototype.addShape = function (shape) {
    var shapes = this.shapes,
        index = shapes.indexOf(shape);

    if (index === -1) {
        shape.body = this;

        shapes.push(shape);

        if (this.space) {
            shape.update(this.matrix);
            this.resetMassData();
        }
    } else {
        Log.error("P2Rigidbody.addShape: Shape already attached to Body");
    }

    return this;
};


P2Rigidbody.prototype.addShapes = function () {

    for (var i = arguments.length; i--;) this.addShape(arguments[i]);
    return this;
};


P2Rigidbody.prototype.removeShape = function (shape) {
    var shapes = this.shapes,
        index = shapes.indexOf(shape);

    if (index !== -1) {
        shape.body = undefined;

        shapes.splice(index, 1);

        if (this.space) this.resetMassData();
    } else {
        Log.error("P2Rigidbody.removeShape: Shape not attached to Body");
    }

    return this;
};


P2Rigidbody.prototype.removeShapes = function () {

    for (var i = arguments.length; i--;) this.removeShape(arguments[i]);
    return this;
};


P2Rigidbody.prototype.forEachShape = function (fn, ctx) {
    var shapes = this.shapes,
        i = shapes.length;

    if (ctx) {
        while (i--) {
            if (fn.call(ctx, shapes[i], i, shapes) === false) break;
        }
    } else {
        while (i--) {
            if (fn(shapes[i], i, shapes) === false) break;
        }
    }

    return this;
};


P2Rigidbody.prototype.sleepTick = function (time) {

    if (this.allowSleep) {
        var sleepState = this.sleepState,
            velSq = this.velocity.lengthSq(),
            sleepVelocityLimit = this.sleepVelocityLimit * this.sleepVelocityLimit,
            aVel = this.angularVelocity,
            sleepAngularVelocityLimit = this.sleepAngularVelocityLimit;

        if (sleepState === SleepState.Awake && (velSq < sleepVelocityLimit && aVel < sleepAngularVelocityLimit)) {
            this.sleepState = SleepState.Sleepy;
            this._sleepTime = time;
        } else if (sleepState === SleepState.Sleepy && (velSq > sleepVelocityLimit || aVel > sleepAngularVelocityLimit)) {
            this.wake();
        } else if (sleepState === SleepState.Sleepy && (time - this._lastSleepyTime) > this.sleepTimeLimit) {
            this.sleep();
        }
    }
};


P2Rigidbody.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);
    var shapes = this.shapes,
        jsonShapes = json.shapes || (json.shapes = []),
        i = shapes.length;

    json.position = this.position.toJSON(json.position);
    json.velocity = this.velocity.toJSON(json.velocity);
    json.force = this.force.toJSON(json.force);

    json.rotation = this.rotation;
    json.angularVelocity = this.angularVelocity;
    json.torque = this.torque;

    json.motionState = this.motionState;

    json.linearDamping = this.linearDamping;

    json.mass = this.mass;
    json.invMass = this.invMass;

    json.allowSleep = this.allowSleep;
    json.sleepState = this.sleepState;

    json.angularDamping = this.angularDamping;

    while (i--) jsonShapes[i] = shapes[i].toJSON(jsonShapes[i]);

    return json;
};


P2Rigidbody.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);
    var jsonShapes = json.shapes || (json.shapes = []),
        i = jsonShapes.length;

    this.position.fromJSON(json.position);
    this.velocity.fromJSON(json.velocity);
    this.force.fromJSON(json.force);

    this.rotation = json.rotation;
    this.angularVelocity = json.angularVelocity;
    this.torque = json.torque;

    this.motionState = json.motionState;

    this.linearDamping = json.linearDamping;

    this.mass = json.mass;
    this.invMass = json.invMass;

    this.allowSleep = json.allowSleep;
    this.sleepState = json.sleepState;

    this.angularDamping = json.angularDamping;

    while (i--) this.addShape(Class.fromJSON(jsonShapes[i]));

    return this;
};


module.exports = P2Rigidbody;

},{"../../base/class":8,"../../base/log":14,"../../math/aabb2":100,"../../math/mat32":105,"../../math/vec2":111,"../p2enums":128}],126:[function(require,module,exports){
var Class = require("../../base/class");
var Vec2 = require("../../math/vec2");
var P2Enums = require("../p2enums");
var P2Shape = require("./p2shape");
"use strict";


var ShapeType = P2Enums.ShapeType,

    abs = Math.abs,
    sqrt = Math.sqrt,
    PI = Math.PI;


function P2Segment(opts) {
    opts || (opts = {});

    P2Shape.call(this, opts);

    this.type = ShapeType.Segment;

    this.a = opts.a != undefined ? opts.a : new Vec2(-0.5, 0.0);
    this.b = opts.b != undefined ? opts.b : new Vec2(0.5, 0.0);

    this._a = this.a.clone();
    this._b = this.b.clone();
    this._normal = new Vec2().vsub(this._b, this._a).perp().normalize();

    this.radius = opts.radius != undefined ? abs(opts.radius) : 0.5;
}

P2Shape.extend(P2Segment);


P2Segment.prototype.copy = function (other) {
    P2Shape.prototype.copy.call(this, other);

    this.a.copy(other.a);
    this.b.copy(other.b);

    this.radius = other.radius;

    return this;
};


P2Segment.prototype.pointQuery = function (p) {
    if (!this.aabb.contains(p)) return false;
    var r = this.radius,
        a = this._a,
        b = this._b,
        n = this._normal,
        ax = a.x,
        ay = a.y,
        bx = b.x,
        by = b.y,
        nx = n.x,
        ny = n.y,
        px = p.x,
        py = p.y,

        dn = (nx * px + ny * py) - (ax * nx + ay * ny),
        dist = abs(dn),
        dt, dta, dtb, dx, dy;

    if (dist > r) return false;

    dt = px * ny - py * nx;
    dta = ax * ny - ay * nx;
    dtb = bx * ny - by * nx;

    if (dt <= dta) {
        if (dt < dta - r) return false;

        dx = px - ax;
        dy = py - ay;

        return (dx * dx + dy * dy) < (r * r);
    } else if (dt > dtb) {
        if (dt > dtb + r) return false;

        dx = px - bx;
        dy = py - by;

        return (dx * dx + dy * dy) < (r * r);
    }

    return true;
};


P2Segment.prototype.centroid = function (v) {
    var localPosition = this.localPosition,
        a = this.a,
        b = this.b;

    v.x = localPosition.x + (a.x + b.x) * 0.5;
    v.y = localPosition.y + (a.y + b.y) * 0.5;

    return v;
};


P2Segment.prototype.area = function () {
    var a = this.a,
        b = this.b,
        r = this.radius,
        abx = b.x - a.x,
        aby = b.y - a.y,
        l = abx * abx + aby * aby;

    l = l === 0.0 ? 0.0 : sqrt(l);

    return r * (PI * r + 2 * l);
};


var inv12 = 1.0 / 12.0;
P2Segment.prototype.inertia = function (mass) {
    var localPosition = this.localPosition,
        lx = localPosition.x,
        ly = localPosition.y,
        a = this.a,
        b = this.b,
        ax = lx + a.x,
        ay = ly + a.y,
        bx = lx + b.x,
        by = ly + b.y,
        abx = bx - ax,
        aby = by - ay,
        lsq = abx * abx + aby * aby,
        x = (ax + bx) * 0.5,
        y = (ay + by) * 0.5;

    return mass * (lsq * inv12 + (x * x + y * y));
};


var VEC2_SCALE = new Vec2(1.0, 1.0);
P2Segment.prototype.update = function (matrix) {
    var localMatrix = this.matrix,
        matrixWorld = this.matrixWorld,
        localPos = this.localPosition,
        pos = this.position,
        _a = this._a,
        _b = this._b,
        _normal = this._normal,
        a = this.a,
        b = this.b,
        radius = this.radius,
        aabb = this.aabb,
        min = aabb.min,
        max = aabb.max,
        l, r, b, t;

    localMatrix.compose(localPos, VEC2_SCALE, this.localRotation);
    matrixWorld.mmul(matrix, localMatrix);

    pos.x = localPos.x;
    pos.y = localPos.y;
    pos.transformMat32(matrix);

    _a.x = a.x;
    _a.y = a.y;
    _a.transformMat32(matrix);

    _b.x = b.x;
    _b.y = b.y;
    _b.transformMat32(matrix);

    _normal.x = -(_b.y - _a.y);
    _normal.y = _b.x - _a.x;
    _normal.normalize();

    if (_a.x < _b.x) {
        l = _a.x;
        r = _b.x;
    } else {
        l = _b.x;
        r = _a.x;
    }

    if (_a.y < _b.y) {
        b = _a.y;
        t = _b.y;
    } else {
        b = _b.y;
        t = _a.y;
    }

    min.x = l - radius;
    min.y = b - radius;
    max.x = r + radius;
    max.y = t + radius;
};


P2Segment.prototype.toJSON = function (json) {
    json = P2Shape.prototype.toJSON.call(this, json);

    json.a = this.a.toJSON(json.a);
    json.b = this.b.toJSON(json.b);

    json.radius = this.radius;

    return json;
};


P2Segment.prototype.fromJSON = function (json) {
    P2Shape.prototype.fromJSON.call(this, json);

    this.a.fromJSON(json.a);
    this.b.fromJSON(json.b);

    this.radius = json.radius;

    return this;
};


module.exports = P2Segment;

},{"../../base/class":8,"../../math/vec2":111,"../p2enums":128,"./p2shape":127}],127:[function(require,module,exports){
var Class = require("../../base/class");
var Vec2 = require("../../math/vec2");
var Mat32 = require("../../math/mat32");
var AABB2 = require("../../math/aabb2");
"use strict";


function P2Shape(opts) {
    opts || (opts = {});

    Class.call(this);

    this.type = -1;

    this.body = undefined;

    this.density = opts.density != undefined ? opts.density : 1;

    this.localPosition = opts.position != undefined ? opts.position : new Vec2;
    this.localRotation = opts.rotation != undefined ? opts.rotation : 0;

    this.position = new Vec2;
    this.rotation = 0;

    this.matrix = new Mat32;
    this.matrixWorld = new Mat32;

    this.friction = opts.friction != undefined ? opts.friction : 0.5;
    this.elasticity = opts.elasticity != undefined ? opts.elasticity : 0.25;

    this.isTrigger = opts.isTrigger != undefined ? !!opts.isTrigger : false;

    this.filterMask = opts.filterMask != undefined ? opts.filterMask : 1;
    this.filterGroup = opts.filterGroup != undefined ? opts.filterGroup : 1;

    this.aabb = new AABB2;
}

Class.extend(P2Shape);


P2Shape.prototype.copy = function (other) {

    this.density = other.density;

    this.localPosition.copy(other.localPosition);
    this.localRotation = other.localRotation;

    this.friction = other.friction;
    this.elasticity = other.elasticity;

    this.isTrigger = other.isTrigger;

    this.filterMask = other.filterMask;
    this.filterGroup = other.filterGroup;

    return this;
};


P2Shape.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);

    json.density = this.density;

    json.localPosition = this.localPosition.toJSON(json.localPosition);
    json.localRotation = this.localRotation;

    json.friction = this.friction;
    json.elasticity = this.elasticity;

    json.isTrigger = this.isTrigger;

    json.filterMask = this.filterMask;
    json.filterGroup = this.filterGroup;

    return json;
};


P2Shape.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);

    this.density = json.density;

    this.localPosition.fromJSON(json.localPosition);
    this.localRotation = json.localRotation;

    this.friction = json.friction;
    this.elasticity = json.elasticity;

    this.isTrigger = json.isTrigger;

    this.filterMask = json.filterMask;
    this.filterGroup = json.filterGroup;

    return this;
};


module.exports = P2Shape;

},{"../../base/class":8,"../../math/aabb2":100,"../../math/mat32":105,"../../math/vec2":111}],128:[function(require,module,exports){
var Enum = require("../base/enum");
"use strict";


module.exports = {
    BodyType: new Enum("Particle RigidBody"),
    ShapeType: new Enum("Convex Circle Segment"),
    MotionState: new Enum("Dynamic Static Kinematic"),
    SleepState: new Enum("Awake Sleepy Sleeping")
};

},{"../base/enum":12}],129:[function(require,module,exports){
var Mathf = require("../math/mathf");
"use strict";


var clamp = Mathf.clamp;

/**
 * @class P2Solver
 * @brief World Solver
 * @param Object opts sets Class properties from passed Object
 */
function P2Solver(opts) {
    opts || (opts = {});

    /**
     * @property Number iterations
     * @brief max number of iterations
     * @memberof P2Solver
     */
    this.iterations = opts.iterations != undefined ? opts.iterations : 10;

    /**
     * @property Number tolerance
     * @memberof P2Solver
     */
    this.tolerance = opts.tolerance != undefined ? opts.tolerance : 1e-6;
}

/**
 * @method solve
 * @memberof P2Solver
 * @brief solves all equations
 * @param Number h
 * @param Array equations
 */
P2Solver.prototype.solve = function (h, equations) {
    var num = equations.length,
        eq, bi, bj,
        vlambdai, vlambdaj, vi, vj,
        iterations = this.iterations,
        iter = 0,
        toleranceSq = this.tolerance * this.tolerance,
        GWlambda, lambda, deltaLambda, deltaLambdaTotal,
        i, j;

    if (num > -1) {

        i = num;
        while (i--) {
            eq = equations[i];

            eq.updateConstants(h);
            eq.init(h);
        }

        i = iterations;
        while (i--) {

            iter++;
            deltaLambdaTotal = 0;

            j = num;
            while (j--) {
                eq = equations[j];

                GWlambda = eq.calculateGWlambda();
                lambda = eq.lambda;
                deltaLambda = eq.invC * (eq.B - GWlambda - eq.epsilon * lambda);

                eq.lambda = clamp(lambda + deltaLambda, eq.minForce, eq.maxForce);
                deltaLambda = eq.lambda - lambda;

                eq.addToLambda(deltaLambda);
                deltaLambdaTotal += deltaLambda;
            }

            if (deltaLambdaTotal * deltaLambdaTotal < toleranceSq) break;
        }

        i = num;
        while (i--) {
            eq = equations[i];

            bi = eq.bi;
            vi = bi.velocity;
            vlambdai = bi.vlambda;
            bj = eq.bj;
            vj = bj.velocity;
            vlambdaj = bj.vlambda;

            vi.x += vlambdai.x;
            vi.y += vlambdai.y;

            vj.x += vlambdaj.x;
            vj.y += vlambdaj.y;

            vlambdai.x = vlambdai.y = vlambdaj.x = vlambdaj.y = 0;

            if (bi.wlambda != undefined) {
                bi.angularVelocity += bi.wlambda;
                bi.wlambda = 0;
            }
            if (bj.wlambda != undefined) {
                bj.angularVelocity += bj.wlambda;
                bj.wlambda = 0;
            }
        }
    }

    return iter;
};


module.exports = P2Solver;
},{"../math/mathf":107}],130:[function(require,module,exports){
var Class = require("../base/class");
var Time = require("../base/time");
var ObjectPool = require("../base/object_pool");
var Vec2 = require("../math/vec2");
var P2Enums = require("./p2enums");
var P2Solver = require("./p2solver");
var P2Broadphase = require("./collision/p2broadphase");
var P2Nearphase = require("./collision/p2nearphase");
var P2Friction = require("./constraints/p2friction");
var Log = require("../base/log");
"use strict";


var now = Time.now,
    MotionState = P2Enums.MotionState,

    FRICTION_POOL = new ObjectPool(P2Friction);


function P2Space(opts) {
    opts || (opts = {});

    Class.call(this, opts);

    this.useGravity = opts.useGravity != undefined ? !!opts.useGravity : true;
    this.gravity = opts.gravity != undefined ? opts.gravity : new Vec2(0.0, -9.801);

    this.time = 0.0;

    this.broadphase = new P2Space.DefaultBroadPhase(opts.broadphase);
    this.nearphase = new P2Space.DefaultNearPhase(opts.nearphase);

    this.solver = new P2Space.DefaultSolver(opts.solver);

    this.bodies = [];
    this._bodyHash = {};

    this._pairsi = [];
    this._pairsj = [];

    this.contacts = [];
    this.frictions = [];
    this.constraints = [];

    this._collisionMatrix = [];
    this._collisionMatrixPrevious = [];

    this.stats = {
        step: 0.0,
        solve: 0.0,
        integrate: 0.0,
        nearphase: 0.0,
        broadphase: 0.0
    };
}

Class.extend(P2Space);


P2Space.DefaultBroadPhase = P2Broadphase;
P2Space.DefaultNearPhase = P2Nearphase;
P2Space.DefaultSolver = P2Solver;
P2Space.FRICTION_POOL = FRICTION_POOL;


P2Space.prototype.collisionMatrixGet = function (i, j, current) {
    var tmp = j;

    if (j > i) {
        j = i;
        i = tmp;
    }
    i = (i * (i + 1) >> 1) + j - 1;

    return (current === undefined || current) ? this._collisionMatrix[i] : this._collisionMatrixPrevious[i];
};


P2Space.prototype.collisionMatrixSet = function (i, j, value, current) {
    var tmp = j;

    if (j > i) {
        j = i;
        i = tmp;
    }

    i = (i * (i + 1) >> 1) + j - 1;

    if (current == undefined || current) {
        this._collisionMatrix[i] = value;
    } else {
        this._collisionMatrixPrevious[i] = value;
    }
};


P2Space.prototype.collisionMatrixTick = function () {
    var collisionMatrix = this._collisionMatrixPrevious,
        i;

    this._collisionMatrixPrevious = this._collisionMatrix;
    this._collisionMatrix = collisionMatrix;

    i = collisionMatrix.length;
    while (i--) collisionMatrix[i] = 0;
};


P2Space.prototype.clear = function () {
    var bodies = this.bodies,
        i = bodies.length;

    while (i--) this.removeBody(bodies[i]);

    return this;
};


P2Space.prototype.addBody = function (body) {
    var bodies = this.bodies,
        index = bodies.indexOf(body);

    if (index === -1) {
        bodies.push(body);
        this._bodyHash[body._id] = body;

        body.space = this;
        body._index = bodies.length - 1;

        body.init();
    } else {
        Log.error("P2Space.addBody: Body already member of P2Space");
    }

    return this;
};


P2Space.prototype.addBodies = function () {
    var i = arguments.length;

    while (i--) this.addBody(arguments[i]);
    return this;
};


P2Space.prototype.removeBody = function (body) {
    var bodies = this.bodies,
        index = bodies.indexOf(body);

    if (index !== -1) {
        body.space = undefined;
        body._index = -1;

        bodies.splice(index, 1);
        this._bodyHash[body._id] = undefined;
    } else {
        Log.error("P2Space.addBody: Body not member of P2Space");
    }

    return this;
};


P2Space.prototype.removeBodies = function () {
    var i = arguments.length;

    while (i--) this.removeBody(arguments[i]);
    return this;
};


P2Space.prototype.addConstraint = function (constraint) {
    var constraints = this.constraints,
        index = constraints.indexOf(constraint);

    if (index === -1) {
        constraints.push(constraint);
    } else {
        Log.error("P2Space.addConstraint: Constraint already member of P2Space");
    }

    return this;
};


P2Space.prototype.removeConstraint = function (constraint) {
    var constraints = this.constraints,
        index = constraints.indexOf(constraint);

    if (index !== -1) {
        constraints.splice(index, 1);
    } else {
        Log.error("P2Space.removeConstraint: Constraint not a member of P2Space");
    }

    return this;
};


P2Space.prototype.findBodyByPoint = function (p) {
    var bodies = this.bodies,
        body, shapes, shape,
        i = bodies.length,
        j;

    while (i--) {
        body = bodies[i];
        if (!body) continue;

        shapes = body.shapes;
        j = shapes.length;
        while (j--) {
            shape = shapes[j];
            if (!shape) continue;

            if (shape.pointQuery(p)) return body;
        }
    }

    return undefined;
};


P2Space.prototype.findBodyById = function (id) {

    return this._bodyHash[id];
};


P2Space.prototype.step = function (dt) {
    var stepStart = now(),
        stats = this.stats,
        g = this.gravity,
        gx = g.x,
        gy = g.y,
        bodies = this.bodies,
        numBodies = bodies.length,
        solver = this.solver,
        constraints = this.constraints,
        pairsi = this._pairsi,
        pairsj = this._pairsj,
        contacts = this.contacts,
        frictions = this.frictions,
        constraint, time, start, body, force, mass,
        bi, bj, c, cp, cn, u, slipForce, fc, fcp, fct,
        i;

    time = this.time += dt;

    if (this.useGravity) {
        i = numBodies;
        while (i--) {
            body = bodies[i];

            if (body.motionState === MotionState.Dynamic) {
                force = body.force;
                mass = body.mass;

                force.x += gx * mass;
                force.y += gy * mass;
            }
        }
    }

    this.collisionMatrixTick();

    start = now();
    this.broadphase.collisions(bodies, pairsi, pairsj);
    stats.broadphase = now() - start;

    start = now();
    this.nearphase.collisions(pairsi, pairsj, contacts);
    stats.nearphase = now() - start;

    start = now();
    solver.solve(dt, contacts);

    FRICTION_POOL.clear();
    frictions.length = 0;

    i = contacts.length;
    while (i--) {
        c = contacts[i];

        if (c.u > 0.0) {
            bi = c.bi;
            bj = c.bj;
            fc = FRICTION_POOL.create();
            u = c.u;

            slipForce = u * c.lambda;
            fc.minForce = -slipForce;
            fc.maxForce = slipForce;

            fc.bi = bi;
            fc.bj = bj;

            cp = c.p;
            fcp = fc.p;

            fcp.x = cp.x;
            fcp.y = cp.y;

            cn = c.n;
            fct = fc.t;

            fct.x = -cn.y;
            fct.y = cn.x;

            frictions.push(fc);
        }
    }

    solver.solve(dt, frictions);

    i = constraints.length;
    while (i--) {
        constraint = constraints[i];
        constraint.update();
        solver.solve(dt, constraint.equations);
    }
    stats.solve = now() - start;

    start = now();
    i = numBodies;
    while (i--) {
        body = bodies[i];
        if (!body) continue;

        body.update(dt);
        body.sleepTick(time);
    }
    stats.integrate = now() - start;

    stats.step = now() - stepStart;
};


P2Space.prototype.toJSON = function (json) {
    json = Class.prototype.toJSON.call(this, json);

    json.useGravity = this.useGravity;
    json.gravity = this.gravity.toJSON(json.gravity);
    json.broadphase = this.broadphase.toJSON(json.broadphase);

    return json;
};


P2Space.prototype.fromJSON = function (json) {
    Class.prototype.fromJSON.call(this, json);

    this.useGravity = json.useGravity;
    this.gravity.fromJSON(json.gravity);
    this.broadphase.fromJSON(json.broadphase);

    return this;
};


module.exports = P2Space;

},{"../base/class":8,"../base/log":14,"../base/object_pool":15,"../base/time":18,"../math/vec2":111,"./collision/p2broadphase":114,"./collision/p2nearphase":116,"./constraints/p2friction":121,"./p2enums":128,"./p2solver":129}],131:[function(require,module,exports){
"use strict";


function Phys2D() {

    this.P2Broadphase = require("./collision/p2broadphase");
    this.P2BroadphaseSpatialHash = require("./collision/p2broadphase_spatialhash");
    this.P2Nearphase = require("./collision/p2nearphase");

    this.P2Circle = require("./objects/p2circle");
    this.P2Convex = require("./objects/p2convex");
    this.P2Rect = require("./objects/p2rect");
    this.P2Rigidbody = require("./objects/p2rigidbody");
    this.P2Segment = require("./objects/p2segment");
    this.P2Shape = require("./objects/p2shape");

    this.P2Constraint = require("./constraints/p2constraint");
    this.P2DistanceConstraint = require("./constraints/p2distance_constraint");

    this.P2Enums = require("./p2enums");
    this.P2Space = require("./p2space");
}


module.exports = new Phys2D;

},{"./collision/p2broadphase":114,"./collision/p2broadphase_spatialhash":115,"./collision/p2nearphase":116,"./constraints/p2constraint":117,"./constraints/p2distance_constraint":119,"./objects/p2circle":122,"./objects/p2convex":123,"./objects/p2rect":124,"./objects/p2rigidbody":125,"./objects/p2segment":126,"./objects/p2shape":127,"./p2enums":128,"./p2space":130}],132:[function(require,module,exports){
"use strict";


var Device = require("./base/device"),
    Time = require("./base/time"),
    now = Time.now,

    IS_SERVER = !(typeof(window) !== "undefined" && window.document),
    IS_CLIENT = !IS_SERVER,

    defineProperty = Object.defineProperty;


if (Device.mobile) {
    window.onerror = function (message, page, line) {
        alert("line: " + line + ", page: " + page + "\nmessage: " + message);
    };
}


/**
 * Holds all accessible Classes
 * @class Xian
 */
function Xian() {

    this.Phys2D = require("./phys2d/phys2d");

    this.AudioCtx = require("./base/audio_ctx");
    this.Class = require("./base/class");
    this.Device = require("./base/device");
    this.Dom = require("./base/dom");
    this.Enum = require("./base/enum");
    this.EventEmitter = require("./base/event_emitter");
    this.ObjectPool = require("./base/object_pool");
    this.requestAnimationFrame = require("./base/request_animation_frame");
    this.io = require("./base/socket.io");
    this.Time = require("./base/time");
    this.util = require("./base/util");
    //
    this.Shader = require("./core/assets/shaders/shader");
    this.ShaderLib = require("./core/assets/shaders/shader_lib");
    this.Asset = require("./core/assets/asset");
    this.AssetLoader = require("./core/assets/asset_loader");
    this.Assets = require("./core/assets/assets");
    this.AudioClip = require("./core/assets/audio_clip");
    this.Material = require("./core/assets/material");
    this.Mesh = require("./core/assets/mesh");
    this.SpriteSheet = require("./core/assets/sprite_sheet");
    this.Texture = require("./core/assets/texture");
    this.TextureCube = require("./core/assets/texture_cube");
    //
    this.BoneComponentManager = require("./core/component_managers/bone_component_manager");
    this.Camera2DComponentManager = require("./core/component_managers/camera_2d_component_manager");
    this.CameraComponentManager = require("./core/component_managers/camera_component_manager");
    this.ComponentManager = require("./core/component_managers/component_manager");
    this.LightComponentManager = require("./core/component_managers/light_component_manager");
    this.MeshAnimationComponentManager = require("./core/component_managers/mesh_animation_component_manager");
    this.MeshFilterComponentManager = require("./core/component_managers/mesh_filter_component_manager");
    this.SpriteComponentManager = require("./core/component_managers/sprite_component_manager");
    this.Transform2DComponentManager = require("./core/component_managers/transform_2d_component_manager");
    this.TransformComponentManager = require("./core/component_managers/transform_component_manager");

    this.ParticleSystem = require("./core/components/particle_system/particle_system");
    this.AudioSource = require("./core/components/audio_source");
    this.Camera = require("./core/components/camera");
    this.Camera2D = require("./core/components/camera_2d");
    this.Component = require("./core/components/component");
    this.GUIText = require("./core/components/gui_text");
    this.GUITexture = require("./core/components/gui_texture");
    this.Light = require("./core/components/light");
    this.MeshAnimation = require("./core/components/mesh_animation");
    this.MeshFilter = require("./core/components/mesh_filter");
    this.OrbitControl = require("./core/components/orbit_control");
    this.RigidBody2D = require("./core/components/rigid_body_2d");
    this.Sprite = require("./core/components/sprite");
    this.SpriteAnimation = require("./core/components/sprite_animation");
    this.Transform = require("./core/components/transform");
    this.Transform2D = require("./core/components/transform_2d");
    //
    this.BaseGame = require("./core/game/base_game");
    //this.ClientGame = require("./core/game/client_game");
    this.Game = require("./core/game/game");
    this.Config = require("./base/config");
    this.Log = require("./base/log");
    //
    this.GUIComponentManager = require("./core/gui/component_managers/gui_component_manager");

    this.GUIComponent = require("./core/gui/components/gui_component");
    //this.GUIContent = require("./core/gui/components/gui_content");
    this.GUITransform = require("./core/gui/components/gui_transform");
    //
    this.GUI = require("./core/gui/gui");
    this.GUIObject = require("./core/gui/gui_object");
    //this.GUIStyle = require("./core/gui/gui_style");
    //this.GUIStyleState = require("./core/gui/gui_style_state");
    //
    this.Handler = require("./core/input/handler");
    this.Input = require("./core/input/input");
    //
    this.Canvas = require("./core/renderer/canvas");
    this.RenderTarget = require("./core/renderer/render_target");
    this.Renderer = require("./core/renderer/renderer");
    this.ShaderChunks = require("./core/renderer/shader_chunks");

    this.World = require("./core/world/world");
    this.World2D = require("./core/world/world_2d");
    //
    this.Enums = require("./core/enums");
    this.GameObject = require("./core/game_object");
    this.Prefab = require("./core/prefab");
    this.Scene = require("./core/scene");
    //
    this.AABB2 = require("./math/aabb2");
    this.AABB3 = require("./math/aabb3");
    this.Color = require("./math/color");
    this.Mat2 = require("./math/mat2");
    this.Mat3 = require("./math/mat3");
    this.Mat32 = require("./math/mat32");
    this.Mat4 = require("./math/mat4");
    this.Mathf = require("./math/mathf");
    this.Quat = require("./math/quat");
    this.Rect = require("./math/rect");
    this.RectOffset = require("./math/rect_offset");
    this.Vec2 = require("./math/vec2");
    this.Vec3 = require("./math/vec3");
    this.Vec4 = require("./math/vec4");
}


defineProperty(Xian.prototype, "isServer", {
    get: function () {
        return IS_SERVER;
    }
});


defineProperty(Xian.prototype, "isClient", {
    get: function () {
        return IS_CLIENT;
    }
});


/**
 * attaches Xian to window/global and all subclasses
 */
Xian.prototype.globalize = function () {

    for (var key in this) window[key] = this[key];
    window.Xian = this;
};

/**
 * benchmarks function console.logs number of operations / second
 * @param String name
 * @param Function fn
 */
Xian.prototype.benchmark = function (name, fn, times) {
    times || (times = 1000);
    var start = 0.0,
        time = 0.0,
        i = times;

    while (i--) {
        start = now();
        fn();
        time += now() - start;
    }

    console.log(name + ":\n\t" + times / time + " (ops/sec)\n\t" + time / times + "(avg/call)");
};


module.exports = new Xian();

},{"./base/audio_ctx":7,"./base/class":8,"./base/config":9,"./base/device":10,"./base/dom":11,"./base/enum":12,"./base/event_emitter":13,"./base/log":14,"./base/object_pool":15,"./base/request_animation_frame":16,"./base/socket.io":17,"./base/time":18,"./base/util":19,"./core/assets/asset":20,"./core/assets/asset_loader":21,"./core/assets/assets":22,"./core/assets/audio_clip":23,"./core/assets/material":24,"./core/assets/mesh":25,"./core/assets/shaders/shader":35,"./core/assets/shaders/shader_lib":36,"./core/assets/sprite_sheet":37,"./core/assets/texture":38,"./core/assets/texture_cube":39,"./core/component_managers/bone_component_manager":40,"./core/component_managers/camera_2d_component_manager":41,"./core/component_managers/camera_component_manager":42,"./core/component_managers/component_manager":43,"./core/component_managers/light_component_manager":44,"./core/component_managers/mesh_animation_component_manager":45,"./core/component_managers/mesh_filter_component_manager":46,"./core/component_managers/sprite_component_manager":47,"./core/component_managers/transform_2d_component_manager":48,"./core/component_managers/transform_component_manager":49,"./core/components/audio_source":50,"./core/components/camera":52,"./core/components/camera_2d":53,"./core/components/component":54,"./core/components/gui_text":56,"./core/components/gui_texture":57,"./core/components/light":58,"./core/components/mesh_animation":59,"./core/components/mesh_filter":60,"./core/components/orbit_control":61,"./core/components/particle_system/particle_system":66,"./core/components/rigid_body_2d":68,"./core/components/sprite":69,"./core/components/sprite_animation":70,"./core/components/transform":71,"./core/components/transform_2d":72,"./core/enums":73,"./core/game/base_game":74,"./core/game/game":75,"./core/game_object":77,"./core/gui/component_managers/gui_component_manager":78,"./core/gui/components/gui_component":79,"./core/gui/components/gui_transform":80,"./core/gui/gui":81,"./core/gui/gui_object":82,"./core/input/handler":87,"./core/input/input":88,"./core/prefab":91,"./core/renderer/canvas":92,"./core/renderer/render_target":93,"./core/renderer/renderer":95,"./core/renderer/shader_chunks":96,"./core/scene":97,"./core/world/world":98,"./core/world/world_2d":99,"./math/aabb2":100,"./math/aabb3":101,"./math/color":102,"./math/mat2":103,"./math/mat3":104,"./math/mat32":105,"./math/mat4":106,"./math/mathf":107,"./math/quat":108,"./math/rect":109,"./math/rect_offset":110,"./math/vec2":111,"./math/vec3":112,"./math/vec4":113,"./phys2d/phys2d":131}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlc1xcYnJvd3NlcmlmeVxcbm9kZV9tb2R1bGVzXFxicm93c2VyLXBhY2tcXF9wcmVsdWRlLmpzIiwiZXhhbXBsZXNcXHRlc3RfM2RcXGluZGV4LmpzIiwibm9kZV9tb2R1bGVzXFxicm93c2VyaWZ5XFxub2RlX21vZHVsZXNcXGJ1ZmZlclxcaW5kZXguanMiLCJub2RlX21vZHVsZXNcXGJyb3dzZXJpZnlcXG5vZGVfbW9kdWxlc1xcYnVmZmVyXFxub2RlX21vZHVsZXNcXGJhc2U2NC1qc1xcbGliXFxiNjQuanMiLCJub2RlX21vZHVsZXNcXGJyb3dzZXJpZnlcXG5vZGVfbW9kdWxlc1xcYnVmZmVyXFxub2RlX21vZHVsZXNcXGllZWU3NTRcXGluZGV4LmpzIiwibm9kZV9tb2R1bGVzXFxicm93c2VyaWZ5XFxub2RlX21vZHVsZXNcXGJ1ZmZlclxcbm9kZV9tb2R1bGVzXFxpcy1hcnJheVxcaW5kZXguanMiLCJub2RlX21vZHVsZXNcXGJyb3dzZXJpZnlcXG5vZGVfbW9kdWxlc1xccHJvY2Vzc1xcYnJvd3Nlci5qcyIsInNyY1xceGlhblxcYmFzZVxcYXVkaW9fY3R4LmpzIiwic3JjXFx4aWFuXFxiYXNlXFxjbGFzcy5qcyIsInNyY1xceGlhblxcYmFzZVxcY29uZmlnLmpzIiwic3JjXFx4aWFuXFxiYXNlXFxkZXZpY2UuanMiLCJzcmNcXHhpYW5cXGJhc2VcXGRvbS5qcyIsInNyY1xceGlhblxcYmFzZVxcZW51bS5qcyIsInNyY1xceGlhblxcYmFzZVxcZXZlbnRfZW1pdHRlci5qcyIsInNyY1xceGlhblxcYmFzZVxcbG9nLmpzIiwic3JjXFx4aWFuXFxiYXNlXFxvYmplY3RfcG9vbC5qcyIsInNyY1xceGlhblxcYmFzZVxccmVxdWVzdF9hbmltYXRpb25fZnJhbWUuanMiLCJzcmNcXHhpYW5cXGJhc2VcXHNvY2tldC5pby5qcyIsInNyY1xceGlhblxcYmFzZVxcdGltZS5qcyIsInNyY1xceGlhblxcYmFzZVxcdXRpbC5qcyIsInNyY1xceGlhblxcY29yZVxcYXNzZXRzXFxhc3NldC5qcyIsInNyY1xceGlhblxcY29yZVxcYXNzZXRzXFxhc3NldF9sb2FkZXIuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGFzc2V0c1xcYXNzZXRzLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxhc3NldHNcXGF1ZGlvX2NsaXAuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGFzc2V0c1xcbWF0ZXJpYWwuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGFzc2V0c1xcbWVzaC5qcyIsInNyY1xceGlhblxcY29yZVxcYXNzZXRzXFxtZXNoX2JvbmUuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGFzc2V0c1xcc2hhZGVyc1xcbm9ybWFsXFxkaWZmdXNlLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxhc3NldHNcXHNoYWRlcnNcXG5vcm1hbFxcbm9ybWFsX2RpZmZ1c2UuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGFzc2V0c1xcc2hhZGVyc1xcbm9ybWFsXFxub3JtYWxfc3BlY3VsYXIuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGFzc2V0c1xcc2hhZGVyc1xcbm9ybWFsXFxwYXJhbGxheF9kaWZmdXNlLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxhc3NldHNcXHNoYWRlcnNcXG5vcm1hbFxcc3BlY3VsYXIuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGFzc2V0c1xcc2hhZGVyc1xcbm9ybWFsXFx1bmxpdC5qcyIsInNyY1xceGlhblxcY29yZVxcYXNzZXRzXFxzaGFkZXJzXFxwYXJ0aWNsZVxcdW5saXQuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGFzc2V0c1xcc2hhZGVyc1xccmVmbGVjdGl2ZVxccmVmbGVjdGl2ZV92ZXJ0ZXhfbGl0LmpzIiwic3JjXFx4aWFuXFxjb3JlXFxhc3NldHNcXHNoYWRlcnNcXHNoYWRlci5qcyIsInNyY1xceGlhblxcY29yZVxcYXNzZXRzXFxzaGFkZXJzXFxzaGFkZXJfbGliLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxhc3NldHNcXHNwcml0ZV9zaGVldC5qcyIsInNyY1xceGlhblxcY29yZVxcYXNzZXRzXFx0ZXh0dXJlLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxhc3NldHNcXHRleHR1cmVfY3ViZS5qcyIsInNyY1xceGlhblxcY29yZVxcY29tcG9uZW50X21hbmFnZXJzXFxib25lX2NvbXBvbmVudF9tYW5hZ2VyLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxjb21wb25lbnRfbWFuYWdlcnNcXGNhbWVyYV8yZF9jb21wb25lbnRfbWFuYWdlci5qcyIsInNyY1xceGlhblxcY29yZVxcY29tcG9uZW50X21hbmFnZXJzXFxjYW1lcmFfY29tcG9uZW50X21hbmFnZXIuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudF9tYW5hZ2Vyc1xcY29tcG9uZW50X21hbmFnZXIuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudF9tYW5hZ2Vyc1xcbGlnaHRfY29tcG9uZW50X21hbmFnZXIuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudF9tYW5hZ2Vyc1xcbWVzaF9hbmltYXRpb25fY29tcG9uZW50X21hbmFnZXIuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudF9tYW5hZ2Vyc1xcbWVzaF9maWx0ZXJfY29tcG9uZW50X21hbmFnZXIuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudF9tYW5hZ2Vyc1xcc3ByaXRlX2NvbXBvbmVudF9tYW5hZ2VyLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxjb21wb25lbnRfbWFuYWdlcnNcXHRyYW5zZm9ybV8yZF9jb21wb25lbnRfbWFuYWdlci5qcyIsInNyY1xceGlhblxcY29yZVxcY29tcG9uZW50X21hbmFnZXJzXFx0cmFuc2Zvcm1fY29tcG9uZW50X21hbmFnZXIuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudHNcXGF1ZGlvX3NvdXJjZS5qcyIsInNyY1xceGlhblxcY29yZVxcY29tcG9uZW50c1xcYm9uZS5qcyIsInNyY1xceGlhblxcY29yZVxcY29tcG9uZW50c1xcY2FtZXJhLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxjb21wb25lbnRzXFxjYW1lcmFfMmQuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudHNcXGNvbXBvbmVudC5qcyIsInNyY1xceGlhblxcY29yZVxcY29tcG9uZW50c1xcZ3VpX2VsZW1lbnQuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudHNcXGd1aV90ZXh0LmpzIiwic3JjXFx4aWFuXFxjb3JlXFxjb21wb25lbnRzXFxndWlfdGV4dHVyZS5qcyIsInNyY1xceGlhblxcY29yZVxcY29tcG9uZW50c1xcbGlnaHQuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudHNcXG1lc2hfYW5pbWF0aW9uLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxjb21wb25lbnRzXFxtZXNoX2ZpbHRlci5qcyIsInNyY1xceGlhblxcY29yZVxcY29tcG9uZW50c1xcb3JiaXRfY29udHJvbC5qcyIsInNyY1xceGlhblxcY29yZVxcY29tcG9uZW50c1xccGFydGljbGVfc3lzdGVtXFxlbWl0dGVyLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxjb21wb25lbnRzXFxwYXJ0aWNsZV9zeXN0ZW1cXGVtaXR0ZXJfMmQuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudHNcXHBhcnRpY2xlX3N5c3RlbVxccGFydGljbGUuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudHNcXHBhcnRpY2xlX3N5c3RlbVxccGFydGljbGVfMmQuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudHNcXHBhcnRpY2xlX3N5c3RlbVxccGFydGljbGVfc3lzdGVtLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxjb21wb25lbnRzXFxwYXJ0aWNsZV9zeXN0ZW1cXHR3ZWVuLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxjb21wb25lbnRzXFxyaWdpZF9ib2R5XzJkLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxjb21wb25lbnRzXFxzcHJpdGUuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudHNcXHNwcml0ZV9hbmltYXRpb24uanMiLCJzcmNcXHhpYW5cXGNvcmVcXGNvbXBvbmVudHNcXHRyYW5zZm9ybS5qcyIsInNyY1xceGlhblxcY29yZVxcY29tcG9uZW50c1xcdHJhbnNmb3JtXzJkLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxlbnVtcy5qcyIsInNyY1xceGlhblxcY29yZVxcZ2FtZVxcYmFzZV9nYW1lLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxnYW1lXFxnYW1lLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxnYW1lXFxsb29wLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxnYW1lX29iamVjdC5qcyIsInNyY1xceGlhblxcY29yZVxcZ3VpXFxjb21wb25lbnRfbWFuYWdlcnNcXGd1aV9jb21wb25lbnRfbWFuYWdlci5qcyIsInNyY1xceGlhblxcY29yZVxcZ3VpXFxjb21wb25lbnRzXFxndWlfY29tcG9uZW50LmpzIiwic3JjXFx4aWFuXFxjb3JlXFxndWlcXGNvbXBvbmVudHNcXGd1aV90cmFuc2Zvcm0uanMiLCJzcmNcXHhpYW5cXGNvcmVcXGd1aVxcZ3VpLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxndWlcXGd1aV9vYmplY3QuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGlucHV0XFxheGVzLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxpbnB1dFxcYXhpcy5qcyIsInNyY1xceGlhblxcY29yZVxcaW5wdXRcXGJ1dHRvbi5qcyIsInNyY1xceGlhblxcY29yZVxcaW5wdXRcXGJ1dHRvbnMuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGlucHV0XFxoYW5kbGVyLmpzIiwic3JjXFx4aWFuXFxjb3JlXFxpbnB1dFxcaW5wdXQuanMiLCJzcmNcXHhpYW5cXGNvcmVcXGlucHV0XFx0b3VjaC5qcyIsInNyY1xceGlhblxcY29yZVxcaW5wdXRcXHRvdWNoZXMuanMiLCJzcmNcXHhpYW5cXGNvcmVcXHByZWZhYi5qcyIsInNyY1xceGlhblxcY29yZVxccmVuZGVyZXJcXGNhbnZhcy5qcyIsInNyY1xceGlhblxcY29yZVxccmVuZGVyZXJcXHJlbmRlcl90YXJnZXQuanMiLCJzcmNcXHhpYW5cXGNvcmVcXHJlbmRlcmVyXFxyZW5kZXJfdGFyZ2V0X2N1YmUuanMiLCJzcmNcXHhpYW5cXGNvcmVcXHJlbmRlcmVyXFxyZW5kZXJlci5qcyIsInNyY1xceGlhblxcY29yZVxccmVuZGVyZXJcXHNoYWRlcl9jaHVua3MuanMiLCJzcmNcXHhpYW5cXGNvcmVcXHNjZW5lLmpzIiwic3JjXFx4aWFuXFxjb3JlXFx3b3JsZFxcd29ybGQuanMiLCJzcmNcXHhpYW5cXGNvcmVcXHdvcmxkXFx3b3JsZF8yZC5qcyIsInNyY1xceGlhblxcbWF0aFxcYWFiYjIuanMiLCJzcmNcXHhpYW5cXG1hdGhcXGFhYmIzLmpzIiwic3JjXFx4aWFuXFxtYXRoXFxjb2xvci5qcyIsInNyY1xceGlhblxcbWF0aFxcbWF0Mi5qcyIsInNyY1xceGlhblxcbWF0aFxcbWF0My5qcyIsInNyY1xceGlhblxcbWF0aFxcbWF0MzIuanMiLCJzcmNcXHhpYW5cXG1hdGhcXG1hdDQuanMiLCJzcmNcXHhpYW5cXG1hdGhcXG1hdGhmLmpzIiwic3JjXFx4aWFuXFxtYXRoXFxxdWF0LmpzIiwic3JjXFx4aWFuXFxtYXRoXFxyZWN0LmpzIiwic3JjXFx4aWFuXFxtYXRoXFxyZWN0X29mZnNldC5qcyIsInNyY1xceGlhblxcbWF0aFxcdmVjMi5qcyIsInNyY1xceGlhblxcbWF0aFxcdmVjMy5qcyIsInNyY1xceGlhblxcbWF0aFxcdmVjNC5qcyIsInNyY1xceGlhblxccGh5czJkXFxjb2xsaXNpb25cXHAyYnJvYWRwaGFzZS5qcyIsInNyY1xceGlhblxccGh5czJkXFxjb2xsaXNpb25cXHAyYnJvYWRwaGFzZV9zcGF0aWFsaGFzaC5qcyIsInNyY1xceGlhblxccGh5czJkXFxjb2xsaXNpb25cXHAybmVhcnBoYXNlLmpzIiwic3JjXFx4aWFuXFxwaHlzMmRcXGNvbnN0cmFpbnRzXFxwMmNvbnN0cmFpbnQuanMiLCJzcmNcXHhpYW5cXHBoeXMyZFxcY29uc3RyYWludHNcXHAyY29udGFjdC5qcyIsInNyY1xceGlhblxccGh5czJkXFxjb25zdHJhaW50c1xccDJkaXN0YW5jZV9jb25zdHJhaW50LmpzIiwic3JjXFx4aWFuXFxwaHlzMmRcXGNvbnN0cmFpbnRzXFxwMmVxdWF0aW9uLmpzIiwic3JjXFx4aWFuXFxwaHlzMmRcXGNvbnN0cmFpbnRzXFxwMmZyaWN0aW9uLmpzIiwic3JjXFx4aWFuXFxwaHlzMmRcXG9iamVjdHNcXHAyY2lyY2xlLmpzIiwic3JjXFx4aWFuXFxwaHlzMmRcXG9iamVjdHNcXHAyY29udmV4LmpzIiwic3JjXFx4aWFuXFxwaHlzMmRcXG9iamVjdHNcXHAycmVjdC5qcyIsInNyY1xceGlhblxccGh5czJkXFxvYmplY3RzXFxwMnJpZ2lkYm9keS5qcyIsInNyY1xceGlhblxccGh5czJkXFxvYmplY3RzXFxwMnNlZ21lbnQuanMiLCJzcmNcXHhpYW5cXHBoeXMyZFxcb2JqZWN0c1xccDJzaGFwZS5qcyIsInNyY1xceGlhblxccGh5czJkXFxwMmVudW1zLmpzIiwic3JjXFx4aWFuXFxwaHlzMmRcXHAyc29sdmVyLmpzIiwic3JjXFx4aWFuXFxwaHlzMmRcXHAyc3BhY2UuanMiLCJzcmNcXHhpYW5cXHBoeXMyZFxccGh5czJkLmpzIiwic3JjXFx4aWFuXFx4aWFuLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9JQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9qREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25IQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMU5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3dkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9TQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbFFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDclFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1ZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbE9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0lBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdFhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbFJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM2FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMVhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0tBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbFFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcFNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdC9GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaFRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbDVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RpQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6MEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqMEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2a0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbDdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy8yQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsNEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0lBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaHVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbmdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIiAgICAgICAgdmFyIFhpYW4gPSByZXF1aXJlKFwiLi4vLi4vc3JjL3hpYW4veGlhblwiKTtcblxuICAgICAgICBYaWFuLmdsb2JhbGl6ZSgpO1xuXG4gICAgICAgIHZhciByYW5kb20gPSBNYXRoLnJhbmRvbSxcbiAgICAgICAgICAgIHJhbmRGbG9hdCA9IE1hdGhmLnJhbmRGbG9hdCxcbiAgICAgICAgICAgIFBJID0gTWF0aC5QSSxcbiAgICAgICAgICAgIHNpbiA9IE1hdGguc2luLFxuICAgICAgICAgICAgY29zID0gTWF0aC5jb3M7XG5cbiAgICAgICAgQXNzZXRzLmFkZEFzc2V0cyhcbiAgICAgICAgICAgIG5ldyBTaGFkZXJMaWIuVW5saXQsXG4gICAgICAgICAgICBuZXcgU2hhZGVyTGliLlZlcnRleExpdCxcbiAgICAgICAgICAgIG5ldyBTaGFkZXJMaWIuRGlmZnVzZSxcbiAgICAgICAgICAgIG5ldyBTaGFkZXJMaWIuU3BlY3VsYXIsXG4gICAgICAgICAgICBuZXcgU2hhZGVyTGliLk5vcm1hbERpZmZ1c2UsXG4gICAgICAgICAgICBuZXcgU2hhZGVyTGliLk5vcm1hbFNwZWN1bGFyLFxuICAgICAgICAgICAgbmV3IFNoYWRlckxpYi5QYXJhbGxheERpZmZ1c2UsXG5cbiAgICAgICAgICAgIG5ldyBTaGFkZXJMaWIuUGFydGljbGVVbmxpdCxcblxuICAgICAgICAgICAgbmV3IFNoYWRlckxpYi5SZWZsZWN0aXZlVmVydGV4TGl0LFxuICAgICAgICAgICAgbmV3IFRleHR1cmUoe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwidGV4X21hcmluZV9kaWZcIixcbiAgICAgICAgICAgICAgICBzcmM6IFwiLi4vY29udGVudC9pbWFnZXMvbWFyaW5lX2RpZl9zcGVjLnBuZ1wiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBUZXh0dXJlKHtcbiAgICAgICAgICAgICAgICBuYW1lOiBcInRleF9tYXJpbmVfbm9yXCIsXG4gICAgICAgICAgICAgICAgc3JjOiBcIi4uL2NvbnRlbnQvaW1hZ2VzL21hcmluZV9ub3IuanBnXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IFRleHR1cmUoe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwidGV4X21hcmluZV9zcGVjXCIsXG4gICAgICAgICAgICAgICAgc3JjOiBcIi4uL2NvbnRlbnQvaW1hZ2VzL21hcmluZV9zcGVjLmpwZ1wiXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBUZXh0dXJlQ3ViZSh7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJjbV9za3lcIixcbiAgICAgICAgICAgICAgICBzcmM6IFtcbiAgICAgICAgICAgICAgICAgICAgXCIuLi9jb250ZW50L2ltYWdlcy9za3lib3hfbGVmdC5qcGdcIixcbiAgICAgICAgICAgICAgICAgICAgXCIuLi9jb250ZW50L2ltYWdlcy9za3lib3hfcmlnaHQuanBnXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiLi4vY29udGVudC9pbWFnZXMvc2t5Ym94X2Zyb250LmpwZ1wiLFxuICAgICAgICAgICAgICAgICAgICBcIi4uL2NvbnRlbnQvaW1hZ2VzL3NreWJveF9iYWNrLmpwZ1wiLFxuICAgICAgICAgICAgICAgICAgICBcIi4uL2NvbnRlbnQvaW1hZ2VzL3NreWJveF91cC5qcGdcIixcbiAgICAgICAgICAgICAgICAgICAgXCIuLi9jb250ZW50L2ltYWdlcy9za3lib3hfZG93bi5qcGdcIixcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICBBc3NldHMuYWRkQXNzZXRzKFxuICAgICAgICAgICAgbmV3IE1lc2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwibWVzaF9vZGluXCIsXG4gICAgICAgICAgICAgICAgc3JjOiBcIi4uL2NvbnRlbnQvZ2VvbWV0cnkvbWFyaW5lLmpzb25cIlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBNZXNoLkN1YmUoe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwibWVzaF9jdWJlXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgTWVzaC5QbGFuZSh7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJtZXNoX3BsYW5lXCJcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgTWVzaC5TcGhlcmUoe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwibWVzaF9zcGhlcmVcIixcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IE1hdGVyaWFsKHtcbiAgICAgICAgICAgICAgICBuYW1lOiBcIm1hdF9kZWZhdWx0XCIsXG5cbiAgICAgICAgICAgICAgICB3aXJlZnJhbWU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHdpcmVmcmFtZUxpbmVXaWR0aDogMSxcblxuICAgICAgICAgICAgICAgIHVuaWZvcm1zOiB7XG4gICAgICAgICAgICAgICAgICAgIGRpZmZ1c2VNYXA6IEFzc2V0cy5nZXQoXCJ0ZXhfbWFyaW5lX2RpZlwiKSxcbiAgICAgICAgICAgICAgICAgICAgbm9ybWFsTWFwOiBBc3NldHMuZ2V0KFwidGV4X21hcmluZV9ub3JcIiksXG4gICAgICAgICAgICAgICAgICAgIHNwZWN1bGFyTWFwOiBBc3NldHMuZ2V0KFwidGV4X21hcmluZV9zcGVjXCIpLFxuICAgICAgICAgICAgICAgICAgICBub3JtYWxTY2FsZTogMSxcbiAgICAgICAgICAgICAgICAgICAgc2hpbmluZXNzOiAzMFxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICBzaGFkZXI6IEFzc2V0cy5nZXQoXCJzaGFkZXJfbm9ybWFsX3NwZWN1bGFyXCIpXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBNYXRlcmlhbCh7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJtYXRfc3ByaXRlXCIsXG5cbiAgICAgICAgICAgICAgICB1bmlmb3Jtczoge1xuICAgICAgICAgICAgICAgICAgICBkaWZmdXNlTWFwOiBBc3NldHMuZ2V0KFwidGV4X21hcmluZV9ub3JcIilcbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgc2hhZGVyOiBBc3NldHMuZ2V0KFwic2hhZGVyX3VubGl0XCIpXG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIGdhbWUgPSBuZXcgR2FtZSh7XG4gICAgICAgICAgICBkZWJ1ZzogdHJ1ZVxuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgc2NlbmUgPSBuZXcgU2NlbmUoe1xuICAgICAgICAgICAgbmFtZTogXCJQbGF5R3JvdW5kXCIsXG4gICAgICAgICAgICB3b3JsZDoge1xuICAgICAgICAgICAgICAgIGFtYmllbnQ6IG5ldyBDb2xvcigpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBjYW1lcmEgPSBuZXcgR2FtZU9iamVjdCh7XG4gICAgICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICAgICAgbmV3IFRyYW5zZm9ybSh7XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgVmVjMygxMCwgMTAsIDEwKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBDYW1lcmEoe1xuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiBuZXcgQ29sb3IoKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBPcmJpdENvbnRyb2xcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB0YWc6IFwiQ2FtZXJhXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHNwaGVyZSA9IG5ldyBHYW1lT2JqZWN0KHtcbiAgICAgICAgICAgIGNvbXBvbmVudHM6IFtcbiAgICAgICAgICAgICAgICBuZXcgVHJhbnNmb3JtKHtcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IG5ldyBWZWMzKDEsIDAsIDApXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IE1lc2hGaWx0ZXIoe1xuICAgICAgICAgICAgICAgICAgICBtZXNoOiBBc3NldHMuZ2V0KFwibWVzaF9zcGhlcmVcIiksXG4gICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsOiBBc3NldHMuZ2V0KFwibWF0X2RlZmF1bHRcIilcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHRhZzogXCJNZXNoXCJcbiAgICAgICAgfSk7XG4gICAgICAgIG9kaW4gPSBuZXcgR2FtZU9iamVjdCh7XG4gICAgICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICAgICAgbmV3IFRyYW5zZm9ybSh7XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgVmVjMygtMSwgMCwgMClcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgTWVzaEZpbHRlcih7XG4gICAgICAgICAgICAgICAgICAgIG1lc2g6IEFzc2V0cy5nZXQoXCJtZXNoX29kaW5cIiksXG4gICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsOiBBc3NldHMuZ2V0KFwibWF0X2RlZmF1bHRcIilcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHRhZzogXCJNZXNoXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGN1YmUgPSBuZXcgR2FtZU9iamVjdCh7XG4gICAgICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICAgICAgbmV3IFRyYW5zZm9ybSh7XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgVmVjMygtMSwgMCwgMClcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgTWVzaEZpbHRlcih7XG4gICAgICAgICAgICAgICAgICAgIG1lc2g6IEFzc2V0cy5nZXQoXCJtZXNoX2N1YmVcIiksXG4gICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsOiBBc3NldHMuZ2V0KFwibWF0X2RlZmF1bHRcIilcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHRhZzogXCJNZXNoXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHBsYW5lID0gbmV3IEdhbWVPYmplY3Qoe1xuICAgICAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAgICAgIG5ldyBUcmFuc2Zvcm0oe1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogbmV3IFZlYzMoMCwgMCwgMClcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgTWVzaEZpbHRlcih7XG4gICAgICAgICAgICAgICAgICAgIG1lc2g6IEFzc2V0cy5nZXQoXCJtZXNoX3BsYW5lXCIpLFxuICAgICAgICAgICAgICAgICAgICBtYXRlcmlhbDogQXNzZXRzLmdldChcIm1hdF9kZWZhdWx0XCIpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB0YWc6IFwiTWVzaFwiXG4gICAgICAgIH0pO1xuICAgICAgICBzcHJpdGUgPSBuZXcgR2FtZU9iamVjdCh7XG4gICAgICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICAgICAgbmV3IFRyYW5zZm9ybSh7XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgVmVjMygwLCAwLCAxKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBTcHJpdGUoe1xuICAgICAgICAgICAgICAgICAgICBtYXRlcmlhbDogQXNzZXRzLmdldChcIm1hdF9kZWZhdWx0XCIpLFxuICAgICAgICAgICAgICAgICAgICB4OiAwLFxuICAgICAgICAgICAgICAgICAgICB5OiAwLFxuICAgICAgICAgICAgICAgICAgICB3OiAxMDI0LFxuICAgICAgICAgICAgICAgICAgICBoOiAxMDI0XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB0YWc6IFwiTWVzaFwiXG4gICAgICAgIH0pO1xuICAgICAgICBwb2ludExpZ2h0ID0gbmV3IEdhbWVPYmplY3Qoe1xuICAgICAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAgICAgIG5ldyBUcmFuc2Zvcm0oe1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogbmV3IFZlYzMoMCwgMCwgMjUpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IE1lc2hGaWx0ZXIoe1xuICAgICAgICAgICAgICAgICAgICBtZXNoOiBBc3NldHMuZ2V0KFwibWVzaF9zcGhlcmVcIiksXG4gICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsOiBBc3NldHMuZ2V0KFwibWF0X2RlZmF1bHRcIilcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgTGlnaHQoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBFbnVtcy5MaWdodFR5cGUuUG9pbnQsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBuZXcgQ29sb3IoMSwgMSwgMSksXG4gICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlOiAxNixcbiAgICAgICAgICAgICAgICAgICAgZW5lcmd5OiA1XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB0YWdzOiBbXG4gICAgICAgICAgICAgICAgXCJMaWdodFwiLFxuICAgICAgICAgICAgICAgIFwiUG9pbnRMaWdodFwiXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICBkaXJlY3Rpb25hbExpZ2h0ID0gbmV3IEdhbWVPYmplY3Qoe1xuICAgICAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAgICAgIG5ldyBUcmFuc2Zvcm0oe1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogbmV3IFZlYzMoMTAsIDUsIDI1KVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBNZXNoRmlsdGVyKHtcbiAgICAgICAgICAgICAgICAgICAgbWVzaDogQXNzZXRzLmdldChcIm1lc2hfc3BoZXJlXCIpLFxuICAgICAgICAgICAgICAgICAgICBtYXRlcmlhbDogQXNzZXRzLmdldChcIm1hdF9kZWZhdWx0XCIpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IExpZ2h0KHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogRW51bXMuTGlnaHRUeXBlLkRpcmVjdGlvbmFsLFxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogbmV3IENvbG9yKDEsIDEsIDEpLFxuICAgICAgICAgICAgICAgICAgICBlbmVyZ3k6IDFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHRhZ3M6IFtcbiAgICAgICAgICAgICAgICBcIkxpZ2h0XCIsXG4gICAgICAgICAgICAgICAgXCJEaXJlY3Rpb25hbExpZ2h0XCJcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSk7XG4gICAgICAgIHNwb3RMaWdodCA9IG5ldyBHYW1lT2JqZWN0KHtcbiAgICAgICAgICAgIGNvbXBvbmVudHM6IFtcbiAgICAgICAgICAgICAgICBuZXcgVHJhbnNmb3JtKHtcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IG5ldyBWZWMzKC0yNSwgLTI1LCAtMjUpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IE1lc2hGaWx0ZXIoe1xuICAgICAgICAgICAgICAgICAgICBtZXNoOiBBc3NldHMuZ2V0KFwibWVzaF9zcGhlcmVcIiksXG4gICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsOiBBc3NldHMuZ2V0KFwibWF0X2RlZmF1bHRcIilcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgTGlnaHQoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBFbnVtcy5MaWdodFR5cGUuU3BvdCxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IG5ldyBDb2xvcigwLCAwLCAxKSxcbiAgICAgICAgICAgICAgICAgICAgZW5lcmd5OiAxLFxuICAgICAgICAgICAgICAgICAgICBhbmdsZTogTWF0aC5QSSxcbiAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2U6IDBcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHRhZ3M6IFtcbiAgICAgICAgICAgICAgICBcIkxpZ2h0XCIsXG4gICAgICAgICAgICAgICAgXCJTcG90TGlnaHRcIlxuICAgICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICAgICAgaGVtaUxpZ2h0ID0gbmV3IEdhbWVPYmplY3Qoe1xuICAgICAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAgICAgIG5ldyBUcmFuc2Zvcm0oe1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogbmV3IFZlYzMoMCwgMCwgMjUpXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IE1lc2hGaWx0ZXIoe1xuICAgICAgICAgICAgICAgICAgICBtZXNoOiBBc3NldHMuZ2V0KFwibWVzaF9zcGhlcmVcIiksXG4gICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsOiBBc3NldHMuZ2V0KFwibWF0X2RlZmF1bHRcIilcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgTGlnaHQoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBFbnVtcy5MaWdodFR5cGUuSGVtaSxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IG5ldyBDb2xvcigxLCAxLCAxKSxcbiAgICAgICAgICAgICAgICAgICAgZW5lcmd5OiAxXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB0YWdzOiBbXG4gICAgICAgICAgICAgICAgXCJMaWdodFwiLFxuICAgICAgICAgICAgICAgIFwiSGVtaUxpZ2h0XCJcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2NlbmUuYWRkR2FtZU9iamVjdHMoY2FtZXJhLCBzcHJpdGUsIHBvaW50TGlnaHQsIHNwb3RMaWdodCwgZGlyZWN0aW9uYWxMaWdodCk7XG4gICAgICAgIGdhbWUuYWRkU2NlbmUoc2NlbmUpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGFkZE9iamVjdChzKSB7XG4gICAgICAgICAgICB2YXIgbnVtID0gcmFuZG9tKCksXG4gICAgICAgICAgICAgICAgaW5zdGFuY2U7XG5cbiAgICAgICAgICAgIGlmIChudW0gPCAwLjI1KSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBjdWJlLmNsb25lKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG51bSA+IDAuMjUgJiYgbnVtIDwgMC41KSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBzcGhlcmUuY2xvbmUoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobnVtID4gMC41ICYmIG51bSA8IDAuNzUpIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZSA9IG9kaW4uY2xvbmUoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBwbGFuZS5jbG9uZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpbnN0YW5jZS50cmFuc2Zvcm0ucG9zaXRpb24uc2V0KHJhbmRGbG9hdCgtMSwgMSksIHJhbmRGbG9hdCgtMSwgMSksIHJhbmRGbG9hdCgtMSwgMSkpLm5vcm1hbGl6ZSgpLnNtdWwocmFuZEZsb2F0KDAsIDI1KSk7XG4gICAgICAgICAgICBpbnN0YW5jZS50cmFuc2Zvcm0ucm90YXRpb24ucm90YXRlKHJhbmRGbG9hdCgtUEksIFBJKSwgcmFuZEZsb2F0KC1QSSwgUEkpLCByYW5kRmxvYXQoLVBJLCBQSSkpO1xuXG4gICAgICAgICAgICBzLmFkZEdhbWVPYmplY3QoaW5zdGFuY2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgICAgICBnYW1lLnNldFNjZW5lKFwiUGxheUdyb3VuZFwiKTtcbiAgICAgICAgICAgIGdhbWUuc2V0Q2FtZXJhKGdhbWUuc2NlbmUuZmluZEJ5VGFnRmlyc3QoXCJDYW1lcmFcIikpO1xuXG4gICAgICAgICAgICB2YXIgY3VycmVudFNjZW5lID0gZ2FtZS5zY2VuZSxcbiAgICAgICAgICAgICAgICBwTGlnaHQgPSBjdXJyZW50U2NlbmUuZmluZEJ5VGFnRmlyc3QoXCJQb2ludExpZ2h0XCIpLFxuICAgICAgICAgICAgICAgIHNMaWdodCA9IGN1cnJlbnRTY2VuZS5maW5kQnlUYWdGaXJzdChcIlNwb3RMaWdodFwiKSxcbiAgICAgICAgICAgICAgICBpO1xuICAgICAgICAgICAgZm9yIChpID0gMTAwOyBpLS07KSBhZGRPYmplY3QoY3VycmVudFNjZW5lKTtcblxuICAgICAgICAgICAgZ2FtZS5vbihcInVwZGF0ZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGltZSA9IFRpbWUudGltZSxcbiAgICAgICAgICAgICAgICAgICAgY29zVGltZSA9IGNvcyh0aW1lKSxcbiAgICAgICAgICAgICAgICAgICAgc2luVGltZSA9IHNpbih0aW1lKTtcblxuICAgICAgICAgICAgICAgIHBMaWdodC50cmFuc2Zvcm0ucG9zaXRpb24uc2V0KFxuICAgICAgICAgICAgICAgICAgICBjb3NUaW1lICogMTUsXG4gICAgICAgICAgICAgICAgICAgIHNpblRpbWUgKiAxNSxcbiAgICAgICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgc0xpZ2h0LnRyYW5zZm9ybS5wb3NpdGlvbi5zZXQoXG4gICAgICAgICAgICAgICAgICAgIGNvc1RpbWUgKiAxNSxcbiAgICAgICAgICAgICAgICAgICAgc2luVGltZSAqIDE1LFxuICAgICAgICAgICAgICAgICAgICBzaW5UaW1lICogMTVcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZXN0YXJ0KCkge1xuICAgICAgICAgICAgc3RhcnQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIEFzc2V0TG9hZGVyLm9uKFwibG9hZFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIEFzc2V0cy5nZXQoXCJtZXNoX29kaW5cIikuY2FsY3VsYXRlVGFuZ2VudHMoKTtcbiAgICAgICAgICAgIEFzc2V0cy5nZXQoXCJtZXNoX3NwaGVyZVwiKS5jYWxjdWxhdGVUYW5nZW50cygpO1xuICAgICAgICAgICAgQXNzZXRzLmdldChcIm1lc2hfcGxhbmVcIikuY2FsY3VsYXRlVGFuZ2VudHMoKTtcbiAgICAgICAgICAgIEFzc2V0cy5nZXQoXCJtZXNoX2N1YmVcIikuY2FsY3VsYXRlVGFuZ2VudHMoKTtcblxuICAgICAgICAgICAgZ2FtZS5vbihcImluaXRcIiwgc3RhcnQpLmluaXQoKTtcbiAgICAgICAgfSkubG9hZCgpO1xuIiwiLyohXG4gKiBUaGUgYnVmZmVyIG1vZHVsZSBmcm9tIG5vZGUuanMsIGZvciB0aGUgYnJvd3Nlci5cbiAqXG4gKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8ZmVyb3NzQGZlcm9zcy5vcmc+IDxodHRwOi8vZmVyb3NzLm9yZz5cbiAqIEBsaWNlbnNlICBNSVRcbiAqL1xuXG52YXIgYmFzZTY0ID0gcmVxdWlyZSgnYmFzZTY0LWpzJylcbnZhciBpZWVlNzU0ID0gcmVxdWlyZSgnaWVlZTc1NCcpXG52YXIgaXNBcnJheSA9IHJlcXVpcmUoJ2lzLWFycmF5JylcblxuZXhwb3J0cy5CdWZmZXIgPSBCdWZmZXJcbmV4cG9ydHMuU2xvd0J1ZmZlciA9IEJ1ZmZlclxuZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFUyA9IDUwXG5CdWZmZXIucG9vbFNpemUgPSA4MTkyIC8vIG5vdCB1c2VkIGJ5IHRoaXMgaW1wbGVtZW50YXRpb25cblxudmFyIGtNYXhMZW5ndGggPSAweDNmZmZmZmZmXG5cbi8qKlxuICogSWYgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYDpcbiAqICAgPT09IHRydWUgICAgVXNlIFVpbnQ4QXJyYXkgaW1wbGVtZW50YXRpb24gKGZhc3Rlc3QpXG4gKiAgID09PSBmYWxzZSAgIFVzZSBPYmplY3QgaW1wbGVtZW50YXRpb24gKG1vc3QgY29tcGF0aWJsZSwgZXZlbiBJRTYpXG4gKlxuICogQnJvd3NlcnMgdGhhdCBzdXBwb3J0IHR5cGVkIGFycmF5cyBhcmUgSUUgMTArLCBGaXJlZm94IDQrLCBDaHJvbWUgNyssIFNhZmFyaSA1LjErLFxuICogT3BlcmEgMTEuNissIGlPUyA0LjIrLlxuICpcbiAqIE5vdGU6XG4gKlxuICogLSBJbXBsZW1lbnRhdGlvbiBtdXN0IHN1cHBvcnQgYWRkaW5nIG5ldyBwcm9wZXJ0aWVzIHRvIGBVaW50OEFycmF5YCBpbnN0YW5jZXMuXG4gKiAgIEZpcmVmb3ggNC0yOSBsYWNrZWQgc3VwcG9ydCwgZml4ZWQgaW4gRmlyZWZveCAzMCsuXG4gKiAgIFNlZTogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9Njk1NDM4LlxuICpcbiAqICAtIENocm9tZSA5LTEwIGlzIG1pc3NpbmcgdGhlIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24uXG4gKlxuICogIC0gSUUxMCBoYXMgYSBicm9rZW4gYFR5cGVkQXJyYXkucHJvdG90eXBlLnN1YmFycmF5YCBmdW5jdGlvbiB3aGljaCByZXR1cm5zIGFycmF5cyBvZlxuICogICAgaW5jb3JyZWN0IGxlbmd0aCBpbiBzb21lIHNpdHVhdGlvbnMuXG4gKlxuICogV2UgZGV0ZWN0IHRoZXNlIGJ1Z2d5IGJyb3dzZXJzIGFuZCBzZXQgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYCB0byBgZmFsc2VgIHNvIHRoZXkgd2lsbFxuICogZ2V0IHRoZSBPYmplY3QgaW1wbGVtZW50YXRpb24sIHdoaWNoIGlzIHNsb3dlciBidXQgd2lsbCB3b3JrIGNvcnJlY3RseS5cbiAqL1xuQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgPSAoZnVuY3Rpb24gKCkge1xuICB0cnkge1xuICAgIHZhciBidWYgPSBuZXcgQXJyYXlCdWZmZXIoMClcbiAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoYnVmKVxuICAgIGFyci5mb28gPSBmdW5jdGlvbiAoKSB7IHJldHVybiA0MiB9XG4gICAgcmV0dXJuIDQyID09PSBhcnIuZm9vKCkgJiYgLy8gdHlwZWQgYXJyYXkgaW5zdGFuY2VzIGNhbiBiZSBhdWdtZW50ZWRcbiAgICAgICAgdHlwZW9mIGFyci5zdWJhcnJheSA9PT0gJ2Z1bmN0aW9uJyAmJiAvLyBjaHJvbWUgOS0xMCBsYWNrIGBzdWJhcnJheWBcbiAgICAgICAgbmV3IFVpbnQ4QXJyYXkoMSkuc3ViYXJyYXkoMSwgMSkuYnl0ZUxlbmd0aCA9PT0gMCAvLyBpZTEwIGhhcyBicm9rZW4gYHN1YmFycmF5YFxuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn0pKClcblxuLyoqXG4gKiBDbGFzczogQnVmZmVyXG4gKiA9PT09PT09PT09PT09XG4gKlxuICogVGhlIEJ1ZmZlciBjb25zdHJ1Y3RvciByZXR1cm5zIGluc3RhbmNlcyBvZiBgVWludDhBcnJheWAgdGhhdCBhcmUgYXVnbWVudGVkXG4gKiB3aXRoIGZ1bmN0aW9uIHByb3BlcnRpZXMgZm9yIGFsbCB0aGUgbm9kZSBgQnVmZmVyYCBBUEkgZnVuY3Rpb25zLiBXZSB1c2VcbiAqIGBVaW50OEFycmF5YCBzbyB0aGF0IHNxdWFyZSBicmFja2V0IG5vdGF0aW9uIHdvcmtzIGFzIGV4cGVjdGVkIC0tIGl0IHJldHVybnNcbiAqIGEgc2luZ2xlIG9jdGV0LlxuICpcbiAqIEJ5IGF1Z21lbnRpbmcgdGhlIGluc3RhbmNlcywgd2UgY2FuIGF2b2lkIG1vZGlmeWluZyB0aGUgYFVpbnQ4QXJyYXlgXG4gKiBwcm90b3R5cGUuXG4gKi9cbmZ1bmN0aW9uIEJ1ZmZlciAoc3ViamVjdCwgZW5jb2RpbmcsIG5vWmVybykge1xuICBpZiAoISh0aGlzIGluc3RhbmNlb2YgQnVmZmVyKSlcbiAgICByZXR1cm4gbmV3IEJ1ZmZlcihzdWJqZWN0LCBlbmNvZGluZywgbm9aZXJvKVxuXG4gIHZhciB0eXBlID0gdHlwZW9mIHN1YmplY3RcblxuICAvLyBGaW5kIHRoZSBsZW5ndGhcbiAgdmFyIGxlbmd0aFxuICBpZiAodHlwZSA9PT0gJ251bWJlcicpXG4gICAgbGVuZ3RoID0gc3ViamVjdCA+IDAgPyBzdWJqZWN0ID4+PiAwIDogMFxuICBlbHNlIGlmICh0eXBlID09PSAnc3RyaW5nJykge1xuICAgIGlmIChlbmNvZGluZyA9PT0gJ2Jhc2U2NCcpXG4gICAgICBzdWJqZWN0ID0gYmFzZTY0Y2xlYW4oc3ViamVjdClcbiAgICBsZW5ndGggPSBCdWZmZXIuYnl0ZUxlbmd0aChzdWJqZWN0LCBlbmNvZGluZylcbiAgfSBlbHNlIGlmICh0eXBlID09PSAnb2JqZWN0JyAmJiBzdWJqZWN0ICE9PSBudWxsKSB7IC8vIGFzc3VtZSBvYmplY3QgaXMgYXJyYXktbGlrZVxuICAgIGlmIChzdWJqZWN0LnR5cGUgPT09ICdCdWZmZXInICYmIGlzQXJyYXkoc3ViamVjdC5kYXRhKSlcbiAgICAgIHN1YmplY3QgPSBzdWJqZWN0LmRhdGFcbiAgICBsZW5ndGggPSArc3ViamVjdC5sZW5ndGggPiAwID8gTWF0aC5mbG9vcigrc3ViamVjdC5sZW5ndGgpIDogMFxuICB9IGVsc2VcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdtdXN0IHN0YXJ0IHdpdGggbnVtYmVyLCBidWZmZXIsIGFycmF5IG9yIHN0cmluZycpXG5cbiAgaWYgKHRoaXMubGVuZ3RoID4ga01heExlbmd0aClcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQXR0ZW1wdCB0byBhbGxvY2F0ZSBCdWZmZXIgbGFyZ2VyIHRoYW4gbWF4aW11bSAnICtcbiAgICAgICdzaXplOiAweCcgKyBrTWF4TGVuZ3RoLnRvU3RyaW5nKDE2KSArICcgYnl0ZXMnKVxuXG4gIHZhciBidWZcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gUHJlZmVycmVkOiBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSBmb3IgYmVzdCBwZXJmb3JtYW5jZVxuICAgIGJ1ZiA9IEJ1ZmZlci5fYXVnbWVudChuZXcgVWludDhBcnJheShsZW5ndGgpKVxuICB9IGVsc2Uge1xuICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gVEhJUyBpbnN0YW5jZSBvZiBCdWZmZXIgKGNyZWF0ZWQgYnkgYG5ld2ApXG4gICAgYnVmID0gdGhpc1xuICAgIGJ1Zi5sZW5ndGggPSBsZW5ndGhcbiAgICBidWYuX2lzQnVmZmVyID0gdHJ1ZVxuICB9XG5cbiAgdmFyIGlcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmIHR5cGVvZiBzdWJqZWN0LmJ5dGVMZW5ndGggPT09ICdudW1iZXInKSB7XG4gICAgLy8gU3BlZWQgb3B0aW1pemF0aW9uIC0tIHVzZSBzZXQgaWYgd2UncmUgY29weWluZyBmcm9tIGEgdHlwZWQgYXJyYXlcbiAgICBidWYuX3NldChzdWJqZWN0KVxuICB9IGVsc2UgaWYgKGlzQXJyYXlpc2goc3ViamVjdCkpIHtcbiAgICAvLyBUcmVhdCBhcnJheS1pc2ggb2JqZWN0cyBhcyBhIGJ5dGUgYXJyYXlcbiAgICBpZiAoQnVmZmVyLmlzQnVmZmVyKHN1YmplY3QpKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXG4gICAgICAgIGJ1ZltpXSA9IHN1YmplY3QucmVhZFVJbnQ4KGkpXG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKylcbiAgICAgICAgYnVmW2ldID0gKChzdWJqZWN0W2ldICUgMjU2KSArIDI1NikgJSAyNTZcbiAgICB9XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3N0cmluZycpIHtcbiAgICBidWYud3JpdGUoc3ViamVjdCwgMCwgZW5jb2RpbmcpXG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gJ251bWJlcicgJiYgIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmICFub1plcm8pIHtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIGJ1ZltpXSA9IDBcbiAgICB9XG4gIH1cblxuICByZXR1cm4gYnVmXG59XG5cbkJ1ZmZlci5pc0J1ZmZlciA9IGZ1bmN0aW9uIChiKSB7XG4gIHJldHVybiAhIShiICE9IG51bGwgJiYgYi5faXNCdWZmZXIpXG59XG5cbkJ1ZmZlci5jb21wYXJlID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYSkgfHwgIUJ1ZmZlci5pc0J1ZmZlcihiKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzJylcblxuICB2YXIgeCA9IGEubGVuZ3RoXG4gIHZhciB5ID0gYi5sZW5ndGhcbiAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IE1hdGgubWluKHgsIHkpOyBpIDwgbGVuICYmIGFbaV0gPT09IGJbaV07IGkrKykge31cbiAgaWYgKGkgIT09IGxlbikge1xuICAgIHggPSBhW2ldXG4gICAgeSA9IGJbaV1cbiAgfVxuICBpZiAoeCA8IHkpIHJldHVybiAtMVxuICBpZiAoeSA8IHgpIHJldHVybiAxXG4gIHJldHVybiAwXG59XG5cbkJ1ZmZlci5pc0VuY29kaW5nID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7XG4gIHN3aXRjaCAoU3RyaW5nKGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgY2FzZSAnaGV4JzpcbiAgICBjYXNlICd1dGY4JzpcbiAgICBjYXNlICd1dGYtOCc6XG4gICAgY2FzZSAnYXNjaWknOlxuICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgY2FzZSAnYmFzZTY0JzpcbiAgICBjYXNlICdyYXcnOlxuICAgIGNhc2UgJ3VjczInOlxuICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICBjYXNlICd1dGYxNmxlJzpcbiAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZmFsc2VcbiAgfVxufVxuXG5CdWZmZXIuY29uY2F0ID0gZnVuY3Rpb24gKGxpc3QsIHRvdGFsTGVuZ3RoKSB7XG4gIGlmICghaXNBcnJheShsaXN0KSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVXNhZ2U6IEJ1ZmZlci5jb25jYXQobGlzdFssIGxlbmd0aF0pJylcblxuICBpZiAobGlzdC5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbmV3IEJ1ZmZlcigwKVxuICB9IGVsc2UgaWYgKGxpc3QubGVuZ3RoID09PSAxKSB7XG4gICAgcmV0dXJuIGxpc3RbMF1cbiAgfVxuXG4gIHZhciBpXG4gIGlmICh0b3RhbExlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdG90YWxMZW5ndGggPSAwXG4gICAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRvdGFsTGVuZ3RoICs9IGxpc3RbaV0ubGVuZ3RoXG4gICAgfVxuICB9XG5cbiAgdmFyIGJ1ZiA9IG5ldyBCdWZmZXIodG90YWxMZW5ndGgpXG4gIHZhciBwb3MgPSAwXG4gIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGl0ZW0gPSBsaXN0W2ldXG4gICAgaXRlbS5jb3B5KGJ1ZiwgcG9zKVxuICAgIHBvcyArPSBpdGVtLmxlbmd0aFxuICB9XG4gIHJldHVybiBidWZcbn1cblxuQnVmZmVyLmJ5dGVMZW5ndGggPSBmdW5jdGlvbiAoc3RyLCBlbmNvZGluZykge1xuICB2YXIgcmV0XG4gIHN0ciA9IHN0ciArICcnXG4gIHN3aXRjaCAoZW5jb2RpbmcgfHwgJ3V0ZjgnKSB7XG4gICAgY2FzZSAnYXNjaWknOlxuICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgY2FzZSAncmF3JzpcbiAgICAgIHJldCA9IHN0ci5sZW5ndGhcbiAgICAgIGJyZWFrXG4gICAgY2FzZSAndWNzMic6XG4gICAgY2FzZSAndWNzLTInOlxuICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgIHJldCA9IHN0ci5sZW5ndGggKiAyXG4gICAgICBicmVha1xuICAgIGNhc2UgJ2hleCc6XG4gICAgICByZXQgPSBzdHIubGVuZ3RoID4+PiAxXG4gICAgICBicmVha1xuICAgIGNhc2UgJ3V0ZjgnOlxuICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgIHJldCA9IHV0ZjhUb0J5dGVzKHN0cikubGVuZ3RoXG4gICAgICBicmVha1xuICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICByZXQgPSBiYXNlNjRUb0J5dGVzKHN0cikubGVuZ3RoXG4gICAgICBicmVha1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXQgPSBzdHIubGVuZ3RoXG4gIH1cbiAgcmV0dXJuIHJldFxufVxuXG4vLyBwcmUtc2V0IGZvciB2YWx1ZXMgdGhhdCBtYXkgZXhpc3QgaW4gdGhlIGZ1dHVyZVxuQnVmZmVyLnByb3RvdHlwZS5sZW5ndGggPSB1bmRlZmluZWRcbkJ1ZmZlci5wcm90b3R5cGUucGFyZW50ID0gdW5kZWZpbmVkXG5cbi8vIHRvU3RyaW5nKGVuY29kaW5nLCBzdGFydD0wLCBlbmQ9YnVmZmVyLmxlbmd0aClcbkJ1ZmZlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcblxuICBzdGFydCA9IHN0YXJ0ID4+PiAwXG4gIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkIHx8IGVuZCA9PT0gSW5maW5pdHkgPyB0aGlzLmxlbmd0aCA6IGVuZCA+Pj4gMFxuXG4gIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnXG4gIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMFxuICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmIChlbmQgPD0gc3RhcnQpIHJldHVybiAnJ1xuXG4gIHdoaWxlICh0cnVlKSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgcmV0dXJuIGhleFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgICByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgICAgcmV0dXJuIGFzY2lpU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGJpbmFyeVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdXRmMTZsZVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSlcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpXG4gICAgICAgIGVuY29kaW5nID0gKGVuY29kaW5nICsgJycpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlXG4gICAgfVxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKGIpIHtcbiAgaWYoIUJ1ZmZlci5pc0J1ZmZlcihiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIHJldHVybiBCdWZmZXIuY29tcGFyZSh0aGlzLCBiKSA9PT0gMFxufVxuXG5CdWZmZXIucHJvdG90eXBlLmluc3BlY3QgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBzdHIgPSAnJ1xuICB2YXIgbWF4ID0gZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFU1xuICBpZiAodGhpcy5sZW5ndGggPiAwKSB7XG4gICAgc3RyID0gdGhpcy50b1N0cmluZygnaGV4JywgMCwgbWF4KS5tYXRjaCgvLnsyfS9nKS5qb2luKCcgJylcbiAgICBpZiAodGhpcy5sZW5ndGggPiBtYXgpXG4gICAgICBzdHIgKz0gJyAuLi4gJ1xuICB9XG4gIHJldHVybiAnPEJ1ZmZlciAnICsgc3RyICsgJz4nXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuY29tcGFyZSA9IGZ1bmN0aW9uIChiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyJylcbiAgcmV0dXJuIEJ1ZmZlci5jb21wYXJlKHRoaXMsIGIpXG59XG5cbi8vIGBnZXRgIHdpbGwgYmUgcmVtb3ZlZCBpbiBOb2RlIDAuMTMrXG5CdWZmZXIucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChvZmZzZXQpIHtcbiAgY29uc29sZS5sb2coJy5nZXQoKSBpcyBkZXByZWNhdGVkLiBBY2Nlc3MgdXNpbmcgYXJyYXkgaW5kZXhlcyBpbnN0ZWFkLicpXG4gIHJldHVybiB0aGlzLnJlYWRVSW50OChvZmZzZXQpXG59XG5cbi8vIGBzZXRgIHdpbGwgYmUgcmVtb3ZlZCBpbiBOb2RlIDAuMTMrXG5CdWZmZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh2LCBvZmZzZXQpIHtcbiAgY29uc29sZS5sb2coJy5zZXQoKSBpcyBkZXByZWNhdGVkLiBBY2Nlc3MgdXNpbmcgYXJyYXkgaW5kZXhlcyBpbnN0ZWFkLicpXG4gIHJldHVybiB0aGlzLndyaXRlVUludDgodiwgb2Zmc2V0KVxufVxuXG5mdW5jdGlvbiBoZXhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIG9mZnNldCA9IE51bWJlcihvZmZzZXQpIHx8IDBcbiAgdmFyIHJlbWFpbmluZyA9IGJ1Zi5sZW5ndGggLSBvZmZzZXRcbiAgaWYgKCFsZW5ndGgpIHtcbiAgICBsZW5ndGggPSByZW1haW5pbmdcbiAgfSBlbHNlIHtcbiAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKVxuICAgIGlmIChsZW5ndGggPiByZW1haW5pbmcpIHtcbiAgICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICAgIH1cbiAgfVxuXG4gIC8vIG11c3QgYmUgYW4gZXZlbiBudW1iZXIgb2YgZGlnaXRzXG4gIHZhciBzdHJMZW4gPSBzdHJpbmcubGVuZ3RoXG4gIGlmIChzdHJMZW4gJSAyICE9PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpXG5cbiAgaWYgKGxlbmd0aCA+IHN0ckxlbiAvIDIpIHtcbiAgICBsZW5ndGggPSBzdHJMZW4gLyAyXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIHZhciBieXRlID0gcGFyc2VJbnQoc3RyaW5nLnN1YnN0cihpICogMiwgMiksIDE2KVxuICAgIGlmIChpc05hTihieXRlKSkgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGhleCBzdHJpbmcnKVxuICAgIGJ1ZltvZmZzZXQgKyBpXSA9IGJ5dGVcbiAgfVxuICByZXR1cm4gaVxufVxuXG5mdW5jdGlvbiB1dGY4V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICB2YXIgY2hhcnNXcml0dGVuID0gYmxpdEJ1ZmZlcih1dGY4VG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxuICByZXR1cm4gY2hhcnNXcml0dGVuXG59XG5cbmZ1bmN0aW9uIGFzY2lpV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICB2YXIgY2hhcnNXcml0dGVuID0gYmxpdEJ1ZmZlcihhc2NpaVRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbiAgcmV0dXJuIGNoYXJzV3JpdHRlblxufVxuXG5mdW5jdGlvbiBiaW5hcnlXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBhc2NpaVdyaXRlKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gYmFzZTY0V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICB2YXIgY2hhcnNXcml0dGVuID0gYmxpdEJ1ZmZlcihiYXNlNjRUb0J5dGVzKHN0cmluZyksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG4gIHJldHVybiBjaGFyc1dyaXR0ZW5cbn1cblxuZnVuY3Rpb24gdXRmMTZsZVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgdmFyIGNoYXJzV3JpdHRlbiA9IGJsaXRCdWZmZXIodXRmMTZsZVRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbiAgcmV0dXJuIGNoYXJzV3JpdHRlblxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKHN0cmluZywgb2Zmc2V0LCBsZW5ndGgsIGVuY29kaW5nKSB7XG4gIC8vIFN1cHBvcnQgYm90aCAoc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCwgZW5jb2RpbmcpXG4gIC8vIGFuZCB0aGUgbGVnYWN5IChzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXQsIGxlbmd0aClcbiAgaWYgKGlzRmluaXRlKG9mZnNldCkpIHtcbiAgICBpZiAoIWlzRmluaXRlKGxlbmd0aCkpIHtcbiAgICAgIGVuY29kaW5nID0gbGVuZ3RoXG4gICAgICBsZW5ndGggPSB1bmRlZmluZWRcbiAgICB9XG4gIH0gZWxzZSB7ICAvLyBsZWdhY3lcbiAgICB2YXIgc3dhcCA9IGVuY29kaW5nXG4gICAgZW5jb2RpbmcgPSBvZmZzZXRcbiAgICBvZmZzZXQgPSBsZW5ndGhcbiAgICBsZW5ndGggPSBzd2FwXG4gIH1cblxuICBvZmZzZXQgPSBOdW1iZXIob2Zmc2V0KSB8fCAwXG4gIHZhciByZW1haW5pbmcgPSB0aGlzLmxlbmd0aCAtIG9mZnNldFxuICBpZiAoIWxlbmd0aCkge1xuICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICB9IGVsc2Uge1xuICAgIGxlbmd0aCA9IE51bWJlcihsZW5ndGgpXG4gICAgaWYgKGxlbmd0aCA+IHJlbWFpbmluZykge1xuICAgICAgbGVuZ3RoID0gcmVtYWluaW5nXG4gICAgfVxuICB9XG4gIGVuY29kaW5nID0gU3RyaW5nKGVuY29kaW5nIHx8ICd1dGY4JykudG9Mb3dlckNhc2UoKVxuXG4gIHZhciByZXRcbiAgc3dpdGNoIChlbmNvZGluZykge1xuICAgIGNhc2UgJ2hleCc6XG4gICAgICByZXQgPSBoZXhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuICAgICAgYnJlYWtcbiAgICBjYXNlICd1dGY4JzpcbiAgICBjYXNlICd1dGYtOCc6XG4gICAgICByZXQgPSB1dGY4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcbiAgICAgIGJyZWFrXG4gICAgY2FzZSAnYXNjaWknOlxuICAgICAgcmV0ID0gYXNjaWlXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuICAgICAgYnJlYWtcbiAgICBjYXNlICdiaW5hcnknOlxuICAgICAgcmV0ID0gYmluYXJ5V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcbiAgICAgIGJyZWFrXG4gICAgY2FzZSAnYmFzZTY0JzpcbiAgICAgIHJldCA9IGJhc2U2NFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG4gICAgICBicmVha1xuICAgIGNhc2UgJ3VjczInOlxuICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICBjYXNlICd1dGYxNmxlJzpcbiAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICByZXQgPSB1dGYxNmxlV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcbiAgICAgIGJyZWFrXG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdCdWZmZXInLFxuICAgIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKVxuICB9XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKHN0YXJ0ID09PSAwICYmIGVuZCA9PT0gYnVmLmxlbmd0aCkge1xuICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1Zi5zbGljZShzdGFydCwgZW5kKSlcbiAgfVxufVxuXG5mdW5jdGlvbiB1dGY4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmVzID0gJydcbiAgdmFyIHRtcCA9ICcnXG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcblxuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgIGlmIChidWZbaV0gPD0gMHg3Rikge1xuICAgICAgcmVzICs9IGRlY29kZVV0ZjhDaGFyKHRtcCkgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSlcbiAgICAgIHRtcCA9ICcnXG4gICAgfSBlbHNlIHtcbiAgICAgIHRtcCArPSAnJScgKyBidWZbaV0udG9TdHJpbmcoMTYpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlcyArIGRlY29kZVV0ZjhDaGFyKHRtcClcbn1cblxuZnVuY3Rpb24gYXNjaWlTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIHZhciByZXQgPSAnJ1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG5cbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICByZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZbaV0pXG4gIH1cbiAgcmV0dXJuIHJldFxufVxuXG5mdW5jdGlvbiBiaW5hcnlTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIHJldHVybiBhc2NpaVNsaWNlKGJ1Ziwgc3RhcnQsIGVuZClcbn1cblxuZnVuY3Rpb24gaGV4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gYnVmLmxlbmd0aFxuXG4gIGlmICghc3RhcnQgfHwgc3RhcnQgPCAwKSBzdGFydCA9IDBcbiAgaWYgKCFlbmQgfHwgZW5kIDwgMCB8fCBlbmQgPiBsZW4pIGVuZCA9IGxlblxuXG4gIHZhciBvdXQgPSAnJ1xuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgIG91dCArPSB0b0hleChidWZbaV0pXG4gIH1cbiAgcmV0dXJuIG91dFxufVxuXG5mdW5jdGlvbiB1dGYxNmxlU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgYnl0ZXMgPSBidWYuc2xpY2Uoc3RhcnQsIGVuZClcbiAgdmFyIHJlcyA9ICcnXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpICs9IDIpIHtcbiAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1tpXSArIGJ5dGVzW2kgKyAxXSAqIDI1NilcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgc3RhcnQgPSB+fnN0YXJ0XG4gIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogfn5lbmRcblxuICBpZiAoc3RhcnQgPCAwKSB7XG4gICAgc3RhcnQgKz0gbGVuO1xuICAgIGlmIChzdGFydCA8IDApXG4gICAgICBzdGFydCA9IDBcbiAgfSBlbHNlIGlmIChzdGFydCA+IGxlbikge1xuICAgIHN0YXJ0ID0gbGVuXG4gIH1cblxuICBpZiAoZW5kIDwgMCkge1xuICAgIGVuZCArPSBsZW5cbiAgICBpZiAoZW5kIDwgMClcbiAgICAgIGVuZCA9IDBcbiAgfSBlbHNlIGlmIChlbmQgPiBsZW4pIHtcbiAgICBlbmQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCBzdGFydClcbiAgICBlbmQgPSBzdGFydFxuXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHJldHVybiBCdWZmZXIuX2F1Z21lbnQodGhpcy5zdWJhcnJheShzdGFydCwgZW5kKSlcbiAgfSBlbHNlIHtcbiAgICB2YXIgc2xpY2VMZW4gPSBlbmQgLSBzdGFydFxuICAgIHZhciBuZXdCdWYgPSBuZXcgQnVmZmVyKHNsaWNlTGVuLCB1bmRlZmluZWQsIHRydWUpXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzbGljZUxlbjsgaSsrKSB7XG4gICAgICBuZXdCdWZbaV0gPSB0aGlzW2kgKyBzdGFydF1cbiAgICB9XG4gICAgcmV0dXJuIG5ld0J1ZlxuICB9XG59XG5cbi8qXG4gKiBOZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IGJ1ZmZlciBpc24ndCB0cnlpbmcgdG8gd3JpdGUgb3V0IG9mIGJvdW5kcy5cbiAqL1xuZnVuY3Rpb24gY2hlY2tPZmZzZXQgKG9mZnNldCwgZXh0LCBsZW5ndGgpIHtcbiAgaWYgKChvZmZzZXQgJSAxKSAhPT0gMCB8fCBvZmZzZXQgPCAwKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdvZmZzZXQgaXMgbm90IHVpbnQnKVxuICBpZiAob2Zmc2V0ICsgZXh0ID4gbGVuZ3RoKVxuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoJylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KVxuICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiB0aGlzW29mZnNldF1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2TEUgPSBmdW5jdGlvbiAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KVxuICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiB0aGlzW29mZnNldF0gfCAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZCRSA9IGZ1bmN0aW9uIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpXG4gICAgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgOCkgfCB0aGlzW29mZnNldCArIDFdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydClcbiAgICBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAoKHRoaXNbb2Zmc2V0XSkgfFxuICAgICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkgfFxuICAgICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgMTYpKSArXG4gICAgICAodGhpc1tvZmZzZXQgKyAzXSAqIDB4MTAwMDAwMClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDMyQkUgPSBmdW5jdGlvbiAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KVxuICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gKiAweDEwMDAwMDApICtcbiAgICAgICgodGhpc1tvZmZzZXQgKyAxXSA8PCAxNikgfFxuICAgICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfFxuICAgICAgdGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50OCA9IGZ1bmN0aW9uIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpXG4gICAgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aClcbiAgaWYgKCEodGhpc1tvZmZzZXRdICYgMHg4MCkpXG4gICAgcmV0dXJuICh0aGlzW29mZnNldF0pXG4gIHJldHVybiAoKDB4ZmYgLSB0aGlzW29mZnNldF0gKyAxKSAqIC0xKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkxFID0gZnVuY3Rpb24gKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydClcbiAgICBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbiAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkJFID0gZnVuY3Rpb24gKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydClcbiAgICBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAxXSB8ICh0aGlzW29mZnNldF0gPDwgOClcbiAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkxFID0gZnVuY3Rpb24gKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydClcbiAgICBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdKSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikgfFxuICAgICAgKHRoaXNbb2Zmc2V0ICsgM10gPDwgMjQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyQkUgPSBmdW5jdGlvbiAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KVxuICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgMjQpIHxcbiAgICAgICh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRMRSA9IGZ1bmN0aW9uIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpXG4gICAgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIHRydWUsIDIzLCA0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRGbG9hdEJFID0gZnVuY3Rpb24gKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydClcbiAgICBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgZmFsc2UsIDIzLCA0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVMRSA9IGZ1bmN0aW9uIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpXG4gICAgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIHRydWUsIDUyLCA4KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVCRSA9IGZ1bmN0aW9uIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpXG4gICAgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIGZhbHNlLCA1MiwgOClcbn1cblxuZnVuY3Rpb24gY2hlY2tJbnQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdidWZmZXIgbXVzdCBiZSBhIEJ1ZmZlciBpbnN0YW5jZScpXG4gIGlmICh2YWx1ZSA+IG1heCB8fCB2YWx1ZSA8IG1pbikgdGhyb3cgbmV3IFR5cGVFcnJvcigndmFsdWUgaXMgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbmRleCBvdXQgb2YgcmFuZ2UnKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDggPSBmdW5jdGlvbiAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwXG4gIGlmICghbm9Bc3NlcnQpXG4gICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMSwgMHhmZiwgMClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKVxuICB0aGlzW29mZnNldF0gPSB2YWx1ZVxuICByZXR1cm4gb2Zmc2V0ICsgMVxufVxuXG5mdW5jdGlvbiBvYmplY3RXcml0ZVVJbnQxNiAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4pIHtcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmYgKyB2YWx1ZSArIDFcbiAgZm9yICh2YXIgaSA9IDAsIGogPSBNYXRoLm1pbihidWYubGVuZ3RoIC0gb2Zmc2V0LCAyKTsgaSA8IGo7IGkrKykge1xuICAgIGJ1ZltvZmZzZXQgKyBpXSA9ICh2YWx1ZSAmICgweGZmIDw8ICg4ICogKGxpdHRsZUVuZGlhbiA/IGkgOiAxIC0gaSkpKSkgPj4+XG4gICAgICAobGl0dGxlRW5kaWFuID8gaSA6IDEgLSBpKSAqIDhcbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2TEUgPSBmdW5jdGlvbiAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwXG4gIGlmICghbm9Bc3NlcnQpXG4gICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSB2YWx1ZVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2QkUgPSBmdW5jdGlvbiAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwXG4gIGlmICghbm9Bc3NlcnQpXG4gICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9IHZhbHVlXG4gIH0gZWxzZSBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgcmV0dXJuIG9mZnNldCArIDJcbn1cblxuZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MzIgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7XG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMVxuICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDQpOyBpIDwgajsgaSsrKSB7XG4gICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlID4+PiAobGl0dGxlRW5kaWFuID8gaSA6IDMgLSBpKSAqIDgpICYgMHhmZlxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJMRSA9IGZ1bmN0aW9uICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgPj4+IDBcbiAgaWYgKCFub0Fzc2VydClcbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlID4+PiAyNClcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0XSA9IHZhbHVlXG4gIH0gZWxzZSBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyQkUgPSBmdW5jdGlvbiAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwXG4gIGlmICghbm9Bc3NlcnQpXG4gICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiAyNClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSB2YWx1ZVxuICB9IGVsc2Ugb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQ4ID0gZnVuY3Rpb24gKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCA+Pj4gMFxuICBpZiAoIW5vQXNzZXJ0KVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4N2YsIC0weDgwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZiArIHZhbHVlICsgMVxuICB0aGlzW29mZnNldF0gPSB2YWx1ZVxuICByZXR1cm4gb2Zmc2V0ICsgMVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZMRSA9IGZ1bmN0aW9uICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgPj4+IDBcbiAgaWYgKCFub0Fzc2VydClcbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9IHZhbHVlXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgfSBlbHNlIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQxNkJFID0gZnVuY3Rpb24gKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCA+Pj4gMFxuICBpZiAoIW5vQXNzZXJ0KVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSB2YWx1ZVxuICB9IGVsc2Ugb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkxFID0gZnVuY3Rpb24gKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCA+Pj4gMFxuICBpZiAoIW5vQXNzZXJ0KVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSB2YWx1ZVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpXG4gIH0gZWxzZSBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJCRSA9IGZ1bmN0aW9uICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgPj4+IDBcbiAgaWYgKCFub0Fzc2VydClcbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDNdID0gdmFsdWVcbiAgfSBlbHNlIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5mdW5jdGlvbiBjaGVja0lFRUU3NTQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ZhbHVlIGlzIG91dCBvZiBib3VuZHMnKVxuICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFR5cGVFcnJvcignaW5kZXggb3V0IG9mIHJhbmdlJylcbn1cblxuZnVuY3Rpb24gd3JpdGVGbG9hdCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpXG4gICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgNCwgMy40MDI4MjM0NjYzODUyODg2ZSszOCwgLTMuNDAyODIzNDY2Mzg1Mjg4NmUrMzgpXG4gIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDIzLCA0KVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRMRSA9IGZ1bmN0aW9uICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVGbG9hdCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlLCBub0Fzc2VydClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0QkUgPSBmdW5jdGlvbiAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KVxufVxuXG5mdW5jdGlvbiB3cml0ZURvdWJsZSAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpXG4gICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgOCwgMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgsIC0xLjc5NzY5MzEzNDg2MjMxNTdFKzMwOClcbiAgaWVlZTc1NC53cml0ZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgNTIsIDgpXG4gIHJldHVybiBvZmZzZXQgKyA4XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVMRSA9IGZ1bmN0aW9uICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVCRSA9IGZ1bmN0aW9uICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KVxufVxuXG4vLyBjb3B5KHRhcmdldEJ1ZmZlciwgdGFyZ2V0U3RhcnQ9MCwgc291cmNlU3RhcnQ9MCwgc291cmNlRW5kPWJ1ZmZlci5sZW5ndGgpXG5CdWZmZXIucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAodGFyZ2V0LCB0YXJnZXRfc3RhcnQsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHNvdXJjZSA9IHRoaXNcblxuICBpZiAoIXN0YXJ0KSBzdGFydCA9IDBcbiAgaWYgKCFlbmQgJiYgZW5kICE9PSAwKSBlbmQgPSB0aGlzLmxlbmd0aFxuICBpZiAoIXRhcmdldF9zdGFydCkgdGFyZ2V0X3N0YXJ0ID0gMFxuXG4gIC8vIENvcHkgMCBieXRlczsgd2UncmUgZG9uZVxuICBpZiAoZW5kID09PSBzdGFydCkgcmV0dXJuXG4gIGlmICh0YXJnZXQubGVuZ3RoID09PSAwIHx8IHNvdXJjZS5sZW5ndGggPT09IDApIHJldHVyblxuXG4gIC8vIEZhdGFsIGVycm9yIGNvbmRpdGlvbnNcbiAgaWYgKGVuZCA8IHN0YXJ0KSB0aHJvdyBuZXcgVHlwZUVycm9yKCdzb3VyY2VFbmQgPCBzb3VyY2VTdGFydCcpXG4gIGlmICh0YXJnZXRfc3RhcnQgPCAwIHx8IHRhcmdldF9zdGFydCA+PSB0YXJnZXQubGVuZ3RoKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3RhcmdldFN0YXJ0IG91dCBvZiBib3VuZHMnKVxuICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHNvdXJjZS5sZW5ndGgpIHRocm93IG5ldyBUeXBlRXJyb3IoJ3NvdXJjZVN0YXJ0IG91dCBvZiBib3VuZHMnKVxuICBpZiAoZW5kIDwgMCB8fCBlbmQgPiBzb3VyY2UubGVuZ3RoKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdzb3VyY2VFbmQgb3V0IG9mIGJvdW5kcycpXG5cbiAgLy8gQXJlIHdlIG9vYj9cbiAgaWYgKGVuZCA+IHRoaXMubGVuZ3RoKVxuICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmICh0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0X3N0YXJ0IDwgZW5kIC0gc3RhcnQpXG4gICAgZW5kID0gdGFyZ2V0Lmxlbmd0aCAtIHRhcmdldF9zdGFydCArIHN0YXJ0XG5cbiAgdmFyIGxlbiA9IGVuZCAtIHN0YXJ0XG5cbiAgaWYgKGxlbiA8IDEwMDAgfHwgIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRfc3RhcnRdID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRhcmdldC5fc2V0KHRoaXMuc3ViYXJyYXkoc3RhcnQsIHN0YXJ0ICsgbGVuKSwgdGFyZ2V0X3N0YXJ0KVxuICB9XG59XG5cbi8vIGZpbGwodmFsdWUsIHN0YXJ0PTAsIGVuZD1idWZmZXIubGVuZ3RoKVxuQnVmZmVyLnByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gKHZhbHVlLCBzdGFydCwgZW5kKSB7XG4gIGlmICghdmFsdWUpIHZhbHVlID0gMFxuICBpZiAoIXN0YXJ0KSBzdGFydCA9IDBcbiAgaWYgKCFlbmQpIGVuZCA9IHRoaXMubGVuZ3RoXG5cbiAgaWYgKGVuZCA8IHN0YXJ0KSB0aHJvdyBuZXcgVHlwZUVycm9yKCdlbmQgPCBzdGFydCcpXG5cbiAgLy8gRmlsbCAwIGJ5dGVzOyB3ZSdyZSBkb25lXG4gIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm5cbiAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm5cblxuICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdzdGFydCBvdXQgb2YgYm91bmRzJylcbiAgaWYgKGVuZCA8IDAgfHwgZW5kID4gdGhpcy5sZW5ndGgpIHRocm93IG5ldyBUeXBlRXJyb3IoJ2VuZCBvdXQgb2YgYm91bmRzJylcblxuICB2YXIgaVxuICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgIGZvciAoaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICAgIHRoaXNbaV0gPSB2YWx1ZVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB2YXIgYnl0ZXMgPSB1dGY4VG9CeXRlcyh2YWx1ZS50b1N0cmluZygpKVxuICAgIHZhciBsZW4gPSBieXRlcy5sZW5ndGhcbiAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICB0aGlzW2ldID0gYnl0ZXNbaSAlIGxlbl1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpc1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgYEFycmF5QnVmZmVyYCB3aXRoIHRoZSAqY29waWVkKiBtZW1vcnkgb2YgdGhlIGJ1ZmZlciBpbnN0YW5jZS5cbiAqIEFkZGVkIGluIE5vZGUgMC4xMi4gT25seSBhdmFpbGFibGUgaW4gYnJvd3NlcnMgdGhhdCBzdXBwb3J0IEFycmF5QnVmZmVyLlxuICovXG5CdWZmZXIucHJvdG90eXBlLnRvQXJyYXlCdWZmZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICh0eXBlb2YgVWludDhBcnJheSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAgIHJldHVybiAobmV3IEJ1ZmZlcih0aGlzKSkuYnVmZmVyXG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBidWYgPSBuZXcgVWludDhBcnJheSh0aGlzLmxlbmd0aClcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBidWYubGVuZ3RoOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgICAgYnVmW2ldID0gdGhpc1tpXVxuICAgICAgfVxuICAgICAgcmV0dXJuIGJ1Zi5idWZmZXJcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQnVmZmVyLnRvQXJyYXlCdWZmZXIgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXInKVxuICB9XG59XG5cbi8vIEhFTFBFUiBGVU5DVElPTlNcbi8vID09PT09PT09PT09PT09PT1cblxudmFyIEJQID0gQnVmZmVyLnByb3RvdHlwZVxuXG4vKipcbiAqIEF1Z21lbnQgYSBVaW50OEFycmF5ICppbnN0YW5jZSogKG5vdCB0aGUgVWludDhBcnJheSBjbGFzcyEpIHdpdGggQnVmZmVyIG1ldGhvZHNcbiAqL1xuQnVmZmVyLl9hdWdtZW50ID0gZnVuY3Rpb24gKGFycikge1xuICBhcnIuY29uc3RydWN0b3IgPSBCdWZmZXJcbiAgYXJyLl9pc0J1ZmZlciA9IHRydWVcblxuICAvLyBzYXZlIHJlZmVyZW5jZSB0byBvcmlnaW5hbCBVaW50OEFycmF5IGdldC9zZXQgbWV0aG9kcyBiZWZvcmUgb3ZlcndyaXRpbmdcbiAgYXJyLl9nZXQgPSBhcnIuZ2V0XG4gIGFyci5fc2V0ID0gYXJyLnNldFxuXG4gIC8vIGRlcHJlY2F0ZWQsIHdpbGwgYmUgcmVtb3ZlZCBpbiBub2RlIDAuMTMrXG4gIGFyci5nZXQgPSBCUC5nZXRcbiAgYXJyLnNldCA9IEJQLnNldFxuXG4gIGFyci53cml0ZSA9IEJQLndyaXRlXG4gIGFyci50b1N0cmluZyA9IEJQLnRvU3RyaW5nXG4gIGFyci50b0xvY2FsZVN0cmluZyA9IEJQLnRvU3RyaW5nXG4gIGFyci50b0pTT04gPSBCUC50b0pTT05cbiAgYXJyLmVxdWFscyA9IEJQLmVxdWFsc1xuICBhcnIuY29tcGFyZSA9IEJQLmNvbXBhcmVcbiAgYXJyLmNvcHkgPSBCUC5jb3B5XG4gIGFyci5zbGljZSA9IEJQLnNsaWNlXG4gIGFyci5yZWFkVUludDggPSBCUC5yZWFkVUludDhcbiAgYXJyLnJlYWRVSW50MTZMRSA9IEJQLnJlYWRVSW50MTZMRVxuICBhcnIucmVhZFVJbnQxNkJFID0gQlAucmVhZFVJbnQxNkJFXG4gIGFyci5yZWFkVUludDMyTEUgPSBCUC5yZWFkVUludDMyTEVcbiAgYXJyLnJlYWRVSW50MzJCRSA9IEJQLnJlYWRVSW50MzJCRVxuICBhcnIucmVhZEludDggPSBCUC5yZWFkSW50OFxuICBhcnIucmVhZEludDE2TEUgPSBCUC5yZWFkSW50MTZMRVxuICBhcnIucmVhZEludDE2QkUgPSBCUC5yZWFkSW50MTZCRVxuICBhcnIucmVhZEludDMyTEUgPSBCUC5yZWFkSW50MzJMRVxuICBhcnIucmVhZEludDMyQkUgPSBCUC5yZWFkSW50MzJCRVxuICBhcnIucmVhZEZsb2F0TEUgPSBCUC5yZWFkRmxvYXRMRVxuICBhcnIucmVhZEZsb2F0QkUgPSBCUC5yZWFkRmxvYXRCRVxuICBhcnIucmVhZERvdWJsZUxFID0gQlAucmVhZERvdWJsZUxFXG4gIGFyci5yZWFkRG91YmxlQkUgPSBCUC5yZWFkRG91YmxlQkVcbiAgYXJyLndyaXRlVUludDggPSBCUC53cml0ZVVJbnQ4XG4gIGFyci53cml0ZVVJbnQxNkxFID0gQlAud3JpdGVVSW50MTZMRVxuICBhcnIud3JpdGVVSW50MTZCRSA9IEJQLndyaXRlVUludDE2QkVcbiAgYXJyLndyaXRlVUludDMyTEUgPSBCUC53cml0ZVVJbnQzMkxFXG4gIGFyci53cml0ZVVJbnQzMkJFID0gQlAud3JpdGVVSW50MzJCRVxuICBhcnIud3JpdGVJbnQ4ID0gQlAud3JpdGVJbnQ4XG4gIGFyci53cml0ZUludDE2TEUgPSBCUC53cml0ZUludDE2TEVcbiAgYXJyLndyaXRlSW50MTZCRSA9IEJQLndyaXRlSW50MTZCRVxuICBhcnIud3JpdGVJbnQzMkxFID0gQlAud3JpdGVJbnQzMkxFXG4gIGFyci53cml0ZUludDMyQkUgPSBCUC53cml0ZUludDMyQkVcbiAgYXJyLndyaXRlRmxvYXRMRSA9IEJQLndyaXRlRmxvYXRMRVxuICBhcnIud3JpdGVGbG9hdEJFID0gQlAud3JpdGVGbG9hdEJFXG4gIGFyci53cml0ZURvdWJsZUxFID0gQlAud3JpdGVEb3VibGVMRVxuICBhcnIud3JpdGVEb3VibGVCRSA9IEJQLndyaXRlRG91YmxlQkVcbiAgYXJyLmZpbGwgPSBCUC5maWxsXG4gIGFyci5pbnNwZWN0ID0gQlAuaW5zcGVjdFxuICBhcnIudG9BcnJheUJ1ZmZlciA9IEJQLnRvQXJyYXlCdWZmZXJcblxuICByZXR1cm4gYXJyXG59XG5cbnZhciBJTlZBTElEX0JBU0U2NF9SRSA9IC9bXitcXC8wLTlBLXpdL2dcblxuZnVuY3Rpb24gYmFzZTY0Y2xlYW4gKHN0cikge1xuICAvLyBOb2RlIHN0cmlwcyBvdXQgaW52YWxpZCBjaGFyYWN0ZXJzIGxpa2UgXFxuIGFuZCBcXHQgZnJvbSB0aGUgc3RyaW5nLCBiYXNlNjQtanMgZG9lcyBub3RcbiAgc3RyID0gc3RyaW5ndHJpbShzdHIpLnJlcGxhY2UoSU5WQUxJRF9CQVNFNjRfUkUsICcnKVxuICAvLyBOb2RlIGFsbG93cyBmb3Igbm9uLXBhZGRlZCBiYXNlNjQgc3RyaW5ncyAobWlzc2luZyB0cmFpbGluZyA9PT0pLCBiYXNlNjQtanMgZG9lcyBub3RcbiAgd2hpbGUgKHN0ci5sZW5ndGggJSA0ICE9PSAwKSB7XG4gICAgc3RyID0gc3RyICsgJz0nXG4gIH1cbiAgcmV0dXJuIHN0clxufVxuXG5mdW5jdGlvbiBzdHJpbmd0cmltIChzdHIpIHtcbiAgaWYgKHN0ci50cmltKSByZXR1cm4gc3RyLnRyaW0oKVxuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKVxufVxuXG5mdW5jdGlvbiBpc0FycmF5aXNoIChzdWJqZWN0KSB7XG4gIHJldHVybiBpc0FycmF5KHN1YmplY3QpIHx8IEJ1ZmZlci5pc0J1ZmZlcihzdWJqZWN0KSB8fFxuICAgICAgc3ViamVjdCAmJiB0eXBlb2Ygc3ViamVjdCA9PT0gJ29iamVjdCcgJiZcbiAgICAgIHR5cGVvZiBzdWJqZWN0Lmxlbmd0aCA9PT0gJ251bWJlcidcbn1cblxuZnVuY3Rpb24gdG9IZXggKG4pIHtcbiAgaWYgKG4gPCAxNikgcmV0dXJuICcwJyArIG4udG9TdHJpbmcoMTYpXG4gIHJldHVybiBuLnRvU3RyaW5nKDE2KVxufVxuXG5mdW5jdGlvbiB1dGY4VG9CeXRlcyAoc3RyKSB7XG4gIHZhciBieXRlQXJyYXkgPSBbXVxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgIHZhciBiID0gc3RyLmNoYXJDb2RlQXQoaSlcbiAgICBpZiAoYiA8PSAweDdGKSB7XG4gICAgICBieXRlQXJyYXkucHVzaChiKVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgc3RhcnQgPSBpXG4gICAgICBpZiAoYiA+PSAweEQ4MDAgJiYgYiA8PSAweERGRkYpIGkrK1xuICAgICAgdmFyIGggPSBlbmNvZGVVUklDb21wb25lbnQoc3RyLnNsaWNlKHN0YXJ0LCBpKzEpKS5zdWJzdHIoMSkuc3BsaXQoJyUnKVxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBoLmxlbmd0aDsgaisrKSB7XG4gICAgICAgIGJ5dGVBcnJheS5wdXNoKHBhcnNlSW50KGhbal0sIDE2KSlcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIGJ5dGVBcnJheVxufVxuXG5mdW5jdGlvbiBhc2NpaVRvQnl0ZXMgKHN0cikge1xuICB2YXIgYnl0ZUFycmF5ID0gW11cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAvLyBOb2RlJ3MgY29kZSBzZWVtcyB0byBiZSBkb2luZyB0aGlzIGFuZCBub3QgJiAweDdGLi5cbiAgICBieXRlQXJyYXkucHVzaChzdHIuY2hhckNvZGVBdChpKSAmIDB4RkYpXG4gIH1cbiAgcmV0dXJuIGJ5dGVBcnJheVxufVxuXG5mdW5jdGlvbiB1dGYxNmxlVG9CeXRlcyAoc3RyKSB7XG4gIHZhciBjLCBoaSwgbG9cbiAgdmFyIGJ5dGVBcnJheSA9IFtdXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgYyA9IHN0ci5jaGFyQ29kZUF0KGkpXG4gICAgaGkgPSBjID4+IDhcbiAgICBsbyA9IGMgJSAyNTZcbiAgICBieXRlQXJyYXkucHVzaChsbylcbiAgICBieXRlQXJyYXkucHVzaChoaSlcbiAgfVxuXG4gIHJldHVybiBieXRlQXJyYXlcbn1cblxuZnVuY3Rpb24gYmFzZTY0VG9CeXRlcyAoc3RyKSB7XG4gIHJldHVybiBiYXNlNjQudG9CeXRlQXJyYXkoc3RyKVxufVxuXG5mdW5jdGlvbiBibGl0QnVmZmVyIChzcmMsIGRzdCwgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGlmICgoaSArIG9mZnNldCA+PSBkc3QubGVuZ3RoKSB8fCAoaSA+PSBzcmMubGVuZ3RoKSlcbiAgICAgIGJyZWFrXG4gICAgZHN0W2kgKyBvZmZzZXRdID0gc3JjW2ldXG4gIH1cbiAgcmV0dXJuIGlcbn1cblxuZnVuY3Rpb24gZGVjb2RlVXRmOENoYXIgKHN0cikge1xuICB0cnkge1xuICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoc3RyKVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSgweEZGRkQpIC8vIFVURiA4IGludmFsaWQgY2hhclxuICB9XG59XG4iLCJ2YXIgbG9va3VwID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nO1xuXG47KGZ1bmN0aW9uIChleHBvcnRzKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuICB2YXIgQXJyID0gKHR5cGVvZiBVaW50OEFycmF5ICE9PSAndW5kZWZpbmVkJylcbiAgICA/IFVpbnQ4QXJyYXlcbiAgICA6IEFycmF5XG5cblx0dmFyIFBMVVMgICA9ICcrJy5jaGFyQ29kZUF0KDApXG5cdHZhciBTTEFTSCAgPSAnLycuY2hhckNvZGVBdCgwKVxuXHR2YXIgTlVNQkVSID0gJzAnLmNoYXJDb2RlQXQoMClcblx0dmFyIExPV0VSICA9ICdhJy5jaGFyQ29kZUF0KDApXG5cdHZhciBVUFBFUiAgPSAnQScuY2hhckNvZGVBdCgwKVxuXG5cdGZ1bmN0aW9uIGRlY29kZSAoZWx0KSB7XG5cdFx0dmFyIGNvZGUgPSBlbHQuY2hhckNvZGVBdCgwKVxuXHRcdGlmIChjb2RlID09PSBQTFVTKVxuXHRcdFx0cmV0dXJuIDYyIC8vICcrJ1xuXHRcdGlmIChjb2RlID09PSBTTEFTSClcblx0XHRcdHJldHVybiA2MyAvLyAnLydcblx0XHRpZiAoY29kZSA8IE5VTUJFUilcblx0XHRcdHJldHVybiAtMSAvL25vIG1hdGNoXG5cdFx0aWYgKGNvZGUgPCBOVU1CRVIgKyAxMClcblx0XHRcdHJldHVybiBjb2RlIC0gTlVNQkVSICsgMjYgKyAyNlxuXHRcdGlmIChjb2RlIDwgVVBQRVIgKyAyNilcblx0XHRcdHJldHVybiBjb2RlIC0gVVBQRVJcblx0XHRpZiAoY29kZSA8IExPV0VSICsgMjYpXG5cdFx0XHRyZXR1cm4gY29kZSAtIExPV0VSICsgMjZcblx0fVxuXG5cdGZ1bmN0aW9uIGI2NFRvQnl0ZUFycmF5IChiNjQpIHtcblx0XHR2YXIgaSwgaiwgbCwgdG1wLCBwbGFjZUhvbGRlcnMsIGFyclxuXG5cdFx0aWYgKGI2NC5sZW5ndGggJSA0ID4gMCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHN0cmluZy4gTGVuZ3RoIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA0Jylcblx0XHR9XG5cblx0XHQvLyB0aGUgbnVtYmVyIG9mIGVxdWFsIHNpZ25zIChwbGFjZSBob2xkZXJzKVxuXHRcdC8vIGlmIHRoZXJlIGFyZSB0d28gcGxhY2Vob2xkZXJzLCB0aGFuIHRoZSB0d28gY2hhcmFjdGVycyBiZWZvcmUgaXRcblx0XHQvLyByZXByZXNlbnQgb25lIGJ5dGVcblx0XHQvLyBpZiB0aGVyZSBpcyBvbmx5IG9uZSwgdGhlbiB0aGUgdGhyZWUgY2hhcmFjdGVycyBiZWZvcmUgaXQgcmVwcmVzZW50IDIgYnl0ZXNcblx0XHQvLyB0aGlzIGlzIGp1c3QgYSBjaGVhcCBoYWNrIHRvIG5vdCBkbyBpbmRleE9mIHR3aWNlXG5cdFx0dmFyIGxlbiA9IGI2NC5sZW5ndGhcblx0XHRwbGFjZUhvbGRlcnMgPSAnPScgPT09IGI2NC5jaGFyQXQobGVuIC0gMikgPyAyIDogJz0nID09PSBiNjQuY2hhckF0KGxlbiAtIDEpID8gMSA6IDBcblxuXHRcdC8vIGJhc2U2NCBpcyA0LzMgKyB1cCB0byB0d28gY2hhcmFjdGVycyBvZiB0aGUgb3JpZ2luYWwgZGF0YVxuXHRcdGFyciA9IG5ldyBBcnIoYjY0Lmxlbmd0aCAqIDMgLyA0IC0gcGxhY2VIb2xkZXJzKVxuXG5cdFx0Ly8gaWYgdGhlcmUgYXJlIHBsYWNlaG9sZGVycywgb25seSBnZXQgdXAgdG8gdGhlIGxhc3QgY29tcGxldGUgNCBjaGFyc1xuXHRcdGwgPSBwbGFjZUhvbGRlcnMgPiAwID8gYjY0Lmxlbmd0aCAtIDQgOiBiNjQubGVuZ3RoXG5cblx0XHR2YXIgTCA9IDBcblxuXHRcdGZ1bmN0aW9uIHB1c2ggKHYpIHtcblx0XHRcdGFycltMKytdID0gdlxuXHRcdH1cblxuXHRcdGZvciAoaSA9IDAsIGogPSAwOyBpIDwgbDsgaSArPSA0LCBqICs9IDMpIHtcblx0XHRcdHRtcCA9IChkZWNvZGUoYjY0LmNoYXJBdChpKSkgPDwgMTgpIHwgKGRlY29kZShiNjQuY2hhckF0KGkgKyAxKSkgPDwgMTIpIHwgKGRlY29kZShiNjQuY2hhckF0KGkgKyAyKSkgPDwgNikgfCBkZWNvZGUoYjY0LmNoYXJBdChpICsgMykpXG5cdFx0XHRwdXNoKCh0bXAgJiAweEZGMDAwMCkgPj4gMTYpXG5cdFx0XHRwdXNoKCh0bXAgJiAweEZGMDApID4+IDgpXG5cdFx0XHRwdXNoKHRtcCAmIDB4RkYpXG5cdFx0fVxuXG5cdFx0aWYgKHBsYWNlSG9sZGVycyA9PT0gMikge1xuXHRcdFx0dG1wID0gKGRlY29kZShiNjQuY2hhckF0KGkpKSA8PCAyKSB8IChkZWNvZGUoYjY0LmNoYXJBdChpICsgMSkpID4+IDQpXG5cdFx0XHRwdXNoKHRtcCAmIDB4RkYpXG5cdFx0fSBlbHNlIGlmIChwbGFjZUhvbGRlcnMgPT09IDEpIHtcblx0XHRcdHRtcCA9IChkZWNvZGUoYjY0LmNoYXJBdChpKSkgPDwgMTApIHwgKGRlY29kZShiNjQuY2hhckF0KGkgKyAxKSkgPDwgNCkgfCAoZGVjb2RlKGI2NC5jaGFyQXQoaSArIDIpKSA+PiAyKVxuXHRcdFx0cHVzaCgodG1wID4+IDgpICYgMHhGRilcblx0XHRcdHB1c2godG1wICYgMHhGRilcblx0XHR9XG5cblx0XHRyZXR1cm4gYXJyXG5cdH1cblxuXHRmdW5jdGlvbiB1aW50OFRvQmFzZTY0ICh1aW50OCkge1xuXHRcdHZhciBpLFxuXHRcdFx0ZXh0cmFCeXRlcyA9IHVpbnQ4Lmxlbmd0aCAlIDMsIC8vIGlmIHdlIGhhdmUgMSBieXRlIGxlZnQsIHBhZCAyIGJ5dGVzXG5cdFx0XHRvdXRwdXQgPSBcIlwiLFxuXHRcdFx0dGVtcCwgbGVuZ3RoXG5cblx0XHRmdW5jdGlvbiBlbmNvZGUgKG51bSkge1xuXHRcdFx0cmV0dXJuIGxvb2t1cC5jaGFyQXQobnVtKVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHRyaXBsZXRUb0Jhc2U2NCAobnVtKSB7XG5cdFx0XHRyZXR1cm4gZW5jb2RlKG51bSA+PiAxOCAmIDB4M0YpICsgZW5jb2RlKG51bSA+PiAxMiAmIDB4M0YpICsgZW5jb2RlKG51bSA+PiA2ICYgMHgzRikgKyBlbmNvZGUobnVtICYgMHgzRilcblx0XHR9XG5cblx0XHQvLyBnbyB0aHJvdWdoIHRoZSBhcnJheSBldmVyeSB0aHJlZSBieXRlcywgd2UnbGwgZGVhbCB3aXRoIHRyYWlsaW5nIHN0dWZmIGxhdGVyXG5cdFx0Zm9yIChpID0gMCwgbGVuZ3RoID0gdWludDgubGVuZ3RoIC0gZXh0cmFCeXRlczsgaSA8IGxlbmd0aDsgaSArPSAzKSB7XG5cdFx0XHR0ZW1wID0gKHVpbnQ4W2ldIDw8IDE2KSArICh1aW50OFtpICsgMV0gPDwgOCkgKyAodWludDhbaSArIDJdKVxuXHRcdFx0b3V0cHV0ICs9IHRyaXBsZXRUb0Jhc2U2NCh0ZW1wKVxuXHRcdH1cblxuXHRcdC8vIHBhZCB0aGUgZW5kIHdpdGggemVyb3MsIGJ1dCBtYWtlIHN1cmUgdG8gbm90IGZvcmdldCB0aGUgZXh0cmEgYnl0ZXNcblx0XHRzd2l0Y2ggKGV4dHJhQnl0ZXMpIHtcblx0XHRcdGNhc2UgMTpcblx0XHRcdFx0dGVtcCA9IHVpbnQ4W3VpbnQ4Lmxlbmd0aCAtIDFdXG5cdFx0XHRcdG91dHB1dCArPSBlbmNvZGUodGVtcCA+PiAyKVxuXHRcdFx0XHRvdXRwdXQgKz0gZW5jb2RlKCh0ZW1wIDw8IDQpICYgMHgzRilcblx0XHRcdFx0b3V0cHV0ICs9ICc9PSdcblx0XHRcdFx0YnJlYWtcblx0XHRcdGNhc2UgMjpcblx0XHRcdFx0dGVtcCA9ICh1aW50OFt1aW50OC5sZW5ndGggLSAyXSA8PCA4KSArICh1aW50OFt1aW50OC5sZW5ndGggLSAxXSlcblx0XHRcdFx0b3V0cHV0ICs9IGVuY29kZSh0ZW1wID4+IDEwKVxuXHRcdFx0XHRvdXRwdXQgKz0gZW5jb2RlKCh0ZW1wID4+IDQpICYgMHgzRilcblx0XHRcdFx0b3V0cHV0ICs9IGVuY29kZSgodGVtcCA8PCAyKSAmIDB4M0YpXG5cdFx0XHRcdG91dHB1dCArPSAnPSdcblx0XHRcdFx0YnJlYWtcblx0XHR9XG5cblx0XHRyZXR1cm4gb3V0cHV0XG5cdH1cblxuXHRleHBvcnRzLnRvQnl0ZUFycmF5ID0gYjY0VG9CeXRlQXJyYXlcblx0ZXhwb3J0cy5mcm9tQnl0ZUFycmF5ID0gdWludDhUb0Jhc2U2NFxufSh0eXBlb2YgZXhwb3J0cyA9PT0gJ3VuZGVmaW5lZCcgPyAodGhpcy5iYXNlNjRqcyA9IHt9KSA6IGV4cG9ydHMpKVxuIiwiZXhwb3J0cy5yZWFkID0gZnVuY3Rpb24oYnVmZmVyLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykge1xuICB2YXIgZSwgbSxcbiAgICAgIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDEsXG4gICAgICBlTWF4ID0gKDEgPDwgZUxlbikgLSAxLFxuICAgICAgZUJpYXMgPSBlTWF4ID4+IDEsXG4gICAgICBuQml0cyA9IC03LFxuICAgICAgaSA9IGlzTEUgPyAobkJ5dGVzIC0gMSkgOiAwLFxuICAgICAgZCA9IGlzTEUgPyAtMSA6IDEsXG4gICAgICBzID0gYnVmZmVyW29mZnNldCArIGldO1xuXG4gIGkgKz0gZDtcblxuICBlID0gcyAmICgoMSA8PCAoLW5CaXRzKSkgLSAxKTtcbiAgcyA+Pj0gKC1uQml0cyk7XG4gIG5CaXRzICs9IGVMZW47XG4gIGZvciAoOyBuQml0cyA+IDA7IGUgPSBlICogMjU2ICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpO1xuXG4gIG0gPSBlICYgKCgxIDw8ICgtbkJpdHMpKSAtIDEpO1xuICBlID4+PSAoLW5CaXRzKTtcbiAgbkJpdHMgKz0gbUxlbjtcbiAgZm9yICg7IG5CaXRzID4gMDsgbSA9IG0gKiAyNTYgKyBidWZmZXJbb2Zmc2V0ICsgaV0sIGkgKz0gZCwgbkJpdHMgLT0gOCk7XG5cbiAgaWYgKGUgPT09IDApIHtcbiAgICBlID0gMSAtIGVCaWFzO1xuICB9IGVsc2UgaWYgKGUgPT09IGVNYXgpIHtcbiAgICByZXR1cm4gbSA/IE5hTiA6ICgocyA/IC0xIDogMSkgKiBJbmZpbml0eSk7XG4gIH0gZWxzZSB7XG4gICAgbSA9IG0gKyBNYXRoLnBvdygyLCBtTGVuKTtcbiAgICBlID0gZSAtIGVCaWFzO1xuICB9XG4gIHJldHVybiAocyA/IC0xIDogMSkgKiBtICogTWF0aC5wb3coMiwgZSAtIG1MZW4pO1xufTtcblxuZXhwb3J0cy53cml0ZSA9IGZ1bmN0aW9uKGJ1ZmZlciwgdmFsdWUsIG9mZnNldCwgaXNMRSwgbUxlbiwgbkJ5dGVzKSB7XG4gIHZhciBlLCBtLCBjLFxuICAgICAgZUxlbiA9IG5CeXRlcyAqIDggLSBtTGVuIC0gMSxcbiAgICAgIGVNYXggPSAoMSA8PCBlTGVuKSAtIDEsXG4gICAgICBlQmlhcyA9IGVNYXggPj4gMSxcbiAgICAgIHJ0ID0gKG1MZW4gPT09IDIzID8gTWF0aC5wb3coMiwgLTI0KSAtIE1hdGgucG93KDIsIC03NykgOiAwKSxcbiAgICAgIGkgPSBpc0xFID8gMCA6IChuQnl0ZXMgLSAxKSxcbiAgICAgIGQgPSBpc0xFID8gMSA6IC0xLFxuICAgICAgcyA9IHZhbHVlIDwgMCB8fCAodmFsdWUgPT09IDAgJiYgMSAvIHZhbHVlIDwgMCkgPyAxIDogMDtcblxuICB2YWx1ZSA9IE1hdGguYWJzKHZhbHVlKTtcblxuICBpZiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlID09PSBJbmZpbml0eSkge1xuICAgIG0gPSBpc05hTih2YWx1ZSkgPyAxIDogMDtcbiAgICBlID0gZU1heDtcbiAgfSBlbHNlIHtcbiAgICBlID0gTWF0aC5mbG9vcihNYXRoLmxvZyh2YWx1ZSkgLyBNYXRoLkxOMik7XG4gICAgaWYgKHZhbHVlICogKGMgPSBNYXRoLnBvdygyLCAtZSkpIDwgMSkge1xuICAgICAgZS0tO1xuICAgICAgYyAqPSAyO1xuICAgIH1cbiAgICBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIHZhbHVlICs9IHJ0IC8gYztcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWUgKz0gcnQgKiBNYXRoLnBvdygyLCAxIC0gZUJpYXMpO1xuICAgIH1cbiAgICBpZiAodmFsdWUgKiBjID49IDIpIHtcbiAgICAgIGUrKztcbiAgICAgIGMgLz0gMjtcbiAgICB9XG5cbiAgICBpZiAoZSArIGVCaWFzID49IGVNYXgpIHtcbiAgICAgIG0gPSAwO1xuICAgICAgZSA9IGVNYXg7XG4gICAgfSBlbHNlIGlmIChlICsgZUJpYXMgPj0gMSkge1xuICAgICAgbSA9ICh2YWx1ZSAqIGMgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pO1xuICAgICAgZSA9IGUgKyBlQmlhcztcbiAgICB9IGVsc2Uge1xuICAgICAgbSA9IHZhbHVlICogTWF0aC5wb3coMiwgZUJpYXMgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pO1xuICAgICAgZSA9IDA7XG4gICAgfVxuICB9XG5cbiAgZm9yICg7IG1MZW4gPj0gODsgYnVmZmVyW29mZnNldCArIGldID0gbSAmIDB4ZmYsIGkgKz0gZCwgbSAvPSAyNTYsIG1MZW4gLT0gOCk7XG5cbiAgZSA9IChlIDw8IG1MZW4pIHwgbTtcbiAgZUxlbiArPSBtTGVuO1xuICBmb3IgKDsgZUxlbiA+IDA7IGJ1ZmZlcltvZmZzZXQgKyBpXSA9IGUgJiAweGZmLCBpICs9IGQsIGUgLz0gMjU2LCBlTGVuIC09IDgpO1xuXG4gIGJ1ZmZlcltvZmZzZXQgKyBpIC0gZF0gfD0gcyAqIDEyODtcbn07XG4iLCJcbi8qKlxuICogaXNBcnJheVxuICovXG5cbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcblxuLyoqXG4gKiB0b1N0cmluZ1xuICovXG5cbnZhciBzdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG4vKipcbiAqIFdoZXRoZXIgb3Igbm90IHRoZSBnaXZlbiBgdmFsYFxuICogaXMgYW4gYXJyYXkuXG4gKlxuICogZXhhbXBsZTpcbiAqXG4gKiAgICAgICAgaXNBcnJheShbXSk7XG4gKiAgICAgICAgLy8gPiB0cnVlXG4gKiAgICAgICAgaXNBcnJheShhcmd1bWVudHMpO1xuICogICAgICAgIC8vID4gZmFsc2VcbiAqICAgICAgICBpc0FycmF5KCcnKTtcbiAqICAgICAgICAvLyA+IGZhbHNlXG4gKlxuICogQHBhcmFtIHttaXhlZH0gdmFsXG4gKiBAcmV0dXJuIHtib29sfVxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gaXNBcnJheSB8fCBmdW5jdGlvbiAodmFsKSB7XG4gIHJldHVybiAhISB2YWwgJiYgJ1tvYmplY3QgQXJyYXldJyA9PSBzdHIuY2FsbCh2YWwpO1xufTtcbiIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxuXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbnByb2Nlc3MubmV4dFRpY2sgPSAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBjYW5TZXRJbW1lZGlhdGUgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuICAgICYmIHdpbmRvdy5zZXRJbW1lZGlhdGU7XG4gICAgdmFyIGNhbk11dGF0aW9uT2JzZXJ2ZXIgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuICAgICYmIHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyO1xuICAgIHZhciBjYW5Qb3N0ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgICAmJiB3aW5kb3cucG9zdE1lc3NhZ2UgJiYgd2luZG93LmFkZEV2ZW50TGlzdGVuZXJcbiAgICA7XG5cbiAgICBpZiAoY2FuU2V0SW1tZWRpYXRlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gd2luZG93LnNldEltbWVkaWF0ZShmKSB9O1xuICAgIH1cblxuICAgIHZhciBxdWV1ZSA9IFtdO1xuXG4gICAgaWYgKGNhbk11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgICAgdmFyIGhpZGRlbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHZhciBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBxdWV1ZUxpc3QgPSBxdWV1ZS5zbGljZSgpO1xuICAgICAgICAgICAgcXVldWUubGVuZ3RoID0gMDtcbiAgICAgICAgICAgIHF1ZXVlTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChmbikge1xuICAgICAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShoaWRkZW5EaXYsIHsgYXR0cmlidXRlczogdHJ1ZSB9KTtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gbmV4dFRpY2soZm4pIHtcbiAgICAgICAgICAgIGlmICghcXVldWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaGlkZGVuRGl2LnNldEF0dHJpYnV0ZSgneWVzJywgJ25vJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBxdWV1ZS5wdXNoKGZuKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoY2FuUG9zdCkge1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChldikge1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGV2LnNvdXJjZTtcbiAgICAgICAgICAgIGlmICgoc291cmNlID09PSB3aW5kb3cgfHwgc291cmNlID09PSBudWxsKSAmJiBldi5kYXRhID09PSAncHJvY2Vzcy10aWNrJykge1xuICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmIChxdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmbiA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCB0cnVlKTtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gbmV4dFRpY2soZm4pIHtcbiAgICAgICAgICAgIHF1ZXVlLnB1c2goZm4pO1xuICAgICAgICAgICAgd2luZG93LnBvc3RNZXNzYWdlKCdwcm9jZXNzLXRpY2snLCAnKicpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiBmdW5jdGlvbiBuZXh0VGljayhmbikge1xuICAgICAgICBzZXRUaW1lb3V0KGZuLCAwKTtcbiAgICB9O1xufSkoKTtcblxucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG4vLyBUT0RPKHNodHlsbWFuKVxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG4iLCIoZnVuY3Rpb24gKGdsb2JhbCl7XG52YXIgRG9tID0gcmVxdWlyZSgnLi9kb20nKTtcbnZhciBEZXZpY2UgPSByZXF1aXJlKCcuL2RldmljZScpO1xuXG4ndXNlIHN0cmljdCc7XG5cblxudmFyIHcgPSB0eXBlb2Yod2luZG93KSAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiBnbG9iYWwsXG4gICAgYWRkRXZlbnQgPSBEb20uYWRkRXZlbnQsXG4gICAgcmVtb3ZlRXZlbnQgPSBEb20ucmVtb3ZlRXZlbnQsXG4gICAgQXVkaW9Db250ZXh0ID0gKFxuICAgIHcuQXVkaW9Db250ZXh0IHx8XG4gICAgdy53ZWJraXRBdWRpb0NvbnRleHQgfHxcbiAgICB3Lm1vekF1ZGlvQ29udGV4dCB8fFxuICAgIHcub0F1ZGlvQ29udGV4dCB8fFxuICAgIHcubXNBdWRpb0NvbnRleHRcbiAgICApLFxuICAgIGF1ZGlvQ29udGV4dCA9IG51bGw7XG5cbmlmICh0eXBlb2YoQXVkaW9Db250ZXh0KSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBhdWRpb0NvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XG4gICAgdmFyIEF1ZGlvQ29udGV4dFByb3RvdHlwZSA9IEF1ZGlvQ29udGV4dC5wcm90b3R5cGU7XG5cbiAgICBBdWRpb0NvbnRleHRQcm90b3R5cGUuVU5MT0NLRUQgPSAhRGV2aWNlLm1vYmlsZTtcbiAgICBBdWRpb0NvbnRleHRQcm90b3R5cGUuY3JlYXRlR2FpbiB8fCAoQXVkaW9Db250ZXh0UHJvdG90eXBlLmNyZWF0ZUdhaW4gPSBBdWRpb0NvbnRleHRQcm90b3R5cGUuY3JlYXRlR2Fpbk5vZGUpO1xuICAgIEF1ZGlvQ29udGV4dFByb3RvdHlwZS5jcmVhdGVQYW5uZXIgfHwgKEF1ZGlvQ29udGV4dFByb3RvdHlwZS5jcmVhdGVQYW5uZXIgPSBBdWRpb0NvbnRleHRQcm90b3R5cGUuY3JlYXRlUGFubmVyTm9kZSk7XG4gICAgQXVkaW9Db250ZXh0UHJvdG90eXBlLmNyZWF0ZURlbGF5IHx8IChBdWRpb0NvbnRleHRQcm90b3R5cGUuY3JlYXRlRGVsYXkgPSBBdWRpb0NvbnRleHRQcm90b3R5cGUuY3JlYXRlRGVsYXlOb2RlKTtcbiAgICBBdWRpb0NvbnRleHRQcm90b3R5cGUuY3JlYXRlU2NyaXB0UHJvY2Vzc29yIHx8IChBdWRpb0NvbnRleHRQcm90b3R5cGUuY3JlYXRlU2NyaXB0UHJvY2Vzc29yID0gQXVkaW9Db250ZXh0UHJvdG90eXBlLmNyZWF0ZUphdmFTY3JpcHROb2RlKTtcblxuICAgIHZhciBPc2NpbGxhdG9yUHJvdG90eXBlID0gYXVkaW9Db250ZXh0LmNyZWF0ZU9zY2lsbGF0b3IoKS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsXG4gICAgICAgIEJ1ZmZlclNvdXJjZU5vZGVQcm90b3R5cGUgPSBhdWRpb0NvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCkuY29uc3RydWN0b3IucHJvdG90eXBlLFxuICAgICAgICBHYWluUHJvdG90eXBlID0gYXVkaW9Db250ZXh0LmNyZWF0ZUdhaW4oKS5nYWluLmNvbnN0cnVjdG9yLnByb3RvdHlwZTtcblxuICAgIE9zY2lsbGF0b3JQcm90b3R5cGUuc3RhcnQgfHwgKE9zY2lsbGF0b3JQcm90b3R5cGUuc3RhcnQgPSBPc2NpbGxhdG9yUHJvdG90eXBlLm5vdGVPbik7XG4gICAgT3NjaWxsYXRvclByb3RvdHlwZS5zdG9wIHx8IChPc2NpbGxhdG9yUHJvdG90eXBlLnN0b3AgPSBPc2NpbGxhdG9yUHJvdG90eXBlLnN0b3ApO1xuICAgIE9zY2lsbGF0b3JQcm90b3R5cGUuc2V0UGVyaW9kaWNXYXZlIHx8IChPc2NpbGxhdG9yUHJvdG90eXBlLnNldFBlcmlvZGljV2F2ZSA9IE9zY2lsbGF0b3JQcm90b3R5cGUuc2V0V2F2ZVRhYmxlKTtcblxuICAgIEJ1ZmZlclNvdXJjZU5vZGVQcm90b3R5cGUuc3RhcnQgfHwgKEJ1ZmZlclNvdXJjZU5vZGVQcm90b3R5cGUuc3RhcnQgPSBCdWZmZXJTb3VyY2VOb2RlUHJvdG90eXBlLm5vdGVPbik7XG4gICAgQnVmZmVyU291cmNlTm9kZVByb3RvdHlwZS5zdG9wIHx8IChCdWZmZXJTb3VyY2VOb2RlUHJvdG90eXBlLnN0b3AgPSBCdWZmZXJTb3VyY2VOb2RlUHJvdG90eXBlLnN0b3ApO1xuXG4gICAgR2FpblByb3RvdHlwZS5zZXRUYXJnZXRBdFRpbWUgfHwgKEdhaW5Qcm90b3R5cGUuc2V0VGFyZ2V0QXRUaW1lID0gR2FpblByb3RvdHlwZS5zZXRUYXJnZXRWYWx1ZUF0VGltZSk7XG5cbiAgICB2YXIgb25Ub3VjaFN0YXJ0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBvblRvdWNoU3RhcnQsIGZhbHNlKTtcbiAgICAgICAgdmFyIGJ1ZmZlciA9IGF1ZGlvQ29udGV4dC5jcmVhdGVCdWZmZXIoMSwgMSwgMjIwNTApLFxuICAgICAgICAgICAgc291cmNlID0gYXVkaW9Db250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuXG4gICAgICAgIHNvdXJjZS5idWZmZXIgPSBidWZmZXI7XG4gICAgICAgIHNvdXJjZS5jb25uZWN0KGF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgIHNvdXJjZS5zdGFydCgwKTtcblxuICAgICAgICBhdWRpb0NvbnRleHQuVU5MT0NLRUQgPSB0cnVlO1xuICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2F1ZGlvY29udGV4dHVubG9jaycpKTtcbiAgICB9O1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0Jywgb25Ub3VjaFN0YXJ0LCBmYWxzZSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYXVkaW9Db250ZXh0ICE9IHVuZGVmaW5lZCA/IGF1ZGlvQ29udGV4dCA6IGZhbHNlO1xuXG59KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB7fSkiLCJ2YXIgRXZlbnRFbWl0dGVyID0gcmVxdWlyZSgnLi9ldmVudF9lbWl0dGVyJyk7XG4ndXNlIHN0cmljdCc7XG5cblxudmFyIENMQVNTX0lEID0gMDtcblxuLyoqXG4gKiBAY2xhc3MgWGlhbi5DbGFzc1xuICogQGV4dGVuZHMgWGlhbi5FdmVudEVtaXR0ZXJcbiAqL1xuZnVuY3Rpb24gQ2xhc3MoKSB7XG5cbiAgICBFdmVudEVtaXR0ZXIuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMuX2lkID0gKytDTEFTU19JRDtcbiAgICB0aGlzLl9qc29uSWQgPSAtMTtcbiAgICB0aGlzLl9uYW1lID0gJyc7XG59XG5cbkV2ZW50RW1pdHRlci5leHRlbmQoQ2xhc3MpO1xuXG5cbi8qKlxuICogcmV0dXJucyBuZXcgY29weSBvZiB0aGlzXG4gKiBAbWVtYmVyb2YgWGlhbi5DbGFzc1xuICogQHJldHVybiBDbGFzc1xuICovXG5DbGFzcy5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoKS5jb3B5KHRoaXMpO1xufTtcblxuLyoqXG4gKiBjb3BpZXMgb3RoZXIgb2Ygc2FtZSBjbGFzc1xuICogQG1lbWJlcm9mIFhpYW4uQ2xhc3NcbiAqIEBwYXJhbSB7WGlhbi5DbGFzc30gb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5DbGFzcy5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBjbGVhcnMgZGF0YSBmb3IgR0NcbiAqIEBtZW1iZXJvZiBYaWFuLkNsYXNzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQ2xhc3MucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIGNvbnZlcnRzIHRoaXMgdG8gYSBKU09OIG9iamVjdFxuICogQG1lbWJlcm9mIFhpYW4uQ2xhc3NcbiAqIEByZXR1cm4ganNvblxuICovXG5DbGFzcy5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0ge30pO1xuXG4gICAganNvbi5faWQgPSB0aGlzLl9pZDtcbiAgICBqc29uLl9qc29uSWQgPSB0aGlzLl9pZDtcbiAgICBqc29uLl9jbGFzc05hbWUgPSB0aGlzLl9jbGFzc05hbWU7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cbi8qKlxuICogc2V0cyB0aGlzIGZyb20gSlNPTiBvYmplY3RcbiAqIEBtZW1iZXJvZiBYaWFuLkNsYXNzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQ2xhc3MucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcblxuICAgIHRoaXMuX2pzb25JZCA9IGpzb24uX2pzb25JZDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiByZXR1cm5zIGNsYXNzIG5hbWVcbiAqIEBtZW1iZXJvZiBYaWFuLkNsYXNzXG4gKiBAcmV0dXJuIHN0cmluZ1xuICovXG5DbGFzcy5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gdGhpcy5fbmFtZTtcbn07XG5cbi8qKlxuICogQG1lbWJlcm9mIFhpYW4uQ2xhc3NcbiAqIEBwYXJhbSB7Y29uc3RydWN0b3J9IGNoaWxkXG4gKiBAcGFyYW0ge2NvbnN0cnVjdG9yfSBwYXJlbnRcbiAqIEByZXR1cm4gY2hpbGRcbiAqL1xuQ2xhc3MuZXh0ZW5kID0gZnVuY3Rpb24gKGNoaWxkLCBwYXJlbnQpIHtcbiAgICBpZiAoIXBhcmVudCkgcGFyZW50ID0gdGhpcztcblxuICAgIGNoaWxkLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSk7XG4gICAgY2hpbGQucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gY2hpbGQ7XG5cbiAgICBjaGlsZC5leHRlbmQgPSBwYXJlbnQuZXh0ZW5kO1xuICAgIGNoaWxkLnByb3RvdHlwZS5fY2xhc3NOYW1lID0gY2hpbGQuX2NsYXNzTmFtZSA9IGNoaWxkLm5hbWU7XG5cbiAgICAodGhpcy5fY2hpbGRyZW4gfHwgKHRoaXMuX2NoaWxkcmVuID0ge30pKVtjaGlsZC5uYW1lXSA9IGNoaWxkO1xuICAgIGNoaWxkLl9wYXJlbnQgPSB0aGlzO1xuXG4gICAgQ2xhc3MuX2NsYXNzZXNbY2hpbGQubmFtZV0gPSBjaGlsZDtcblxuICAgIGlmIChwYXJlbnQub25FeHRlbmQpIHtcbiAgICAgICAgaWYgKCFjaGlsZC5vbkV4dGVuZCkgY2hpbGQub25FeHRlbmQgPSBwYXJlbnQub25FeHRlbmQ7XG4gICAgICAgIHBhcmVudC5vbkV4dGVuZChjaGlsZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNoaWxkO1xufTtcblxuLyoqXG4gKiBjcmVhdGVzIG5ldyBYaWFuLkNsYXNzIGZyb20ganNvbiBvYmplY3RcbiAqIEBtZW1iZXJvZiBYaWFuLkNsYXNzXG4gKiBAcGFyYW0ge29iamVjdH0ganNvblxuICogQHJldHVybiBYaWFuLkNsYXNzXG4gKi9cbkNsYXNzLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcblxuICAgIHJldHVybiBuZXcgQ2xhc3MuX2NsYXNzZXNbanNvbi5fY2xhc3NOYW1lXSgpLmZyb21KU09OKGpzb24pO1xufTtcblxuLyoqXG4gKiBjcmVhdGVzIG5ldyBYaWFuLkNsYXNzIGZyb20gc3RyaW5nIHR5cGVcbiAqIEBtZW1iZXJvZiBYaWFuLkNsYXNzXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICogQHJldHVybiBYaWFuLkNsYXNzXG4gKi9cbkNsYXNzLmNyZWF0ZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG5cbiAgICByZXR1cm4gbmV3IENsYXNzLl9jbGFzc2VzW3R5cGVdO1xufTtcblxuXG5DbGFzcy5fY2xhc3NlcyA9IHt9O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gQ2xhc3M7XG4iLCIndXNlIHN0cmljdCc7XG5cblxudmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcblxuXG5mdW5jdGlvbiBDb25maWcoKSB7XG5cbiAgICB0aGlzLmRlYnVnID0gZmFsc2U7XG5cbiAgICB0aGlzLmhvc3QgPSAnMTI3LjAuMC4xJztcbiAgICB0aGlzLnBvcnQgPSAzMDAwO1xuXG4gICAgdGhpcy5GQUtFX0xBRyA9IDA7XG4gICAgdGhpcy5TQ0VORV9TWU5DX1JBVEUgPSAwLjU7XG5cbiAgICB0aGlzLk1BWF9TQ0VORV9TVEFURVMgPSA1O1xuXG4gICAgdGhpcy5NSU5fREVMVEEgPSAwLjAwMDAwMTtcbiAgICB0aGlzLk1BWF9ERUxUQSA9IDAuMjU7XG59XG5cblxuQ29uZmlnLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG5cbiAgICBmb3IgKHZhciBrZXkgaW4ganNvbikge1xuICAgICAgICBpZiAodGhpc1trZXldICE9IHVuZGVmaW5lZCkgdGhpc1trZXldID0ganNvbltrZXldO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5Db25maWcucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiB8fCAoanNvbiA9IHt9KTtcblxuICAgIGZvciAodmFyIGtleSBpbiB0aGlzKSB7XG4gICAgICAgIGlmICh0aGlzW2tleV0gIT0gdW5kZWZpbmVkICYmIGhhc093blByb3BlcnR5LmNhbGwodGhpcywga2V5KSkganNvbltrZXldID0gdGhpc1trZXldO1xuICAgIH1cblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBDb25maWc7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBEZXZpY2UoKSB7XG4gICAgdmFyIHVzZXJBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgYXVkaW8gPSBuZXcgQXVkaW8sXG4gICAgICAgIHZpZGVvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInZpZGVvXCIpO1xuXG4gICAgdGhpcy51c2VyQWdlbnQgPSB1c2VyQWdlbnQ7XG5cbiAgICB0aGlzLnBpeGVsUmF0aW8gPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxO1xuICAgIHRoaXMuaW52UGl4ZWxSYXRpbyA9IDEgLyB0aGlzLnBpeGVsUmF0aW87XG5cbiAgICB0aGlzLmJyb3dzZXIgPSB1c2VyQWdlbnQubWF0Y2goLyhvcGVyYXxjaHJvbWV8c2FmYXJpfGZpcmVmb3h8bXNpZSlcXC8/XFxzKihcXC4/XFxkKyhcXC5cXGQrKSopL2kpWzFdO1xuICAgIHRoaXMudG91Y2ggPSBcIm9udG91Y2hzdGFydFwiIGluIHdpbmRvdztcbiAgICB0aGlzLm1vYmlsZSA9IC9hbmRyb2lkfHdlYm9zfGlwaG9uZXxpcGFkfGlwb2R8YmxhY2tiZXJyeS9pLnRlc3QodXNlckFnZW50KTtcblxuICAgIHRoaXMucG9pbnRlckxvY2sgPSBcInBvaW50ZXJMb2NrRWxlbWVudFwiIGluIGRvY3VtZW50IHx8IFwibW96UG9pbnRlckxvY2tFbGVtZW50XCIgaW4gZG9jdW1lbnQgfHwgXCJ3ZWJraXRQb2ludGVyTG9ja0VsZW1lbnRcIiBpbiBkb2N1bWVudDtcbiAgICB0aGlzLmZ1bGxTY3JlZW4gPSBcImZ1bGxzY3JlZW5FbGVtZW50XCIgaW4gZG9jdW1lbnQgfHwgXCJtb3pGdWxsc2NyZWVuRWxlbWVudFwiIGluIGRvY3VtZW50IHx8IFwid2Via2l0RnVsbHNjcmVlbkVsZW1lbnRcIiBpbiBkb2N1bWVudDtcblxuICAgIHRoaXMud2ViZ2wgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxcbiAgICAgICAgICAgIG5hbWVzID0gW1wiM2RcIiwgXCJtb3otd2ViZ2xcIiwgXCJleHBlcmltZW50YWwtd2ViZ2xcIiwgXCJ3ZWJraXQtM2RcIiwgXCJ3ZWJnbFwiXSxcbiAgICAgICAgICAgIGhhcywgaSA9IG5hbWVzLmxlbmd0aDtcblxuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBoYXMgPSAhIWNhbnZhcy5nZXRDb250ZXh0KG5hbWVzW2ldKTtcbiAgICAgICAgICAgIGlmIChoYXMpIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGhhcztcbiAgICB9KCkpO1xuXG4gICAgdGhpcy5jYW52YXMgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxcbiAgICAgICAgICAgIGhhcyA9ICEhY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblxuICAgICAgICByZXR1cm4gaGFzO1xuICAgIH0oKSk7XG5cbiAgICB0aGlzLmdhbWVwYWRzID0gISFuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMgfHwgISFuYXZpZ2F0b3Iud2Via2l0R2V0R2FtZXBhZHMgfHwgISFuYXZpZ2F0b3Iud2Via2l0R2FtZXBhZHM7XG5cbiAgICB0aGlzLmF1ZGlvTXBlZyA9ICEhYXVkaW8uY2FuUGxheVR5cGUoXCJhdWRpby9tcGVnXCIpO1xuICAgIHRoaXMuYXVkaW9PZ2cgPSAhIWF1ZGlvLmNhblBsYXlUeXBlKFwiYXVkaW8vb2dnXCIpO1xuICAgIHRoaXMuYXVkaW9NcDMgPSAhIWF1ZGlvLmNhblBsYXlUeXBlKFwiYXVkaW8vbXAzXCIpO1xuICAgIHRoaXMuYXVkaW9NcDQgPSAhIWF1ZGlvLmNhblBsYXlUeXBlKFwiYXVkaW8vbXA0XCIpO1xuXG4gICAgdGhpcy52aWRlb1dlYm0gPSAhIXZpZGVvLmNhblBsYXlUeXBlKFwidmlkZW8vd2VibVwiKTtcbiAgICB0aGlzLnZpZGVvT2dnID0gISF2aWRlby5jYW5QbGF5VHlwZShcInZpZGVvL29nZ1wiKTtcbiAgICB0aGlzLnZpZGVvTXA0ID0gISF2aWRlby5jYW5QbGF5VHlwZShcInZpZGVvL21wNFwiKTtcbn1cblxuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBEZXZpY2U7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuXG52YXIgU1BMSVRFUiA9IC9bICxdKy8sXG5cbiAgICBXRUJHTF9OQU1FUyA9IFtcIndlYmdsXCIsIFwid2Via2l0LTNkXCIsIFwibW96LXdlYmdsXCIsIFwiZXhwZXJpbWVudGFsLXdlYmdsXCIsIFwiM2RcIl0sXG4gICAgV0VCR0xfQVRUUklCVVRFUyA9IHtcbiAgICAgICAgYWxwaGE6IHRydWUsXG4gICAgICAgIGFudGlhbGlhczogdHJ1ZSxcbiAgICAgICAgZGVwdGg6IHRydWUsXG4gICAgICAgIHByZW11bHRpcGxpZWRBbHBoYTogdHJ1ZSxcbiAgICAgICAgcHJlc2VydmVEcmF3aW5nQnVmZmVyOiBmYWxzZSxcbiAgICAgICAgc3RlbmNpbDogdHJ1ZVxuICAgIH07XG5cblxuZnVuY3Rpb24gRG9tKCkge1xufVxuXG5cbnZhciBFVkVOVF9DQUxMQkFDS19JRCA9IDAsXG4gICAgRVZFTlRfQ0FMTEJBQ0tTID0ge307XG5Eb20ucHJvdG90eXBlLmFkZEV2ZW50ID0gZnVuY3Rpb24gKG9iaiwgbmFtZSwgY2FsbGJhY2ssIGN0eCkge1xuICAgIHZhciBuYW1lcyA9IG5hbWUuc3BsaXQoU1BMSVRFUiksXG4gICAgICAgIGkgPSBuYW1lcy5sZW5ndGgsXG4gICAgICAgIHNjb3BlID0gY3R4IHx8IG9iaixcbiAgICAgICAgYWZuID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwoc2NvcGUsIGUgfHwgd2luZG93LmV2ZW50KTtcbiAgICAgICAgfTtcblxuICAgIEVWRU5UX0NBTExCQUNLU1soY2FsbGJhY2suX19FVkVOVF9DQUxMQkFDS19JRF9fID0gRVZFTlRfQ0FMTEJBQ0tfSUQrKyldID0gYWZuO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBuYW1lID0gbmFtZXNbaV07XG5cbiAgICAgICAgaWYgKG9iai5hdHRhY2hFdmVudCkge1xuICAgICAgICAgICAgb2JqLmF0dGFjaEV2ZW50KFwib25cIiArIG5hbWUsIGFmbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvYmouYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBhZm4sIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cblxuRG9tLnByb3RvdHlwZS5yZW1vdmVFdmVudCA9IGZ1bmN0aW9uIChvYmosIG5hbWUsIGNhbGxiYWNrLCBjdHgpIHtcbiAgICB2YXIgbmFtZXMgPSBuYW1lLnNwbGl0KFNQTElURVIpLFxuICAgICAgICBpID0gbmFtZXMubGVuZ3RoLFxuICAgICAgICBzY29wZSA9IGN0eCB8fCBvYmosXG4gICAgICAgIGlkID0gY2FsbGJhY2suX19FVkVOVF9DQUxMQkFDS19JRF9fLFxuICAgICAgICBhZm4gPSBFVkVOVF9DQUxMQkFDS1NbaWRdO1xuXG4gICAgRVZFTlRfQ0FMTEJBQ0tTW2lkXSA9IG51bGw7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIG5hbWUgPSBuYW1lc1tpXTtcblxuICAgICAgICBpZiAob2JqLmRldGFjaEV2ZW50KSB7XG4gICAgICAgICAgICBvYmouZGV0YWNoRXZlbnQoXCJvblwiICsgbmFtZSwgYWZuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG9iai5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIGFmbiwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuXG5Eb20ucHJvdG90eXBlLmFkZE1ldGEgPSBmdW5jdGlvbiAoaWQsIG5hbWUsIGNvbnRlbnQpIHtcbiAgICB2YXIgbWV0YSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJtZXRhXCIpLFxuICAgICAgICBoZWFkID0gZG9jdW1lbnQuaGVhZDtcblxuICAgIGlmIChpZCkgbWV0YS5pZCA9IGlkO1xuICAgIGlmIChuYW1lKSBtZXRhLm5hbWUgPSBuYW1lO1xuICAgIGlmIChjb250ZW50KSBtZXRhLmNvbnRlbnQgPSBjb250ZW50O1xuXG4gICAgaGVhZC5pbnNlcnRCZWZvcmUobWV0YSwgaGVhZC5maXJzdENoaWxkKTtcbn07XG5cblxuRG9tLnByb3RvdHlwZS5nZXRXZWJHTENvbnRleHQgPSBmdW5jdGlvbiAoY2FudmFzLCBhdHRyaWJ1dGVzKSB7XG4gICAgdmFyIGtleSwgZ2wsIGkgPSBXRUJHTF9OQU1FUy5sZW5ndGg7XG5cbiAgICBhdHRyaWJ1dGVzIHx8IChhdHRyaWJ1dGVzID0ge30pO1xuICAgIGZvciAoa2V5IGluIFdFQkdMX0FUVFJJQlVURVMpIHtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXNba2V5XSA9PSB1bmRlZmluZWQpIGF0dHJpYnV0ZXNba2V5XSA9IFdFQkdMX0FUVFJJQlVURVNba2V5XTtcbiAgICB9XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBnbCA9IGNhbnZhcy5nZXRDb250ZXh0KFdFQkdMX05BTUVTW2ldLCBhdHRyaWJ1dGVzKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRG9tLmdldFdlYkdMQ29udGV4dDogY291bGQgbm90IGdldCBhIFdlYkdMIENvbnRleHQgXCIgKyAoZXJyLm1lc3NhZ2UgfHwgXCJcIikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChnbCkgYnJlYWs7XG4gICAgfVxuXG4gICAgaWYgKCFnbCkgdGhyb3cgXCJEb20uZ2V0V2ViR0xDb250ZXh0OiBjb3VsZCBub3QgZ2V0IGEgV2ViR0wgQ29udGV4dFwiO1xuXG4gICAgcmV0dXJuIGdsO1xufTtcblxuXG52YXIgY3JlYXRlU2hhZGVyID0gRG9tLnByb3RvdHlwZS5jcmVhdGVTaGFkZXIgPSBmdW5jdGlvbiAoZ2wsIHNvdXJjZSwgdHlwZSkge1xuICAgIHZhciBzaGFkZXIgPSBnbC5jcmVhdGVTaGFkZXIodHlwZSk7XG5cbiAgICBnbC5zaGFkZXJTb3VyY2Uoc2hhZGVyLCBzb3VyY2UpO1xuICAgIGdsLmNvbXBpbGVTaGFkZXIoc2hhZGVyKTtcblxuICAgIGlmICghZ2wuZ2V0U2hhZGVyUGFyYW1ldGVyKHNoYWRlciwgZ2wuQ09NUElMRV9TVEFUVVMpKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJEb20uY3JlYXRlU2hhZGVyOiBwcm9ibGVtIGNvbXBpbGluZyBzaGFkZXIgXCIgKyBnbC5nZXRTaGFkZXJJbmZvTG9nKHNoYWRlcikpO1xuICAgICAgICBnbC5kZWxldGVTaGFkZXIoc2hhZGVyKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXR1cm4gc2hhZGVyO1xufTtcblxuXG5Eb20ucHJvdG90eXBlLmNyZWF0ZVByb2dyYW0gPSBmdW5jdGlvbiAoZ2wsIHZlcnRleCwgZnJhZ21lbnQpIHtcbiAgICB2YXIgcHJvZ3JhbSA9IGdsLmNyZWF0ZVByb2dyYW0oKSxcbiAgICAgICAgc2hhZGVyO1xuXG4gICAgc2hhZGVyID0gY3JlYXRlU2hhZGVyKGdsLCB2ZXJ0ZXgsIGdsLlZFUlRFWF9TSEFERVIpO1xuICAgIGdsLmF0dGFjaFNoYWRlcihwcm9ncmFtLCBzaGFkZXIpO1xuICAgIGdsLmRlbGV0ZVNoYWRlcihzaGFkZXIpO1xuXG4gICAgc2hhZGVyID0gY3JlYXRlU2hhZGVyKGdsLCBmcmFnbWVudCwgZ2wuRlJBR01FTlRfU0hBREVSKTtcbiAgICBnbC5hdHRhY2hTaGFkZXIocHJvZ3JhbSwgc2hhZGVyKTtcbiAgICBnbC5kZWxldGVTaGFkZXIoc2hhZGVyKTtcblxuICAgIGdsLmxpbmtQcm9ncmFtKHByb2dyYW0pO1xuICAgIGdsLnZhbGlkYXRlUHJvZ3JhbShwcm9ncmFtKTtcbiAgICBnbC51c2VQcm9ncmFtKHByb2dyYW0pO1xuXG4gICAgaWYgKCFnbC5nZXRQcm9ncmFtUGFyYW1ldGVyKHByb2dyYW0sIGdsLkxJTktfU1RBVFVTKSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRG9tLmNyZWF0ZVByb2dyYW06IHByb2JsZW0gY29tcGlsaW5nIFByb2dyYW0gXCIgKyBnbC5nZXRQcm9ncmFtSW5mb0xvZyhwcm9ncmFtKSk7XG4gICAgICAgIGdsLmRlbGV0ZVByb2dyYW0ocHJvZ3JhbSk7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHByb2dyYW07XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IERvbTtcbiIsInZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbFwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBpc0FycmF5ID0gdXRpbC5pc0FycmF5LFxuICAgIFNQTElURVIgPSAvWyAsXSsvLFxuICAgIENPVU5URVIgPSAwO1xuXG5cbmZ1bmN0aW9uIEVudW0oZW51bXMpIHtcbiAgICBlbnVtcyA9IGlzQXJyYXkoZW51bXMpID8gZW51bXMgOiBlbnVtcy5zcGxpdChTUExJVEVSKTtcbiAgICB2YXIgaSA9IGVudW1zLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHRoaXNbZW51bXNbaV1dID0gKytDT1VOVEVSO1xufVxuXG5cbkVudW0ucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChlbnVtcykge1xuICAgIGVudW1zID0gaXNBcnJheShlbnVtcykgPyBlbnVtcyA6IGVudW1zLnNwbGl0KFNQTElURVIpO1xuICAgIHZhciBpID0gZW51bXMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkgdGhpc1tlbnVtc1tpXV0gPSArK0NPVU5URVI7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuRW51bS5wcm90b3R5cGUuaW4gPSBmdW5jdGlvbiAobnVtKSB7XG4gICAgdmFyIGtleTtcblxuICAgIGZvciAoa2V5IGluIHRoaXMpIHtcbiAgICAgICAgaWYgKHRoaXNba2V5XSA9PSBudW0pIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBFbnVtO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5cbnZhciBzaGlmdCA9IEFycmF5LnByb3RvdHlwZS5zaGlmdDtcblxuXG4vKipcbiAqIEBjbGFzcyBYaWFuLkV2ZW50RW1pdHRlclxuICovXG5mdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XG5cbiAgICB0aGlzLl9ldmVudHMgPSB7fTtcbn1cblxuLyoqXG4gKiBhdHRhY2hlcyBmdW5jdGlvbiB0byBhbiBldmVudFxuICogQG1lbWJlcm9mIFhpYW4uRXZlbnRFbWl0dGVyXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICogQHBhcmFtIHtmdW5jdGlvbn0gbGlzdGVuZXJcbiAqIEBwYXJhbSB7b2JqZWN0fSBjdHhcbiAqIEByZXR1cm4gdGhpc1xuICovXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gKHR5cGUsIGxpc3RlbmVyLCBjdHgpIHtcbiAgICB2YXIgZXZlbnRzID0gdGhpcy5fZXZlbnRzO1xuXG4gICAgKGV2ZW50c1t0eXBlXSB8fCAoZXZlbnRzW3R5cGVdID0gW10pKS5wdXNoKHtcbiAgICAgICAgbGlzdGVuZXI6IGxpc3RlbmVyLFxuICAgICAgICBjdHg6IGN0eCB8fCB0aGlzXG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogYXR0YWNoZXMgZnVuY3Rpb24gdG8gYW4gZXZlbnQsIG9uIHRoZSBmaXJzdCBjYWxsIGl0cyByZW1vdmVkXG4gKiBAbWVtYmVyb2YgWGlhbi5FdmVudEVtaXR0ZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBsaXN0ZW5lclxuICogQHBhcmFtIHtvYmplY3R9IGN0eFxuICogQHJldHVybiB0aGlzXG4gKi9cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uICh0eXBlLCBsaXN0ZW5lciwgY3R4KSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICBjdHggPSBjdHggfHwgdGhpcztcblxuICAgIGZ1bmN0aW9uIG9uY2UoKSB7XG4gICAgICAgIF90aGlzLm9mZih0eXBlLCBvbmNlLCBjdHgpO1xuICAgICAgICBsaXN0ZW5lci5hcHBseShjdHgsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMub24odHlwZSwgb25jZSwgY3R4KTtcbn07XG5cbi8qKlxuICogYXR0YWNoZXMgZnVuY3Rpb24gdG8gYW4gZXZlbnQgb24gYW5vdGhlciBvYmplY3RcbiAqIEBtZW1iZXJvZiBYaWFuLkV2ZW50RW1pdHRlclxuICogQHBhcmFtIHtvYmplY3R9IG9ialxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGxpc3RlbmVyXG4gKiBAcGFyYW0ge29iamVjdH0gY3R4XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5UbyA9IGZ1bmN0aW9uIChvYmosIHR5cGUsIGxpc3RlbmVyLCBjdHgpIHtcbiAgICBpZiAoIShvYmogaW5zdGFuY2VvZiBFdmVudEVtaXR0ZXIpKSB0aHJvdyBcIkNhbid0IGxpc3RlbiB0byBPYmplY3QsIGl0J3Mgbm90IGEgaW5zdGFuY2Ugb2YgRXZlbnRFbWl0dGVyXCI7XG5cbiAgICBvYmoub24odHlwZSwgbGlzdGVuZXIsIGN0eCB8fCB0aGlzKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiByZW1vdmVzIGZ1bmN0aW9uIGZyb20gYW4gZXZlbnRcbiAqIEBtZW1iZXJvZiBYaWFuLkV2ZW50RW1pdHRlclxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGxpc3RlbmVyXG4gKiBAcGFyYW0ge29iamVjdH0gY3R4XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAodHlwZSwgbGlzdGVuZXIsIGN0eCkge1xuICAgIHZhciB0aGlzRXZlbnRzID0gdGhpcy5fZXZlbnRzLFxuICAgICAgICBldmVudHMsIGV2ZW50LFxuICAgICAgICBpO1xuXG4gICAgaWYgKCF0eXBlKSB7XG4gICAgICAgIGZvciAoaSBpbiB0aGlzRXZlbnRzKVxuICAgICAgICAgICAgaWYgKChldmVudHMgPSB0aGlzRXZlbnRzW2ldKSkgZXZlbnRzLmxlbmd0aCA9IDA7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGV2ZW50cyA9IHRoaXNFdmVudHNbdHlwZV07XG4gICAgaWYgKCFldmVudHMpIHJldHVybiB0aGlzO1xuXG4gICAgaWYgKCFsaXN0ZW5lcikge1xuICAgICAgICBldmVudHMubGVuZ3RoID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHggPSBjdHggfHwgdGhpcztcbiAgICAgICAgaSA9IGV2ZW50cy5sZW5ndGg7XG5cbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgZXZlbnQgPSBldmVudHNbaV07XG5cbiAgICAgICAgICAgIGlmIChldmVudC5saXN0ZW5lciA9PT0gbGlzdGVuZXIgJiYgZXZlbnQuY3R4ID09PSBjdHgpIHtcbiAgICAgICAgICAgICAgICBldmVudHMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIGVtaXRzIGV2ZW50IHR5cGVcbiAqIEBtZW1iZXJvZiBYaWFuLkV2ZW50RW1pdHRlclxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAqIEByZXR1cm4gdGhpc1xuICovXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgIHZhciBldmVudHMgPSB0aGlzLl9ldmVudHNbdHlwZV0sXG4gICAgICAgIGExLCBhMiwgYTMsIGE0LFxuICAgICAgICBsZW5ndGgsIGV2ZW50LFxuICAgICAgICBpO1xuXG4gICAgaWYgKCFldmVudHMgfHwgIWV2ZW50cy5sZW5ndGgpIHJldHVybiB0aGlzO1xuICAgIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cbiAgICBpZiAobGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGkgPSBldmVudHMubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAoZXZlbnQgPSBldmVudHNbaV0pLmxpc3RlbmVyLmNhbGwoZXZlbnQuY3R4KTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAobGVuZ3RoID09PSAyKSB7XG4gICAgICAgIGExID0gYXJndW1lbnRzWzFdO1xuICAgICAgICBpID0gZXZlbnRzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgKGV2ZW50ID0gZXZlbnRzW2ldKS5saXN0ZW5lci5jYWxsKGV2ZW50LmN0eCwgYTEpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChsZW5ndGggPT09IDMpIHtcbiAgICAgICAgYTEgPSBhcmd1bWVudHNbMV07XG4gICAgICAgIGEyID0gYXJndW1lbnRzWzJdO1xuICAgICAgICBpID0gZXZlbnRzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgKGV2ZW50ID0gZXZlbnRzW2ldKS5saXN0ZW5lci5jYWxsKGV2ZW50LmN0eCwgYTEsIGEyKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAobGVuZ3RoID09PSA0KSB7XG4gICAgICAgIGExID0gYXJndW1lbnRzWzFdO1xuICAgICAgICBhMiA9IGFyZ3VtZW50c1syXTtcbiAgICAgICAgYTMgPSBhcmd1bWVudHNbM107XG4gICAgICAgIGkgPSBldmVudHMubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAoZXZlbnQgPSBldmVudHNbaV0pLmxpc3RlbmVyLmNhbGwoZXZlbnQuY3R4LCBhMSwgYTIsIGEzKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAobGVuZ3RoID09PSA1KSB7XG4gICAgICAgIGExID0gYXJndW1lbnRzWzFdO1xuICAgICAgICBhMiA9IGFyZ3VtZW50c1syXTtcbiAgICAgICAgYTMgPSBhcmd1bWVudHNbM107XG4gICAgICAgIGE0ID0gYXJndW1lbnRzWzRdO1xuICAgICAgICBpID0gZXZlbnRzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgKGV2ZW50ID0gZXZlbnRzW2ldKS5saXN0ZW5lci5jYWxsKGV2ZW50LmN0eCwgYTEsIGEyLCBhMywgYTQpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2hpZnQuYXBwbHkoYXJndW1lbnRzKTtcbiAgICAgICAgaSA9IGV2ZW50cy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgIChldmVudCA9IGV2ZW50c1tpXSkubGlzdGVuZXIuYXBwbHkoZXZlbnQuY3R4LCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZW1iZXJvZiBYaWFuLkV2ZW50RW1pdHRlclxuICogQHBhcmFtIHtjb25zdHJ1Y3Rvcn0gY2hpbGRcbiAqIEBwYXJhbSB7Y29uc3RydWN0b3J9IHBhcmVudFxuICogQHJldHVybiBjaGlsZFxuICovXG5FdmVudEVtaXR0ZXIuZXh0ZW5kID0gZnVuY3Rpb24gKGNoaWxkLCBwYXJlbnQpIHtcbiAgICBpZiAoIXBhcmVudCkgcGFyZW50ID0gdGhpcztcblxuICAgIGNoaWxkLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSk7XG4gICAgY2hpbGQucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gY2hpbGQ7XG5cbiAgICAodGhpcy5fY2hpbGRyZW4gfHwgKHRoaXMuX2NoaWxkcmVuID0ge30pKVtjaGlsZC5uYW1lXSA9IGNoaWxkO1xuICAgIGNoaWxkLl9wYXJlbnQgPSB0aGlzO1xuXG4gICAgY2hpbGQuZXh0ZW5kID0gcGFyZW50LmV4dGVuZCB8fCB0aGlzLmV4dGVuZDtcblxuICAgIGlmIChwYXJlbnQub25FeHRlbmQpIHtcbiAgICAgICAgaWYgKCFjaGlsZC5vbkV4dGVuZCkgY2hpbGQub25FeHRlbmQgPSBwYXJlbnQub25FeHRlbmQ7XG4gICAgICAgIHBhcmVudC5vbkV4dGVuZChjaGlsZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNoaWxkO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEV2ZW50RW1pdHRlcjtcbiIsInZhciBEZXZpY2UgPSByZXF1aXJlKFwiLi9kZXZpY2VcIik7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWxcIik7XG52YXIgQ29uZmlnID0gcmVxdWlyZShcIi4vY29uZmlnXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGVhY2ggPSB1dGlsLmVhY2g7XG5cblxuZnVuY3Rpb24gTG9nKCkge1xufVxuXG5cbmlmIChEZXZpY2UubW9iaWxlKSB7XG4gICAgdmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xuXG4gICAgTG9nLnByb3RvdHlwZS5kZWJ1ZyA9IExvZy5wcm90b3R5cGUuaW5mbyA9IExvZy5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIUNvbmZpZy5kZWJ1ZykgcmV0dXJuO1xuICAgICAgICBhbGVydChzbGljZS5jYWxsKGFyZ3VtZW50cywgMCkpO1xuICAgIH07XG5cbiAgICBMb2cucHJvdG90eXBlLndhcm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghKENvbmZpZy5kZWJ1ZyB8fCBDb25maWcud2FybikpIHJldHVybjtcbiAgICAgICAgYWxlcnQoc2xpY2UuY2FsbChhcmd1bWVudHMsIDApKTtcbiAgICB9O1xuXG4gICAgTG9nLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCEoQ29uZmlnLmRlYnVnIHx8IENvbmZpZy5lcnJvcikpIHJldHVybjtcbiAgICAgICAgYWxlcnQoc2xpY2UuY2FsbChhcmd1bWVudHMsIDApKTtcbiAgICB9O1xufSBlbHNlIHtcbiAgICBMb2cucHJvdG90eXBlLmRlYnVnID0gTG9nLnByb3RvdHlwZS5pbmZvID0gTG9nLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghQ29uZmlnLmRlYnVnKSByZXR1cm47XG4gICAgICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIExvZy5wcm90b3R5cGUud2FybiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCEoQ29uZmlnLmRlYnVnIHx8IENvbmZpZy53YXJuKSkgcmV0dXJuO1xuICAgICAgICBjb25zb2xlLndhcm4uYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcbiAgICB9O1xuXG4gICAgTG9nLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCEoQ29uZmlnLmRlYnVnIHx8IENvbmZpZy5lcnJvcikpIHJldHVybjtcbiAgICAgICAgY29uc29sZS5lcnJvci5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpO1xuICAgIH07XG59XG5cblxudmFyIENBQ0hFID0ge307XG5Mb2cucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCEoQ29uZmlnLmRlYnVnIHx8IENvbmZpZy5lcnJvcikgfHwgQ0FDSEVbY2FjaGVLZXkoYXJndW1lbnRzKV0pIHJldHVybjtcblxuICAgIENBQ0hFW2NhY2hlS2V5KGFyZ3VtZW50cyldID0gdHJ1ZTtcbiAgICB0aGlzLmVycm9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59O1xuXG5cbmZ1bmN0aW9uIGNhY2hlS2V5KGFyZ3MpIHtcbiAgICB2YXIga2V5ID0gXCJcIixcbiAgICAgICAgaTtcblxuICAgIGZvciAoaSA9IGFyZ3MubGVuZ3RoOyBpLS07KSBrZXkgKz0gYXJnc1tpXTtcblxuICAgIHJldHVybiBrZXk7XG59O1xuXG5cbkxvZy5wcm90b3R5cGUub2JqZWN0ID0gZnVuY3Rpb24gKG9iaiwgdmFsdWVzLCB0YWJzKSB7XG4gICAgaWYgKCFDb25maWcuZGVidWcpIHJldHVybiBcIlwiO1xuICAgIHZhciBzdHIgPSBcIlwiO1xuXG4gICAgdGFicyB8fCAodGFicyA9IFwiXCIpO1xuICAgIHZhbHVlcyB8fCAodmFsdWVzID0gW10pO1xuXG4gICAgZWFjaChvYmosIGZ1bmN0aW9uICh2YWx1ZSwgaSkge1xuICAgICAgICBpZiAofnZhbHVlcy5pbmRleE9mKHZhbHVlKSkgcmV0dXJuO1xuXG4gICAgICAgIHZhciB0eXBlID0gdHlwZW9mKHZhbHVlKSxcbiAgICAgICAgICAgIHRtcDtcblxuICAgICAgICBpZiAodHlwZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgdG1wID0gdGFicztcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIHRhYnMgKz0gXCJcXHRcIjtcbiAgICAgICAgICAgIHN0ciArPSB0YWJzICsgaSArIFwiID0gXCIgKyB0aGlzLm9iamVjdCh2YWx1ZSwgdmFsdWVzLCB0YWJzKSArIFwiXFxuXCI7XG4gICAgICAgICAgICB0YWJzID0gdG1wO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgc3RyICs9IHRhYnMgKyBpICsgXCIgPSBcIiArIHZhbHVlICsgXCJcXG5cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIHN0ciArPSB0YWJzICsgdmFsdWUgKyBcIlxcblwiO1xuICAgICAgICB9XG4gICAgfSwgdGhpcyk7XG5cbiAgICByZXR1cm4gc3RyO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBMb2c7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBPYmplY3RQb29sKGNvbnN0cnVjdG9yKSB7XG5cbiAgICB0aGlzLnBvb2xlZCA9IFtdO1xuICAgIHRoaXMub2JqZWN0cyA9IFtdO1xuICAgIHRoaXMub2JqZWN0ID0gY29uc3RydWN0b3I7XG59XG5cblxuT2JqZWN0UG9vbC5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBwb29sZWQgPSB0aGlzLnBvb2xlZCxcbiAgICAgICAgb2JqZWN0ID0gcG9vbGVkLmxlbmd0aCA/IHBvb2xlZC5wb3AoKSA6IG5ldyB0aGlzLm9iamVjdDtcblxuICAgIHRoaXMub2JqZWN0cy5wdXNoKG9iamVjdCk7XG4gICAgcmV0dXJuIG9iamVjdDtcbn07XG5cblxuT2JqZWN0UG9vbC5wcm90b3R5cGUucmVtb3ZlT2JqZWN0ID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICAgIHZhciBvYmplY3RzID0gdGhpcy5vYmplY3RzLFxuICAgICAgICBwb29sZWQgPSB0aGlzLnBvb2xlZCxcbiAgICAgICAgaW5kZXggPSBvYmplY3RzLmluZGV4T2Yob2JqZWN0KTtcblxuICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgIHBvb2xlZC5wdXNoKG9iamVjdCk7XG4gICAgICAgIG9iamVjdHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuT2JqZWN0UG9vbC5wcm90b3R5cGUucmVtb3ZlID0gT2JqZWN0UG9vbC5wcm90b3R5cGUucmVtb3ZlT2JqZWN0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLnJlbW92ZU9iamVjdChhcmd1bWVudHNbaV0pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbk9iamVjdFBvb2wucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBvYmplY3RzID0gdGhpcy5vYmplY3RzLFxuICAgICAgICBwb29sZWQgPSB0aGlzLnBvb2xlZCxcbiAgICAgICAgaSA9IG9iamVjdHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkgcG9vbGVkLnB1c2gob2JqZWN0c1tpXSk7XG4gICAgb2JqZWN0cy5sZW5ndGggPSAwO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbk9iamVjdFBvb2wucHJvdG90eXBlLmNsZWFyRm9yRWFjaCA9IGZ1bmN0aW9uIChmbikge1xuICAgIHZhciBvYmplY3RzID0gdGhpcy5vYmplY3RzLFxuICAgICAgICBwb29sZWQgPSB0aGlzLnBvb2xlZCxcbiAgICAgICAgb2JqZWN0LFxuICAgICAgICBpID0gb2JqZWN0cy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIG9iamVjdCA9IG9iamVjdHNbaV07XG5cbiAgICAgICAgcG9vbGVkLnB1c2gob2JqZWN0KTtcbiAgICAgICAgZm4ob2JqZWN0KTtcbiAgICB9XG4gICAgb2JqZWN0cy5sZW5ndGggPSAwO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbk9iamVjdFBvb2wucHJvdG90eXBlLmVtcHR5ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5wb29sZWQubGVuZ3RoID0gdGhpcy5vYmplY3RzLmxlbmd0aCA9IDA7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3RQb29sO1xuIiwiKGZ1bmN0aW9uIChnbG9iYWwpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIFJBVEUgPSAxMDAwIC8gNjAsXG4gICAgdyA9IHR5cGVvZih3aW5kb3cpICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogZ2xvYmFsO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChcbncucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG53LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxudy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcbncub1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxudy5tc1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxuZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG5cbiAgICByZXR1cm4gdy5zZXRUaW1lb3V0KGNhbGxiYWNrLCBSQVRFKTtcbn1cbik7XG5cbn0pLmNhbGwodGhpcyx0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KSIsIihmdW5jdGlvbigpIHtcbiAgICB2YXIgaW8gPSAoZnVuY3Rpb24oZXhwb3J0cywgZ2xvYmFsKSB7XG4gICAgICAgIHZhciBpbyA9IGV4cG9ydHM7XG4gICAgICAgIGlvLnZlcnNpb24gPSBcIjAuOS4xNlwiO1xuICAgICAgICBpby5wcm90b2NvbCA9IDE7XG4gICAgICAgIGlvLnRyYW5zcG9ydHMgPSBbXTtcbiAgICAgICAgaW8uaiA9IFtdO1xuICAgICAgICBpby5zb2NrZXRzID0ge307XG4gICAgICAgIGlvLmNvbm5lY3QgPSBmdW5jdGlvbihob3N0LCBkZXRhaWxzKSB7XG4gICAgICAgICAgICB2YXIgdXJpID0gaW8udXRpbC5wYXJzZVVyaShob3N0KSxcbiAgICAgICAgICAgICAgICB1dXJpLCBzb2NrZXQ7XG4gICAgICAgICAgICBpZiAoZ2xvYmFsICYmIGdsb2JhbC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgIHVyaS5wcm90b2NvbCA9IHVyaS5wcm90b2NvbCB8fCBnbG9iYWwubG9jYXRpb24ucHJvdG9jb2wuc2xpY2UoMCwgLTEpO1xuICAgICAgICAgICAgICAgIHVyaS5ob3N0ID0gdXJpLmhvc3QgfHwgKGdsb2JhbC5kb2N1bWVudCA/IGdsb2JhbC5kb2N1bWVudC5kb21haW4gOiBnbG9iYWwubG9jYXRpb24uaG9zdG5hbWUpO1xuICAgICAgICAgICAgICAgIHVyaS5wb3J0ID0gdXJpLnBvcnQgfHwgZ2xvYmFsLmxvY2F0aW9uLnBvcnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHV1cmkgPSBpby51dGlsLnVuaXF1ZVVyaSh1cmkpO1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgaG9zdDogdXJpLmhvc3QsXG4gICAgICAgICAgICAgICAgc2VjdXJlOiBcImh0dHBzXCIgPT0gdXJpLnByb3RvY29sLFxuICAgICAgICAgICAgICAgIHBvcnQ6IHVyaS5wb3J0IHx8IChcImh0dHBzXCIgPT0gdXJpLnByb3RvY29sID8gNDQzIDogODApLFxuICAgICAgICAgICAgICAgIHF1ZXJ5OiB1cmkucXVlcnkgfHwgXCJcIlxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlvLnV0aWwubWVyZ2Uob3B0aW9ucywgZGV0YWlscyk7XG4gICAgICAgICAgICBpZiAob3B0aW9uc1tcImZvcmNlIG5ldyBjb25uZWN0aW9uXCJdIHx8ICFpby5zb2NrZXRzW3V1cmldKSB7XG4gICAgICAgICAgICAgICAgc29ja2V0ID0gbmV3IGlvLlNvY2tldChvcHRpb25zKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFvcHRpb25zW1wiZm9yY2UgbmV3IGNvbm5lY3Rpb25cIl0gJiYgc29ja2V0KSB7XG4gICAgICAgICAgICAgICAgaW8uc29ja2V0c1t1dXJpXSA9IHNvY2tldFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc29ja2V0ID0gc29ja2V0IHx8IGlvLnNvY2tldHNbdXVyaV07XG4gICAgICAgICAgICByZXR1cm4gc29ja2V0Lm9mKHVyaS5wYXRoLmxlbmd0aCA+IDEgPyB1cmkucGF0aCA6IFwiXCIpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBpb1xuICAgIH0pKHt9LCB0aGlzKTtcbiAgICAoZnVuY3Rpb24oZXhwb3J0cywgZ2xvYmFsKSB7XG4gICAgICAgIHZhciB1dGlsID0gZXhwb3J0cy51dGlsID0ge307XG4gICAgICAgIHZhciByZSA9IC9eKD86KD8hW146QF0rOlteOkBcXC9dKkApKFteOlxcLz8jLl0rKTopPyg/OlxcL1xcLyk/KCg/OigoW146QF0qKSg/OjooW146QF0qKSk/KT9AKT8oW146XFwvPyNdKikoPzo6KFxcZCopKT8pKCgoXFwvKD86W14/I10oPyFbXj8jXFwvXSpcXC5bXj8jXFwvLl0rKD86Wz8jXXwkKSkpKlxcLz8pPyhbXj8jXFwvXSopKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8pLztcbiAgICAgICAgdmFyIHBhcnRzID0gW1wic291cmNlXCIsIFwicHJvdG9jb2xcIiwgXCJhdXRob3JpdHlcIiwgXCJ1c2VySW5mb1wiLCBcInVzZXJcIiwgXCJwYXNzd29yZFwiLCBcImhvc3RcIiwgXCJwb3J0XCIsIFwicmVsYXRpdmVcIiwgXCJwYXRoXCIsIFwiZGlyZWN0b3J5XCIsIFwiZmlsZVwiLCBcInF1ZXJ5XCIsIFwiYW5jaG9yXCJdO1xuICAgICAgICB1dGlsLnBhcnNlVXJpID0gZnVuY3Rpb24oc3RyKSB7XG4gICAgICAgICAgICB2YXIgbSA9IHJlLmV4ZWMoc3RyIHx8IFwiXCIpLFxuICAgICAgICAgICAgICAgIHVyaSA9IHt9LCBpID0gMTQ7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgdXJpW3BhcnRzW2ldXSA9IG1baV0gfHwgXCJcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVyaVxuICAgICAgICB9O1xuICAgICAgICB1dGlsLnVuaXF1ZVVyaSA9IGZ1bmN0aW9uKHVyaSkge1xuICAgICAgICAgICAgdmFyIHByb3RvY29sID0gdXJpLnByb3RvY29sLFxuICAgICAgICAgICAgICAgIGhvc3QgPSB1cmkuaG9zdCxcbiAgICAgICAgICAgICAgICBwb3J0ID0gdXJpLnBvcnQ7XG4gICAgICAgICAgICBpZiAoXCJkb2N1bWVudFwiIGluIGdsb2JhbCkge1xuICAgICAgICAgICAgICAgIGhvc3QgPSBob3N0IHx8IGRvY3VtZW50LmRvbWFpbjtcbiAgICAgICAgICAgICAgICBwb3J0ID0gcG9ydCB8fCAocHJvdG9jb2wgPT0gXCJodHRwc1wiICYmIGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sICE9PSBcImh0dHBzOlwiID8gNDQzIDogZG9jdW1lbnQubG9jYXRpb24ucG9ydClcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaG9zdCA9IGhvc3QgfHwgXCJsb2NhbGhvc3RcIjtcbiAgICAgICAgICAgICAgICBpZiAoIXBvcnQgJiYgcHJvdG9jb2wgPT0gXCJodHRwc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvcnQgPSA0NDNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gKHByb3RvY29sIHx8IFwiaHR0cFwiKSArIFwiOi8vXCIgKyBob3N0ICsgXCI6XCIgKyAocG9ydCB8fCA4MClcbiAgICAgICAgfTtcbiAgICAgICAgdXRpbC5xdWVyeSA9IGZ1bmN0aW9uKGJhc2UsIGFkZGl0aW9uKSB7XG4gICAgICAgICAgICB2YXIgcXVlcnkgPSB1dGlsLmNodW5rUXVlcnkoYmFzZSB8fCBcIlwiKSxcbiAgICAgICAgICAgICAgICBjb21wb25lbnRzID0gW107XG4gICAgICAgICAgICB1dGlsLm1lcmdlKHF1ZXJ5LCB1dGlsLmNodW5rUXVlcnkoYWRkaXRpb24gfHwgXCJcIikpO1xuICAgICAgICAgICAgZm9yICh2YXIgcGFydCBpbiBxdWVyeSkge1xuICAgICAgICAgICAgICAgIGlmIChxdWVyeS5oYXNPd25Qcm9wZXJ0eShwYXJ0KSkge1xuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRzLnB1c2gocGFydCArIFwiPVwiICsgcXVlcnlbcGFydF0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudHMubGVuZ3RoID8gXCI/XCIgKyBjb21wb25lbnRzLmpvaW4oXCImXCIpIDogXCJcIlxuICAgICAgICB9O1xuICAgICAgICB1dGlsLmNodW5rUXVlcnkgPSBmdW5jdGlvbihxcykge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0ge30sIHBhcmFtcyA9IHFzLnNwbGl0KFwiJlwiKSxcbiAgICAgICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgICAgICBsID0gcGFyYW1zLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBrdjtcbiAgICAgICAgICAgIGZvciAoOyBpIDwgbDsgKytpKSB7XG4gICAgICAgICAgICAgICAga3YgPSBwYXJhbXNbaV0uc3BsaXQoXCI9XCIpO1xuICAgICAgICAgICAgICAgIGlmIChrdlswXSkge1xuICAgICAgICAgICAgICAgICAgICBxdWVyeVtrdlswXV0gPSBrdlsxXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBxdWVyeVxuICAgICAgICB9O1xuICAgICAgICB2YXIgcGFnZUxvYWRlZCA9IGZhbHNlO1xuICAgICAgICB1dGlsLmxvYWQgPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgICAgaWYgKFwiZG9jdW1lbnRcIiBpbiBnbG9iYWwgJiYgZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gXCJjb21wbGV0ZVwiIHx8IHBhZ2VMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4oKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdXRpbC5vbihnbG9iYWwsIFwibG9hZFwiLCBmbiwgZmFsc2UpXG4gICAgICAgIH07XG4gICAgICAgIHV0aWwub24gPSBmdW5jdGlvbihlbGVtZW50LCBldmVudCwgZm4sIGNhcHR1cmUpIHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50LmF0dGFjaEV2ZW50KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5hdHRhY2hFdmVudChcIm9uXCIgKyBldmVudCwgZm4pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBmbiwgY2FwdHVyZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHV0aWwucmVxdWVzdCA9IGZ1bmN0aW9uKHhkb21haW4pIHtcbiAgICAgICAgICAgIGlmICh4ZG9tYWluICYmIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIFhEb21haW5SZXF1ZXN0ICYmICF1dGlsLnVhLmhhc0NPUlMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFhEb21haW5SZXF1ZXN0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAmJiAoIXhkb21haW4gfHwgdXRpbC51YS5oYXNDT1JTKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgWE1MSHR0cFJlcXVlc3QoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF4ZG9tYWluKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB3aW5kb3dbKFtcIkFjdGl2ZVwiXS5jb25jYXQoXCJPYmplY3RcIikuam9pbihcIlhcIikpXShcIk1pY3Jvc29mdC5YTUxIVFRQXCIpXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIGlmIChcInVuZGVmaW5lZFwiICE9IHR5cGVvZiB3aW5kb3cpIHtcbiAgICAgICAgICAgIHV0aWwubG9hZChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBwYWdlTG9hZGVkID0gdHJ1ZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICB1dGlsLmRlZmVyID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICAgIGlmICghdXRpbC51YS53ZWJraXQgfHwgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgaW1wb3J0U2NyaXB0cykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbigpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB1dGlsLmxvYWQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmbiwgMTAwKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgdXRpbC5tZXJnZSA9IGZ1bmN0aW9uIG1lcmdlKHRhcmdldCwgYWRkaXRpb25hbCwgZGVlcCwgbGFzdHNlZW4pIHtcbiAgICAgICAgICAgIHZhciBzZWVuID0gbGFzdHNlZW4gfHwgW10sXG4gICAgICAgICAgICAgICAgZGVwdGggPSB0eXBlb2YgZGVlcCA9PSBcInVuZGVmaW5lZFwiID8gMiA6IGRlZXAsXG4gICAgICAgICAgICAgICAgcHJvcDtcbiAgICAgICAgICAgIGZvciAocHJvcCBpbiBhZGRpdGlvbmFsKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFkZGl0aW9uYWwuaGFzT3duUHJvcGVydHkocHJvcCkgJiYgdXRpbC5pbmRleE9mKHNlZW4sIHByb3ApIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRhcmdldFtwcm9wXSAhPT0gXCJvYmplY3RcIiB8fCAhZGVwdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFtwcm9wXSA9IGFkZGl0aW9uYWxbcHJvcF07XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWVuLnB1c2goYWRkaXRpb25hbFtwcm9wXSlcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV0aWwubWVyZ2UodGFyZ2V0W3Byb3BdLCBhZGRpdGlvbmFsW3Byb3BdLCBkZXB0aCAtIDEsIHNlZW4pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0XG4gICAgICAgIH07XG4gICAgICAgIHV0aWwubWl4aW4gPSBmdW5jdGlvbihjdG9yLCBjdG9yMikge1xuICAgICAgICAgICAgdXRpbC5tZXJnZShjdG9yLnByb3RvdHlwZSwgY3RvcjIucHJvdG90eXBlKVxuICAgICAgICB9O1xuICAgICAgICB1dGlsLmluaGVyaXQgPSBmdW5jdGlvbihjdG9yLCBjdG9yMikge1xuICAgICAgICAgICAgZnVuY3Rpb24gZigpIHt9XG4gICAgICAgICAgICBmLnByb3RvdHlwZSA9IGN0b3IyLnByb3RvdHlwZTtcbiAgICAgICAgICAgIGN0b3IucHJvdG90eXBlID0gbmV3IGZcbiAgICAgICAgfTtcbiAgICAgICAgdXRpbC5pc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gXCJbb2JqZWN0IEFycmF5XVwiXG4gICAgICAgIH07XG4gICAgICAgIHV0aWwuaW50ZXJzZWN0ID0gZnVuY3Rpb24oYXJyLCBhcnIyKSB7XG4gICAgICAgICAgICB2YXIgcmV0ID0gW10sXG4gICAgICAgICAgICAgICAgbG9uZ2VzdCA9IGFyci5sZW5ndGggPiBhcnIyLmxlbmd0aCA/IGFyciA6IGFycjIsXG4gICAgICAgICAgICAgICAgc2hvcnRlc3QgPSBhcnIubGVuZ3RoID4gYXJyMi5sZW5ndGggPyBhcnIyIDogYXJyO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBzaG9ydGVzdC5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAofnV0aWwuaW5kZXhPZihsb25nZXN0LCBzaG9ydGVzdFtpXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2goc2hvcnRlc3RbaV0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldFxuICAgICAgICB9O1xuICAgICAgICB1dGlsLmluZGV4T2YgPSBmdW5jdGlvbihhcnIsIG8sIGkpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSBhcnIubGVuZ3RoLCBpID0gaSA8IDAgPyBpICsgaiA8IDAgPyAwIDogaSArIGogOiBpIHx8IDA7IGkgPCBqICYmIGFycltpXSAhPT0gbzsgaSsrKSB7fVxuICAgICAgICAgICAgcmV0dXJuIGogPD0gaSA/IC0xIDogaVxuICAgICAgICB9O1xuICAgICAgICB1dGlsLnRvQXJyYXkgPSBmdW5jdGlvbihlbnUpIHtcbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZW51Lmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIGFyci5wdXNoKGVudVtpXSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhcnJcbiAgICAgICAgfTtcbiAgICAgICAgdXRpbC51YSA9IHt9O1xuICAgICAgICB1dGlsLnVhLmhhc0NPUlMgPSBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAmJiAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBhID0gbmV3IFhNTEh0dHBSZXF1ZXN0KClcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhLndpdGhDcmVkZW50aWFscyAhPSB1bmRlZmluZWRcbiAgICAgICAgfSkoKTtcbiAgICAgICAgdXRpbC51YS53ZWJraXQgPSBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBuYXZpZ2F0b3IgJiYgL3dlYmtpdC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7XG4gICAgICAgIHV0aWwudWEuaURldmljZSA9IFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIG5hdmlnYXRvciAmJiAvaVBhZHxpUGhvbmV8aVBvZC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudClcbiAgICB9KShcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBpbyA/IGlvIDogbW9kdWxlLmV4cG9ydHMsIHRoaXMpO1xuICAgIChmdW5jdGlvbihleHBvcnRzLCBpbykge1xuICAgICAgICBleHBvcnRzLkV2ZW50RW1pdHRlciA9IEV2ZW50RW1pdHRlcjtcblxuICAgICAgICBmdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7fVxuICAgICAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uID0gZnVuY3Rpb24obmFtZSwgZm4pIHtcbiAgICAgICAgICAgIGlmICghdGhpcy4kZXZlbnRzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kZXZlbnRzID0ge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy4kZXZlbnRzW25hbWVdKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kZXZlbnRzW25hbWVdID0gZm5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGlvLnV0aWwuaXNBcnJheSh0aGlzLiRldmVudHNbbmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGV2ZW50c1tuYW1lXS5wdXNoKGZuKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGV2ZW50c1tuYW1lXSA9IFt0aGlzLiRldmVudHNbbmFtZV0sIGZuXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgIH07XG4gICAgICAgIEV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXIgPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uO1xuICAgICAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbihuYW1lLCBmbikge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnJlbW92ZUxpc3RlbmVyKG5hbWUsIG9uKTtcbiAgICAgICAgICAgICAgICBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvbi5saXN0ZW5lciA9IGZuO1xuICAgICAgICAgICAgdGhpcy5vbihuYW1lLCBvbik7XG4gICAgICAgICAgICByZXR1cm4gdGhpc1xuICAgICAgICB9O1xuICAgICAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24obmFtZSwgZm4pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLiRldmVudHMgJiYgdGhpcy4kZXZlbnRzW25hbWVdKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLiRldmVudHNbbmFtZV07XG4gICAgICAgICAgICAgICAgaWYgKGlvLnV0aWwuaXNBcnJheShsaXN0KSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gLTE7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gbGlzdC5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaXN0W2ldID09PSBmbiB8fCAobGlzdFtpXS5saXN0ZW5lciAmJiBsaXN0W2ldLmxpc3RlbmVyID09PSBmbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvcyA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGlzdC5zcGxpY2UocG9zLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFsaXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuJGV2ZW50c1tuYW1lXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3QgPT09IGZuIHx8IChsaXN0Lmxpc3RlbmVyICYmIGxpc3QubGlzdGVuZXIgPT09IGZuKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuJGV2ZW50c1tuYW1lXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgfTtcbiAgICAgICAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kZXZlbnRzID0ge307XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLiRldmVudHMgJiYgdGhpcy4kZXZlbnRzW25hbWVdKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kZXZlbnRzW25hbWVdID0gbnVsbFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgfTtcbiAgICAgICAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lcnMgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuJGV2ZW50cykge1xuICAgICAgICAgICAgICAgIHRoaXMuJGV2ZW50cyA9IHt9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMuJGV2ZW50c1tuYW1lXSkge1xuICAgICAgICAgICAgICAgIHRoaXMuJGV2ZW50c1tuYW1lXSA9IFtdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlvLnV0aWwuaXNBcnJheSh0aGlzLiRldmVudHNbbmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kZXZlbnRzW25hbWVdID0gW3RoaXMuJGV2ZW50c1tuYW1lXV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRldmVudHNbbmFtZV1cbiAgICAgICAgfTtcbiAgICAgICAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLiRldmVudHMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBoYW5kbGVyID0gdGhpcy4kZXZlbnRzW25hbWVdO1xuICAgICAgICAgICAgaWYgKCFoYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgICAgICAgICBpZiAoXCJmdW5jdGlvblwiID09IHR5cGVvZiBoYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoaW8udXRpbC5pc0FycmF5KGhhbmRsZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaXN0ZW5lcnMgPSBoYW5kbGVyLnNsaWNlKCk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gbGlzdGVuZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXJzW2ldLmFwcGx5KHRoaXMsIGFyZ3MpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9XG4gICAgfSkoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgaW8gPyBpbyA6IG1vZHVsZS5leHBvcnRzLCBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBpbyA/IGlvIDogbW9kdWxlLnBhcmVudC5leHBvcnRzKTtcbiAgICAoZnVuY3Rpb24oZXhwb3J0cywgbmF0aXZlSlNPTikge1xuICAgICAgICBpZiAobmF0aXZlSlNPTiAmJiBuYXRpdmVKU09OLnBhcnNlKSB7XG4gICAgICAgICAgICByZXR1cm4gZXhwb3J0cy5KU09OID0ge1xuICAgICAgICAgICAgICAgIHBhcnNlOiBuYXRpdmVKU09OLnBhcnNlLFxuICAgICAgICAgICAgICAgIHN0cmluZ2lmeTogbmF0aXZlSlNPTi5zdHJpbmdpZnlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgSlNPTiA9IGV4cG9ydHMuSlNPTiA9IHt9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGYobikge1xuICAgICAgICAgICAgcmV0dXJuIG4gPCAxMCA/IFwiMFwiICsgbiA6IG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGRhdGUoZCkge1xuICAgICAgICAgICAgcmV0dXJuIGlzRmluaXRlKGQudmFsdWVPZigpKSA/IGQuZ2V0VVRDRnVsbFllYXIoKSArIFwiLVwiICsgZihkLmdldFVUQ01vbnRoKCkgKyAxKSArIFwiLVwiICsgZihkLmdldFVUQ0RhdGUoKSkgKyBcIlRcIiArIGYoZC5nZXRVVENIb3VycygpKSArIFwiOlwiICsgZihkLmdldFVUQ01pbnV0ZXMoKSkgKyBcIjpcIiArIGYoZC5nZXRVVENTZWNvbmRzKCkpICsgXCJaXCIgOiBudWxsXG4gICAgICAgIH1cbiAgICAgICAgdmFyIGN4ID0gL1tcXHUwMDAwXFx1MDBhZFxcdTA2MDAtXFx1MDYwNFxcdTA3MGZcXHUxN2I0XFx1MTdiNVxcdTIwMGMtXFx1MjAwZlxcdTIwMjgtXFx1MjAyZlxcdTIwNjAtXFx1MjA2ZlxcdWZlZmZcXHVmZmYwLVxcdWZmZmZdL2csXG4gICAgICAgICAgICBlc2NhcGFibGUgPSAvW1xcXFxcXFwiXFx4MDAtXFx4MWZcXHg3Zi1cXHg5ZlxcdTAwYWRcXHUwNjAwLVxcdTA2MDRcXHUwNzBmXFx1MTdiNFxcdTE3YjVcXHUyMDBjLVxcdTIwMGZcXHUyMDI4LVxcdTIwMmZcXHUyMDYwLVxcdTIwNmZcXHVmZWZmXFx1ZmZmMC1cXHVmZmZmXS9nLFxuICAgICAgICAgICAgZ2FwLCBpbmRlbnQsIG1ldGEgPSB7XG4gICAgICAgICAgICAgICAgXCJcXGJcIjogXCJcXFxcYlwiLFxuICAgICAgICAgICAgICAgIFwiXFx0XCI6IFwiXFxcXHRcIixcbiAgICAgICAgICAgICAgICBcIlxcblwiOiBcIlxcXFxuXCIsXG4gICAgICAgICAgICAgICAgXCJcXGZcIjogXCJcXFxcZlwiLFxuICAgICAgICAgICAgICAgIFwiXFxyXCI6IFwiXFxcXHJcIixcbiAgICAgICAgICAgICAgICAnXCInOiAnXFxcXFwiJyxcbiAgICAgICAgICAgICAgICBcIlxcXFxcIjogXCJcXFxcXFxcXFwiXG4gICAgICAgICAgICB9LCByZXA7XG5cbiAgICAgICAgZnVuY3Rpb24gcXVvdGUoc3RyaW5nKSB7XG4gICAgICAgICAgICBlc2NhcGFibGUubGFzdEluZGV4ID0gMDtcbiAgICAgICAgICAgIHJldHVybiBlc2NhcGFibGUudGVzdChzdHJpbmcpID8gJ1wiJyArIHN0cmluZy5yZXBsYWNlKGVzY2FwYWJsZSwgZnVuY3Rpb24oYSkge1xuICAgICAgICAgICAgICAgIHZhciBjID0gbWV0YVthXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIGMgPT09IFwic3RyaW5nXCIgPyBjIDogXCJcXFxcdVwiICsgKFwiMDAwMFwiICsgYS5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTQpXG4gICAgICAgICAgICB9KSArICdcIicgOiAnXCInICsgc3RyaW5nICsgJ1wiJ1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3RyKGtleSwgaG9sZGVyKSB7XG4gICAgICAgICAgICB2YXIgaSwgaywgdiwgbGVuZ3RoLCBtaW5kID0gZ2FwLFxuICAgICAgICAgICAgICAgIHBhcnRpYWwsIHZhbHVlID0gaG9sZGVyW2tleV07XG4gICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBkYXRlKGtleSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVwID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHJlcC5jYWxsKGhvbGRlciwga2V5LCB2YWx1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcInN0cmluZ1wiOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcXVvdGUodmFsdWUpO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJudW1iZXJcIjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzRmluaXRlKHZhbHVlKSA/IFN0cmluZyh2YWx1ZSkgOiBcIm51bGxcIjtcbiAgICAgICAgICAgICAgICBjYXNlIFwiYm9vbGVhblwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJudWxsXCI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJvYmplY3RcIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwibnVsbFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZ2FwICs9IGluZGVudDtcbiAgICAgICAgICAgICAgICAgICAgcGFydGlhbCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5hcHBseSh2YWx1ZSkgPT09IFwiW29iamVjdCBBcnJheV1cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoID0gdmFsdWUubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydGlhbFtpXSA9IHN0cihpLCB2YWx1ZSkgfHwgXCJudWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHYgPSBwYXJ0aWFsLmxlbmd0aCA9PT0gMCA/IFwiW11cIiA6IGdhcCA/IFwiW1xcblwiICsgZ2FwICsgcGFydGlhbC5qb2luKFwiLFxcblwiICsgZ2FwKSArIFwiXFxuXCIgKyBtaW5kICsgXCJdXCIgOiBcIltcIiArIHBhcnRpYWwuam9pbihcIixcIikgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhcCA9IG1pbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXAgJiYgdHlwZW9mIHJlcCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoID0gcmVwLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVwW2ldID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsgPSByZXBbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYgPSBzdHIoaywgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydGlhbC5wdXNoKHF1b3RlKGspICsgKGdhcCA/IFwiOiBcIiA6IFwiOlwiKSArIHYpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGsgaW4gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCBrKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ID0gc3RyKGssIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWwucHVzaChxdW90ZShrKSArIChnYXAgPyBcIjogXCIgOiBcIjpcIikgKyB2KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHYgPSBwYXJ0aWFsLmxlbmd0aCA9PT0gMCA/IFwie31cIiA6IGdhcCA/IFwie1xcblwiICsgZ2FwICsgcGFydGlhbC5qb2luKFwiLFxcblwiICsgZ2FwKSArIFwiXFxuXCIgKyBtaW5kICsgXCJ9XCIgOiBcIntcIiArIHBhcnRpYWwuam9pbihcIixcIikgKyBcIn1cIjtcbiAgICAgICAgICAgICAgICAgICAgZ2FwID0gbWluZDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBKU09OLnN0cmluZ2lmeSA9IGZ1bmN0aW9uKHZhbHVlLCByZXBsYWNlciwgc3BhY2UpIHtcbiAgICAgICAgICAgIHZhciBpO1xuICAgICAgICAgICAgZ2FwID0gXCJcIjtcbiAgICAgICAgICAgIGluZGVudCA9IFwiXCI7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNwYWNlID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNwYWNlOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kZW50ICs9IFwiIFwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHNwYWNlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGVudCA9IHNwYWNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVwID0gcmVwbGFjZXI7XG4gICAgICAgICAgICBpZiAocmVwbGFjZXIgJiYgdHlwZW9mIHJlcGxhY2VyICE9PSBcImZ1bmN0aW9uXCIgJiYgKHR5cGVvZiByZXBsYWNlciAhPT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgcmVwbGFjZXIubGVuZ3RoICE9PSBcIm51bWJlclwiKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkpTT04uc3RyaW5naWZ5XCIpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc3RyKFwiXCIsIHtcbiAgICAgICAgICAgICAgICBcIlwiOiB2YWx1ZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgSlNPTi5wYXJzZSA9IGZ1bmN0aW9uKHRleHQsIHJldml2ZXIpIHtcbiAgICAgICAgICAgIHZhciBqO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB3YWxrKGhvbGRlciwga2V5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGssIHYsIHZhbHVlID0gaG9sZGVyW2tleV07XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGsgaW4gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodmFsdWUsIGspKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9IHdhbGsodmFsdWUsIGspO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVba10gPSB2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHZhbHVlW2tdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXZpdmVyLmNhbGwoaG9sZGVyLCBrZXksIHZhbHVlKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGV4dCA9IFN0cmluZyh0ZXh0KTtcbiAgICAgICAgICAgIGN4Lmxhc3RJbmRleCA9IDA7XG4gICAgICAgICAgICBpZiAoY3gudGVzdCh0ZXh0KSkge1xuICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoY3gsIGZ1bmN0aW9uKGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiXFxcXHVcIiArIChcIjAwMDBcIiArIGEuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC00KVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoL15bXFxdLDp7fVxcc10qJC8udGVzdCh0ZXh0LnJlcGxhY2UoL1xcXFwoPzpbXCJcXFxcXFwvYmZucnRdfHVbMC05YS1mQS1GXXs0fSkvZywgXCJAXCIpLnJlcGxhY2UoL1wiW15cIlxcXFxcXG5cXHJdKlwifHRydWV8ZmFsc2V8bnVsbHwtP1xcZCsoPzpcXC5cXGQqKT8oPzpbZUVdWytcXC1dP1xcZCspPy9nLCBcIl1cIikucmVwbGFjZSgvKD86Xnw6fCwpKD86XFxzKlxcWykrL2csIFwiXCIpKSkge1xuICAgICAgICAgICAgICAgIGogPSBldmFsKFwiKFwiICsgdGV4dCArIFwiKVwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIHJldml2ZXIgPT09IFwiZnVuY3Rpb25cIiA/IHdhbGsoe1xuICAgICAgICAgICAgICAgICAgICBcIlwiOiBqXG4gICAgICAgICAgICAgICAgfSwgXCJcIikgOiBqXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoXCJKU09OLnBhcnNlXCIpXG4gICAgICAgIH1cbiAgICB9KShcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBpbyA/IGlvIDogbW9kdWxlLmV4cG9ydHMsIHR5cGVvZiBKU09OICE9PSBcInVuZGVmaW5lZFwiID8gSlNPTiA6IHVuZGVmaW5lZCk7XG4gICAgKGZ1bmN0aW9uKGV4cG9ydHMsIGlvKSB7XG4gICAgICAgIHZhciBwYXJzZXIgPSBleHBvcnRzLnBhcnNlciA9IHt9O1xuICAgICAgICB2YXIgcGFja2V0cyA9IHBhcnNlci5wYWNrZXRzID0gW1wiZGlzY29ubmVjdFwiLCBcImNvbm5lY3RcIiwgXCJoZWFydGJlYXRcIiwgXCJtZXNzYWdlXCIsIFwianNvblwiLCBcImV2ZW50XCIsIFwiYWNrXCIsIFwiZXJyb3JcIiwgXCJub29wXCJdO1xuICAgICAgICB2YXIgcmVhc29ucyA9IHBhcnNlci5yZWFzb25zID0gW1widHJhbnNwb3J0IG5vdCBzdXBwb3J0ZWRcIiwgXCJjbGllbnQgbm90IGhhbmRzaGFrZW5cIiwgXCJ1bmF1dGhvcml6ZWRcIl07XG4gICAgICAgIHZhciBhZHZpY2UgPSBwYXJzZXIuYWR2aWNlID0gW1wicmVjb25uZWN0XCJdO1xuICAgICAgICB2YXIgSlNPTiA9IGlvLkpTT04sXG4gICAgICAgICAgICBpbmRleE9mID0gaW8udXRpbC5pbmRleE9mO1xuICAgICAgICBwYXJzZXIuZW5jb2RlUGFja2V0ID0gZnVuY3Rpb24ocGFja2V0KSB7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IGluZGV4T2YocGFja2V0cywgcGFja2V0LnR5cGUpLFxuICAgICAgICAgICAgICAgIGlkID0gcGFja2V0LmlkIHx8IFwiXCIsXG4gICAgICAgICAgICAgICAgZW5kcG9pbnQgPSBwYWNrZXQuZW5kcG9pbnQgfHwgXCJcIixcbiAgICAgICAgICAgICAgICBhY2sgPSBwYWNrZXQuYWNrLFxuICAgICAgICAgICAgICAgIGRhdGEgPSBudWxsO1xuICAgICAgICAgICAgc3dpdGNoIChwYWNrZXQudHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJlcnJvclwiOlxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVhc29uID0gcGFja2V0LnJlYXNvbiA/IGluZGV4T2YocmVhc29ucywgcGFja2V0LnJlYXNvbikgOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWR2ID0gcGFja2V0LmFkdmljZSA/IGluZGV4T2YoYWR2aWNlLCBwYWNrZXQuYWR2aWNlKSA6IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWFzb24gIT09IFwiXCIgfHwgYWR2ICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gcmVhc29uICsgKGFkdiAhPT0gXCJcIiA/IChcIitcIiArIGFkdikgOiBcIlwiKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJtZXNzYWdlXCI6XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYWNrZXQuZGF0YSAhPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHBhY2tldC5kYXRhXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImV2ZW50XCI6XG4gICAgICAgICAgICAgICAgICAgIHZhciBldiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHBhY2tldC5uYW1lXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYWNrZXQuYXJncyAmJiBwYWNrZXQuYXJncy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2LmFyZ3MgPSBwYWNrZXQuYXJnc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBKU09OLnN0cmluZ2lmeShldik7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJqc29uXCI6XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBKU09OLnN0cmluZ2lmeShwYWNrZXQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJjb25uZWN0XCI6XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYWNrZXQucXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBwYWNrZXQucXNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiYWNrXCI6XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBwYWNrZXQuYWNrSWQgKyAocGFja2V0LmFyZ3MgJiYgcGFja2V0LmFyZ3MubGVuZ3RoID8gXCIrXCIgKyBKU09OLnN0cmluZ2lmeShwYWNrZXQuYXJncykgOiBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBlbmNvZGVkID0gW3R5cGUsIGlkICsgKGFjayA9PSBcImRhdGFcIiA/IFwiK1wiIDogXCJcIiksIGVuZHBvaW50XTtcbiAgICAgICAgICAgIGlmIChkYXRhICE9PSBudWxsICYmIGRhdGEgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGVuY29kZWQucHVzaChkYXRhKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGVuY29kZWQuam9pbihcIjpcIilcbiAgICAgICAgfTtcbiAgICAgICAgcGFyc2VyLmVuY29kZVBheWxvYWQgPSBmdW5jdGlvbihwYWNrZXRzKSB7XG4gICAgICAgICAgICB2YXIgZGVjb2RlZCA9IFwiXCI7XG4gICAgICAgICAgICBpZiAocGFja2V0cy5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYWNrZXRzWzBdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHBhY2tldHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhY2tldCA9IHBhY2tldHNbaV07XG4gICAgICAgICAgICAgICAgZGVjb2RlZCArPSBcIlxcdWZmZmRcIiArIHBhY2tldC5sZW5ndGggKyBcIlxcdWZmZmRcIiArIHBhY2tldHNbaV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBkZWNvZGVkXG4gICAgICAgIH07XG4gICAgICAgIHZhciByZWdleHAgPSAvKFteOl0rKTooWzAtOV0rKT8oXFwrKT86KFteOl0rKT86PyhbXFxzXFxTXSopPy87XG4gICAgICAgIHBhcnNlci5kZWNvZGVQYWNrZXQgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICB2YXIgcGllY2VzID0gZGF0YS5tYXRjaChyZWdleHApO1xuICAgICAgICAgICAgaWYgKCFwaWVjZXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpZCA9IHBpZWNlc1syXSB8fCBcIlwiLFxuICAgICAgICAgICAgICAgIGRhdGEgPSBwaWVjZXNbNV0gfHwgXCJcIixcbiAgICAgICAgICAgICAgICBwYWNrZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHBhY2tldHNbcGllY2VzWzFdXSxcbiAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6IHBpZWNlc1s0XSB8fCBcIlwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChpZCkge1xuICAgICAgICAgICAgICAgIHBhY2tldC5pZCA9IGlkO1xuICAgICAgICAgICAgICAgIGlmIChwaWVjZXNbM10pIHtcbiAgICAgICAgICAgICAgICAgICAgcGFja2V0LmFjayA9IFwiZGF0YVwiXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcGFja2V0LmFjayA9IHRydWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKHBhY2tldC50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcImVycm9yXCI6XG4gICAgICAgICAgICAgICAgICAgIHZhciBwaWVjZXMgPSBkYXRhLnNwbGl0KFwiK1wiKTtcbiAgICAgICAgICAgICAgICAgICAgcGFja2V0LnJlYXNvbiA9IHJlYXNvbnNbcGllY2VzWzBdXSB8fCBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBwYWNrZXQuYWR2aWNlID0gYWR2aWNlW3BpZWNlc1sxXV0gfHwgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIm1lc3NhZ2VcIjpcbiAgICAgICAgICAgICAgICAgICAgcGFja2V0LmRhdGEgPSBkYXRhIHx8IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJldmVudFwiOlxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9wdHMgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFja2V0Lm5hbWUgPSBvcHRzLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYWNrZXQuYXJncyA9IG9wdHMuYXJnc1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICAgICAgICAgICAgICBwYWNrZXQuYXJncyA9IHBhY2tldC5hcmdzIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwianNvblwiOlxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFja2V0LmRhdGEgPSBKU09OLnBhcnNlKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJjb25uZWN0XCI6XG4gICAgICAgICAgICAgICAgICAgIHBhY2tldC5xcyA9IGRhdGEgfHwgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImFja1wiOlxuICAgICAgICAgICAgICAgICAgICB2YXIgcGllY2VzID0gZGF0YS5tYXRjaCgvXihbMC05XSspKFxcKyk/KC4qKS8pO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGllY2VzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYWNrZXQuYWNrSWQgPSBwaWVjZXNbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBwYWNrZXQuYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpZWNlc1szXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhY2tldC5hcmdzID0gcGllY2VzWzNdID8gSlNPTi5wYXJzZShwaWVjZXNbM10pIDogW11cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJkaXNjb25uZWN0XCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcImhlYXJ0YmVhdFwiOlxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBhY2tldFxuICAgICAgICB9O1xuICAgICAgICBwYXJzZXIuZGVjb2RlUGF5bG9hZCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhLmNoYXJBdCgwKSA9PSBcIlxcdWZmZmRcIikge1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMSwgbGVuZ3RoID0gXCJcIjsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY2hhckF0KGkpID09IFwiXFx1ZmZmZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXQucHVzaChwYXJzZXIuZGVjb2RlUGFja2V0KGRhdGEuc3Vic3RyKGkgKyAxKS5zdWJzdHIoMCwgbGVuZ3RoKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaSArPSBOdW1iZXIobGVuZ3RoKSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGggPSBcIlwiXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGggKz0gZGF0YS5jaGFyQXQoaSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBbcGFyc2VyLmRlY29kZVBhY2tldChkYXRhKV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pKFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGlvID8gaW8gOiBtb2R1bGUuZXhwb3J0cywgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgaW8gPyBpbyA6IG1vZHVsZS5wYXJlbnQuZXhwb3J0cyk7XG4gICAgKGZ1bmN0aW9uKGV4cG9ydHMsIGlvKSB7XG4gICAgICAgIGV4cG9ydHMuVHJhbnNwb3J0ID0gVHJhbnNwb3J0O1xuXG4gICAgICAgIGZ1bmN0aW9uIFRyYW5zcG9ydChzb2NrZXQsIHNlc3NpZCkge1xuICAgICAgICAgICAgdGhpcy5zb2NrZXQgPSBzb2NrZXQ7XG4gICAgICAgICAgICB0aGlzLnNlc3NpZCA9IHNlc3NpZFxuICAgICAgICB9XG4gICAgICAgIGlvLnV0aWwubWl4aW4oVHJhbnNwb3J0LCBpby5FdmVudEVtaXR0ZXIpO1xuICAgICAgICBUcmFuc3BvcnQucHJvdG90eXBlLmhlYXJ0YmVhdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH07XG4gICAgICAgIFRyYW5zcG9ydC5wcm90b3R5cGUub25EYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5jbGVhckNsb3NlVGltZW91dCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc29ja2V0LmNvbm5lY3RlZCB8fCB0aGlzLnNvY2tldC5jb25uZWN0aW5nIHx8IHRoaXMuc29ja2V0LnJlY29ubmVjdGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0Q2xvc2VUaW1lb3V0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkYXRhICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1zZ3MgPSBpby5wYXJzZXIuZGVjb2RlUGF5bG9hZChkYXRhKTtcbiAgICAgICAgICAgICAgICBpZiAobXNncyAmJiBtc2dzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IG1zZ3MubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uUGFja2V0KG1zZ3NbaV0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpc1xuICAgICAgICB9O1xuICAgICAgICBUcmFuc3BvcnQucHJvdG90eXBlLm9uUGFja2V0ID0gZnVuY3Rpb24ocGFja2V0KSB7XG4gICAgICAgICAgICB0aGlzLnNvY2tldC5zZXRIZWFydGJlYXRUaW1lb3V0KCk7XG4gICAgICAgICAgICBpZiAocGFja2V0LnR5cGUgPT0gXCJoZWFydGJlYXRcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9uSGVhcnRiZWF0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYWNrZXQudHlwZSA9PSBcImNvbm5lY3RcIiAmJiBwYWNrZXQuZW5kcG9pbnQgPT0gXCJcIikge1xuICAgICAgICAgICAgICAgIHRoaXMub25Db25uZWN0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYWNrZXQudHlwZSA9PSBcImVycm9yXCIgJiYgcGFja2V0LmFkdmljZSA9PSBcInJlY29ubmVjdFwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc09wZW4gPSBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zb2NrZXQub25QYWNrZXQocGFja2V0KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgIH07XG4gICAgICAgIFRyYW5zcG9ydC5wcm90b3R5cGUuc2V0Q2xvc2VUaW1lb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2xvc2VUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbkRpc2Nvbm5lY3QoKVxuICAgICAgICAgICAgICAgIH0sIHRoaXMuc29ja2V0LmNsb3NlVGltZW91dClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVHJhbnNwb3J0LnByb3RvdHlwZS5vbkRpc2Nvbm5lY3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzT3Blbikge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jbGVhclRpbWVvdXRzKCk7XG4gICAgICAgICAgICB0aGlzLnNvY2tldC5vbkRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgIH07XG4gICAgICAgIFRyYW5zcG9ydC5wcm90b3R5cGUub25Db25uZWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnNvY2tldC5vbkNvbm5lY3QoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgIH07XG4gICAgICAgIFRyYW5zcG9ydC5wcm90b3R5cGUuY2xlYXJDbG9zZVRpbWVvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNsb3NlVGltZW91dCkge1xuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmNsb3NlVGltZW91dCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZVRpbWVvdXQgPSBudWxsXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFRyYW5zcG9ydC5wcm90b3R5cGUuY2xlYXJUaW1lb3V0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5jbGVhckNsb3NlVGltZW91dCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMucmVvcGVuVGltZW91dCkge1xuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnJlb3BlblRpbWVvdXQpXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFRyYW5zcG9ydC5wcm90b3R5cGUucGFja2V0ID0gZnVuY3Rpb24ocGFja2V0KSB7XG4gICAgICAgICAgICB0aGlzLnNlbmQoaW8ucGFyc2VyLmVuY29kZVBhY2tldChwYWNrZXQpKVxuICAgICAgICB9O1xuICAgICAgICBUcmFuc3BvcnQucHJvdG90eXBlLm9uSGVhcnRiZWF0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnBhY2tldCh7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJoZWFydGJlYXRcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgVHJhbnNwb3J0LnByb3RvdHlwZS5vbk9wZW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJDbG9zZVRpbWVvdXQoKTtcbiAgICAgICAgICAgIHRoaXMuc29ja2V0Lm9uT3BlbigpXG4gICAgICAgIH07XG4gICAgICAgIFRyYW5zcG9ydC5wcm90b3R5cGUub25DbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuc29ja2V0Lm9uQ2xvc2UoKTtcbiAgICAgICAgICAgIHRoaXMub25EaXNjb25uZWN0KClcbiAgICAgICAgfTtcbiAgICAgICAgVHJhbnNwb3J0LnByb3RvdHlwZS5wcmVwYXJlVXJsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMuc29ja2V0Lm9wdGlvbnM7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zY2hlbWUoKSArIFwiOi8vXCIgKyBvcHRpb25zLmhvc3QgKyBcIjpcIiArIG9wdGlvbnMucG9ydCArIFwiL1wiICsgb3B0aW9ucy5yZXNvdXJjZSArIFwiL1wiICsgaW8ucHJvdG9jb2wgKyBcIi9cIiArIHRoaXMubmFtZSArIFwiL1wiICsgdGhpcy5zZXNzaWRcbiAgICAgICAgfTtcbiAgICAgICAgVHJhbnNwb3J0LnByb3RvdHlwZS5yZWFkeSA9IGZ1bmN0aW9uKHNvY2tldCwgZm4pIHtcbiAgICAgICAgICAgIGZuLmNhbGwodGhpcylcbiAgICAgICAgfVxuICAgIH0pKFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGlvID8gaW8gOiBtb2R1bGUuZXhwb3J0cywgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgaW8gPyBpbyA6IG1vZHVsZS5wYXJlbnQuZXhwb3J0cyk7XG4gICAgKGZ1bmN0aW9uKGV4cG9ydHMsIGlvLCBnbG9iYWwpIHtcbiAgICAgICAgZXhwb3J0cy5Tb2NrZXQgPSBTb2NrZXQ7XG5cbiAgICAgICAgZnVuY3Rpb24gU29ja2V0KG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBwb3J0OiA4MCxcbiAgICAgICAgICAgICAgICBzZWN1cmU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGRvY3VtZW50OiBcImRvY3VtZW50XCIgaW4gZ2xvYmFsID8gZG9jdW1lbnQgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZXNvdXJjZTogXCJzb2NrZXQuaW9cIixcbiAgICAgICAgICAgICAgICB0cmFuc3BvcnRzOiBpby50cmFuc3BvcnRzLFxuICAgICAgICAgICAgICAgIFwiY29ubmVjdCB0aW1lb3V0XCI6IDEwMDAwLFxuICAgICAgICAgICAgICAgIFwidHJ5IG11bHRpcGxlIHRyYW5zcG9ydHNcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlY29ubmVjdFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVjb25uZWN0aW9uIGRlbGF5XCI6IDUwMCxcbiAgICAgICAgICAgICAgICBcInJlY29ubmVjdGlvbiBsaW1pdFwiOiBJbmZpbml0eSxcbiAgICAgICAgICAgICAgICBcInJlb3BlbiBkZWxheVwiOiAzMDAwLFxuICAgICAgICAgICAgICAgIFwibWF4IHJlY29ubmVjdGlvbiBhdHRlbXB0c1wiOiAxMCxcbiAgICAgICAgICAgICAgICBcInN5bmMgZGlzY29ubmVjdCBvbiB1bmxvYWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgXCJhdXRvIGNvbm5lY3RcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcImZsYXNoIHBvbGljeSBwb3J0XCI6IDEwODQzLFxuICAgICAgICAgICAgICAgIFwibWFudWFsRmx1c2hcIjogZmFsc2VcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpby51dGlsLm1lcmdlKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5vcGVuID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMucmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm5hbWVzcGFjZXMgPSB7fTtcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyID0gW107XG4gICAgICAgICAgICB0aGlzLmRvQnVmZmVyID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zW1wic3luYyBkaXNjb25uZWN0IG9uIHVubG9hZFwiXSAmJiAoIXRoaXMuaXNYRG9tYWluKCkgfHwgaW8udXRpbC51YS5oYXNDT1JTKSkge1xuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICBpby51dGlsLm9uKGdsb2JhbCwgXCJiZWZvcmV1bmxvYWRcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzY29ubmVjdFN5bmMoKVxuICAgICAgICAgICAgICAgIH0sIGZhbHNlKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9uc1tcImF1dG8gY29ubmVjdFwiXSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29ubmVjdCgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaW8udXRpbC5taXhpbihTb2NrZXQsIGlvLkV2ZW50RW1pdHRlcik7XG4gICAgICAgIFNvY2tldC5wcm90b3R5cGUub2YgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMubmFtZXNwYWNlc1tuYW1lXSkge1xuICAgICAgICAgICAgICAgIHRoaXMubmFtZXNwYWNlc1tuYW1lXSA9IG5ldyBpby5Tb2NrZXROYW1lc3BhY2UodGhpcywgbmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUgIT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYW1lc3BhY2VzW25hbWVdLnBhY2tldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImNvbm5lY3RcIlxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWVzcGFjZXNbbmFtZV1cbiAgICAgICAgfTtcbiAgICAgICAgU29ja2V0LnByb3RvdHlwZS5wdWJsaXNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIHZhciBuc3A7XG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMubmFtZXNwYWNlcykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWVzcGFjZXMuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbnNwID0gdGhpcy5vZihpKTtcbiAgICAgICAgICAgICAgICAgICAgbnNwLiRlbWl0LmFwcGx5KG5zcCwgYXJndW1lbnRzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBlbXB0eSgpIHt9XG4gICAgICAgIFNvY2tldC5wcm90b3R5cGUuaGFuZHNoYWtlID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcyxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBjb21wbGV0ZShkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbkVycm9yKGRhdGEubWVzc2FnZSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmbi5hcHBseShudWxsLCBkYXRhLnNwbGl0KFwiOlwiKSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdXJsID0gW1wiaHR0cFwiICsgKG9wdGlvbnMuc2VjdXJlID8gXCJzXCIgOiBcIlwiKSArIFwiOi9cIiwgb3B0aW9ucy5ob3N0ICsgXCI6XCIgKyBvcHRpb25zLnBvcnQsIG9wdGlvbnMucmVzb3VyY2UsIGlvLnByb3RvY29sLCBpby51dGlsLnF1ZXJ5KHRoaXMub3B0aW9ucy5xdWVyeSwgXCJ0PVwiICsgK25ldyBEYXRlKV0uam9pbihcIi9cIik7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1hEb21haW4oKSAmJiAhaW8udXRpbC51YS5oYXNDT1JTKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluc2VydEF0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIilbMF0sXG4gICAgICAgICAgICAgICAgICAgIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG4gICAgICAgICAgICAgICAgc2NyaXB0LnNyYyA9IHVybCArIFwiJmpzb25wPVwiICsgaW8uai5sZW5ndGg7XG4gICAgICAgICAgICAgICAgaW5zZXJ0QXQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2NyaXB0LCBpbnNlcnRBdCk7XG4gICAgICAgICAgICAgICAgaW8uai5wdXNoKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHNjcmlwdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNjcmlwdClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgeGhyID0gaW8udXRpbC5yZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgeGhyLm9wZW4oXCJHRVRcIiwgdXJsLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1hEb21haW4oKSkge1xuICAgICAgICAgICAgICAgICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZW1wdHk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZSh4aHIucmVzcG9uc2VUZXh0KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PSA0MDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5vbkVycm9yKHhoci5yZXNwb25zZVRleHQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFzZWxmLnJlY29ubmVjdGluZyAmJiBzZWxmLm9uRXJyb3IoeGhyLnJlc3BvbnNlVGV4dClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHhoci5zZW5kKG51bGwpXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFNvY2tldC5wcm90b3R5cGUuZ2V0VHJhbnNwb3J0ID0gZnVuY3Rpb24ob3ZlcnJpZGUpIHtcbiAgICAgICAgICAgIHZhciB0cmFuc3BvcnRzID0gb3ZlcnJpZGUgfHwgdGhpcy50cmFuc3BvcnRzO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIHRyYW5zcG9ydDsgdHJhbnNwb3J0ID0gdHJhbnNwb3J0c1tpXTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlvLlRyYW5zcG9ydFt0cmFuc3BvcnRdICYmIGlvLlRyYW5zcG9ydFt0cmFuc3BvcnRdLmNoZWNrKHRoaXMpICYmICghdGhpcy5pc1hEb21haW4oKSB8fCBpby5UcmFuc3BvcnRbdHJhbnNwb3J0XS54ZG9tYWluQ2hlY2sodGhpcykpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgaW8uVHJhbnNwb3J0W3RyYW5zcG9ydF0odGhpcywgdGhpcy5zZXNzaW9uaWQpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgU29ja2V0LnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbm5lY3RpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgc2VsZi5jb25uZWN0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuaGFuZHNoYWtlKGZ1bmN0aW9uKHNpZCwgaGVhcnRiZWF0LCBjbG9zZSwgdHJhbnNwb3J0cykge1xuICAgICAgICAgICAgICAgIHNlbGYuc2Vzc2lvbmlkID0gc2lkO1xuICAgICAgICAgICAgICAgIHNlbGYuY2xvc2VUaW1lb3V0ID0gY2xvc2UgKiAxMDAwO1xuICAgICAgICAgICAgICAgIHNlbGYuaGVhcnRiZWF0VGltZW91dCA9IGhlYXJ0YmVhdCAqIDEwMDA7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLnRyYW5zcG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi50cmFuc3BvcnRzID0gc2VsZi5vcmlnVHJhbnNwb3J0cyA9ICh0cmFuc3BvcnRzID8gaW8udXRpbC5pbnRlcnNlY3QodHJhbnNwb3J0cy5zcGxpdChcIixcIiksIHNlbGYub3B0aW9ucy50cmFuc3BvcnRzKSA6IHNlbGYub3B0aW9ucy50cmFuc3BvcnRzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxmLnNldEhlYXJ0YmVhdFRpbWVvdXQoKTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbm5lY3QodHJhbnNwb3J0cykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi50cmFuc3BvcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudHJhbnNwb3J0LmNsZWFyVGltZW91dHMoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNlbGYudHJhbnNwb3J0ID0gc2VsZi5nZXRUcmFuc3BvcnQodHJhbnNwb3J0cyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghc2VsZi50cmFuc3BvcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnB1Ymxpc2goXCJjb25uZWN0X2ZhaWxlZFwiKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNlbGYudHJhbnNwb3J0LnJlYWR5KHNlbGYsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25uZWN0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucHVibGlzaChcImNvbm5lY3RpbmdcIiwgc2VsZi50cmFuc3BvcnQubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnRyYW5zcG9ydC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zW1wiY29ubmVjdCB0aW1lb3V0XCJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25uZWN0VGltZW91dFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWxmLmNvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zW1widHJ5IG11bHRpcGxlIHRyYW5zcG9ydHNcIl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtYWluaW5nID0gc2VsZi50cmFuc3BvcnRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChyZW1haW5pbmcubGVuZ3RoID4gMCAmJiByZW1haW5pbmcuc3BsaWNlKDAsIDEpWzBdICE9IHNlbGYudHJhbnNwb3J0Lm5hbWUpIHt9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbWFpbmluZy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdChyZW1haW5pbmcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wdWJsaXNoKFwiY29ubmVjdF9mYWlsZWRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBzZWxmLm9wdGlvbnNbXCJjb25uZWN0IHRpbWVvdXRcIl0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbm5lY3Qoc2VsZi50cmFuc3BvcnRzKTtcbiAgICAgICAgICAgICAgICBzZWxmLm9uY2UoXCJjb25uZWN0XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoc2VsZi5jb25uZWN0VGltZW91dFRpbWVyKTtcbiAgICAgICAgICAgICAgICAgICAgZm4gJiYgdHlwZW9mIGZuID09IFwiZnVuY3Rpb25cIiAmJiBmbigpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgfTtcbiAgICAgICAgU29ja2V0LnByb3RvdHlwZS5zZXRIZWFydGJlYXRUaW1lb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5oZWFydGJlYXRUaW1lb3V0VGltZXIpO1xuICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNwb3J0ICYmICF0aGlzLnRyYW5zcG9ydC5oZWFydGJlYXRzKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuaGVhcnRiZWF0VGltZW91dFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnRyYW5zcG9ydC5vbkNsb3NlKClcbiAgICAgICAgICAgIH0sIHRoaXMuaGVhcnRiZWF0VGltZW91dClcbiAgICAgICAgfTtcbiAgICAgICAgU29ja2V0LnByb3RvdHlwZS5wYWNrZXQgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jb25uZWN0ZWQgJiYgIXRoaXMuZG9CdWZmZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5wYWNrZXQoZGF0YSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5idWZmZXIucHVzaChkYXRhKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgfTtcbiAgICAgICAgU29ja2V0LnByb3RvdHlwZS5zZXRCdWZmZXIgPSBmdW5jdGlvbih2KSB7XG4gICAgICAgICAgICB0aGlzLmRvQnVmZmVyID0gdjtcbiAgICAgICAgICAgIGlmICghdiAmJiB0aGlzLmNvbm5lY3RlZCAmJiB0aGlzLmJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMub3B0aW9uc1tcIm1hbnVhbEZsdXNoXCJdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmx1c2hCdWZmZXIoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgU29ja2V0LnByb3RvdHlwZS5mbHVzaEJ1ZmZlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy50cmFuc3BvcnQucGF5bG9hZCh0aGlzLmJ1ZmZlcik7XG4gICAgICAgICAgICB0aGlzLmJ1ZmZlciA9IFtdXG4gICAgICAgIH07XG4gICAgICAgIFNvY2tldC5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkIHx8IHRoaXMuY29ubmVjdGluZykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vZihcIlwiKS5wYWNrZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJkaXNjb25uZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5vbkRpc2Nvbm5lY3QoXCJib290ZWRcIilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgIH07XG4gICAgICAgIFNvY2tldC5wcm90b3R5cGUuZGlzY29ubmVjdFN5bmMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB4aHIgPSBpby51dGlsLnJlcXVlc3QoKTtcbiAgICAgICAgICAgIHZhciB1cmkgPSBbXCJodHRwXCIgKyAodGhpcy5vcHRpb25zLnNlY3VyZSA/IFwic1wiIDogXCJcIikgKyBcIjovXCIsIHRoaXMub3B0aW9ucy5ob3N0ICsgXCI6XCIgKyB0aGlzLm9wdGlvbnMucG9ydCwgdGhpcy5vcHRpb25zLnJlc291cmNlLCBpby5wcm90b2NvbCwgXCJcIiwgdGhpcy5zZXNzaW9uaWRdLmpvaW4oXCIvXCIpICsgXCIvP2Rpc2Nvbm5lY3Q9MVwiO1xuICAgICAgICAgICAgeGhyLm9wZW4oXCJHRVRcIiwgdXJpLCBmYWxzZSk7XG4gICAgICAgICAgICB4aHIuc2VuZChudWxsKTtcbiAgICAgICAgICAgIHRoaXMub25EaXNjb25uZWN0KFwiYm9vdGVkXCIpXG4gICAgICAgIH07XG4gICAgICAgIFNvY2tldC5wcm90b3R5cGUuaXNYRG9tYWluID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgcG9ydCA9IGdsb2JhbC5sb2NhdGlvbi5wb3J0IHx8IChcImh0dHBzOlwiID09IGdsb2JhbC5sb2NhdGlvbi5wcm90b2NvbCA/IDQ0MyA6IDgwKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuaG9zdCAhPT0gZ2xvYmFsLmxvY2F0aW9uLmhvc3RuYW1lIHx8IHRoaXMub3B0aW9ucy5wb3J0ICE9IHBvcnRcbiAgICAgICAgfTtcbiAgICAgICAgU29ja2V0LnByb3RvdHlwZS5vbkNvbm5lY3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRvQnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QnVmZmVyKGZhbHNlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoXCJjb25uZWN0XCIpXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFNvY2tldC5wcm90b3R5cGUub25PcGVuID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLm9wZW4gPSB0cnVlXG4gICAgICAgIH07XG4gICAgICAgIFNvY2tldC5wcm90b3R5cGUub25DbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5vcGVuID0gZmFsc2U7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5oZWFydGJlYXRUaW1lb3V0VGltZXIpXG4gICAgICAgIH07XG4gICAgICAgIFNvY2tldC5wcm90b3R5cGUub25QYWNrZXQgPSBmdW5jdGlvbihwYWNrZXQpIHtcbiAgICAgICAgICAgIHRoaXMub2YocGFja2V0LmVuZHBvaW50KS5vblBhY2tldChwYWNrZXQpXG4gICAgICAgIH07XG4gICAgICAgIFNvY2tldC5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgaWYgKGVyciAmJiBlcnIuYWR2aWNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVyci5hZHZpY2UgPT09IFwicmVjb25uZWN0XCIgJiYgKHRoaXMuY29ubmVjdGVkIHx8IHRoaXMuY29ubmVjdGluZykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMucmVjb25uZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY29ubmVjdCgpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnB1Ymxpc2goXCJlcnJvclwiLCBlcnIgJiYgZXJyLnJlYXNvbiA/IGVyci5yZWFzb24gOiBlcnIpXG4gICAgICAgIH07XG4gICAgICAgIFNvY2tldC5wcm90b3R5cGUub25EaXNjb25uZWN0ID0gZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgICB2YXIgd2FzQ29ubmVjdGVkID0gdGhpcy5jb25uZWN0ZWQsXG4gICAgICAgICAgICAgICAgd2FzQ29ubmVjdGluZyA9IHRoaXMuY29ubmVjdGluZztcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMub3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHdhc0Nvbm5lY3RlZCB8fCB3YXNDb25uZWN0aW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmFuc3BvcnQuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5jbGVhclRpbWVvdXRzKCk7XG4gICAgICAgICAgICAgICAgaWYgKHdhc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnB1Ymxpc2goXCJkaXNjb25uZWN0XCIsIHJlYXNvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcImJvb3RlZFwiICE9IHJlYXNvbiAmJiB0aGlzLm9wdGlvbnMucmVjb25uZWN0ICYmICF0aGlzLnJlY29ubmVjdGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNvbm5lY3QoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBTb2NrZXQucHJvdG90eXBlLnJlY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5yZWNvbm5lY3RpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5yZWNvbm5lY3Rpb25BdHRlbXB0cyA9IDA7XG4gICAgICAgICAgICB0aGlzLnJlY29ubmVjdGlvbkRlbGF5ID0gdGhpcy5vcHRpb25zW1wicmVjb25uZWN0aW9uIGRlbGF5XCJdO1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgICAgICAgICAgIG1heEF0dGVtcHRzID0gdGhpcy5vcHRpb25zW1wibWF4IHJlY29ubmVjdGlvbiBhdHRlbXB0c1wiXSxcbiAgICAgICAgICAgICAgICB0cnlNdWx0aXBsZSA9IHRoaXMub3B0aW9uc1tcInRyeSBtdWx0aXBsZSB0cmFuc3BvcnRzXCJdLFxuICAgICAgICAgICAgICAgIGxpbWl0ID0gdGhpcy5vcHRpb25zW1wicmVjb25uZWN0aW9uIGxpbWl0XCJdO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBzZWxmLm5hbWVzcGFjZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm5hbWVzcGFjZXMuaGFzT3duUHJvcGVydHkoaSkgJiYgXCJcIiAhPT0gaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubmFtZXNwYWNlc1tpXS5wYWNrZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImNvbm5lY3RcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2VsZi5wdWJsaXNoKFwicmVjb25uZWN0XCIsIHNlbGYudHJhbnNwb3J0Lm5hbWUsIHNlbGYucmVjb25uZWN0aW9uQXR0ZW1wdHMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChzZWxmLnJlY29ubmVjdGlvblRpbWVyKTtcbiAgICAgICAgICAgICAgICBzZWxmLnJlbW92ZUxpc3RlbmVyKFwiY29ubmVjdF9mYWlsZWRcIiwgbWF5YmVSZWNvbm5lY3QpO1xuICAgICAgICAgICAgICAgIHNlbGYucmVtb3ZlTGlzdGVuZXIoXCJjb25uZWN0XCIsIG1heWJlUmVjb25uZWN0KTtcbiAgICAgICAgICAgICAgICBzZWxmLnJlY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBzZWxmLnJlY29ubmVjdGlvbkF0dGVtcHRzO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBzZWxmLnJlY29ubmVjdGlvbkRlbGF5O1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBzZWxmLnJlY29ubmVjdGlvblRpbWVyO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBzZWxmLnJlZG9UcmFuc3BvcnRzO1xuICAgICAgICAgICAgICAgIHNlbGYub3B0aW9uc1tcInRyeSBtdWx0aXBsZSB0cmFuc3BvcnRzXCJdID0gdHJ5TXVsdGlwbGVcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gbWF5YmVSZWNvbm5lY3QoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLnJlY29ubmVjdGluZykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNldCgpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNvbm5lY3RpbmcgJiYgc2VsZi5yZWNvbm5lY3RpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYucmVjb25uZWN0aW9uVGltZXIgPSBzZXRUaW1lb3V0KG1heWJlUmVjb25uZWN0LCAxMDAwKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5yZWNvbm5lY3Rpb25BdHRlbXB0cysrID49IG1heEF0dGVtcHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghc2VsZi5yZWRvVHJhbnNwb3J0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5vbihcImNvbm5lY3RfZmFpbGVkXCIsIG1heWJlUmVjb25uZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYub3B0aW9uc1tcInRyeSBtdWx0aXBsZSB0cmFuc3BvcnRzXCJdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudHJhbnNwb3J0cyA9IHNlbGYub3JpZ1RyYW5zcG9ydHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnRyYW5zcG9ydCA9IHNlbGYuZ2V0VHJhbnNwb3J0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlZG9UcmFuc3BvcnRzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY29ubmVjdCgpXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnB1Ymxpc2goXCJyZWNvbm5lY3RfZmFpbGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzZXQoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYucmVjb25uZWN0aW9uRGVsYXkgPCBsaW1pdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWNvbm5lY3Rpb25EZWxheSAqPSAyXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYucHVibGlzaChcInJlY29ubmVjdGluZ1wiLCBzZWxmLnJlY29ubmVjdGlvbkRlbGF5LCBzZWxmLnJlY29ubmVjdGlvbkF0dGVtcHRzKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWNvbm5lY3Rpb25UaW1lciA9IHNldFRpbWVvdXQobWF5YmVSZWNvbm5lY3QsIHNlbGYucmVjb25uZWN0aW9uRGVsYXkpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vcHRpb25zW1widHJ5IG11bHRpcGxlIHRyYW5zcG9ydHNcIl0gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMucmVjb25uZWN0aW9uVGltZXIgPSBzZXRUaW1lb3V0KG1heWJlUmVjb25uZWN0LCB0aGlzLnJlY29ubmVjdGlvbkRlbGF5KTtcbiAgICAgICAgICAgIHRoaXMub24oXCJjb25uZWN0XCIsIG1heWJlUmVjb25uZWN0KVxuICAgICAgICB9XG4gICAgfSkoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgaW8gPyBpbyA6IG1vZHVsZS5leHBvcnRzLCBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBpbyA/IGlvIDogbW9kdWxlLnBhcmVudC5leHBvcnRzLCB0aGlzKTtcbiAgICAoZnVuY3Rpb24oZXhwb3J0cywgaW8pIHtcbiAgICAgICAgZXhwb3J0cy5Tb2NrZXROYW1lc3BhY2UgPSBTb2NrZXROYW1lc3BhY2U7XG5cbiAgICAgICAgZnVuY3Rpb24gU29ja2V0TmFtZXNwYWNlKHNvY2tldCwgbmFtZSkge1xuICAgICAgICAgICAgdGhpcy5zb2NrZXQgPSBzb2NrZXQ7XG4gICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lIHx8IFwiXCI7XG4gICAgICAgICAgICB0aGlzLmZsYWdzID0ge307XG4gICAgICAgICAgICB0aGlzLmpzb24gPSBuZXcgRmxhZyh0aGlzLCBcImpzb25cIik7XG4gICAgICAgICAgICB0aGlzLmFja1BhY2tldHMgPSAwO1xuICAgICAgICAgICAgdGhpcy5hY2tzID0ge31cbiAgICAgICAgfVxuICAgICAgICBpby51dGlsLm1peGluKFNvY2tldE5hbWVzcGFjZSwgaW8uRXZlbnRFbWl0dGVyKTtcbiAgICAgICAgU29ja2V0TmFtZXNwYWNlLnByb3RvdHlwZS4kZW1pdCA9IGlvLkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZW1pdDtcbiAgICAgICAgU29ja2V0TmFtZXNwYWNlLnByb3RvdHlwZS5vZiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc29ja2V0Lm9mLmFwcGx5KHRoaXMuc29ja2V0LCBhcmd1bWVudHMpXG4gICAgICAgIH07XG4gICAgICAgIFNvY2tldE5hbWVzcGFjZS5wcm90b3R5cGUucGFja2V0ID0gZnVuY3Rpb24ocGFja2V0KSB7XG4gICAgICAgICAgICBwYWNrZXQuZW5kcG9pbnQgPSB0aGlzLm5hbWU7XG4gICAgICAgICAgICB0aGlzLnNvY2tldC5wYWNrZXQocGFja2V0KTtcbiAgICAgICAgICAgIHRoaXMuZmxhZ3MgPSB7fTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgIH07XG4gICAgICAgIFNvY2tldE5hbWVzcGFjZS5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKGRhdGEsIGZuKSB7XG4gICAgICAgICAgICB2YXIgcGFja2V0ID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6IHRoaXMuZmxhZ3MuanNvbiA/IFwianNvblwiIDogXCJtZXNzYWdlXCIsXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGZuKSB7XG4gICAgICAgICAgICAgICAgcGFja2V0LmlkID0gKyt0aGlzLmFja1BhY2tldHM7XG4gICAgICAgICAgICAgICAgcGFja2V0LmFjayA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5hY2tzW3BhY2tldC5pZF0gPSBmblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFja2V0KHBhY2tldClcbiAgICAgICAgfTtcbiAgICAgICAgU29ja2V0TmFtZXNwYWNlLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpLFxuICAgICAgICAgICAgICAgIGxhc3RBcmcgPSBhcmdzW2FyZ3MubGVuZ3RoIC0gMV0sXG4gICAgICAgICAgICAgICAgcGFja2V0ID0ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImV2ZW50XCIsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgbGFzdEFyZykge1xuICAgICAgICAgICAgICAgIHBhY2tldC5pZCA9ICsrdGhpcy5hY2tQYWNrZXRzO1xuICAgICAgICAgICAgICAgIHBhY2tldC5hY2sgPSBcImRhdGFcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmFja3NbcGFja2V0LmlkXSA9IGxhc3RBcmc7XG4gICAgICAgICAgICAgICAgYXJncyA9IGFyZ3Muc2xpY2UoMCwgYXJncy5sZW5ndGggLSAxKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFja2V0LmFyZ3MgPSBhcmdzO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFja2V0KHBhY2tldClcbiAgICAgICAgfTtcbiAgICAgICAgU29ja2V0TmFtZXNwYWNlLnByb3RvdHlwZS5kaXNjb25uZWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5uYW1lID09PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zb2NrZXQuZGlzY29ubmVjdCgpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGFja2V0KHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJkaXNjb25uZWN0XCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KFwiZGlzY29ubmVjdFwiKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgfTtcbiAgICAgICAgU29ja2V0TmFtZXNwYWNlLnByb3RvdHlwZS5vblBhY2tldCA9IGZ1bmN0aW9uKHBhY2tldCkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBhY2soKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5wYWNrZXQoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImFja1wiLFxuICAgICAgICAgICAgICAgICAgICBhcmdzOiBpby51dGlsLnRvQXJyYXkoYXJndW1lbnRzKSxcbiAgICAgICAgICAgICAgICAgICAgYWNrSWQ6IHBhY2tldC5pZFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKHBhY2tldC50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcImNvbm5lY3RcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdChcImNvbm5lY3RcIik7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJkaXNjb25uZWN0XCI6XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWUgPT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc29ja2V0Lm9uRGlzY29ubmVjdChwYWNrZXQucmVhc29uIHx8IFwiYm9vdGVkXCIpXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KFwiZGlzY29ubmVjdFwiLCBwYWNrZXQucmVhc29uKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJtZXNzYWdlXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcImpzb25cIjpcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IFtcIm1lc3NhZ2VcIiwgcGFja2V0LmRhdGFdO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFja2V0LmFjayA9PSBcImRhdGFcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnB1c2goYWNrKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhY2tldC5hY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhY2tldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYWNrXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFja0lkOiBwYWNrZXQuaWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQuYXBwbHkodGhpcywgcGFyYW1zKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImV2ZW50XCI6XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSBbcGFja2V0Lm5hbWVdLmNvbmNhdChwYWNrZXQuYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYWNrZXQuYWNrID09IFwiZGF0YVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMucHVzaChhY2spXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdC5hcHBseSh0aGlzLCBwYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiYWNrXCI6XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFja3NbcGFja2V0LmFja0lkXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hY2tzW3BhY2tldC5hY2tJZF0uYXBwbHkodGhpcywgcGFja2V0LmFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuYWNrc1twYWNrZXQuYWNrSWRdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImVycm9yXCI6XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYWNrZXQuYWR2aWNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNvY2tldC5vbkVycm9yKHBhY2tldClcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYWNrZXQucmVhc29uID09IFwidW5hdXRob3JpemVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KFwiY29ubmVjdF9mYWlsZWRcIiwgcGFja2V0LnJlYXNvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdChcImVycm9yXCIsIHBhY2tldC5yZWFzb24pXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBGbGFnKG5zcCwgbmFtZSkge1xuICAgICAgICAgICAgdGhpcy5uYW1lc3BhY2UgPSBuc3A7XG4gICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lXG4gICAgICAgIH1cbiAgICAgICAgRmxhZy5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5uYW1lc3BhY2UuZmxhZ3NbdGhpcy5uYW1lXSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLm5hbWVzcGFjZS5zZW5kLmFwcGx5KHRoaXMubmFtZXNwYWNlLCBhcmd1bWVudHMpXG4gICAgICAgIH07XG4gICAgICAgIEZsYWcucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMubmFtZXNwYWNlLmZsYWdzW3RoaXMubmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5uYW1lc3BhY2UuZW1pdC5hcHBseSh0aGlzLm5hbWVzcGFjZSwgYXJndW1lbnRzKVxuICAgICAgICB9XG4gICAgfSkoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgaW8gPyBpbyA6IG1vZHVsZS5leHBvcnRzLCBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBpbyA/IGlvIDogbW9kdWxlLnBhcmVudC5leHBvcnRzKTtcbiAgICAoZnVuY3Rpb24oZXhwb3J0cywgaW8sIGdsb2JhbCkge1xuICAgICAgICBleHBvcnRzLndlYnNvY2tldCA9IFdTO1xuXG4gICAgICAgIGZ1bmN0aW9uIFdTKCkge1xuICAgICAgICAgICAgaW8uVHJhbnNwb3J0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcbiAgICAgICAgfVxuICAgICAgICBpby51dGlsLmluaGVyaXQoV1MsIGlvLlRyYW5zcG9ydCk7XG4gICAgICAgIFdTLnByb3RvdHlwZS5uYW1lID0gXCJ3ZWJzb2NrZXRcIjtcbiAgICAgICAgV1MucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IGlvLnV0aWwucXVlcnkodGhpcy5zb2NrZXQub3B0aW9ucy5xdWVyeSksXG4gICAgICAgICAgICAgICAgc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICAgICAgU29ja2V0O1xuICAgICAgICAgICAgaWYgKCFTb2NrZXQpIHtcbiAgICAgICAgICAgICAgICBTb2NrZXQgPSBnbG9iYWwuTW96V2ViU29ja2V0IHx8IGdsb2JhbC5XZWJTb2NrZXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMud2Vic29ja2V0ID0gbmV3IFNvY2tldCh0aGlzLnByZXBhcmVVcmwoKSArIHF1ZXJ5KTtcbiAgICAgICAgICAgIHRoaXMud2Vic29ja2V0Lm9ub3BlbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYub25PcGVuKCk7XG4gICAgICAgICAgICAgICAgc2VsZi5zb2NrZXQuc2V0QnVmZmVyKGZhbHNlKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMud2Vic29ja2V0Lm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5vbkRhdGEoZXYuZGF0YSlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLndlYnNvY2tldC5vbmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5vbkNsb3NlKCk7XG4gICAgICAgICAgICAgICAgc2VsZi5zb2NrZXQuc2V0QnVmZmVyKHRydWUpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy53ZWJzb2NrZXQub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm9uRXJyb3IoZSlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gdGhpc1xuICAgICAgICB9O1xuICAgICAgICBpZiAoaW8udXRpbC51YS5pRGV2aWNlKSB7XG4gICAgICAgICAgICBXUy5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi53ZWJzb2NrZXQuc2VuZChkYXRhKVxuICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBXUy5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndlYnNvY2tldC5zZW5kKGRhdGEpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgV1MucHJvdG90eXBlLnBheWxvYWQgPSBmdW5jdGlvbihhcnIpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gYXJyLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMucGFja2V0KGFycltpXSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgIH07XG4gICAgICAgIFdTLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy53ZWJzb2NrZXQuY2xvc2UoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgIH07XG4gICAgICAgIFdTLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdGhpcy5zb2NrZXQub25FcnJvcihlKVxuICAgICAgICB9O1xuICAgICAgICBXUy5wcm90b3R5cGUuc2NoZW1lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zb2NrZXQub3B0aW9ucy5zZWN1cmUgPyBcIndzc1wiIDogXCJ3c1wiXG4gICAgICAgIH07XG4gICAgICAgIFdTLmNoZWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gKFwiV2ViU29ja2V0XCIgaW4gZ2xvYmFsICYmICEoXCJfX2FkZFRhc2tcIiBpbiBXZWJTb2NrZXQpKSB8fCBcIk1veldlYlNvY2tldFwiIGluIGdsb2JhbFxuICAgICAgICB9O1xuICAgICAgICBXUy54ZG9tYWluQ2hlY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH07XG4gICAgICAgIGlvLnRyYW5zcG9ydHMucHVzaChcIndlYnNvY2tldFwiKVxuICAgIH0pKFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGlvID8gaW8uVHJhbnNwb3J0IDogbW9kdWxlLmV4cG9ydHMsIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGlvID8gaW8gOiBtb2R1bGUucGFyZW50LmV4cG9ydHMsIHRoaXMpO1xuICAgIChmdW5jdGlvbihleHBvcnRzLCBpbywgZ2xvYmFsKSB7XG4gICAgICAgIGV4cG9ydHMuWEhSID0gWEhSO1xuXG4gICAgICAgIGZ1bmN0aW9uIFhIUihzb2NrZXQpIHtcbiAgICAgICAgICAgIGlmICghc29ja2V0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpby5UcmFuc3BvcnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIHRoaXMuc2VuZEJ1ZmZlciA9IFtdXG4gICAgICAgIH1cbiAgICAgICAgaW8udXRpbC5pbmhlcml0KFhIUiwgaW8uVHJhbnNwb3J0KTtcbiAgICAgICAgWEhSLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnNvY2tldC5zZXRCdWZmZXIoZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgICAgICAgIHRoaXMuZ2V0KCk7XG4gICAgICAgICAgICB0aGlzLnNldENsb3NlVGltZW91dCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgfTtcbiAgICAgICAgWEhSLnByb3RvdHlwZS5wYXlsb2FkID0gZnVuY3Rpb24ocGF5bG9hZCkge1xuICAgICAgICAgICAgdmFyIG1zZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gcGF5bG9hZC5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtc2dzLnB1c2goaW8ucGFyc2VyLmVuY29kZVBhY2tldChwYXlsb2FkW2ldKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VuZChpby5wYXJzZXIuZW5jb2RlUGF5bG9hZChtc2dzKSlcbiAgICAgICAgfTtcbiAgICAgICAgWEhSLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5wb3N0KGRhdGEpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBlbXB0eSgpIHt9XG4gICAgICAgIFhIUi5wcm90b3R5cGUucG9zdCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuc29ja2V0LnNldEJ1ZmZlcih0cnVlKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gc3RhdGVDaGFuZ2UoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25yZWFkeXN0YXRlY2hhbmdlID0gZW1wdHk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYucG9zdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNvY2tldC5zZXRCdWZmZXIoZmFsc2UpXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm9uQ2xvc2UoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbmxvYWQoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmxvYWQgPSBlbXB0eTtcbiAgICAgICAgICAgICAgICBzZWxmLnNvY2tldC5zZXRCdWZmZXIoZmFsc2UpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlbmRYSFIgPSB0aGlzLnJlcXVlc3QoXCJQT1NUXCIpO1xuICAgICAgICAgICAgaWYgKGdsb2JhbC5YRG9tYWluUmVxdWVzdCAmJiB0aGlzLnNlbmRYSFIgaW5zdGFuY2VvZiBYRG9tYWluUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VuZFhIUi5vbmxvYWQgPSB0aGlzLnNlbmRYSFIub25lcnJvciA9IG9ubG9hZFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbmRYSFIub25yZWFkeXN0YXRlY2hhbmdlID0gc3RhdGVDaGFuZ2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VuZFhIUi5zZW5kKGRhdGEpXG4gICAgICAgIH07XG4gICAgICAgIFhIUi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMub25DbG9zZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgfTtcbiAgICAgICAgWEhSLnByb3RvdHlwZS5yZXF1ZXN0ID0gZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgICAgICAgICB2YXIgcmVxID0gaW8udXRpbC5yZXF1ZXN0KHRoaXMuc29ja2V0LmlzWERvbWFpbigpKSxcbiAgICAgICAgICAgICAgICBxdWVyeSA9IGlvLnV0aWwucXVlcnkodGhpcy5zb2NrZXQub3B0aW9ucy5xdWVyeSwgXCJ0PVwiICsgK25ldyBEYXRlKTtcbiAgICAgICAgICAgIHJlcS5vcGVuKG1ldGhvZCB8fCBcIkdFVFwiLCB0aGlzLnByZXBhcmVVcmwoKSArIHF1ZXJ5LCB0cnVlKTtcbiAgICAgICAgICAgIGlmIChtZXRob2QgPT0gXCJQT1NUXCIpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVxLnNldFJlcXVlc3RIZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC10eXBlXCIsIFwidGV4dC9wbGFpbjtjaGFyc2V0PVVURi04XCIpXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXEuY29udGVudFR5cGUgPSBcInRleHQvcGxhaW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXFcbiAgICAgICAgfTtcbiAgICAgICAgWEhSLnByb3RvdHlwZS5zY2hlbWUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNvY2tldC5vcHRpb25zLnNlY3VyZSA/IFwiaHR0cHNcIiA6IFwiaHR0cFwiXG4gICAgICAgIH07XG4gICAgICAgIFhIUi5jaGVjayA9IGZ1bmN0aW9uKHNvY2tldCwgeGRvbWFpbikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGlvLnV0aWwucmVxdWVzdCh4ZG9tYWluKSxcbiAgICAgICAgICAgICAgICAgICAgdXNlc1hEb21SZXEgPSAoZ2xvYmFsLlhEb21haW5SZXF1ZXN0ICYmIHJlcXVlc3QgaW5zdGFuY2VvZiBYRG9tYWluUmVxdWVzdCksXG4gICAgICAgICAgICAgICAgICAgIHNvY2tldFByb3RvY29sID0gKHNvY2tldCAmJiBzb2NrZXQub3B0aW9ucyAmJiBzb2NrZXQub3B0aW9ucy5zZWN1cmUgPyBcImh0dHBzOlwiIDogXCJodHRwOlwiKSxcbiAgICAgICAgICAgICAgICAgICAgaXNYUHJvdG9jb2wgPSAoZ2xvYmFsLmxvY2F0aW9uICYmIHNvY2tldFByb3RvY29sICE9IGdsb2JhbC5sb2NhdGlvbi5wcm90b2NvbCk7XG4gICAgICAgICAgICAgICAgaWYgKHJlcXVlc3QgJiYgISh1c2VzWERvbVJlcSAmJiBpc1hQcm90b2NvbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIFhIUi54ZG9tYWluQ2hlY2sgPSBmdW5jdGlvbihzb2NrZXQpIHtcbiAgICAgICAgICAgIHJldHVybiBYSFIuY2hlY2soc29ja2V0LCB0cnVlKVxuICAgICAgICB9XG4gICAgfSkoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgaW8gPyBpby5UcmFuc3BvcnQgOiBtb2R1bGUuZXhwb3J0cywgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgaW8gPyBpbyA6IG1vZHVsZS5wYXJlbnQuZXhwb3J0cywgdGhpcyk7XG4gICAgKGZ1bmN0aW9uKGV4cG9ydHMsIGlvKSB7XG4gICAgICAgIGV4cG9ydHMuaHRtbGZpbGUgPSBIVE1MRmlsZTtcblxuICAgICAgICBmdW5jdGlvbiBIVE1MRmlsZSgpIHtcbiAgICAgICAgICAgIGlvLlRyYW5zcG9ydC5YSFIuYXBwbHkodGhpcywgYXJndW1lbnRzKVxuICAgICAgICB9XG4gICAgICAgIGlvLnV0aWwuaW5oZXJpdChIVE1MRmlsZSwgaW8uVHJhbnNwb3J0LlhIUik7XG4gICAgICAgIEhUTUxGaWxlLnByb3RvdHlwZS5uYW1lID0gXCJodG1sZmlsZVwiO1xuICAgICAgICBIVE1MRmlsZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLmRvYyA9IG5ldyB3aW5kb3dbKFtcIkFjdGl2ZVwiXS5jb25jYXQoXCJPYmplY3RcIikuam9pbihcIlhcIikpXShcImh0bWxmaWxlXCIpO1xuICAgICAgICAgICAgdGhpcy5kb2Mub3BlbigpO1xuICAgICAgICAgICAgdGhpcy5kb2Mud3JpdGUoXCI8aHRtbD48L2h0bWw+XCIpO1xuICAgICAgICAgICAgdGhpcy5kb2MuY2xvc2UoKTtcbiAgICAgICAgICAgIHRoaXMuZG9jLnBhcmVudFdpbmRvdy5zID0gdGhpcztcbiAgICAgICAgICAgIHZhciBpZnJhbWVDID0gdGhpcy5kb2MuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgIGlmcmFtZUMuY2xhc3NOYW1lID0gXCJzb2NrZXRpb1wiO1xuICAgICAgICAgICAgdGhpcy5kb2MuYm9keS5hcHBlbmRDaGlsZChpZnJhbWVDKTtcbiAgICAgICAgICAgIHRoaXMuaWZyYW1lID0gdGhpcy5kb2MuY3JlYXRlRWxlbWVudChcImlmcmFtZVwiKTtcbiAgICAgICAgICAgIGlmcmFtZUMuYXBwZW5kQ2hpbGQodGhpcy5pZnJhbWUpO1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gaW8udXRpbC5xdWVyeSh0aGlzLnNvY2tldC5vcHRpb25zLnF1ZXJ5LCBcInQ9XCIgKyArbmV3IERhdGUpO1xuICAgICAgICAgICAgdGhpcy5pZnJhbWUuc3JjID0gdGhpcy5wcmVwYXJlVXJsKCkgKyBxdWVyeTtcbiAgICAgICAgICAgIGlvLnV0aWwub24od2luZG93LCBcInVubG9hZFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmRlc3Ryb3koKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgSFRNTEZpbGUucHJvdG90eXBlLl8gPSBmdW5jdGlvbihkYXRhLCBkb2MpIHtcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhLnJlcGxhY2UoL1xcXFxcXC8vZywgXCIvXCIpO1xuICAgICAgICAgICAgdGhpcy5vbkRhdGEoZGF0YSk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBzY3JpcHQgPSBkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIilbMF07XG4gICAgICAgICAgICAgICAgc2NyaXB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0KVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgfTtcbiAgICAgICAgSFRNTEZpbGUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlmcmFtZSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lLnNyYyA9IFwiYWJvdXQ6YmxhbmtcIlxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgICAgICAgICAgdGhpcy5kb2MgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5pZnJhbWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICBDb2xsZWN0R2FyYmFnZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEhUTUxGaWxlLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95KCk7XG4gICAgICAgICAgICByZXR1cm4gaW8uVHJhbnNwb3J0LlhIUi5wcm90b3R5cGUuY2xvc2UuY2FsbCh0aGlzKVxuICAgICAgICB9O1xuICAgICAgICBIVE1MRmlsZS5jaGVjayA9IGZ1bmN0aW9uKHNvY2tldCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT0gXCJ1bmRlZmluZWRcIiAmJiAoW1wiQWN0aXZlXCJdLmNvbmNhdChcIk9iamVjdFwiKS5qb2luKFwiWFwiKSkgaW4gd2luZG93KSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBuZXcgd2luZG93WyhbXCJBY3RpdmVcIl0uY29uY2F0KFwiT2JqZWN0XCIpLmpvaW4oXCJYXCIpKV0oXCJodG1sZmlsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgJiYgaW8uVHJhbnNwb3J0LlhIUi5jaGVjayhzb2NrZXQpXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICBIVE1MRmlsZS54ZG9tYWluQ2hlY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICBpby50cmFuc3BvcnRzLnB1c2goXCJodG1sZmlsZVwiKVxuICAgIH0pKFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGlvID8gaW8uVHJhbnNwb3J0IDogbW9kdWxlLmV4cG9ydHMsIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGlvID8gaW8gOiBtb2R1bGUucGFyZW50LmV4cG9ydHMpO1xuICAgIChmdW5jdGlvbihleHBvcnRzLCBpbywgZ2xvYmFsKSB7XG4gICAgICAgIGV4cG9ydHNbXCJ4aHItcG9sbGluZ1wiXSA9IFhIUlBvbGxpbmc7XG5cbiAgICAgICAgZnVuY3Rpb24gWEhSUG9sbGluZygpIHtcbiAgICAgICAgICAgIGlvLlRyYW5zcG9ydC5YSFIuYXBwbHkodGhpcywgYXJndW1lbnRzKVxuICAgICAgICB9XG4gICAgICAgIGlvLnV0aWwuaW5oZXJpdChYSFJQb2xsaW5nLCBpby5UcmFuc3BvcnQuWEhSKTtcbiAgICAgICAgaW8udXRpbC5tZXJnZShYSFJQb2xsaW5nLCBpby5UcmFuc3BvcnQuWEhSKTtcbiAgICAgICAgWEhSUG9sbGluZy5wcm90b3R5cGUubmFtZSA9IFwieGhyLXBvbGxpbmdcIjtcbiAgICAgICAgWEhSUG9sbGluZy5wcm90b3R5cGUuaGVhcnRiZWF0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIFhIUlBvbGxpbmcucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIGlvLlRyYW5zcG9ydC5YSFIucHJvdG90eXBlLm9wZW4uY2FsbChzZWxmKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGVtcHR5KCkge31cbiAgICAgICAgWEhSUG9sbGluZy5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNPcGVuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHN0YXRlQ2hhbmdlKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT0gNCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGVtcHR5O1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm9uRGF0YSh0aGlzLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdldCgpXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm9uQ2xvc2UoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbmxvYWQoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmxvYWQgPSBlbXB0eTtcbiAgICAgICAgICAgICAgICB0aGlzLm9uZXJyb3IgPSBlbXB0eTtcbiAgICAgICAgICAgICAgICBzZWxmLnJldHJ5Q291bnRlciA9IDE7XG4gICAgICAgICAgICAgICAgc2VsZi5vbkRhdGEodGhpcy5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgIHNlbGYuZ2V0KClcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gb25lcnJvcigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnJldHJ5Q291bnRlcisrO1xuICAgICAgICAgICAgICAgIGlmICghc2VsZi5yZXRyeUNvdW50ZXIgfHwgc2VsZi5yZXRyeUNvdW50ZXIgPiAzKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYub25DbG9zZSgpXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5nZXQoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMueGhyID0gdGhpcy5yZXF1ZXN0KCk7XG4gICAgICAgICAgICBpZiAoZ2xvYmFsLlhEb21haW5SZXF1ZXN0ICYmIHRoaXMueGhyIGluc3RhbmNlb2YgWERvbWFpblJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnhoci5vbmxvYWQgPSBvbmxvYWQ7XG4gICAgICAgICAgICAgICAgdGhpcy54aHIub25lcnJvciA9IG9uZXJyb3JcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy54aHIub25yZWFkeXN0YXRlY2hhbmdlID0gc3RhdGVDaGFuZ2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMueGhyLnNlbmQobnVsbClcbiAgICAgICAgfTtcbiAgICAgICAgWEhSUG9sbGluZy5wcm90b3R5cGUub25DbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaW8uVHJhbnNwb3J0LlhIUi5wcm90b3R5cGUub25DbG9zZS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgaWYgKHRoaXMueGhyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy54aHIub25yZWFkeXN0YXRlY2hhbmdlID0gdGhpcy54aHIub25sb2FkID0gdGhpcy54aHIub25lcnJvciA9IGVtcHR5O1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMueGhyLmFib3J0KClcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICAgICAgICAgIHRoaXMueGhyID0gbnVsbFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBYSFJQb2xsaW5nLnByb3RvdHlwZS5yZWFkeSA9IGZ1bmN0aW9uKHNvY2tldCwgZm4pIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIGlvLnV0aWwuZGVmZXIoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZm4uY2FsbChzZWxmLCBzb2NrZXQpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBpby50cmFuc3BvcnRzLnB1c2goXCJ4aHItcG9sbGluZ1wiKVxuICAgIH0pKFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGlvID8gaW8uVHJhbnNwb3J0IDogbW9kdWxlLmV4cG9ydHMsIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGlvID8gaW8gOiBtb2R1bGUucGFyZW50LmV4cG9ydHMsIHRoaXMpO1xuICAgIChmdW5jdGlvbihleHBvcnRzLCBpbywgZ2xvYmFsKSB7XG4gICAgICAgIHZhciBpbmRpY2F0b3IgPSBnbG9iYWwuZG9jdW1lbnQgJiYgXCJNb3pBcHBlYXJhbmNlXCIgaW4gZ2xvYmFsLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZTtcbiAgICAgICAgZXhwb3J0c1tcImpzb25wLXBvbGxpbmdcIl0gPSBKU09OUFBvbGxpbmc7XG5cbiAgICAgICAgZnVuY3Rpb24gSlNPTlBQb2xsaW5nKCkge1xuICAgICAgICAgICAgaW8uVHJhbnNwb3J0W1wieGhyLXBvbGxpbmdcIl0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIHRoaXMuaW5kZXggPSBpby5qLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIGlvLmoucHVzaChmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl8obXNnKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBpby51dGlsLmluaGVyaXQoSlNPTlBQb2xsaW5nLCBpby5UcmFuc3BvcnRbXCJ4aHItcG9sbGluZ1wiXSk7XG4gICAgICAgIEpTT05QUG9sbGluZy5wcm90b3R5cGUubmFtZSA9IFwianNvbnAtcG9sbGluZ1wiO1xuICAgICAgICBKU09OUFBvbGxpbmcucHJvdG90eXBlLnBvc3QgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICAgICAgcXVlcnkgPSBpby51dGlsLnF1ZXJ5KHRoaXMuc29ja2V0Lm9wdGlvbnMucXVlcnksIFwidD1cIiArICgrbmV3IERhdGUpICsgXCImaT1cIiArIHRoaXMuaW5kZXgpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmZvcm0pIHtcbiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpLFxuICAgICAgICAgICAgICAgICAgICBhcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIpLFxuICAgICAgICAgICAgICAgICAgICBpZCA9IHRoaXMuaWZyYW1lSWQgPSBcInNvY2tldGlvX2lmcmFtZV9cIiArIHRoaXMuaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgIGlmcmFtZTtcbiAgICAgICAgICAgICAgICBmb3JtLmNsYXNzTmFtZSA9IFwic29ja2V0aW9cIjtcbiAgICAgICAgICAgICAgICBmb3JtLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuICAgICAgICAgICAgICAgIGZvcm0uc3R5bGUudG9wID0gXCIwcHhcIjtcbiAgICAgICAgICAgICAgICBmb3JtLnN0eWxlLmxlZnQgPSBcIjBweFwiO1xuICAgICAgICAgICAgICAgIGZvcm0uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgICAgIGZvcm0udGFyZ2V0ID0gaWQ7XG4gICAgICAgICAgICAgICAgZm9ybS5tZXRob2QgPSBcIlBPU1RcIjtcbiAgICAgICAgICAgICAgICBmb3JtLnNldEF0dHJpYnV0ZShcImFjY2VwdC1jaGFyc2V0XCIsIFwidXRmLThcIik7XG4gICAgICAgICAgICAgICAgYXJlYS5uYW1lID0gXCJkXCI7XG4gICAgICAgICAgICAgICAgZm9ybS5hcHBlbmRDaGlsZChhcmVhKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZvcm0pO1xuICAgICAgICAgICAgICAgIHRoaXMuZm9ybSA9IGZvcm07XG4gICAgICAgICAgICAgICAgdGhpcy5hcmVhID0gYXJlYVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5mb3JtLmFjdGlvbiA9IHRoaXMucHJlcGFyZVVybCgpICsgcXVlcnk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXBsZXRlKCkge1xuICAgICAgICAgICAgICAgIGluaXRJZnJhbWUoKTtcbiAgICAgICAgICAgICAgICBzZWxmLnNvY2tldC5zZXRCdWZmZXIoZmFsc2UpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGluaXRJZnJhbWUoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuaWZyYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZm9ybS5yZW1vdmVDaGlsZChzZWxmLmlmcmFtZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnPGlmcmFtZSBuYW1lPVwiJyArIHNlbGYuaWZyYW1lSWQgKyAnXCI+JylcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmcmFtZS5uYW1lID0gc2VsZi5pZnJhbWVJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZnJhbWUuaWQgPSBzZWxmLmlmcmFtZUlkO1xuICAgICAgICAgICAgICAgIHNlbGYuZm9ybS5hcHBlbmRDaGlsZChpZnJhbWUpO1xuICAgICAgICAgICAgICAgIHNlbGYuaWZyYW1lID0gaWZyYW1lXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbml0SWZyYW1lKCk7XG4gICAgICAgICAgICB0aGlzLmFyZWEudmFsdWUgPSBpby5KU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtLnN1Ym1pdCgpXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICAgICAgaWYgKHRoaXMuaWZyYW1lLmF0dGFjaEV2ZW50KSB7XG4gICAgICAgICAgICAgICAgaWZyYW1lLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5pZnJhbWUucmVhZHlTdGF0ZSA9PSBcImNvbXBsZXRlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlKClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pZnJhbWUub25sb2FkID0gY29tcGxldGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc29ja2V0LnNldEJ1ZmZlcih0cnVlKVxuICAgICAgICB9O1xuICAgICAgICBKU09OUFBvbGxpbmcucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIiksXG4gICAgICAgICAgICAgICAgcXVlcnkgPSBpby51dGlsLnF1ZXJ5KHRoaXMuc29ja2V0Lm9wdGlvbnMucXVlcnksIFwidD1cIiArICgrbmV3IERhdGUpICsgXCImaT1cIiArIHRoaXMuaW5kZXgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNjcmlwdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JpcHQgPSBudWxsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY3JpcHQuYXN5bmMgPSB0cnVlO1xuICAgICAgICAgICAgc2NyaXB0LnNyYyA9IHRoaXMucHJlcGFyZVVybCgpICsgcXVlcnk7XG4gICAgICAgICAgICBzY3JpcHQub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYub25DbG9zZSgpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGluc2VydEF0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIilbMF07XG4gICAgICAgICAgICBpbnNlcnRBdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzY3JpcHQsIGluc2VydEF0KTtcbiAgICAgICAgICAgIHRoaXMuc2NyaXB0ID0gc2NyaXB0O1xuICAgICAgICAgICAgaWYgKGluZGljYXRvcikge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoaWZyYW1lKVxuICAgICAgICAgICAgICAgIH0sIDEwMClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgSlNPTlBQb2xsaW5nLnByb3RvdHlwZS5fID0gZnVuY3Rpb24obXNnKSB7XG4gICAgICAgICAgICB0aGlzLm9uRGF0YShtc2cpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNPcGVuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXQoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgfTtcbiAgICAgICAgSlNPTlBQb2xsaW5nLnByb3RvdHlwZS5yZWFkeSA9IGZ1bmN0aW9uKHNvY2tldCwgZm4pIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIGlmICghaW5kaWNhdG9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlvLnV0aWwubG9hZChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBmbi5jYWxsKHNlbGYpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBKU09OUFBvbGxpbmcuY2hlY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBcImRvY3VtZW50XCIgaW4gZ2xvYmFsXG4gICAgICAgIH07XG4gICAgICAgIEpTT05QUG9sbGluZy54ZG9tYWluQ2hlY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH07XG4gICAgICAgIGlvLnRyYW5zcG9ydHMucHVzaChcImpzb25wLXBvbGxpbmdcIilcbiAgICB9KShcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBpbyA/IGlvLlRyYW5zcG9ydCA6IG1vZHVsZS5leHBvcnRzLCBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBpbyA/IGlvIDogbW9kdWxlLnBhcmVudC5leHBvcnRzLCB0aGlzKTtcbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcbiAgICAgICAgZGVmaW5lKFtdLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBpb1xuICAgICAgICB9KVxuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24gKHByb2Nlc3Mpe1xudmFyIENvbmZpZyA9IHJlcXVpcmUoJy4vY29uZmlnJyk7XG4ndXNlIHN0cmljdCc7XG5cblxudmFyIGlzU2VydmVyID0gdHlwZW9mKHdpbmRvdykgPT09ICd1bmRlZmluZWQnLFxuICAgIHcgPSBpc1NlcnZlciA/IHt9IDogd2luZG93LFxuICAgIHBlcmZvcm1hbmNlID0gdHlwZW9mKHcucGVyZm9ybWFuY2UpICE9PSAndW5kZWZpbmVkJyA/IHcucGVyZm9ybWFuY2UgOiB7fSxcbiAgICBkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSxcbiAgICBTVEFSVF9NUyA9IERhdGUubm93KCksXG4gICAgU1RBUlQgPSBTVEFSVF9NUyAqIDAuMDAxLFxuICAgIERFTFRBID0gMSAvIDYwLFxuICAgIEZJWEVEX0RFTFRBID0gREVMVEEsXG4gICAgR0xPQkFMX0ZJWEVEID0gREVMVEEsXG4gICAgU0NBTEUgPSAxLFxuICAgIERhdGVOb3c7XG5cblxuaWYgKGlzU2VydmVyKSB7XG4gICAgdmFyIEhSX1RJTUUgPSBwcm9jZXNzLmhydGltZSgpO1xuXG4gICAgRGF0ZU5vdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGhydGltZSA9IHByb2Nlc3MuaHJ0aW1lKEhSX1RJTUUpLFxuICAgICAgICAgICAgcyA9IGhydGltZVswXSAqIDEwMDAsXG4gICAgICAgICAgICBucyA9IGhydGltZVsxXSAqIDFlLTY7XG5cbiAgICAgICAgcmV0dXJuIHMgKyBucztcbiAgICB9XG59IGVsc2Uge1xuICAgIERhdGVOb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBEYXRlLm5vdygpIC0gU1RBUlRfTVM7XG4gICAgfVxufVxuXG5cbnBlcmZvcm1hbmNlLm5vdyB8fCAocGVyZm9ybWFuY2Uubm93ID0gKFxucGVyZm9ybWFuY2Uud2Via2l0Tm93IHx8XG5wZXJmb3JtYW5jZS5tb3pOb3cgfHxcbnBlcmZvcm1hbmNlLm1zTm93IHx8XG5wZXJmb3JtYW5jZS5vTm93IHx8XG5EYXRlTm93XG4pKTtcblxuZnVuY3Rpb24gbm93KCkge1xuXG4gICAgcmV0dXJuIHBlcmZvcm1hbmNlLm5vdygpICogMC4wMDE7XG59XG5cblxuZnVuY3Rpb24gVGltZSgpIHtcblxuICAgIHRoaXMuc3RhcnQgPSBTVEFSVDtcbiAgICB0aGlzLnNpbmNlU3RhcnQgPSAwO1xuICAgIHRoaXMudGltZSA9IDA7XG4gICAgdGhpcy5mcHMgPSA2MDtcbiAgICB0aGlzLmRlbHRhID0gREVMVEE7XG4gICAgdGhpcy5mcmFtZUNvdW50ID0gMDtcblxuICAgIGRlZmluZVByb3BlcnR5KHRoaXMsICdzY2FsZScsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gU0NBTEU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBTQ0FMRSA9IHZhbHVlO1xuICAgICAgICAgICAgRklYRURfREVMVEEgPSBHTE9CQUxfRklYRUQgKiB2YWx1ZVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCAnZml4ZWREZWx0YScsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gRklYRURfREVMVEE7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBHTE9CQUxfRklYRUQgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZJWEVEX0RFTFRBID0gR0xPQkFMX0ZJWEVEICogU0NBTEU7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuXG5UaW1lLnByb3RvdHlwZS5ub3cgPSBub3c7XG5cblxuVGltZS5wcm90b3R5cGUuc3RhbXAgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gRGF0ZS5ub3coKSAqIDAuMDAxO1xufTtcblxuXG5UaW1lLnByb3RvdHlwZS5zdGFtcE1TID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIERhdGUubm93KCk7XG59O1xuXG5cbnZhciBmcmFtZUNvdW50ID0gMCxcbiAgICBsYXN0ID0gLTEgLyA2MCxcbiAgICB0aW1lID0gMCxcbiAgICBkZWx0YSA9IDEgLyA2MCxcbiAgICBmcHNGcmFtZSA9IDAsXG4gICAgZnBzTGFzdCA9IDAsXG4gICAgZnBzVGltZSA9IDA7XG5cblRpbWUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgTUlOX0RFTFRBID0gQ29uZmlnLk1JTl9ERUxUQSxcbiAgICAgICAgTUFYX0RFTFRBID0gQ29uZmlnLk1BWF9ERUxUQTtcblxuICAgIHRoaXMuZnJhbWVDb3VudCA9IGZyYW1lQ291bnQrKztcblxuICAgIGxhc3QgPSB0aW1lO1xuICAgIHRpbWUgPSBub3coKTtcbiAgICB0aGlzLnNpbmNlU3RhcnQgPSB0aW1lO1xuXG4gICAgZnBzVGltZSA9IHRpbWU7XG4gICAgZnBzRnJhbWUrKztcblxuICAgIGlmIChmcHNMYXN0ICsgMSA8IGZwc1RpbWUpIHtcbiAgICAgICAgdGhpcy5mcHMgPSBmcHNGcmFtZSAvIChmcHNUaW1lIC0gZnBzTGFzdCk7XG5cbiAgICAgICAgZnBzTGFzdCA9IGZwc1RpbWU7XG4gICAgICAgIGZwc0ZyYW1lID0gMDtcbiAgICB9XG5cbiAgICBkZWx0YSA9ICh0aW1lIC0gbGFzdCkgKiBTQ0FMRTtcbiAgICB0aGlzLmRlbHRhID0gZGVsdGEgPCBNSU5fREVMVEEgPyBNSU5fREVMVEEgOiBkZWx0YSA+IE1BWF9ERUxUQSA/IE1BWF9ERUxUQSA6IGRlbHRhO1xuXG4gICAgdGhpcy50aW1lID0gdGltZSAqIFNDQUxFO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBUaW1lO1xuXG59KS5jYWxsKHRoaXMscmVxdWlyZSgnX3Byb2Nlc3MnKSkiLCIoZnVuY3Rpb24gKHByb2Nlc3MsQnVmZmVyKXtcblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciB1dGlsID0ge30sXG4gICAgcmFuZG9tID0gTWF0aC5yYW5kb20sXG5cbiAgICBpc1NlcnZlciA9IHR5cGVvZih3aW5kb3cpID09PSBcInVuZGVmaW5lZFwiLFxuICAgIGN3ZCA9IGlzU2VydmVyID8gcHJvY2Vzcy5jd2QoKSA6IHdpbmRvdy5sb2NhdGlvbi5ocmVmLm1hdGNoKC8uKlxcLy8pWzBdLFxuXG4gICAgT2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlLFxuICAgIHRvU3RyaW5nID0gT2JqZWN0UHJvdG8udG9TdHJpbmcsXG4gICAgaGFzT3duUHJvcGVydHkgPSBPYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eSxcblxuICAgIEFycmF5UHJvdG8gPSBBcnJheS5wcm90b3R5cGUsXG4gICAgQXJyYXlGb3JFYWNoID0gQXJyYXlQcm90by5mb3JFYWNoLFxuXG4gICAga2V5cyA9IE9iamVjdC5rZXlzIHx8IChPYmplY3Qua2V5cyA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBbXSxcbiAgICAgICAgICAgICAgICBrZXk7XG5cbiAgICAgICAgICAgIGZvciAoa2V5IGluIG9iaikge1xuICAgICAgICAgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgb3V0LnB1c2goa2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgIH0pLFxuXG4gICAgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgKEFycmF5LmlzQXJyYXkgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09PSBcIltvYmplY3QgQXJyYXldXCI7XG4gICAgICAgIH0pLFxuXG4gICAgU1BJTFRFUiA9IC9bIFxcX1xcLVxcLl0rfCg/PVtBLVpdW15BLVpdKS9nLFxuICAgIFVOREVSU0NPUkUgPSAvKFthLXpdKShbQS1aXSkvZyxcbiAgICBGT1JNQVRfUkVHRVggPSAvJVtzZGolXS9nO1xuXG5mdW5jdGlvbiBpc09iamVjdChvYmopIHtcblxuICAgIHJldHVybiBvYmogPT09IE9iamVjdChvYmopO1xufVxudXRpbC5pc09iamVjdCA9IGlzT2JqZWN0O1xuXG5cbmZ1bmN0aW9uIGlzQXJyYXlMaWtlKG9iaikge1xuXG4gICAgcmV0dXJuIHR5cGVvZihvYmopID09PSBcIm9iamVjdFwiICYmIHR5cGVvZihvYmoubGVuZ3RoKSA9PT0gXCJudW1iZXJcIjtcbn1cbnV0aWwuaXNBcnJheUxpa2UgPSBpc0FycmF5TGlrZTtcbnV0aWwuaXNBcnJheSA9IGlzQXJyYXk7XG5cblxuZnVuY3Rpb24gaXNBcmd1bWVudHMob2JqKSB7XG5cbiAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09PSBcIltvYmplY3QgQXJndW1lbnRzXVwiO1xufVxudXRpbC5pc0FyZ3VtZW50cyA9IGlzQXJndW1lbnRzO1xuXG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24ob2JqKSB7XG5cbiAgICByZXR1cm4gdHlwZW9mKG9iaikgPT09IFwiZnVuY3Rpb25cIlxufVxudXRpbC5pc0Z1bmN0aW9uID0gaXNGdW5jdGlvbjtcblxuXG5mdW5jdGlvbiBpc1N0cmluZyhvYmopIHtcblxuICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09IFwiW29iamVjdCBTdHJpbmddXCI7XG59XG51dGlsLmlzU3RyaW5nID0gaXNTdHJpbmc7XG5cblxuZnVuY3Rpb24gaXNOdW1iZXIob2JqKSB7XG5cbiAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09PSBcIltvYmplY3QgTnVtYmVyXVwiO1xufVxudXRpbC5pc051bWJlciA9IGlzTnVtYmVyO1xuXG5cbmZ1bmN0aW9uIGlzRGVjaW1hbChvYmopIHtcblxuICAgIHJldHVybiBpc051bWJlcihvYmopICYmIG9iaiAlIDEgIT09IDA7XG59XG51dGlsLmlzRGVjaW1hbCA9IGlzRGVjaW1hbDtcblxuXG5mdW5jdGlvbiBpc0ludGVnZXIob2JqKSB7XG5cbiAgICByZXR1cm4gaXNOdW1iZXIob2JqKSAmJiBvYmogJSAxID09PSAwO1xufVxudXRpbC5pc0ludGVnZXIgPSBpc0ludGVnZXI7XG5cblxuZnVuY3Rpb24gaXNEYXRlKG9iaikge1xuXG4gICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gXCJbb2JqZWN0IERhdGVdXCI7XG59XG51dGlsLmlzRGF0ZSA9IGlzRGF0ZTtcblxuXG5mdW5jdGlvbiBpc1JlZ0V4cChvYmopIHtcblxuICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09IFwiW29iamVjdCBSZWdFeHBdXCI7XG59XG51dGlsLmlzUmVnRXhwID0gaXNSZWdFeHA7XG5cblxudXRpbC5pc0Zpbml0ZSA9IGlzRmluaXRlO1xuXG5cbnV0aWwuaXNOYU4gPSBpc05hTjtcblxuXG5mdW5jdGlvbiBpc0Jvb2xlYW4ob2JqKSB7XG5cbiAgICByZXR1cm4gb2JqID09PSB0cnVlIHx8IG9iaiA9PT0gZmFsc2UgfHwgdG9TdHJpbmcuY2FsbChvYmopID09PSBcIltvYmplY3QgQm9vbGVhbl1cIjtcbn1cbnV0aWwuaXNCb29sZWFuID0gaXNCb29sZWFuO1xuXG5cbmZ1bmN0aW9uIGlzTnVsbChvYmopIHtcblxuICAgIHJldHVybiBvYmogPT09IG51bGw7XG59XG51dGlsLmlzTnVsbCA9IGlzTnVsbDtcblxuXG5mdW5jdGlvbiBpc1VuZGVmaW5lZChvYmopIHtcblxuICAgIHJldHVybiBvYmogPT09IHZvaWQgMDtcbn1cbnV0aWwuaXNVbmRlZmluZWQgPSBpc1VuZGVmaW5lZDtcblxuXG5mdW5jdGlvbiBoYXMob2JqLCBrZXkpIHtcblxuICAgIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcbn1cbnV0aWwuaGFzID0gaGFzO1xuXG5cbmZ1bmN0aW9uIGZvcm1hdChmbXQpIHtcbiAgICB2YXIgaSA9IDEsXG4gICAgICAgIGFyZ3MgPSBhcmd1bWVudHMsXG4gICAgICAgIGxlbiA9IGFyZ3MubGVuZ3RoO1xuXG4gICAgcmV0dXJuIFN0cmluZyhmbXQpLnJlcGxhY2UoRk9STUFUX1JFR0VYLCBmdW5jdGlvbiAoeCkge1xuICAgICAgICBpZiAoeCA9PT0gXCIlJVwiKSByZXR1cm4gXCIlXCI7XG4gICAgICAgIGlmIChpID49IGxlbikgcmV0dXJuIHg7XG5cbiAgICAgICAgaWYgKHggPT09IFwiJXNcIikge1xuICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhhcmdzW2krK10pO1xuICAgICAgICB9IGVsc2UgaWYgKHggPT09IFwiJWRcIikge1xuICAgICAgICAgICAgcmV0dXJuIE51bWJlcihhcmdzW2krK10pO1xuICAgICAgICB9IGVsc2UgaWYgKHggPT09IFwiJWpcIikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYXJnc1tpKytdKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJbQ2lyY3VsYXJdXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4geDtcbiAgICAgICAgfVxuICAgIH0pO1xufVxudXRpbC5mb3JtYXQgPSBmb3JtYXQ7XG5cblxuZnVuY3Rpb24gY2FtZWxpemUod29yZCwgbG93Rmlyc3RMZXR0ZXIpIHtcbiAgICB2YXIgcGFydHMgPSB3b3JkLnNwbGl0KFNQSUxURVIpLFxuICAgICAgICBzdHJpbmcgPSBcIlwiLFxuICAgICAgICBwYXJ0LCBpLCBpbDtcblxuICAgIGZvciAoaSA9IDAsIGlsID0gcGFydHMubGVuZ3RoOyBpIDwgaWw7IGkrKykge1xuICAgICAgICBwYXJ0ID0gcGFydHNbaV07XG4gICAgICAgIHN0cmluZyArPSBwYXJ0WzBdLnRvVXBwZXJDYXNlKCkgKyBwYXJ0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGxvd0ZpcnN0TGV0dGVyID8gc3RyaW5nWzBdLnRvTG93ZXJDYXNlKCkgKyBzdHJpbmcuc2xpY2UoMSkgOiBzdHJpbmc7XG59O1xudXRpbC5jYW1lbGl6ZSA9IGNhbWVsaXplO1xuXG5cbmZ1bmN0aW9uIHVuZGVyc2NvcmUod29yZCkge1xuXG4gICAgcmV0dXJuIHdvcmQucmVwbGFjZShTUElMVEVSLCBcIlwiKS5yZXBsYWNlKFVOREVSU0NPUkUsIFwiJDFfJDJcIikudG9Mb3dlckNhc2UoKTtcbn07XG51dGlsLnVuZGVyc2NvcmUgPSB1bmRlcnNjb3JlO1xuXG5cbmZ1bmN0aW9uIG1lcmdlKG9iaiwgYWRkKSB7XG4gICAgdmFyIGtleTtcblxuICAgIGZvciAoa2V5IGluIGFkZCkge1xuICAgICAgICBpZiAob2JqW2tleV0gPT0gdW5kZWZpbmVkKSBvYmpba2V5XSA9IGFkZFtrZXldO1xuICAgIH1cblxuICAgIHJldHVybiBvYmo7XG59O1xudXRpbC5tZXJnZSA9IG1lcmdlO1xuXG5cbmZ1bmN0aW9uIG92ZXJyaWRlKG9iaiwgYWRkKSB7XG4gICAgdmFyIGtleTtcblxuICAgIGZvciAoa2V5IGluIGFkZCkge1xuICAgICAgICBpZiAoYWRkW2tleV0gIT0gdW5kZWZpbmVkKSBvYmpba2V5XSA9IGFkZFtrZXldO1xuICAgIH1cblxuICAgIHJldHVybiBvYmo7XG59O1xudXRpbC5vdmVycmlkZSA9IG92ZXJyaWRlO1xuXG5cbmZ1bmN0aW9uIGNvcHkob2JqLCBvdXQpIHtcbiAgICB2YXIgdHlwZSA9IHR5cGVvZihvYmopLFxuICAgICAgICBrZXksIGksIGlsO1xuXG4gICAgaWYgKHR5cGUgIT09IFwib2JqZWN0XCIpIHJldHVybiBvYmo7XG5cbiAgICBpZiAoaXNBcnJheUxpa2Uob2JqKSkge1xuICAgICAgICBvdXQgPSBbXTtcbiAgICAgICAgZm9yIChpID0gMCwgaWwgPSBvYmoubGVuZ3RoOyBpIDwgaWw7IGkrKykgb3V0W2ldID0gY29weShvYmpbaV0pO1xuICAgIH0gZWxzZSBpZiAoaXNPYmplY3Qob2JqKSkge1xuICAgICAgICBvdXQgPSB7fTtcbiAgICAgICAgZm9yIChrZXkgaW4gb2JqKSBvdXRba2V5XSA9IGNvcHkob2JqW2tleV0pO1xuICAgIH1cblxuICAgIHJldHVybiBvdXQ7XG59O1xudXRpbC5jb3B5ID0gY29weTtcblxuXG5mdW5jdGlvbiBjbGVhcihvYmopIHtcbiAgICB2YXIga2V5O1xuXG4gICAgZm9yIChrZXkgaW4gb2JqKSBkZWxldGUgb2JqW2tleV07XG5cbiAgICByZXR1cm4gb2JqO1xufTtcbnV0aWwuY2xlYXIgPSBjbGVhcjtcblxuXG51dGlsLmtleXMgPSBrZXlzO1xuXG5cbmZ1bmN0aW9uIGFycmF5QnVmZmVyVG9CYXNlNjQoYnVmZmVyKSB7XG4gICAgdmFyIGJpbmFyeSA9IFwiXCIsXG4gICAgICAgIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKSxcbiAgICAgICAgbGVuID0gYnl0ZXMuYnl0ZUxlbmd0aCxcbiAgICAgICAgaSA9IDA7XG5cbiAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSBiaW5hcnkgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1tpXSk7XG5cbiAgICByZXR1cm4gaXNTZXJ2ZXIgPyBuZXcgQnVmZmVyKGJpbmFyeS50b1N0cmluZygpLCBcImJpbmFyeVwiKS50b1N0cmluZyhcImJhc2U2NFwiKSA6IHdpbmRvdy5idG9hKGJpbmFyeSk7XG59XG51dGlsLmFycmF5QnVmZmVyVG9CYXNlNjQgPSBhcnJheUJ1ZmZlclRvQmFzZTY0O1xuXG5cbmZ1bmN0aW9uIGJhc2U2NFRvQXJyYXlCdWZmZXIoc3RyKSB7XG4gICAgdmFyIGJpbmFyeSA9IGlzU2VydmVyID8gbmV3IEJ1ZmZlcihzdHIsIFwiYmFzZTY0XCIpLnRvU3RyaW5nKFwiYmluYXJ5XCIpIDogd2luZG93LmF0b2Ioc3RyKSxcbiAgICAgICAgbGVuID0gYmluYXJ5Lmxlbmd0aCxcbiAgICAgICAgYnl0ZXMgPSBuZXcgVWludDhBcnJheShsZW4pLlxuICAgICAgICAgICAgaSA9IDA7XG5cbiAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSBieXRlc1tpXSA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuXG4gICAgcmV0dXJuIGJ5dGVzLmJ1ZmZlcjtcbn1cbnV0aWwuYmFzZTY0VG9BcnJheUJ1ZmZlciA9IGJhc2U2NFRvQXJyYXlCdWZmZXI7XG5cblxuZnVuY3Rpb24gdWlkKCkge1xuICAgIHJldHVybiBcInh4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eFwiLnJlcGxhY2UoVUlEX1JFUExBQ0VSLCBmdW5jdGlvbiAoYykge1xuICAgICAgICB2YXIgYSA9IDE2ICogcmFuZG9tKCkgfCAwO1xuICAgICAgICByZXR1cm4gKFwieFwiID09IGMgPyBhIDogYSAmIDMgfCA4KS50b1N0cmluZygxNik7XG4gICAgfSlcbn1cbnZhciBVSURfUkVQTEFDRVIgPSAvW3h5XS9nO1xudXRpbC51aWQgPSB1aWQ7XG5cblxuZnVuY3Rpb24gZWFjaChvYmosIGl0ZXJhdG9yLCBjdHgpIHtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybjtcblxuICAgIGlmIChBcnJheUZvckVhY2ggJiYgb2JqLmZvckVhY2ggPT09IEFycmF5Rm9yRWFjaCkge1xuICAgICAgICBvYmouZm9yRWFjaChpdGVyYXRvciwgY3R4KTtcbiAgICB9IGVsc2UgaWYgKG9iai5sZW5ndGggPT09ICtvYmoubGVuZ3RoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBvYmoubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpdGVyYXRvci5jYWxsKGN0eCwgb2JqW2ldLCBpLCBvYmopID09PSBmYWxzZSkgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG9iaktleXMgPSBrZXlzKG9iaik7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IG9iaktleXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpdGVyYXRvci5jYWxsKGN0eCwgb2JqW29iaktleXNbaV1dLCBvYmpLZXlzW2ldLCBvYmopID09PSBmYWxzZSkgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxufVxudXRpbC5lYWNoID0gZWFjaDtcblxuXG5mdW5jdGlvbiBub3JtYWxpemVQYXRoKHBhdGgpIHtcbiAgICB2YXIgcGFydHMgPSBwYXRoLnNwbGl0KFwiL1wiKSxcbiAgICAgICAgZGlyZWN0b3JpZXMgPSBbXSxcbiAgICAgICAgaSA9IDAsXG4gICAgICAgIGlsID0gcGFydHMubGVuZ3RoLFxuICAgICAgICBwcmV2LCBkaXJlY3Rvcnk7XG5cbiAgICBmb3IgKDsgaSA8IGlsOyBpKyspIHtcbiAgICAgICAgZGlyZWN0b3J5ID0gcGFydHNbaV07XG5cbiAgICAgICAgaWYgKGRpcmVjdG9yeSA9PT0gXCJcIiAmJiBpICE9PSAwICYmIGkgIT09IGlsKSBjb250aW51ZTtcbiAgICAgICAgaWYgKGRpcmVjdG9yeSA9PT0gXCIuXCIgJiYgcHJldiAhPT0gdW5kZWZpbmVkKSBjb250aW51ZTtcbiAgICAgICAgaWYgKGRpcmVjdG9yaWVzLmxlbmd0aCA9PT0gMSAmJiBkaXJlY3Rvcmllc1swXSA9PT0gXCJcIiAmJiAoZGlyZWN0b3J5ID09PSBcIi5cIiB8fCBkaXJlY3RvcnkgPT09IFwiLi5cIikpIGNvbnRpbnVlO1xuXG4gICAgICAgIGlmIChkaXJlY3RvcnkgPT09IFwiLi5cIiAmJiBkaXJlY3Rvcmllcy5sZW5ndGggJiYgcHJldiAhPT0gXCIuLlwiICYmIHByZXYgIT09IFwiLlwiICYmIHByZXYgIT09IHVuZGVmaW5lZCAmJiAocHJldiAhPT0gXCJcIikpIHtcbiAgICAgICAgICAgIGRpcmVjdG9yaWVzLnBvcCgpO1xuICAgICAgICAgICAgcHJldiA9IGRpcmVjdG9yaWVzWzBdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHByZXYgPT09IFwiLlwiKSBkaXJlY3Rvcmllcy5wb3AoKTtcbiAgICAgICAgICAgIGRpcmVjdG9yaWVzLnB1c2goZGlyZWN0b3J5KTtcbiAgICAgICAgICAgIHByZXYgPSBkaXJlY3Rvcnk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKChwYXRoID0gZGlyZWN0b3JpZXNbMF0pICYmIHBhdGguaW5kZXhPZihcIjpcIikgPT09IHBhdGgubGVuZ3RoIC0gMSkgZGlyZWN0b3JpZXNbMF0gKz0gXCIvXCI7XG5cbiAgICByZXR1cm4gZGlyZWN0b3JpZXMuam9pbihcIi9cIik7XG59XG51dGlsLm5vcm1hbGl6ZVBhdGggPSBub3JtYWxpemVQYXRoO1xuXG5cbmZ1bmN0aW9uIHJlbGF0aXZlUGF0aChwYXRoKSB7XG4gICAgcGF0aCB8fCAocGF0aCA9IFwiLi9cIik7XG4gICAgcmV0dXJuIG5vcm1hbGl6ZVBhdGgocmVxdWlyZS50b1VybChwYXRoKSk7XG59XG51dGlsLnJlbGF0aXZlUGF0aCA9IHJlbGF0aXZlUGF0aDtcblxuXG5mdW5jdGlvbiBhYnNvbHV0ZVBhdGgocGF0aCkge1xuICAgIHBhdGggfHwgKHBhdGggPSBcIi4vXCIpO1xuICAgIHJldHVybiBub3JtYWxpemVQYXRoKGN3ZCArIHJlcXVpcmUudG9VcmwocGF0aCkpO1xufVxudXRpbC5hYnNvbHV0ZVBhdGggPSBhYnNvbHV0ZVBhdGg7XG5cblxuaWYgKCFpc1NlcnZlcikge1xuICAgIHV0aWwuY3JlYXRlV29ya2VyID0gZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIHZhciBibG9iVVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTChcbiAgICAgICAgICAgICAgICBuZXcgQmxvYihbXG4gICAgICAgICAgICAgICAgICAgIFwiKGZ1bmN0aW9uKCkge1xcblwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJpbXBvcnRTY3JpcHRzKFxcXCJcIiArIGFic29sdXRlUGF0aChcIm9kaW4vcmVxdWlyZS5qc1wiKSArIFwiXFxcIik7XFxuXCIgK1xuICAgICAgICAgICAgICAgICAgICBcInJlcXVpcmUuY29uZmlnKHtiYXNlVXJsOiBcXFwiXCIgKyBhYnNvbHV0ZVBhdGgoXCIuL1wiKSArIFwiXFxcIn0pO1xcblwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIoXCIgKyBmbi50b1N0cmluZygpICsgXCIpLmNhbGwodGhpcyk7XFxuXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIn0pLmNhbGwodGhpcyk7XCJcbiAgICAgICAgICAgICAgICBdLCB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXBwbGljYXRpb24vamF2YXNjcmlwdFwiXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICB3b3JrZXIgPSBuZXcgV29ya2VyKGJsb2JVUkwpO1xuXG4gICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwoYmxvYlVSTCk7XG5cbiAgICAgICAgcmV0dXJuIHdvcmtlcjtcbiAgICB9O1xuXG4gICAgdXRpbC5hamF4ID0gZnVuY3Rpb24gYWpheChvcHRzKSB7XG4gICAgICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG4gICAgICAgIHZhciByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0LFxuICAgICAgICAgICAgc3JjID0gb3B0cy5zcmMsXG4gICAgICAgICAgICBtZXRob2QgPSBvcHRzLm1ldGhvZCB8fCAob3B0cy5tZXRob2QgPSBcIkdFVFwiKSxcbiAgICAgICAgICAgIGJlZm9yZSA9IG9wdHMuYmVmb3JlLFxuICAgICAgICAgICAgc3VjY2VzcyA9IG9wdHMuc3VjY2VzcyxcbiAgICAgICAgICAgIGVycm9yID0gb3B0cy5lcnJvcixcbiAgICAgICAgICAgIGFzeW5jID0gb3B0cy5hc3luYyAhPSB1bmRlZmluZWQgPyAhIW9wdHMuYXN5bmMgOiB0cnVlO1xuXG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHN0YXR1cyA9IHRoaXMuc3RhdHVzO1xuXG4gICAgICAgICAgICBpZiAoKHN0YXR1cyA+IDE5OSAmJiBzdGF0dXMgPCAzMDEpIHx8IHN0YXR1cyA9PSAzMDQpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mKHN1Y2Nlc3MpID09PSBcImZ1bmN0aW9uXCIpIHN1Y2Nlc3MuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZihlcnJvcikgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICBlcnJvci5jYWxsKHRoaXMsIG5ldyBFcnJvcihtZXRob2QgKyBcIiBcIiArIHNyYyArIFwiIFwiICsgc3RhdHVzKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1ldGhvZCArIFwiIFwiICsgc3JjICsgXCIgXCIgKyBzdGF0dXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZmFsc2UpO1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mKGVycm9yKSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgZXJyb3IobmV3IEVycm9yKG1ldGhvZCArIFwiIFwiICsgc3JjKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihtZXRob2QgKyBcIiBcIiArIHNyYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGZhbHNlKTtcblxuICAgICAgICByZXF1ZXN0Lm9wZW4obWV0aG9kLCBzcmMsIGFzeW5jKTtcbiAgICAgICAgaWYgKHR5cGVvZihiZWZvcmUpID09PSBcImZ1bmN0aW9uXCIpIGJlZm9yZS5jYWxsKHJlcXVlc3QpO1xuICAgICAgICByZXF1ZXN0LnNlbmQoKTtcbiAgICB9O1xufVxuXG5cbm1vZHVsZS5leHBvcnRzID0gdXRpbDtcblxufSkuY2FsbCh0aGlzLHJlcXVpcmUoJ19wcm9jZXNzJykscmVxdWlyZShcImJ1ZmZlclwiKS5CdWZmZXIpIiwidmFyIExvZyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2xvZ1wiKTtcbnZhciBDbGFzcyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2NsYXNzXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuXG5cbmZ1bmN0aW9uIEFzc2V0KG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQ2xhc3MuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMuX25hbWUgPSBvcHRzLm5hbWUgIT0gdW5kZWZpbmVkID8gb3B0cy5uYW1lIDogXCJBc3NldF9cIiArIHRoaXMuX2lkO1xuICAgIHRoaXMuX2xvYWRlZCA9IGZhbHNlO1xuXG4gICAgdGhpcy5qc29uID0gb3B0cy5qc29uICE9IHVuZGVmaW5lZCA/ICEhb3B0cy5qc29uIDogdHJ1ZTtcblxuICAgIHRoaXMuYXNzZXRzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubG9hZCA9IG9wdHMubG9hZCAhPSB1bmRlZmluZWQgPyAhIW9wdHMubG9hZCA6ICEhb3B0cy5zcmM7XG4gICAgdGhpcy5zcmMgPSBvcHRzLnNyYztcbiAgICB0aGlzLnJhdyA9IG9wdHMucmF3O1xufVxuXG5DbGFzcy5leHRlbmQoQXNzZXQpO1xuXG5cbmRlZmluZVByb3BlcnR5KEFzc2V0LnByb3RvdHlwZSwgXCJuYW1lXCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX25hbWU7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgYXNzZXRzID0gdGhpcy5hc3NldHMsXG4gICAgICAgICAgICBoYXNoO1xuXG4gICAgICAgIGlmIChhc3NldHMpIHtcbiAgICAgICAgICAgIGhhc2ggPSBhc3NldHMuaGFzaDtcblxuICAgICAgICAgICAgaWYgKGhhc2hbdmFsdWVdKSB7XG4gICAgICAgICAgICAgICAgTG9nLndhcm4oXCJBc3NldC5zZXQgbmFtZTogY2FuJ3QgY2hhbmdlIG5hbWUgdG8gXCIgKyB2YWx1ZSArIFwiIEFzc2V0cyBhbHJlYWR5IGhhdmUgYW4gYXNzZXQgd2l0aCBzYW1lIG5hbWVcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkZWxldGUgaGFzaFt0aGlzLm5hbWVdO1xuICAgICAgICAgICAgaGFzaFt2YWx1ZV0gPSB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fbmFtZSA9IHZhbHVlO1xuICAgIH1cbn0pO1xuXG5cbkFzc2V0LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICB0aGlzLnN5bmMgPSBvdGhlci5zeW5jO1xuICAgIHRoaXMuanNvbiA9IG90aGVyLmpzb247XG5cbiAgICB0aGlzLm5hbWUgPSBvdGhlci5uYW1lICsgXCIuXCIgKyB0aGlzLl9pZDtcbiAgICB0aGlzLnNyYyA9IG90aGVyLnNyYztcbiAgICB0aGlzLnJhdyA9IG90aGVyLnJhdztcblxuICAgIGlmIChvdGhlci5hc3NldHMgJiYgdGhpcy5hc3NldHMgIT09IG90aGVyLmFzc2V0cykgb3RoZXIuYXNzZXRzLmFkZEFzc2V0KHRoaXMpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkFzc2V0LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMucmF3ID0gbnVsbDtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuQXNzZXQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmFzc2V0cykge1xuICAgICAgICBMb2cuZXJyb3IoXCJBc3NldC5kZXN0cm95OiBjYW4ndCBkZXN0cm95IEFzc2V0IGlmIGl0J3Mgbm90IGFkZGVkIHRvIEFzc2V0c1wiKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgdGhpcy5hc3NldHMucmVtb3ZlQXNzZXQodGhpcyk7XG4gICAgdGhpcy5jbGVhcigpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkFzc2V0LnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChyYXcpIHtcblxuICAgIHRoaXMucmF3ID0gcmF3O1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5Bc3NldC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24sIHBhY2spIHtcbiAgICBqc29uID0gQ2xhc3MucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi5uYW1lID0gdGhpcy5uYW1lO1xuICAgIGlmICghcGFjaykganNvbi5zcmMgPSB0aGlzLnNyYztcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5Bc3NldC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENsYXNzLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy5uYW1lID0ganNvbi5uYW1lO1xuICAgIHRoaXMuc3JjID0ganNvbi5zcmM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBBc3NldDtcbiIsInZhciBEZXZpY2UgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9kZXZpY2VcIik7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL3V0aWxcIik7XG52YXIgRXZlbnRFbWl0dGVyID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvZXZlbnRfZW1pdHRlclwiKTtcbnZhciBBdWRpb0N0eCA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2F1ZGlvX2N0eFwiKTtcbnZhciBBc3NldCA9IHJlcXVpcmUoXCIuL2Fzc2V0XCIpO1xudmFyIEFzc2V0cyA9IHJlcXVpcmUoXCIuL2Fzc2V0c1wiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9sb2dcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgaXNBcnJheSA9IHV0aWwuaXNBcnJheSxcbiAgICBhamF4ID0gdXRpbC5hamF4LFxuICAgIGVhY2ggPSB1dGlsLmVhY2g7XG5cblxuZnVuY3Rpb24gZ2V0RXh0KHNyYykge1xuXG4gICAgcmV0dXJuIHNyYyA/IChzcmMuc3BsaXQoXCIuXCIpLnBvcCgpKS50b0xvd2VyQ2FzZSgpIDogXCJub25lXCI7XG59O1xuXG5cbmZ1bmN0aW9uIEFzc2V0TG9hZGVyKCkge1xuXG4gICAgRXZlbnRFbWl0dGVyLmNhbGwodGhpcyk7XG5cbiAgICB2YXIgc3VwcG9ydHMgPSB0aGlzLnN1cHBvcnRzID0gW1wianNvblwiLCBcImpwZWdcIiwgXCJqcGdcIiwgXCJwbmdcIiwgXCJnaWZcIl07XG5cbiAgICBpZiAoRGV2aWNlLmF1ZGlvTXBlZykgc3VwcG9ydHMucHVzaChcIm1wZWdcIik7XG4gICAgaWYgKERldmljZS5hdWRpb09nZyB8fCBEZXZpY2UudmlkZW9PZ2cpIHN1cHBvcnRzLnB1c2goXCJvZ2dcIik7XG4gICAgaWYgKERldmljZS5hdWRpb01wMykgc3VwcG9ydHMucHVzaChcIm1wM1wiKTtcbiAgICBpZiAoRGV2aWNlLmF1ZGlvTXA0IHx8IERldmljZS52aWRlb01wNCkgc3VwcG9ydHMucHVzaChcIm1wNFwiKTtcbn1cblxuRXZlbnRFbWl0dGVyLmV4dGVuZChBc3NldExvYWRlcik7XG5cblxuQXNzZXRMb2FkZXIucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAocmVsb2FkKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcyxcbiAgICAgICAgY291bnQgPSBBc3NldHMubGVuZ3RoLFxuICAgICAgICBpID0gY291bnQsXG4gICAgICAgIGZuID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgaWYgKGVycikgTG9nLmVycm9yKGVycik7XG5cbiAgICAgICAgICAgIGNvdW50LS07XG4gICAgICAgICAgICBpZiAoY291bnQgPD0gMCkgX3RoaXMuZW1pdChcImxvYWRcIik7XG4gICAgICAgIH07XG5cbiAgICBpZiAoIWNvdW50KSB0aGlzLmVtaXQoXCJsb2FkXCIpO1xuICAgIHdoaWxlIChpLS0pIHRoaXMubG9hZEFzc2V0KEFzc2V0c1tpXSwgZm4sIHJlbG9hZCwgdHJ1ZSk7XG59O1xuXG5cbkFzc2V0TG9hZGVyLnByb3RvdHlwZS5sb2FkQXNzZXQgPSBmdW5jdGlvbiAoYXNzZXQsIGNhbGxiYWNrLCByZWxvYWQsIGtub3duKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcyxcbiAgICAgICAgc3VwcG9ydHMgPSB0aGlzLnN1cHBvcnRzLFxuICAgICAgICBzcmMgPSBhc3NldC5zcmM7XG5cbiAgICBpZiAoIWtub3duIHx8IEFzc2V0cy5pbmRleE9mKGFzc2V0KSA9PT0gLTEpIEFzc2V0cy5hZGRBc3NldChhc3NldCk7XG5cbiAgICBpZiAoIWFzc2V0LmxvYWQgfHwgIXNyYyB8fCBhc3NldC5yYXcgJiYgIXJlbG9hZCkge1xuICAgICAgICBhc3NldC5fbG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKVxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIDtcblxuICAgIGlmIChpc0FycmF5KHNyYykpIHtcbiAgICAgICAgdmFyIHJhdyA9IFtdLFxuICAgICAgICAgICAgZXh0cyA9IFtdLFxuICAgICAgICAgICAgbG9hZGVkID0gc3JjLmxlbmd0aCxcbiAgICAgICAgICAgIGhhc0V4dCA9IGZhbHNlO1xuXG4gICAgICAgIGVhY2goc3JjLCBmdW5jdGlvbiAocywgaSkge1xuICAgICAgICAgICAgdmFyIGV4dCA9IGdldEV4dChzKTtcbiAgICAgICAgICAgIGV4dHMucHVzaChleHQpO1xuXG4gICAgICAgICAgICBpZiAoIXRoaXNbZXh0XSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKG5ldyBFcnJvcihcIkFzc2V0TG9hZGVyLmxvYWQ6IGhhcyBubyBsb2FkZXIgZm9yIFwiICsgc3JjICsgXCIgb2YgdHlwZSBcIiArIGV4dCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpc1tleHRdKHMsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcbiAgICAgICAgICAgICAgICBsb2FkZWQtLTtcbiAgICAgICAgICAgICAgICByYXdbaV0gPSBkYXRhO1xuXG4gICAgICAgICAgICAgICAgaWYgKGVycikgTG9nLmVycm9yKGVycik7XG5cbiAgICAgICAgICAgICAgICBpZiAobG9hZGVkIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IGV4dHMubGVuZ3RoOyBqLS07KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VwcG9ydHMuaW5kZXhPZihleHRzW2ldKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNFeHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNFeHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKG5ldyBFcnJvcihcIkFzc2V0TG9hZGVyLmxvYWQ6IGRldmljZSBkb2VzIG5vdCBzdXBwb3J0IGFueSBvZiB0aGUgZ2l2ZW4gZmlsZSB0eXBlcyBcIiArIGV4dHMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGFzc2V0Ll9sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBhc3NldC5wYXJzZShyYXcpO1xuICAgICAgICAgICAgICAgICAgICBhc3NldC5lbWl0KFwibG9hZFwiLCByYXcpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5lbWl0KFwibG9hZEFzc2V0XCIsIGFzc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBleHQgPSBnZXRFeHQoc3JjKTtcblxuICAgICAgICBpZiAoIXRoaXNbZXh0XSkge1xuICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2sobmV3IEVycm9yKFwiQXNzZXRMb2FkZXIubG9hZDogaGFzIG5vIGxvYWRlciBmaWxlIFwiICsgc3JjICsgXCIgb2YgdHlwZSBcIiArIGV4dCkpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdXBwb3J0cy5pbmRleE9mKGV4dCkgPT09IC0xKSB7XG4gICAgICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhuZXcgRXJyb3IoXCJBc3NldExvYWRlci5sb2FkOiBkZXZpY2UgZG9lcyBub3Qgc3VwcG9ydCBmaWxlIFwiICsgc3JjICsgXCIgb2YgdHlwZSBcIiArIGV4dCkpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpc1tleHRdKHNyYywgZnVuY3Rpb24gKGVyciwgcmF3KSB7XG4gICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2sobmV3IEVycm9yKFwiQXNzZXRMb2FkZXIubG9hZDogXCIgKyBlcnIubWVzc2FnZSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXNzZXQuX2xvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICBhc3NldC5wYXJzZShyYXcpO1xuICAgICAgICAgICAgYXNzZXQuZW1pdChcImxvYWRcIiwgcmF3KTtcbiAgICAgICAgICAgIF90aGlzLmVtaXQoXCJsb2FkQXNzZXRcIiwgYXNzZXQpO1xuICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKTtcbiAgICAgICAgfSk7XG4gICAgfVxufTtcblxuXG5Bc3NldExvYWRlci5wcm90b3R5cGUuZ2lmID0gQXNzZXRMb2FkZXIucHJvdG90eXBlLmpwZyA9IEFzc2V0TG9hZGVyLnByb3RvdHlwZS5qcGVnID0gQXNzZXRMb2FkZXIucHJvdG90eXBlLnBuZyA9IGZ1bmN0aW9uIChzcmMsIGNhbGxiYWNrKSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlO1xuXG4gICAgaW1hZ2Uub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhudWxsLCBpbWFnZSk7XG4gICAgfTtcbiAgICBpbWFnZS5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhuZXcgRXJyb3IoXCJHRVQgXCIgKyBzcmMgKyBcIiA0MDQgKE5vdCBGb3VuZClcIikpO1xuICAgIH07XG5cbiAgICBpbWFnZS5zcmMgPSBzcmM7XG59O1xuXG5cbkFzc2V0TG9hZGVyLnByb3RvdHlwZS5qc29uID0gZnVuY3Rpb24gKHNyYywgY2FsbGJhY2spIHtcblxuICAgIGFqYXgoe1xuICAgICAgICBzcmM6IHNyYyxcbiAgICAgICAgYmVmb3JlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xuICAgICAgICB9LFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIganNvbiA9IHRoaXMucmVzcG9uc2VUZXh0O1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGpzb24gPSBKU09OLnBhcnNlKHRoaXMucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKGVycik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhudWxsLCBqc29uKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKGVycik7XG4gICAgICAgIH1cbiAgICB9KTtcbn07XG5cblxuQXNzZXRMb2FkZXIucHJvdG90eXBlLm9nZyA9IEFzc2V0TG9hZGVyLnByb3RvdHlwZS53YXYgPSBBc3NldExvYWRlci5wcm90b3R5cGUubXAzID0gQXNzZXRMb2FkZXIucHJvdG90eXBlLmFhYyA9IGZ1bmN0aW9uIChzcmMsIGNhbGxiYWNrKSB7XG5cbiAgICBhamF4KHtcbiAgICAgICAgc3JjOiBzcmMsXG4gICAgICAgIGJlZm9yZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5yZXNwb25zZVR5cGUgPSBcImFycmF5YnVmZmVyXCI7XG4gICAgICAgIH0sXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChBdWRpb0N0eCkge1xuICAgICAgICAgICAgICAgIGlmIChBdWRpb0N0eC5kZWNvZGVBdWRpb0RhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgQXVkaW9DdHguZGVjb2RlQXVkaW9EYXRhKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNwb25zZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MoYnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2sobnVsbCwgYnVmZmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBmYWlsdXJlKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKG5ldyBFcnJvcihcIkF1ZGlvQ29udGV4dCBGYWlsZWQgdG8gcGFyc2UgQXVkaW8gQ2xpcFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IEF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlcih0aGlzLnJlc3BvbnNlLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGJ1ZmZlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2sobnVsbCwgYnVmZmVyKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKG5ldyBFcnJvcihcIkF1ZGlvQ29udGV4dCBGYWlsZWQgdG8gcGFyc2UgQXVkaW8gQ2xpcFwiKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKG5ldyBFcnJvcihcIkF1ZGlvQ29udGV4dCAoV2ViQXVkaW8gQVBJKSBpcyBub3Qgc3VwcG9ydGVkIGJ5IHRoaXMgYnJvd3NlclwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhlcnIpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IEFzc2V0TG9hZGVyO1xuIiwidmFyIENsYXNzID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvY2xhc3NcIik7XG52YXIgQXNzZXQgPSByZXF1aXJlKFwiLi9hc3NldFwiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9sb2dcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBBc3NldHMoKSB7XG5cbiAgICBBcnJheS5jYWxsKHRoaXMpO1xuXG4gICAgdGhpcy5oYXNoID0ge307XG59XG5cbkFzc2V0cy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEFycmF5LnByb3RvdHlwZSk7XG5Bc3NldHMucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQXNzZXRzO1xuXG5cbkFzc2V0cy5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB2YXIgYXNzZXQgPSB0aGlzLmhhc2hbbmFtZV07XG4gICAgaWYgKGFzc2V0KSByZXR1cm4gYXNzZXQ7XG5cbiAgICBMb2cuZXJyb3IoXCJBc3NldHMuZ2V0OiBjYW4ndCBmaW5kIGFzc2V0IHdpdGggbmFtZSBcIiArIG5hbWUgKyBcIiwgaXQgaGFzIG5vdCBiZWVuIGFkZGVkIHRvIEFzc2V0cywgdXNlIEFzc2V0cy5hZGRBc3NldChhc3NldClcIik7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cblxuQXNzZXRzLnByb3RvdHlwZS5hZGRBc3NldCA9IGZ1bmN0aW9uIChhc3NldCkge1xuICAgIGlmICghKGFzc2V0IGluc3RhbmNlb2YgQXNzZXQpKSB7XG4gICAgICAgIExvZy5lcnJvcihcIkFzc2V0cy5hZGRBc3NldDogY2FuJ3QgYWRkIHBhc3NlZCBhcmd1bWVudCwgaXQgaXMgbm90IGFuIGluc3RhbmNlIG9mIEFzc2V0XCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdmFyIG5hbWUgPSBhc3NldC5uYW1lO1xuXG4gICAgaWYgKHRoaXMuaGFzaFtuYW1lXSkge1xuICAgICAgICBMb2cuZXJyb3IoXCJBc3NldHMuYWRkQXNzZXQ6IEFzc2V0cyBhbHJlYWR5IGhhdmUgQXNzZXQgbmFtZWQgXCIgKyBhc3NldC5uYW1lKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBhc3NldC5hc3NldHMgPSB0aGlzO1xuICAgIHRoaXMucHVzaChhc3NldCk7XG4gICAgdGhpcy5oYXNoW25hbWVdID0gYXNzZXQ7XG5cbiAgICByZXR1cm4gYXNzZXQ7XG59O1xuXG5cbkFzc2V0cy5wcm90b3R5cGUuYWRkQXNzZXRzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpLCBpbDtcblxuICAgIGZvciAoaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHRoaXMuYWRkQXNzZXQoYXJndW1lbnRzW2ldKTtcbn07XG5cblxuQXNzZXRzLnByb3RvdHlwZS5yZW1vdmVBc3NldCA9IGZ1bmN0aW9uIChhc3NldCkge1xuICAgIHZhciBuYW1lID0gdHlwZW9mKGFzc2V0KSA9PT0gXCJzdHJpbmdcIiA/IGFzc2V0IDogYXNzZXQubmFtZTtcbiAgICBhc3NldCA9IHRoaXMuaGFzaFtuYW1lXTtcblxuICAgIGlmICghYXNzZXQpIHtcbiAgICAgICAgTG9nLmVycm9yKFwiQXNzZXRzLnJlbW92ZUFzc2V0OiBBc3NldHMgZG9lcyBub3QgaGF2ZSBhbiBBc3NldCBuYW1lZCBcIiArIG5hbWUpO1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHRoaXMuc3BsaWNlKHRoaXMuaW5kZXhPZihhc3NldCksIDEpO1xuICAgIHRoaXMuaGFzaFtuYW1lXSA9IG51bGw7XG5cbiAgICByZXR1cm4gYXNzZXQ7XG59O1xuXG5cbkFzc2V0cy5wcm90b3R5cGUucmVtb3ZlQXNzZXRzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpLCBpbDtcblxuICAgIGZvciAoaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHRoaXMucmVtb3ZlQXNzZXQoYXJndW1lbnRzW2ldKTtcbn07XG5cblxuQXNzZXRzLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbiwgcGFjaykge1xuICAgIGpzb24gfHwgKGpzb24gPSB7fSk7XG4gICAgdmFyIGpzb25Bc3NldHMgPSBqc29uLmFzc2V0cyB8fCAoanNvbi5hc3NldHMgPSBbXSksXG4gICAgICAgIGpzb25Bc3NldCxcbiAgICAgICAgaSA9IHRoaXMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZiAoKGpzb25Bc3NldCA9IHRoaXNbaV0pLmpzb24pIGpzb25Bc3NldHNbaV0gPSBqc29uQXNzZXQudG9KU09OKGpzb25Bc3NldHNbaV0sIHBhY2spO1xuICAgIH1cblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5Bc3NldHMucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICB2YXIgYXNzZXRzSGFzaCA9IHRoaXMuaGFzaCxcbiAgICAgICAganNvbkFzc2V0cyA9IGpzb24uYXNzZXRzIHx8IChqc29uLmFzc2V0cyA9IFtdKSxcbiAgICAgICAgYXNzZXQsIGpzb25Bc3NldCxcbiAgICAgICAgaSA9IGpzb25Bc3NldHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZiAoIShqc29uQXNzZXQgPSBqc29uQXNzZXRzW2ldKSkgY29udGludWU7XG5cbiAgICAgICAgaWYgKChhc3NldCA9IGFzc2V0c0hhc2hbanNvbkFzc2V0Lm5hbWVdKSkge1xuICAgICAgICAgICAgYXNzZXQuZnJvbUpTT04oanNvbkFzc2V0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWRkKENsYXNzLmZyb21KU09OKGpzb25Bc3NldCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IEFzc2V0cztcbiIsInZhciB1dGlsID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvdXRpbFwiKTtcbnZhciBBdWRpb0N0eCA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2F1ZGlvX2N0eFwiKTtcbnZhciBBc3NldCA9IHJlcXVpcmUoXCIuL2Fzc2V0XCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGlzQXJyYXkgPSB1dGlsLmlzQXJyYXksXG4gICAgZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHksXG4gICAgYXJyYXlCdWZmZXJUb0Jhc2U2NCA9IHV0aWwuYXJyYXlCdWZmZXJUb0Jhc2U2NCxcbiAgICBiYXNlNjRUb0FycmF5QnVmZmVyID0gdXRpbC5iYXNlNjRUb0FycmF5QnVmZmVyO1xuXG5cbmZ1bmN0aW9uIEF1ZGlvQ2xpcChvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIEFzc2V0LmNhbGwodGhpcywgb3B0cyk7XG59XG5cbkFzc2V0LmV4dGVuZChBdWRpb0NsaXApO1xuXG5cbmRlZmluZVByb3BlcnR5KEF1ZGlvQ2xpcC5wcm90b3R5cGUsIFwibGVuZ3RoXCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmF3ID8gdGhpcy5yYXcuZHVyYXRpb24gOiAwO1xuICAgIH1cbn0pO1xuXG5cbmRlZmluZVByb3BlcnR5KEF1ZGlvQ2xpcC5wcm90b3R5cGUsIFwic2FtcGxlc1wiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJhdyA/IHRoaXMucmF3Lmxlbmd0aCA6IDA7XG4gICAgfVxufSk7XG5cblxuZGVmaW5lUHJvcGVydHkoQXVkaW9DbGlwLnByb3RvdHlwZSwgXCJmcmVxdWVuY3lcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yYXcgPyB0aGlzLnJhdy5zYW1wbGVSYXRlIDogNDQxMDA7XG4gICAgfVxufSk7XG5cblxuZGVmaW5lUHJvcGVydHkoQXVkaW9DbGlwLnByb3RvdHlwZSwgXCJjaGFubmVsc1wiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJhdyA/IHRoaXMucmF3Lm51bWJlck9mQ2hhbm5lbHMgOiAwO1xuICAgIH1cbn0pO1xuXG5cbkF1ZGlvQ2xpcC5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAocmF3KSB7XG4gICAgQXNzZXQucHJvdG90eXBlLnBhcnNlLmNhbGwodGhpcywgcmF3KTtcbiAgICB2YXIgaTtcblxuICAgIGlmIChpc0FycmF5KHJhdykpIHtcbiAgICAgICAgaSA9IHJhdy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgIGlmIChyYXdbaV0pIHRoaXMucmF3ID0gcmF3W2ldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkF1ZGlvQ2xpcC5wcm90b3R5cGUuZ2V0RGF0YSA9IGZ1bmN0aW9uIChhcnJheSwgb2Zmc2V0KSB7XG4gICAgYXJyYXkgfHwgKGFycmF5ID0gW10pO1xuXG4gICAgcmV0dXJuIHRoaXMucmF3ID8gdGhpcy5yYXcuZ2V0Q2hhbm5lbERhdGEoYXJyYXksIG9mZnNldCkgOiBhcnJheTtcbn07XG5cblxuQXVkaW9DbGlwLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbiwgcGFjaykge1xuICAgIGpzb24gPSBBc3NldC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbiwgcGFjayk7XG5cbiAgICBpZiAoKHBhY2sgfHwgIXRoaXMuc3JjKSAmJiB0aGlzLnJhdykganNvbi5yYXcgPSBhcnJheUJ1ZmZlclRvQmFzZTY0KHRoaXMucmF3KTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5BdWRpb0NsaXAucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24sIHBhY2spIHtcbiAgICBBc3NldC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uLCBwYWNrKTtcblxuICAgIGlmICgocGFjayB8fCAhdGhpcy5zcmMpICYmIHRoaXMucmF3KSB0aGlzLnJhdyA9IGJhc2U2NFRvQXJyYXlCdWZmZXIoanNvbi5yYXcpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gQXVkaW9DbGlwO1xuIiwidmFyIHV0aWwgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS91dGlsXCIpO1xudmFyIFJlY3QgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9yZWN0XCIpO1xudmFyIFZlYzMgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWMzXCIpO1xudmFyIENvbG9yID0gcmVxdWlyZShcIi4uLy4uL21hdGgvY29sb3JcIik7XG52YXIgQXNzZXQgPSByZXF1aXJlKFwiLi9hc3NldFwiKTtcbnZhciBBc3NldHMgPSByZXF1aXJlKFwiLi9hc3NldHNcIik7XG52YXIgRW51bXMgPSByZXF1aXJlKFwiLi4vZW51bXNcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgbWVyZ2UgPSB1dGlsLm1lcmdlO1xuXG5cbmZ1bmN0aW9uIE1hdGVyaWFsKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQXNzZXQuY2FsbCh0aGlzLCBvcHRzKTtcblxuICAgIHRoaXMuYmxlbmRpbmcgPSBvcHRzLmJsZW5kaW5nICE9IHVuZGVmaW5lZCA/IG9wdHMuYmxlbmRpbmcgOiBFbnVtcy5CbGVuZGluZy5EZWZhdWx0O1xuICAgIHRoaXMuc2lkZSA9IG9wdHMuc2lkZSAhPSB1bmRlZmluZWQgPyBvcHRzLnNpZGUgOiBFbnVtcy5TaWRlLkZyb250O1xuXG4gICAgdGhpcy53aXJlZnJhbWUgPSBvcHRzLndpcmVmcmFtZSAhPSB1bmRlZmluZWQgPyBvcHRzLndpcmVmcmFtZSA6IGZhbHNlO1xuICAgIHRoaXMud2lyZWZyYW1lTGluZVdpZHRoID0gb3B0cy53aXJlZnJhbWVMaW5lV2lkdGggIT0gdW5kZWZpbmVkID8gb3B0cy53aXJlZnJhbWVMaW5lV2lkdGggOiAxLjA7XG5cbiAgICB0aGlzLnNoYWRlciA9IG9wdHMuc2hhZGVyICE9IHVuZGVmaW5lZCA/IG9wdHMuc2hhZGVyIDogdW5kZWZpbmVkO1xuXG4gICAgdGhpcy51bmlmb3JtcyA9IG1lcmdlKG9wdHMudW5pZm9ybXMgfHwge30sIHtcbiAgICAgICAgZGlmZnVzZUNvbG9yOiBuZXcgQ29sb3IoMS4wLCAxLjAsIDEuMCksXG4gICAgICAgIHNoaW5pbmVzczogOC4wLFxuICAgICAgICBub3JtYWxTY2FsZTogMS4wXG4gICAgfSk7XG5cbiAgICB0aGlzLnJlY2VpdmVTaGFkb3cgPSBvcHRzLnJlY2VpdmVTaGFkb3cgIT0gdW5kZWZpbmVkID8gISFvcHRzLnJlY2VpdmVTaGFkb3cgOiB0cnVlO1xuICAgIHRoaXMuY2FzdFNoYWRvdyA9IG9wdHMuY2FzdFNoYWRvdyAhPSB1bmRlZmluZWQgPyAhIW9wdHMuY2FzdFNoYWRvdyA6IHRydWU7XG5cbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn1cblxuQXNzZXQuZXh0ZW5kKE1hdGVyaWFsKTtcblxuXG5NYXRlcmlhbC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIEFzc2V0LnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcywgb3RoZXIpO1xuXG4gICAgdGhpcy5ibGVuZGluZyA9IG90aGVyLmJsZW5kaW5nO1xuICAgIHRoaXMuc2lkZSA9IG90aGVyLnNpZGU7XG5cbiAgICB0aGlzLndpcmVmcmFtZSA9IG90aGVyLndpcmVmcmFtZTtcbiAgICB0aGlzLndpcmVmcmFtZUxpbmVXaWR0aCA9IG90aGVyLndpcmVmcmFtZUxpbmVXaWR0aDtcblxuICAgIHRoaXMuc2hhZGVyID0gb3RoZXIuc2hhZGVyO1xuXG4gICAgdGhpcy51bmlmb3JtcyA9IGNvcHkob3RoZXIudW5pZm9ybXMpO1xuXG4gICAgdGhpcy5yZWNlaXZlU2hhZG93ID0gb3RoZXIucmVjZWl2ZVNoYWRvdztcbiAgICB0aGlzLmNhc3RTaGFkb3cgPSBvdGhlci5jYXN0U2hhZG93O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbk1hdGVyaWFsLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChyYXcpIHtcbiAgICBBc3NldC5wcm90b3R5cGUucGFyc2UuY2FsbCh0aGlzLCByYXcpO1xuXG4gICAgdGhpcy5mcm9tSlNPTihyYXcpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbk1hdGVyaWFsLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICBBc3NldC5wcm90b3R5cGUuY2xlYXIuY2FsbCh0aGlzKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5NYXRlcmlhbC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24sIHBhY2spIHtcbiAgICBqc29uID0gQXNzZXQucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24sIHBhY2spO1xuXG4gICAganNvbi5ibGVuZGluZyA9IHRoaXMuYmxlbmRpbmc7XG4gICAganNvbi5zaWRlID0gdGhpcy5zaWRlO1xuXG4gICAganNvbi53aXJlZnJhbWUgPSB0aGlzLndpcmVmcmFtZTtcbiAgICBqc29uLndpcmVmcmFtZUxpbmVXaWR0aCA9IHRoaXMud2lyZWZyYW1lTGluZVdpZHRoO1xuXG4gICAganNvbi5zaGFkZXIgPSB0aGlzLnNoYWRlciAhPSB1bmRlZmluZWQgPyB0aGlzLnNoYWRlci5uYW1lIDogdW5kZWZpbmVkO1xuXG4gICAgdG9KU09OKHRoaXMudW5pZm9ybXMsIGpzb24udW5pZm9ybXMgfHwgKGpzb24udW5pZm9ybXMgPSB7fSkpO1xuXG4gICAganNvbi5yZWNlaXZlU2hhZG93ID0gdGhpcy5yZWNlaXZlU2hhZG93O1xuICAgIGpzb24uY2FzdFNoYWRvdyA9IHRoaXMuY2FzdFNoYWRvdztcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5NYXRlcmlhbC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIEFzc2V0LnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy5ibGVuZGluZyA9IGpzb24uYmxlbmRpbmc7XG4gICAgdGhpcy5zaWRlID0ganNvbi5zaWRlO1xuXG4gICAgdGhpcy53aXJlZnJhbWUgPSBqc29uLndpcmVmcmFtZTtcbiAgICB0aGlzLndpcmVmcmFtZUxpbmVXaWR0aCA9IGpzb24ud2lyZWZyYW1lTGluZVdpZHRoO1xuXG4gICAgdGhpcy5zaGFkZXIgPSBqc29uLnNoYWRlciAhPSB1bmRlZmluZWQgPyBBc3NldHMuZ2V0KGpzb24uc2hhZGVyKSA6IHVuZGVmaW5lZDtcblxuICAgIGZyb21KU09OKHRoaXMudW5pZm9ybXMsIGpzb24udW5pZm9ybXMpO1xuXG4gICAgdGhpcy5yZWNlaXZlU2hhZG93ID0ganNvbi5yZWNlaXZlU2hhZG93O1xuICAgIHRoaXMuY2FzdFNoYWRvdyA9IGpzb24uY2FzdFNoYWRvdztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5mdW5jdGlvbiB0b0pTT04ob2JqLCBqc29uKSB7XG4gICAgdmFyIHZhbHVlLCBrZXk7XG5cbiAgICBmb3IgKGtleSBpbiBvYmopIHtcbiAgICAgICAgdmFsdWUgPSBvYmpba2V5XTtcblxuICAgICAgICBpZiAodHlwZW9mKHZhbHVlKSAhPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAganNvbltrZXldID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUudG9KU09OKSB7XG4gICAgICAgICAgICBqc29uW2tleV0gPSB2YWx1ZS50b0pTT04oanNvbltrZXldKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGpzb25ba2V5XSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGpzb247XG59XG5cblxuZnVuY3Rpb24gZnJvbUpTT04ob2JqLCBqc29uKSB7XG4gICAgdmFyIGNsYXNzZXMgPSBDbGFzcy5fY2xhc3NlcyxcbiAgICAgICAgbWF0aENsYXNzZXMgPSBNYXRoZi5fY2xhc3NlcyxcbiAgICAgICAgdmFsdWUsIGtleTtcblxuICAgIGZvciAoa2V5IGluIGpzb24pIHtcbiAgICAgICAgdmFsdWUgPSBqc29uW2tleV07XG5cbiAgICAgICAgaWYgKHR5cGVvZih2YWx1ZSkgIT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIG9ialtrZXldID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSBpZiAobWF0aENsYXNzZXNbdmFsdWUuX2NsYXNzTmFtZV0pIHtcbiAgICAgICAgICAgIG9ialtrZXldID0gTWF0aGYuZnJvbUpTT04odmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGNsYXNzZXNbdmFsdWUuX2NsYXNzTmFtZV0pIHtcbiAgICAgICAgICAgIG9ialtrZXldID0gQ2xhc3MuZnJvbUpTT04odmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb2JqW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG5mdW5jdGlvbiBjb3B5KG9iaikge1xuICAgIHZhciBvdXQgPSB7fSxcbiAgICAgICAgY2xhc3NlcyA9IENsYXNzLl9jbGFzc2VzLFxuICAgICAgICBtYXRoQ2xhc3NlcyA9IE1hdGhmLl9jbGFzc2VzLFxuICAgICAgICB2YWx1ZSwga2V5O1xuXG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XG4gICAgICAgIHZhbHVlID0gb2JqW2tleV07XG5cbiAgICAgICAgaWYgKHR5cGVvZih2YWx1ZSkgIT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIG91dFtrZXldID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSBpZiAobWF0aENsYXNzZXNbdmFsdWUuX2NsYXNzTmFtZV0pIHtcbiAgICAgICAgICAgIG91dFtrZXldID0gbmV3IG1hdGhDbGFzc2VzW3ZhbHVlLl9jbGFzc05hbWVdKCkuY29weSh2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY2xhc3Nlc1t2YWx1ZS5fY2xhc3NOYW1lXSkge1xuICAgICAgICAgICAgb3V0W2tleV0gPSBuZXcgY2xhc3Nlc1t2YWx1ZS5fY2xhc3NOYW1lXSgpLmNvcHkodmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb3V0W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBvdXQ7XG59XG5cblxubW9kdWxlLmV4cG9ydHMgPSBNYXRlcmlhbDtcbiIsInZhciBBc3NldCA9IHJlcXVpcmUoXCIuL2Fzc2V0XCIpO1xudmFyIE1lc2hCb25lID0gcmVxdWlyZShcIi4vbWVzaF9ib25lXCIpO1xudmFyIFZlYzIgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWMyXCIpO1xudmFyIFZlYzMgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWMzXCIpO1xudmFyIFZlYzQgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWM0XCIpO1xudmFyIENvbG9yID0gcmVxdWlyZShcIi4uLy4uL21hdGgvY29sb3JcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBNZXNoKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQXNzZXQuY2FsbCh0aGlzLCBvcHRzKTtcblxuICAgIHRoaXMudmVydGljZXMgPSBvcHRzLnZlcnRpY2VzICE9IHVuZGVmaW5lZCA/IG9wdHMudmVydGljZXMgOiBbXTtcblxuICAgIHRoaXMubm9ybWFscyA9IG9wdHMubm9ybWFscyAhPSB1bmRlZmluZWQgPyBvcHRzLm5vcm1hbHMgOiBbXTtcblxuICAgIHRoaXMudGFuZ2VudHMgPSBvcHRzLnRhbmdlbnRzICE9IHVuZGVmaW5lZCA/IG9wdHMudGFuZ2VudHMgOiBbXTtcblxuICAgIHRoaXMuaW5kaWNlcyA9IG9wdHMuaW5kaWNlcyAhPSB1bmRlZmluZWQgPyBvcHRzLmluZGljZXMgOiBbXTtcblxuICAgIHRoaXMuY29sb3JzID0gb3B0cy5jb2xvcnMgIT0gdW5kZWZpbmVkID8gb3B0cy5jb2xvcnMgOiBbXTtcblxuICAgIHRoaXMudXZzID0gb3B0cy51dnMgIT0gdW5kZWZpbmVkID8gb3B0cy51dnMgOiBbXTtcbiAgICB0aGlzLnV2czIgPSBvcHRzLnV2czIgIT0gdW5kZWZpbmVkID8gb3B0cy51dnMyIDogW107XG5cbiAgICB0aGlzLmJvbmVzID0gb3B0cy5ib25lcyAhPSB1bmRlZmluZWQgPyBvcHRzLmJvbmVzIDogW107XG4gICAgdGhpcy5ib25lSW5kaWNlcyA9IG9wdHMuYm9uZUluZGljZXMgIT0gdW5kZWZpbmVkID8gb3B0cy5ib25lSW5kaWNlcyA6IFtdO1xuICAgIHRoaXMuYm9uZVdlaWdodHMgPSBvcHRzLmJvbmVXZWlnaHRzICE9IHVuZGVmaW5lZCA/IG9wdHMuYm9uZVdlaWdodHMgOiBbXTtcblxuICAgIHRoaXMuZHluYW1pYyA9IG9wdHMuZHluYW1pYyAhPSB1bmRlZmluZWQgPyAhIW9wdHMuZHluYW1pYyA6IGZhbHNlO1xuICAgIHRoaXMudXNlQm9uZXMgPSBvcHRzLnVzZUJvbmVzICE9IHVuZGVmaW5lZCA/ICEhb3B0cy51c2VCb25lcyA6IHRoaXMuYm9uZXMubGVuZ3RoID4gMCA/IHRydWUgOiBmYWxzZTtcblxuICAgIHRoaXMuYW5pbWF0aW9ucyA9IHt9O1xuXG4gICAgdGhpcy5hYWJiID0gbmV3IEFBQkIzO1xuICAgIGlmIChvcHRzLnZlcnRpY2VzKSB0aGlzLmFhYmIuZnJvbVBvaW50cyh0aGlzLnZlcnRpY2VzKTtcblxuICAgIHRoaXMudmVydGljZXNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLm5vcm1hbHNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLnRhbmdlbnRzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5pbmRpY2VzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5jb2xvcnNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLnV2c05lZWRVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMudXZzMk5lZWRVcGRhdGUgPSB0cnVlO1xuXG4gICAgdGhpcy5ib25lSW5kaWNlc05lZWRVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuYm9uZVdlaWdodHNOZWVkVXBkYXRlID0gdHJ1ZTtcblxuICAgIHRoaXMuX3dlYmdsQnVmZmVyc0luaXR0ZWQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fd2ViZ2xVc2VkID0gMDtcblxuICAgIHRoaXMuX3dlYmdsVmVydGV4QnVmZmVyID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3dlYmdsTm9ybWFsQnVmZmVyID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3dlYmdsVGFuZ2VudEJ1ZmZlciA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl93ZWJnbENvbG9yQnVmZmVyID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3dlYmdsVXZCdWZmZXIgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fd2ViZ2xVdjJCdWZmZXIgPSB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLl93ZWJnbE1lc2hCb25lSW5kZXhCdWZmZXIgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fd2ViZ2xNZXNoQm9uZVdlaWdodEJ1ZmZlciA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuX3dlYmdsSW5kZXhCdWZmZXIgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fd2ViZ2xMaW5lQnVmZmVyID0gdW5kZWZpbmVkO1xuXG4gICAgdGhpcy5fd2ViZ2xWZXJ0ZXhBcnJheSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl93ZWJnbE5vcm1hbEFycmF5ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3dlYmdsVGFuZ2VudEFycmF5ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3dlYmdsQ29sb3JBcnJheSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl93ZWJnbFV2QXJyYXkgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fd2ViZ2xVdjJBcnJheSA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuX3dlYmdsTWVzaEJvbmVJbmRleEFycmF5ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3dlYmdsTWVzaEJvbmVXZWlnaHRBcnJheSA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuX3dlYmdsSW5kZXhBcnJheSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl93ZWJnbExpbmVBcnJheSA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuX3dlYmdsVmVydGV4Q291bnQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fd2ViZ2xMaW5lQ291bnQgPSB1bmRlZmluZWQ7XG5cbiAgICBpZiAob3B0cy5qc29uKSB0aGlzLmZyb21KU09OKG9wdHMuanNvbik7XG59XG5cbkFzc2V0LmV4dGVuZChNZXNoKTtcblxuXG5NZXNoLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgQXNzZXQucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLCBvdGhlcik7XG4gICAgdmFyIHZlcnRpY2VzID0gdGhpcy52ZXJ0aWNlcyxcbiAgICAgICAgb3RoZXJWZXJ0aWNlcyA9IG90aGVyLnZlcnRpY2VzLFxuICAgICAgICBub3JtYWxzID0gdGhpcy5ub3JtYWxzLFxuICAgICAgICBvdGhlck5vcm1hbHMgPSBvdGhlci5ub3JtYWxzLFxuICAgICAgICB0YW5nZW50cyA9IHRoaXMudGFuZ2VudHMsXG4gICAgICAgIG90aGVyVGFuZ2VudHMgPSBvdGhlci50YW5nZW50cyxcbiAgICAgICAgaW5kaWNlcyA9IHRoaXMuaW5kaWNlcyxcbiAgICAgICAgb3RoZXJJbmRpY2VzID0gb3RoZXIuaW5kaWNlcyxcbiAgICAgICAgY29sb3JzID0gdGhpcy5jb2xvcnMsXG4gICAgICAgIG90aGVyQ29sb3JzID0gb3RoZXIuY29sb3JzLFxuICAgICAgICB1dnMgPSB0aGlzLnV2cyxcbiAgICAgICAgb3RoZXJVdnMgPSBvdGhlci51dnMsXG4gICAgICAgIHV2czIgPSB0aGlzLnV2czIsXG4gICAgICAgIG90aGVyVXYycyA9IG90aGVyLnV2czIsXG4gICAgICAgIGJvbmVzID0gdGhpcy5ib25lcyxcbiAgICAgICAgb3RoZXJNZXNoQm9uZXMgPSBvdGhlci5ib25lcyxcbiAgICAgICAgYm9uZUluZGljZXMgPSB0aGlzLmJvbmVJbmRpY2VzLFxuICAgICAgICBvdGhlck1lc2hCb25lSW5kaWNlcyA9IG90aGVyLmJvbmVJbmRpY2VzLFxuICAgICAgICBib25lV2VpZ2h0cyA9IHRoaXMuYm9uZVdlaWdodHMsXG4gICAgICAgIG90aGVyTWVzaEJvbmVXZWlnaHRzID0gb3RoZXIuYm9uZVdlaWdodHMsXG4gICAgICAgIGk7XG5cbiAgICB2ZXJ0aWNlcy5sZW5ndGggPSBvdGhlclZlcnRpY2VzLmxlbmd0aDtcbiAgICBub3JtYWxzLmxlbmd0aCA9IG90aGVyTm9ybWFscy5sZW5ndGg7XG4gICAgdGFuZ2VudHMubGVuZ3RoID0gb3RoZXJUYW5nZW50cy5sZW5ndGg7XG4gICAgaW5kaWNlcy5sZW5ndGggPSBvdGhlckluZGljZXMubGVuZ3RoO1xuICAgIGNvbG9ycy5sZW5ndGggPSBvdGhlckNvbG9ycy5sZW5ndGg7XG4gICAgdXZzLmxlbmd0aCA9IG90aGVyVXZzLmxlbmd0aDtcbiAgICB1dnMyLmxlbmd0aCA9IG90aGVyVXYycy5sZW5ndGg7XG5cbiAgICBib25lcy5sZW5ndGggPSBvdGhlck1lc2hCb25lcy5sZW5ndGg7XG4gICAgYm9uZUluZGljZXMubGVuZ3RoID0gb3RoZXJNZXNoQm9uZUluZGljZXMubGVuZ3RoO1xuICAgIGJvbmVXZWlnaHRzLmxlbmd0aCA9IG90aGVyTWVzaEJvbmVXZWlnaHRzLmxlbmd0aDtcblxuICAgIGZvciAoaSA9IG90aGVyVmVydGljZXMubGVuZ3RoOyBpLS07KSB2ZXJ0aWNlc1tpXSA9ICh2ZXJ0aWNlc1tpXSB8fCBuZXcgVmVjMykuY29weShvdGhlclZlcnRpY2VzW2ldKTtcbiAgICBmb3IgKGkgPSBvdGhlck5vcm1hbHMubGVuZ3RoOyBpLS07KSBub3JtYWxzW2ldID0gKG5vcm1hbHNbaV0gfHwgbmV3IFZlYzMpLmNvcHkob3RoZXJOb3JtYWxzW2ldKTtcbiAgICBmb3IgKGkgPSBvdGhlclRhbmdlbnRzLmxlbmd0aDsgaS0tOykgdGFuZ2VudHNbaV0gPSAodGFuZ2VudHNbaV0gfHwgbmV3IFZlYzQpLmNvcHkob3RoZXJUYW5nZW50c1tpXSk7XG4gICAgZm9yIChpID0gb3RoZXJJbmRpY2VzLmxlbmd0aDsgaS0tOykgaW5kaWNlc1tpXSA9IG90aGVySW5kaWNlc1tpXTtcbiAgICBmb3IgKGkgPSBvdGhlckNvbG9ycy5sZW5ndGg7IGktLTspIGNvbG9yc1tpXSA9IChjb2xvcnNbaV0gfHwgbmV3IENvbG9yKS5jb3B5KG90aGVyQ29sb3JzW2ldKTtcbiAgICBmb3IgKGkgPSBvdGhlclV2cy5sZW5ndGg7IGktLTspIHV2c1tpXSA9ICh1dnNbaV0gfHwgbmV3IFZlYzIpLmNvcHkob3RoZXJVdnNbaV0pO1xuICAgIGZvciAoaSA9IG90aGVyVXYycy5sZW5ndGg7IGktLTspIHV2czJbaV0gPSAodXZzMltpXSB8fCBuZXcgVmVjMikuY29weShvdGhlclV2MnNbaV0pO1xuICAgIGZvciAoaSA9IG90aGVyTWVzaEJvbmVzLmxlbmd0aDsgaS0tOykgYm9uZXNbaV0gPSAoYm9uZXNbaV0gfHwgbmV3IE1lc2hCb25lKS5jb3B5KG90aGVyTWVzaEJvbmVzW2ldKTtcbiAgICBmb3IgKGkgPSBvdGhlck1lc2hCb25lSW5kaWNlcy5sZW5ndGg7IGktLTspIGJvbmVJbmRpY2VzW2ldID0gb3RoZXJNZXNoQm9uZUluZGljZXNbaV07XG4gICAgZm9yIChpID0gb3RoZXJNZXNoQm9uZVdlaWdodHMubGVuZ3RoOyBpLS07KSBib25lV2VpZ2h0c1tpXSA9IG90aGVyTWVzaEJvbmVXZWlnaHRzW2ldO1xuXG4gICAgdGhpcy5keW5hbWljID0gb3RoZXIuZHluYW1pYztcbiAgICB0aGlzLnVzZUJvbmVzID0gb3RoZXIudXNlQm9uZXM7XG5cbiAgICB0aGlzLmFhYmIuZnJvbVBvaW50cyh0aGlzLnZlcnRpY2VzKTtcblxuICAgIHRoaXMudmVydGljZXNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLm5vcm1hbHNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLnRhbmdlbnRzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5pbmRpY2VzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5jb2xvcnNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLnV2c05lZWRVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMudXZzMk5lZWRVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuYm9uZUluZGljZXNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLmJvbmVXZWlnaHRzTmVlZFVwZGF0ZSA9IHRydWU7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuTWVzaC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgQXNzZXQucHJvdG90eXBlLmNsZWFyLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLnZlcnRpY2VzLmxlbmd0aCA9IDA7XG4gICAgdGhpcy5ub3JtYWxzLmxlbmd0aCA9IDA7XG4gICAgdGhpcy50YW5nZW50cy5sZW5ndGggPSAwO1xuICAgIHRoaXMuaW5kaWNlcy5sZW5ndGggPSAwO1xuICAgIHRoaXMuY29sb3JzLmxlbmd0aCA9IDA7XG4gICAgdGhpcy51dnMubGVuZ3RoID0gMDtcbiAgICB0aGlzLnV2czIubGVuZ3RoID0gMDtcblxuICAgIHRoaXMuYm9uZXMubGVuZ3RoID0gMDtcbiAgICB0aGlzLmJvbmVJbmRpY2VzLmxlbmd0aCA9IDA7XG4gICAgdGhpcy5ib25lV2VpZ2h0cy5sZW5ndGggPSAwO1xuXG4gICAgdGhpcy5hYWJiLmNsZWFyKCk7XG5cbiAgICB0aGlzLnZlcnRpY2VzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5ub3JtYWxzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy50YW5nZW50c05lZWRVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuaW5kaWNlc05lZWRVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuY29sb3JzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy51dnNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLnV2czJOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLmJvbmVJbmRpY2VzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5ib25lV2VpZ2h0c05lZWRVcGRhdGUgPSB0cnVlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbnZhciBFTVBUWV9BUlJBWSA9IFtdO1xuXG5NZXNoLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChyYXcpIHtcbiAgICBBc3NldC5wcm90b3R5cGUucGFyc2UuY2FsbCh0aGlzLCByYXcpO1xuICAgIHZhciB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMsXG4gICAgICAgIG5vcm1hbHMgPSB0aGlzLm5vcm1hbHMsXG4gICAgICAgIHRhbmdlbnRzID0gdGhpcy50YW5nZW50cyxcbiAgICAgICAgaW5kaWNlcyA9IHRoaXMuaW5kaWNlcyxcbiAgICAgICAgY29sb3JzID0gdGhpcy5jb2xvcnMsXG4gICAgICAgIHV2cyA9IHRoaXMudXZzLFxuICAgICAgICB1dnMyID0gdGhpcy51dnMyLFxuICAgICAgICBib25lcyA9IHRoaXMuYm9uZXMsXG4gICAgICAgIGJvbmVXZWlnaHRzID0gdGhpcy5ib25lV2VpZ2h0cyxcbiAgICAgICAgYm9uZUluZGljZXMgPSB0aGlzLmJvbmVJbmRpY2VzLFxuICAgICAgICBib25lLCBpdGVtcywgaXRlbSxcbiAgICAgICAgaSwgaWw7XG5cbiAgICB2ZXJ0aWNlcy5sZW5ndGggPSBub3JtYWxzLmxlbmd0aCA9IHRhbmdlbnRzLmxlbmd0aCA9IGluZGljZXMubGVuZ3RoID0gY29sb3JzLmxlbmd0aCA9IHV2cy5sZW5ndGggPSB1dnMyLmxlbmd0aCA9IDA7XG4gICAgYm9uZXMubGVuZ3RoID0gYm9uZVdlaWdodHMubGVuZ3RoID0gYm9uZUluZGljZXMubGVuZ3RoID0gMDtcblxuICAgIGl0ZW1zID0gcmF3LnZlcnRpY2VzIHx8IEVNUFRZX0FSUkFZO1xuICAgIGZvciAoaSA9IDAsIGlsID0gaXRlbXMubGVuZ3RoOyBpIDwgaWw7IGkgKz0gMykgdmVydGljZXMucHVzaChuZXcgVmVjMyhpdGVtc1tpXSwgaXRlbXNbaSArIDFdLCBpdGVtc1tpICsgMl0pKTtcblxuICAgIGl0ZW1zID0gcmF3Lm5vcm1hbHMgfHwgRU1QVFlfQVJSQVk7XG4gICAgZm9yIChpID0gMCwgaWwgPSBpdGVtcy5sZW5ndGg7IGkgPCBpbDsgaSArPSAzKSBub3JtYWxzLnB1c2gobmV3IFZlYzMoaXRlbXNbaV0sIGl0ZW1zW2kgKyAxXSwgaXRlbXNbaSArIDJdKSk7XG5cbiAgICBpdGVtcyA9IHJhdy50YW5nZW50cyB8fCBFTVBUWV9BUlJBWTtcbiAgICBmb3IgKGkgPSAwLCBpbCA9IGl0ZW1zLmxlbmd0aDsgaSA8IGlsOyBpICs9IDQpIHRhbmdlbnRzLnB1c2gobmV3IFZlYzQoaXRlbXNbaV0sIGl0ZW1zW2kgKyAxXSwgaXRlbXNbaSArIDJdLCBpdGVtc1tpICsgM10pKTtcblxuICAgIGl0ZW1zID0gcmF3LmluZGljZXMgfHwgcmF3LmZhY2VzIHx8IEVNUFRZX0FSUkFZO1xuICAgIGZvciAoaSA9IDAsIGlsID0gaXRlbXMubGVuZ3RoOyBpIDwgaWw7IGkgKz0gMykgaW5kaWNlcy5wdXNoKGl0ZW1zW2ldLCBpdGVtc1tpICsgMV0sIGl0ZW1zW2kgKyAyXSk7XG5cbiAgICBpdGVtcyA9IHJhdy5jb2xvcnMgfHwgRU1QVFlfQVJSQVk7XG4gICAgZm9yIChpID0gMCwgaWwgPSBpdGVtcy5sZW5ndGg7IGkgPCBpbDsgaSArPSAzKSBjb2xvcnMucHVzaChuZXcgQ29sb3IoaXRlbXNbaV0sIGl0ZW1zW2kgKyAxXSwgaXRlbXNbaSArIDJdKSk7XG5cbiAgICBpdGVtcyA9IHJhdy51dnMgfHwgRU1QVFlfQVJSQVk7XG4gICAgZm9yIChpID0gMCwgaWwgPSBpdGVtcy5sZW5ndGg7IGkgPCBpbDsgaSArPSAyKSB1dnMucHVzaChuZXcgVmVjMihpdGVtc1tpXSwgaXRlbXNbaSArIDFdKSk7XG5cbiAgICBpdGVtcyA9IHJhdy51dnMyIHx8IEVNUFRZX0FSUkFZO1xuICAgIGZvciAoaSA9IDAsIGlsID0gaXRlbXMubGVuZ3RoOyBpIDwgaWw7IGkgKz0gMikgdXZzMi5wdXNoKG5ldyBWZWMyKGl0ZW1zW2ldLCBpdGVtc1tpICsgMV0pKTtcblxuICAgIGl0ZW1zID0gcmF3LmJvbmVzIHx8IEVNUFRZX0FSUkFZO1xuICAgIGZvciAoaSA9IDAsIGlsID0gaXRlbXMubGVuZ3RoOyBpIDwgaWw7IGkrKykge1xuICAgICAgICBpdGVtID0gaXRlbXNbaV07XG5cbiAgICAgICAgYm9uZSA9IG5ldyBNZXNoQm9uZShpdGVtLnBhcmVudCwgaXRlbS5uYW1lKTtcblxuICAgICAgICBib25lLnBvc2l0aW9uLmZyb21BcnJheShpdGVtLnBvc2l0aW9uKTtcbiAgICAgICAgYm9uZS5yb3RhdGlvbi5mcm9tQXJyYXkoaXRlbS5yb3RhdGlvbik7XG4gICAgICAgIGJvbmUuc2NhbGUuZnJvbUFycmF5KGl0ZW0uc2NhbGUpO1xuICAgICAgICBib25lLmJpbmRQb3NlLmZyb21BcnJheShpdGVtLmJpbmRQb3NlKTtcbiAgICAgICAgYm9uZS5za2lubmVkID0gISFpdGVtLnNraW5uZWQ7XG5cbiAgICAgICAgYm9uZXMucHVzaChib25lKTtcbiAgICB9XG4gICAgaWYgKGl0ZW1zLmxlbmd0aCkgdGhpcy51c2VCb25lcyA9IHRydWU7XG5cbiAgICBpdGVtcyA9IHJhdy5ib25lV2VpZ2h0cyB8fCBFTVBUWV9BUlJBWTtcbiAgICBmb3IgKGkgPSAwLCBpbCA9IGl0ZW1zLmxlbmd0aDsgaSA8IGlsOyBpKyspIGJvbmVXZWlnaHRzLnB1c2goaXRlbXNbaV0pO1xuXG4gICAgaXRlbXMgPSByYXcuYm9uZUluZGljZXMgfHwgRU1QVFlfQVJSQVk7XG4gICAgZm9yIChpID0gMCwgaWwgPSBpdGVtcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBib25lSW5kaWNlcy5wdXNoKGl0ZW1zW2ldKTtcblxuICAgIHRoaXMuYW5pbWF0aW9ucyA9IHJhdy5hbmltYXRpb25zO1xuXG4gICAgdGhpcy5hYWJiLmZyb21Qb2ludHModGhpcy52ZXJ0aWNlcyk7XG5cbiAgICB0aGlzLnZlcnRpY2VzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5ub3JtYWxzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy50YW5nZW50c05lZWRVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuaW5kaWNlc05lZWRVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuY29sb3JzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy51dnNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLnV2czJOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLmJvbmVJbmRpY2VzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5ib25lV2VpZ2h0c05lZWRVcGRhdGUgPSB0cnVlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbk1lc2gucHJvdG90eXBlLnRyYW5zZm9ybU1hdDMgPSBmdW5jdGlvbiAobSkge1xuICAgIHZhciB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMsXG4gICAgICAgIG5vcm1hbHMgPSB0aGlzLm5vcm1hbHMsXG4gICAgICAgIGk7XG5cbiAgICBpZiAodmVydGljZXMpIHtcbiAgICAgICAgaSA9IHZlcnRpY2VzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkgdmVydGljZXNbaV0udHJhbnNmb3JtTWF0MyhtKTtcbiAgICAgICAgdGhpcy52ZXJ0aWNlc05lZWRVcGRhdGUgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAobm9ybWFscykge1xuICAgICAgICBpID0gbm9ybWFscy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpLS0pIG5vcm1hbHNbaV0udHJhbnNmb3JtTWF0MyhtKTtcbiAgICAgICAgdGhpcy5ub3JtYWxzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbk1lc2gucHJvdG90eXBlLnRyYW5zZm9ybU1hdDQgPSBmdW5jdGlvbiAobSkge1xuICAgIHZhciB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMsXG4gICAgICAgIG5vcm1hbHMgPSB0aGlzLm5vcm1hbHMsXG4gICAgICAgIGk7XG5cbiAgICBpZiAodmVydGljZXMpIHtcbiAgICAgICAgaSA9IHZlcnRpY2VzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkgdmVydGljZXNbaV0udHJhbnNmb3JtTWF0NChtKTtcbiAgICAgICAgdGhpcy52ZXJ0aWNlc05lZWRVcGRhdGUgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAobm9ybWFscykge1xuICAgICAgICBpID0gbm9ybWFscy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpLS0pIG5vcm1hbHNbaV0udHJhbnNmb3JtTWF0NFJvdGF0aW9uKG0pO1xuICAgICAgICB0aGlzLm5vcm1hbHNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuTWVzaC5wcm90b3R5cGUuY2FsY3VsYXRlQUFCQiA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMuYWFiYi5mcm9tUG9pbnRzKHRoaXMudmVydGljZXMpO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5NZXNoLnByb3RvdHlwZS5jYWxjdWxhdGVOb3JtYWxzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB1ID0gbmV3IFZlYzMsXG4gICAgICAgIHYgPSBuZXcgVmVjMyxcbiAgICAgICAgdXYgPSBuZXcgVmVjMyxcbiAgICAgICAgZmFjZU5vcm1hbCA9IG5ldyBWZWMzO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZlcnRpY2VzID0gdGhpcy52ZXJ0aWNlcyxcbiAgICAgICAgICAgIG5vcm1hbHMgPSB0aGlzLm5vcm1hbHMsXG4gICAgICAgICAgICBpbmRpY2VzID0gdGhpcy5pbmRpY2VzLFxuICAgICAgICAgICAgYSwgYiwgYywgdmEsIHZiLCB2YywgaTtcblxuICAgICAgICBmb3IgKGkgPSB2ZXJ0aWNlcy5sZW5ndGg7IGktLTspKG5vcm1hbHNbaV0gfHwgKG5vcm1hbHNbaV0gPSBuZXcgVmVjMykpLnNldCgwLCAwLCAwKTtcblxuICAgICAgICBmb3IgKGkgPSBpbmRpY2VzLmxlbmd0aDsgaSAtPSAzOykge1xuICAgICAgICAgICAgYSA9IGluZGljZXNbaV07XG4gICAgICAgICAgICBiID0gaW5kaWNlc1tpICsgMV07XG4gICAgICAgICAgICBjID0gaW5kaWNlc1tpICsgMl07XG5cbiAgICAgICAgICAgIHZhID0gdmVydGljZXNbYV07XG4gICAgICAgICAgICB2YiA9IHZlcnRpY2VzW2JdO1xuICAgICAgICAgICAgdmMgPSB2ZXJ0aWNlc1tjXTtcblxuICAgICAgICAgICAgdS52c3ViKHZjLCB2Yik7XG4gICAgICAgICAgICB2LnZzdWIodmEsIHZiKTtcblxuICAgICAgICAgICAgdXYudmNyb3NzKHUsIHYpO1xuXG4gICAgICAgICAgICBmYWNlTm9ybWFsLmNvcHkodXYpLm5vcm1hbGl6ZSgpO1xuXG4gICAgICAgICAgICBub3JtYWxzW2FdLmFkZChmYWNlTm9ybWFsKTtcbiAgICAgICAgICAgIG5vcm1hbHNbYl0uYWRkKGZhY2VOb3JtYWwpO1xuICAgICAgICAgICAgbm9ybWFsc1tjXS5hZGQoZmFjZU5vcm1hbCk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGkgPSBpbmRpY2VzLmxlbmd0aDsgaSAtPSAzOykge1xuICAgICAgICAgICAgbm9ybWFsc1tpbmRpY2VzW2ldXS5ub3JtYWxpemUoKTtcbiAgICAgICAgICAgIG5vcm1hbHNbaW5kaWNlc1tpICsgMV1dLm5vcm1hbGl6ZSgpO1xuICAgICAgICAgICAgbm9ybWFsc1tpbmRpY2VzW2kgKyAyXV0ubm9ybWFsaXplKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm5vcm1hbHNOZWVkVXBkYXRlID0gdHJ1ZTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xufSgpO1xuXG5cbk1lc2gucHJvdG90eXBlLmNhbGN1bGF0ZVRhbmdlbnRzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0YW4xID0gW10sXG4gICAgICAgIHRhbjIgPSBbXSxcbiAgICAgICAgc2RpciA9IG5ldyBWZWMzLFxuICAgICAgICB0ZGlyID0gbmV3IFZlYzMsXG4gICAgICAgIG4gPSBuZXcgVmVjMyxcbiAgICAgICAgdCA9IG5ldyBWZWMzLFxuICAgICAgICB0bXAxID0gbmV3IFZlYzMsXG4gICAgICAgIHRtcDIgPSBuZXcgVmVjMztcblxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbmRpY2VzID0gdGhpcy5pbmRpY2VzLFxuICAgICAgICAgICAgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzLFxuICAgICAgICAgICAgbm9ybWFscyA9IHRoaXMubm9ybWFscyxcbiAgICAgICAgICAgIHRhbmdlbnRzID0gdGhpcy50YW5nZW50cyxcbiAgICAgICAgICAgIHV2cyA9IHRoaXMudXZzLFxuXG4gICAgICAgICAgICB2MSwgdjIsIHYzLFxuICAgICAgICAgICAgdzEsIHcyLCB3MyxcblxuICAgICAgICAgICAgeDEsIHgyLCB5MSwgeTIsIHoxLCB6MixcbiAgICAgICAgICAgIHMxLCBzMiwgdDEsIHQyLFxuICAgICAgICAgICAgYSwgYiwgYyxcblxuICAgICAgICAgICAgciwgdywgaTtcblxuICAgICAgICBmb3IgKGkgPSB2ZXJ0aWNlcy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgICh0YW4xW2ldIHx8ICh0YW4xW2ldID0gbmV3IFZlYzMpKS5zZXQoMCwgMCwgMCk7XG4gICAgICAgICAgICAodGFuMltpXSB8fCAodGFuMltpXSA9IG5ldyBWZWMzKSkuc2V0KDAsIDAsIDApO1xuICAgICAgICAgICAgKHRhbmdlbnRzW2ldIHx8ICh0YW5nZW50c1tpXSA9IG5ldyBWZWM0KSkuc2V0KDAsIDAsIDAsIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChpID0gdmVydGljZXMubGVuZ3RoOyBpLS07KSB1dnNbaV0gPSB1dnNbaV0gfHwgKHV2c1tpXSA9IG5ldyBWZWMyKTtcblxuICAgICAgICBmb3IgKGkgPSBpbmRpY2VzLmxlbmd0aDsgaSAtPSAzOykge1xuICAgICAgICAgICAgYSA9IGluZGljZXNbaV07XG4gICAgICAgICAgICBiID0gaW5kaWNlc1tpICsgMV07XG4gICAgICAgICAgICBjID0gaW5kaWNlc1tpICsgMl07XG5cbiAgICAgICAgICAgIHYxID0gdmVydGljZXNbYV07XG4gICAgICAgICAgICB2MiA9IHZlcnRpY2VzW2JdO1xuICAgICAgICAgICAgdjMgPSB2ZXJ0aWNlc1tjXTtcblxuICAgICAgICAgICAgdzEgPSB1dnNbYV07XG4gICAgICAgICAgICB3MiA9IHV2c1tiXTtcbiAgICAgICAgICAgIHczID0gdXZzW2NdO1xuXG4gICAgICAgICAgICB4MSA9IHYyLnggLSB2MS54O1xuICAgICAgICAgICAgeDIgPSB2My54IC0gdjEueDtcbiAgICAgICAgICAgIHkxID0gdjIueSAtIHYxLnk7XG4gICAgICAgICAgICB5MiA9IHYzLnkgLSB2MS55O1xuICAgICAgICAgICAgejEgPSB2Mi56IC0gdjEuejtcbiAgICAgICAgICAgIHoyID0gdjMueiAtIHYxLno7XG5cbiAgICAgICAgICAgIHMxID0gdzIueCAtIHcxLng7XG4gICAgICAgICAgICBzMiA9IHczLnggLSB3MS54O1xuICAgICAgICAgICAgdDEgPSB3Mi55IC0gdzEueTtcbiAgICAgICAgICAgIHQyID0gdzMueSAtIHcxLnk7XG5cbiAgICAgICAgICAgIHIgPSBzMSAqIHQyIC0gczIgKiB0MTtcbiAgICAgICAgICAgIHIgPSByICE9PSAwID8gMSAvIHIgOiAwO1xuXG4gICAgICAgICAgICBzZGlyLnNldChcbiAgICAgICAgICAgICAgICAodDIgKiB4MSAtIHQxICogeDIpICogciwgKHQyICogeTEgLSB0MSAqIHkyKSAqIHIsICh0MiAqIHoxIC0gdDEgKiB6MikgKiByXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0ZGlyLnNldChcbiAgICAgICAgICAgICAgICAoczEgKiB4MiAtIHMyICogeDEpICogciwgKHMxICogeTIgLSBzMiAqIHkxKSAqIHIsIChzMSAqIHoyIC0gczIgKiB6MSkgKiByXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0YW4xW2FdLmFkZChzZGlyKTtcbiAgICAgICAgICAgIHRhbjFbYl0uYWRkKHNkaXIpO1xuICAgICAgICAgICAgdGFuMVtjXS5hZGQoc2Rpcik7XG5cbiAgICAgICAgICAgIHRhbjJbYV0uYWRkKHRkaXIpO1xuICAgICAgICAgICAgdGFuMltiXS5hZGQodGRpcik7XG4gICAgICAgICAgICB0YW4yW2NdLmFkZCh0ZGlyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoaSA9IHZlcnRpY2VzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgdC5jb3B5KHRhbjFbaV0pO1xuICAgICAgICAgICAgbi5jb3B5KG5vcm1hbHNbaV0pO1xuXG4gICAgICAgICAgICB0bXAxLmNvcHkodCk7XG4gICAgICAgICAgICB0bXAxLnN1YihuLnNtdWwobi5kb3QodCkpKS5ub3JtYWxpemUoKTtcblxuICAgICAgICAgICAgbi5jb3B5KG5vcm1hbHNbaV0pO1xuICAgICAgICAgICAgdG1wMi52Y3Jvc3MobiwgdCk7XG5cbiAgICAgICAgICAgIHcgPSAodG1wMi5kb3QodGFuMltpXSkgPCAwKSA/IC0xIDogMTtcblxuICAgICAgICAgICAgdGFuZ2VudHNbaV0uc2V0KHRtcDEueCwgdG1wMS55LCB0bXAxLnosIHcpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50YW5nZW50c05lZWRVcGRhdGUgPSB0cnVlO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG59KCk7XG5cblxuTWVzaC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24sIHBhY2spIHtcbiAgICBqc29uID0gQXNzZXQucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24sIHBhY2spO1xuICAgIHZhciB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMsXG4gICAgICAgIGpzb25WZXJ0aWNlcyA9IGpzb24udmVydGljZXMgfHwgKGpzb24udmVydGljZXMgPSBbXSksXG4gICAgICAgIG5vcm1hbHMgPSB0aGlzLm5vcm1hbHMsXG4gICAgICAgIGpzb25Ob3JtYWxzID0ganNvbi5ub3JtYWxzIHx8IChqc29uLm5vcm1hbHMgPSBbXSksXG4gICAgICAgIHRhbmdlbnRzID0gdGhpcy50YW5nZW50cyxcbiAgICAgICAganNvblRhbmdlbnRzID0ganNvbi50YW5nZW50cyB8fCAoanNvbi50YW5nZW50cyA9IFtdKSxcbiAgICAgICAgaW5kaWNlcyA9IHRoaXMuaW5kaWNlcyxcbiAgICAgICAganNvbkluZGljZXMgPSBqc29uLmluZGljZXMgfHwgKGpzb24uaW5kaWNlcyA9IFtdKSxcbiAgICAgICAgY29sb3JzID0gdGhpcy5jb2xvcnMsXG4gICAgICAgIGpzb25Db2xvcnMgPSBqc29uLmNvbG9ycyB8fCAoanNvbi5jb2xvcnMgPSBbXSksXG4gICAgICAgIHV2cyA9IHRoaXMudXZzLFxuICAgICAgICBqc29uVXZzID0ganNvbi51dnMgfHwgKGpzb24udXZzID0gW10pLFxuICAgICAgICB1dnMyID0gdGhpcy51dnMyLFxuICAgICAgICBqc29uVXYycyA9IGpzb24udXZzMiB8fCAoanNvbi51dnMyID0gW10pLFxuICAgICAgICBib25lcyA9IHRoaXMuYm9uZXMsXG4gICAgICAgIGpzb25NZXNoQm9uZXMgPSBqc29uLmJvbmVzIHx8IChqc29uLmJvbmVzID0gW10pLFxuICAgICAgICBib25lSW5kaWNlcyA9IHRoaXMuYm9uZUluZGljZXMsXG4gICAgICAgIGpzb25NZXNoQm9uZUluZGljZXMgPSBqc29uLmJvbmVJbmRpY2VzIHx8IChqc29uLmJvbmVJbmRpY2VzID0gW10pLFxuICAgICAgICBib25lV2VpZ2h0cyA9IHRoaXMuYm9uZVdlaWdodHMsXG4gICAgICAgIGpzb25NZXNoQm9uZVdlaWdodHMgPSBqc29uLmJvbmVXZWlnaHRzIHx8IChqc29uLmJvbmVXZWlnaHRzID0gW10pLFxuICAgICAgICBpO1xuXG4gICAganNvblZlcnRpY2VzLmxlbmd0aCA9IHZlcnRpY2VzLmxlbmd0aDtcbiAgICBqc29uTm9ybWFscy5sZW5ndGggPSBub3JtYWxzLmxlbmd0aDtcbiAgICBqc29uVGFuZ2VudHMubGVuZ3RoID0gdGFuZ2VudHMubGVuZ3RoO1xuICAgIGpzb25JbmRpY2VzLmxlbmd0aCA9IGluZGljZXMubGVuZ3RoO1xuICAgIGpzb25Db2xvcnMubGVuZ3RoID0gY29sb3JzLmxlbmd0aDtcbiAgICBqc29uVXZzLmxlbmd0aCA9IHV2cy5sZW5ndGg7XG4gICAganNvblV2MnMubGVuZ3RoID0gdXZzMi5sZW5ndGg7XG5cbiAgICBqc29uTWVzaEJvbmVzLmxlbmd0aCA9IGJvbmVzLmxlbmd0aDtcbiAgICBqc29uTWVzaEJvbmVJbmRpY2VzLmxlbmd0aCA9IGJvbmVJbmRpY2VzLmxlbmd0aDtcbiAgICBqc29uTWVzaEJvbmVXZWlnaHRzLmxlbmd0aCA9IGJvbmVXZWlnaHRzLmxlbmd0aDtcblxuICAgIGZvciAoaSA9IHZlcnRpY2VzLmxlbmd0aDsgaS0tOykganNvblZlcnRpY2VzW2ldID0gdmVydGljZXNbaV0udG9KU09OKGpzb25WZXJ0aWNlc1tpXSk7XG4gICAgZm9yIChpID0gbm9ybWFscy5sZW5ndGg7IGktLTspIGpzb25Ob3JtYWxzW2ldID0gbm9ybWFsc1tpXS50b0pTT04oanNvbk5vcm1hbHNbaV0pO1xuICAgIGZvciAoaSA9IHRhbmdlbnRzLmxlbmd0aDsgaS0tOykganNvblRhbmdlbnRzW2ldID0gdGFuZ2VudHNbaV0udG9KU09OKGpzb25UYW5nZW50c1tpXSk7XG4gICAgZm9yIChpID0gaW5kaWNlcy5sZW5ndGg7IGktLTspIGluZGljZXNbaV0gPSBqc29uSW5kaWNlc1tpXTtcbiAgICBmb3IgKGkgPSBjb2xvcnMubGVuZ3RoOyBpLS07KSBqc29uQ29sb3JzW2ldID0gY29sb3JzW2ldLnRvSlNPTihqc29uQ29sb3JzW2ldKTtcbiAgICBmb3IgKGkgPSB1dnMubGVuZ3RoOyBpLS07KSBqc29uVXZzW2ldID0gdXZzW2ldLnRvSlNPTihqc29uVXZzW2ldKTtcbiAgICBmb3IgKGkgPSB1dnMyLmxlbmd0aDsgaS0tOykganNvblV2MnNbaV0gPSB1dnMyW2ldLnRvSlNPTihqc29uVXYyc1tpXSk7XG4gICAgZm9yIChpID0gYm9uZXMubGVuZ3RoOyBpLS07KSBqc29uTWVzaEJvbmVzW2ldID0gYm9uZXNbaV0udG9KU09OKGpzb25NZXNoQm9uZXNbaV0pO1xuICAgIGZvciAoaSA9IGJvbmVJbmRpY2VzLmxlbmd0aDsgaS0tOykgYm9uZUluZGljZXNbaV0gPSBqc29uTWVzaEJvbmVJbmRpY2VzW2ldO1xuICAgIGZvciAoaSA9IGJvbmVXZWlnaHRzLmxlbmd0aDsgaS0tOykgYm9uZVdlaWdodHNbaV0gPSBqc29uTWVzaEJvbmVXZWlnaHRzW2ldO1xuXG4gICAganNvbi5keW5hbWljID0gdGhpcy5keW5hbWljO1xuICAgIGpzb24udXNlQm9uZXMgPSB0aGlzLnVzZUJvbmVzO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbk1lc2gucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBBc3NldC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcbiAgICB2YXIgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzLFxuICAgICAgICBqc29uVmVydGljZXMgPSBqc29uLnZlcnRpY2VzLFxuICAgICAgICBub3JtYWxzID0gdGhpcy5ub3JtYWxzLFxuICAgICAgICBqc29uTm9ybWFscyA9IGpzb24ubm9ybWFscyxcbiAgICAgICAgdGFuZ2VudHMgPSB0aGlzLnRhbmdlbnRzLFxuICAgICAgICBqc29uVGFuZ2VudHMgPSBqc29uLnRhbmdlbnRzLFxuICAgICAgICBpbmRpY2VzID0gdGhpcy5pbmRpY2VzLFxuICAgICAgICBqc29uSW5kaWNlcyA9IGpzb24uaW5kaWNlcyxcbiAgICAgICAgY29sb3JzID0gdGhpcy5jb2xvcnMsXG4gICAgICAgIGpzb25Db2xvcnMgPSBqc29uLmNvbG9ycyxcbiAgICAgICAgdXZzID0gdGhpcy51dnMsXG4gICAgICAgIGpzb25VdnMgPSBqc29uLnV2cyxcbiAgICAgICAgdXZzMiA9IHRoaXMudXZzMixcbiAgICAgICAganNvblV2MnMgPSBqc29uLnV2czIsXG4gICAgICAgIGJvbmVzID0gdGhpcy5ib25lcyxcbiAgICAgICAganNvbk1lc2hCb25lcyA9IGpzb24uYm9uZXMsXG4gICAgICAgIGJvbmVJbmRpY2VzID0gdGhpcy5ib25lSW5kaWNlcyxcbiAgICAgICAganNvbk1lc2hCb25lSW5kaWNlcyA9IGpzb24uYm9uZUluZGljZXMsXG4gICAgICAgIGJvbmVXZWlnaHRzID0gdGhpcy5ib25lV2VpZ2h0cyxcbiAgICAgICAganNvbk1lc2hCb25lV2VpZ2h0cyA9IGpzb24uYm9uZVdlaWdodHMsXG4gICAgICAgIGk7XG5cbiAgICB2ZXJ0aWNlcy5sZW5ndGggPSBqc29uVmVydGljZXMubGVuZ3RoO1xuICAgIG5vcm1hbHMubGVuZ3RoID0ganNvbk5vcm1hbHMubGVuZ3RoO1xuICAgIHRhbmdlbnRzLmxlbmd0aCA9IGpzb25UYW5nZW50cy5sZW5ndGg7XG4gICAgaW5kaWNlcy5sZW5ndGggPSBqc29uSW5kaWNlcy5sZW5ndGg7XG4gICAgY29sb3JzLmxlbmd0aCA9IGpzb25Db2xvcnMubGVuZ3RoO1xuICAgIHV2cy5sZW5ndGggPSBqc29uVXZzLmxlbmd0aDtcbiAgICB1dnMyLmxlbmd0aCA9IGpzb25VdjJzLmxlbmd0aDtcblxuICAgIGJvbmVzLmxlbmd0aCA9IGpzb25NZXNoQm9uZXMubGVuZ3RoO1xuICAgIGJvbmVJbmRpY2VzLmxlbmd0aCA9IGpzb25NZXNoQm9uZUluZGljZXMubGVuZ3RoO1xuICAgIGJvbmVXZWlnaHRzLmxlbmd0aCA9IGpzb25NZXNoQm9uZVdlaWdodHMubGVuZ3RoO1xuXG4gICAgZm9yIChpID0ganNvblZlcnRpY2VzLmxlbmd0aDsgaS0tOykgdmVydGljZXNbaV0gPSAodmVydGljZXNbaV0gfHwgbmV3IFZlYzMpLmNvcHkoanNvblZlcnRpY2VzW2ldKTtcbiAgICBmb3IgKGkgPSBqc29uTm9ybWFscy5sZW5ndGg7IGktLTspIG5vcm1hbHNbaV0gPSAobm9ybWFsc1tpXSB8fCBuZXcgVmVjMykuY29weS5mcm9tSlNPTihqc29uTm9ybWFsc1tpXSk7XG4gICAgZm9yIChpID0ganNvblRhbmdlbnRzLmxlbmd0aDsgaS0tOykgdGFuZ2VudHNbaV0gPSAodGFuZ2VudHNbaV0gfHwgbmV3IFZlYzQpLmZyb21KU09OKGpzb25UYW5nZW50c1tpXSk7XG4gICAgZm9yIChpID0ganNvbkluZGljZXMubGVuZ3RoOyBpLS07KSBpbmRpY2VzW2ldID0ganNvbkluZGljZXNbaV07XG4gICAgZm9yIChpID0ganNvbkNvbG9ycy5sZW5ndGg7IGktLTspIGNvbG9yc1tpXSA9IChjb2xvcnNbaV0gfHwgbmV3IENvbG9yKS5mcm9tSlNPTihqc29uQ29sb3JzW2ldKTtcbiAgICBmb3IgKGkgPSBqc29uVXZzLmxlbmd0aDsgaS0tOykgdXZzW2ldID0gKHV2c1tpXSB8fCBuZXcgVmVjMikuZnJvbUpTT04oanNvblV2c1tpXSk7XG4gICAgZm9yIChpID0ganNvblV2MnMubGVuZ3RoOyBpLS07KSB1dnMyW2ldID0gKHV2czJbaV0gfHwgbmV3IFZlYzIpLmZyb21KU09OKGpzb25VdjJzW2ldKTtcbiAgICBmb3IgKGkgPSBqc29uTWVzaEJvbmVzLmxlbmd0aDsgaS0tOykgYm9uZXNbaV0gPSAoYm9uZXNbaV0gfHwgbmV3IE1lc2hCb25lKS5mcm9tSlNPTihqc29uTWVzaEJvbmVzW2ldKTtcbiAgICBmb3IgKGkgPSBqc29uTWVzaEJvbmVJbmRpY2VzLmxlbmd0aDsgaS0tOykgYm9uZUluZGljZXNbaV0gPSBqc29uTWVzaEJvbmVJbmRpY2VzW2ldO1xuICAgIGZvciAoaSA9IGpzb25NZXNoQm9uZVdlaWdodHMubGVuZ3RoOyBpLS07KSBib25lV2VpZ2h0c1tpXSA9IGpzb25NZXNoQm9uZVdlaWdodHNbaV07XG5cbiAgICB0aGlzLmR5bmFtaWMgPSBqc29uLmR5bmFtaWM7XG4gICAgdGhpcy51c2VCb25lcyA9IGpzb24udXNlQm9uZXM7XG5cbiAgICB0aGlzLmFhYmIuZnJvbVBvaW50cyh0aGlzLnZlcnRpY2VzKTtcblxuICAgIHRoaXMudmVydGljZXNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLm5vcm1hbHNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLnRhbmdlbnRzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5pbmRpY2VzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5jb2xvcnNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLnV2c05lZWRVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMudXZzMk5lZWRVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuYm9uZUluZGljZXNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLmJvbmVXZWlnaHRzTmVlZFVwZGF0ZSA9IHRydWU7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxudmFyIFBJID0gTWF0aC5QSSxcbiAgICBIQUxGX1BJID0gUEkgKiAwLjUsXG4gICAgVFdPX1BJID0gUEkgKiAyLFxuICAgIHNpbiA9IE1hdGguc2luLFxuICAgIGNvcyA9IE1hdGguY29zO1xuTWVzaC5TcGhlcmUgPSBmdW5jdGlvbiAob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG4gICAgdmFyIHJhZGl1cyA9IG9wdHMucmFkaXVzICE9IHVuZGVmaW5lZCA/IG9wdHMucmFkaXVzIDogMC41LFxuICAgICAgICBzZWdtZW50cyA9IChvcHRzLnNlZ21lbnRzICE9IHVuZGVmaW5lZCA/IGZsb29yKG1heChvcHRzLnNlZ21lbnRzLCAzKSkgOiAxNikgKyAxLFxuICAgICAgICByaW5ncyA9IChvcHRzLnJpbmdzICE9IHVuZGVmaW5lZCA/IGZsb29yKG1heChvcHRzLnJpbmdzLCAzKSkgOiA4KSArIDIsXG5cbiAgICAgICAgUiA9IDEgLyAocmluZ3MgLSAxKSxcbiAgICAgICAgUyA9IDEgLyAoc2VnbWVudHMgLSAxKSxcbiAgICAgICAgciwgcyxcbiAgICAgICAgeCwgeSwgeixcbiAgICAgICAgYSwgYiwgYywgZCxcblxuICAgICAgICBtZXNoID0gbmV3IE1lc2gob3B0cyksXG4gICAgICAgIHZlcnRpY2VzID0gbWVzaC52ZXJ0aWNlcyxcbiAgICAgICAgbm9ybWFscyA9IG1lc2gubm9ybWFscyxcbiAgICAgICAgdXZzID0gbWVzaC51dnMsXG4gICAgICAgIGNvbG9ycyA9IG1lc2guY29sb3JzLFxuICAgICAgICBpbmRpY2VzID0gbWVzaC5pbmRpY2VzO1xuXG4gICAgZm9yIChyID0gMDsgciA8IHJpbmdzOyByKyspIHtcbiAgICAgICAgZm9yIChzID0gMDsgcyA8IHNlZ21lbnRzOyBzKyspIHtcbiAgICAgICAgICAgIHogPSBzaW4oLUhBTEZfUEkgKyBQSSAqIHIgKiBSKTtcbiAgICAgICAgICAgIHggPSBjb3MoVFdPX1BJICogcyAqIFMpICogc2luKFBJICogciAqIFIpO1xuICAgICAgICAgICAgeSA9IHNpbihUV09fUEkgKiBzICogUykgKiBzaW4oUEkgKiByICogUik7XG5cbiAgICAgICAgICAgIHZlcnRpY2VzLnB1c2gobmV3IFZlYzMoeCwgeSwgeikuc211bChyYWRpdXMpKTtcbiAgICAgICAgICAgIG5vcm1hbHMucHVzaChuZXcgVmVjMyh4LCB5LCB6KSk7XG4gICAgICAgICAgICB1dnMucHVzaChuZXcgVmVjMihzICogUywgciAqIFIpKTtcbiAgICAgICAgICAgIGNvbG9ycy5wdXNoKG5ldyBWZWMzKHMgKiBTLCByICogUiwgMCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChyID0gMDsgciA8IHJpbmdzIC0gMTsgcisrKSB7XG4gICAgICAgIGZvciAocyA9IDA7IHMgPCBzZWdtZW50cyAtIDE7IHMrKykge1xuICAgICAgICAgICAgYSA9IHIgKiBzZWdtZW50cyArIHM7XG4gICAgICAgICAgICBiID0gciAqIHNlZ21lbnRzICsgKHMgKyAxKTtcbiAgICAgICAgICAgIGMgPSAociArIDEpICogc2VnbWVudHMgKyAocyArIDEpO1xuICAgICAgICAgICAgZCA9IChyICsgMSkgKiBzZWdtZW50cyArIHM7XG5cbiAgICAgICAgICAgIGluZGljZXMucHVzaChhLCBiLCBjKTtcbiAgICAgICAgICAgIGluZGljZXMucHVzaChhLCBjLCBkKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1lc2guY2FsY3VsYXRlQUFCQigpO1xuICAgIG1lc2gubG9hZCA9IGZhbHNlO1xuICAgIGlmIChvcHRzLnRhbmdlbnRzKSBtZXNoLmNhbGN1bGF0ZVRhbmdlbnRzKCk7XG5cbiAgICByZXR1cm4gbWVzaDtcbn07XG5cblxuTWVzaC5DdWJlID0gZnVuY3Rpb24gKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuICAgIHZhciB3ID0gb3B0cy53aWR0aCB8fCAxLFxuICAgICAgICBoID0gb3B0cy5oZWlnaHQgfHwgMSxcbiAgICAgICAgZCA9IG9wdHMuZGVwdGggfHwgMSxcbiAgICAgICAgaHcgPSB3ICogMC41LFxuICAgICAgICBoaCA9IGggKiAwLjUsXG4gICAgICAgIGhkID0gZCAqIDAuNSxcbiAgICAgICAgd3MgPSAob3B0cy53aWR0aFNlZ21lbnRzIHx8IDEpLFxuICAgICAgICBocyA9IChvcHRzLmhlaWdodFNlZ21lbnRzIHx8IDEpLFxuICAgICAgICBkcyA9IChvcHRzLmRlcHRoU2VnbWVudHMgfHwgMSksXG4gICAgICAgIG1lc2ggPSBuZXcgTWVzaChvcHRzKTtcblxuICAgIGJ1aWxkUGxhbmUobWVzaCwgXCJ6XCIsIFwieVwiLCAtMSwgMSwgZCwgZHMsIGgsIGhzLCBodywgd3MpO1xuICAgIGJ1aWxkUGxhbmUobWVzaCwgXCJ6XCIsIFwieVwiLCAxLCAxLCBkLCBkcywgaCwgaHMsIC1odywgd3MpO1xuICAgIGJ1aWxkUGxhbmUobWVzaCwgXCJ4XCIsIFwielwiLCAxLCAtMSwgdywgd3MsIGQsIGRzLCBoaCwgaHMpO1xuICAgIGJ1aWxkUGxhbmUobWVzaCwgXCJ4XCIsIFwielwiLCAxLCAxLCB3LCB3cywgZCwgZHMsIC1oaCwgaHMpO1xuICAgIGJ1aWxkUGxhbmUobWVzaCwgXCJ4XCIsIFwieVwiLCAxLCAxLCB3LCB3cywgaCwgaHMsIGhkLCBkcyk7XG4gICAgYnVpbGRQbGFuZShtZXNoLCBcInhcIiwgXCJ5XCIsIC0xLCAxLCB3LCB3cywgaCwgaHMsIC1oZCwgZHMpO1xuXG4gICAgbWVzaC5jYWxjdWxhdGVBQUJCKCk7XG4gICAgbWVzaC5sb2FkID0gZmFsc2U7XG4gICAgaWYgKG9wdHMudGFuZ2VudHMpIG1lc2guY2FsY3VsYXRlVGFuZ2VudHMoKTtcblxuICAgIHJldHVybiBtZXNoO1xufTtcblxuXG5NZXNoLlBsYW5lID0gZnVuY3Rpb24gKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuICAgIHZhciB3ID0gb3B0cy53aWR0aCB8fCAxLFxuICAgICAgICBoID0gb3B0cy5oZWlnaHQgfHwgMSxcbiAgICAgICAgd3MgPSAob3B0cy53aWR0aFNlZ21lbnRzIHx8IDEpLFxuICAgICAgICBocyA9IChvcHRzLmhlaWdodFNlZ21lbnRzIHx8IDEpLFxuICAgICAgICBtZXNoID0gbmV3IE1lc2gob3B0cyk7XG5cbiAgICBidWlsZFBsYW5lKG1lc2gsIFwieFwiLCBcInlcIiwgMSwgMSwgdywgd3MsIGgsIGhzLCAwLCAwKTtcblxuICAgIG1lc2guY2FsY3VsYXRlQUFCQigpO1xuICAgIG1lc2gubG9hZCA9IGZhbHNlO1xuICAgIGlmIChvcHRzLnRhbmdlbnRzKSBtZXNoLmNhbGN1bGF0ZVRhbmdlbnRzKCk7XG5cbiAgICByZXR1cm4gbWVzaDtcbn07XG5cblxuZnVuY3Rpb24gYnVpbGRQbGFuZShtZXNoLCB1LCB2LCB1ZGlyLCB2ZGlyLCB3aWR0aCwgd3MsIGhlaWdodCwgaHMsIGRlcHRoLCBkcykge1xuICAgIHZhciB2ZXJ0aWNlcyA9IG1lc2gudmVydGljZXMsXG4gICAgICAgIG5vcm1hbHMgPSBtZXNoLm5vcm1hbHMsXG4gICAgICAgIGluZGljZXMgPSBtZXNoLmluZGljZXMsXG4gICAgICAgIHV2cyA9IG1lc2gudXZzLFxuICAgICAgICBncmlkWCA9IHdzLFxuICAgICAgICBncmlkWSA9IGhzLFxuICAgICAgICB3aWR0aF9oYWxmID0gd2lkdGggLyAyLFxuICAgICAgICBoZWlnaHRfaGFsZiA9IGhlaWdodCAvIDIsXG4gICAgICAgIG9mZnNldCA9IHZlcnRpY2VzLmxlbmd0aCxcbiAgICAgICAgdywgaXgsIGl5O1xuXG4gICAgaWYgKCh1ID09PSBcInhcIiAmJiB2ID09PSBcInpcIikgfHwgKHUgPT09IFwielwiICYmIHYgPT09IFwieFwiKSkge1xuICAgICAgICB3ID0gXCJ5XCI7XG4gICAgICAgIGdyaWRZID0gZHM7XG4gICAgfSBlbHNlIGlmICgodSA9PT0gXCJ4XCIgJiYgdiA9PT0gXCJ5XCIpIHx8ICh1ID09PSBcInlcIiAmJiB2ID09PSBcInhcIikpIHtcbiAgICAgICAgdyA9IFwielwiO1xuICAgIH0gZWxzZSBpZiAoKHUgPT09IFwieVwiICYmIHYgPT09IFwielwiKSB8fCAodSA9PT0gXCJ6XCIgJiYgdiA9PT0gXCJ5XCIpKSB7XG4gICAgICAgIHcgPSBcInhcIjtcbiAgICAgICAgZ3JpZFggPSBkcztcbiAgICB9XG5cbiAgICB2YXIgZ3JpZFgxID0gZ3JpZFggKyAxLFxuICAgICAgICBncmlkWTEgPSBncmlkWSArIDEsXG4gICAgICAgIHNlZ21lbnRfd2lkdGggPSB3aWR0aCAvIGdyaWRYLFxuICAgICAgICBzZWdtZW50X2hlaWdodCA9IGhlaWdodCAvIGdyaWRZLFxuICAgICAgICBub3JtYWwgPSBuZXcgVmVjMygpLFxuICAgICAgICB2ZXJ0ZXhDb3VudCA9IG9mZnNldDtcblxuICAgIG5vcm1hbFt3XSA9IGRlcHRoID4gMCA/IDEgOiAtMTtcblxuICAgIGZ1bmN0aW9uIGFkZFZlcnRleCh4LCB5LCB6KSB7XG4gICAgICAgIHZhciB2ZWN0b3IgPSBuZXcgVmVjMygpO1xuICAgICAgICB2ZWN0b3JbdV0gPSB4O1xuICAgICAgICB2ZWN0b3Jbdl0gPSB5O1xuICAgICAgICB2ZWN0b3Jbd10gPSB6O1xuICAgICAgICB2ZXJ0aWNlcy5wdXNoKHZlY3Rvcik7XG4gICAgfVxuXG4gICAgZm9yIChpeSA9IDA7IGl5IDwgZ3JpZFk7IGl5KyspIHtcbiAgICAgICAgZm9yIChpeCA9IDA7IGl4IDwgZ3JpZFg7IGl4KyspIHtcbiAgICAgICAgICAgIGFkZFZlcnRleChcbiAgICAgICAgICAgICAgICAoKGl4ICsgMSkgKiBzZWdtZW50X3dpZHRoIC0gd2lkdGhfaGFsZikgKiB1ZGlyLCAoKGl5ICsgMSkgKiBzZWdtZW50X2hlaWdodCAtIGhlaWdodF9oYWxmKSAqIHZkaXIsXG4gICAgICAgICAgICAgICAgZGVwdGhcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB1dnMucHVzaChuZXcgVmVjMigoaXggKyAxKSAvIGdyaWRYLCAxIC0gKGl5ICsgMSkgLyBncmlkWSkpO1xuXG4gICAgICAgICAgICBhZGRWZXJ0ZXgoXG4gICAgICAgICAgICAgICAgKGl4ICogc2VnbWVudF93aWR0aCAtIHdpZHRoX2hhbGYpICogdWRpciwgKChpeSArIDEpICogc2VnbWVudF9oZWlnaHQgLSBoZWlnaHRfaGFsZikgKiB2ZGlyLFxuICAgICAgICAgICAgICAgIGRlcHRoXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdXZzLnB1c2gobmV3IFZlYzIoaXggLyBncmlkWCwgMSAtIChpeSArIDEpIC8gZ3JpZFkpKTtcblxuICAgICAgICAgICAgYWRkVmVydGV4KFxuICAgICAgICAgICAgICAgIChpeCAqIHNlZ21lbnRfd2lkdGggLSB3aWR0aF9oYWxmKSAqIHVkaXIsIChpeSAqIHNlZ21lbnRfaGVpZ2h0IC0gaGVpZ2h0X2hhbGYpICogdmRpcixcbiAgICAgICAgICAgICAgICBkZXB0aFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHV2cy5wdXNoKG5ldyBWZWMyKGl4IC8gZ3JpZFgsIDEgLSBpeSAvIGdyaWRZKSk7XG5cbiAgICAgICAgICAgIGFkZFZlcnRleChcbiAgICAgICAgICAgICAgICAoKGl4ICsgMSkgKiBzZWdtZW50X3dpZHRoIC0gd2lkdGhfaGFsZikgKiB1ZGlyLCAoaXkgKiBzZWdtZW50X2hlaWdodCAtIGhlaWdodF9oYWxmKSAqIHZkaXIsXG4gICAgICAgICAgICAgICAgZGVwdGhcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB1dnMucHVzaChuZXcgVmVjMigoaXggKyAxKSAvIGdyaWRYLCAxIC0gaXkgLyBncmlkWSkpO1xuXG4gICAgICAgICAgICBpbmRpY2VzLnB1c2goXG4gICAgICAgICAgICAgICAgdmVydGV4Q291bnQsIHZlcnRleENvdW50ICsgMSwgdmVydGV4Q291bnQgKyAyLFxuICAgICAgICAgICAgICAgIHZlcnRleENvdW50LCB2ZXJ0ZXhDb3VudCArIDIsIHZlcnRleENvdW50ICsgM1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIG5vcm1hbHMucHVzaChub3JtYWwuY2xvbmUoKSwgbm9ybWFsLmNsb25lKCksIG5vcm1hbC5jbG9uZSgpLCBub3JtYWwuY2xvbmUoKSk7XG4gICAgICAgICAgICB2ZXJ0ZXhDb3VudCArPSA0O1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cbk1lc2guTWVzaEJvbmUgPSBNZXNoQm9uZTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IE1lc2g7XG4iLCJ2YXIgVmVjMyA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3ZlYzNcIik7XG52YXIgUXVhdCA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3F1YXRcIik7XG52YXIgTWF0NCA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL21hdDRcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgVU5LTk9XTiA9IDA7XG5cblxuZnVuY3Rpb24gTWVzaEJvbmUocGFyZW50SW5kZXgsIG5hbWUpIHtcblxuICAgIHRoaXMucGFyZW50SW5kZXggPSBwYXJlbnRJbmRleCAhPSB1bmRlZmluZWQgPyBwYXJlbnRJbmRleCA6IC0xO1xuICAgIHRoaXMubmFtZSA9IG5hbWUgIT0gdW5kZWZpbmVkID8gbmFtZSA6IFwiTWVzaEJvbmVfXCIgKyBVTktOT1dOKys7XG5cbiAgICB0aGlzLnNraW5uZWQgPSBmYWxzZTtcbiAgICB0aGlzLnBvc2l0aW9uID0gbmV3IFZlYzM7XG4gICAgdGhpcy5yb3RhdGlvbiA9IG5ldyBRdWF0O1xuICAgIHRoaXMuc2NhbGUgPSBuZXcgVmVjMztcbiAgICB0aGlzLmJpbmRQb3NlID0gbmV3IE1hdDQ7XG59XG5cblxuTWVzaEJvbmUucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIG5ldyBNZXNoQm9uZSgpLmNvcHkodGhpcyk7XG59O1xuXG5cbk1lc2hCb25lLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICB0aGlzLm5hbWUgPSBvdGhlci5uYW1lO1xuICAgIHRoaXMucGFyZW50SW5kZXggPSBvdGhlci5wYXJlbnRJbmRleDtcblxuICAgIHRoaXMuc2tpbm5lZCA9IG90aGVyLnNraW5uZWQ7XG4gICAgdGhpcy5wb3NpdGlvbi5jb3B5KG90aGVyLnBvc2l0aW9uKTtcbiAgICB0aGlzLnJvdGF0aW9uLmNvcHkob3RoZXIucm90YXRpb24pO1xuICAgIHRoaXMuc2NhbGUuY29weShvdGhlci5zY2FsZSk7XG4gICAgdGhpcy5iaW5kUG9zZS5jb3B5KG90aGVyLmJpbmRQb3NlKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5NZXNoQm9uZS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0ge30pO1xuXG4gICAganNvbi5uYW1lID0gdGhpcy5uYW1lO1xuICAgIGpzb24ucGFyZW50SW5kZXggPSB0aGlzLnBhcmVudEluZGV4O1xuXG4gICAganNvbi5za2lubmVkID0gdGhpcy5za2lubmVkO1xuICAgIGpzb24ucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uLnRvSlNPTihqc29uLnBvc2l0aW9uKTtcbiAgICBqc29uLnJvdGF0aW9uID0gdGhpcy5yb3RhdGlvbi50b0pTT04oanNvbi5yb3RhdGlvbik7XG4gICAganNvbi5zY2FsZSA9IHRoaXMuc2NhbGUudG9KU09OKGpzb24uc2NhbGUpO1xuICAgIGpzb24uYmluZFBvc2UgPSB0aGlzLmJpbmRQb3NlLnRvSlNPTihqc29uLmJpbmRQb3NlKTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5NZXNoQm9uZS5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuXG4gICAgdGhpcy5uYW1lID0ganNvbi5uYW1lO1xuICAgIHRoaXMucGFyZW50SW5kZXggPSBqc29uLnBhcmVudEluZGV4O1xuXG4gICAgdGhpcy5za2lubmVkID0ganNvbi5za2lubmVkO1xuICAgIHRoaXMucG9zaXRpb24uZnJvbUpTT04oanNvbi5wb3NpdGlvbik7XG4gICAgdGhpcy5yb3RhdGlvbi5mcm9tSlNPTihqc29uLnJvdGF0aW9uKTtcbiAgICB0aGlzLnNjYWxlLmZyb21KU09OKGpzb24uc2NhbGUpO1xuICAgIHRoaXMuYmluZFBvc2UuZnJvbUpTT04oanNvbi5iaW5kUG9zZSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBNZXNoQm9uZTtcbiIsInZhciBTaGFkZXIgPSByZXF1aXJlKFwiLi4vc2hhZGVyXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gRGlmZnVzZSgpIHtcblxuICAgIFNoYWRlci5jYWxsKHRoaXMsIHtcbiAgICAgICAgbmFtZTogXCJzaGFkZXJfZGlmZnVzZVwiLFxuICAgICAgICBsb2FkOiBmYWxzZSxcblxuICAgICAgICBsaWdodHM6IHRydWUsXG4gICAgICAgIHNwZWN1bGFyOiBmYWxzZSxcblxuICAgICAgICB2ZXJ0ZXg6IFtcbiAgICAgICAgICAgIFwidmFyeWluZyB2ZWMyIHZVdjtcIixcblxuICAgICAgICAgICAgXCJ2b2lkIG1haW4oKSB7XCIsXG4gICAgICAgICAgICBcIlx0dlV2ID0gdXY7XCIsXG4gICAgICAgICAgICBcIlx0Z2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbXZQb3NpdGlvbjtcIixcbiAgICAgICAgICAgIFwifVwiXG4gICAgICAgIF0uam9pbihcIlxcblwiKSxcblxuICAgICAgICBmcmFnbWVudDogW1xuICAgICAgICAgICAgXCJ1bmlmb3JtIHZlYzMgZGlmZnVzZUNvbG9yO1wiLFxuICAgICAgICAgICAgXCJ1bmlmb3JtIHNhbXBsZXIyRCBkaWZmdXNlTWFwO1wiLFxuXG4gICAgICAgICAgICBcInZhcnlpbmcgdmVjMiB2VXY7XCIsXG5cbiAgICAgICAgICAgIFwidm9pZCBtYWluKCkge1wiLFxuICAgICAgICAgICAgXCJcdHZlYzMgZGlmZnVzZUxpZ2h0ID0gUGl4ZWxMaWdodE5vU3BlYyhub3JtYWxpemUodk5vcm1hbCkpO1wiLFxuXG4gICAgICAgICAgICBcIlx0dmVjNCBmaW5hbENvbG9yID0gdGV4dHVyZTJEKGRpZmZ1c2VNYXAsIHZVdik7XCIsXG4gICAgICAgICAgICBcIlx0ZmluYWxDb2xvci54eXogKj0gZGlmZnVzZUNvbG9yO1wiLFxuXG4gICAgICAgICAgICBcIlx0Z2xfRnJhZ0NvbG9yID0gdmVjNChkaWZmdXNlTGlnaHQgKiBmaW5hbENvbG9yLnh5eiwgZmluYWxDb2xvci53KTtcIixcbiAgICAgICAgICAgIFwifVwiXG4gICAgICAgIF0uam9pbihcIlxcblwiKVxuICAgIH0pO1xufVxuXG5TaGFkZXIuZXh0ZW5kKERpZmZ1c2UpO1xuXG5cbm1vZHVsZS5leHBvcnRzID0gRGlmZnVzZTtcbiIsInZhciBTaGFkZXIgPSByZXF1aXJlKFwiLi4vc2hhZGVyXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gTm9ybWFsRGlmZnVzZSgpIHtcblxuICAgIFNoYWRlci5jYWxsKHRoaXMsIHtcbiAgICAgICAgbmFtZTogXCJzaGFkZXJfbm9ybWFsX2RpZmZ1c2VcIixcbiAgICAgICAgbG9hZDogZmFsc2UsXG5cbiAgICAgICAgbGlnaHRzOiB0cnVlLFxuICAgICAgICBzcGVjdWxhcjogZmFsc2UsXG4gICAgICAgIE9FU19zdGFuZGFyZF9kZXJpdmF0aXZlczogdHJ1ZSxcblxuICAgICAgICB2ZXJ0ZXg6IFtcbiAgICAgICAgICAgIFwidmFyeWluZyB2ZWMyIHZVdjtcIixcbiAgICAgICAgICAgIFwidmFyeWluZyB2ZWMzIHZUYW5nZW50O1wiLFxuICAgICAgICAgICAgXCJ2YXJ5aW5nIHZlYzMgdkJpbm9ybWFsO1wiLFxuXG4gICAgICAgICAgICBcInZvaWQgbWFpbigpIHtcIixcbiAgICAgICAgICAgIFwiXHQjaWZkZWYgVVNFX1NLSU5OSU5HXCIsXG4gICAgICAgICAgICBcIlx0XHR2ZWM0IGJvbmVUYW5nZW50ID0gYm9uZU1hdHJpeCAqIHZlYzQoIHRhbmdlbnQueHl6LCAwLjAgKTtcIixcbiAgICAgICAgICAgIFwiXHRcdHZUYW5nZW50ID0gbm9ybWFsaXplKCBub3JtYWxNYXRyaXggKiBib25lVGFuZ2VudC54eXogKTtcIixcbiAgICAgICAgICAgIFwiXHQjZWxzZVwiLFxuICAgICAgICAgICAgXCJcdFx0dlRhbmdlbnQgPSBub3JtYWxpemUoIG5vcm1hbE1hdHJpeCAqIHRhbmdlbnQueHl6ICk7XCIsXG4gICAgICAgICAgICBcIlx0I2VuZGlmXCIsXG5cbiAgICAgICAgICAgIFwiXHR2VXYgPSB1djtcIixcbiAgICAgICAgICAgIFwiXHR2Qmlub3JtYWwgPSBub3JtYWxpemUoIGNyb3NzKCB2Tm9ybWFsLCB2VGFuZ2VudCApICogdGFuZ2VudC53ICk7XCIsXG5cbiAgICAgICAgICAgIFwiXHRnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtdlBvc2l0aW9uO1wiLFxuICAgICAgICAgICAgXCJ9XCJcbiAgICAgICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgICAgIGZyYWdtZW50OiBbXG4gICAgICAgICAgICBcInVuaWZvcm0gdmVjMyBkaWZmdXNlQ29sb3I7XCIsXG4gICAgICAgICAgICBcInVuaWZvcm0gc2FtcGxlcjJEIGRpZmZ1c2VNYXA7XCIsXG5cbiAgICAgICAgICAgIFwidW5pZm9ybSBzYW1wbGVyMkQgbm9ybWFsTWFwO1wiLFxuICAgICAgICAgICAgXCJ1bmlmb3JtIGZsb2F0IG5vcm1hbFNjYWxlO1wiLFxuXG4gICAgICAgICAgICBcInZhcnlpbmcgdmVjMiB2VXY7XCIsXG4gICAgICAgICAgICBcInZhcnlpbmcgdmVjMyB2VGFuZ2VudDtcIixcbiAgICAgICAgICAgIFwidmFyeWluZyB2ZWMzIHZCaW5vcm1hbDtcIixcblxuICAgICAgICAgICAgXCJ2b2lkIG1haW4oKSB7XCIsXG4gICAgICAgICAgICBcIlx0dmVjMyBub3JtYWxUZXggPSB0ZXh0dXJlMkQoIG5vcm1hbE1hcCwgdlV2ICkueHl6ICogMi4wIC0gMS4wO1wiLFxuICAgICAgICAgICAgXCJcdG5vcm1hbFRleC54eSAqPSBub3JtYWxTY2FsZTtcIixcblxuICAgICAgICAgICAgXCJcdG1hdDMgdHNiID0gbWF0MyggdlRhbmdlbnQsIHZCaW5vcm1hbCwgdk5vcm1hbCApO1wiLFxuICAgICAgICAgICAgXCJcdHZlYzMgbm9ybWFsID0gbm9ybWFsaXplKHRzYiAqIG5vcm1hbFRleCk7XCIsXG5cbiAgICAgICAgICAgIFwiXHR2ZWMzIGRpZmZ1c2VMaWdodCA9IFBpeGVsTGlnaHROb1NwZWMobm9ybWFsKTtcIixcblxuICAgICAgICAgICAgXCJcdHZlYzQgZmluYWxDb2xvciA9IHRleHR1cmUyRChkaWZmdXNlTWFwLCB2VXYpO1wiLFxuICAgICAgICAgICAgXCJcdGZpbmFsQ29sb3IueHl6ICo9IGRpZmZ1c2VDb2xvcjtcIixcblxuICAgICAgICAgICAgXCJcdGdsX0ZyYWdDb2xvciA9IHZlYzQoZGlmZnVzZUxpZ2h0ICogZmluYWxDb2xvci54eXosIGZpbmFsQ29sb3Iudyk7XCIsXG4gICAgICAgICAgICBcIn1cIlxuICAgICAgICBdLmpvaW4oXCJcXG5cIilcbiAgICB9KTtcbn1cblxuU2hhZGVyLmV4dGVuZChOb3JtYWxEaWZmdXNlKTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IE5vcm1hbERpZmZ1c2U7XG4iLCJ2YXIgU2hhZGVyID0gcmVxdWlyZShcIi4uL3NoYWRlclwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIE5vcm1hbFNwZWN1bGFyKCkge1xuXG4gICAgU2hhZGVyLmNhbGwodGhpcywge1xuICAgICAgICBuYW1lOiBcInNoYWRlcl9ub3JtYWxfc3BlY3VsYXJcIixcbiAgICAgICAgbG9hZDogZmFsc2UsXG5cbiAgICAgICAgZmFsbGJhY2s6IFwic3BlY3VsYXJcIixcblxuICAgICAgICBsaWdodHM6IHRydWUsXG4gICAgICAgIE9FU19zdGFuZGFyZF9kZXJpdmF0aXZlczogdHJ1ZSxcblxuICAgICAgICB2ZXJ0ZXg6IFtcbiAgICAgICAgICAgIFwidmFyeWluZyB2ZWMyIHZVdjtcIixcbiAgICAgICAgICAgIFwidmFyeWluZyB2ZWMzIHZUYW5nZW50O1wiLFxuICAgICAgICAgICAgXCJ2YXJ5aW5nIHZlYzMgdkJpbm9ybWFsO1wiLFxuXG4gICAgICAgICAgICBcInZvaWQgbWFpbigpIHtcIixcbiAgICAgICAgICAgIFwiXHQjaWZkZWYgVVNFX1NLSU5OSU5HXCIsXG4gICAgICAgICAgICBcIlx0XHR2ZWM0IGJvbmVUYW5nZW50ID0gYm9uZU1hdHJpeCAqIHZlYzQoIHRhbmdlbnQueHl6LCAwLjAgKTtcIixcbiAgICAgICAgICAgIFwiXHRcdHZUYW5nZW50ID0gbm9ybWFsaXplKCBub3JtYWxNYXRyaXggKiBib25lVGFuZ2VudC54eXogKTtcIixcbiAgICAgICAgICAgIFwiXHQjZWxzZVwiLFxuICAgICAgICAgICAgXCJcdFx0dlRhbmdlbnQgPSBub3JtYWxpemUoIG5vcm1hbE1hdHJpeCAqIHRhbmdlbnQueHl6ICk7XCIsXG4gICAgICAgICAgICBcIlx0I2VuZGlmXCIsXG5cbiAgICAgICAgICAgIFwiXHR2VXYgPSB1djtcIixcbiAgICAgICAgICAgIFwiXHR2Qmlub3JtYWwgPSBub3JtYWxpemUoIGNyb3NzKCB2Tm9ybWFsLCB2VGFuZ2VudCApICogdGFuZ2VudC53ICk7XCIsXG5cbiAgICAgICAgICAgIFwiXHRnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtdlBvc2l0aW9uO1wiLFxuICAgICAgICAgICAgXCJ9XCJcbiAgICAgICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgICAgIGZyYWdtZW50OiBbXG4gICAgICAgICAgICBcInVuaWZvcm0gdmVjMyBkaWZmdXNlQ29sb3I7XCIsXG4gICAgICAgICAgICBcInVuaWZvcm0gc2FtcGxlcjJEIGRpZmZ1c2VNYXA7XCIsXG5cbiAgICAgICAgICAgIFwidW5pZm9ybSBzYW1wbGVyMkQgbm9ybWFsTWFwO1wiLFxuICAgICAgICAgICAgXCJ1bmlmb3JtIGZsb2F0IG5vcm1hbFNjYWxlO1wiLFxuXG4gICAgICAgICAgICBcInVuaWZvcm0gZmxvYXQgc2hpbmluZXNzO1wiLFxuXG4gICAgICAgICAgICBcInZhcnlpbmcgdmVjMiB2VXY7XCIsXG4gICAgICAgICAgICBcInZhcnlpbmcgdmVjMyB2VGFuZ2VudDtcIixcbiAgICAgICAgICAgIFwidmFyeWluZyB2ZWMzIHZCaW5vcm1hbDtcIixcblxuICAgICAgICAgICAgXCJ2b2lkIG1haW4oKSB7XCIsXG4gICAgICAgICAgICBcIlx0dmVjNCBmaW5hbENvbG9yID0gdGV4dHVyZTJEKGRpZmZ1c2VNYXAsIHZVdik7XCIsXG4gICAgICAgICAgICBcIlx0ZmluYWxDb2xvci54eXogKj0gZGlmZnVzZUNvbG9yO1wiLFxuXG4gICAgICAgICAgICBcIlx0dmVjMyBub3JtYWxUZXggPSB0ZXh0dXJlMkQoIG5vcm1hbE1hcCwgdlV2ICkueHl6ICogMi4wIC0gMS4wO1wiLFxuICAgICAgICAgICAgXCJcdG5vcm1hbFRleC54eSAqPSBub3JtYWxTY2FsZTtcIixcblxuICAgICAgICAgICAgXCJcdG1hdDMgdHNiID0gbWF0MyggdlRhbmdlbnQsIHZCaW5vcm1hbCwgdk5vcm1hbCApO1wiLFxuICAgICAgICAgICAgXCJcdHZlYzMgbm9ybWFsID0gbm9ybWFsaXplKHRzYiAqIG5vcm1hbFRleCk7XCIsXG5cbiAgICAgICAgICAgIFwiXHR2ZWMzIGRpZmZ1c2VMaWdodCwgc3BlY3VsYXJMaWdodDtcIixcbiAgICAgICAgICAgIFwiXHRQaXhlbExpZ2h0KG5vcm1hbCwgdmVjMyhmaW5hbENvbG9yLncpLCBmaW5hbENvbG9yLncsIHNoaW5pbmVzcywgZGlmZnVzZUxpZ2h0LCBzcGVjdWxhckxpZ2h0KTtcIixcblxuICAgICAgICAgICAgXCJcdGdsX0ZyYWdDb2xvciA9IHZlYzQoZGlmZnVzZUxpZ2h0ICogZmluYWxDb2xvci54eXogKyBzcGVjdWxhckxpZ2h0ICogZmluYWxDb2xvci54eXosIDEuMCk7XCIsXG4gICAgICAgICAgICBcIn1cIlxuICAgICAgICBdLmpvaW4oXCJcXG5cIilcbiAgICB9KTtcbn1cblxuU2hhZGVyLmV4dGVuZChOb3JtYWxTcGVjdWxhcik7XG5cblxubW9kdWxlLmV4cG9ydHMgPSBOb3JtYWxTcGVjdWxhcjtcbiIsInZhciBTaGFkZXIgPSByZXF1aXJlKFwiLi4vc2hhZGVyXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gUGFyYWxsZXhEaWZmdXNlKCkge1xuXG4gICAgU2hhZGVyLmNhbGwodGhpcywge1xuICAgICAgICBuYW1lOiBcInNoYWRlcl9wYXJhbGxleF9kaWZmdXNlXCIsXG4gICAgICAgIGxvYWQ6IGZhbHNlLFxuXG4gICAgICAgIGxpZ2h0czogdHJ1ZSxcbiAgICAgICAgc3BlY3VsYXI6IGZhbHNlLFxuICAgICAgICBPRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXM6IHRydWUsXG5cbiAgICAgICAgdmVydGV4OiBbXG4gICAgICAgICAgICBcInZhcnlpbmcgdmVjMiB2VXY7XCIsXG4gICAgICAgICAgICBcInZhcnlpbmcgdmVjMyB2VGFuZ2VudDtcIixcbiAgICAgICAgICAgIFwidmFyeWluZyB2ZWMzIHZCaW5vcm1hbDtcIixcblxuICAgICAgICAgICAgXCJ2b2lkIG1haW4oKSB7XCIsXG4gICAgICAgICAgICBcIlx0I2lmZGVmIFVTRV9TS0lOTklOR1wiLFxuICAgICAgICAgICAgXCJcdFx0dmVjNCBib25lVGFuZ2VudCA9IGJvbmVNYXRyaXggKiB2ZWM0KCB0YW5nZW50Lnh5eiwgMC4wICk7XCIsXG4gICAgICAgICAgICBcIlx0XHR2VGFuZ2VudCA9IG5vcm1hbGl6ZSggbm9ybWFsTWF0cml4ICogYm9uZVRhbmdlbnQueHl6ICk7XCIsXG4gICAgICAgICAgICBcIlx0I2Vsc2VcIixcbiAgICAgICAgICAgIFwiXHRcdHZUYW5nZW50ID0gbm9ybWFsaXplKCBub3JtYWxNYXRyaXggKiB0YW5nZW50Lnh5eiApO1wiLFxuICAgICAgICAgICAgXCJcdCNlbmRpZlwiLFxuXG4gICAgICAgICAgICBcIlx0dlV2ID0gdXY7XCIsXG4gICAgICAgICAgICBcIlx0dkJpbm9ybWFsID0gbm9ybWFsaXplKCBjcm9zcyggdk5vcm1hbCwgdlRhbmdlbnQgKSAqIHRhbmdlbnQudyApO1wiLFxuXG4gICAgICAgICAgICBcIlx0Z2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbXZQb3NpdGlvbjtcIixcbiAgICAgICAgICAgIFwifVwiXG4gICAgICAgIF0uam9pbihcIlxcblwiKSxcblxuICAgICAgICBmcmFnbWVudDogW1xuICAgICAgICAgICAgXCJ1bmlmb3JtIHZlYzMgZGlmZnVzZUNvbG9yO1wiLFxuICAgICAgICAgICAgXCJ1bmlmb3JtIHNhbXBsZXIyRCBkaWZmdXNlTWFwO1wiLFxuXG4gICAgICAgICAgICBcInVuaWZvcm0gc2FtcGxlcjJEIG5vcm1hbE1hcDtcIixcbiAgICAgICAgICAgIFwidW5pZm9ybSBmbG9hdCBub3JtYWxTY2FsZTtcIixcblxuICAgICAgICAgICAgXCJ2YXJ5aW5nIHZlYzIgdlV2O1wiLFxuICAgICAgICAgICAgXCJ2YXJ5aW5nIHZlYzMgdlRhbmdlbnQ7XCIsXG4gICAgICAgICAgICBcInZhcnlpbmcgdmVjMyB2Qmlub3JtYWw7XCIsXG5cbiAgICAgICAgICAgIFwidm9pZCBtYWluKCkge1wiLFxuICAgICAgICAgICAgXCJcdHZlYzMgbm9ybWFsVGV4ID0gdGV4dHVyZTJEKCBub3JtYWxNYXAsIHZVdiApLnh5eiAqIDIuMCAtIDEuMDtcIixcbiAgICAgICAgICAgIFwiXHRub3JtYWxUZXgueHkgKj0gbm9ybWFsU2NhbGU7XCIsXG5cbiAgICAgICAgICAgIFwiXHRtYXQzIHRzYiA9IG1hdDMoIHZUYW5nZW50LCB2Qmlub3JtYWwsIHZOb3JtYWwgKTtcIixcbiAgICAgICAgICAgIFwiXHR2ZWMzIG5vcm1hbCA9IG5vcm1hbGl6ZSh0c2IgKiBub3JtYWxUZXgpO1wiLFxuXG4gICAgICAgICAgICBcIlx0dmVjMyBkaWZmdXNlTGlnaHQgPSBQaXhlbExpZ2h0Tm9TcGVjKG5vcm1hbCk7XCIsXG5cbiAgICAgICAgICAgIFwiXHR2ZWM0IGZpbmFsQ29sb3IgPSB0ZXh0dXJlMkQoZGlmZnVzZU1hcCwgdlV2KTtcIixcbiAgICAgICAgICAgIFwiXHRmaW5hbENvbG9yLnh5eiAqPSBkaWZmdXNlQ29sb3I7XCIsXG5cbiAgICAgICAgICAgIFwiXHRnbF9GcmFnQ29sb3IgPSB2ZWM0KGRpZmZ1c2VMaWdodCAqIGZpbmFsQ29sb3IueHl6LCBmaW5hbENvbG9yLncpO1wiLFxuICAgICAgICAgICAgXCJ9XCJcbiAgICAgICAgXS5qb2luKFwiXFxuXCIpXG4gICAgfSk7XG59XG5cblNoYWRlci5leHRlbmQoUGFyYWxsZXhEaWZmdXNlKTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFBhcmFsbGV4RGlmZnVzZTtcbiIsInZhciBTaGFkZXIgPSByZXF1aXJlKFwiLi4vc2hhZGVyXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gU3BlY3VsYXIoKSB7XG5cbiAgICBTaGFkZXIuY2FsbCh0aGlzLCB7XG4gICAgICAgIG5hbWU6IFwic2hhZGVyX3NwZWN1bGFyXCIsXG4gICAgICAgIGxvYWQ6IGZhbHNlLFxuXG4gICAgICAgIGxpZ2h0czogdHJ1ZSxcblxuICAgICAgICB2ZXJ0ZXg6IFtcbiAgICAgICAgICAgIFwidmFyeWluZyB2ZWMyIHZVdjtcIixcblxuICAgICAgICAgICAgXCJ2b2lkIG1haW4oKSB7XCIsXG4gICAgICAgICAgICBcIlx0dlV2ID0gdXY7XCIsXG4gICAgICAgICAgICBcIlx0Z2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbXZQb3NpdGlvbjtcIixcbiAgICAgICAgICAgIFwifVwiXG4gICAgICAgIF0uam9pbihcIlxcblwiKSxcblxuICAgICAgICBmcmFnbWVudDogW1xuICAgICAgICAgICAgXCJ1bmlmb3JtIHZlYzMgZGlmZnVzZUNvbG9yO1wiLFxuICAgICAgICAgICAgXCJ1bmlmb3JtIHNhbXBsZXIyRCBkaWZmdXNlTWFwO1wiLFxuXG4gICAgICAgICAgICBcInVuaWZvcm0gZmxvYXQgc2hpbmluZXNzO1wiLFxuXG4gICAgICAgICAgICBcInZhcnlpbmcgdmVjMiB2VXY7XCIsXG5cbiAgICAgICAgICAgIFwidm9pZCBtYWluKCkge1wiLFxuICAgICAgICAgICAgXCJcdHZlYzQgZmluYWxDb2xvciA9IHRleHR1cmUyRChkaWZmdXNlTWFwLCB2VXYpO1wiLFxuICAgICAgICAgICAgXCJcdGZpbmFsQ29sb3IueHl6ICo9IGRpZmZ1c2VDb2xvcjtcIixcblxuICAgICAgICAgICAgXCJcdHZlYzMgZGlmZnVzZUxpZ2h0LCBzcGVjdWxhckxpZ2h0O1wiLFxuICAgICAgICAgICAgXCJcdFBpeGVsTGlnaHQobm9ybWFsaXplKHZOb3JtYWwpLCB2ZWMzKGZpbmFsQ29sb3IudyksIGZpbmFsQ29sb3Iudywgc2hpbmluZXNzLCBkaWZmdXNlTGlnaHQsIHNwZWN1bGFyTGlnaHQpO1wiLFxuXG4gICAgICAgICAgICBcIlx0Z2xfRnJhZ0NvbG9yID0gdmVjNChkaWZmdXNlTGlnaHQgKiBmaW5hbENvbG9yLnh5eiArIHNwZWN1bGFyTGlnaHQgKiBmaW5hbENvbG9yLnh5eiwgMS4wKTtcIixcbiAgICAgICAgICAgIFwifVwiXG4gICAgICAgIF0uam9pbihcIlxcblwiKVxuICAgIH0pO1xufVxuXG5TaGFkZXIuZXh0ZW5kKFNwZWN1bGFyKTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFNwZWN1bGFyO1xuIiwidmFyIFNoYWRlciA9IHJlcXVpcmUoXCIuLi9zaGFkZXJcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBVbmxpdCgpIHtcblxuICAgIFNoYWRlci5jYWxsKHRoaXMsIHtcbiAgICAgICAgbmFtZTogXCJzaGFkZXJfdW5saXRcIixcbiAgICAgICAgbG9hZDogZmFsc2UsXG5cbiAgICAgICAgdmVydGV4OiBbXG4gICAgICAgICAgICBcInZhcnlpbmcgdmVjMiB2VXY7XCIsXG5cbiAgICAgICAgICAgIFwidm9pZCBtYWluKCkge1wiLFxuICAgICAgICAgICAgXCJcdHZVdiA9IHV2O1wiLFxuICAgICAgICAgICAgXCJcdGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG12UG9zaXRpb247XCIsXG4gICAgICAgICAgICBcIn1cIlxuICAgICAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICAgICAgZnJhZ21lbnQ6IFtcbiAgICAgICAgICAgIFwidW5pZm9ybSB2ZWMzIGRpZmZ1c2VDb2xvcjtcIixcbiAgICAgICAgICAgIFwidW5pZm9ybSBzYW1wbGVyMkQgZGlmZnVzZU1hcDtcIixcblxuICAgICAgICAgICAgXCJ2YXJ5aW5nIHZlYzIgdlV2O1wiLFxuXG4gICAgICAgICAgICBcInZvaWQgbWFpbigpIHtcIixcbiAgICAgICAgICAgIFwiXHR2ZWM0IGZpbmFsQ29sb3IgPSB0ZXh0dXJlMkQoZGlmZnVzZU1hcCwgdlV2KTtcIixcbiAgICAgICAgICAgIFwiXHRmaW5hbENvbG9yLnh5eiAqPSBkaWZmdXNlQ29sb3I7XCIsXG5cbiAgICAgICAgICAgIFwiXHRnbF9GcmFnQ29sb3IgPSBmaW5hbENvbG9yO1wiLFxuICAgICAgICAgICAgXCJ9XCJcbiAgICAgICAgXS5qb2luKFwiXFxuXCIpXG4gICAgfSk7XG59XG5cblNoYWRlci5leHRlbmQoVW5saXQpO1xuXG5cbm1vZHVsZS5leHBvcnRzID0gVW5saXQ7XG4iLCJ2YXIgU2hhZGVyID0gcmVxdWlyZShcIi4uL3NoYWRlclwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIFBhcnRpY2xlVW5saXQoKSB7XG5cbiAgICBTaGFkZXIuY2FsbCh0aGlzLCB7XG4gICAgICAgIG5hbWU6IFwic2hhZGVyX3BhcnRpY2xlX3VubGl0XCIsXG5cbiAgICAgICAgdmVydGV4OiBbXG4gICAgICAgICAgICBcInZvaWQgbWFpbigpIHtcIixcbiAgICAgICAgICAgIFwiXHRnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtdlBvc2l0aW9uO1wiLFxuICAgICAgICAgICAgXCJ9XCJcbiAgICAgICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgICAgIGZyYWdtZW50OiBbXG4gICAgICAgICAgICBcInVuaWZvcm0gc2FtcGxlcjJEIGRpZmZ1c2VNYXA7XCIsXG5cbiAgICAgICAgICAgIFwidm9pZCBtYWluKCkge1wiLFxuICAgICAgICAgICAgXCJcdGZsb2F0IGMgPSBjb3ModkFuZ2xlKTtcIixcbiAgICAgICAgICAgIFwiXHRmbG9hdCBzID0gc2luKHZBbmdsZSk7XCIsXG5cbiAgICAgICAgICAgIFwiXHR2ZWMyIHJvdGF0ZWRVViA9IHZlYzIoYyAqIChnbF9Qb2ludENvb3JkLnggLSAwLjUpICsgcyAqIChnbF9Qb2ludENvb3JkLnkgLSAwLjUpICsgMC41LFwiLFxuICAgICAgICAgICAgXCJcdFx0XHRcdFx0XHQgIGMgKiAoZ2xfUG9pbnRDb29yZC55IC0gMC41KSAtIHMgKiAoZ2xfUG9pbnRDb29yZC54IC0gMC41KSArIDAuNSk7XCIsXG5cbiAgICAgICAgICAgIFwiXHR2ZWM0IHJvdGF0ZWRUZXh0dXJlID0gdGV4dHVyZTJEKGRpZmZ1c2VNYXAsIHJvdGF0ZWRVVik7XCIsXG4gICAgICAgICAgICBcIlx0Z2xfRnJhZ0NvbG9yID0gdmVjNCh2UGFydGljbGVDb2xvciAqIHJvdGF0ZWRUZXh0dXJlLnh5eiwgdkFscGhhICogcm90YXRlZFRleHR1cmUudyk7XCIsXG4gICAgICAgICAgICBcIn1cIlxuICAgICAgICBdLmpvaW4oXCJcXG5cIilcbiAgICB9KTtcbn1cblxuU2hhZGVyLmV4dGVuZChQYXJ0aWNsZVVubGl0KTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFBhcnRpY2xlVW5saXQ7XG4iLCJ2YXIgU2hhZGVyID0gcmVxdWlyZShcIi4uL3NoYWRlclwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIFJlZmxlY3RpdmVWZXJ0ZXhMaXQoKSB7XG5cbiAgICBTaGFkZXIuY2FsbCh0aGlzLCB7XG4gICAgICAgIG5hbWU6IFwic2hhZGVyX3JlZmxlY3RpdmVfdmVydGV4X2xpdFwiLFxuICAgICAgICBsb2FkOiBmYWxzZSxcblxuICAgICAgICBsaWdodHM6IHRydWUsXG4gICAgICAgIHZlcnRleExpdDogdHJ1ZSxcblxuICAgICAgICB2ZXJ0ZXg6IFtcbiAgICAgICAgICAgIFwidmFyeWluZyB2ZWMyIHZVdjtcIixcbiAgICAgICAgICAgIFwidmFyeWluZyB2ZWMzIHZSZWZsZWN0O1wiLFxuICAgICAgICAgICAgXCJ2YXJ5aW5nIHZlYzMgdkRpZmZ1c2VMaWdodDtcIixcblxuICAgICAgICAgICAgXCJ2b2lkIG1haW4oKSB7XCIsXG4gICAgICAgICAgICBcIlx0dmVjMyB3b3JsZE5vcm1hbCA9IG5vcm1hbGl6ZShtYXQzKG1vZGVsTWF0cml4WzBdLnh5eiwgbW9kZWxNYXRyaXhbMV0ueHl6LCBtb2RlbE1hdHJpeFsyXS54eXopICogb2JqZWN0Tm9ybWFsKTtcIixcbiAgICAgICAgICAgIFwiXHR2ZWMzIGNhbWVyYVRvVmVydGV4ID0gbm9ybWFsaXplKHdvcmxkUG9zaXRpb24ueHl6IC0gY2FtZXJhUG9zaXRpb24pO1wiLFxuXG4gICAgICAgICAgICBcIlx0dlJlZmxlY3QgPSByZWZsZWN0KGNhbWVyYVRvVmVydGV4LCB3b3JsZE5vcm1hbCk7XCIsXG4gICAgICAgICAgICBcIlx0dlV2ID0gdXY7XCIsXG4gICAgICAgICAgICBcIlx0VmVydGV4TGlnaHQodHJhbnNmb3JtZWROb3JtYWwsIHdvcmxkUG9zaXRpb24ueHl6LCAtbXZQb3NpdGlvbi54eXosIHZEaWZmdXNlTGlnaHQpO1wiLFxuXG4gICAgICAgICAgICBcIlx0Z2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbXZQb3NpdGlvbjtcIixcbiAgICAgICAgICAgIFwifVwiXG4gICAgICAgIF0uam9pbihcIlxcblwiKSxcblxuICAgICAgICBmcmFnbWVudDogW1xuICAgICAgICAgICAgXCJ1bmlmb3JtIHZlYzMgZGlmZnVzZUNvbG9yO1wiLFxuICAgICAgICAgICAgXCJ1bmlmb3JtIHNhbXBsZXIyRCBkaWZmdXNlTWFwO1wiLFxuICAgICAgICAgICAgXCJ1bmlmb3JtIHNhbXBsZXJDdWJlIGVudk1hcDtcIixcblxuICAgICAgICAgICAgXCJ1bmlmb3JtIGZsb2F0IHJlZmxlY3Rpdml0eTtcIixcbiAgICAgICAgICAgIFwidW5pZm9ybSBpbnQgY29tYmluZTtcIixcblxuICAgICAgICAgICAgXCJ2YXJ5aW5nIHZlYzIgdlV2O1wiLFxuICAgICAgICAgICAgXCJ2YXJ5aW5nIHZlYzMgdlJlZmxlY3Q7XCIsXG4gICAgICAgICAgICBcInZhcnlpbmcgdmVjMyB2RGlmZnVzZUxpZ2h0O1wiLFxuXG4gICAgICAgICAgICBcInZvaWQgbWFpbigpIHtcIixcblxuICAgICAgICAgICAgXCJcdHZlYzQgZmluYWxDb2xvciA9IHRleHR1cmUyRChkaWZmdXNlTWFwLCB2VXYpO1wiLFxuICAgICAgICAgICAgXCJcdGZpbmFsQ29sb3IueHl6ICo9IGRpZmZ1c2VDb2xvcjtcIixcblxuICAgICAgICAgICAgXCJcdHZlYzMgY3ViZUNvbG9yID0gdGV4dHVyZUN1YmUoZW52TWFwLCB2UmVmbGVjdCkueHl6O1wiLFxuXG4gICAgICAgICAgICBcIlx0aWYgKGNvbWJpbmUgPT0gMSkge1wiLFxuICAgICAgICAgICAgXCJcdFx0ZmluYWxDb2xvci54eXogPSBtaXgoZmluYWxDb2xvci54eXosIGN1YmVDb2xvciwgcmVmbGVjdGl2aXR5KTtcIixcbiAgICAgICAgICAgIFwiXHR9IGVsc2UgaWYgKGNvbWJpbmUgPT0gMikge1wiLFxuICAgICAgICAgICAgXCJcdFx0ZmluYWxDb2xvci54eXogKz0gY3ViZUNvbG9yICogcmVmbGVjdGl2aXR5O1wiLFxuICAgICAgICAgICAgXCJcdH0gZWxzZSB7XCIsXG4gICAgICAgICAgICBcIlx0XHRmaW5hbENvbG9yLnh5eiA9IG1peChmaW5hbENvbG9yLnh5eiwgZmluYWxDb2xvci54eXogKiBjdWJlQ29sb3IsIHJlZmxlY3Rpdml0eSk7XCIsXG4gICAgICAgICAgICBcIlx0fVwiLFxuXG4gICAgICAgICAgICBcIlx0Z2xfRnJhZ0NvbG9yID0gdmVjNCh2RGlmZnVzZUxpZ2h0ICogZmluYWxDb2xvci54eXosIGZpbmFsQ29sb3Iudyk7XCIsXG4gICAgICAgICAgICBcIn1cIlxuICAgICAgICBdLmpvaW4oXCJcXG5cIilcbiAgICB9KTtcbn1cblxuU2hhZGVyLmV4dGVuZChSZWZsZWN0aXZlVmVydGV4TGl0KTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFJlZmxlY3RpdmVWZXJ0ZXhMaXQ7XG4iLCJ2YXIgQXNzZXQgPSByZXF1aXJlKFwiLi4vYXNzZXRcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBTaGFkZXIob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBBc3NldC5jYWxsKHRoaXMsIG9wdHMpO1xuXG4gICAgdGhpcy5mYWxsYmFjayA9IG9wdHMuZmFsbGJhY2sgfHwgXCJcIjtcblxuICAgIHRoaXMudmVydGV4ID0gb3B0cy52ZXJ0ZXggfHwgXCJ2b2lkIG1haW4odm9pZCkge31cIjtcbiAgICB0aGlzLmZyYWdtZW50ID0gb3B0cy5mcmFnbWVudCB8fCBcInZvaWQgbWFpbih2b2lkKSB7fVwiO1xuXG4gICAgdGhpcy5saWdodHMgPSBvcHRzLmxpZ2h0cyAhPSB1bmRlZmluZWQgPyBvcHRzLmxpZ2h0cyA6IGZhbHNlO1xuICAgIHRoaXMuc3BlY3VsYXIgPSBvcHRzLnNwZWN1bGFyICE9IHVuZGVmaW5lZCA/IG9wdHMuc3BlY3VsYXIgOiB0cnVlO1xuICAgIHRoaXMudmVydGV4TGl0ID0gb3B0cy52ZXJ0ZXhMaXQgIT0gdW5kZWZpbmVkID8gb3B0cy52ZXJ0ZXhMaXQgOiBmYWxzZTtcbiAgICB0aGlzLnNoYWRvd3MgPSBvcHRzLnNoYWRvd3MgIT0gdW5kZWZpbmVkID8gb3B0cy5zaGFkb3dzIDogZmFsc2U7XG4gICAgdGhpcy5mb2cgPSBvcHRzLmZvZyAhPSB1bmRlZmluZWQgPyBvcHRzLmZvZyA6IGZhbHNlO1xuXG4gICAgdGhpcy5PRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMgPSBvcHRzLk9FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyAhPSB1bmRlZmluZWQgPyBvcHRzLk9FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyA6IGZhbHNlO1xufVxuXG5Bc3NldC5leHRlbmQoU2hhZGVyKTtcblxuXG5TaGFkZXIucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICBBc3NldC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsIG90aGVyKTtcblxuICAgIHRoaXMuZmFsbGJhY2sgPSBvdGhlci5mYWxsYmFjaztcblxuICAgIHRoaXMudmVydGV4ID0gb3RoZXIudmVydGV4O1xuICAgIHRoaXMuZnJhZ21lbnQgPSBvdGhlci5mcmFnbWVudDtcblxuICAgIHRoaXMubGlnaHRzID0gb3RoZXIubGlnaHRzO1xuICAgIHRoaXMuc3BlY3VsYXIgPSBvdGhlci5zcGVjdWxhcjtcbiAgICB0aGlzLnZlcnRleExpdCA9IG90aGVyLnZlcnRleExpdDtcbiAgICB0aGlzLnNoYWRvd3MgPSBvdGhlci5zaGFkb3dzO1xuICAgIHRoaXMuZm9nID0gb3RoZXIuZm9nO1xuXG4gICAgdGhpcy5PRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMgPSBvdGhlci5PRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuU2hhZGVyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChyYXcpIHtcbiAgICBBc3NldC5wcm90b3R5cGUucGFyc2UuY2FsbCh0aGlzLCByYXcpO1xuXG4gICAgdGhpcy5mcm9tSlNPTihyYXcpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblNoYWRlci5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgQXNzZXQucHJvdG90eXBlLmNsZWFyLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLnZlcnRleCA9IFwiXCI7XG4gICAgdGhpcy5mcmFnbWVudCA9IFwiXCI7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuU2hhZGVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbiwgcGFjaykge1xuICAgIGpzb24gPSBBc3NldC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbiwgcGFjayk7XG5cbiAgICBqc29uLmZhbGxiYWNrID0gdGhpcy5mYWxsYmFjaztcblxuICAgIGpzb24udmVydGV4ID0gdGhpcy52ZXJ0ZXg7XG4gICAganNvbi5mcmFnbWVudCA9IHRoaXMuZnJhZ21lbnQ7XG5cbiAgICBqc29uLmxpZ2h0cyA9IHRoaXMubGlnaHRzO1xuICAgIGpzb24uc3BlY3VsYXIgPSB0aGlzLnNwZWN1bGFyO1xuICAgIGpzb24udmVydGV4TGl0ID0gdGhpcy52ZXJ0ZXhMaXQ7XG4gICAganNvbi5zaGFkb3dzID0gdGhpcy5zaGFkb3dzO1xuICAgIGpzb24uZm9nID0gdGhpcy5mb2c7XG5cbiAgICBqc29uLk9FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyA9IHRoaXMuT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cblNoYWRlci5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIEFzc2V0LnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy5mYWxsYmFjayA9IGpzb24uZmFsbGJhY2s7XG5cbiAgICB0aGlzLnZlcnRleCA9IGpzb24udmVydGV4O1xuICAgIHRoaXMuZnJhZ21lbnQgPSBqc29uLmZyYWdtZW50O1xuXG4gICAgdGhpcy5saWdodHMgPSBqc29uLmxpZ2h0cztcbiAgICB0aGlzLnNwZWN1bGFyID0ganNvbi5zcGVjdWxhcjtcbiAgICB0aGlzLnZlcnRleExpdCA9IGpzb24udmVydGV4TGl0O1xuICAgIHRoaXMuc2hhZG93cyA9IGpzb24uc2hhZG93cztcbiAgICB0aGlzLmZvZyA9IGpzb24uZm9nO1xuXG4gICAgdGhpcy5PRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMgPSBqc29uLk9FU19zdGFuZGFyZF9kZXJpdmF0aXZlcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFNoYWRlcjtcbiIsInZhciBVbmxpdCA9IHJlcXVpcmUoXCIuL25vcm1hbC91bmxpdFwiKTtcbnZhciBWZXJ0ZXhMaXQgPSByZXF1aXJlKFwiLi9ub3JtYWwvc3BlY3VsYXJcIik7XG52YXIgRGlmZnVzZSA9IHJlcXVpcmUoXCIuL25vcm1hbC9kaWZmdXNlXCIpO1xudmFyIFNwZWN1bGFyID0gcmVxdWlyZShcIi4vbm9ybWFsL3NwZWN1bGFyXCIpO1xudmFyIE5vcm1hbERpZmZ1c2UgPSByZXF1aXJlKFwiLi9ub3JtYWwvbm9ybWFsX2RpZmZ1c2VcIik7XG52YXIgTm9ybWFsU3BlY3VsYXIgPSByZXF1aXJlKFwiLi9ub3JtYWwvbm9ybWFsX3NwZWN1bGFyXCIpO1xudmFyIFBhcmFsbGF4RGlmZnVzZSA9IHJlcXVpcmUoXCIuL25vcm1hbC9wYXJhbGxheF9kaWZmdXNlXCIpO1xudmFyIFBhcnRpY2xlVW5saXQgPSByZXF1aXJlKFwiLi9wYXJ0aWNsZS91bmxpdFwiKTtcbnZhciBSZWZsZWN0aXZlVmVydGV4TGl0ID0gcmVxdWlyZShcIi4vcmVmbGVjdGl2ZS9yZWZsZWN0aXZlX3ZlcnRleF9saXRcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBVbmxpdDogVW5saXQsXG4gICAgVmVydGV4TGl0OiBWZXJ0ZXhMaXQsXG4gICAgRGlmZnVzZTogRGlmZnVzZSxcbiAgICBTcGVjdWxhcjogU3BlY3VsYXIsXG4gICAgTm9ybWFsRGlmZnVzZTogTm9ybWFsRGlmZnVzZSxcbiAgICBOb3JtYWxTcGVjdWxhcjogTm9ybWFsU3BlY3VsYXIsXG4gICAgUGFyYWxsYXhEaWZmdXNlOiBQYXJhbGxheERpZmZ1c2UsXG5cbiAgICBQYXJ0aWNsZVVubGl0OiBQYXJ0aWNsZVVubGl0LFxuXG4gICAgUmVmbGVjdGl2ZVZlcnRleExpdDogUmVmbGVjdGl2ZVZlcnRleExpdFxufTtcbiIsInZhciBBc3NldCA9IHJlcXVpcmUoXCIuL2Fzc2V0XCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gU3ByaXRlU2hlZXQob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBBc3NldC5jYWxsKHRoaXMsIG9wdHMpO1xufVxuXG5Bc3NldC5leHRlbmQoU3ByaXRlU2hlZXQpO1xuXG5cblNwcml0ZVNoZWV0LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgQXNzZXQucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLCBvdGhlcik7XG4gICAgdmFyIHJhdyA9IG90aGVyLnJhdyxcbiAgICAgICAga2V5O1xuXG4gICAgZm9yIChrZXkgaW4gcmF3KSB0aGlzW2tleV0gPSByYXdba2V5XTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5TcHJpdGVTaGVldC5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAocmF3KSB7XG4gICAgQXNzZXQucHJvdG90eXBlLnBhcnNlLmNhbGwodGhpcywgcmF3KTtcblxuICAgIGZvciAodmFyIGtleSBpbiByYXcpIHtcbiAgICAgICAgaWYgKCF0aGlzW2tleV0pIHtcbiAgICAgICAgICAgIHRoaXNba2V5XSA9IHJhd1trZXldO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgTG9nLmVycm9yKFwiU3ByaXRlU2hlZXQucGFyc2U6IGludmFsaWQgYW5pbWF0aW9uIG5hbWUgXCIgKyBrZXkgKyBcIiBpbiBmaWxlIFwiICsgdGhpcy5zcmMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblNwcml0ZVNoZWV0LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5yYXcpIHRoaXNba2V5XSA9IG51bGw7XG4gICAgQXNzZXQucHJvdG90eXBlLmNsZWFyLmNhbGwodGhpcyk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuU3ByaXRlU2hlZXQucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uLCBwYWNrKSB7XG4gICAganNvbiA9IEFzc2V0LnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIGlmICgocGFjayB8fCAhdGhpcy5zcmMpICYmIHRoaXMucmF3KSBqc29uLnJhdyA9IEpTT04uc3RyaW5naWZ5KHRoaXMucmF3KTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5TcHJpdGVTaGVldC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIEFzc2V0LnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgaWYgKCFqc29uLnNyYyAmJiBqc29uLnJhdykgdGhpcy5yYXcgPSBKU09OLnBhcnNlKGpzb24ucmF3KTtcbiAgICB0aGlzLnBhcnNlKHRoaXMucmF3KTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFNwcml0ZVNoZWV0O1xuIiwidmFyIEVudW1zID0gcmVxdWlyZShcIi4uL2VudW1zXCIpO1xudmFyIEFzc2V0ID0gcmVxdWlyZShcIi4vYXNzZXRcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBUZXh0dXJlKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQXNzZXQuY2FsbCh0aGlzLCBvcHRzKTtcblxuICAgIHRoaXMud2lkdGggPSAwO1xuICAgIHRoaXMuaGVpZ2h0ID0gMDtcblxuICAgIHRoaXMuaW52V2lkdGggPSAwO1xuICAgIHRoaXMuaW52SGVpZ2h0ID0gMDtcblxuICAgIHRoaXMuZ2VuZXJhdGVNaXBtYXAgPSBvcHRzLmdlbmVyYXRlTWlwbWFwICE9IHVuZGVmaW5lZCA/ICEhb3B0cy5nZW5lcmF0ZU1pcG1hcCA6IHRydWU7XG4gICAgdGhpcy5mbGlwWSA9IG9wdHMuZmxpcFkgIT0gdW5kZWZpbmVkID8gISFvcHRzLmZsaXBZIDogdHJ1ZTtcbiAgICB0aGlzLnByZW11bHRpcGx5QWxwaGEgPSBvcHRzLnByZW11bHRpcGx5QWxwaGEgIT0gdW5kZWZpbmVkID8gISFvcHRzLnByZW11bHRpcGx5QWxwaGEgOiBmYWxzZTtcblxuICAgIHRoaXMuYW5pc290cm9weSA9IG9wdHMuYW5pc290cm9weSAhPSB1bmRlZmluZWQgPyBvcHRzLmFuaXNvdHJvcHkgOiAxO1xuXG4gICAgdGhpcy5maWx0ZXIgPSBvcHRzLmZpbHRlciAhPSB1bmRlZmluZWQgPyBvcHRzLmZpbHRlciA6IEVudW1zLkZpbHRlck1vZGUuTGluZWFyO1xuICAgIHRoaXMuZm9ybWF0ID0gb3B0cy5mb3JtYXQgIT0gdW5kZWZpbmVkID8gb3B0cy5mb3JtYXQgOiBFbnVtcy5UZXh0dXJlRm9ybWF0LlJHQkE7XG4gICAgdGhpcy53cmFwID0gb3B0cy53cmFwICE9IHVuZGVmaW5lZCA/IG9wdHMud3JhcCA6IEVudW1zLlRleHR1cmVXcmFwLlJlcGVhdDtcblxuICAgIHRoaXMuX3dlYmdsID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3dlYmdsVXNlZCA9IDA7XG5cbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn1cblxuQXNzZXQuZXh0ZW5kKFRleHR1cmUpO1xuXG5cblRleHR1cmUucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICBBc3NldC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsIG90aGVyKTtcblxuICAgIHRoaXMud2lkdGggPSBvdGhlci53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IG90aGVyLmhlaWdodDtcblxuICAgIHRoaXMuaW52V2lkdGggPSBvdGhlci5pbnZXaWR0aDtcbiAgICB0aGlzLmludkhlaWdodCA9IG90aGVyLmludkhlaWdodDtcblxuICAgIHRoaXMuZ2VuZXJhdGVNaXBtYXAgPSBvdGhlci5nZW5lcmF0ZU1pcG1hcDtcbiAgICB0aGlzLmZsaXBZID0gb3RoZXIuZmxpcFk7XG4gICAgdGhpcy5wcmVtdWx0aXBseUFscGhhID0gb3RoZXIucHJlbXVsdGlwbHlBbHBoYTtcblxuICAgIHRoaXMuYW5pc290cm9weSA9IG90aGVyLmFuaXNvdHJvcHk7XG5cbiAgICB0aGlzLmZpbHRlciA9IG90aGVyLmZpbHRlcjtcbiAgICB0aGlzLmZvcm1hdCA9IG90aGVyLmZvcm1hdDtcbiAgICB0aGlzLndyYXAgPSBvdGhlci53cmFwO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblRleHR1cmUucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHJhdykge1xuICAgIEFzc2V0LnByb3RvdHlwZS5wYXJzZS5jYWxsKHRoaXMsIHJhdyk7XG5cbiAgICB0aGlzLndpZHRoID0gcmF3LndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gcmF3LmhlaWdodDtcblxuICAgIHRoaXMuaW52V2lkdGggPSAxIC8gdGhpcy53aWR0aDtcbiAgICB0aGlzLmludkhlaWdodCA9IDEgLyB0aGlzLmhlaWdodDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5UZXh0dXJlLnByb3RvdHlwZS5zZXRNaXBtYXAgPSBmdW5jdGlvbiAodmFsdWUpIHtcblxuICAgIHRoaXMuZ2VuZXJhdGVNaXBtYXAgPSB2YWx1ZSAhPSB1bmRlZmluZWQgPyAhIXZhbHVlIDogIXRoaXMuZ2VuZXJhdGVNaXBtYXA7XG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG59O1xuXG5cblRleHR1cmUucHJvdG90eXBlLnNldEFuaXNvdHJvcHkgPSBmdW5jdGlvbiAodmFsdWUpIHtcblxuICAgIHRoaXMuYW5pc290cm9weSA9IHZhbHVlO1xuICAgIHRoaXMubmVlZHNVcGRhdGUgPSB0cnVlO1xufTtcblxuXG5UZXh0dXJlLnByb3RvdHlwZS5zZXRGaWx0ZXIgPSBmdW5jdGlvbiAodmFsdWUpIHtcblxuICAgIHRoaXMuZmlsdGVyID0gdmFsdWU7XG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG59O1xuXG5cblRleHR1cmUucHJvdG90eXBlLnNldEZvcm1hdCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXG4gICAgdGhpcy5mb3JtYXQgPSB2YWx1ZTtcbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxuVGV4dHVyZS5wcm90b3R5cGUuc2V0V3JhcCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXG4gICAgdGhpcy53cmFwID0gdmFsdWU7XG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG59O1xuXG5cblRleHR1cmUucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uLCBwYWNrKSB7XG4gICAganNvbiA9IEFzc2V0LnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIGlmICgocGFjayB8fCAhdGhpcy5zcmMpICYmIHRoaXMucmF3KSB7XG4gICAgICAgIGlmICh0eXBlb2Yod2luZG93KSA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAganNvbi5yYXcgPSB0aGlzLnJhdztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciByYXcgPSB0aGlzLnJhdyxcbiAgICAgICAgICAgICAgICBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLFxuICAgICAgICAgICAgICAgIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5cbiAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IHJhdy53aWR0aDtcbiAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSByYXcuaGVpZ2h0O1xuICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShyYXcsIDAsIDApO1xuXG4gICAgICAgICAgICBqc29uLnJhdyA9IGNhbnZhcy50b0RhdGFVUkwoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGpzb24ud2lkdGggPSB0aGlzLndpZHRoO1xuICAgIGpzb24uaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XG5cbiAgICBqc29uLmludldpZHRoID0gdGhpcy5pbnZXaWR0aDtcbiAgICBqc29uLmludkhlaWdodCA9IHRoaXMuaW52SGVpZ2h0O1xuXG4gICAganNvbi5nZW5lcmF0ZU1pcG1hcCA9IHRoaXMuZ2VuZXJhdGVNaXBtYXA7XG4gICAganNvbi5mbGlwWSA9IHRoaXMuZmxpcFk7XG4gICAganNvbi5wcmVtdWx0aXBseUFscGhhID0gdGhpcy5wcmVtdWx0aXBseUFscGhhO1xuXG4gICAganNvbi5hbmlzb3Ryb3B5ID0gdGhpcy5hbmlzb3Ryb3B5O1xuXG4gICAganNvbi5maWx0ZXIgPSB0aGlzLmZpbHRlcjtcbiAgICBqc29uLmZvcm1hdCA9IHRoaXMuZm9ybWF0O1xuICAgIGpzb24ud3JhcCA9IHRoaXMud3JhcDtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5UZXh0dXJlLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgQXNzZXQucHJvdG90eXBlLmZyb21KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICBpZiAoIWpzb24uc3JjICYmIGpzb24ucmF3KSB7XG4gICAgICAgIGlmICh0eXBlb2Yod2luZG93KSA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgdGhpcy5yYXcgPSBqc29uLnJhdztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZTtcbiAgICAgICAgICAgIGltYWdlLnNyYyA9IGpzb24ucmF3O1xuICAgICAgICAgICAgdGhpcy5yYXcgPSBpbWFnZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMud2lkdGggPSBqc29uLndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0ganNvbi5oZWlnaHQ7XG5cbiAgICB0aGlzLmludldpZHRoID0ganNvbi5pbnZXaWR0aDtcbiAgICB0aGlzLmludkhlaWdodCA9IGpzb24uaW52SGVpZ2h0O1xuXG4gICAgdGhpcy5nZW5lcmF0ZU1pcG1hcCA9IGpzb24uZ2VuZXJhdGVNaXBtYXA7XG4gICAgdGhpcy5mbGlwWSA9IGpzb24uZmxpcFk7XG4gICAgdGhpcy5wcmVtdWx0aXBseUFscGhhID0ganNvbi5wcmVtdWx0aXBseUFscGhhO1xuXG4gICAgdGhpcy5hbmlzb3Ryb3B5ID0ganNvbi5hbmlzb3Ryb3B5O1xuXG4gICAgdGhpcy5maWx0ZXIgPSBqc29uLmZpbHRlcjtcbiAgICB0aGlzLmZvcm1hdCA9IGpzb24uZm9ybWF0O1xuICAgIHRoaXMud3JhcCA9IGpzb24ud3JhcDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFRleHR1cmU7XG4iLCJ2YXIgRW51bXMgPSByZXF1aXJlKFwiLi4vZW51bXNcIik7XG52YXIgQXNzZXQgPSByZXF1aXJlKFwiLi9hc3NldFwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIFRleHR1cmVDdWJlKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQXNzZXQuY2FsbCh0aGlzLCBvcHRzKTtcblxuICAgIHRoaXMubWlwbWFwID0gb3B0cy5taXBtYXAgIT0gdW5kZWZpbmVkID8gISFvcHRzLm1pcG1hcCA6IHRydWU7XG4gICAgdGhpcy5mbGlwWSA9IG9wdHMuZmxpcFkgIT0gdW5kZWZpbmVkID8gISFvcHRzLmZsaXBZIDogdHJ1ZTtcbiAgICB0aGlzLnByZW11bHRpcGx5QWxwaGEgPSBvcHRzLnByZW11bHRpcGx5QWxwaGEgIT0gdW5kZWZpbmVkID8gISFvcHRzLnByZW11bHRpcGx5QWxwaGEgOiBmYWxzZTtcblxuICAgIHRoaXMuYW5pc290cm9weSA9IG9wdHMuYW5pc290cm9weSAhPSB1bmRlZmluZWQgPyBvcHRzLmFuaXNvdHJvcHkgOiAxO1xuXG4gICAgdGhpcy5maWx0ZXIgPSBvcHRzLmZpbHRlciAhPSB1bmRlZmluZWQgPyBvcHRzLmZpbHRlciA6IEVudW1zLkZpbHRlck1vZGUuTGluZWFyO1xuICAgIHRoaXMuZm9ybWF0ID0gb3B0cy5mb3JtYXQgIT0gdW5kZWZpbmVkID8gb3B0cy5mb3JtYXQgOiBFbnVtcy5UZXh0dXJlRm9ybWF0LlJHQkE7XG4gICAgdGhpcy53cmFwID0gb3B0cy53cmFwICE9IHVuZGVmaW5lZCA/IG9wdHMud3JhcCA6IEVudW1zLlRleHR1cmVXcmFwLlJlcGVhdDtcblxuICAgIHRoaXMuX3dlYmdsID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3dlYmdsVXNlZCA9IDA7XG5cbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn1cblxuQXNzZXQuZXh0ZW5kKFRleHR1cmVDdWJlKTtcblxuXG5UZXh0dXJlQ3ViZS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIEFzc2V0LnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcywgb3RoZXIpO1xuXG4gICAgdGhpcy5taXBtYXAgPSBvdGhlci5taXBtYXA7XG4gICAgdGhpcy5mbGlwWSA9IG90aGVyLmZsaXBZO1xuICAgIHRoaXMucHJlbXVsdGlwbHlBbHBoYSA9IG90aGVyLnByZW11bHRpcGx5QWxwaGE7XG5cbiAgICB0aGlzLmFuaXNvdHJvcHkgPSBvdGhlci5hbmlzb3Ryb3B5O1xuXG4gICAgdGhpcy5maWx0ZXIgPSBvdGhlci5maWx0ZXI7XG4gICAgdGhpcy5mb3JtYXQgPSBvdGhlci5mb3JtYXQ7XG4gICAgdGhpcy53cmFwID0gb3RoZXIud3JhcDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5UZXh0dXJlQ3ViZS5wcm90b3R5cGUuc2V0TWlwbWFwID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cbiAgICB0aGlzLm1pcG1hcCA9IHZhbHVlICE9IHVuZGVmaW5lZCA/ICEhdmFsdWUgOiAhdGhpcy5taXBtYXA7XG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG59O1xuXG5cblRleHR1cmVDdWJlLnByb3RvdHlwZS5zZXRBbmlzb3Ryb3B5ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cbiAgICB0aGlzLmFuaXNvdHJvcHkgPSB2YWx1ZTtcbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxuVGV4dHVyZUN1YmUucHJvdG90eXBlLnNldEZpbHRlciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXG4gICAgdGhpcy5maWx0ZXIgPSB2YWx1ZTtcbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxuVGV4dHVyZUN1YmUucHJvdG90eXBlLnNldEZvcm1hdCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXG4gICAgdGhpcy5mb3JtYXQgPSB2YWx1ZTtcbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxuVGV4dHVyZUN1YmUucHJvdG90eXBlLnNldFdyYXAgPSBmdW5jdGlvbiAodmFsdWUpIHtcblxuICAgIHRoaXMud3JhcCA9IHZhbHVlO1xuICAgIHRoaXMubmVlZHNVcGRhdGUgPSB0cnVlO1xufTtcblxuXG5UZXh0dXJlQ3ViZS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24sIHBhY2spIHtcbiAgICBqc29uID0gQXNzZXQucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgaWYgKChwYWNrIHx8ICF0aGlzLnNyYykgJiYgdGhpcy5yYXcpIHtcbiAgICAgICAgaWYgKHR5cGVvZih3aW5kb3cpID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBqc29uLnJhdyA9IHRoaXMucmF3O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGpzb25SYXcgPSBqc29uLnJhdyB8fCAoanNvbi5yYXcgPSBbXSksXG4gICAgICAgICAgICAgICAgcmF3ID0gdGhpcy5yYXcsXG4gICAgICAgICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgICAgICAgaWwgPSByYXcubGVuZ3RoO1xuXG4gICAgICAgICAgICBmb3IgKDsgaSA8IGlsOyBpKyspIGpzb25SYXdbaV0gPSBpbWFnZVRvRGF0YVVybChyYXdbaV0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAganNvbi53aWR0aCA9IHRoaXMud2lkdGg7XG4gICAganNvbi5oZWlnaHQgPSB0aGlzLmhlaWdodDtcblxuICAgIGpzb24uaW52V2lkdGggPSB0aGlzLmludldpZHRoO1xuICAgIGpzb24uaW52SGVpZ2h0ID0gdGhpcy5pbnZIZWlnaHQ7XG5cbiAgICBqc29uLm1pcG1hcCA9IHRoaXMubWlwbWFwO1xuICAgIGpzb24uZmxpcFkgPSB0aGlzLmZsaXBZO1xuICAgIGpzb24ucHJlbXVsdGlwbHlBbHBoYSA9IHRoaXMucHJlbXVsdGlwbHlBbHBoYTtcblxuICAgIGpzb24uYW5pc290cm9weSA9IHRoaXMuYW5pc290cm9weTtcblxuICAgIGpzb24uZmlsdGVyID0gdGhpcy5maWx0ZXI7XG4gICAganNvbi5mb3JtYXQgPSB0aGlzLmZvcm1hdDtcbiAgICBqc29uLndyYXAgPSB0aGlzLndyYXA7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuVGV4dHVyZUN1YmUucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBBc3NldC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIGlmICghanNvbi5zcmMgJiYganNvbi5yYXcpIHtcbiAgICAgICAgaWYgKHR5cGVvZih3aW5kb3cpID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB0aGlzLnJhdyA9IGpzb24ucmF3O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGpzb25SYXcgPSBqc29uLnJhdyxcbiAgICAgICAgICAgICAgICByYXcgPSB0aGlzLnJhdyxcbiAgICAgICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgICAgICBpbCA9IGpzb25SYXcubGVuZ3RoO1xuXG4gICAgICAgICAgICBmb3IgKDsgaSA8IGlsOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2U7XG4gICAgICAgICAgICAgICAgaW1hZ2Uuc3JjID0gc29uUmF3W2ldO1xuICAgICAgICAgICAgICAgIHJhd1tpXSA9IGltYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy53aWR0aCA9IGpzb24ud2lkdGg7XG4gICAgdGhpcy5oZWlnaHQgPSBqc29uLmhlaWdodDtcblxuICAgIHRoaXMuaW52V2lkdGggPSBqc29uLmludldpZHRoO1xuICAgIHRoaXMuaW52SGVpZ2h0ID0ganNvbi5pbnZIZWlnaHQ7XG5cbiAgICB0aGlzLm1pcG1hcCA9IGpzb24ubWlwbWFwO1xuICAgIHRoaXMuZmxpcFkgPSBqc29uLmZsaXBZO1xuICAgIHRoaXMucHJlbXVsdGlwbHlBbHBoYSA9IGpzb24ucHJlbXVsdGlwbHlBbHBoYTtcblxuICAgIHRoaXMuYW5pc290cm9weSA9IGpzb24uYW5pc290cm9weTtcblxuICAgIHRoaXMuZmlsdGVyID0ganNvbi5maWx0ZXI7XG4gICAgdGhpcy5mb3JtYXQgPSBqc29uLmZvcm1hdDtcbiAgICB0aGlzLndyYXAgPSBqc29uLndyYXA7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuZnVuY3Rpb24gaW1hZ2VUb0RhdGFVcmwoaW1hZ2UpIHtcbiAgICBpZiAodHlwZW9mKHdpbmRvdykgPT09IFwidW5kZWZpbmVkXCIpIHJldHVybiBpbWFnZTtcbiAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxcbiAgICAgICAgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblxuICAgIGNhbnZhcy53aWR0aCA9IGltYWdlLndpZHRoO1xuICAgIGNhbnZhcy5oZWlnaHQgPSBpbWFnZS5oZWlnaHQ7XG4gICAgY3R4LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7XG5cbiAgICByZXR1cm4gY2FudmFzLnRvRGF0YVVSTCgpO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFRleHR1cmVDdWJlO1xuIiwidmFyIENvbXBvbmVudE1hbmFnZXIgPSByZXF1aXJlKFwiLi9jb21wb25lbnRfbWFuYWdlclwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIEJvbmVDb21wb25lbnRNYW5hZ2VyKCkge1xuXG4gICAgQ29tcG9uZW50TWFuYWdlci5jYWxsKHRoaXMsIDEwMDAwMDApO1xufVxuXG5Db21wb25lbnRNYW5hZ2VyLmV4dGVuZChCb25lQ29tcG9uZW50TWFuYWdlcik7XG5cblxuQm9uZUNvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLnNvcnRGdW5jdGlvbiA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cbiAgICByZXR1cm4gYS5wYXJlbnRJbmRleCAtIGIucGFyZW50SW5kZXg7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gQm9uZUNvbXBvbmVudE1hbmFnZXI7XG4iLCJ2YXIgQ29tcG9uZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL2NvbXBvbmVudF9tYW5hZ2VyXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gQ2FtZXJhMkRDb21wb25lbnRNYW5hZ2VyKCkge1xuXG4gICAgQ29tcG9uZW50TWFuYWdlci5jYWxsKHRoaXMpO1xufVxuXG5Db21wb25lbnRNYW5hZ2VyLmV4dGVuZChDYW1lcmEyRENvbXBvbmVudE1hbmFnZXIpO1xuXG5cbkNhbWVyYTJEQ29tcG9uZW50TWFuYWdlci5wcm90b3R5cGUuc29ydEZ1bmN0aW9uID0gZnVuY3Rpb24gKGEsIGIpIHtcblxuICAgIHJldHVybiBhLl9hY3RpdmUgPyAxIDogYi5fYWN0aXZlID8gLTEgOiAwO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IENhbWVyYTJEQ29tcG9uZW50TWFuYWdlcjtcbiIsInZhciBDb21wb25lbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vY29tcG9uZW50X21hbmFnZXJcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBDYW1lcmFDb21wb25lbnRNYW5hZ2VyKCkge1xuXG4gICAgQ29tcG9uZW50TWFuYWdlci5jYWxsKHRoaXMpO1xufVxuXG5Db21wb25lbnRNYW5hZ2VyLmV4dGVuZChDYW1lcmFDb21wb25lbnRNYW5hZ2VyKTtcblxuXG5DYW1lcmFDb21wb25lbnRNYW5hZ2VyLnByb3RvdHlwZS5zb3J0RnVuY3Rpb24gPSBmdW5jdGlvbiAoYSwgYikge1xuXG4gICAgcmV0dXJuIGEuX2FjdGl2ZSA/IDEgOiBiLl9hY3RpdmUgPyAtMSA6IDA7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gQ2FtZXJhQ29tcG9uZW50TWFuYWdlcjtcbiIsInZhciBDbGFzcyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2NsYXNzXCIpO1xudmFyIENvbXBvbmVudCA9IHJlcXVpcmUoXCIuLi9jb21wb25lbnRzL2NvbXBvbmVudFwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIENvbXBvbmVudE1hbmFnZXIob3JkZXIpIHtcblxuICAgIENsYXNzLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLm9yZGVyID0gb3JkZXIgfHwgMDtcblxuICAgIHRoaXMuc2NlbmUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5jb21wb25lbnRzID0gW107XG59XG5cbkNsYXNzLmV4dGVuZChDb21wb25lbnRNYW5hZ2VyKTtcblxuXG5Db21wb25lbnRNYW5hZ2VyLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGZuLCBjdHgpIHtcbiAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cyxcbiAgICAgICAgaSA9IDAsXG4gICAgICAgIGlsID0gY29tcG9uZW50cy5sZW5ndGg7XG5cbiAgICBpZiAoY3R4KSB7XG4gICAgICAgIGZvciAoOyBpIDwgaWw7IGkrKykgZm4uY2FsbChjdHgsIGNvbXBvbmVudHNbaV0sIGksIGNvbXBvbmVudHMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAoOyBpIDwgaWw7IGkrKykgZm4oY29tcG9uZW50c1tpXSwgaSwgY29tcG9uZW50cyk7XG4gICAgfVxufTtcblxuXG5Db21wb25lbnRNYW5hZ2VyLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cyxcbiAgICAgICAgaSwgaWw7XG5cbiAgICBmb3IgKGkgPSAwLCBpbCA9IGNvbXBvbmVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgY29tcG9uZW50c1tpXS5zdGFydCgpO1xuICAgIGZvciAoaSA9IDAsIGlsID0gY29tcG9uZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBjb21wb25lbnRzW2ldLmVtaXQoXCJzdGFydFwiKTtcbn07XG5cblxuQ29tcG9uZW50TWFuYWdlci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cyxcbiAgICAgICAgaSwgaWw7XG5cbiAgICBmb3IgKGkgPSAwLCBpbCA9IGNvbXBvbmVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgY29tcG9uZW50c1tpXS5pbml0KCk7XG4gICAgZm9yIChpID0gMCwgaWwgPSBjb21wb25lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIGNvbXBvbmVudHNbaV0uZW1pdChcImluaXRcIik7XG59O1xuXG5cbkNvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cyxcbiAgICAgICAgaSA9IDAsXG4gICAgICAgIGlsID0gY29tcG9uZW50cy5sZW5ndGgsXG4gICAgICAgIGNvbXBvbmVudDtcblxuICAgIGZvciAoOyBpIDwgaWw7IGkrKylcbiAgICAgICAgaWYgKChjb21wb25lbnQgPSBjb21wb25lbnRzW2ldKSkgY29tcG9uZW50LnVwZGF0ZSgpO1xufTtcblxuXG5Db21wb25lbnRNYW5hZ2VyLnByb3RvdHlwZS5zb3J0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5jb21wb25lbnRzLnNvcnQodGhpcy5zb3J0RnVuY3Rpb24pO1xufTtcblxuXG5Db21wb25lbnRNYW5hZ2VyLnByb3RvdHlwZS5zb3J0RnVuY3Rpb24gPSBmdW5jdGlvbiAoYSwgYikge1xuXG4gICAgcmV0dXJuIGEuX2lkIC0gYi5faWQ7XG59O1xuXG5cbkNvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLmVtcHR5ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIHRoaXMuY29tcG9uZW50cy5sZW5ndGggPT09IDA7XG59O1xuXG5cbkNvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChjb21wb25lbnQpIHtcbiAgICBpZiAoIShjb21wb25lbnQgaW5zdGFuY2VvZiBDb21wb25lbnQpKSB7XG4gICAgICAgIExvZy5lcnJvcih0aGlzLl9jbGFzc05hbWUgKyBcIi5hZGQ6IGNhbid0IGFkZCBhcmd1bWVudCB0byBcIiArIHRoaXMuX2NsYXNzTmFtZSArIFwiLCBpdCdzIG5vdCBhbiBpbnN0YW5jZSBvZiBDb21wb25lbnRcIik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGNvbXBvbmVudHMgPSB0aGlzLmNvbXBvbmVudHMsXG4gICAgICAgIGluZGV4ID0gY29tcG9uZW50cy5pbmRleE9mKGNvbXBvbmVudCk7XG5cbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIGNvbXBvbmVudHMucHVzaChjb21wb25lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcih0aGlzLl9jbGFzc05hbWUgKyBcIi5hZGQ6IENvbXBvbmVudCBpcyBhbHJlYWR5IGEgbWVtYmVyIG9mIFwiICsgdGhpcy5fY2xhc3NOYW1lKTtcbiAgICB9XG59O1xuXG5cbkNvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChjb21wb25lbnQpIHtcbiAgICBpZiAoIShjb21wb25lbnQgaW5zdGFuY2VvZiBDb21wb25lbnQpKSB7XG4gICAgICAgIExvZy5lcnJvcih0aGlzLl9jbGFzc05hbWUgKyBcIi5yZW1vdmU6IGNhbid0IHJlbW92ZSBhcmd1bWVudCBmcm9tIFwiICsgdGhpcy5fY2xhc3NOYW1lICsgXCIsIGl0J3Mgbm90IGFuIGluc3RhbmNlIG9mIENvbXBvbmVudFwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cyxcbiAgICAgICAgaW5kZXggPSBjb21wb25lbnRzLmluZGV4T2YoY29tcG9uZW50KTtcblxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgY29tcG9uZW50cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcih0aGlzLl9jbGFzc05hbWUgKyBcIi5yZW1vdmU6IENvbXBvbmVudCBpcyBub3QgYSBtZW1iZXIgb2YgXCIgKyB0aGlzLl9jbGFzc05hbWUpO1xuICAgIH1cbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBDb21wb25lbnRNYW5hZ2VyO1xuIiwidmFyIENvbXBvbmVudE1hbmFnZXIgPSByZXF1aXJlKFwiLi9jb21wb25lbnRfbWFuYWdlclwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIExpZ2h0Q29tcG9uZW50TWFuYWdlcigpIHtcblxuICAgIENvbXBvbmVudE1hbmFnZXIuY2FsbCh0aGlzKTtcbn1cblxuQ29tcG9uZW50TWFuYWdlci5leHRlbmQoTGlnaHRDb21wb25lbnRNYW5hZ2VyKTtcblxuXG5MaWdodENvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLnNvcnRGdW5jdGlvbiA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cbiAgICByZXR1cm4gYS50eXBlIC0gYi50eXBlO1xufTtcblxuXG5MaWdodENvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcblxufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IExpZ2h0Q29tcG9uZW50TWFuYWdlcjtcbiIsInZhciBDb21wb25lbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vY29tcG9uZW50X21hbmFnZXJcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBNZXNoQW5pbWF0aW9uQ29tcG9uZW50TWFuYWdlcigpIHtcblxuICAgIENvbXBvbmVudE1hbmFnZXIuY2FsbCh0aGlzLCAtOTk5OTk5KTtcbn1cblxuQ29tcG9uZW50TWFuYWdlci5leHRlbmQoTWVzaEFuaW1hdGlvbkNvbXBvbmVudE1hbmFnZXIpO1xuXG5cbm1vZHVsZS5leHBvcnRzID0gTWVzaEFuaW1hdGlvbkNvbXBvbmVudE1hbmFnZXI7XG4iLCJ2YXIgQ29tcG9uZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL2NvbXBvbmVudF9tYW5hZ2VyXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gTWVzaEZpbHRlckNvbXBvbmVudE1hbmFnZXIoKSB7XG5cbiAgICBDb21wb25lbnRNYW5hZ2VyLmNhbGwodGhpcyk7XG59XG5cbkNvbXBvbmVudE1hbmFnZXIuZXh0ZW5kKE1lc2hGaWx0ZXJDb21wb25lbnRNYW5hZ2VyKTtcblxuXG5NZXNoRmlsdGVyQ29tcG9uZW50TWFuYWdlci5wcm90b3R5cGUuc29ydEZ1bmN0aW9uID0gZnVuY3Rpb24gKGEsIGIpIHtcblxuICAgIHJldHVybiBhLm1lc2ggPT09IGIubWVzaCA/IDEgOiAtMTtcbn07XG5cblxuTWVzaEZpbHRlckNvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcblxufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IE1lc2hGaWx0ZXJDb21wb25lbnRNYW5hZ2VyO1xuIiwidmFyIENsYXNzID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvY2xhc3NcIik7XG52YXIgTWF0aGYgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9tYXRoZlwiKTtcbnZhciBDb21wb25lbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vY29tcG9uZW50X21hbmFnZXJcIik7XG52YXIgU3ByaXRlID0gcmVxdWlyZShcIi4uL2NvbXBvbmVudHMvc3ByaXRlXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGNsYW1wID0gTWF0aGYuY2xhbXA7XG5cblxuZnVuY3Rpb24gU3ByaXRlQ29tcG9uZW50TWFuYWdlcigpIHtcblxuICAgIENsYXNzLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLm9yZGVyID0gMDtcblxuICAgIHRoaXMuc2NlbmUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5sYXllcnMgPSBbXTtcbn1cblxuQ29tcG9uZW50TWFuYWdlci5leHRlbmQoU3ByaXRlQ29tcG9uZW50TWFuYWdlcik7XG5cblxuU3ByaXRlQ29tcG9uZW50TWFuYWdlci5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChmbiwgY3R4KSB7XG4gICAgdmFyIGxheWVycyA9IHRoaXMubGF5ZXJzLFxuICAgICAgICBjb21wb25lbnRzLCBpLCBpbCwgaiwgamw7XG5cbiAgICBpZiAoY3R4KSB7XG4gICAgICAgIGZvciAoaSA9IDAsIGlsID0gbGF5ZXJzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHtcbiAgICAgICAgICAgIGNvbXBvbmVudHMgPSBsYXllcnNbaV07XG4gICAgICAgICAgICBpZiAoIWNvbXBvbmVudHMpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yIChqID0gMCwgamwgPSBjb21wb25lbnRzLmxlbmd0aDsgaiA8IGpsOyBqKyspIGZuLmNhbGwoY3R4LCBjb21wb25lbnRzW2pdLCBqLCBjb21wb25lbnRzKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAoaSA9IDAsIGlsID0gbGF5ZXJzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHtcbiAgICAgICAgICAgIGNvbXBvbmVudHMgPSBsYXllcnNbaV07XG4gICAgICAgICAgICBpZiAoIWNvbXBvbmVudHMpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yIChqID0gMCwgamwgPSBjb21wb25lbnRzLmxlbmd0aDsgaiA8IGpsOyBqKyspIGZuKGNvbXBvbmVudHNbal0sIGosIGNvbXBvbmVudHMpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuXG5TcHJpdGVDb21wb25lbnRNYW5hZ2VyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBsYXllcnMgPSB0aGlzLmxheWVycyxcbiAgICAgICAgY29tcG9uZW50cywgaSwgaWwsIGosIGpsO1xuXG4gICAgZm9yIChpID0gMCwgaWwgPSBsYXllcnMubGVuZ3RoOyBpIDwgaWw7IGkrKykge1xuICAgICAgICBjb21wb25lbnRzID0gbGF5ZXJzW2ldO1xuICAgICAgICBpZiAoIWNvbXBvbmVudHMpIGNvbnRpbnVlO1xuXG4gICAgICAgIGZvciAoaiA9IDAsIGpsID0gY29tcG9uZW50cy5sZW5ndGg7IGogPCBqbDsgaisrKSBjb21wb25lbnRzW2pdLmluaXQoKTtcbiAgICAgICAgZm9yIChqID0gMCwgamwgPSBjb21wb25lbnRzLmxlbmd0aDsgaiA8IGpsOyBqKyspIGNvbXBvbmVudHNbal0uZW1pdChcImluaXRcIik7XG4gICAgfVxufTtcblxuXG5TcHJpdGVDb21wb25lbnRNYW5hZ2VyLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGF5ZXJzID0gdGhpcy5sYXllcnMsXG4gICAgICAgIGNvbXBvbmVudHMsIGksIGlsLCBqLCBqbDtcblxuICAgIGZvciAoaSA9IDAsIGlsID0gbGF5ZXJzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHtcbiAgICAgICAgY29tcG9uZW50cyA9IGxheWVyc1tpXTtcbiAgICAgICAgaWYgKCFjb21wb25lbnRzKSBjb250aW51ZTtcblxuICAgICAgICBmb3IgKGogPSAwLCBqbCA9IGNvbXBvbmVudHMubGVuZ3RoOyBqIDwgamw7IGorKykgY29tcG9uZW50c1tqXS5zdGFydCgpO1xuICAgICAgICBmb3IgKGogPSAwLCBqbCA9IGNvbXBvbmVudHMubGVuZ3RoOyBqIDwgamw7IGorKykgY29tcG9uZW50c1tqXS5lbWl0KFwic3RhcnRcIik7XG4gICAgfVxufTtcblxuXG5TcHJpdGVDb21wb25lbnRNYW5hZ2VyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG5cbn07XG5cblxuU3ByaXRlQ29tcG9uZW50TWFuYWdlci5wcm90b3R5cGUuc29ydCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGF5ZXJzID0gdGhpcy5sYXllcnMsXG4gICAgICAgIGNvbXBvbmVudHMsIGksIGlsO1xuXG4gICAgZm9yIChpID0gMCwgaWwgPSBsYXllcnMubGVuZ3RoOyBpIDwgaWw7IGkrKykge1xuICAgICAgICBjb21wb25lbnRzID0gbGF5ZXJzW2ldO1xuICAgICAgICBpZiAoIWNvbXBvbmVudHMpIGNvbnRpbnVlO1xuXG4gICAgICAgIGNvbXBvbmVudHMuc29ydCh0aGlzLnNvcnRGdW5jdGlvbik7XG4gICAgfVxufTtcblxuXG5TcHJpdGVDb21wb25lbnRNYW5hZ2VyLnByb3RvdHlwZS5zb3J0RnVuY3Rpb24gPSBmdW5jdGlvbiAoYSwgYikge1xuXG4gICAgcmV0dXJuIGEueiAtIGIuejtcbn07XG5cblxuU3ByaXRlQ29tcG9uZW50TWFuYWdlci5wcm90b3R5cGUuZW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxheWVycyA9IHRoaXMubGF5ZXJzLFxuICAgICAgICBjb21wb25lbnRzLCBpLCBpbCxcbiAgICAgICAgZW1wdHkgPSB0cnVlO1xuXG4gICAgZm9yIChpID0gMCwgaWwgPSBsYXllcnMubGVuZ3RoOyBpIDwgaWw7IGkrKykge1xuICAgICAgICBjb21wb25lbnRzID0gbGF5ZXJzW2ldO1xuICAgICAgICBpZiAoIWNvbXBvbmVudHMpIGNvbnRpbnVlO1xuXG4gICAgICAgIGlmIChjb21wb25lbnRzLmxlbmd0aCAhPT0gMCkgZW1wdHkgPSBmYWxzZVxuICAgIH1cblxuICAgIHJldHVybiBlbXB0eTtcbn07XG5cblxuU3ByaXRlQ29tcG9uZW50TWFuYWdlci5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGNvbXBvbmVudCkge1xuICAgIGlmICghKGNvbXBvbmVudCBpbnN0YW5jZW9mIFNwcml0ZSkpIHtcbiAgICAgICAgTG9nLmVycm9yKFwiU3ByaXRlQ29tcG9uZW50TWFuYWdlci5hZGQ6IGNhbid0IGFkZCBhcmd1bWVudCB0byBTcHJpdGVDb21wb25lbnRNYW5hZ2VyLCBpdCdzIG5vdCBhbiBpbnN0YW5jZSBvZiBTcHJpdGVcIik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGxheWVycyA9IHRoaXMubGF5ZXJzLFxuICAgICAgICBjb21wb25lbnRMYXllciA9IChjb21wb25lbnQubGF5ZXIgPSBjbGFtcChjb21wb25lbnQubGF5ZXIgfHwgMCwgMCwgMjApKSxcbiAgICAgICAgY29tcG9uZW50cyA9IGxheWVyc1tjb21wb25lbnRMYXllcl0gfHwgKGxheWVyc1tjb21wb25lbnRMYXllcl0gPSBbXSksXG4gICAgICAgIGluZGV4ID0gY29tcG9uZW50cy5pbmRleE9mKGNvbXBvbmVudCk7XG5cbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIGNvbXBvbmVudHMucHVzaChjb21wb25lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcih0aGlzLl9jbGFzc05hbWUgKyBcIi5hZGQ6IFNwcml0ZSBpcyBhbHJlYWR5IGEgbWVtYmVyIG9mIFNwcml0ZUNvbXBvbmVudE1hbmFnZXJcIik7XG4gICAgfVxufTtcblxuXG5TcHJpdGVDb21wb25lbnRNYW5hZ2VyLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoY29tcG9uZW50KSB7XG4gICAgaWYgKCEoY29tcG9uZW50IGluc3RhbmNlb2YgU3ByaXRlKSkge1xuICAgICAgICBMb2cuZXJyb3IoXCJTcHJpdGVDb21wb25lbnRNYW5hZ2VyLnJlbW92ZTogY2FuJ3QgcmVtb3ZlIGFyZ3VtZW50IGZyb20gU3ByaXRlQ29tcG9uZW50TWFuYWdlciwgaXQncyBub3QgYW4gaW5zdGFuY2Ugb2YgU3ByaXRlXCIpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBsYXllcnMgPSB0aGlzLmxheWVycyxcbiAgICAgICAgY29tcG9uZW50TGF5ZXIgPSAoY29tcG9uZW50LmxheWVyID0gY2xhbXAoY29tcG9uZW50LmxheWVyIHx8IDAsIDAsIDIwKSksXG4gICAgICAgIGNvbXBvbmVudHMgPSBsYXllcnNbY29tcG9uZW50TGF5ZXJdIHx8IChsYXllcnNbY29tcG9uZW50TGF5ZXJdID0gW10pLFxuICAgICAgICBpbmRleCA9IGNvbXBvbmVudHMuaW5kZXhPZihjb21wb25lbnQpO1xuXG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICBjb21wb25lbnRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgTG9nLmVycm9yKFwiU3ByaXRlQ29tcG9uZW50TWFuYWdlci5yZW1vdmU6IFNwcml0ZSBpcyBub3QgYSBtZW1iZXIgb2YgU3ByaXRlQ29tcG9uZW50TWFuYWdlclwiKTtcbiAgICB9XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gU3ByaXRlQ29tcG9uZW50TWFuYWdlcjtcbiIsInZhciBDb21wb25lbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vY29tcG9uZW50X21hbmFnZXJcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBUcmFuc2Zvcm0yRENvbXBvbmVudE1hbmFnZXIoKSB7XG5cbiAgICBDb21wb25lbnRNYW5hZ2VyLmNhbGwodGhpcywgOTk5OTk5KTtcbn1cblxuQ29tcG9uZW50TWFuYWdlci5leHRlbmQoVHJhbnNmb3JtMkRDb21wb25lbnRNYW5hZ2VyKTtcblxuXG5UcmFuc2Zvcm0yRENvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLnNvcnRGdW5jdGlvbiA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cbiAgICByZXR1cm4gYS5kZXB0aCAtIGIuZGVwdGg7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gVHJhbnNmb3JtMkRDb21wb25lbnRNYW5hZ2VyO1xuIiwidmFyIENvbXBvbmVudE1hbmFnZXIgPSByZXF1aXJlKFwiLi9jb21wb25lbnRfbWFuYWdlclwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIFRyYW5zZm9ybUNvbXBvbmVudE1hbmFnZXIoKSB7XG5cbiAgICBDb21wb25lbnRNYW5hZ2VyLmNhbGwodGhpcywgOTk5OTk5KTtcbn1cblxuQ29tcG9uZW50TWFuYWdlci5leHRlbmQoVHJhbnNmb3JtQ29tcG9uZW50TWFuYWdlcik7XG5cblxuVHJhbnNmb3JtQ29tcG9uZW50TWFuYWdlci5wcm90b3R5cGUuc29ydEZ1bmN0aW9uID0gZnVuY3Rpb24gKGEsIGIpIHtcblxuICAgIHJldHVybiBhLmRlcHRoIC0gYi5kZXB0aDtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBUcmFuc2Zvcm1Db21wb25lbnRNYW5hZ2VyO1xuIiwidmFyIEF1ZGlvQ3R4ID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvYXVkaW9fY3R4XCIpO1xudmFyIFRpbWUgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS90aW1lXCIpO1xudmFyIE1hdGhmID0gcmVxdWlyZShcIi4uLy4uL21hdGgvbWF0aGZcIik7XG52YXIgVmVjMiA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3ZlYzJcIik7XG52YXIgVmVjMyA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3ZlYzNcIik7XG52YXIgQXNzZXRzID0gcmVxdWlyZShcIi4uL2Fzc2V0cy9hc3NldHNcIik7XG52YXIgQ29tcG9uZW50ID0gcmVxdWlyZShcIi4vY29tcG9uZW50XCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIG5vdyA9IFRpbWUubm93LFxuICAgIGNsYW1wMDEgPSBNYXRoZi5jbGFtcDAxLFxuICAgIGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuXG5mdW5jdGlvbiBBdWRpb1NvdXJjZShvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIENvbXBvbmVudC5jYWxsKHRoaXMsIFwiQXVkaW9Tb3VyY2VcIiwgb3B0cyk7XG5cbiAgICB0aGlzLmNsaXAgPSBvcHRzLmNsaXA7XG5cbiAgICB0aGlzLl9zb3VyY2UgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fZ2FpbiA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl9wYW5uZXIgPSB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLmRvcHBsZXJMZXZlbCA9IG9wdHMuZG9wcGxlckxldmVsICE9IHVuZGVmaW5lZCA/IG9wdHMuZG9wcGxlckxldmVsIDogMTtcbiAgICB0aGlzLl9sb29wID0gb3B0cy5sb29wICE9IHVuZGVmaW5lZCA/ICEhb3B0cy5sb29wIDogZmFsc2U7XG5cbiAgICB0aGlzLm1heERpc3RhbmNlID0gb3B0cy5tYXhEaXN0YW5jZSAhPSB1bmRlZmluZWQgPyBvcHRzLm1heERpc3RhbmNlIDogMTU7XG4gICAgdGhpcy5taW5EaXN0YW5jZSA9IG9wdHMubWluRGlzdGFuY2UgIT0gdW5kZWZpbmVkID8gb3B0cy5taW5EaXN0YW5jZSA6IDE7XG5cbiAgICB0aGlzLm9mZnNldCA9IG9wdHMub2Zmc2V0ICE9IHVuZGVmaW5lZCA/IG9wdHMub2Zmc2V0IDogbmV3IFZlYzM7XG5cbiAgICB0aGlzLnBpdGNoID0gb3B0cy5waXRjaCAhPSB1bmRlZmluZWQgPyBvcHRzLnBpdGNoIDogMDtcblxuICAgIHRoaXMucGxheU9uU3RhcnQgPSBvcHRzLnBsYXlPblN0YXJ0ICE9IHVuZGVmaW5lZCA/ICEhb3B0cy5wbGF5T25TdGFydCA6IGZhbHNlO1xuXG4gICAgdGhpcy5zcHJlYWQgPSBvcHRzLnNwcmVhZCAhPSB1bmRlZmluZWQgPyBvcHRzLnNwcmVhZCA6IDA7XG5cbiAgICB0aGlzLnRpbWUgPSBvcHRzLnRpbWUgIT0gdW5kZWZpbmVkID8gb3B0cy50aW1lIDogMDtcbiAgICB0aGlzLl92b2x1bWUgPSBvcHRzLnZvbHVtZSAhPSB1bmRlZmluZWQgPyBvcHRzLnZvbHVtZSA6IDE7XG5cbiAgICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcbiAgICB0aGlzLnN0b3BwZWQgPSBmYWxzZTtcbiAgICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xuXG4gICAgdGhpcy5fc3RhcnRUaW1lID0gMDtcblxuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgdGhpcy5fb25lbmRlZCA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICBfdGhpcy5wbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIF90aGlzLnRpbWUgPSAwO1xuICAgICAgICBfdGhpcy5lbWl0KFwiZW5kXCIpO1xuICAgIH07XG59XG5cbkNvbXBvbmVudC5leHRlbmQoQXVkaW9Tb3VyY2UpO1xuXG5cbmRlZmluZVByb3BlcnR5KEF1ZGlvU291cmNlLnByb3RvdHlwZSwgXCJ2b2x1bWVcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdm9sdW1lO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdm9sdW1lID0gY2xhbXAwMSh2YWx1ZSk7XG4gICAgICAgIGlmICh0aGlzLl9nYWluKSB0aGlzLl9nYWluLmdhaW4udmFsdWUgPSB0aGlzLl92b2x1bWU7XG4gICAgfVxufSk7XG5cblxuZGVmaW5lUHJvcGVydHkoQXVkaW9Tb3VyY2UucHJvdG90eXBlLCBcImxvb3BcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbG9vcDtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2xvb3AgPSAhIXZhbHVlO1xuICAgICAgICBpZiAodGhpcy5fc291cmNlKSB0aGlzLl9zb3VyY2UubG9vcCA9IHRoaXMuX2xvb3A7XG4gICAgfVxufSk7XG5cblxuQXVkaW9Tb3VyY2UucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMuY2xpcCA9IG90aGVyLmNsaXA7XG5cbiAgICB0aGlzLmRvcHBsZXJMZXZlbCA9IG90aGVyLmRvcHBsZXJMZXZlbDtcbiAgICB0aGlzLmxvb3AgPSBvdGhlci5sb29wO1xuXG4gICAgdGhpcy5tYXhEaXN0YW5jZSA9IG90aGVyLm1heERpc3RhbmNlO1xuICAgIHRoaXMubWluRGlzdGFuY2UgPSBvdGhlci5taW5EaXN0YW5jZTtcblxuICAgIHRoaXMub2Zmc2V0LmNvcHkob3RoZXIub2Zmc2V0KTtcbiAgICB0aGlzLnBhbkxldmVsID0gb3RoZXIucGFuTGV2ZWw7XG5cbiAgICB0aGlzLnBpdGNoID0gb3RoZXIucGl0Y2g7XG5cbiAgICB0aGlzLnBsYXlPblN0YXJ0ID0gb3RoZXIucGxheU9uU3RhcnQ7XG5cbiAgICB0aGlzLnNwcmVhZCA9IG90aGVyLnNwcmVhZDtcblxuICAgIHRoaXMudGltZSA9IG90aGVyLnRpbWU7XG4gICAgdGhpcy52b2x1bWUgPSBvdGhlci52b2x1bWU7XG5cbiAgICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcbiAgICB0aGlzLnN0b3BwZWQgPSBmYWxzZTtcbiAgICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkF1ZGlvU291cmNlLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICBDb21wb25lbnQucHJvdG90eXBlLmNsZWFyLmNhbGwodGhpcyk7XG4gICAgaWYgKHRoaXMucGxheWluZykgdGhpcy5zdG9wKCk7XG5cbiAgICB0aGlzLmNsaXAgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fc291cmNlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX2dhaW4gPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fcGFubmVyID0gdW5kZWZpbmVkO1xufTtcblxuXG5BdWRpb1NvdXJjZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICBpZiAodGhpcy5wbGF5T25TdGFydCkgdGhpcy5wbGF5KCk7XG59O1xuXG5cbnZhciBWRUMyID0gbmV3IFZlYzIsXG4gICAgVkVDMyA9IG5ldyBWZWMzO1xuQXVkaW9Tb3VyY2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5kb3BwbGVyTGV2ZWwgPT09IDAgfHwgIXRoaXMucGxheWluZykgcmV0dXJuO1xuICAgIHZhciB0cmFuc2Zvcm0yZCwgdHJhbnNmb3JtLCBjYW1lcmEsIGNhbWVyYVRyYW5zZm9ybSwgcGFubmVyO1xuXG4gICAgaWYgKCEoY2FtZXJhID0gdGhpcy5nYW1lT2JqZWN0LnNjZW5lLmdhbWUuY2FtZXJhKSkgcmV0dXJuO1xuICAgIGlmICghKHBhbm5lciA9IHRoaXMuX3Bhbm5lcikpIHJldHVybjtcblxuICAgIHRyYW5zZm9ybSA9IHRoaXMudHJhbnNmb3JtO1xuICAgIHRyYW5zZm9ybTJkID0gdGhpcy50cmFuc2Zvcm0yZDtcblxuICAgIGNhbWVyYVRyYW5zZm9ybSA9IGNhbWVyYS50cmFuc2Zvcm0gfHwgY2FtZXJhLnRyYW5zZm9ybTJkO1xuXG4gICAgaWYgKHRyYW5zZm9ybTJkKSB7XG4gICAgICAgIFZFQzIudmFkZCh0cmFuc2Zvcm0yZC5wb3NpdGlvbiwgdGhpcy5vZmZzZXQpO1xuICAgICAgICBWRUMyLnN1YihjYW1lcmFUcmFuc2Zvcm0ucG9zaXRpb24pO1xuICAgICAgICBWRUMyLnNtdWwodGhpcy5kb3BwbGVyTGV2ZWwpO1xuXG4gICAgICAgIHBhbm5lci5zZXRQb3NpdGlvbihWRUMyLngsIFZFQzIueSwgY2FtZXJhLm9ydGhvZ3JhcGhpY1NpemUgKiAwLjUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIFZFQzMudmFkZCh0cmFuc2Zvcm0ucG9zaXRpb24sIHRoaXMub2Zmc2V0KTtcbiAgICAgICAgVkVDMy5zdWIoY2FtZXJhVHJhbnNmb3JtLnBvc2l0aW9uKTtcbiAgICAgICAgVkVDMy5zbXVsKHRoaXMuZG9wcGxlckxldmVsKTtcblxuICAgICAgICBwYW5uZXIuc2V0UG9zaXRpb24oVkVDMy54LCBWRUMzLnksIFZFQzMueiB8fCAwKTtcbiAgICB9XG59O1xuXG5cbkF1ZGlvU291cmNlLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKGRlbGF5LCBvZmZzZXQsIGR1cmF0aW9uKSB7XG4gICAgaWYgKCFBdWRpb0N0eCkgcmV0dXJuIHRoaXM7XG4gICAgaWYgKCFBdWRpb0N0eC5VTkxPQ0tFRCAmJiB0aGlzLl9sb29wKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXMsXG4gICAgICAgICAgICBsaXN0ZW5lciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucGxheSgpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXVkaW9jb250ZXh0dW5sb2NrXCIsIGxpc3RlbmVyLCBmYWxzZSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiYXVkaW9jb250ZXh0dW5sb2NrXCIsIGxpc3RlbmVyLCBmYWxzZSk7XG4gICAgfVxuICAgIGlmICghdGhpcy5jbGlwIHx8ICF0aGlzLmNsaXAucmF3KSByZXR1cm4gdGhpcztcbiAgICB2YXIgdGltZSA9IHRoaXMudGltZSxcbiAgICAgICAgY2xpcExlbmd0aCA9IHRoaXMuY2xpcC5sZW5ndGgsXG4gICAgICAgIG1heExlbmd0aCA9IGNsaXBMZW5ndGggLSB0aW1lO1xuXG4gICAgZGVsYXkgfHwgKGRlbGF5ID0gMCk7XG4gICAgb2Zmc2V0IHx8IChvZmZzZXQgPSB0aW1lKTtcbiAgICBkdXJhdGlvbiB8fCAoZHVyYXRpb24gPSBjbGlwTGVuZ3RoKTtcbiAgICBkdXJhdGlvbiA9IGR1cmF0aW9uID4gbWF4TGVuZ3RoID8gbWF4TGVuZ3RoIDogZHVyYXRpb247XG5cbiAgICB0aGlzLl9yZWZyZXNoKCk7XG5cbiAgICB0aGlzLnBsYXlpbmcgPSB0cnVlO1xuICAgIHRoaXMuc3RvcHBlZCA9IGZhbHNlO1xuICAgIHRoaXMucGF1c2VkID0gZmFsc2U7XG4gICAgdGhpcy5fc3RhcnRUaW1lID0gbm93KCk7XG5cbiAgICB0aGlzLnRpbWUgPSBvZmZzZXQ7XG4gICAgdGhpcy5fc291cmNlLnN0YXJ0KGRlbGF5LCBvZmZzZXQsIGR1cmF0aW9uKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5BdWRpb1NvdXJjZS5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFBdWRpb0N0eCB8fCAhdGhpcy5jbGlwIHx8ICF0aGlzLmNsaXAucmF3KSByZXR1cm4gdGhpcztcblxuICAgIHRoaXMucGxheWluZyA9IGZhbHNlO1xuICAgIHRoaXMuc3RvcHBlZCA9IGZhbHNlO1xuICAgIHRoaXMucGF1c2VkID0gdHJ1ZTtcbiAgICB0aGlzLnRpbWUgPSBub3coKSAtIHRoaXMuX3N0YXJ0VGltZTtcblxuICAgIHRoaXMuX3NvdXJjZS5zdG9wKHRoaXMudGltZSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuQXVkaW9Tb3VyY2UucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFBdWRpb0N0eCB8fCAhdGhpcy5jbGlwIHx8ICF0aGlzLmNsaXAucmF3KSByZXR1cm4gdGhpcztcblxuICAgIHRoaXMudGltZSA9IDA7XG4gICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7XG4gICAgdGhpcy5zdG9wcGVkID0gdHJ1ZTtcbiAgICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xuXG4gICAgdGhpcy5fc291cmNlLnN0b3AodGhpcy50aW1lKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5BdWRpb1NvdXJjZS5wcm90b3R5cGUuX3JlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNvdXJjZSA9IHRoaXMuX3NvdXJjZSA9IEF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpLFxuICAgICAgICBnYWluID0gdGhpcy5fZ2FpbiA9IEF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKSxcbiAgICAgICAgcGFubmVyO1xuXG4gICAgaWYgKHRoaXMuZG9wcGxlckxldmVsID09PSAwKSB7XG4gICAgICAgIGdhaW4uY29ubmVjdChBdWRpb0N0eC5kZXN0aW5hdGlvbik7XG4gICAgICAgIHNvdXJjZS5jb25uZWN0KGdhaW4pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHBhbm5lciA9IHRoaXMuX3Bhbm5lciA9IEF1ZGlvQ3R4LmNyZWF0ZVBhbm5lcigpO1xuXG4gICAgICAgIGdhaW4uY29ubmVjdChBdWRpb0N0eC5kZXN0aW5hdGlvbik7XG4gICAgICAgIHBhbm5lci5jb25uZWN0KGdhaW4pO1xuICAgICAgICBzb3VyY2UuY29ubmVjdChwYW5uZXIpO1xuICAgIH1cblxuICAgIHNvdXJjZS5idWZmZXIgPSB0aGlzLmNsaXAucmF3O1xuICAgIHNvdXJjZS5vbmVuZGVkID0gdGhpcy5fb25lbmRlZDtcblxuICAgIGdhaW4uZ2Fpbi52YWx1ZSA9IHRoaXMudm9sdW1lO1xuICAgIHNvdXJjZS5sb29wID0gdGhpcy5fbG9vcDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5BdWRpb1NvdXJjZS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gQ29tcG9uZW50LnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIGpzb24uY2xpcCA9IHRoaXMuY2xpcCA/IHRoaXMuY2xpcC5uYW1lIDogdW5kZWZpbmVkO1xuXG4gICAganNvbi5kb3BwbGVyTGV2ZWwgPSB0aGlzLmRvcHBsZXJMZXZlbDtcbiAgICBqc29uLmxvb3AgPSB0aGlzLmxvb3A7XG5cbiAgICBqc29uLm1heERpc3RhbmNlID0gdGhpcy5tYXhEaXN0YW5jZTtcbiAgICBqc29uLm1pbkRpc3RhbmNlID0gdGhpcy5taW5EaXN0YW5jZTtcblxuICAgIGpzb24ub2Zmc2V0ID0gdGhpcy5vZmZzZXQudG9KU09OKGpzb24ub2Zmc2V0KTtcbiAgICBqc29uLnBhbkxldmVsID0gdGhpcy5wYW5MZXZlbDtcblxuICAgIGpzb24ucGl0Y2ggPSB0aGlzLnBpdGNoO1xuXG4gICAganNvbi5wbGF5T25TdGFydCA9IHRoaXMucGxheU9uU3RhcnQ7XG5cbiAgICBqc29uLnNwcmVhZCA9IHRoaXMuc3ByZWFkO1xuXG4gICAganNvbi50aW1lID0gdGhpcy50aW1lO1xuICAgIGpzb24udm9sdW1lID0gdGhpcy52b2x1bWU7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuQXVkaW9Tb3VyY2UucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBDb21wb25lbnQucHJvdG90eXBlLmZyb21KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICB0aGlzLmNsaXAgPSBqc29uLmNsaXAgPyBBc3NldHMuZ2V0KGpzb24uY2xpcCkgOiB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLmRvcHBsZXJMZXZlbCA9IGpzb24uZG9wcGxlckxldmVsO1xuICAgIHRoaXMubG9vcCA9IGpzb24ubG9vcDtcblxuICAgIHRoaXMubWF4RGlzdGFuY2UgPSBqc29uLm1heERpc3RhbmNlO1xuICAgIHRoaXMubWluRGlzdGFuY2UgPSBqc29uLm1pbkRpc3RhbmNlO1xuXG4gICAgdGhpcy5vZmZzZXQuZnJvbUpTT04oanNvbi5vZmZzZXQpO1xuICAgIHRoaXMucGFuTGV2ZWwgPSBqc29uLnBhbkxldmVsO1xuXG4gICAgdGhpcy5waXRjaCA9IGpzb24ucGl0Y2g7XG5cbiAgICB0aGlzLnBsYXlPblN0YXJ0ID0ganNvbi5wbGF5T25TdGFydDtcblxuICAgIHRoaXMuc3ByZWFkID0ganNvbi5zcHJlYWQ7XG5cbiAgICB0aGlzLnRpbWUgPSBqc29uLnRpbWU7XG4gICAgdGhpcy52b2x1bWUgPSBqc29uLnZvbHVtZTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEF1ZGlvU291cmNlO1xuIiwidmFyIFZlYzMgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWMyXCIpO1xudmFyIFF1YXQgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9xdWF0XCIpO1xudmFyIE1hdDQgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9tYXQ0XCIpO1xudmFyIENvbXBvbmVudCA9IHJlcXVpcmUoXCIuL2NvbXBvbmVudFwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBVTktOT1dOID0gMDtcblxuXG5mdW5jdGlvbiBCb25lKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQ29tcG9uZW50LmNhbGwodGhpcywgXCJCb25lXCIsIG9wdHMpO1xuXG4gICAgdGhpcy5wYXJlbnRJbmRleCA9IG9wdHMucGFyZW50SW5kZXggIT0gdW5kZWZpbmVkID8gb3B0cy5wYXJlbnRJbmRleCA6IC0xO1xuICAgIHRoaXMubmFtZSA9IG9wdHMubmFtZSAhPSB1bmRlZmluZWQgPyBvcHRzLm5hbWUgOiBcIkJvbmVfXCIgKyBVTktOT1dOKys7XG5cbiAgICB0aGlzLnNraW5uZWQgPSBvcHRzLnNraW5uZWQgIT0gdW5kZWZpbmVkID8gb3B0cy5za2lubmVkIDogZmFsc2U7XG4gICAgdGhpcy5iaW5kUG9zZSA9IG9wdHMuYmluZFBvc2UgIT0gdW5kZWZpbmVkID8gb3B0cy5iaW5kUG9zZSA6IG5ldyBNYXQ0O1xuICAgIHRoaXMudW5pZm9ybSA9IG5ldyBNYXQ0O1xuXG4gICAgdGhpcy5pbmhlcml0UG9zaXRpb24gPSBvcHRzLmluaGVyaXRQb3NpdGlvbiAhPSB1bmRlZmluZWQgPyBvcHRzLmluaGVyaXRQb3NpdGlvbiA6IHRydWU7XG4gICAgdGhpcy5pbmhlcml0Um90YXRpb24gPSBvcHRzLmluaGVyaXRSb3RhdGlvbiAhPSB1bmRlZmluZWQgPyBvcHRzLmluaGVyaXRSb3RhdGlvbiA6IHRydWU7XG4gICAgdGhpcy5pbmhlcml0U2NhbGUgPSBvcHRzLmluaGVyaXRTY2FsZSAhPSB1bmRlZmluZWQgPyBvcHRzLmluaGVyaXRTY2FsZSA6IHRydWU7XG59XG5cbkNvbXBvbmVudC5leHRlbmQoQm9uZSk7XG5cblxuQm9uZS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy5uYW1lID0gb3RoZXIubmFtZTtcbiAgICB0aGlzLnBhcmVudEluZGV4ID0gb3RoZXIucGFyZW50SW5kZXg7XG5cbiAgICB0aGlzLnNraW5uZWQgPSBvdGhlci5za2lubmVkO1xuICAgIHRoaXMuYmluZFBvc2UuY29weShvdGhlci5iaW5kUG9zZSk7XG5cbiAgICB0aGlzLmluaGVyaXRQb3NpdGlvbiA9IG90aGVyLmluaGVyaXRQb3NpdGlvbjtcbiAgICB0aGlzLmluaGVyaXRSb3RhdGlvbiA9IG90aGVyLmluaGVyaXRSb3RhdGlvbjtcbiAgICB0aGlzLmluaGVyaXRTY2FsZSA9IG90aGVyLmluaGVyaXRTY2FsZTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG52YXIgTUFUID0gbmV3IE1hdDQsXG4gICAgUE9TSVRJT04gPSBuZXcgVmVjMyxcbiAgICBTQ0FMRSA9IG5ldyBWZWMzLFxuICAgIFJPVEFUSU9OID0gbmV3IFF1YXQ7XG5Cb25lLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLnNraW5uZWQpIHJldHVybjtcbiAgICB2YXIgdHJhbnNmb3JtID0gdGhpcy50cmFuc2Zvcm0sXG4gICAgICAgIHVuaWZvcm0gPSB0aGlzLnVuaWZvcm0sXG4gICAgICAgIHBhcmVudCA9IHRyYW5zZm9ybS5wYXJlbnQsXG4gICAgICAgIGluaGVyaXRQb3NpdGlvbiA9IHRoaXMuaW5oZXJpdFBvc2l0aW9uLFxuICAgICAgICBpbmhlcml0U2NhbGUgPSB0aGlzLmluaGVyaXRTY2FsZSxcbiAgICAgICAgaW5oZXJpdFJvdGF0aW9uID0gdGhpcy5pbmhlcml0Um90YXRpb247XG5cbiAgICB1bmlmb3JtLmNvcHkodHJhbnNmb3JtLm1hdHJpeCk7XG5cbiAgICBpZiAocGFyZW50ICYmIHRoaXMucGFyZW50SW5kZXggIT09IC0xKSB7XG4gICAgICAgIE1BVC5jb3B5KHBhcmVudC5ib25lLnVuaWZvcm0pO1xuXG4gICAgICAgIGlmICghaW5oZXJpdFBvc2l0aW9uIHx8ICFpbmhlcml0U2NhbGUgfHwgIWluaGVyaXRSb3RhdGlvbikge1xuICAgICAgICAgICAgTUFULmRlY29tcG9zZShQT1NJVElPTiwgU0NBTEUsIFJPVEFUSU9OKTtcblxuICAgICAgICAgICAgaWYgKCFpbmhlcml0UG9zaXRpb24pIFBPU0lUSU9OLnNldCgwLjAsIDAuMCwgMC4wKTtcbiAgICAgICAgICAgIGlmICghaW5oZXJpdFNjYWxlKSBTQ0FMRS5zZXQoMS4wLCAxLjAsIDEuMCk7XG4gICAgICAgICAgICBpZiAoIWluaGVyaXRSb3RhdGlvbikgUk9UQVRJT04uc2V0KDAuMCwgMC4wLCAwLjAsIDEuMCk7XG5cbiAgICAgICAgICAgIE1BVC5jb21wb3NlKFBPU0lUSU9OLCBTQ0FMRSwgUk9UQVRJT04pO1xuICAgICAgICB9XG5cbiAgICAgICAgdW5pZm9ybS5tbXVsKE1BVCwgdW5pZm9ybSk7XG4gICAgfVxufTtcblxuXG5Cb25lLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDb21wb25lbnQucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi5uYW1lID0gdGhpcy5uYW1lO1xuICAgIGpzb24ucGFyZW50SW5kZXggPSB0aGlzLnBhcmVudEluZGV4O1xuXG4gICAganNvbi5za2lubmVkID0gdGhpcy5za2lubmVkO1xuICAgIGpzb24uYmluZFBvc2UgPSB0aGlzLmJpbmRQb3NlLnRvSlNPTihqc29uLmJpbmRQb3NlKTtcblxuICAgIGpzb24uaW5oZXJpdFBvc2l0aW9uID0gdGhpcy5pbmhlcml0UG9zaXRpb247XG4gICAganNvbi5pbmhlcml0Um90YXRpb24gPSB0aGlzLmluaGVyaXRSb3RhdGlvbjtcbiAgICBqc29uLmluaGVyaXRTY2FsZSA9IHRoaXMuaW5oZXJpdFNjYWxlO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbkJvbmUucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBDb21wb25lbnQucHJvdG90eXBlLmZyb21KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICB0aGlzLm5hbWUgPSBqc29uLm5hbWU7XG4gICAgdGhpcy5wYXJlbnRJbmRleCA9IGpzb24ucGFyZW50SW5kZXg7XG5cbiAgICB0aGlzLnNraW5uZWQgPSBqc29uLnNraW5uZWQ7XG4gICAgdGhpcy5iaW5kUG9zZS5mcm9tSlNPTihqc29uLmJpbmRQb3NlKTtcblxuICAgIHRoaXMuaW5oZXJpdFBvc2l0aW9uID0ganNvbi5pbmhlcml0UG9zaXRpb247XG4gICAgdGhpcy5pbmhlcml0Um90YXRpb24gPSBqc29uLmluaGVyaXRSb3RhdGlvbjtcbiAgICB0aGlzLmluaGVyaXRTY2FsZSA9IGpzb24uaW5oZXJpdFNjYWxlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gQm9uZTtcbiIsInZhciBNYXRoZiA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL21hdGhmXCIpO1xudmFyIENvbG9yID0gcmVxdWlyZShcIi4uLy4uL21hdGgvY29sb3JcIik7XG52YXIgVmVjMyA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3ZlYzNcIik7XG52YXIgTWF0NCA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL21hdDRcIik7XG52YXIgQ29tcG9uZW50ID0gcmVxdWlyZShcIi4vY29tcG9uZW50XCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGRlZ3NUb1JhZHMgPSBNYXRoZi5kZWdzVG9SYWRzLFxuICAgIGNsYW1wID0gTWF0aGYuY2xhbXAsXG4gICAgRVBTSUxPTiA9IE1hdGhmLkVQU0lMT047XG5cblxuZnVuY3Rpb24gQ2FtZXJhKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQ29tcG9uZW50LmNhbGwodGhpcywgXCJDYW1lcmFcIiwgb3B0cyk7XG5cbiAgICB0aGlzLndpZHRoID0gOTYwO1xuICAgIHRoaXMuaGVpZ2h0ID0gNjQwO1xuICAgIHRoaXMuaW52V2lkdGggPSAxIC8gdGhpcy53aWR0aDtcbiAgICB0aGlzLmludkhlaWdodCA9IDEgLyB0aGlzLmhlaWdodDtcblxuICAgIHRoaXMuYXV0b1Jlc2l6ZSA9IG9wdHMuYXV0b1Jlc2l6ZSAhPSB1bmRlZmluZWQgPyAhIW9wdHMuYXV0b1Jlc2l6ZSA6IHRydWU7XG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gb3B0cy5iYWNrZ3JvdW5kICE9IHVuZGVmaW5lZCA/IG9wdHMuYmFja2dyb3VuZCA6IG5ldyBDb2xvcigwLjUsIDAuNSwgMC41KTtcblxuICAgIHRoaXMuYXNwZWN0ID0gdGhpcy53aWR0aCAvIHRoaXMuaGVpZ2h0O1xuICAgIHRoaXMuZm92ID0gb3B0cy5mb3YgIT0gdW5kZWZpbmVkID8gb3B0cy5mb3YgOiAzNTtcblxuICAgIHRoaXMubmVhciA9IG9wdHMubmVhciAhPSB1bmRlZmluZWQgPyBvcHRzLm5lYXIgOiAwLjA2MjU7XG4gICAgdGhpcy5mYXIgPSBvcHRzLmZhciAhPSB1bmRlZmluZWQgPyBvcHRzLmZhciA6IDE2Mzg0O1xuXG4gICAgdGhpcy5vcnRob2dyYXBoaWMgPSBvcHRzLm9ydGhvZ3JhcGhpYyAhPSB1bmRlZmluZWQgPyAhIW9wdHMub3J0aG9ncmFwaGljIDogZmFsc2U7XG4gICAgdGhpcy5vcnRob2dyYXBoaWNTaXplID0gb3B0cy5vcnRob2dyYXBoaWNTaXplICE9IHVuZGVmaW5lZCA/IG9wdHMub3J0aG9ncmFwaGljU2l6ZSA6IDI7XG5cbiAgICB0aGlzLm1pbk9ydGhvZ3JhcGhpY1NpemUgPSBvcHRzLm1pbk9ydGhvZ3JhcGhpY1NpemUgIT0gdW5kZWZpbmVkID8gb3B0cy5taW5PcnRob2dyYXBoaWNTaXplIDogRVBTSUxPTjtcbiAgICB0aGlzLm1heE9ydGhvZ3JhcGhpY1NpemUgPSBvcHRzLm1heE9ydGhvZ3JhcGhpY1NpemUgIT0gdW5kZWZpbmVkID8gb3B0cy5tYXhPcnRob2dyYXBoaWNTaXplIDogMTAyNDtcblxuICAgIHRoaXMucHJvamVjdGlvbiA9IG5ldyBNYXQ0O1xuICAgIHRoaXMuZ3VpUHJvamVjdGlvbiA9IG5ldyBNYXQ0O1xuICAgIHRoaXMudmlldyA9IG5ldyBNYXQ0O1xuXG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5fYWN0aXZlID0gZmFsc2U7XG59XG5cbkNvbXBvbmVudC5leHRlbmQoQ2FtZXJhKTtcblxuXG5DYW1lcmEucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMud2lkdGggPSBvdGhlci53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IG90aGVyLmhlaWdodDtcbiAgICB0aGlzLmFzcGVjdCA9IG90aGVyLmFzcGVjdDtcblxuICAgIHRoaXMuaW52V2lkdGggPSAxIC8gdGhpcy53aWR0aDtcbiAgICB0aGlzLmludkhlaWdodCA9IDEgLyB0aGlzLmhlaWdodDtcblxuICAgIHRoaXMuYXV0b1Jlc2l6ZSA9IG90aGVyLmF1dG9SZXNpemU7XG4gICAgdGhpcy5iYWNrZ3JvdW5kLmNvcHkob3RoZXIuYmFja2dyb3VuZCk7XG5cbiAgICB0aGlzLmZhciA9IG90aGVyLmZhcjtcbiAgICB0aGlzLm5lYXIgPSBvdGhlci5uZWFyO1xuICAgIHRoaXMuZm92ID0gb3RoZXIuZm92O1xuXG4gICAgdGhpcy5vcnRob2dyYXBoaWMgPSBvdGhlci5vcnRob2dyYXBoaWM7XG4gICAgdGhpcy5vcnRob2dyYXBoaWNTaXplID0gb3RoZXIub3J0aG9ncmFwaGljU2l6ZTtcbiAgICB0aGlzLm1pbk9ydGhvZ3JhcGhpY1NpemUgPSBvdGhlci5taW5PcnRob2dyYXBoaWNTaXplO1xuICAgIHRoaXMubWF4T3J0aG9ncmFwaGljU2l6ZSA9IG90aGVyLm1heE9ydGhvZ3JhcGhpY1NpemU7XG5cbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5DYW1lcmEucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0KSB7XG5cbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICB0aGlzLmludldpZHRoID0gMSAvIHRoaXMud2lkdGg7XG4gICAgdGhpcy5pbnZIZWlnaHQgPSAxIC8gdGhpcy5oZWlnaHQ7XG5cbiAgICB0aGlzLmFzcGVjdCA9IHdpZHRoIC8gaGVpZ2h0O1xuICAgIHRoaXMubmVlZHNVcGRhdGUgPSB0cnVlO1xufTtcblxuXG5DYW1lcmEucHJvdG90eXBlLnNldFdpZHRoID0gZnVuY3Rpb24gKHdpZHRoKSB7XG5cbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5hc3BlY3QgPSB3aWR0aCAvIHRoaXMuaGVpZ2h0O1xuXG4gICAgdGhpcy5pbnZXaWR0aCA9IDEgLyB0aGlzLndpZHRoO1xuXG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG59O1xuXG5cbkNhbWVyYS5wcm90b3R5cGUuc2V0SGVpZ2h0ID0gZnVuY3Rpb24gKGhlaWdodCkge1xuXG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgdGhpcy5hc3BlY3QgPSB0aGlzLndpZHRoIC8gaGVpZ2h0O1xuXG4gICAgdGhpcy5pbnZIZWlnaHQgPSAxIC8gdGhpcy5oZWlnaHQ7XG5cbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxuQ2FtZXJhLnByb3RvdHlwZS5zZXRGb3YgPSBmdW5jdGlvbiAodmFsdWUpIHtcblxuICAgIHRoaXMuZm92ID0gdmFsdWU7XG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG59O1xuXG5cbkNhbWVyYS5wcm90b3R5cGUuc2V0TmVhciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXG4gICAgdGhpcy5uZWFyID0gdmFsdWU7XG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG59O1xuXG5cbkNhbWVyYS5wcm90b3R5cGUuc2V0RmFyID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cbiAgICB0aGlzLmZhciA9IHZhbHVlO1xuICAgIHRoaXMubmVlZHNVcGRhdGUgPSB0cnVlO1xufTtcblxuXG5DYW1lcmEucHJvdG90eXBlLnNldE9ydGhvZ3JhcGhpYyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXG4gICAgdGhpcy5vcnRob2dyYXBoaWMgPSAhIXZhbHVlO1xuICAgIHRoaXMubmVlZHNVcGRhdGUgPSB0cnVlO1xufTtcblxuXG5DYW1lcmEucHJvdG90eXBlLnRvZ2dsZU9ydGhvZ3JhcGhpYyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMub3J0aG9ncmFwaGljID0gIXRoaXMub3J0aG9ncmFwaGljO1xuICAgIHRoaXMubmVlZHNVcGRhdGUgPSB0cnVlO1xufTtcblxuXG5DYW1lcmEucHJvdG90eXBlLnNldE9ydGhvZ3JhcGhpY1NpemUgPSBmdW5jdGlvbiAoc2l6ZSkge1xuXG4gICAgdGhpcy5vcnRob2dyYXBoaWNTaXplID0gY2xhbXAoc2l6ZSwgdGhpcy5taW5PcnRob2dyYXBoaWNTaXplLCB0aGlzLm1heE9ydGhvZ3JhcGhpY1NpemUpO1xuICAgIHRoaXMubmVlZHNVcGRhdGUgPSB0cnVlO1xufTtcblxuXG52YXIgTUFUNCA9IG5ldyBNYXQ0LFxuICAgIFZFQzMgPSBuZXcgVmVjMztcblxuQ2FtZXJhLnByb3RvdHlwZS50b1dvcmxkID0gZnVuY3Rpb24gKHYsIG91dCkge1xuICAgIG91dCB8fCAob3V0ID0gbmV3IFZlYzMpO1xuXG4gICAgb3V0LnggPSAyLjAgKiAodi54ICogdGhpcy5pbnZXaWR0aCkgLSAxLjA7XG4gICAgb3V0LnkgPSAtMi4wICogKHYueSAqIHRoaXMuaW52SGVpZ2h0KSArIDEuMDtcbiAgICBvdXQudHJhbnNmb3JtTWF0NChNQVQ0Lm1tdWwodGhpcy5wcm9qZWN0aW9uLCB0aGlzLnZpZXcpLmludmVyc2UoKSk7XG4gICAgb3V0LnogPSB0aGlzLm5lYXI7XG5cbiAgICByZXR1cm4gb3V0O1xufTtcblxuXG5DYW1lcmEucHJvdG90eXBlLnRvU2NyZWVuID0gZnVuY3Rpb24gKHYsIG91dCkge1xuICAgIG91dCB8fCAob3V0ID0gbmV3IFZlYzIpO1xuXG4gICAgVkVDMy5jb3B5KHYpO1xuICAgIFZFQzMudHJhbnNmb3JtTWF0NChNQVQ0Lm1tdWwodGhpcy5wcm9qZWN0aW9uLCB0aGlzLnZpZXcpKTtcblxuICAgIG91dC54ID0gKChWRUMzLnggKyAxLjApICogMC41KSAqIHRoaXMud2lkdGg7XG4gICAgb3V0LnkgPSAoKDEuMCAtIFZFQzMueSkgKiAwLjUpICogdGhpcy5oZWlnaHQ7XG5cbiAgICByZXR1cm4gdjtcbn07XG5cblxuQ2FtZXJhLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZm9yY2UpIHtcbiAgICBpZiAoIWZvcmNlICYmICF0aGlzLl9hY3RpdmUpIHJldHVybjtcblxuICAgIGlmICh0aGlzLm5lZWRzVXBkYXRlKSB7XG5cbiAgICAgICAgaWYgKCF0aGlzLm9ydGhvZ3JhcGhpYykge1xuICAgICAgICAgICAgdGhpcy5wcm9qZWN0aW9uLnBlcnNwZWN0aXZlKGRlZ3NUb1JhZHModGhpcy5mb3YpLCB0aGlzLmFzcGVjdCwgdGhpcy5uZWFyLCB0aGlzLmZhcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9ydGhvZ3JhcGhpY1NpemUgPSBjbGFtcCh0aGlzLm9ydGhvZ3JhcGhpY1NpemUsIHRoaXMubWluT3J0aG9ncmFwaGljU2l6ZSwgdGhpcy5tYXhPcnRob2dyYXBoaWNTaXplKTtcblxuICAgICAgICAgICAgdmFyIG9ydGhvZ3JhcGhpY1NpemUgPSB0aGlzLm9ydGhvZ3JhcGhpY1NpemUsXG4gICAgICAgICAgICAgICAgcmlnaHQgPSBvcnRob2dyYXBoaWNTaXplICogdGhpcy5hc3BlY3QsXG4gICAgICAgICAgICAgICAgbGVmdCA9IC1yaWdodCxcbiAgICAgICAgICAgICAgICB0b3AgPSBvcnRob2dyYXBoaWNTaXplLFxuICAgICAgICAgICAgICAgIGJvdHRvbSA9IC10b3A7XG5cbiAgICAgICAgICAgIHRoaXMucHJvamVjdGlvbi5vcnRob2dyYXBoaWMobGVmdCwgcmlnaHQsIHRvcCwgYm90dG9tLCB0aGlzLm5lYXIsIHRoaXMuZmFyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZ3VpUHJvamVjdGlvbi5vcnRob2dyYXBoaWMoMCwgdGhpcy53aWR0aCwgMCwgdGhpcy5oZWlnaHQsIC0xLCAxKTtcblxuICAgICAgICB0aGlzLm5lZWRzVXBkYXRlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdGhpcy52aWV3LmludmVyc2VNYXQoKHRoaXMudHJhbnNmb3JtIHx8IHRoaXMudHJhbnNmb3JtMmQpLm1hdHJpeFdvcmxkKTtcbn07XG5cblxuQ2FtZXJhLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDb21wb25lbnQucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi53aWR0aCA9IHRoaXMud2lkdGg7XG4gICAganNvbi5oZWlnaHQgPSB0aGlzLmhlaWdodDtcbiAgICBqc29uLmFzcGVjdCA9IHRoaXMuYXNwZWN0O1xuXG4gICAganNvbi5hdXRvUmVzaXplID0gdGhpcy5hdXRvUmVzaXplO1xuICAgIGpzb24uYmFja2dyb3VuZCA9IHRoaXMuYmFja2dyb3VuZC50b0pTT04oanNvbi5iYWNrZ3JvdW5kKTtcblxuICAgIGpzb24uZmFyID0gdGhpcy5mYXI7XG4gICAganNvbi5uZWFyID0gdGhpcy5uZWFyO1xuICAgIGpzb24uZm92ID0gdGhpcy5mb3Y7XG5cbiAgICBqc29uLm9ydGhvZ3JhcGhpYyA9IHRoaXMub3J0aG9ncmFwaGljO1xuICAgIGpzb24ub3J0aG9ncmFwaGljU2l6ZSA9IHRoaXMub3J0aG9ncmFwaGljU2l6ZTtcbiAgICBqc29uLm1pbk9ydGhvZ3JhcGhpY1NpemUgPSB0aGlzLm1pbk9ydGhvZ3JhcGhpY1NpemU7XG4gICAganNvbi5tYXhPcnRob2dyYXBoaWNTaXplID0gdGhpcy5tYXhPcnRob2dyYXBoaWNTaXplO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbkNhbWVyYS5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENvbXBvbmVudC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIHRoaXMud2lkdGggPSBqc29uLndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0ganNvbi5oZWlnaHQ7XG4gICAgdGhpcy5hc3BlY3QgPSBqc29uLmFzcGVjdDtcblxuICAgIHRoaXMuYXV0b1Jlc2l6ZSA9IGpzb24uYXV0b1Jlc2l6ZTtcbiAgICB0aGlzLmJhY2tncm91bmQuZnJvbUpTT04oanNvbi5iYWNrZ3JvdW5kKTtcblxuICAgIHRoaXMuZmFyID0ganNvbi5mYXI7XG4gICAgdGhpcy5uZWFyID0ganNvbi5uZWFyO1xuICAgIHRoaXMuZm92ID0ganNvbi5mb3Y7XG5cbiAgICB0aGlzLm9ydGhvZ3JhcGhpYyA9IGpzb24ub3J0aG9ncmFwaGljO1xuICAgIHRoaXMub3J0aG9ncmFwaGljU2l6ZSA9IGpzb24ub3J0aG9ncmFwaGljU2l6ZTtcbiAgICB0aGlzLm1pbk9ydGhvZ3JhcGhpY1NpemUgPSBqc29uLm1pbk9ydGhvZ3JhcGhpY1NpemU7XG4gICAgdGhpcy5tYXhPcnRob2dyYXBoaWNTaXplID0ganNvbi5tYXhPcnRob2dyYXBoaWNTaXplO1xuXG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBDYW1lcmE7XG4iLCJ2YXIgTWF0aGYgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9tYXRoZlwiKTtcbnZhciBDb2xvciA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL2NvbG9yXCIpO1xudmFyIFZlYzIgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWMyXCIpO1xudmFyIE1hdDMyID0gcmVxdWlyZShcIi4uLy4uL21hdGgvbWF0MzJcIik7XG52YXIgTWF0NCA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL21hdDRcIik7XG52YXIgQ29tcG9uZW50ID0gcmVxdWlyZShcIi4vY29tcG9uZW50XCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGNsYW1wID0gTWF0aGYuY2xhbXAsXG4gICAgRVBTSUxPTiA9IE1hdGhmLkVQU0lMT047XG5cblxuZnVuY3Rpb24gQ2FtZXJhMkQob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBDb21wb25lbnQuY2FsbCh0aGlzLCBcIkNhbWVyYTJEXCIsIG9wdHMpO1xuXG4gICAgdGhpcy53aWR0aCA9IDk2MDtcbiAgICB0aGlzLmhlaWdodCA9IDY0MDtcbiAgICB0aGlzLmludldpZHRoID0gMSAvIHRoaXMud2lkdGg7XG4gICAgdGhpcy5pbnZIZWlnaHQgPSAxIC8gdGhpcy5oZWlnaHQ7XG5cbiAgICB0aGlzLmF1dG9SZXNpemUgPSBvcHRzLmF1dG9SZXNpemUgIT0gdW5kZWZpbmVkID8gISFvcHRzLmF1dG9SZXNpemUgOiB0cnVlO1xuICAgIHRoaXMuYmFja2dyb3VuZCA9IG9wdHMuYmFja2dyb3VuZCAhPSB1bmRlZmluZWQgPyBvcHRzLmJhY2tncm91bmQgOiBuZXcgQ29sb3IoMC41LCAwLjUsIDAuNSk7XG5cbiAgICB0aGlzLmFzcGVjdCA9IHRoaXMud2lkdGggLyB0aGlzLmhlaWdodDtcblxuICAgIHRoaXMub3J0aG9ncmFwaGljU2l6ZSA9IG9wdHMub3J0aG9ncmFwaGljU2l6ZSAhPSB1bmRlZmluZWQgPyBvcHRzLm9ydGhvZ3JhcGhpY1NpemUgOiAyO1xuXG4gICAgdGhpcy5taW5PcnRob2dyYXBoaWNTaXplID0gb3B0cy5taW5PcnRob2dyYXBoaWNTaXplICE9IHVuZGVmaW5lZCA/IG9wdHMubWluT3J0aG9ncmFwaGljU2l6ZSA6IEVQU0lMT047XG4gICAgdGhpcy5tYXhPcnRob2dyYXBoaWNTaXplID0gb3B0cy5tYXhPcnRob2dyYXBoaWNTaXplICE9IHVuZGVmaW5lZCA/IG9wdHMubWF4T3J0aG9ncmFwaGljU2l6ZSA6IDEwMjQ7XG5cbiAgICB0aGlzLnByb2plY3Rpb24gPSBuZXcgTWF0NDtcbiAgICB0aGlzLl9wcm9qZWN0aW9uID0gbmV3IE1hdDMyO1xuICAgIHRoaXMuZ3VpUHJvamVjdGlvbiA9IG5ldyBNYXQ0O1xuXG4gICAgdGhpcy52aWV3ID0gbmV3IE1hdDQ7XG4gICAgdGhpcy5fdmlldyA9IG5ldyBNYXQzMjtcblxuICAgIHRoaXMubmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuX2FjdGl2ZSA9IGZhbHNlO1xufVxuXG5Db21wb25lbnQuZXh0ZW5kKENhbWVyYTJEKTtcblxuXG5DYW1lcmEyRC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy53aWR0aCA9IG90aGVyLndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gb3RoZXIuaGVpZ2h0O1xuXG4gICAgdGhpcy5pbnZXaWR0aCA9IDEgLyB0aGlzLndpZHRoO1xuICAgIHRoaXMuaW52SGVpZ2h0ID0gMSAvIHRoaXMuaGVpZ2h0O1xuXG4gICAgdGhpcy5hdXRvUmVzaXplID0gb3RoZXIuYXV0b1Jlc2l6ZTtcbiAgICB0aGlzLmJhY2tncm91bmQuY29weShvdGhlci5iYWNrZ3JvdW5kKTtcblxuICAgIHRoaXMub3J0aG9ncmFwaGljU2l6ZSA9IG90aGVyLm9ydGhvZ3JhcGhpY1NpemU7XG4gICAgdGhpcy5taW5PcnRob2dyYXBoaWNTaXplID0gb3RoZXIubWluT3J0aG9ncmFwaGljU2l6ZTtcbiAgICB0aGlzLm1heE9ydGhvZ3JhcGhpY1NpemUgPSBvdGhlci5tYXhPcnRob2dyYXBoaWNTaXplO1xuXG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuQ2FtZXJhMkQucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0KSB7XG5cbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICB0aGlzLmludldpZHRoID0gMSAvIHRoaXMud2lkdGg7XG4gICAgdGhpcy5pbnZIZWlnaHQgPSAxIC8gdGhpcy5oZWlnaHQ7XG5cbiAgICB0aGlzLmFzcGVjdCA9IHdpZHRoIC8gaGVpZ2h0O1xuICAgIHRoaXMubmVlZHNVcGRhdGUgPSB0cnVlO1xufTtcblxuXG5DYW1lcmEyRC5wcm90b3R5cGUuc2V0V2lkdGggPSBmdW5jdGlvbiAod2lkdGgpIHtcblxuICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLmFzcGVjdCA9IHdpZHRoIC8gdGhpcy5oZWlnaHQ7XG5cbiAgICB0aGlzLmludldpZHRoID0gMSAvIHRoaXMud2lkdGg7XG5cbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxuQ2FtZXJhMkQucHJvdG90eXBlLnNldEhlaWdodCA9IGZ1bmN0aW9uIChoZWlnaHQpIHtcblxuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIHRoaXMuYXNwZWN0ID0gdGhpcy53aWR0aCAvIGhlaWdodDtcblxuICAgIHRoaXMuaW52SGVpZ2h0ID0gMSAvIHRoaXMuaGVpZ2h0O1xuXG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG59O1xuXG5cbkNhbWVyYTJELnByb3RvdHlwZS5zZXRPcnRob2dyYXBoaWNTaXplID0gZnVuY3Rpb24gKHNpemUpIHtcblxuICAgIHRoaXMub3J0aG9ncmFwaGljU2l6ZSA9IGNsYW1wKHNpemUsIHRoaXMubWluT3J0aG9ncmFwaGljU2l6ZSwgdGhpcy5tYXhPcnRob2dyYXBoaWNTaXplKTtcbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxudmFyIE1BVDMyID0gbmV3IE1hdDMyLFxuICAgIFZFQzIgPSBuZXcgVmVjMjtcbkNhbWVyYTJELnByb3RvdHlwZS50b1dvcmxkID0gZnVuY3Rpb24gKHYsIG91dCkge1xuICAgIG91dCB8fCAob3V0ID0gbmV3IFZlYzIpO1xuXG4gICAgb3V0LnggPSAyICogKHYueCAqIHRoaXMuaW52V2lkdGgpIC0gMTtcbiAgICBvdXQueSA9IC0yICogKHYueSAqIHRoaXMuaW52SGVpZ2h0KSArIDE7XG4gICAgb3V0LnRyYW5zZm9ybU1hdDMyKE1BVDMyLm1tdWwodGhpcy5fcHJvamVjdGlvbiwgdGhpcy5fdmlldykuaW52ZXJzZSgpKTtcblxuICAgIHJldHVybiBvdXQ7XG59O1xuXG5cbkNhbWVyYTJELnByb3RvdHlwZS50b1NjcmVlbiA9IGZ1bmN0aW9uICh2LCBvdXQpIHtcbiAgICBvdXQgfHwgKG91dCA9IG5ldyBWZWMyKTtcblxuICAgIFZFQzIuY29weSh2KS50cmFuc2Zvcm1NYXQzMihNQVQzMi5tbXVsKHRoaXMuX3Byb2plY3Rpb24sIHRoaXMuX3ZpZXcpKTtcblxuICAgIG91dC54ID0gKChWRUMyLnggKyAxKSAqIDAuNSkgKiB0aGlzLndpZHRoO1xuICAgIG91dC55ID0gKCgxIC0gVkVDMi55KSAqIDAuNSkgKiB0aGlzLmhlaWdodDtcblxuICAgIHJldHVybiBvdXQ7XG59O1xuXG5cbkNhbWVyYTJELnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLl9hY3RpdmUpIHJldHVybjtcblxuICAgIGlmICh0aGlzLm5lZWRzVXBkYXRlKSB7XG4gICAgICAgIHZhciBvcnRob2dyYXBoaWNTaXplID0gdGhpcy5vcnRob2dyYXBoaWNTaXplLFxuICAgICAgICAgICAgcmlnaHQgPSBvcnRob2dyYXBoaWNTaXplICogdGhpcy5hc3BlY3QsXG4gICAgICAgICAgICBsZWZ0ID0gLXJpZ2h0LFxuICAgICAgICAgICAgdG9wID0gb3J0aG9ncmFwaGljU2l6ZSxcbiAgICAgICAgICAgIGJvdHRvbSA9IC10b3A7XG5cbiAgICAgICAgdGhpcy5wcm9qZWN0aW9uLm9ydGhvZ3JhcGhpYyhsZWZ0LCByaWdodCwgdG9wLCBib3R0b20sIC0xLCAxKTtcbiAgICAgICAgdGhpcy5fcHJvamVjdGlvbi5mcm9tTWF0NCh0aGlzLnByb2plY3Rpb24pO1xuICAgICAgICB0aGlzLm5lZWRzVXBkYXRlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5ndWlQcm9qZWN0aW9uLm9ydGhvZ3JhcGhpYygwLCB0aGlzLndpZHRoLCAwLCB0aGlzLmhlaWdodCwgLTEsIDEpO1xuICAgIH1cblxuICAgIHRoaXMudmlldy5pbnZlcnNlTWF0KCh0aGlzLnRyYW5zZm9ybSB8fCB0aGlzLnRyYW5zZm9ybTJkKS5tYXRyaXhXb3JsZCk7XG4gICAgdGhpcy5fdmlldy5mcm9tTWF0NCh0aGlzLnZpZXcpO1xufTtcblxuXG5DYW1lcmEyRC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gQ29tcG9uZW50LnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIGpzb24ud2lkdGggPSB0aGlzLndpZHRoO1xuICAgIGpzb24uaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XG5cbiAgICBqc29uLmF1dG9SZXNpemUgPSB0aGlzLmF1dG9SZXNpemU7XG4gICAganNvbi5iYWNrZ3JvdW5kID0gdGhpcy5iYWNrZ3JvdW5kLnRvSlNPTihqc29uLmJhY2tncm91bmQpO1xuXG4gICAganNvbi5vcnRob2dyYXBoaWNTaXplID0gdGhpcy5vcnRob2dyYXBoaWNTaXplO1xuICAgIGpzb24ubWluT3J0aG9ncmFwaGljU2l6ZSA9IHRoaXMubWluT3J0aG9ncmFwaGljU2l6ZTtcbiAgICBqc29uLm1heE9ydGhvZ3JhcGhpY1NpemUgPSB0aGlzLm1heE9ydGhvZ3JhcGhpY1NpemU7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuQ2FtZXJhMkQucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBDb21wb25lbnQucHJvdG90eXBlLmZyb21KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICB0aGlzLndpZHRoID0ganNvbi53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IGpzb24uaGVpZ2h0O1xuXG4gICAgdGhpcy5hdXRvUmVzaXplID0ganNvbi5hdXRvUmVzaXplO1xuICAgIHRoaXMuYmFja2dyb3VuZC5mcm9tSlNPTihqc29uLmJhY2tncm91bmQpO1xuXG4gICAgdGhpcy5vcnRob2dyYXBoaWNTaXplID0ganNvbi5vcnRob2dyYXBoaWNTaXplO1xuICAgIHRoaXMubWluT3J0aG9ncmFwaGljU2l6ZSA9IGpzb24ubWluT3J0aG9ncmFwaGljU2l6ZTtcbiAgICB0aGlzLm1heE9ydGhvZ3JhcGhpY1NpemUgPSBqc29uLm1heE9ydGhvZ3JhcGhpY1NpemU7XG5cbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IENhbWVyYTJEO1xuIiwidmFyIENsYXNzID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvY2xhc3NcIik7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL3V0aWxcIik7XG52YXIgTG9nID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvbG9nXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGNhbWVsaXplID0gdXRpbC5jYW1lbGl6ZTtcblxuXG5mdW5jdGlvbiBDb21wb25lbnQodHlwZSwgb3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG4gICAgaWYgKCF0eXBlKSBMb2cuZXJyb3IoXCJDb21wb25lbnQgZGVmaW5lZCB3aXRob3V0IGEgdHlwZSwgdXNlIENvbXBvbmVudC5jYWxsKHRoaXMsIFxcXCJDb21wb25lbnROYW1lXFxcIiwgeyBzeW5jOiBCb29sZWFuLCBqc29uOiBCb29sZWFuIH0pXCIpO1xuXG4gICAgQ2xhc3MuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMuX3R5cGUgPSB0eXBlIHx8IFwiVW5rbm93bkNvbXBvbmVudFwiO1xuICAgIHRoaXMuX25hbWUgPSBjYW1lbGl6ZSh0aGlzLl90eXBlLCB0cnVlKTtcblxuICAgIHRoaXMuc3luYyA9IG9wdHMuc3luYyAhPSB1bmRlZmluZWQgPyAhIW9wdHMuc3luYyA6IGZhbHNlO1xuICAgIHRoaXMuanNvbiA9IG9wdHMuanNvbiAhPSB1bmRlZmluZWQgPyAhIW9wdHMuanNvbiA6IHRydWU7XG5cbiAgICB0aGlzLmdhbWVPYmplY3QgPSB1bmRlZmluZWQ7XG59XG5cbkNsYXNzLmV4dGVuZChDb21wb25lbnQpO1xuXG5cbkNvbXBvbmVudC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy5zeW5jID0gb3RoZXIuc3luYztcbiAgICB0aGlzLmpzb24gPSBvdGhlci5qc29uO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkNvbXBvbmVudC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5Db21wb25lbnQucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkNvbXBvbmVudC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuXG59O1xuXG5cbkNvbXBvbmVudC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLm9mZigpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkNvbXBvbmVudC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuZ2FtZU9iamVjdCkge1xuICAgICAgICBMb2cuZXJyb3IoXCJDb21wb25lbnQuZGVzdHJveTogY2FuJ3QgZGVzdHJveSBDb21wb25lbnQgaWYgaXQncyBub3QgYWRkZWQgdG8gYSBHYW1lT2JqZWN0XCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICB0aGlzLmdhbWVPYmplY3QucmVtb3ZlQ29tcG9uZW50KHRoaXMpO1xuICAgIHRoaXMuZW1pdChcImRlc3Ryb3lcIik7XG5cbiAgICB0aGlzLmNsZWFyKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuQ29tcG9uZW50LnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmdhbWVPYmplY3QpIHtcbiAgICAgICAgTG9nLmVycm9yKFwiQ29tcG9uZW50LnJlbW92ZTogY2FuJ3QgcmVtb3ZlIENvbXBvbmVudCBpZiBpdCdzIG5vdCBhZGRlZCB0byBhIEdhbWVPYmplY3RcIik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHRoaXMuZ2FtZU9iamVjdC5yZW1vdmVDb21wb25lbnQodGhpcywgdHJ1ZSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkNvbXBvbmVudC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gQ2xhc3MucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi5fdHlwZSA9IHRoaXMuX3R5cGU7XG4gICAganNvbi5zeW5jID0gdGhpcy5zeW5jO1xuICAgIGpzb24uanNvbiA9IHRoaXMuanNvbjtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5Db21wb25lbnQucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBDbGFzcy5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIHRoaXMuc3luYyA9IGpzb24uc3luYztcbiAgICB0aGlzLmpzb24gPSBqc29uLmpzb247XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBDb21wb25lbnQ7XG4iLCJ2YXIgQ29tcG9uZW50ID0gcmVxdWlyZShcIi4vY29tcG9uZW50XCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gR1VJRWxlbWVudCh0eXBlLCBvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIENvbXBvbmVudC5jYWxsKHRoaXMsIHR5cGUgfHwgXCJHVUlFbGVtZW50XCIsIG9wdHMpO1xufVxuXG5Db21wb25lbnQuZXh0ZW5kKEdVSUVsZW1lbnQpO1xuXG5cbm1vZHVsZS5leHBvcnRzID0gR1VJRWxlbWVudDtcbiIsInZhciBSZWN0ID0gcmVxdWlyZShcIi4uLy4uL21hdGgvcmVjdFwiKTtcbnZhciBDb2xvciA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL2NvbG9yXCIpO1xudmFyIEVudW1zID0gcmVxdWlyZShcIi4uL2VudW1zXCIpO1xudmFyIEFzc2V0cyA9IHJlcXVpcmUoXCIuLi9hc3NldHMvYXNzZXRzXCIpO1xudmFyIEdVSUVsZW1lbnQgPSByZXF1aXJlKFwiLi9ndWlfZWxlbWVudFwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBGb250U3R5bGUgPSBFbnVtcy5Gb250U3R5bGUsXG4gICAgVGV4dEFuY2hvciA9IEVudW1zLlRleHRBbmNob3I7XG5cblxuZnVuY3Rpb24gR1VJVGV4dChvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIEdVSUVsZW1lbnQuY2FsbCh0aGlzLCBcIkdVSVRleHRcIiwgb3B0cyk7XG5cbiAgICB0aGlzLnRleHQgPSBvcHRzLnRleHQgIT0gdW5kZWZpbmVkID8gb3B0cy50ZXh0IDogXCJcIjtcblxuICAgIHRoaXMuZm9udCA9IG9wdHMuZm9udCB8fCBcIkFyaWFsXCI7XG4gICAgdGhpcy5mb250U2l6ZSA9IG9wdHMuZm9udFNpemUgfHwgMTY7XG4gICAgdGhpcy5mb250U3R5bGUgPSBvcHRzLmZvbnRTdHlsZSB8fCBGb250U3R5bGUuTm9ybWFsO1xuICAgIHRoaXMubGluZUhlaWdodCA9IG9wdHMubGluZUhlaWdodCB8fCAyNDtcbiAgICB0aGlzLmxpbmVTcGFjaW5nID0gb3B0cy5saW5lU3BhY2luZyB8fCAwO1xuXG4gICAgdGhpcy5jb2xvciA9IG9wdHMuY29sb3IgIT0gdW5kZWZpbmVkID8gb3B0cy5jb2xvciA6IG5ldyBDb2xvcigxLCAxLCAxKTtcbiAgICB0aGlzLm9mZnNldCA9IG9wdHMub2Zmc2V0ICE9IHVuZGVmaW5lZCA/IG9wdHMub2Zmc2V0IDogbmV3IFZlYzI7XG5cbiAgICB0aGlzLmFsaWdubWVudCA9IG9wdHMuYWxpZ25tZW50IHx8IFRleHRBbmNob3IuTWlkZGxlTGVmdDtcbn1cblxuR1VJRWxlbWVudC5leHRlbmQoR1VJVGV4dCk7XG5cblxuR1VJVGV4dC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy50ZXh0ID0gb3RoZXIudGV4dDtcblxuICAgIHRoaXMuZm9udCA9IG90aGVyLmZvbnQ7XG4gICAgdGhpcy5mb250U2l6ZSA9IG90aGVyLmZvbnRTaXplO1xuICAgIHRoaXMuZm9udFN0eWxlID0gb3RoZXIuZm9udFN0eWxlO1xuICAgIHRoaXMubGluZUhlaWdodCA9IG90aGVyLmxpbmVIZWlnaHQ7XG4gICAgdGhpcy5saW5lU3BhY2luZyA9IG90aGVyLmxpbmVTcGFjaW5nO1xuXG4gICAgdGhpcy5jb2xvci5jb3B5KG90aGVyLmNvbG9yKTtcbiAgICB0aGlzLm9mZnNldC5jb3B5KG90aGVyLm9mZnNldCk7XG5cbiAgICB0aGlzLmFsaWdubWVudCA9IG90aGVyLmFsaWdubWVudDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUlUZXh0LnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBHVUlFbGVtZW50LnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIGpzb24udGV4dCA9IHRoaXMudGV4dDtcblxuICAgIGpzb24uZm9udCA9IHRoaXMuZm9udDtcbiAgICBqc29uLmZvbnRTaXplID0gdGhpcy5mb250U2l6ZTtcbiAgICBqc29uLmZvbnRTdHlsZSA9IHRoaXMuZm9udFN0eWxlO1xuICAgIGpzb24ubGluZUhlaWdodCA9IHRoaXMubGluZUhlaWdodDtcbiAgICBqc29uLmxpbmVTcGFjaW5nID0gdGhpcy5saW5lU3BhY2luZztcblxuICAgIGpzb24uY29sb3IgPSB0aGlzLmNvbG9yLnRvSlNPTihqc29uLmNvbG9yKTtcbiAgICBqc29uLm9mZnNldCA9IHRoaXMub2Zmc2V0LnRvSlNPTihqc29uLm9mZnNldCk7XG5cbiAgICBqc29uLmFsaWdubWVudCA9IHRoaXMuYWxpZ25tZW50O1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbkdVSVRleHQucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBHVUlFbGVtZW50LnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy50ZXh0ID0ganNvbi50ZXh0O1xuXG4gICAgdGhpcy5mb250ID0ganNvbi5mb250O1xuICAgIHRoaXMuZm9udFNpemUgPSBqc29uLmZvbnRTaXplO1xuICAgIHRoaXMuZm9udFN0eWxlID0ganNvbi5mb250U3R5bGU7XG4gICAgdGhpcy5saW5lSGVpZ2h0ID0ganNvbi5saW5lSGVpZ2h0O1xuICAgIHRoaXMubGluZVNwYWNpbmcgPSBqc29uLmxpbmVTcGFjaW5nO1xuXG4gICAgdGhpcy5jb2xvci5mcm9tSlNPTihqc29uLmNvbG9yKTtcbiAgICB0aGlzLm9mZnNldC5mcm9tSlNPTihqc29uLm9mZnNldCk7XG5cbiAgICB0aGlzLmFsaWdubWVudCA9IHRoaXMuYWxpZ25tZW50O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gR1VJVGV4dDtcbiIsInZhciBSZWN0ID0gcmVxdWlyZShcIi4uLy4uL21hdGgvcmVjdFwiKTtcbnZhciBDb2xvciA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL2NvbG9yXCIpO1xudmFyIEFzc2V0cyA9IHJlcXVpcmUoXCIuLi9hc3NldHMvYXNzZXRzXCIpO1xudmFyIEdVSUVsZW1lbnQgPSByZXF1aXJlKFwiLi9ndWlfZWxlbWVudFwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIEdVSVRleHR1cmUob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBHVUlFbGVtZW50LmNhbGwodGhpcywgXCJHVUlUZXh0dXJlXCIsIG9wdHMpO1xuXG4gICAgdGhpcy50ZXh0dXJlID0gb3B0cy50ZXh0dXJlO1xuICAgIHRoaXMuY29sb3IgPSBvcHRzLmNvbG9yICE9IHVuZGVmaW5lZCA/IG9wdHMuY29sb3IgOiBuZXcgQ29sb3IoMSwgMSwgMSk7XG4gICAgdGhpcy5wb3NpdGlvbiA9IG9wdHMucG9zaXRpb24gIT0gdW5kZWZpbmVkID8gb3B0cy5wb3NpdGlvbiA6IG5ldyBSZWN0O1xuXG4gICAgdGhpcy54ID0gb3B0cy54IHx8IDA7XG4gICAgdGhpcy55ID0gb3B0cy55IHx8IDA7XG4gICAgdGhpcy53ID0gb3B0cy53IHx8IDE7XG4gICAgdGhpcy5oID0gb3B0cy5oIHx8IDE7XG5cbiAgICB0aGlzLmFscGhhID0gb3B0cy5hbHBoYSAhPSB1bmRlZmluZWQgPyBvcHRzLmFscGhhIDogMTtcbn1cblxuR1VJRWxlbWVudC5leHRlbmQoR1VJVGV4dHVyZSk7XG5cblxuR1VJVGV4dHVyZS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy50ZXh0dXJlID0gb3RoZXIudGV4dHVyZTtcbiAgICB0aGlzLmNvbG9yLmNvcHkob3RoZXIuY29sb3IpO1xuICAgIHRoaXMucG9zaXRpb24uY29weShvdGhlci5wb3NpdGlvbik7XG5cbiAgICB0aGlzLnggPSBvdGhlci54O1xuICAgIHRoaXMueSA9IG90aGVyLnk7XG4gICAgdGhpcy53ID0gb3RoZXIudztcbiAgICB0aGlzLmggPSBvdGhlci5oO1xuXG4gICAgdGhpcy5hbHBoYSA9IG90aGVyLmFscGhhO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdVSVRleHR1cmUucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgIEdVSUVsZW1lbnQucHJvdG90eXBlLmNsZWFyLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLnRleHR1cmUgPSB1bmRlZmluZWQ7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR1VJVGV4dHVyZS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gR1VJRWxlbWVudC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICBqc29uLnRleHR1cmUgPSB0aGlzLnRleHR1cmUgPyB0aGlzLnRleHR1cmUubmFtZSA6IHVuZGVmaW5lZDtcbiAgICBqc29uLmNvbG9yID0gdGhpcy5jb2xvci50b0pTT04oanNvbi5jb2xvcik7XG4gICAganNvbi5wb3NpdGlvbiA9IHRoaXMucG9zaXRpb24udG9KU09OKGpzb24ucG9zaXRpb24pO1xuXG4gICAganNvbi54ID0gdGhpcy54O1xuICAgIGpzb24ueSA9IHRoaXMueTtcbiAgICBqc29uLncgPSB0aGlzLnc7XG4gICAganNvbi5oID0gdGhpcy5oO1xuXG4gICAganNvbi5hbHBoYSA9IHRoaXMuYWxwaGE7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuR1VJVGV4dHVyZS5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIEdVSUVsZW1lbnQucHJvdG90eXBlLmZyb21KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICB0aGlzLnRleHR1cmUgPSBqc29uLnRleHR1cmUgPyBBc3NldHMuZ2V0KGpzb24udGV4dHVyZSkgOiB1bmRlZmluZWQ7XG4gICAgdGhpcy5jb2xvci5mcm9tSlNPTihqc29uLmNvbG9yKTtcbiAgICB0aGlzLnBvc2l0aW9uLmZyb21KU09OKGpzb24ucG9zaXRpb24pO1xuXG4gICAgdGhpcy54ID0ganNvbi54O1xuICAgIHRoaXMueSA9IGpzb24ueTtcbiAgICB0aGlzLncgPSBqc29uLnc7XG4gICAgdGhpcy5oID0ganNvbi5oO1xuXG4gICAgdGhpcy5hbHBoYSA9IGpzb24uYWxwaGE7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBHVUlUZXh0dXJlO1xuIiwidmFyIEVudW1zID0gcmVxdWlyZShcIi4uL2VudW1zXCIpO1xudmFyIFZlYzMgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWMzXCIpO1xudmFyIENvbG9yID0gcmVxdWlyZShcIi4uLy4uL21hdGgvY29sb3JcIik7XG52YXIgQ29tcG9uZW50ID0gcmVxdWlyZShcIi4vY29tcG9uZW50XCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGNvcyA9IE1hdGguY29zLFxuICAgIGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuXG5cbmZ1bmN0aW9uIExpZ2h0KG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQ29tcG9uZW50LmNhbGwodGhpcywgXCJMaWdodFwiLCBvcHRzKTtcblxuICAgIHRoaXMudHlwZSA9IG9wdHMudHlwZSAhPSB1bmRlZmluZWQgPyBvcHRzLnR5cGUgOiBFbnVtcy5MaWdodFR5cGUuUG9pbnQ7XG5cbiAgICB0aGlzLnZpc2libGUgPSBvcHRzLnZpc2libGUgIT0gdW5kZWZpbmVkID8gISFvcHRzLnZpc2libGUgOiB0cnVlO1xuICAgIHRoaXMub25seVNoYWRvdyA9IG9wdHMub25seVNoYWRvdyAhPSB1bmRlZmluZWQgPyAhIW9wdHMub25seVNoYWRvdyA6IGZhbHNlO1xuICAgIHRoaXMuY2FzdFNoYWRvdyA9IG9wdHMuY2FzdFNoYWRvdyAhPSB1bmRlZmluZWQgPyAhIW9wdHMuY2FzdFNoYWRvdyA6IHRydWU7XG5cbiAgICB0aGlzLmNvbG9yID0gb3B0cy5jb2xvciAhPSB1bmRlZmluZWQgPyBvcHRzLmNvbG9yIDogbmV3IENvbG9yKDEsIDEsIDEpO1xuICAgIHRoaXMuZW5lcmd5ID0gb3B0cy5lbmVyZ3kgIT0gdW5kZWZpbmVkID8gb3B0cy5lbmVyZ3kgOiAxO1xuICAgIHRoaXMuZGlzdGFuY2UgPSBvcHRzLmRpc3RhbmNlICE9IHVuZGVmaW5lZCA/IG9wdHMuZGlzdGFuY2UgOiAwO1xuXG4gICAgdGhpcy5fYW5nbGVDb3MgPSAwO1xuICAgIHRoaXMuX2FuZ2xlID0gMDtcbiAgICB0aGlzLmFuZ2xlID0gb3B0cy5hbmdsZSAhPSB1bmRlZmluZWQgPyBvcHRzLmFuZ2xlIDogTWF0aC5QSSAqIDAuMDYyNTtcbiAgICB0aGlzLmV4cG9uZW50ID0gb3B0cy5leHBvbmVudCAhPSB1bmRlZmluZWQgPyBvcHRzLmV4cG9uZW50IDogMTA7XG5cbiAgICB0aGlzLnRhcmdldCA9IG9wdHMudGFyZ2V0ICE9IHVuZGVmaW5lZCA/IG9wdHMudGFyZ2V0IDogbmV3IFZlYzM7XG59XG5cbkNvbXBvbmVudC5leHRlbmQoTGlnaHQpO1xuXG5cbmRlZmluZVByb3BlcnR5KExpZ2h0LnByb3RvdHlwZSwgXCJhbmdsZVwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hbmdsZTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2FuZ2xlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX2FuZ2xlQ29zID0gY29zKHZhbHVlKTtcbiAgICB9XG59KTtcblxuXG5MaWdodC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy50eXBlID0gb3RoZXIudHlwZTtcblxuICAgIHRoaXMudmlzaWJsZSA9IG90aGVyLnZpc2libGU7XG4gICAgdGhpcy5vbmx5U2hhZG93ID0gb3RoZXIub25seVNoYWRvdztcbiAgICB0aGlzLmNhc3RTaGFkb3cgPSBvdGhlci5jYXN0U2hhZG93O1xuXG4gICAgdGhpcy5jb2xvci5jb3B5KG90aGVyLmNvbG9yKTtcbiAgICB0aGlzLmVuZXJneSA9IG90aGVyLmVuZXJneTtcbiAgICB0aGlzLmRpc3RhbmNlID0gb3RoZXIuZGlzdGFuY2U7XG4gICAgdGhpcy5hbmdsZSA9IG90aGVyLmFuZ2xlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkxpZ2h0LnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDb21wb25lbnQucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi50eXBlID0gdGhpcy50eXBlO1xuXG4gICAganNvbi52aXNpYmxlID0gdGhpcy52aXNpYmxlO1xuICAgIGpzb24ub25seVNoYWRvdyA9IHRoaXMub25seVNoYWRvdztcbiAgICBqc29uLmNhc3RTaGFkb3cgPSB0aGlzLmNhc3RTaGFkb3c7XG5cbiAgICBqc29uLmNvbG9yID0gdGhpcy5jb2xvci50b0pTT04oanNvbi5jb2xvcik7XG4gICAganNvbi5lbmVyZ3kgPSB0aGlzLmVuZXJneTtcbiAgICBqc29uLmRpc3RhbmNlID0gdGhpcy5kaXN0YW5jZTtcbiAgICBqc29uLmFuZ2xlID0gdGhpcy5hbmdsZTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5MaWdodC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENvbXBvbmVudC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIHRoaXMudHlwZSA9IGpzb24udHlwZTtcblxuICAgIHRoaXMudmlzaWJsZSA9IGpzb24udmlzaWJsZTtcbiAgICB0aGlzLm9ubHlTaGFkb3cgPSBqc29uLm9ubHlTaGFkb3c7XG4gICAgdGhpcy5jYXN0U2hhZG93ID0ganNvbi5jYXN0U2hhZG93O1xuXG4gICAgdGhpcy5jb2xvci5mcm9tSlNPTihqc29uLmNvbG9yKTtcbiAgICB0aGlzLmVuZXJneSA9IGpzb24uZW5lcmd5O1xuICAgIHRoaXMuZGlzdGFuY2UgPSBqc29uLmRpc3RhbmNlO1xuICAgIHRoaXMuYW5nbGUgPSBqc29uLmFuZ2xlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gTGlnaHQ7XG4iLCJ2YXIgVGltZSA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL3RpbWVcIik7XG52YXIgTWF0aGYgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9tYXRoZlwiKTtcbnZhciBNYXQ0ID0gcmVxdWlyZShcIi4uLy4uL21hdGgvbWF0NFwiKTtcbnZhciBWZWMzID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjM1wiKTtcbnZhciBRdWF0ID0gcmVxdWlyZShcIi4uLy4uL21hdGgvcXVhdFwiKTtcbnZhciBBc3NldHMgPSByZXF1aXJlKFwiLi4vYXNzZXRzL2Fzc2V0c1wiKTtcbnZhciBDb21wb25lbnQgPSByZXF1aXJlKFwiLi9jb21wb25lbnRcIik7XG52YXIgRW51bXMgPSByZXF1aXJlKFwiLi4vZW51bXNcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgY2xhbXAwMSA9IE1hdGhmLmNsYW1wMDEsXG4gICAgYWJzID0gTWF0aC5hYnMsXG4gICAgV3JhcE1vZGUgPSBFbnVtcy5XcmFwTW9kZTtcblxuXG5mdW5jdGlvbiBNZXNoQW5pbWF0aW9uKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQ29tcG9uZW50LmNhbGwodGhpcywgXCJNZXNoQW5pbWF0aW9uXCIsIG9wdHMpO1xuXG4gICAgdGhpcy5jdXJyZW50ID0gb3B0cy5jdXJyZW50ICE9IHVuZGVmaW5lZCA/IG9wdHMuY3VycmVudCA6IFwiaWRsZVwiO1xuICAgIHRoaXMubW9kZSA9IG9wdHMubW9kZSAhPSB1bmRlZmluZWQgPyBvcHRzLm1vZGUgOiBXcmFwTW9kZS5Mb29wO1xuXG4gICAgdGhpcy5yYXRlID0gb3B0cy5yYXRlICE9IHVuZGVmaW5lZCA/IG9wdHMucmF0ZSA6IDEgLyAyNDtcblxuICAgIHRoaXMuX3RpbWUgPSAwO1xuICAgIHRoaXMuX2ZyYW1lID0gMDtcbiAgICB0aGlzLl9sYXN0RnJhbWUgPSAwO1xuICAgIHRoaXMuX29yZGVyID0gMTtcblxuICAgIHRoaXMucGxheWluZyA9IHRoaXMuc2hlZXQgPyB0cnVlIDogZmFsc2U7XG59XG5cbkNvbXBvbmVudC5leHRlbmQoTWVzaEFuaW1hdGlvbik7XG5cblxuTWVzaEFuaW1hdGlvbi5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy5jdXJyZW50ID0gb3RoZXIuY3VycmVudDtcbiAgICB0aGlzLm1vZGUgPSBvdGhlci5tb2RlO1xuXG4gICAgdGhpcy5yYXRlID0gb3RoZXIucmF0ZTtcblxuICAgIHRoaXMuX3RpbWUgPSBvdGhlci5fdGltZTtcbiAgICB0aGlzLl9mcmFtZSA9IG90aGVyLl9mcmFtZTtcbiAgICB0aGlzLl9sYXN0RnJhbWUgPSBvdGhlci5fbGFzdEZyYW1lO1xuICAgIHRoaXMuX29yZGVyID0gb3RoZXIuX29yZGVyO1xuXG4gICAgdGhpcy5wbGF5aW5nID0gb3RoZXIucGxheWluZztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5NZXNoQW5pbWF0aW9uLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKG5hbWUsIG1vZGUsIHJhdGUpIHtcbiAgICB2YXIgbWVzaEZpbHRlciA9IHRoaXMubWVzaEZpbHRlcjtcbiAgICBpZiAoKHRoaXMucGxheWluZyAmJiB0aGlzLmN1cnJlbnQgPT09IG5hbWUpIHx8ICFtZXNoRmlsdGVyIHx8ICFtZXNoRmlsdGVyLm1lc2guYW5pbWF0aW9uc1tuYW1lXSkgcmV0dXJuIHRoaXM7XG5cbiAgICB0aGlzLmN1cnJlbnQgPSBuYW1lO1xuICAgIHRoaXMucmF0ZSA9IHJhdGUgIT0gdW5kZWZpbmVkID8gcmF0ZSA6IChyYXRlID0gdGhpcy5yYXRlKTtcbiAgICB0aGlzLm1vZGUgPSBtb2RlIHx8IChtb2RlID0gdGhpcy5tb2RlKTtcbiAgICB0aGlzLl9mcmFtZSA9IDA7XG4gICAgdGhpcy5fbGFzdEZyYW1lID0gMDtcbiAgICB0aGlzLl9vcmRlciA9IDE7XG4gICAgdGhpcy5fdGltZSA9IDA7XG5cbiAgICB0aGlzLnBsYXlpbmcgPSB0cnVlO1xuICAgIHRoaXMuZW1pdChcInBsYXlcIiwgbmFtZSwgbW9kZSwgcmF0ZSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuTWVzaEFuaW1hdGlvbi5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIGlmICh0aGlzLnBsYXlpbmcpIHRoaXMuZW1pdChcInN0b3BcIik7XG4gICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7XG4gICAgdGhpcy5fZnJhbWUgPSAwO1xuICAgIHRoaXMuX2xhc3RGcmFtZSA9IDA7XG4gICAgdGhpcy5fb3JkZXIgPSAxO1xuICAgIHRoaXMuX3RpbWUgPSAwO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbnZhciBQT1NJVElPTiA9IG5ldyBWZWMzLFxuICAgIExBU1RfUE9TSVRJT04gPSBuZXcgVmVjMyxcbiAgICBST1RBVElPTiA9IG5ldyBRdWF0LFxuICAgIExBU1RfUk9UQVRJT04gPSBuZXcgUXVhdCxcbiAgICBTQ0FMRSA9IG5ldyBWZWMzLFxuICAgIExBU1RfU0NBTEUgPSBuZXcgVmVjMyxcbiAgICBNQVQ0ID0gbmV3IE1hdDQ7XG5cbk1lc2hBbmltYXRpb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMucGxheWluZykgcmV0dXJuO1xuICAgIHZhciBtZXNoRmlsdGVyID0gdGhpcy5tZXNoRmlsdGVyLFxuICAgICAgICBtZXNoQm9uZXMsIG1lc2gsIGJvbmVzTGVuZ3RoLCBhbHBoYSA9IDAuMCxcbiAgICAgICAgYm9uZUN1cnJlbnQsIGJvbmVUcmFuc2Zvcm0sIHVuaWZvcm0sIHBhcmVudEluZGV4LCBib25lRnJhbWUsIGxhc3RCb25lRnJhbWUsIHBvcywgcm90LCBzY2wsXG4gICAgICAgIGN1cnJlbnQsIGR0LCBjb3VudCwgbGVuZ3RoLCBvcmRlciwgZnJhbWUsIGxhc3RGcmFtZSwgbW9kZSwgZnJhbWVTdGF0ZSwgbGFzdEZyYW1lU3RhdGUsIGk7XG5cbiAgICBpZiAoIW1lc2hGaWx0ZXIpIHJldHVybjtcbiAgICBtZXNoQm9uZXMgPSBtZXNoRmlsdGVyLl9ib25lcztcblxuICAgIG1lc2ggPSBtZXNoRmlsdGVyLm1lc2g7XG4gICAgaWYgKCFtZXNoKSByZXR1cm47XG5cbiAgICBpZiAoIShib25lc0xlbmd0aCA9IG1lc2hCb25lcy5sZW5ndGgpKSByZXR1cm47XG4gICAgaSA9IGJvbmVzTGVuZ3RoO1xuXG4gICAgY3VycmVudCA9IG1lc2guYW5pbWF0aW9uc1t0aGlzLmN1cnJlbnRdO1xuICAgIGlmICghY3VycmVudCkgcmV0dXJuO1xuXG4gICAgZHQgPSBUaW1lLmRlbHRhO1xuICAgIG9yZGVyID0gdGhpcy5fb3JkZXI7XG4gICAgZnJhbWUgPSB0aGlzLl9mcmFtZTtcbiAgICBsYXN0RnJhbWUgPSB0aGlzLl9sYXN0RnJhbWU7XG4gICAgbW9kZSA9IHRoaXMubW9kZTtcblxuICAgIGlmICghdGhpcy5yYXRlIHx8IHRoaXMucmF0ZSA9PT0gSW5maW5pdHkgfHwgdGhpcy5yYXRlIDwgMCkge1xuICAgICAgICBmcmFtZSA9IGFicyhmcmFtZSkgJSBjdXJyZW50Lmxlbmd0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl90aW1lICs9IGR0O1xuICAgICAgICBjb3VudCA9IHRoaXMuX3RpbWUgLyB0aGlzLnJhdGU7XG4gICAgICAgIGFscGhhID0gY291bnQ7XG5cbiAgICAgICAgaWYgKGNvdW50ID49IDEpIHtcbiAgICAgICAgICAgIGxhc3RGcmFtZSA9IGZyYW1lO1xuICAgICAgICAgICAgYWxwaGEgPSAwLjA7XG5cbiAgICAgICAgICAgIHRoaXMuX3RpbWUgPSAwO1xuICAgICAgICAgICAgbGVuZ3RoID0gY3VycmVudC5sZW5ndGg7XG4gICAgICAgICAgICBmcmFtZSArPSAob3JkZXIgKiAoY291bnQgfCAwKSk7XG5cbiAgICAgICAgICAgIGlmIChtb2RlID09PSBXcmFwTW9kZS5Mb29wKSB7XG4gICAgICAgICAgICAgICAgZnJhbWUgPSBmcmFtZSAlIGxlbmd0aDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gV3JhcE1vZGUuT25jZSkge1xuICAgICAgICAgICAgICAgIGlmIChvcmRlciA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZyYW1lID49IGxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUgPSBsZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnJhbWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFtZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gV3JhcE1vZGUuUGluZ1BvbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAob3JkZXIgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmcmFtZSA+PSBsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29yZGVyID0gLTE7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFtZSA9IGxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnJhbWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vcmRlciA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFtZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1vZGUgPT09IFdyYXBNb2RlLkNsYW1wKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9yZGVyID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnJhbWUgPj0gbGVuZ3RoKSBmcmFtZSA9IGxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZyYW1lIDwgMCkgZnJhbWUgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFscGhhID0gY2xhbXAwMShhbHBoYSk7XG4gICAgZnJhbWVTdGF0ZSA9IGN1cnJlbnRbZnJhbWVdO1xuICAgIGxhc3RGcmFtZVN0YXRlID0gY3VycmVudFtsYXN0RnJhbWVdIHx8IGZyYW1lU3RhdGU7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGJvbmVDdXJyZW50ID0gbWVzaEJvbmVzW2ldO1xuXG4gICAgICAgIGJvbmVUcmFuc2Zvcm0gPSBib25lQ3VycmVudC50cmFuc2Zvcm07XG4gICAgICAgIHVuaWZvcm0gPSBib25lQ3VycmVudC51bmlmb3JtO1xuICAgICAgICBwYXJlbnRJbmRleCA9IGJvbmVDdXJyZW50LnBhcmVudEluZGV4O1xuICAgICAgICBwb3MgPSBib25lVHJhbnNmb3JtLnBvc2l0aW9uO1xuICAgICAgICByb3QgPSBib25lVHJhbnNmb3JtLnJvdGF0aW9uO1xuICAgICAgICBzY2wgPSBib25lVHJhbnNmb3JtLnNjYWxlO1xuXG4gICAgICAgIGJvbmVGcmFtZSA9IGZyYW1lU3RhdGVbaV07XG4gICAgICAgIGxhc3RCb25lRnJhbWUgPSBsYXN0RnJhbWVTdGF0ZVtpXTtcblxuICAgICAgICBMQVNUX1BPU0lUSU9OLnggPSBsYXN0Qm9uZUZyYW1lWzBdO1xuICAgICAgICBMQVNUX1BPU0lUSU9OLnkgPSBsYXN0Qm9uZUZyYW1lWzFdO1xuICAgICAgICBMQVNUX1BPU0lUSU9OLnogPSBsYXN0Qm9uZUZyYW1lWzJdO1xuXG4gICAgICAgIExBU1RfUk9UQVRJT04ueCA9IGxhc3RCb25lRnJhbWVbM107XG4gICAgICAgIExBU1RfUk9UQVRJT04ueSA9IGxhc3RCb25lRnJhbWVbNF07XG4gICAgICAgIExBU1RfUk9UQVRJT04ueiA9IGxhc3RCb25lRnJhbWVbNV07XG4gICAgICAgIExBU1RfUk9UQVRJT04udyA9IGxhc3RCb25lRnJhbWVbNl07XG5cbiAgICAgICAgTEFTVF9TQ0FMRS54ID0gbGFzdEJvbmVGcmFtZVs3XTtcbiAgICAgICAgTEFTVF9TQ0FMRS55ID0gbGFzdEJvbmVGcmFtZVs4XTtcbiAgICAgICAgTEFTVF9TQ0FMRS56ID0gbGFzdEJvbmVGcmFtZVs5XTtcblxuICAgICAgICBQT1NJVElPTi54ID0gYm9uZUZyYW1lWzBdO1xuICAgICAgICBQT1NJVElPTi55ID0gYm9uZUZyYW1lWzFdO1xuICAgICAgICBQT1NJVElPTi56ID0gYm9uZUZyYW1lWzJdO1xuXG4gICAgICAgIFJPVEFUSU9OLnggPSBib25lRnJhbWVbM107XG4gICAgICAgIFJPVEFUSU9OLnkgPSBib25lRnJhbWVbNF07XG4gICAgICAgIFJPVEFUSU9OLnogPSBib25lRnJhbWVbNV07XG4gICAgICAgIFJPVEFUSU9OLncgPSBib25lRnJhbWVbNl07XG5cbiAgICAgICAgU0NBTEUueCA9IGJvbmVGcmFtZVs3XTtcbiAgICAgICAgU0NBTEUueSA9IGJvbmVGcmFtZVs4XTtcbiAgICAgICAgU0NBTEUueiA9IGJvbmVGcmFtZVs5XTtcblxuICAgICAgICBwb3MudmxlcnAoTEFTVF9QT1NJVElPTiwgUE9TSVRJT04sIGFscGhhKTtcbiAgICAgICAgcm90LnFsZXJwKExBU1RfUk9UQVRJT04sIFJPVEFUSU9OLCBhbHBoYSk7XG4gICAgICAgIHNjbC52bGVycChMQVNUX1NDQUxFLCBTQ0FMRSwgYWxwaGEpO1xuICAgIH1cblxuICAgIHRoaXMuX2ZyYW1lID0gZnJhbWU7XG4gICAgdGhpcy5fbGFzdEZyYW1lID0gbGFzdEZyYW1lO1xufTtcblxuXG5NZXNoQW5pbWF0aW9uLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDb21wb25lbnQucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi5jdXJyZW50ID0gdGhpcy5jdXJyZW50O1xuICAgIGpzb24ubW9kZSA9IHRoaXMubW9kZTtcblxuICAgIGpzb24ucmF0ZSA9IHRoaXMucmF0ZTtcblxuICAgIGpzb24uX3RpbWUgPSB0aGlzLl90aW1lO1xuICAgIGpzb24uX2ZyYW1lID0gdGhpcy5fZnJhbWU7XG4gICAganNvbi5fb3JkZXIgPSB0aGlzLl9vcmRlcjtcblxuICAgIGpzb24ucGxheWluZyA9IHRoaXMucGxheWluZztcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5NZXNoQW5pbWF0aW9uLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy5jdXJyZW50ID0ganNvbi5jdXJyZW50O1xuICAgIHRoaXMubW9kZSA9IGpzb24ubW9kZTtcblxuICAgIHRoaXMucmF0ZSA9IGpzb24ucmF0ZTtcblxuICAgIHRoaXMuX3RpbWUgPSBqc29uLl90aW1lO1xuICAgIHRoaXMuX2ZyYW1lID0ganNvbi5fZnJhbWU7XG4gICAgdGhpcy5fb3JkZXIgPSBqc29uLl9vcmRlcjtcblxuICAgIHRoaXMucGxheWluZyA9IGpzb24ucGxheWluZztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IE1lc2hBbmltYXRpb247XG4iLCJ2YXIgQXNzZXRzID0gcmVxdWlyZShcIi4uL2Fzc2V0cy9hc3NldHNcIik7XG52YXIgR2FtZU9iamVjdCA9IHJlcXVpcmUoXCIuLi9nYW1lX29iamVjdFwiKTtcbnZhciBDb21wb25lbnQgPSByZXF1aXJlKFwiLi9jb21wb25lbnRcIik7XG52YXIgQm9uZSA9IHJlcXVpcmUoXCIuL2JvbmVcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG4vKipcbiAqIEBjbGFzcyBNZXNoRmlsdGVyXG4gKiBAZXh0ZW5kcyBDb21wb25lbnRcbiAqIEBicmllZiBiYXNlIGNsYXNzIGZvciBoYW5kbGluZyBtZXNoZXNcbiAqIEBwYXJhbSBPYmplY3Qgb3B0aW9uc1xuICovXG5mdW5jdGlvbiBNZXNoRmlsdGVyKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQ29tcG9uZW50LmNhbGwodGhpcywgXCJNZXNoRmlsdGVyXCIsIG9wdHMpO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE1lc2ggbWVzaFxuICAgICAqIEBtZW1iZXJvZiBNZXNoRmlsdGVyXG4gICAgICovXG4gICAgdGhpcy5tZXNoID0gb3B0cy5tZXNoICE9IHVuZGVmaW5lZCA/IG9wdHMubWVzaCA6IHVuZGVmaW5lZDtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBNYXRlcmlhbCBtYXRlcmlhbFxuICAgICAqIEBtZW1iZXJvZiBNZXNoRmlsdGVyXG4gICAgICovXG4gICAgdGhpcy5tYXRlcmlhbCA9IG9wdHMubWF0ZXJpYWwgIT0gdW5kZWZpbmVkID8gb3B0cy5tYXRlcmlhbCA6IHVuZGVmaW5lZDtcblxuXG4gICAgdGhpcy5fYm9uZXMgPSBbXTtcbiAgICB0aGlzLl93ZWJnbE1lc2hJbml0dGVkID0gZmFsc2U7XG59XG5cbkNvbXBvbmVudC5leHRlbmQoTWVzaEZpbHRlcik7XG5cblxuTWVzaEZpbHRlci5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy5tZXNoID0gb3RoZXIubWVzaDtcbiAgICB0aGlzLm1hdGVyaWFsID0gb3RoZXIubWF0ZXJpYWw7XG5cbiAgICB0aGlzLl9ib25lcy5sZW5ndGggPSAwO1xuICAgIHRoaXMuX3dlYmdsTWVzaEluaXR0ZWQgPSBmYWxzZTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5NZXNoRmlsdGVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0cmFuc2Zvcm0gPSB0aGlzLnRyYW5zZm9ybSxcbiAgICAgICAgYm9uZXMgPSB0aGlzLl9ib25lcyxcbiAgICAgICAgbWVzaEJvbmVzID0gdGhpcy5tZXNoLmJvbmVzLFxuICAgICAgICBzdWJHYW1lT2JqZWN0LCBtZXNoQm9uZSwgYm9uZSwgcGFyZW50LFxuICAgICAgICBpID0gbWVzaEJvbmVzLmxlbmd0aDtcblxuICAgIGlmICghaSkgcmV0dXJuO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBtZXNoQm9uZSA9IG1lc2hCb25lc1tpXTtcblxuICAgICAgICBzdWJHYW1lT2JqZWN0ID0gbmV3IEdhbWVPYmplY3QoKS5hZGRDb21wb25lbnRzKFxuICAgICAgICAgICAgbmV3IEJvbmUoe1xuICAgICAgICAgICAgICAgIG5hbWU6IG1lc2hCb25lLm5hbWUsXG4gICAgICAgICAgICAgICAgcGFyZW50SW5kZXg6IG1lc2hCb25lLnBhcmVudEluZGV4LFxuXG4gICAgICAgICAgICAgICAgc2tpbm5lZDogbWVzaEJvbmUuc2tpbm5lZCxcbiAgICAgICAgICAgICAgICBiaW5kUG9zZTogbWVzaEJvbmUuYmluZFBvc2VcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IFRyYW5zZm9ybSh7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IG1lc2hCb25lLnBvc2l0aW9uLmNsb25lKCksXG4gICAgICAgICAgICAgICAgcm90YXRpb246IG1lc2hCb25lLnJvdGF0aW9uLmNsb25lKCksXG4gICAgICAgICAgICAgICAgc2NhbGU6IG1lc2hCb25lLnNjYWxlLmNsb25lKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICAgIHN1YkdhbWVPYmplY3QubmFtZSA9IG1lc2hCb25lLm5hbWU7XG4gICAgICAgIGJvbmVzW2ldID0gc3ViR2FtZU9iamVjdC5ib25lO1xuICAgIH1cblxuICAgIHRyYW5zZm9ybS5hZGRDaGlsZChib25lc1swXS50cmFuc2Zvcm0pO1xuXG4gICAgaSA9IG1lc2hCb25lcy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBib25lID0gYm9uZXNbaV07XG4gICAgICAgIHBhcmVudCA9IGJvbmVzW2JvbmUucGFyZW50SW5kZXhdO1xuICAgICAgICBpZiAoIXBhcmVudCkgY29udGludWU7XG5cbiAgICAgICAgcGFyZW50LnRyYW5zZm9ybS5hZGRDaGlsZChib25lLnRyYW5zZm9ybSk7XG4gICAgfVxufTtcblxuXG5NZXNoRmlsdGVyLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICBDb21wb25lbnQucHJvdG90eXBlLmNsZWFyLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLm1lc2ggPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5tYXRlcmlhbCA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuX2JvbmVzLmxlbmd0aCA9IDA7XG4gICAgdGhpcy5fd2ViZ2xNZXNoSW5pdHRlZCA9IGZhbHNlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbk1lc2hGaWx0ZXIucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiA9IENvbXBvbmVudC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICBqc29uLm1lc2ggPSB0aGlzLm1lc2ggPyB0aGlzLm1lc2gubmFtZSA6IHVuZGVmaW5lZDtcbiAgICBqc29uLm1hdGVyaWFsID0gdGhpcy5tYXRlcmlhbCA/IHRoaXMubWF0ZXJpYWwubmFtZSA6IHVuZGVmaW5lZDtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5NZXNoRmlsdGVyLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy5tZXNoID0ganNvbi5tZXNoID8gQXNzZXRzLmdldChqc29uLm1lc2gpIDogdW5kZWZpbmVkO1xuICAgIHRoaXMubWF0ZXJpYWwgPSBqc29uLm1hdGVyaWFsID8gQXNzZXRzLmdldChqc29uLm1hdGVyaWFsKSA6IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuX2JvbmVzLmxlbmd0aCA9IDA7XG4gICAgdGhpcy5fd2ViZ2xNZXNoSW5pdHRlZCA9IGZhbHNlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gTWVzaEZpbHRlcjtcbiIsInZhciBEZXZpY2UgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9kZXZpY2VcIik7XG52YXIgTWF0aGYgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9tYXRoZlwiKTtcbnZhciBWZWMyID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjMlwiKTtcbnZhciBWZWMzID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjM1wiKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoXCIuLi9pbnB1dC9pbnB1dFwiKTtcbnZhciBDb21wb25lbnQgPSByZXF1aXJlKFwiLi9jb21wb25lbnRcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgcG93ID0gTWF0aC5wb3csXG4gICAgc3FydCA9IE1hdGguc3FydCxcbiAgICBzaW4gPSBNYXRoLnNpbixcbiAgICBjb3MgPSBNYXRoLmNvcyxcbiAgICB0YW4gPSBNYXRoLnRhbixcbiAgICBhdGFuMiA9IE1hdGguYXRhbjIsXG4gICAgbWluID0gTWF0aC5taW4sXG4gICAgbWF4ID0gTWF0aC5tYXgsXG4gICAgUEkgPSBNYXRoLlBJLFxuICAgIE1JTl9QT0xPUiA9IDAsXG4gICAgTUFYX1BPTE9SID0gUEksXG5cbiAgICBkZWdzVG9SYWRzID0gTWF0aGYuZGVnc1RvUmFkcyxcbiAgICBFUFNJTE9OID0gTWF0aGYuRVBTSUxPTixcblxuICAgIE5PTkUgPSAxLFxuICAgIFJPVEFURSA9IDIsXG4gICAgUEFOID0gMztcblxuXG5mdW5jdGlvbiBPcmJpdENvbnRyb2wob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBDb21wb25lbnQuY2FsbCh0aGlzLCBcIk9yYml0Q29udHJvbFwiLCBvcHRzKTtcblxuICAgIHRoaXMuc3BlZWQgPSBvcHRzLnNwZWVkID4gRVBTSUxPTiA/IG9wdHMuc3BlZWQgOiAxO1xuICAgIHRoaXMuem9vbVNwZWVkID0gb3B0cy56b29tU3BlZWQgPiBFUFNJTE9OID8gb3B0cy56b29tU3BlZWQgOiAyO1xuXG4gICAgdGhpcy5hbGxvd1pvb20gPSBvcHRzLmFsbG93Wm9vbSAhPSB1bmRlZmluZWQgPyAhIW9wdHMuYWxsb3dab29tIDogdHJ1ZTtcbiAgICB0aGlzLmFsbG93UGFuID0gb3B0cy5hbGxvd1BhbiAhPSB1bmRlZmluZWQgPyAhIW9wdHMuYWxsb3dQYW4gOiB0cnVlO1xuICAgIHRoaXMuYWxsb3dSb3RhdGUgPSBvcHRzLmFsbG93Um90YXRlICE9IHVuZGVmaW5lZCA/ICEhb3B0cy5hbGxvd1JvdGF0ZSA6IHRydWU7XG5cbiAgICB0aGlzLnRhcmdldCA9IG9wdHMudGFyZ2V0IHx8IG5ldyBWZWMzO1xuXG4gICAgdGhpcy5fb2Zmc2V0ID0gbmV3IFZlYzM7XG4gICAgdGhpcy5fcGFuID0gbmV3IFZlYzM7XG4gICAgdGhpcy5fc2NhbGUgPSAxO1xuICAgIHRoaXMuX3RoZXRhRGVsdGEgPSAwO1xuICAgIHRoaXMuX3BoaURlbHRhID0gMDtcbiAgICB0aGlzLl9zdGF0ZSA9IE5PTkU7XG59XG5cbkNvbXBvbmVudC5leHRlbmQoT3JiaXRDb250cm9sKTtcblxuXG5PcmJpdENvbnRyb2wucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuT3JiaXRDb250cm9sLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIGlmIChEZXZpY2UubW9iaWxlKSB7XG4gICAgICAgIElucHV0Lm9uKFwidG91Y2hzdGFydFwiLCB0aGlzLm9uVG91Y2hTdGFydCwgdGhpcyk7XG4gICAgICAgIElucHV0Lm9uKFwidG91Y2hlbmRcIiwgdGhpcy5vblRvdWNoRW5kLCB0aGlzKTtcbiAgICAgICAgSW5wdXQub24oXCJ0b3VjaG1vdmVcIiwgdGhpcy5vblRvdWNoTW92ZSwgdGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgSW5wdXQub24oXCJtb3VzZXVwXCIsIHRoaXMub25Nb3VzZVVwLCB0aGlzKTtcbiAgICAgICAgSW5wdXQub24oXCJtb3VzZWRvd25cIiwgdGhpcy5vbk1vdXNlRG93biwgdGhpcyk7XG4gICAgICAgIElucHV0Lm9uKFwibW91c2Vtb3ZlXCIsIHRoaXMub25Nb3VzZU1vdmUsIHRoaXMpO1xuICAgICAgICBJbnB1dC5vbihcIm1vdXNld2hlZWxcIiwgdGhpcy5vbk1vdXNlV2hlZWwsIHRoaXMpO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlT3JiaXQoKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5PcmJpdENvbnRyb2wucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgIENvbXBvbmVudC5wcm90b3R5cGUuY2xlYXIuY2FsbCh0aGlzKTtcblxuICAgIGlmIChEZXZpY2UubW9iaWxlKSB7XG4gICAgICAgIElucHV0Lm9uKFwidG91Y2hzdGFydFwiLCB0aGlzLm9uVG91Y2hTdGFydCwgdGhpcyk7XG4gICAgICAgIElucHV0Lm9uKFwidG91Y2hlbmRcIiwgdGhpcy5vblRvdWNoRW5kLCB0aGlzKTtcbiAgICAgICAgSW5wdXQub24oXCJ0b3VjaG1vdmVcIiwgdGhpcy5vblRvdWNoTW92ZSwgdGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgSW5wdXQub2ZmKFwibW91c2V1cFwiLCB0aGlzLm9uTW91c2VVcCwgdGhpcyk7XG4gICAgICAgIElucHV0Lm9mZihcIm1vdXNlZG93blwiLCB0aGlzLm9uTW91c2VEb3duLCB0aGlzKTtcbiAgICAgICAgSW5wdXQub2ZmKFwibW91c2Vtb3ZlXCIsIHRoaXMub25Nb3VzZU1vdmUsIHRoaXMpO1xuICAgICAgICBJbnB1dC5vZmYoXCJtb3VzZXdoZWVsXCIsIHRoaXMub25Nb3VzZVdoZWVsLCB0aGlzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuT3JiaXRDb250cm9sLnByb3RvdHlwZS5vblRvdWNoU3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxlbmd0aCA9IElucHV0LnRvdWNoZXMubGVuZ3RoO1xuXG4gICAgaWYgKGxlbmd0aCA9PT0gMSkge1xuICAgICAgICB0aGlzLl9zdGF0ZSA9IFJPVEFURTtcbiAgICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gMiAmJiB0aGlzLmFsbG93UGFuKSB7XG4gICAgICAgIHRoaXMuX3N0YXRlID0gUEFOO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3N0YXRlID0gTk9ORTtcbiAgICB9XG59O1xuXG5cbnZhciBMRUZUX01PVVNFID0gXCJtb3VzZTBcIixcbiAgICBNSURETEVfTU9VU0UgPSBcIm1vdXNlMVwiO1xuT3JiaXRDb250cm9sLnByb3RvdHlwZS5vbk1vdXNlRG93biA9IGZ1bmN0aW9uIChidXR0b24pIHtcblxuICAgIGlmIChidXR0b24gPT09IExFRlRfTU9VU0UgJiYgdGhpcy5hbGxvd1JvdGF0ZSkge1xuICAgICAgICB0aGlzLl9zdGF0ZSA9IFJPVEFURTtcbiAgICB9IGVsc2UgaWYgKGJ1dHRvbiA9PT0gTUlERExFX01PVVNFICYmIHRoaXMuYWxsb3dQYW4pIHtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBQQU47XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBOT05FO1xuICAgIH1cbn07XG5cblxuT3JiaXRDb250cm9sLnByb3RvdHlwZS5vblRvdWNoRW5kID0gT3JiaXRDb250cm9sLnByb3RvdHlwZS5vbk1vdXNlVXAgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLl9zdGF0ZSA9IE5PTkU7XG59O1xuXG5cbk9yYml0Q29udHJvbC5wcm90b3R5cGUub25Ub3VjaE1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHVwZGF0ZSA9IGZhbHNlLFxuICAgICAgICB0b3VjaCA9IElucHV0LnRvdWNoZXNbMF0sXG4gICAgICAgIGRlbHRhID0gdG91Y2guZGVsdGEsXG4gICAgICAgIGNhbWVyYTtcblxuICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gUk9UQVRFKSB7XG4gICAgICAgIHVwZGF0ZSA9IHRydWU7XG4gICAgICAgIGNhbWVyYSA9IHRoaXMuY2FtZXJhO1xuXG4gICAgICAgIHRoaXMuX3RoZXRhRGVsdGEgKz0gMiAqIFBJICogZGVsdGEueCAqIGNhbWVyYS5pbnZXaWR0aCAqIHRoaXMuc3BlZWQ7XG4gICAgICAgIHRoaXMuX3BoaURlbHRhIC09IDIgKiBQSSAqIGRlbHRhLnkgKiBjYW1lcmEuaW52SGVpZ2h0ICogdGhpcy5zcGVlZDtcbiAgICB9IGVsc2UgaWYgKHRoaXMuX3N0YXRlID09PSBQQU4pIHtcbiAgICAgICAgdXBkYXRlID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLnBhbihkZWx0YSk7XG4gICAgfVxuXG4gICAgdXBkYXRlICYmIHRoaXMudXBkYXRlT3JiaXQoKTtcbn07XG5cblxuT3JiaXRDb250cm9sLnByb3RvdHlwZS5vbk1vdXNlTW92ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdXBkYXRlID0gZmFsc2UsXG4gICAgICAgIG1vdXNlRGVsdGEgPSBJbnB1dC5tb3VzZURlbHRhLFxuICAgICAgICBjYW1lcmE7XG5cbiAgICBpZiAodGhpcy5fc3RhdGUgPT09IFJPVEFURSkge1xuICAgICAgICB1cGRhdGUgPSB0cnVlO1xuICAgICAgICBjYW1lcmEgPSB0aGlzLmNhbWVyYTtcblxuICAgICAgICB0aGlzLl90aGV0YURlbHRhICs9IDIgKiBQSSAqIG1vdXNlRGVsdGEueCAqIGNhbWVyYS5pbnZXaWR0aCAqIHRoaXMuc3BlZWQ7XG4gICAgICAgIHRoaXMuX3BoaURlbHRhIC09IDIgKiBQSSAqIG1vdXNlRGVsdGEueSAqIGNhbWVyYS5pbnZIZWlnaHQgKiB0aGlzLnNwZWVkO1xuICAgIH0gZWxzZSBpZiAodGhpcy5fc3RhdGUgPT09IFBBTikge1xuICAgICAgICB1cGRhdGUgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMucGFuKG1vdXNlRGVsdGEpO1xuICAgIH1cblxuICAgIHVwZGF0ZSAmJiB0aGlzLnVwZGF0ZU9yYml0KCk7XG59O1xuXG5cbk9yYml0Q29udHJvbC5wcm90b3R5cGUub25Nb3VzZVdoZWVsID0gZnVuY3Rpb24gKG1vdXNlV2hlZWwpIHtcbiAgICBpZiAoIXRoaXMuYWxsb3dab29tKSByZXR1cm47XG4gICAgdmFyIHVwZGF0ZSA9IGZhbHNlO1xuXG4gICAgaWYgKG1vdXNlV2hlZWwgPiAwKSB7XG4gICAgICAgIHVwZGF0ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuX3NjYWxlICo9IHBvdygwLjk1LCB0aGlzLnpvb21TcGVlZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fc2NhbGUgLz0gcG93KDAuOTUsIHRoaXMuem9vbVNwZWVkKTtcbiAgICB9XG5cbiAgICB1cGRhdGUgJiYgdGhpcy51cGRhdGVPcmJpdCgpO1xufTtcblxuXG5PcmJpdENvbnRyb2wucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgIENvbXBvbmVudC5wcm90b3R5cGUuY2xlYXIuY2FsbCh0aGlzKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG52YXIgcGFuT2Zmc2V0ID0gbmV3IFZlYzM7XG5PcmJpdENvbnRyb2wucHJvdG90eXBlLnBhbiA9IGZ1bmN0aW9uIChkZWx0YSkge1xuICAgIHZhciBwYW4gPSB0aGlzLl9wYW4sXG4gICAgICAgIGNhbWVyYSA9IHRoaXMuY2FtZXJhLFxuICAgICAgICB0cmFuc2Zvcm0gPSB0aGlzLnRyYW5zZm9ybSxcbiAgICAgICAgdGUgPSB0cmFuc2Zvcm0ubWF0cml4V29ybGQuZWxlbWVudHMsXG4gICAgICAgIHBvc2l0aW9uID0gdHJhbnNmb3JtLnBvc2l0aW9uLFxuICAgICAgICB0YXJnZXREaXN0YW5jZTtcblxuICAgIHBhbk9mZnNldC52c3ViKHBvc2l0aW9uLCB0aGlzLnRhcmdldCk7XG4gICAgdGFyZ2V0RGlzdGFuY2UgPSBwYW5PZmZzZXQubGVuZ3RoKCk7XG5cbiAgICBpZiAoIWNhbWVyYS5vcnRob2dyYXBoaWMpIHtcbiAgICAgICAgdGFyZ2V0RGlzdGFuY2UgKj0gdGFuKGRlZ3NUb1JhZHMoY2FtZXJhLmZvdiAqIDAuNSkpO1xuXG4gICAgICAgIHBhbk9mZnNldC5zZXQodGVbMF0sIHRlWzFdLCB0ZVsyXSkuc211bCgtMiAqIGRlbHRhLnggKiB0YXJnZXREaXN0YW5jZSAqIGNhbWVyYS5pbnZXaWR0aCk7XG4gICAgICAgIHBhbi5hZGQocGFuT2Zmc2V0KTtcblxuICAgICAgICBwYW5PZmZzZXQuc2V0KHRlWzRdLCB0ZVs1XSwgdGVbNl0pLnNtdWwoMiAqIGRlbHRhLnkgKiB0YXJnZXREaXN0YW5jZSAqIGNhbWVyYS5pbnZIZWlnaHQpO1xuICAgICAgICBwYW4uYWRkKHBhbk9mZnNldCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGFyZ2V0RGlzdGFuY2UgKj0gY2FtZXJhLm9ydGhvZ3JhcGhpY1NpemUgKiAwLjU7XG5cbiAgICAgICAgcGFuT2Zmc2V0LnNldCh0ZVswXSwgdGVbMV0sIHRlWzJdKS5zbXVsKC0yICogZGVsdGEueCAqIHRhcmdldERpc3RhbmNlICogY2FtZXJhLmludldpZHRoKTtcbiAgICAgICAgcGFuLmFkZChwYW5PZmZzZXQpO1xuXG4gICAgICAgIHBhbk9mZnNldC5zZXQodGVbNF0sIHRlWzVdLCB0ZVs2XSkuc211bCgyICogZGVsdGEueSAqIHRhcmdldERpc3RhbmNlICogY2FtZXJhLmludkhlaWdodCk7XG4gICAgICAgIHBhbi5hZGQocGFuT2Zmc2V0KTtcbiAgICB9XG59O1xuXG5cbk9yYml0Q29udHJvbC5wcm90b3R5cGUudXBkYXRlT3JiaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRyYW5zZm9ybSA9IHRoaXMudHJhbnNmb3JtLFxuICAgICAgICBwb3NpdGlvbiA9IHRyYW5zZm9ybS5wb3NpdGlvbixcbiAgICAgICAgdGFyZ2V0ID0gdGhpcy50YXJnZXQsXG4gICAgICAgIG9mZnNldCA9IHRoaXMuX29mZnNldCxcbiAgICAgICAgcGFuID0gdGhpcy5fcGFuLFxuICAgICAgICB0aGV0YSwgcGhpLCByYWRpdXM7XG5cbiAgICBvZmZzZXQudnN1Yihwb3NpdGlvbiwgdGFyZ2V0KTtcbiAgICB0aGV0YSA9IGF0YW4yKG9mZnNldC54LCBvZmZzZXQueSk7XG4gICAgcGhpID0gYXRhbjIoc3FydChvZmZzZXQueCAqIG9mZnNldC54ICsgb2Zmc2V0LnkgKiBvZmZzZXQueSksIG9mZnNldC56KTtcblxuICAgIHRoZXRhICs9IHRoaXMuX3RoZXRhRGVsdGE7XG4gICAgcGhpICs9IHRoaXMuX3BoaURlbHRhO1xuXG4gICAgcGhpID0gbWF4KE1JTl9QT0xPUiwgbWluKE1BWF9QT0xPUiwgcGhpKSk7XG4gICAgcGhpID0gbWF4KEVQU0lMT04sIG1pbihQSSAtIEVQU0lMT04sIHBoaSkpO1xuXG4gICAgcmFkaXVzID0gb2Zmc2V0Lmxlbmd0aCgpICogdGhpcy5fc2NhbGU7XG5cbiAgICB0YXJnZXQuYWRkKHBhbik7XG5cbiAgICBvZmZzZXQueCA9IHJhZGl1cyAqIHNpbihwaGkpICogc2luKHRoZXRhKTtcbiAgICBvZmZzZXQueSA9IHJhZGl1cyAqIHNpbihwaGkpICogY29zKHRoZXRhKTtcbiAgICBvZmZzZXQueiA9IHJhZGl1cyAqIGNvcyhwaGkpO1xuXG4gICAgcG9zaXRpb24udmFkZCh0YXJnZXQsIG9mZnNldCk7XG4gICAgdHJhbnNmb3JtLmxvb2tBdCh0YXJnZXQpO1xuXG4gICAgdGhpcy5fc2NhbGUgPSAxO1xuICAgIHRoaXMuX3RoZXRhRGVsdGEgPSAwO1xuICAgIHRoaXMuX3BoaURlbHRhID0gMDtcbiAgICBwYW4uc2V0KDAsIDAsIDApO1xufTtcblxuXG5PcmJpdENvbnRyb2wucHJvdG90eXBlLnNldFRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcblxuICAgIHRoaXMudGFyZ2V0LmNvcHkodGFyZ2V0KTtcbiAgICB0aGlzLnRyYW5zZm9ybS5sb29rQXQodGhpcy50YXJnZXQpO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IE9yYml0Q29udHJvbDtcbiIsInZhciBPYmplY3RQb29sID0gcmVxdWlyZShcIi4uLy4uLy4uL2Jhc2Uvb2JqZWN0X3Bvb2xcIik7XG52YXIgQ2xhc3MgPSByZXF1aXJlKFwiLi4vLi4vLi4vYmFzZS9jbGFzc1wiKTtcbnZhciBNYXRoZiA9IHJlcXVpcmUoXCIuLi8uLi8uLi9tYXRoL21hdGhmXCIpO1xudmFyIFZlYzMgPSByZXF1aXJlKFwiLi4vLi4vLi4vbWF0aC92ZWMzXCIpO1xudmFyIENvbG9yID0gcmVxdWlyZShcIi4uLy4uLy4uL21hdGgvY29sb3JcIik7XG52YXIgRW51bXMgPSByZXF1aXJlKFwiLi4vLi4vZW51bXNcIik7XG52YXIgQXNzZXRzID0gcmVxdWlyZShcIi4uLy4uL2Fzc2V0cy9hc3NldHNcIik7XG52YXIgVHdlZW4gPSByZXF1aXJlKFwiLi90d2VlblwiKTtcbnZhciBQYXJ0aWNsZSA9IHJlcXVpcmUoXCIuL3BhcnRpY2xlXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIEVtaXR0ZXJUeXBlID0gRW51bXMuRW1pdHRlclR5cGUsXG5cbiAgICBQSSA9IE1hdGguUEksXG4gICAgVFdPX1BJID0gUEkgKiAyLFxuXG4gICAgcmFuZG9tID0gTWF0aC5yYW5kb20sXG4gICAgcmFuZEludCA9IE1hdGhmLnJhbmRJbnQsXG4gICAgcmFuZEZsb2F0ID0gTWF0aGYucmFuZEZsb2F0LFxuICAgIGNsYW1wVG9wID0gTWF0aGYuY2xhbXBUb3AsXG4gICAgc3FydCA9IE1hdGguc3FydCxcblxuICAgIFBBUlRJQ0xFX1BPT0wgPSBFbWl0dGVyLlBBUlRJQ0xFX1BPT0wgPSBuZXcgT2JqZWN0UG9vbChQYXJ0aWNsZSk7XG5cblxuZnVuY3Rpb24gRW1pdHRlcihvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIENsYXNzLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLnNvcnQgPSBvcHRzLnNvcnQgIT0gdW5kZWZpbmVkID8gb3B0cy5zb3J0IDogdHJ1ZTtcblxuICAgIHRoaXMucG9zaXRpb25UeXBlID0gb3B0cy5wb3NpdGlvblR5cGUgIT0gdW5kZWZpbmVkID8gb3B0cy5wb3NpdGlvblR5cGUgOiBFbWl0dGVyVHlwZS5Cb3g7XG4gICAgdGhpcy52ZWxvY2l0eVR5cGUgPSBvcHRzLnZlbG9jaXR5VHlwZSAhPSB1bmRlZmluZWQgPyBvcHRzLnZlbG9jaXR5VHlwZSA6IEVtaXR0ZXJUeXBlLkJveDtcblxuICAgIHRoaXMubWF0ZXJpYWwgPSBvcHRzLm1hdGVyaWFsICE9IHVuZGVmaW5lZCA/IG9wdHMubWF0ZXJpYWwgOiB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLnBvc2l0aW9uU3ByZWFkID0gb3B0cy5wb3NpdGlvblNwcmVhZCAhPSB1bmRlZmluZWQgPyBvcHRzLnBvc2l0aW9uU3ByZWFkIDogbmV3IFZlYzMoMC41LCAwLjUsIDAuNSk7XG4gICAgdGhpcy5wb3NpdGlvblJhZGl1cyA9IG9wdHMucG9zaXRpb25SYWRpdXMgIT0gdW5kZWZpbmVkID8gb3B0cy5wb3NpdGlvblJhZGl1cyA6IDAuNTtcblxuICAgIHRoaXMuc3BlZWQgPSBvcHRzLnNwZWVkICE9IHVuZGVmaW5lZCA/IG9wdHMuc3BlZWQgOiAwO1xuICAgIHRoaXMuc3BlZWRTcHJlYWQgPSBvcHRzLnNwZWVkU3ByZWFkICE9IHVuZGVmaW5lZCA/IG9wdHMuc3BlZWRTcHJlYWQgOiAwO1xuXG4gICAgdGhpcy5wYXJ0aWNsZVN5c3RlbSA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMud29ybGRTcGFjZSA9IG9wdHMud29ybGRTcGFjZSAhPSB1bmRlZmluZWQgPyBvcHRzLndvcmxkU3BhY2UgOiB0cnVlO1xuXG4gICAgdGhpcy5wb3NpdGlvbiA9IG9wdHMucG9zaXRpb24gIT0gdW5kZWZpbmVkID8gb3B0cy5wb3NpdGlvbiA6IG5ldyBWZWMzO1xuXG4gICAgdGhpcy5taW5FbWlzc2lvbiA9IG9wdHMubWluRW1pc3Npb24gIT0gdW5kZWZpbmVkID8gb3B0cy5taW5FbWlzc2lvbiA6IDE7XG4gICAgdGhpcy5tYXhFbWlzc2lvbiA9IG9wdHMubWF4RW1pc3Npb24gIT0gdW5kZWZpbmVkID8gb3B0cy5tYXhFbWlzc2lvbiA6IDI7XG5cbiAgICB0aGlzLm1pbkxpZmUgPSBvcHRzLm1pbkxpZmUgIT0gdW5kZWZpbmVkID8gb3B0cy5taW5MaWZlIDogMTtcbiAgICB0aGlzLm1heExpZmUgPSBvcHRzLm1heExpZmUgIT0gdW5kZWZpbmVkID8gb3B0cy5tYXhMaWZlIDogMjtcblxuICAgIHRoaXMubWluU2l6ZSA9IG9wdHMubWluU2l6ZSAhPSB1bmRlZmluZWQgPyBvcHRzLm1pblNpemUgOiAwLjE7XG4gICAgdGhpcy5tYXhTaXplID0gb3B0cy5tYXhTaXplICE9IHVuZGVmaW5lZCA/IG9wdHMubWF4U2l6ZSA6IDAuNTtcblxuICAgIHRoaXMuc2l6ZVR3ZWVuID0gbmV3IFR3ZWVuKG9wdHMuc2l6ZVR3ZWVuKTtcbiAgICB0aGlzLmFscGhhVHdlZW4gPSBuZXcgVHdlZW4ob3B0cy5hbHBoYVR3ZWVuKTtcbiAgICB0aGlzLmNvbG9yVHdlZW4gPSBuZXcgVHdlZW4ob3B0cy5jb2xvclR3ZWVuKTtcblxuICAgIHRoaXMudmVsb2NpdHkgPSBvcHRzLnZlbG9jaXR5ICE9IHVuZGVmaW5lZCA/IG9wdHMudmVsb2NpdHkgOiBuZXcgVmVjMztcbiAgICB0aGlzLnZlbG9jaXR5U3ByZWFkID0gb3B0cy52ZWxvY2l0eVNwcmVhZCAhPSB1bmRlZmluZWQgPyBvcHRzLnZlbG9jaXR5U3ByZWFkIDogbmV3IFZlYzM7XG5cbiAgICB0aGlzLmFjY2VsZXJhdGlvbiA9IG9wdHMuYWNjZWxlcmF0aW9uICE9IHVuZGVmaW5lZCA/IG9wdHMuYWNjZWxlcmF0aW9uIDogbmV3IFZlYzM7XG4gICAgdGhpcy5hY2NlbGVyYXRpb25TcHJlYWQgPSBvcHRzLmFjY2VsZXJhdGlvblNwcmVhZCAhPSB1bmRlZmluZWQgPyBvcHRzLmFjY2VsZXJhdGlvblNwcmVhZCA6IG5ldyBWZWMzO1xuXG4gICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkgPSBvcHRzLmFuZ3VsYXJWZWxvY2l0eSAhPSB1bmRlZmluZWQgPyBvcHRzLmFuZ3VsYXJWZWxvY2l0eSA6IDA7XG4gICAgdGhpcy5hbmd1bGFyVmVsb2NpdHlTcHJlYWQgPSBvcHRzLmFuZ3VsYXJWZWxvY2l0eVNwcmVhZCAhPSB1bmRlZmluZWQgPyBvcHRzLmFuZ3VsYXJWZWxvY2l0eVNwcmVhZCA6IDA7XG5cbiAgICB0aGlzLmFuZ3VsYXJBY2NlbGVyYXRpb24gPSBvcHRzLmFuZ3VsYXJBY2NlbGVyYXRpb24gIT0gdW5kZWZpbmVkID8gb3B0cy5hbmd1bGFyQWNjZWxlcmF0aW9uIDogMDtcbiAgICB0aGlzLmFuZ3VsYXJBY2NlbGVyYXRpb25TcHJlYWQgPSBvcHRzLmFuZ3VsYXJBY2NlbGVyYXRpb25TcHJlYWQgIT0gdW5kZWZpbmVkID8gb3B0cy5hbmd1bGFyQWNjZWxlcmF0aW9uU3ByZWFkIDogMDtcblxuICAgIHRoaXMucmFuZG9tQW5nbGUgPSBvcHRzLnJhbmRvbUFuZ2xlICE9IHVuZGVmaW5lZCA/IG9wdHMucmFuZG9tQW5nbGUgOiB0cnVlO1xuXG4gICAgdGhpcy5lbWlzc2lvblJhdGUgPSBvcHRzLmVtaXNzaW9uUmF0ZSAhPSB1bmRlZmluZWQgPyBvcHRzLmVtaXNzaW9uUmF0ZSA6IDEgLyA2MDtcblxuICAgIHRoaXMuY29sb3IgPSBvcHRzLmNvbG9yICE9IHVuZGVmaW5lZCA/IG9wdHMuY29sb3IgOiBuZXcgQ29sb3I7XG4gICAgdGhpcy5jb2xvclNwcmVhZCA9IG9wdHMuY29sb3JTcHJlYWQgIT0gdW5kZWZpbmVkID8gb3B0cy5jb2xvclNwcmVhZCA6IG5ldyBDb2xvcjtcblxuICAgIHRoaXMudGltZSA9IG9wdHMudGltZSAhPSB1bmRlZmluZWQgPyBvcHRzLnRpbWUgOiAwO1xuICAgIHRoaXMuX3RpbWUgPSAwO1xuXG4gICAgdGhpcy5kdXJhdGlvbiA9IG9wdHMuZHVyYXRpb24gIT0gdW5kZWZpbmVkID8gb3B0cy5kdXJhdGlvbiA6IDA7XG5cbiAgICB0aGlzLmxvb3AgPSBvcHRzLmxvb3AgIT0gdW5kZWZpbmVkID8gb3B0cy5sb29wIDogdHJ1ZTtcblxuICAgIHRoaXMucGxheWluZyA9IG9wdHMucGxheWluZyAhPSB1bmRlZmluZWQgPyBvcHRzLnBsYXlpbmcgOiB0cnVlO1xuICAgIHRoaXMuZW1pdHRpbmcgPSBvcHRzLmVtaXR0aW5nICE9IHVuZGVmaW5lZCA/IG9wdHMuZW1pdHRpbmcgOiB0cnVlO1xuXG4gICAgdGhpcy5wYXJ0aWNsZXMgPSBbXTtcblxuICAgIHRoaXMuX3dlYmdsSW5pdHRlZCA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuX3dlYmdsVmVydGV4QnVmZmVyID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3dlYmdsUGFydGljbGVCdWZmZXIgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fd2ViZ2xQYXJ0aWNsZUNvbG9yQnVmZmVyID0gdW5kZWZpbmVkO1xuXG4gICAgdGhpcy5fd2ViZ2xWZXJ0ZXhBcnJheSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl93ZWJnbFBhcnRpY2xlQXJyYXkgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fd2ViZ2xQYXJ0aWNsZUNvbG9yQXJyYXkgPSB1bmRlZmluZWQ7XG59XG5cbkNsYXNzLmV4dGVuZChFbWl0dGVyKTtcblxuXG5FbWl0dGVyLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICB0aGlzLnNvcnQgPSBvdGhlci5zb3J0O1xuXG4gICAgdGhpcy5wb3NpdGlvblR5cGUgPSBvdGhlci5wb3NpdGlvblR5cGU7XG4gICAgdGhpcy52ZWxvY2l0eVR5cGUgPSBvdGhlci52ZWxvY2l0eVR5cGU7XG5cbiAgICB0aGlzLm1hdGVyaWFsID0gb3RoZXIubWF0ZXJpYWw7XG5cbiAgICB0aGlzLnBvc2l0aW9uLmNvcHkob3RoZXIucG9zaXRpb24pO1xuICAgIHRoaXMucG9zaXRpb25TcHJlYWQuY29weShvdGhlci5wb3NpdGlvblNwcmVhZCk7XG4gICAgdGhpcy5wb3NpdGlvblJhZGl1cyA9IG90aGVyLnBvc2l0aW9uUmFkaXVzO1xuXG4gICAgdGhpcy5zcGVlZCA9IG90aGVyLnNwZWVkO1xuICAgIHRoaXMuc3BlZWRTcHJlYWQgPSBvdGhlci5zcGVlZFNwcmVhZDtcblxuICAgIHRoaXMud29ybGRTcGFjZSA9IG90aGVyLndvcmxkU3BhY2U7XG5cbiAgICB0aGlzLm1pbkVtaXNzaW9uID0gb3RoZXIubWluRW1pc3Npb247XG4gICAgdGhpcy5tYXhFbWlzc2lvbiA9IG90aGVyLm1heEVtaXNzaW9uO1xuXG4gICAgdGhpcy5taW5MaWZlID0gb3RoZXIubWluTGlmZTtcbiAgICB0aGlzLm1heExpZmUgPSBvdGhlci5tYXhMaWZlO1xuXG4gICAgdGhpcy5taW5TaXplID0gb3RoZXIubWluU2l6ZTtcbiAgICB0aGlzLm1heFNpemUgPSBvdGhlci5tYXhTaXplO1xuXG4gICAgdGhpcy5zaXplVHdlZW4uY29weShvdGhlci5zaXplVHdlZW4pO1xuICAgIHRoaXMuYWxwaGFUd2Vlbi5jb3B5KG90aGVyLmFscGhhVHdlZW4pO1xuICAgIHRoaXMuY29sb3JUd2Vlbi5jb3B5KG90aGVyLmNvbG9yVHdlZW4pO1xuXG4gICAgdGhpcy52ZWxvY2l0eS5jb3B5KG90aGVyLnZlbG9jaXR5KTtcbiAgICB0aGlzLnZlbG9jaXR5U3ByZWFkLmNvcHkob3RoZXIudmVsb2NpdHlTcHJlYWQpO1xuXG4gICAgdGhpcy5hY2NlbGVyYXRpb24uY29weShvdGhlci5hY2NlbGVyYXRpb24pO1xuICAgIHRoaXMuYWNjZWxlcmF0aW9uU3ByZWFkLmNvcHkob3RoZXIuYWNjZWxlcmF0aW9uU3ByZWFkKTtcblxuICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5ID0gb3RoZXIuYW5ndWxhclZlbG9jaXR5O1xuICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5U3ByZWFkID0gb3RoZXIuYW5ndWxhclZlbG9jaXR5U3ByZWFkO1xuXG4gICAgdGhpcy5hbmd1bGFyQWNjZWxlcmF0aW9uID0gb3RoZXIuYW5ndWxhckFjY2VsZXJhdGlvbjtcbiAgICB0aGlzLmFuZ3VsYXJBY2NlbGVyYXRpb25TcHJlYWQgPSBvdGhlci5hbmd1bGFyQWNjZWxlcmF0aW9uU3ByZWFkO1xuXG4gICAgdGhpcy5yYW5kb21BbmdsZSA9IG90aGVyLnJhbmRvbUFuZ2xlO1xuXG4gICAgdGhpcy5lbWlzc2lvblJhdGUgPSBvdGhlci5lbWlzc2lvblJhdGU7XG5cbiAgICB0aGlzLmNvbG9yLmNvcHkob3RoZXIuY29sb3IpO1xuICAgIHRoaXMuY29sb3JTcHJlYWQuY29weShvdGhlci5jb2xvclNwcmVhZCk7XG5cbiAgICB0aGlzLnRpbWUgPSBvdGhlci50aW1lO1xuICAgIHRoaXMuX3RpbWUgPSBvdGhlci5fdGltZTtcblxuICAgIHRoaXMuZHVyYXRpb24gPSBvdGhlci5kdXJhdGlvbjtcbiAgICB0aGlzLmxvb3AgPSBvdGhlci5sb29wO1xuICAgIHRoaXMucGxheWluZyA9IG90aGVyLnBsYXlpbmc7XG4gICAgdGhpcy5lbWl0dGluZyA9IG90aGVyLmVtaXR0aW5nO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkVtaXR0ZXIucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLnRpbWUgPSAwO1xuICAgIHRoaXMucGxheWluZyA9IHRydWU7XG4gICAgdGhpcy5lbWl0dGluZyA9IHRydWU7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuRW1pdHRlci5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHBhcnRpY2xlcyA9IHRoaXMucGFydGljbGVzLFxuICAgICAgICBpID0gcGFydGljbGVzLmxlbmd0aDtcblxuICAgIHRoaXMudGltZSA9IDA7XG4gICAgdGhpcy5fdGltZSA9IDA7XG4gICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7XG4gICAgdGhpcy5lbWl0dGluZyA9IGZhbHNlO1xuXG4gICAgd2hpbGUgKGktLSkgUEFSVElDTEVfUE9PTC5yZW1vdmVPYmplY3QocGFydGljbGVzW2ldKTtcbiAgICBwYXJ0aWNsZXMubGVuZ3RoID0gMDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG52YXIgVkVDID0gbmV3IFZlYzM7XG5FbWl0dGVyLnByb3RvdHlwZS5zcGF3biA9IGZ1bmN0aW9uIChjb3VudCkge1xuICAgIHZhciB0cmFuc2Zvcm0gPSB0aGlzLnBhcnRpY2xlU3lzdGVtLnRyYW5zZm9ybSB8fCB0aGlzLnBhcnRpY2xlU3lzdGVtLnRyYW5zZm9ybTJkLFxuICAgICAgICB0cmFuc2Zvcm1Qb3NpdGlvbiA9IHRyYW5zZm9ybS50b1dvcmxkKFZFQy5zZXQoMCwgMCwgMCkpLFxuICAgICAgICB0cmFuc2Zvcm1NYXRyaXggPSB0cmFuc2Zvcm0ubWF0cml4V29ybGQsXG5cbiAgICAgICAgcG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uLFxuICAgICAgICBwb3NpdGlvblNwcmVhZCA9IHRoaXMucG9zaXRpb25TcHJlYWQsXG4gICAgICAgIHBvc2l0aW9uUmFkaXVzID0gdGhpcy5wb3NpdGlvblJhZGl1cyxcblxuICAgICAgICBzcGVlZCA9IHRoaXMuc3BlZWQsXG4gICAgICAgIHNwZWVkU3ByZWFkID0gdGhpcy5zcGVlZFNwcmVhZCxcblxuICAgICAgICBwYXJ0aWNsZXMgPSB0aGlzLnBhcnRpY2xlcyxcbiAgICAgICAgbnVtUGFydGljbGUyRHMgPSBwYXJ0aWNsZXMubGVuZ3RoLFxuXG4gICAgICAgIHdvcmxkU3BhY2UgPSB0aGlzLndvcmxkU3BhY2UsXG4gICAgICAgIHJhbmRvbUFuZ2xlID0gdGhpcy5yYW5kb21BbmdsZSxcblxuICAgICAgICBjb2xvciA9IHRoaXMuY29sb3IsXG4gICAgICAgIGNvbG9yU3ByZWFkID0gdGhpcy5jb2xvclNwcmVhZCxcbiAgICAgICAgdXNlUmFuZENvbG9yID0gY29sb3JTcHJlYWQubGVuZ3RoU3EoKSA+IDAsXG5cbiAgICAgICAgdmVsb2NpdHkgPSB0aGlzLnZlbG9jaXR5LFxuICAgICAgICB2ZWxvY2l0eVNwcmVhZCA9IHRoaXMudmVsb2NpdHlTcHJlYWQsXG5cbiAgICAgICAgYWNjZWxlcmF0aW9uID0gdGhpcy5hY2NlbGVyYXRpb24sXG4gICAgICAgIGFjY2VsZXJhdGlvblNwcmVhZCA9IHRoaXMuYWNjZWxlcmF0aW9uU3ByZWFkLFxuXG4gICAgICAgIGFuZ3VsYXJWZWxvY2l0eSA9IHRoaXMuYW5ndWxhclZlbG9jaXR5LFxuICAgICAgICBhbmd1bGFyVmVsb2NpdHlTcHJlYWQgPSB0aGlzLmFuZ3VsYXJWZWxvY2l0eVNwcmVhZCxcblxuICAgICAgICBhbmd1bGFyQWNjZWxlcmF0aW9uID0gdGhpcy5hbmd1bGFyQWNjZWxlcmF0aW9uLFxuICAgICAgICBhbmd1bGFyQWNjZWxlcmF0aW9uU3ByZWFkID0gdGhpcy5hbmd1bGFyQWNjZWxlcmF0aW9uU3ByZWFkLFxuXG4gICAgICAgIG1pbkxpZmUgPSB0aGlzLm1pbkxpZmUsXG4gICAgICAgIG1heExpZmUgPSB0aGlzLm1heExpZmUsXG5cbiAgICAgICAgbWluU2l6ZSA9IHRoaXMubWluU2l6ZSxcbiAgICAgICAgbWF4U2l6ZSA9IHRoaXMubWF4U2l6ZSxcblxuICAgICAgICBwb3NpdGlvblR5cGUgPSB0aGlzLnBvc2l0aW9uVHlwZSxcbiAgICAgICAgdmVsb2NpdHlUeXBlID0gdGhpcy52ZWxvY2l0eVR5cGUsXG5cbiAgICAgICAgbGltaXQgPSBjbGFtcFRvcChudW1QYXJ0aWNsZTJEcyArIGNvdW50LCBFbWl0dGVyLk1BWF9QQVJUSUNMRVMpIC0gbnVtUGFydGljbGUyRHMsXG4gICAgICAgIHBvc3gsIHBvc3ksIHBvc3osIHZlbCwgYWNjLCBwb3MsIGNvbCwgeCwgeSwgeiwgbGVuLCByLCBkeCwgZHksIGR6LCBzcGQsIHBhcnRpY2xlO1xuXG4gICAgaWYgKHBvc2l0aW9uVHlwZSAhPT0gRW1pdHRlclR5cGUuQm94KSB7XG4gICAgICAgIHBvc3ggPSByYW5kRmxvYXQoLXBvc2l0aW9uU3ByZWFkLngsIHBvc2l0aW9uU3ByZWFkLngpO1xuICAgICAgICBwb3N5ID0gcmFuZEZsb2F0KC1wb3NpdGlvblNwcmVhZC55LCBwb3NpdGlvblNwcmVhZC55KTtcbiAgICAgICAgcG9zeiA9IHJhbmRGbG9hdCgtcG9zaXRpb25TcHJlYWQueiwgcG9zaXRpb25TcHJlYWQueik7XG4gICAgfVxuXG4gICAgd2hpbGUgKGxpbWl0LS0pIHtcbiAgICAgICAgcGFydGljbGUgPSBQQVJUSUNMRV9QT09MLmNyZWF0ZSgpO1xuICAgICAgICBwb3MgPSBwYXJ0aWNsZS5wb3NpdGlvbjtcbiAgICAgICAgdmVsID0gcGFydGljbGUudmVsb2NpdHk7XG4gICAgICAgIGFjYyA9IHBhcnRpY2xlLmFjY2VsZXJhdGlvbjtcbiAgICAgICAgY29sID0gcGFydGljbGUuY29sb3I7XG5cbiAgICAgICAgY29sLnIgPSBjb2xvci5yO1xuICAgICAgICBjb2wuZyA9IGNvbG9yLmc7XG4gICAgICAgIGNvbC5iID0gY29sb3IuYjtcblxuICAgICAgICBpZiAodXNlUmFuZENvbG9yKSB7XG4gICAgICAgICAgICBjb2wuciArPSBjb2xvclNwcmVhZC5yICogcmFuZG9tKCk7XG4gICAgICAgICAgICBjb2wuZyArPSBjb2xvclNwcmVhZC5nICogcmFuZG9tKCk7XG4gICAgICAgICAgICBjb2wuYiArPSBjb2xvclNwcmVhZC5iICogcmFuZG9tKCk7XG4gICAgICAgICAgICBjb2wuY25vcm1hbGl6ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHdvcmxkU3BhY2UpIHtcbiAgICAgICAgICAgIHBvcy54ID0gcG9zaXRpb24ueCArIHRyYW5zZm9ybVBvc2l0aW9uLng7XG4gICAgICAgICAgICBwb3MueSA9IHBvc2l0aW9uLnkgKyB0cmFuc2Zvcm1Qb3NpdGlvbi55O1xuICAgICAgICAgICAgcG9zLnogPSBwb3NpdGlvbi56ICsgdHJhbnNmb3JtUG9zaXRpb24uejtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBvcy54ID0gcG9zaXRpb24ueDtcbiAgICAgICAgICAgIHBvcy55ID0gcG9zaXRpb24ueTtcbiAgICAgICAgICAgIHBvcy56ID0gcG9zaXRpb24uejtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwb3NpdGlvblR5cGUgPT09IEVtaXR0ZXJUeXBlLkJveCkge1xuICAgICAgICAgICAgcG9zLnggKz0gcmFuZEZsb2F0KC1wb3NpdGlvblNwcmVhZC54LCBwb3NpdGlvblNwcmVhZC54KTtcbiAgICAgICAgICAgIHBvcy55ICs9IHJhbmRGbG9hdCgtcG9zaXRpb25TcHJlYWQueSwgcG9zaXRpb25TcHJlYWQueSk7XG4gICAgICAgICAgICBwb3MueiArPSByYW5kRmxvYXQoLXBvc2l0aW9uU3ByZWFkLnosIHBvc2l0aW9uU3ByZWFkLnopO1xuICAgICAgICB9IGVsc2UgeyAvL0VtaXR0ZXJUeXBlLlNwaGVyZVxuICAgICAgICAgICAgeCA9IHJhbmRGbG9hdCgtMSwgMSk7XG4gICAgICAgICAgICB5ID0gcmFuZEZsb2F0KC0xLCAxKTtcbiAgICAgICAgICAgIHogPSByYW5kRmxvYXQoLTEsIDEpO1xuXG4gICAgICAgICAgICBsZW4gPSB4ICogeCArIHkgKiB5ICsgeiAqIHo7XG4gICAgICAgICAgICBsZW4gPSBsZW4gIT09IDAgPyAxIC8gc3FydChsZW4pIDogbGVuO1xuXG4gICAgICAgICAgICBwb3MueCArPSBwb3N4ICsgeCAqIGxlbiAqIHBvc2l0aW9uUmFkaXVzO1xuICAgICAgICAgICAgcG9zLnkgKz0gcG9zeSArIHkgKiBsZW4gKiBwb3NpdGlvblJhZGl1cztcbiAgICAgICAgICAgIHBvcy56ICs9IHBvc3ogKyB6ICogbGVuICogcG9zaXRpb25SYWRpdXM7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodmVsb2NpdHlUeXBlID09PSBFbWl0dGVyVHlwZS5Cb3gpIHtcbiAgICAgICAgICAgIHZlbC54ID0gdmVsb2NpdHkueCArIHJhbmRGbG9hdCgtdmVsb2NpdHlTcHJlYWQueCwgdmVsb2NpdHlTcHJlYWQueCk7XG4gICAgICAgICAgICB2ZWwueSA9IHZlbG9jaXR5LnkgKyByYW5kRmxvYXQoLXZlbG9jaXR5U3ByZWFkLnksIHZlbG9jaXR5U3ByZWFkLnkpO1xuICAgICAgICAgICAgdmVsLnogPSB2ZWxvY2l0eS56ICsgcmFuZEZsb2F0KC12ZWxvY2l0eVNwcmVhZC56LCB2ZWxvY2l0eVNwcmVhZC56KTtcbiAgICAgICAgfSBlbHNlIHsgLy9FbWl0dGVyVHlwZS5TcGhlcmVcbiAgICAgICAgICAgIGlmICh3b3JsZFNwYWNlKSB7XG4gICAgICAgICAgICAgICAgZHggPSBwb3MueCAtIChwb3NpdGlvbi54ICsgdHJhbnNmb3JtUG9zaXRpb24ueCk7XG4gICAgICAgICAgICAgICAgZHkgPSBwb3MueSAtIChwb3NpdGlvbi55ICsgdHJhbnNmb3JtUG9zaXRpb24ueSk7XG4gICAgICAgICAgICAgICAgZHogPSBwb3MueiAtIChwb3NpdGlvbi56ICsgdHJhbnNmb3JtUG9zaXRpb24ueik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGR4ID0gcG9zLnggLSBwb3NpdGlvbi54O1xuICAgICAgICAgICAgICAgIGR5ID0gcG9zLnkgLSBwb3NpdGlvbi55O1xuICAgICAgICAgICAgICAgIGR6ID0gcG9zLnogLSBwb3NpdGlvbi56O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3BkID0gc3BlZWQgKyByYW5kRmxvYXQoLXNwZWVkU3ByZWFkLCBzcGVlZFNwcmVhZCk7XG5cbiAgICAgICAgICAgIHIgPSBkeCAqIGR4ICsgZHkgKiBkeSArIGR6ICogZHo7XG4gICAgICAgICAgICByID0gciAhPT0gMCA/IDEgLyBzcXJ0KHIpIDogcjtcblxuICAgICAgICAgICAgdmVsLnggPSBkeCAqIHIgKiBzcGQ7XG4gICAgICAgICAgICB2ZWwueSA9IGR5ICogciAqIHNwZDtcbiAgICAgICAgICAgIHZlbC56ID0gZHogKiByICogc3BkO1xuICAgICAgICB9XG4gICAgICAgIHZlbC50cmFuc2Zvcm1NYXQ0Um90YXRpb24odHJhbnNmb3JtTWF0cml4KTtcblxuICAgICAgICBhY2MueCA9IGFjY2VsZXJhdGlvbi54ICsgcmFuZEZsb2F0KC1hY2NlbGVyYXRpb25TcHJlYWQueCwgYWNjZWxlcmF0aW9uU3ByZWFkLngpO1xuICAgICAgICBhY2MueSA9IGFjY2VsZXJhdGlvbi55ICsgcmFuZEZsb2F0KC1hY2NlbGVyYXRpb25TcHJlYWQueSwgYWNjZWxlcmF0aW9uU3ByZWFkLnkpO1xuICAgICAgICBhY2MueiA9IGFjY2VsZXJhdGlvbi56ICsgcmFuZEZsb2F0KC1hY2NlbGVyYXRpb25TcHJlYWQueiwgYWNjZWxlcmF0aW9uU3ByZWFkLnopO1xuXG4gICAgICAgIHBhcnRpY2xlLmFuZ3VsYXJWZWxvY2l0eSA9IGFuZ3VsYXJWZWxvY2l0eSArIHJhbmRGbG9hdCgtYW5ndWxhclZlbG9jaXR5U3ByZWFkLCBhbmd1bGFyVmVsb2NpdHlTcHJlYWQpO1xuICAgICAgICBwYXJ0aWNsZS5hbmd1bGFyQWNjZWxlcmF0aW9uID0gYW5ndWxhckFjY2VsZXJhdGlvbiArIHJhbmRGbG9hdCgtYW5ndWxhckFjY2VsZXJhdGlvblNwcmVhZCwgYW5ndWxhckFjY2VsZXJhdGlvblNwcmVhZCk7XG5cbiAgICAgICAgcGFydGljbGUuYWxwaGEgPSAxO1xuICAgICAgICBwYXJ0aWNsZS5hbmdsZSA9IHJhbmRvbUFuZ2xlID8gcmFuZG9tKCkgKiBUV09fUEkgOiAwO1xuICAgICAgICBwYXJ0aWNsZS5saWZlVGltZSA9IDA7XG4gICAgICAgIHBhcnRpY2xlLmxpZmUgPSByYW5kRmxvYXQobWluTGlmZSwgbWF4TGlmZSk7XG4gICAgICAgIHBhcnRpY2xlLnNpemUgPSByYW5kRmxvYXQobWluU2l6ZSwgbWF4U2l6ZSk7XG5cbiAgICAgICAgcGFydGljbGVzLnB1c2gocGFydGljbGUpO1xuICAgIH1cbn07XG5cblxuRW1pdHRlci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGR0KSB7XG4gICAgaWYgKCF0aGlzLnBsYXlpbmcpIHJldHVybjtcbiAgICB2YXIgcGFydGljbGVzID0gdGhpcy5wYXJ0aWNsZXMsXG4gICAgICAgIHNpemVUd2VlbiA9IHRoaXMuc2l6ZVR3ZWVuLFxuICAgICAgICBhbHBoYVR3ZWVuID0gdGhpcy5hbHBoYVR3ZWVuLFxuICAgICAgICBjb2xvclR3ZWVuID0gdGhpcy5jb2xvclR3ZWVuLFxuICAgICAgICBzaXplVHdlZW5VcGRhdGUgPSBzaXplVHdlZW4udGltZXMubGVuZ3RoID4gMCxcbiAgICAgICAgYWxwaGFUd2VlblVwZGF0ZSA9IGFscGhhVHdlZW4udGltZXMubGVuZ3RoID4gMCxcbiAgICAgICAgY29sb3JUd2VlblVwZGF0ZSA9IGNvbG9yVHdlZW4udGltZXMubGVuZ3RoID4gMCxcbiAgICAgICAgcGFydGljbGUsIGxpZmUsIGNvdW50LFxuICAgICAgICBpO1xuXG4gICAgdGhpcy50aW1lICs9IGR0O1xuICAgIHRoaXMuX3RpbWUgKz0gZHQ7XG4gICAgY291bnQgPSB0aGlzLl90aW1lIC8gdGhpcy5lbWlzc2lvblJhdGU7XG5cbiAgICBpZiAodGhpcy5lbWl0dGluZyAmJiBjb3VudCA+PSAxKSB7XG4gICAgICAgIHRoaXMuX3RpbWUgPSAwO1xuICAgICAgICB0aGlzLnNwYXduKHJhbmRJbnQodGhpcy5taW5FbWlzc2lvbiwgdGhpcy5tYXhFbWlzc2lvbikgKiAoY291bnQgfCAwKSk7XG5cbiAgICAgICAgaWYgKCF0aGlzLmxvb3AgJiYgdGhpcy50aW1lID4gdGhpcy5kdXJhdGlvbikgdGhpcy5lbWl0dGluZyA9IGZhbHNlO1xuICAgIH1cblxuICAgIGkgPSBwYXJ0aWNsZXMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgcGFydGljbGUgPSBwYXJ0aWNsZXNbaV07XG4gICAgICAgIHBhcnRpY2xlLnVwZGF0ZShkdCk7XG4gICAgICAgIGxpZmUgPSBwYXJ0aWNsZS5saWZlVGltZSAvIHBhcnRpY2xlLmxpZmU7XG5cbiAgICAgICAgaWYgKHNpemVUd2VlblVwZGF0ZSkgcGFydGljbGUuc2l6ZSA9IHNpemVUd2Vlbi51cGRhdGUobGlmZSk7XG4gICAgICAgIGlmIChhbHBoYVR3ZWVuVXBkYXRlKSBwYXJ0aWNsZS5hbHBoYSA9IGFscGhhVHdlZW4udXBkYXRlKGxpZmUpO1xuICAgICAgICBpZiAoY29sb3JUd2VlblVwZGF0ZSkgY29sb3JUd2Vlbi51cGRhdGUobGlmZSwgcGFydGljbGUuY29sb3IpO1xuXG4gICAgICAgIGlmIChsaWZlID4gMSkge1xuICAgICAgICAgICAgUEFSVElDTEVfUE9PTC5yZW1vdmVPYmplY3QocGFydGljbGUpO1xuICAgICAgICAgICAgcGFydGljbGVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICghdGhpcy5lbWl0dGluZyAmJiBwYXJ0aWNsZXMubGVuZ3RoID09PSAwKSB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcbn07XG5cblxuRW1pdHRlci5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gQ2xhc3MucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi50eXBlID0gMTtcblxuICAgIGpzb24uc29ydCA9IHRoaXMuc29ydDtcblxuICAgIGpzb24ucG9zaXRpb25UeXBlID0gdGhpcy5wb3NpdGlvblR5cGU7XG4gICAganNvbi52ZWxvY2l0eVR5cGUgPSB0aGlzLnZlbG9jaXR5VHlwZTtcblxuICAgIGpzb24ubWF0ZXJpYWwgPSB0aGlzLm1hdGVyaWFsID8gdGhpcy5tYXRlcmlhbC5uYW1lIDogdW5kZWZpbmVkO1xuXG4gICAganNvbi5wb3NpdGlvbiA9IHRoaXMucG9zaXRpb24udG9KU09OKGpzb24ucG9zaXRpb24pO1xuICAgIGpzb24ucG9zaXRpb25TcHJlYWQgPSB0aGlzLnBvc2l0aW9uU3ByZWFkLnRvSlNPTihqc29uLnBvc2l0aW9uU3ByZWFkKTtcbiAgICBqc29uLnBvc2l0aW9uUmFkaXVzID0gdGhpcy5wb3NpdGlvblJhZGl1cztcblxuICAgIGpzb24uc3BlZWQgPSB0aGlzLnNwZWVkO1xuICAgIGpzb24uc3BlZWRTcHJlYWQgPSB0aGlzLnNwZWVkU3ByZWFkO1xuXG4gICAganNvbi53b3JsZFNwYWNlID0gdGhpcy53b3JsZFNwYWNlO1xuXG4gICAganNvbi5taW5FbWlzc2lvbiA9IHRoaXMubWluRW1pc3Npb247XG4gICAganNvbi5tYXhFbWlzc2lvbiA9IHRoaXMubWF4RW1pc3Npb247XG5cbiAgICBqc29uLm1pbkxpZmUgPSB0aGlzLm1pbkxpZmU7XG4gICAganNvbi5tYXhMaWZlID0gdGhpcy5tYXhMaWZlO1xuXG4gICAganNvbi5taW5TaXplID0gdGhpcy5taW5TaXplO1xuICAgIGpzb24ubWF4U2l6ZSA9IHRoaXMubWF4U2l6ZTtcblxuICAgIGpzb24uc2l6ZVR3ZWVuID0gdGhpcy5zaXplVHdlZW4udG9KU09OKGpzb24uc2l6ZVR3ZWVuKTtcbiAgICBqc29uLmFscGhhVHdlZW4gPSB0aGlzLmFscGhhVHdlZW4udG9KU09OKGpzb24uYWxwaGFUd2Vlbik7XG4gICAganNvbi5jb2xvclR3ZWVuID0gdGhpcy5jb2xvclR3ZWVuLnRvSlNPTihqc29uLmNvbG9yVHdlZW4pO1xuXG4gICAganNvbi52ZWxvY2l0eSA9IHRoaXMudmVsb2NpdHkudG9KU09OKGpzb24udmVsb2NpdHkpO1xuICAgIGpzb24udmVsb2NpdHlTcHJlYWQgPSB0aGlzLnZlbG9jaXR5U3ByZWFkLnRvSlNPTihqc29uLnZlbG9jaXR5U3ByZWFkKTtcblxuICAgIGpzb24uYWNjZWxlcmF0aW9uID0gdGhpcy5hY2NlbGVyYXRpb24udG9KU09OKGpzb24uYWNjZWxlcmF0aW9uKTtcbiAgICBqc29uLmFjY2VsZXJhdGlvblNwcmVhZCA9IHRoaXMuYWNjZWxlcmF0aW9uU3ByZWFkLnRvSlNPTihqc29uLmFjY2VsZXJhdGlvblNwcmVhZCk7XG5cbiAgICBqc29uLmFuZ3VsYXJWZWxvY2l0eSA9IHRoaXMuYW5ndWxhclZlbG9jaXR5O1xuICAgIGpzb24uYW5ndWxhckFjY2VsZXJhdGlvbiA9IHRoaXMuYW5ndWxhckFjY2VsZXJhdGlvbjtcblxuICAgIGpzb24uYW5ndWxhclZlbG9jaXR5U3ByZWFkID0gdGhpcy5hbmd1bGFyVmVsb2NpdHlTcHJlYWQ7XG4gICAganNvbi5yYW5kb21BbmdsZSA9IHRoaXMucmFuZG9tQW5nbGU7XG5cbiAgICBqc29uLmVtaXNzaW9uUmF0ZSA9IHRoaXMuZW1pc3Npb25SYXRlO1xuXG4gICAganNvbi5jb2xvciA9IHRoaXMuY29sb3IudG9KU09OKGpzb24uY29sb3IpO1xuICAgIGpzb24uY29sb3JTcHJlYWQgPSB0aGlzLmNvbG9yU3ByZWFkLnRvSlNPTihqc29uLmNvbG9yU3ByZWFkKTtcblxuICAgIGpzb24udGltZSA9IHRoaXMudGltZTtcbiAgICBqc29uLl90aW1lID0gdGhpcy5fdGltZTtcblxuICAgIGpzb24uZHVyYXRpb24gPSB0aGlzLmR1cmF0aW9uO1xuICAgIGpzb24ubG9vcCA9IHRoaXMubG9vcDtcbiAgICBqc29uLnBsYXlpbmcgPSB0aGlzLnBsYXlpbmc7XG4gICAganNvbi5lbWl0dGluZyA9IHRoaXMuZW1pdHRpbmc7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuRW1pdHRlci5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENsYXNzLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy5zb3J0ID0ganNvbi5zb3J0O1xuXG4gICAgdGhpcy5wb3NpdGlvblR5cGUgPSBqc29uLnBvc2l0aW9uVHlwZTtcbiAgICB0aGlzLnZlbG9jaXR5VHlwZSA9IGpzb24udmVsb2NpdHlUeXBlO1xuXG4gICAgdGhpcy5tYXRlcmlhbCA9IGpzb24ubWF0ZXJpYWwgPyBBc3NldHMuaGFzaFtqc29uLm1hdGVyaWFsXSA6IHVuZGVmaW5lZDtcblxuICAgIHRoaXMucG9zaXRpb24uZnJvbUpTT04oanNvbi5wb3NpdGlvbik7XG4gICAgdGhpcy5wb3NpdGlvblNwcmVhZC5mcm9tSlNPTihqc29uLnBvc2l0aW9uU3ByZWFkKTtcbiAgICB0aGlzLnBvc2l0aW9uUmFkaXVzID0ganNvbi5wb3NpdGlvblJhZGl1cztcblxuICAgIHRoaXMuc3BlZWQgPSBqc29uLnNwZWVkO1xuICAgIHRoaXMuc3BlZWRTcHJlYWQgPSBqc29uLnNwZWVkU3ByZWFkO1xuXG4gICAgdGhpcy53b3JsZFNwYWNlID0ganNvbi53b3JsZFNwYWNlO1xuXG4gICAgdGhpcy5taW5FbWlzc2lvbiA9IGpzb24ubWluRW1pc3Npb247XG4gICAgdGhpcy5tYXhFbWlzc2lvbiA9IGpzb24ubWF4RW1pc3Npb247XG5cbiAgICB0aGlzLm1pbkxpZmUgPSBqc29uLm1pbkxpZmU7XG4gICAgdGhpcy5tYXhMaWZlID0ganNvbi5tYXhMaWZlO1xuXG4gICAgdGhpcy5taW5TaXplID0ganNvbi5taW5TaXplO1xuICAgIHRoaXMubWF4U2l6ZSA9IGpzb24ubWF4U2l6ZTtcblxuICAgIHRoaXMuc2l6ZVR3ZWVuLmZyb21KU09OKGpzb24uc2l6ZVR3ZWVuKTtcbiAgICB0aGlzLmFscGhhVHdlZW4uZnJvbUpTT04oanNvbi5hbHBoYVR3ZWVuKTtcbiAgICB0aGlzLmNvbG9yVHdlZW4uZnJvbUpTT04oanNvbi5jb2xvclR3ZWVuKTtcblxuICAgIHRoaXMudmVsb2NpdHkuZnJvbUpTT04oanNvbi52ZWxvY2l0eSk7XG4gICAgdGhpcy52ZWxvY2l0eVNwcmVhZC5mcm9tSlNPTihqc29uLnZlbG9jaXR5U3ByZWFkKTtcblxuICAgIHRoaXMuYWNjZWxlcmF0aW9uLmZyb21KU09OKGpzb24uYWNjZWxlcmF0aW9uKTtcbiAgICB0aGlzLmFjY2VsZXJhdGlvblNwcmVhZC5mcm9tSlNPTihqc29uLmFjY2VsZXJhdGlvblNwcmVhZCk7XG5cbiAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IGpzb24uYW5ndWxhclZlbG9jaXR5O1xuICAgIHRoaXMuYW5ndWxhckFjY2VsZXJhdGlvbiA9IGpzb24uYW5ndWxhckFjY2VsZXJhdGlvbjtcblxuICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5U3ByZWFkID0ganNvbi5hbmd1bGFyVmVsb2NpdHlTcHJlYWQ7XG4gICAgdGhpcy5yYW5kb21BbmdsZSA9IGpzb24ucmFuZG9tQW5nbGU7XG5cbiAgICB0aGlzLmVtaXNzaW9uUmF0ZSA9IGpzb24uZW1pc3Npb25SYXRlO1xuXG4gICAgdGhpcy5jb2xvci5mcm9tSlNPTihqc29uLmNvbG9yKTtcbiAgICB0aGlzLmNvbG9yU3ByZWFkLmZyb21KU09OKGpzb24uY29sb3JTcHJlYWQpO1xuXG4gICAgdGhpcy50aW1lID0ganNvbi50aW1lO1xuICAgIHRoaXMuX3RpbWUgPSBqc29uLl90aW1lO1xuXG4gICAgdGhpcy5kdXJhdGlvbiA9IGpzb24uZHVyYXRpb247XG4gICAgdGhpcy5sb29wID0ganNvbi5sb29wO1xuICAgIHRoaXMucGxheWluZyA9IGpzb24ucGxheWluZztcbiAgICB0aGlzLmVtaXR0aW5nID0ganNvbi5lbWl0dGluZztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5FbWl0dGVyLk1BWF9QQVJUSUNMRVMgPSAxMDI0O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gRW1pdHRlcjtcbiIsInZhciBPYmplY3RQb29sID0gcmVxdWlyZShcIi4uLy4uLy4uL2Jhc2Uvb2JqZWN0X3Bvb2xcIik7XG52YXIgQ2xhc3MgPSByZXF1aXJlKFwiLi4vLi4vLi4vYmFzZS9jbGFzc1wiKTtcbnZhciBNYXRoZiA9IHJlcXVpcmUoXCIuLi8uLi8uLi9tYXRoL21hdGhmXCIpO1xudmFyIFZlYzIgPSByZXF1aXJlKFwiLi4vLi4vLi4vbWF0aC92ZWMyXCIpO1xudmFyIENvbG9yID0gcmVxdWlyZShcIi4uLy4uLy4uL21hdGgvY29sb3JcIik7XG52YXIgRW51bXMgPSByZXF1aXJlKFwiLi4vLi4vZW51bXNcIik7XG52YXIgQXNzZXRzID0gcmVxdWlyZShcIi4uLy4uL2Fzc2V0cy9hc3NldHNcIik7XG52YXIgVHdlZW4gPSByZXF1aXJlKFwiLi90d2VlblwiKTtcbnZhciBQYXJ0aWNsZTJEID0gcmVxdWlyZShcIi4vcGFydGljbGVfMmRcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgRW1pdHRlclR5cGUgPSBFbnVtcy5FbWl0dGVyVHlwZSxcblxuICAgIFBJID0gTWF0aC5QSSxcbiAgICBUV09fUEkgPSBQSSAqIDIsXG5cbiAgICByYW5kb20gPSBNYXRoLnJhbmRvbSxcbiAgICByYW5kSW50ID0gTWF0aGYucmFuZEludCxcbiAgICByYW5kRmxvYXQgPSBNYXRoZi5yYW5kRmxvYXQsXG4gICAgY2xhbXBUb3AgPSBNYXRoZi5jbGFtcFRvcCxcbiAgICBjb3MgPSBNYXRoLmNvcyxcbiAgICBzaW4gPSBNYXRoLnNpbixcbiAgICBzcXJ0ID0gTWF0aC5zcXJ0LFxuXG4gICAgUEFSVElDTEVfUE9PTCA9IEVtaXR0ZXIyRC5QQVJUSUNMRV9QT09MID0gbmV3IE9iamVjdFBvb2woUGFydGljbGUyRCk7XG5cblxuZnVuY3Rpb24gRW1pdHRlcjJEKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQ2xhc3MuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMucG9zaXRpb25UeXBlID0gb3B0cy5wb3NpdGlvblR5cGUgIT0gdW5kZWZpbmVkID8gb3B0cy5wb3NpdGlvblR5cGUgOiBFbWl0dGVyVHlwZS5Cb3g7XG4gICAgdGhpcy52ZWxvY2l0eVR5cGUgPSBvcHRzLnZlbG9jaXR5VHlwZSAhPSB1bmRlZmluZWQgPyBvcHRzLnZlbG9jaXR5VHlwZSA6IEVtaXR0ZXJUeXBlLkJveDtcblxuICAgIHRoaXMubWF0ZXJpYWwgPSBvcHRzLm1hdGVyaWFsICE9IHVuZGVmaW5lZCA/IG9wdHMubWF0ZXJpYWwgOiB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLnBvc2l0aW9uU3ByZWFkID0gb3B0cy5wb3NpdGlvblNwcmVhZCAhPSB1bmRlZmluZWQgPyBvcHRzLnBvc2l0aW9uU3ByZWFkIDogbmV3IFZlYzIoMC41LCAwLjUpO1xuICAgIHRoaXMucG9zaXRpb25SYWRpdXMgPSBvcHRzLnBvc2l0aW9uUmFkaXVzICE9IHVuZGVmaW5lZCA/IG9wdHMucG9zaXRpb25SYWRpdXMgOiAwLjU7XG5cbiAgICB0aGlzLnNwZWVkID0gb3B0cy5zcGVlZCAhPSB1bmRlZmluZWQgPyBvcHRzLnNwZWVkIDogMDtcbiAgICB0aGlzLnNwZWVkU3ByZWFkID0gb3B0cy5zcGVlZFNwcmVhZCAhPSB1bmRlZmluZWQgPyBvcHRzLnNwZWVkU3ByZWFkIDogMDtcblxuICAgIHRoaXMucGFydGljbGVTeXN0ZW0gPSB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLndvcmxkU3BhY2UgPSBvcHRzLndvcmxkU3BhY2UgIT0gdW5kZWZpbmVkID8gb3B0cy53b3JsZFNwYWNlIDogdHJ1ZTtcblxuICAgIHRoaXMucG9zaXRpb24gPSBvcHRzLnBvc2l0aW9uICE9IHVuZGVmaW5lZCA/IG9wdHMucG9zaXRpb24gOiBuZXcgVmVjMjtcblxuICAgIHRoaXMubWluRW1pc3Npb24gPSBvcHRzLm1pbkVtaXNzaW9uICE9IHVuZGVmaW5lZCA/IG9wdHMubWluRW1pc3Npb24gOiAxO1xuICAgIHRoaXMubWF4RW1pc3Npb24gPSBvcHRzLm1heEVtaXNzaW9uICE9IHVuZGVmaW5lZCA/IG9wdHMubWF4RW1pc3Npb24gOiAyO1xuXG4gICAgdGhpcy5taW5MaWZlID0gb3B0cy5taW5MaWZlICE9IHVuZGVmaW5lZCA/IG9wdHMubWluTGlmZSA6IDE7XG4gICAgdGhpcy5tYXhMaWZlID0gb3B0cy5tYXhMaWZlICE9IHVuZGVmaW5lZCA/IG9wdHMubWF4TGlmZSA6IDI7XG5cbiAgICB0aGlzLm1pblNpemUgPSBvcHRzLm1pblNpemUgIT0gdW5kZWZpbmVkID8gb3B0cy5taW5TaXplIDogMC4xO1xuICAgIHRoaXMubWF4U2l6ZSA9IG9wdHMubWF4U2l6ZSAhPSB1bmRlZmluZWQgPyBvcHRzLm1heFNpemUgOiAwLjU7XG5cbiAgICB0aGlzLnNpemVUd2VlbiA9IG5ldyBUd2VlbihvcHRzLnNpemVUd2Vlbik7XG4gICAgdGhpcy5hbHBoYVR3ZWVuID0gbmV3IFR3ZWVuKG9wdHMuYWxwaGFUd2Vlbik7XG4gICAgdGhpcy5jb2xvclR3ZWVuID0gbmV3IFR3ZWVuKG9wdHMuY29sb3JUd2Vlbik7XG5cbiAgICB0aGlzLnZlbG9jaXR5ID0gb3B0cy52ZWxvY2l0eSAhPSB1bmRlZmluZWQgPyBvcHRzLnZlbG9jaXR5IDogbmV3IFZlYzI7XG4gICAgdGhpcy52ZWxvY2l0eVNwcmVhZCA9IG9wdHMudmVsb2NpdHlTcHJlYWQgIT0gdW5kZWZpbmVkID8gb3B0cy52ZWxvY2l0eVNwcmVhZCA6IG5ldyBWZWMyO1xuXG4gICAgdGhpcy5hY2NlbGVyYXRpb24gPSBvcHRzLmFjY2VsZXJhdGlvbiAhPSB1bmRlZmluZWQgPyBvcHRzLmFjY2VsZXJhdGlvbiA6IG5ldyBWZWMyO1xuICAgIHRoaXMuYWNjZWxlcmF0aW9uU3ByZWFkID0gb3B0cy5hY2NlbGVyYXRpb25TcHJlYWQgIT0gdW5kZWZpbmVkID8gb3B0cy5hY2NlbGVyYXRpb25TcHJlYWQgOiBuZXcgVmVjMjtcblxuICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5ID0gb3B0cy5hbmd1bGFyVmVsb2NpdHkgIT0gdW5kZWZpbmVkID8gb3B0cy5hbmd1bGFyVmVsb2NpdHkgOiAwO1xuICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5U3ByZWFkID0gb3B0cy5hbmd1bGFyVmVsb2NpdHlTcHJlYWQgIT0gdW5kZWZpbmVkID8gb3B0cy5hbmd1bGFyVmVsb2NpdHlTcHJlYWQgOiAwO1xuXG4gICAgdGhpcy5hbmd1bGFyQWNjZWxlcmF0aW9uID0gb3B0cy5hbmd1bGFyQWNjZWxlcmF0aW9uICE9IHVuZGVmaW5lZCA/IG9wdHMuYW5ndWxhckFjY2VsZXJhdGlvbiA6IDA7XG4gICAgdGhpcy5hbmd1bGFyQWNjZWxlcmF0aW9uU3ByZWFkID0gb3B0cy5hbmd1bGFyQWNjZWxlcmF0aW9uU3ByZWFkICE9IHVuZGVmaW5lZCA/IG9wdHMuYW5ndWxhckFjY2VsZXJhdGlvblNwcmVhZCA6IDA7XG5cbiAgICB0aGlzLnJhbmRvbUFuZ2xlID0gb3B0cy5yYW5kb21BbmdsZSAhPSB1bmRlZmluZWQgPyBvcHRzLnJhbmRvbUFuZ2xlIDogdHJ1ZTtcblxuICAgIHRoaXMuZW1pc3Npb25SYXRlID0gb3B0cy5lbWlzc2lvblJhdGUgIT0gdW5kZWZpbmVkID8gb3B0cy5lbWlzc2lvblJhdGUgOiAxIC8gNjA7XG5cbiAgICB0aGlzLmNvbG9yID0gb3B0cy5jb2xvciAhPSB1bmRlZmluZWQgPyBvcHRzLmNvbG9yIDogbmV3IENvbG9yO1xuICAgIHRoaXMuY29sb3JTcHJlYWQgPSBvcHRzLmNvbG9yU3ByZWFkICE9IHVuZGVmaW5lZCA/IG9wdHMuY29sb3JTcHJlYWQgOiBuZXcgQ29sb3I7XG5cbiAgICB0aGlzLnRpbWUgPSBvcHRzLnRpbWUgIT0gdW5kZWZpbmVkID8gb3B0cy50aW1lIDogMDtcbiAgICB0aGlzLl90aW1lID0gMDtcblxuICAgIHRoaXMuZHVyYXRpb24gPSBvcHRzLmR1cmF0aW9uICE9IHVuZGVmaW5lZCA/IG9wdHMuZHVyYXRpb24gOiAwO1xuXG4gICAgdGhpcy5sb29wID0gb3B0cy5sb29wICE9IHVuZGVmaW5lZCA/IG9wdHMubG9vcCA6IHRydWU7XG5cbiAgICB0aGlzLnBsYXlpbmcgPSBvcHRzLnBsYXlpbmcgIT0gdW5kZWZpbmVkID8gb3B0cy5wbGF5aW5nIDogdHJ1ZTtcbiAgICB0aGlzLmVtaXR0aW5nID0gb3B0cy5lbWl0dGluZyAhPSB1bmRlZmluZWQgPyBvcHRzLmVtaXR0aW5nIDogdHJ1ZTtcblxuICAgIHRoaXMucGFydGljbGVzID0gW107XG5cbiAgICB0aGlzLl93ZWJnbEluaXR0ZWQgPSB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLl93ZWJnbFZlcnRleEJ1ZmZlciA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl93ZWJnbFBhcnRpY2xlQnVmZmVyID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3dlYmdsUGFydGljbGVDb2xvckJ1ZmZlciA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuX3dlYmdsVmVydGV4QXJyYXkgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fd2ViZ2xQYXJ0aWNsZUFycmF5ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3dlYmdsUGFydGljbGVDb2xvckFycmF5ID0gdW5kZWZpbmVkO1xufVxuXG5DbGFzcy5leHRlbmQoRW1pdHRlcjJEKTtcblxuXG5FbWl0dGVyMkQucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMucG9zaXRpb25UeXBlID0gb3RoZXIucG9zaXRpb25UeXBlO1xuICAgIHRoaXMudmVsb2NpdHlUeXBlID0gb3RoZXIudmVsb2NpdHlUeXBlO1xuXG4gICAgdGhpcy5tYXRlcmlhbCA9IG90aGVyLm1hdGVyaWFsO1xuXG4gICAgdGhpcy5wb3NpdGlvbi5jb3B5KG90aGVyLnBvc2l0aW9uKTtcbiAgICB0aGlzLnBvc2l0aW9uU3ByZWFkLmNvcHkob3RoZXIucG9zaXRpb25TcHJlYWQpO1xuICAgIHRoaXMucG9zaXRpb25SYWRpdXMgPSBvdGhlci5wb3NpdGlvblJhZGl1cztcblxuICAgIHRoaXMuc3BlZWQgPSBvdGhlci5zcGVlZDtcbiAgICB0aGlzLnNwZWVkU3ByZWFkID0gb3RoZXIuc3BlZWRTcHJlYWQ7XG5cbiAgICB0aGlzLndvcmxkU3BhY2UgPSBvdGhlci53b3JsZFNwYWNlO1xuXG4gICAgdGhpcy5taW5FbWlzc2lvbiA9IG90aGVyLm1pbkVtaXNzaW9uO1xuICAgIHRoaXMubWF4RW1pc3Npb24gPSBvdGhlci5tYXhFbWlzc2lvbjtcblxuICAgIHRoaXMubWluTGlmZSA9IG90aGVyLm1pbkxpZmU7XG4gICAgdGhpcy5tYXhMaWZlID0gb3RoZXIubWF4TGlmZTtcblxuICAgIHRoaXMubWluU2l6ZSA9IG90aGVyLm1pblNpemU7XG4gICAgdGhpcy5tYXhTaXplID0gb3RoZXIubWF4U2l6ZTtcblxuICAgIHRoaXMuc2l6ZVR3ZWVuLmNvcHkob3RoZXIuc2l6ZVR3ZWVuKTtcbiAgICB0aGlzLmFscGhhVHdlZW4uY29weShvdGhlci5hbHBoYVR3ZWVuKTtcbiAgICB0aGlzLmNvbG9yVHdlZW4uY29weShvdGhlci5jb2xvclR3ZWVuKTtcblxuICAgIHRoaXMudmVsb2NpdHkuY29weShvdGhlci52ZWxvY2l0eSk7XG4gICAgdGhpcy52ZWxvY2l0eVNwcmVhZC5jb3B5KG90aGVyLnZlbG9jaXR5U3ByZWFkKTtcblxuICAgIHRoaXMuYWNjZWxlcmF0aW9uLmNvcHkob3RoZXIuYWNjZWxlcmF0aW9uKTtcbiAgICB0aGlzLmFjY2VsZXJhdGlvblNwcmVhZC5jb3B5KG90aGVyLmFjY2VsZXJhdGlvblNwcmVhZCk7XG5cbiAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IG90aGVyLmFuZ3VsYXJWZWxvY2l0eTtcbiAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eVNwcmVhZCA9IG90aGVyLmFuZ3VsYXJWZWxvY2l0eVNwcmVhZDtcblxuICAgIHRoaXMuYW5ndWxhckFjY2VsZXJhdGlvbiA9IG90aGVyLmFuZ3VsYXJBY2NlbGVyYXRpb247XG4gICAgdGhpcy5hbmd1bGFyQWNjZWxlcmF0aW9uU3ByZWFkID0gb3RoZXIuYW5ndWxhckFjY2VsZXJhdGlvblNwcmVhZDtcblxuICAgIHRoaXMucmFuZG9tQW5nbGUgPSBvdGhlci5yYW5kb21BbmdsZTtcblxuICAgIHRoaXMuZW1pc3Npb25SYXRlID0gb3RoZXIuZW1pc3Npb25SYXRlO1xuXG4gICAgdGhpcy5jb2xvci5jb3B5KG90aGVyLmNvbG9yKTtcbiAgICB0aGlzLmNvbG9yU3ByZWFkLmNvcHkob3RoZXIuY29sb3JTcHJlYWQpO1xuXG4gICAgdGhpcy50aW1lID0gb3RoZXIudGltZTtcbiAgICB0aGlzLl90aW1lID0gb3RoZXIuX3RpbWU7XG5cbiAgICB0aGlzLmR1cmF0aW9uID0gb3RoZXIuZHVyYXRpb247XG4gICAgdGhpcy5sb29wID0gb3RoZXIubG9vcDtcbiAgICB0aGlzLnBsYXlpbmcgPSBvdGhlci5wbGF5aW5nO1xuICAgIHRoaXMuZW1pdHRpbmcgPSBvdGhlci5lbWl0dGluZztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5FbWl0dGVyMkQucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLnRpbWUgPSAwO1xuICAgIHRoaXMucGxheWluZyA9IHRydWU7XG4gICAgdGhpcy5lbWl0dGluZyA9IHRydWU7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuRW1pdHRlcjJELnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcGFydGljbGVzID0gdGhpcy5wYXJ0aWNsZXMsXG4gICAgICAgIGkgPSBwYXJ0aWNsZXMubGVuZ3RoO1xuXG4gICAgdGhpcy50aW1lID0gMDtcbiAgICB0aGlzLl90aW1lID0gMDtcbiAgICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmVtaXR0aW5nID0gZmFsc2U7XG5cbiAgICB3aGlsZSAoaS0tKSBQQVJUSUNMRV9QT09MLnJlbW92ZU9iamVjdChwYXJ0aWNsZXNbaV0pO1xuICAgIHBhcnRpY2xlcy5sZW5ndGggPSAwO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbnZhciBWRUMgPSBuZXcgVmVjMjtcbkVtaXR0ZXIyRC5wcm90b3R5cGUuc3Bhd24gPSBmdW5jdGlvbiAoY291bnQpIHtcbiAgICB2YXIgdHJhbnNmb3JtID0gdGhpcy5wYXJ0aWNsZVN5c3RlbS50cmFuc2Zvcm0gfHwgdGhpcy5wYXJ0aWNsZVN5c3RlbS50cmFuc2Zvcm0yZCxcbiAgICAgICAgdHJhbnNmb3JtUG9zaXRpb24gPSB0cmFuc2Zvcm0udG9Xb3JsZChWRUMuc2V0KDAsIDApKSxcblxuICAgICAgICBwb3NpdGlvbiA9IHRoaXMucG9zaXRpb24sXG4gICAgICAgIHBvc2l0aW9uU3ByZWFkID0gdGhpcy5wb3NpdGlvblNwcmVhZCxcbiAgICAgICAgcG9zaXRpb25SYWRpdXMgPSB0aGlzLnBvc2l0aW9uUmFkaXVzLFxuXG4gICAgICAgIHNwZWVkID0gdGhpcy5zcGVlZCxcbiAgICAgICAgc3BlZWRTcHJlYWQgPSB0aGlzLnNwZWVkU3ByZWFkLFxuXG4gICAgICAgIHBhcnRpY2xlcyA9IHRoaXMucGFydGljbGVzLFxuICAgICAgICBudW1QYXJ0aWNsZTJEcyA9IHBhcnRpY2xlcy5sZW5ndGgsXG5cbiAgICAgICAgd29ybGRTcGFjZSA9IHRoaXMud29ybGRTcGFjZSxcbiAgICAgICAgcmFuZG9tQW5nbGUgPSB0aGlzLnJhbmRvbUFuZ2xlLFxuXG4gICAgICAgIGNvbG9yID0gdGhpcy5jb2xvcixcbiAgICAgICAgY29sb3JTcHJlYWQgPSB0aGlzLmNvbG9yU3ByZWFkLFxuICAgICAgICB1c2VSYW5kQ29sb3IgPSBjb2xvclNwcmVhZC5sZW5ndGhTcSgpID4gMCxcblxuICAgICAgICB2ZWxvY2l0eSA9IHRoaXMudmVsb2NpdHksXG4gICAgICAgIHZlbG9jaXR5U3ByZWFkID0gdGhpcy52ZWxvY2l0eVNwcmVhZCxcblxuICAgICAgICBhY2NlbGVyYXRpb24gPSB0aGlzLmFjY2VsZXJhdGlvbixcbiAgICAgICAgYWNjZWxlcmF0aW9uU3ByZWFkID0gdGhpcy5hY2NlbGVyYXRpb25TcHJlYWQsXG5cbiAgICAgICAgYW5ndWxhclZlbG9jaXR5ID0gdGhpcy5hbmd1bGFyVmVsb2NpdHksXG4gICAgICAgIGFuZ3VsYXJWZWxvY2l0eVNwcmVhZCA9IHRoaXMuYW5ndWxhclZlbG9jaXR5U3ByZWFkLFxuXG4gICAgICAgIGFuZ3VsYXJBY2NlbGVyYXRpb24gPSB0aGlzLmFuZ3VsYXJBY2NlbGVyYXRpb24sXG4gICAgICAgIGFuZ3VsYXJBY2NlbGVyYXRpb25TcHJlYWQgPSB0aGlzLmFuZ3VsYXJBY2NlbGVyYXRpb25TcHJlYWQsXG5cbiAgICAgICAgbWluTGlmZSA9IHRoaXMubWluTGlmZSxcbiAgICAgICAgbWF4TGlmZSA9IHRoaXMubWF4TGlmZSxcblxuICAgICAgICBtaW5TaXplID0gdGhpcy5taW5TaXplLFxuICAgICAgICBtYXhTaXplID0gdGhpcy5tYXhTaXplLFxuXG4gICAgICAgIHBvc2l0aW9uVHlwZSA9IHRoaXMucG9zaXRpb25UeXBlLFxuICAgICAgICB2ZWxvY2l0eVR5cGUgPSB0aGlzLnZlbG9jaXR5VHlwZSxcblxuICAgICAgICBsaW1pdCA9IGNsYW1wVG9wKG51bVBhcnRpY2xlMkRzICsgY291bnQsIEVtaXR0ZXIyRC5NQVhfUEFSVElDTEVTKSAtIG51bVBhcnRpY2xlMkRzLFxuICAgICAgICBwb3N4LCBwb3N5LCB2ZWwsIGFjYywgcG9zLCBjb2wsIGFuZ2xlLCB1LCByLCBkeCwgZHksIHNwZCwgcGFydGljbGU7XG5cbiAgICBpZiAocG9zaXRpb25UeXBlID09PSBFbWl0dGVyVHlwZS5DaXJjbGUgfHwgcG9zaXRpb25UeXBlID09PSBFbWl0dGVyVHlwZS5DaXJjbGVFZGdlKSB7XG4gICAgICAgIHBvc3ggPSByYW5kRmxvYXQoLXBvc2l0aW9uU3ByZWFkLngsIHBvc2l0aW9uU3ByZWFkLngpO1xuICAgICAgICBwb3N5ID0gcmFuZEZsb2F0KC1wb3NpdGlvblNwcmVhZC55LCBwb3NpdGlvblNwcmVhZC55KTtcbiAgICB9XG5cbiAgICB3aGlsZSAobGltaXQtLSkge1xuICAgICAgICBwYXJ0aWNsZSA9IFBBUlRJQ0xFX1BPT0wuY3JlYXRlKCk7XG4gICAgICAgIHBvcyA9IHBhcnRpY2xlLnBvc2l0aW9uO1xuICAgICAgICB2ZWwgPSBwYXJ0aWNsZS52ZWxvY2l0eTtcbiAgICAgICAgYWNjID0gcGFydGljbGUuYWNjZWxlcmF0aW9uO1xuICAgICAgICBjb2wgPSBwYXJ0aWNsZS5jb2xvcjtcblxuICAgICAgICBjb2wuciA9IGNvbG9yLnI7XG4gICAgICAgIGNvbC5nID0gY29sb3IuZztcbiAgICAgICAgY29sLmIgPSBjb2xvci5iO1xuXG4gICAgICAgIGlmICh1c2VSYW5kQ29sb3IpIHtcbiAgICAgICAgICAgIGNvbC5yICs9IGNvbG9yU3ByZWFkLnIgKiByYW5kb20oKTtcbiAgICAgICAgICAgIGNvbC5nICs9IGNvbG9yU3ByZWFkLmcgKiByYW5kb20oKTtcbiAgICAgICAgICAgIGNvbC5iICs9IGNvbG9yU3ByZWFkLmIgKiByYW5kb20oKTtcbiAgICAgICAgICAgIGNvbC5jbm9ybWFsaXplKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAod29ybGRTcGFjZSkge1xuICAgICAgICAgICAgcG9zLnggPSBwb3NpdGlvbi54ICsgdHJhbnNmb3JtUG9zaXRpb24ueDtcbiAgICAgICAgICAgIHBvcy55ID0gcG9zaXRpb24ueSArIHRyYW5zZm9ybVBvc2l0aW9uLnk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwb3MueCA9IHBvc2l0aW9uLng7XG4gICAgICAgICAgICBwb3MueSA9IHBvc2l0aW9uLnk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocG9zaXRpb25UeXBlID09PSBFbWl0dGVyVHlwZS5Cb3gpIHtcbiAgICAgICAgICAgIHBvcy54ICs9IHJhbmRGbG9hdCgtcG9zaXRpb25TcHJlYWQueCwgcG9zaXRpb25TcHJlYWQueCk7XG4gICAgICAgICAgICBwb3MueSArPSByYW5kRmxvYXQoLXBvc2l0aW9uU3ByZWFkLnksIHBvc2l0aW9uU3ByZWFkLnkpO1xuICAgICAgICB9IGVsc2UgeyAvL0VtaXR0ZXJUeXBlLkNpcmNsZVxuICAgICAgICAgICAgYW5nbGUgPSBUV09fUEkgKiByYW5kb20oKTtcbiAgICAgICAgICAgIHUgPSByYW5kb20oKSArIHJhbmRvbSgpO1xuICAgICAgICAgICAgciA9IHUgPiAxID8gMiAtIHUgOiB1O1xuXG4gICAgICAgICAgICBwb3MueCArPSBwb3N4ICsgciAqIGNvcyhhbmdsZSkgKiBwb3NpdGlvblJhZGl1cztcbiAgICAgICAgICAgIHBvcy55ICs9IHBvc3kgKyByICogc2luKGFuZ2xlKSAqIHBvc2l0aW9uUmFkaXVzO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZlbG9jaXR5VHlwZSA9PT0gRW1pdHRlclR5cGUuQm94KSB7XG4gICAgICAgICAgICB2ZWwueCA9IHZlbG9jaXR5LnggKyByYW5kRmxvYXQoLXZlbG9jaXR5U3ByZWFkLngsIHZlbG9jaXR5U3ByZWFkLngpO1xuICAgICAgICAgICAgdmVsLnkgPSB2ZWxvY2l0eS55ICsgcmFuZEZsb2F0KC12ZWxvY2l0eVNwcmVhZC55LCB2ZWxvY2l0eVNwcmVhZC55KTtcbiAgICAgICAgfSBlbHNlIHsgLy9FbWl0dGVyVHlwZS5DaXJjbGVcbiAgICAgICAgICAgIGlmICh3b3JsZFNwYWNlKSB7XG4gICAgICAgICAgICAgICAgZHggPSBwb3MueCAtIChwb3NpdGlvbi54ICsgdHJhbnNmb3JtUG9zaXRpb24ueCk7XG4gICAgICAgICAgICAgICAgZHkgPSBwb3MueSAtIChwb3NpdGlvbi55ICsgdHJhbnNmb3JtUG9zaXRpb24ueSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGR4ID0gcG9zLnggLSBwb3NpdGlvbi54O1xuICAgICAgICAgICAgICAgIGR5ID0gcG9zLnkgLSBwb3NpdGlvbi55O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3BkID0gc3BlZWQgKyByYW5kRmxvYXQoLXNwZWVkU3ByZWFkLCBzcGVlZFNwcmVhZCk7XG5cbiAgICAgICAgICAgIHIgPSBkeCAqIGR4ICsgZHkgKiBkeTtcbiAgICAgICAgICAgIHIgPSByICE9PSAwID8gMSAvIHNxcnQocikgOiByO1xuXG4gICAgICAgICAgICB2ZWwueCA9IGR4ICogciAqIHNwZDtcbiAgICAgICAgICAgIHZlbC55ID0gZHkgKiByICogc3BkO1xuICAgICAgICB9XG5cbiAgICAgICAgYWNjLnggPSBhY2NlbGVyYXRpb24ueCArIHJhbmRGbG9hdCgtYWNjZWxlcmF0aW9uU3ByZWFkLngsIGFjY2VsZXJhdGlvblNwcmVhZC54KTtcbiAgICAgICAgYWNjLnkgPSBhY2NlbGVyYXRpb24ueSArIHJhbmRGbG9hdCgtYWNjZWxlcmF0aW9uU3ByZWFkLnksIGFjY2VsZXJhdGlvblNwcmVhZC55KTtcblxuICAgICAgICBwYXJ0aWNsZS5hbmd1bGFyVmVsb2NpdHkgPSBhbmd1bGFyVmVsb2NpdHkgKyByYW5kRmxvYXQoLWFuZ3VsYXJWZWxvY2l0eVNwcmVhZCwgYW5ndWxhclZlbG9jaXR5U3ByZWFkKTtcbiAgICAgICAgcGFydGljbGUuYW5ndWxhckFjY2VsZXJhdGlvbiA9IGFuZ3VsYXJBY2NlbGVyYXRpb24gKyByYW5kRmxvYXQoLWFuZ3VsYXJBY2NlbGVyYXRpb25TcHJlYWQsIGFuZ3VsYXJBY2NlbGVyYXRpb25TcHJlYWQpO1xuXG4gICAgICAgIHBhcnRpY2xlLmFscGhhID0gMTtcbiAgICAgICAgcGFydGljbGUuYW5nbGUgPSByYW5kb21BbmdsZSA/IHJhbmRvbSgpICogVFdPX1BJIDogMDtcbiAgICAgICAgcGFydGljbGUubGlmZVRpbWUgPSAwO1xuICAgICAgICBwYXJ0aWNsZS5saWZlID0gcmFuZEZsb2F0KG1pbkxpZmUsIG1heExpZmUpO1xuICAgICAgICBwYXJ0aWNsZS5zaXplID0gcmFuZEZsb2F0KG1pblNpemUsIG1heFNpemUpO1xuXG4gICAgICAgIHBhcnRpY2xlcy5wdXNoKHBhcnRpY2xlKTtcbiAgICB9XG59O1xuXG5cbkVtaXR0ZXIyRC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGR0KSB7XG4gICAgaWYgKCF0aGlzLnBsYXlpbmcpIHJldHVybjtcbiAgICB2YXIgcGFydGljbGVzID0gdGhpcy5wYXJ0aWNsZXMsXG4gICAgICAgIHNpemVUd2VlbiA9IHRoaXMuc2l6ZVR3ZWVuLFxuICAgICAgICBhbHBoYVR3ZWVuID0gdGhpcy5hbHBoYVR3ZWVuLFxuICAgICAgICBjb2xvclR3ZWVuID0gdGhpcy5jb2xvclR3ZWVuLFxuICAgICAgICBzaXplVHdlZW5VcGRhdGUgPSBzaXplVHdlZW4udGltZXMubGVuZ3RoID4gMCxcbiAgICAgICAgYWxwaGFUd2VlblVwZGF0ZSA9IGFscGhhVHdlZW4udGltZXMubGVuZ3RoID4gMCxcbiAgICAgICAgY29sb3JUd2VlblVwZGF0ZSA9IGNvbG9yVHdlZW4udGltZXMubGVuZ3RoID4gMCxcbiAgICAgICAgcGFydGljbGUsIGxpZmUsIGNvdW50LFxuICAgICAgICBpO1xuXG4gICAgdGhpcy50aW1lICs9IGR0O1xuICAgIHRoaXMuX3RpbWUgKz0gZHQ7XG4gICAgY291bnQgPSB0aGlzLl90aW1lIC8gdGhpcy5lbWlzc2lvblJhdGU7XG5cbiAgICBpZiAodGhpcy5lbWl0dGluZyAmJiBjb3VudCA+PSAxKSB7XG4gICAgICAgIHRoaXMuX3RpbWUgPSAwO1xuICAgICAgICB0aGlzLnNwYXduKHJhbmRJbnQodGhpcy5taW5FbWlzc2lvbiwgdGhpcy5tYXhFbWlzc2lvbikgKiAoY291bnQgfCAwKSk7XG5cbiAgICAgICAgaWYgKCF0aGlzLmxvb3AgJiYgdGhpcy50aW1lID4gdGhpcy5kdXJhdGlvbikgdGhpcy5lbWl0dGluZyA9IGZhbHNlO1xuICAgIH1cblxuICAgIGkgPSBwYXJ0aWNsZXMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgcGFydGljbGUgPSBwYXJ0aWNsZXNbaV07XG4gICAgICAgIHBhcnRpY2xlLnVwZGF0ZShkdCk7XG4gICAgICAgIGxpZmUgPSBwYXJ0aWNsZS5saWZlVGltZSAvIHBhcnRpY2xlLmxpZmU7XG5cbiAgICAgICAgaWYgKHNpemVUd2VlblVwZGF0ZSkgcGFydGljbGUuc2l6ZSA9IHNpemVUd2Vlbi51cGRhdGUobGlmZSk7XG4gICAgICAgIGlmIChhbHBoYVR3ZWVuVXBkYXRlKSBwYXJ0aWNsZS5hbHBoYSA9IGFscGhhVHdlZW4udXBkYXRlKGxpZmUpO1xuICAgICAgICBpZiAoY29sb3JUd2VlblVwZGF0ZSkgY29sb3JUd2Vlbi51cGRhdGUobGlmZSwgcGFydGljbGUuY29sb3IpO1xuXG4gICAgICAgIGlmIChsaWZlID4gMSkge1xuICAgICAgICAgICAgUEFSVElDTEVfUE9PTC5yZW1vdmVPYmplY3QocGFydGljbGUpO1xuICAgICAgICAgICAgcGFydGljbGVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmVtaXR0aW5nICYmIHBhcnRpY2xlcy5sZW5ndGggPT09IDApIHRoaXMucGxheWluZyA9IGZhbHNlO1xufTtcblxuXG5FbWl0dGVyMkQucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiA9IENsYXNzLnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIGpzb24udHlwZSA9IDE7XG5cbiAgICBqc29uLnBvc2l0aW9uVHlwZSA9IHRoaXMucG9zaXRpb25UeXBlO1xuICAgIGpzb24udmVsb2NpdHlUeXBlID0gdGhpcy52ZWxvY2l0eVR5cGU7XG5cbiAgICBqc29uLm1hdGVyaWFsID0gdGhpcy5tYXRlcmlhbCA/IHRoaXMubWF0ZXJpYWwubmFtZSA6IHVuZGVmaW5lZDtcblxuICAgIGpzb24ucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uLnRvSlNPTihqc29uLnBvc2l0aW9uKTtcbiAgICBqc29uLnBvc2l0aW9uU3ByZWFkID0gdGhpcy5wb3NpdGlvblNwcmVhZC50b0pTT04oanNvbi5wb3NpdGlvblNwcmVhZCk7XG4gICAganNvbi5wb3NpdGlvblJhZGl1cyA9IHRoaXMucG9zaXRpb25SYWRpdXM7XG5cbiAgICBqc29uLnNwZWVkID0gdGhpcy5zcGVlZDtcbiAgICBqc29uLnNwZWVkU3ByZWFkID0gdGhpcy5zcGVlZFNwcmVhZDtcblxuICAgIGpzb24ud29ybGRTcGFjZSA9IHRoaXMud29ybGRTcGFjZTtcblxuICAgIGpzb24ubWluRW1pc3Npb24gPSB0aGlzLm1pbkVtaXNzaW9uO1xuICAgIGpzb24ubWF4RW1pc3Npb24gPSB0aGlzLm1heEVtaXNzaW9uO1xuXG4gICAganNvbi5taW5MaWZlID0gdGhpcy5taW5MaWZlO1xuICAgIGpzb24ubWF4TGlmZSA9IHRoaXMubWF4TGlmZTtcblxuICAgIGpzb24ubWluU2l6ZSA9IHRoaXMubWluU2l6ZTtcbiAgICBqc29uLm1heFNpemUgPSB0aGlzLm1heFNpemU7XG5cbiAgICBqc29uLnNpemVUd2VlbiA9IHRoaXMuc2l6ZVR3ZWVuLnRvSlNPTihqc29uLnNpemVUd2Vlbik7XG4gICAganNvbi5hbHBoYVR3ZWVuID0gdGhpcy5hbHBoYVR3ZWVuLnRvSlNPTihqc29uLmFscGhhVHdlZW4pO1xuICAgIGpzb24uY29sb3JUd2VlbiA9IHRoaXMuY29sb3JUd2Vlbi50b0pTT04oanNvbi5jb2xvclR3ZWVuKTtcblxuICAgIGpzb24udmVsb2NpdHkgPSB0aGlzLnZlbG9jaXR5LnRvSlNPTihqc29uLnZlbG9jaXR5KTtcbiAgICBqc29uLnZlbG9jaXR5U3ByZWFkID0gdGhpcy52ZWxvY2l0eVNwcmVhZC50b0pTT04oanNvbi52ZWxvY2l0eVNwcmVhZCk7XG5cbiAgICBqc29uLmFjY2VsZXJhdGlvbiA9IHRoaXMuYWNjZWxlcmF0aW9uLnRvSlNPTihqc29uLmFjY2VsZXJhdGlvbik7XG4gICAganNvbi5hY2NlbGVyYXRpb25TcHJlYWQgPSB0aGlzLmFjY2VsZXJhdGlvblNwcmVhZC50b0pTT04oanNvbi5hY2NlbGVyYXRpb25TcHJlYWQpO1xuXG4gICAganNvbi5hbmd1bGFyVmVsb2NpdHkgPSB0aGlzLmFuZ3VsYXJWZWxvY2l0eTtcbiAgICBqc29uLmFuZ3VsYXJBY2NlbGVyYXRpb24gPSB0aGlzLmFuZ3VsYXJBY2NlbGVyYXRpb247XG5cbiAgICBqc29uLmFuZ3VsYXJWZWxvY2l0eVNwcmVhZCA9IHRoaXMuYW5ndWxhclZlbG9jaXR5U3ByZWFkO1xuICAgIGpzb24ucmFuZG9tQW5nbGUgPSB0aGlzLnJhbmRvbUFuZ2xlO1xuXG4gICAganNvbi5lbWlzc2lvblJhdGUgPSB0aGlzLmVtaXNzaW9uUmF0ZTtcblxuICAgIGpzb24uY29sb3IgPSB0aGlzLmNvbG9yLnRvSlNPTihqc29uLmNvbG9yKTtcbiAgICBqc29uLmNvbG9yU3ByZWFkID0gdGhpcy5jb2xvclNwcmVhZC50b0pTT04oanNvbi5jb2xvclNwcmVhZCk7XG5cbiAgICBqc29uLnRpbWUgPSB0aGlzLnRpbWU7XG4gICAganNvbi5fdGltZSA9IHRoaXMuX3RpbWU7XG5cbiAgICBqc29uLmR1cmF0aW9uID0gdGhpcy5kdXJhdGlvbjtcbiAgICBqc29uLmxvb3AgPSB0aGlzLmxvb3A7XG4gICAganNvbi5wbGF5aW5nID0gdGhpcy5wbGF5aW5nO1xuICAgIGpzb24uZW1pdHRpbmcgPSB0aGlzLmVtaXR0aW5nO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbkVtaXR0ZXIyRC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENsYXNzLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy5wb3NpdGlvblR5cGUgPSBqc29uLnBvc2l0aW9uVHlwZTtcbiAgICB0aGlzLnZlbG9jaXR5VHlwZSA9IGpzb24udmVsb2NpdHlUeXBlO1xuXG4gICAgdGhpcy5tYXRlcmlhbCA9IGpzb24ubWF0ZXJpYWwgPyBBc3NldHMuZ2V0KGpzb24ubWF0ZXJpYWwpIDogdW5kZWZpbmVkO1xuXG4gICAgdGhpcy5wb3NpdGlvbi5mcm9tSlNPTihqc29uLnBvc2l0aW9uKTtcbiAgICB0aGlzLnBvc2l0aW9uU3ByZWFkLmZyb21KU09OKGpzb24ucG9zaXRpb25TcHJlYWQpO1xuICAgIHRoaXMucG9zaXRpb25SYWRpdXMgPSBqc29uLnBvc2l0aW9uUmFkaXVzO1xuXG4gICAgdGhpcy5zcGVlZCA9IGpzb24uc3BlZWQ7XG4gICAgdGhpcy5zcGVlZFNwcmVhZCA9IGpzb24uc3BlZWRTcHJlYWQ7XG5cbiAgICB0aGlzLndvcmxkU3BhY2UgPSBqc29uLndvcmxkU3BhY2U7XG5cbiAgICB0aGlzLm1pbkVtaXNzaW9uID0ganNvbi5taW5FbWlzc2lvbjtcbiAgICB0aGlzLm1heEVtaXNzaW9uID0ganNvbi5tYXhFbWlzc2lvbjtcblxuICAgIHRoaXMubWluTGlmZSA9IGpzb24ubWluTGlmZTtcbiAgICB0aGlzLm1heExpZmUgPSBqc29uLm1heExpZmU7XG5cbiAgICB0aGlzLm1pblNpemUgPSBqc29uLm1pblNpemU7XG4gICAgdGhpcy5tYXhTaXplID0ganNvbi5tYXhTaXplO1xuXG4gICAgdGhpcy5zaXplVHdlZW4uZnJvbUpTT04oanNvbi5zaXplVHdlZW4pO1xuICAgIHRoaXMuYWxwaGFUd2Vlbi5mcm9tSlNPTihqc29uLmFscGhhVHdlZW4pO1xuICAgIHRoaXMuY29sb3JUd2Vlbi5mcm9tSlNPTihqc29uLmNvbG9yVHdlZW4pO1xuXG4gICAgdGhpcy52ZWxvY2l0eS5mcm9tSlNPTihqc29uLnZlbG9jaXR5KTtcbiAgICB0aGlzLnZlbG9jaXR5U3ByZWFkLmZyb21KU09OKGpzb24udmVsb2NpdHlTcHJlYWQpO1xuXG4gICAgdGhpcy5hY2NlbGVyYXRpb24uZnJvbUpTT04oanNvbi5hY2NlbGVyYXRpb24pO1xuICAgIHRoaXMuYWNjZWxlcmF0aW9uU3ByZWFkLmZyb21KU09OKGpzb24uYWNjZWxlcmF0aW9uU3ByZWFkKTtcblxuICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5ID0ganNvbi5hbmd1bGFyVmVsb2NpdHk7XG4gICAgdGhpcy5hbmd1bGFyQWNjZWxlcmF0aW9uID0ganNvbi5hbmd1bGFyQWNjZWxlcmF0aW9uO1xuXG4gICAgdGhpcy5hbmd1bGFyVmVsb2NpdHlTcHJlYWQgPSBqc29uLmFuZ3VsYXJWZWxvY2l0eVNwcmVhZDtcbiAgICB0aGlzLnJhbmRvbUFuZ2xlID0ganNvbi5yYW5kb21BbmdsZTtcblxuICAgIHRoaXMuZW1pc3Npb25SYXRlID0ganNvbi5lbWlzc2lvblJhdGU7XG5cbiAgICB0aGlzLmNvbG9yLmZyb21KU09OKGpzb24uY29sb3IpO1xuICAgIHRoaXMuY29sb3JTcHJlYWQuZnJvbUpTT04oanNvbi5jb2xvclNwcmVhZCk7XG5cbiAgICB0aGlzLnRpbWUgPSBqc29uLnRpbWU7XG4gICAgdGhpcy5fdGltZSA9IGpzb24uX3RpbWU7XG5cbiAgICB0aGlzLmR1cmF0aW9uID0ganNvbi5kdXJhdGlvbjtcbiAgICB0aGlzLmxvb3AgPSBqc29uLmxvb3A7XG4gICAgdGhpcy5wbGF5aW5nID0ganNvbi5wbGF5aW5nO1xuICAgIHRoaXMuZW1pdHRpbmcgPSBqc29uLmVtaXR0aW5nO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkVtaXR0ZXIyRC5NQVhfUEFSVElDTEVTID0gMTAyNDtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEVtaXR0ZXIyRDtcbiIsInZhciBWZWMzID0gcmVxdWlyZShcIi4uLy4uLy4uL21hdGgvdmVjM1wiKTtcbnZhciBDb2xvciA9IHJlcXVpcmUoXCIuLi8uLi8uLi9tYXRoL2NvbG9yXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gUGFydGljbGUoKSB7XG5cbiAgICB0aGlzLnogPSAxO1xuICAgIHRoaXMuYWxwaGEgPSAxO1xuXG4gICAgdGhpcy5saWZlVGltZSA9IDA7XG4gICAgdGhpcy5saWZlID0gMTtcblxuICAgIHRoaXMuc2l6ZSA9IDE7XG5cbiAgICB0aGlzLmNvbG9yID0gbmV3IENvbG9yO1xuXG4gICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBWZWMzO1xuICAgIHRoaXMudmVsb2NpdHkgPSBuZXcgVmVjMztcbiAgICB0aGlzLmFjY2VsZXJhdGlvbiA9IG5ldyBWZWMzO1xuXG4gICAgdGhpcy5hbmdsZSA9IDA7XG4gICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkgPSAwO1xuICAgIHRoaXMuYW5ndWxhckFjY2VsZXJhdGlvbiA9IDA7XG59XG5cblxuUGFydGljbGUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkdCkge1xuICAgIHZhciBwb3MgPSB0aGlzLnBvc2l0aW9uLFxuICAgICAgICB2ZWwgPSB0aGlzLnZlbG9jaXR5LFxuICAgICAgICBhY2MgPSB0aGlzLmFjY2VsZXJhdGlvbjtcblxuICAgIHBvcy54ICs9IHZlbC54ICogZHQ7XG4gICAgcG9zLnkgKz0gdmVsLnkgKiBkdDtcbiAgICBwb3MueiArPSB2ZWwueiAqIGR0O1xuXG4gICAgdmVsLnggKz0gYWNjLnggKiBkdDtcbiAgICB2ZWwueSArPSBhY2MueSAqIGR0O1xuICAgIHZlbC56ICs9IGFjYy56ICogZHQ7XG5cbiAgICB0aGlzLmFuZ2xlICs9IHRoaXMuYW5ndWxhclZlbG9jaXR5ICogZHQ7XG4gICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkgKz0gdGhpcy5hbmd1bGFyQWNjZWxlcmF0aW9uICogZHQ7XG5cbiAgICB0aGlzLmxpZmVUaW1lICs9IGR0O1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFBhcnRpY2xlO1xuIiwidmFyIFZlYzIgPSByZXF1aXJlKFwiLi4vLi4vLi4vbWF0aC92ZWMyXCIpO1xudmFyIENvbG9yID0gcmVxdWlyZShcIi4uLy4uLy4uL21hdGgvY29sb3JcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBQYXJ0aWNsZTJEKCkge1xuXG4gICAgdGhpcy5hbHBoYSA9IDE7XG5cbiAgICB0aGlzLmxpZmVUaW1lID0gMDtcbiAgICB0aGlzLmxpZmUgPSAxO1xuXG4gICAgdGhpcy5zaXplID0gMTtcblxuICAgIHRoaXMuY29sb3IgPSBuZXcgQ29sb3I7XG5cbiAgICB0aGlzLnBvc2l0aW9uID0gbmV3IFZlYzI7XG4gICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBWZWMyO1xuICAgIHRoaXMuYWNjZWxlcmF0aW9uID0gbmV3IFZlYzI7XG5cbiAgICB0aGlzLmFuZ2xlID0gMDtcbiAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IDA7XG4gICAgdGhpcy5hbmd1bGFyQWNjZWxlcmF0aW9uID0gMDtcbn1cblxuXG5QYXJ0aWNsZTJELnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZHQpIHtcbiAgICB2YXIgcG9zID0gdGhpcy5wb3NpdGlvbixcbiAgICAgICAgdmVsID0gdGhpcy52ZWxvY2l0eSxcbiAgICAgICAgYWNjID0gdGhpcy5hY2NlbGVyYXRpb247XG5cbiAgICBwb3MueCArPSB2ZWwueCAqIGR0O1xuICAgIHBvcy55ICs9IHZlbC55ICogZHQ7XG5cbiAgICB2ZWwueCArPSBhY2MueCAqIGR0O1xuICAgIHZlbC55ICs9IGFjYy55ICogZHQ7XG5cbiAgICB0aGlzLmFuZ2xlICs9IHRoaXMuYW5ndWxhclZlbG9jaXR5ICogZHQ7XG4gICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkgKz0gdGhpcy5hbmd1bGFyQWNjZWxlcmF0aW9uICogZHQ7XG5cbiAgICB0aGlzLmxpZmVUaW1lICs9IGR0O1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFBhcnRpY2xlMkQ7XG4iLCJ2YXIgQ2xhc3MgPSByZXF1aXJlKFwiLi4vLi4vLi4vYmFzZS9jbGFzc1wiKTtcbnZhciBUaW1lID0gcmVxdWlyZShcIi4uLy4uLy4uL2Jhc2UvdGltZVwiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi4vLi4vLi4vYmFzZS9sb2dcIik7XG52YXIgQ29tcG9uZW50ID0gcmVxdWlyZShcIi4uL2NvbXBvbmVudFwiKTtcbnZhciBFbWl0dGVyID0gcmVxdWlyZShcIi4vZW1pdHRlclwiKTtcbnZhciBFbWl0dGVyMkQgPSByZXF1aXJlKFwiLi9lbWl0dGVyXzJkXCIpO1xudmFyIFR3ZWVuID0gcmVxdWlyZShcIi4vdHdlZW5cIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG4vKipcbiAqIEBjbGFzcyBQYXJ0aWNsZVN5c3RlbVxuICogQGV4dGVuZHMgQ29tcG9uZW50XG4gKiBAYnJpZWYgMmQgcGFydGljbGUgZW1pdHRlclxuICogQHBhcmFtIE9iamVjdCBvcHRpb25zXG4gKi9cbmZ1bmN0aW9uIFBhcnRpY2xlU3lzdGVtKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQ29tcG9uZW50LmNhbGwodGhpcywgXCJQYXJ0aWNsZVN5c3RlbVwiLCBvcHRzKTtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBCb29sZWFuIHBsYXlpbmdcbiAgICAgKiBAbWVtYmVyb2YgUGFydGljbGVTeXN0ZW1cbiAgICAgKi9cbiAgICB0aGlzLnBsYXlpbmcgPSBvcHRzLnBsYXlpbmcgIT0gdW5kZWZpbmVkID8gb3B0cy5wbGF5aW5nIDogdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBBcnJheSBlbWl0dGVyc1xuICAgICAqIEBtZW1iZXJvZiBQYXJ0aWNsZVN5c3RlbVxuICAgICAqL1xuICAgIHRoaXMuZW1pdHRlcnMgPSBbXTtcbiAgICB0aGlzLl9lbWl0dGVySGFzaCA9IHt9O1xuICAgIHRoaXMuX2VtaXR0ZXJKU09OSGFzaCA9IHt9O1xuXG4gICAgaWYgKG9wdHMuZW1pdHRlcikgdGhpcy5hZGRFbWl0dGVyKG9wdHMuZW1pdHRlcik7XG4gICAgaWYgKG9wdHMuZW1pdHRlcnMpIHRoaXMuYWRkLmFwcGx5KHRoaXMsIG9wdHMuZW1pdHRlcnMpO1xufVxuXG5QYXJ0aWNsZVN5c3RlbS50eXBlID0gXCJQYXJ0aWNsZVN5c3RlbVwiO1xuQ29tcG9uZW50LmV4dGVuZChQYXJ0aWNsZVN5c3RlbSk7XG5cblxuUGFydGljbGVTeXN0ZW0uRW1pdHRlciA9IEVtaXR0ZXI7XG5QYXJ0aWNsZVN5c3RlbS5FbWl0dGVyMkQgPSBFbWl0dGVyMkQ7XG5QYXJ0aWNsZVN5c3RlbS5Ud2VlbiA9IFR3ZWVuO1xuXG5cblBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIGVtaXR0ZXJzID0gdGhpcy5lbWl0dGVycyxcbiAgICAgICAgb3RoZXJFbWl0dGVycyA9IG90aGVyLmVtaXR0ZXJzLFxuICAgICAgICBpID0gb3RoZXJFbWl0dGVycy5sZW5ndGgsXG4gICAgICAgIGogPSBlbWl0dGVycy5sZW5ndGgsXG4gICAgICAgIGVtaXR0ZXIsIG90aGVyRW1pdHRlcjtcblxuICAgIHdoaWxlIChpLS0gPiBqKSB0aGlzLnJlbW92ZUVtaXR0ZXIoZW1pdHRlcnNbaV0pO1xuXG4gICAgaSA9IG90aGVyRW1pdHRlcnMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgb3RoZXJFbWl0dGVyID0gb3RoZXJFbWl0dGVyc1tpXTtcblxuICAgICAgICBpZiAoKGVtaXR0ZXIgPSBlbWl0dGVyc1tpXSkpIHtcbiAgICAgICAgICAgIGlmICgoZW1pdHRlci5fY2xhc3NOYW1lID09PSBvdGhlckVtaXR0ZXIuX2NsYXNzTmFtZSkpIHtcbiAgICAgICAgICAgICAgICBvdGhlckVtaXR0ZXJzW2ldLmNvcHkob3RoZXIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUVtaXR0ZXIoZW1pdHRlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRFbWl0dGVyKG90aGVyRW1pdHRlci5jbG9uZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWRkRW1pdHRlcihvdGhlckVtaXR0ZXIuY2xvbmUoKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5wbGF5aW5nID0gb3RoZXIucGxheWluZztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5QYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5jbGVhci5jYWxsKHRoaXMpO1xuICAgIHZhciBlbWl0dGVycyA9IHRoaXMuZW1pdHRlcnMsXG4gICAgICAgIGkgPSBlbWl0dGVycy5sZW5ndGg7XG4gICAgO1xuXG4gICAgd2hpbGUgKGktLSkgZW1pdHRlcnNbaV0uY2xlYXIoKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlLmFkZEVtaXR0ZXIgPSBmdW5jdGlvbiAoZW1pdHRlcikge1xuICAgIHZhciBlbWl0dGVycyA9IHRoaXMuZW1pdHRlcnMsXG4gICAgICAgIGluZGV4ID0gZW1pdHRlcnMuaW5kZXhPZihlbWl0dGVyKTtcblxuICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgaWYgKGVtaXR0ZXIucGFydGljbGVTeXN0ZW0pIGVtaXR0ZXIgPSBlbWl0dGVyLmNsb25lKCk7XG5cbiAgICAgICAgZW1pdHRlci5wYXJ0aWNsZVN5c3RlbSA9IHRoaXM7XG4gICAgICAgIGVtaXR0ZXJzLnB1c2goZW1pdHRlcik7XG4gICAgICAgIHRoaXMuX2VtaXR0ZXJIYXNoW2VtaXR0ZXIuX2lkXSA9IGVtaXR0ZXI7XG4gICAgICAgIGlmIChlbWl0dGVyLl9qc29uSWQgIT09IC0xKSB0aGlzLl9lbWl0dGVySGFzaFtlbWl0dGVyLl9qc29uSWRdID0gZW1pdHRlcjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBMb2cuZXJyb3IoXCJQYXJ0aWNsZVN5c3RlbS5hZGRFbWl0dGVyOiBQYXJ0aWNsZVN5c3RlbSBhbHJlYWR5IGhhcyBwYXNzZWQgRW1pdHRlclwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLmFkZEVtaXR0ZXIoYXJndW1lbnRzW2ldKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlLnJlbW92ZUVtaXR0ZXIgPSBmdW5jdGlvbiAoZW1pdHRlcikge1xuICAgIHZhciBlbWl0dGVycyA9IHRoaXMuZW1pdHRlcnMsXG4gICAgICAgIGluZGV4ID0gZW1pdHRlcnMuaW5kZXhPZihlbWl0dGVyKTtcblxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgZW1pdHRlcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5fZW1pdHRlckhhc2hbZW1pdHRlci5faWRdID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoZW1pdHRlci5fanNvbklkICE9PSAtMSkgdGhpcy5fZW1pdHRlckhhc2hbZW1pdHRlci5fanNvbklkXSA9IHVuZGVmaW5lZDtcblxuICAgICAgICBlbWl0dGVyLmNsZWFyKCk7XG4gICAgICAgIGVtaXR0ZXIucGFydGljbGVTeXN0ZW0gPSB1bmRlZmluZWQ7XG4gICAgICAgIGVtaXR0ZXIudHJhbnNmb3JtID0gdW5kZWZpbmVkO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIlBhcnRpY2xlU3lzdGVtLnJlbW92ZUVtaXR0ZXI6IFBhcnRpY2xlU3lzdGVtIGRvZXMgbm90IGhhdmUgcGFzc2VkIEVtaXR0ZXJcIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGkgPSBhcmd1bWVudHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkgdGhpcy5yZW1vdmVFbWl0dGVyKGFyZ3VtZW50c1tpXSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZS5maW5kRW1pdHRlckJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9lbWl0dGVySGFzaFtpZF07XG59O1xuXG5cblBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZS5maW5kRW1pdHRlckJ5SlNPTklkID0gZnVuY3Rpb24gKGlkKSB7XG5cbiAgICByZXR1cm4gdGhpcy5fZW1pdHRlckpTT05IYXNoW2lkXTtcbn07XG5cblxuLyoqXG4gKiBAbWV0aG9kIHBsYXlcbiAqIEBtZW1iZXJvZiBQYXJ0aWNsZVN5c3RlbVxuICovXG5QYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZW1pdHRlcnMgPSB0aGlzLmVtaXR0ZXJzLFxuICAgICAgICBpID0gZW1pdHRlcnMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkgZW1pdHRlcnNbaV0ucGxheSgpO1xuICAgIHRoaXMucGxheWluZyA9IHRydWU7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuUGFydGljbGVTeXN0ZW0ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMucGxheWluZykgcmV0dXJuO1xuXG4gICAgdmFyIGR0ID0gVGltZS5kZWx0YSxcbiAgICAgICAgZW1pdHRlcnMgPSB0aGlzLmVtaXR0ZXJzLFxuICAgICAgICBlbWl0dGVyLCBwbGF5aW5nID0gZmFsc2UsXG4gICAgICAgIGkgPSBlbWl0dGVycy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGVtaXR0ZXIgPSBlbWl0dGVyc1tpXTtcbiAgICAgICAgZW1pdHRlci51cGRhdGUoZHQpO1xuICAgICAgICBpZiAoZW1pdHRlci5wbGF5aW5nKSBwbGF5aW5nID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB0aGlzLnBsYXlpbmcgPSBwbGF5aW5nO1xufTtcblxuXG5QYXJ0aWNsZVN5c3RlbS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gQ29tcG9uZW50LnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcbiAgICB2YXIgZW1pdHRlcnMgPSB0aGlzLmVtaXR0ZXJzLFxuICAgICAgICBqc29uRW1pdHRlcnMgPSBqc29uLmVtaXR0ZXJzIHx8IChqc29uLmVtaXR0ZXJzID0gW10pLFxuICAgICAgICBpID0gZW1pdHRlcnMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBqc29uRW1pdHRlcnNbaV0gPSBlbWl0dGVyc1tpXS50b0pTT04oanNvbkVtaXR0ZXJzW2ldKTtcbiAgICB9XG4gICAganNvbi5wbGF5aW5nID0gdGhpcy5wbGF5aW5nO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cblBhcnRpY2xlU3lzdGVtLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuICAgIHZhciBqc29uRW1pdHRlcnMgPSBqc29uLmVtaXR0ZXJzLFxuICAgICAgICBlbWl0dGVyLCBqc29uRW1pdHRlcixcbiAgICAgICAgaSA9IGpzb25FbWl0dGVycy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGpzb25FbWl0dGVyID0ganNvbkVtaXR0ZXJzW2ldO1xuXG4gICAgICAgIGlmICgoZW1pdHRlciA9IHRoaXMuZmluZEVtaXR0ZXJCeUpTT05JZChqc29uRW1pdHRlci5faWQpKSkge1xuICAgICAgICAgICAgZW1pdHRlci5mcm9tSlNPTihqc29uRW1pdHRlcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFkZEVtaXR0ZXIoQ2xhc3MuZnJvbUpTT04oanNvbkVtaXR0ZXIpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnBsYXlpbmcgPSBqc29uLnBsYXlpbmc7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBQYXJ0aWNsZVN5c3RlbTtcbiIsInZhciBDbGFzcyA9IHJlcXVpcmUoXCIuLi8uLi8uLi9iYXNlL2NsYXNzXCIpO1xudmFyIE1hdGhmID0gcmVxdWlyZShcIi4uLy4uLy4uL21hdGgvbWF0aGZcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBUd2VlbihvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIHRoaXMudGltZXMgPSBvcHRzLnRpbWVzIHx8IFtdO1xuICAgIHRoaXMudmFsdWVzID0gb3B0cy52YWx1ZXMgfHwgW107XG59XG5cblxuVHdlZW4ucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMudGltZXMgPSBvdGhlci50aW1lcy5zbGljZSgpO1xuICAgIHRoaXMudmFsdWVzID0gb3RoZXIudmFsdWVzLnNsaWNlKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuVHdlZW4ucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy50aW1lcy5sZW5ndGggPSAwO1xuICAgIHRoaXMudmFsdWVzLmxlbmd0aCA9IDA7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuVHdlZW4ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICh0aW1lLCBvdXQpIHtcbiAgICB2YXIgdGltZXMgPSB0aGlzLnRpbWVzLFxuICAgICAgICB2YWx1ZXMgPSB0aGlzLnZhbHVlcyxcbiAgICAgICAgbiA9IHRpbWVzLmxlbmd0aCxcbiAgICAgICAgaSA9IDAsXG4gICAgICAgIHQ7XG5cbiAgICB3aGlsZSAoaSA8IG4gJiYgdGltZSA+IHRpbWVzW2ldKSBpKys7XG5cbiAgICBpZiAoaSA9PT0gMCkgcmV0dXJuIHZhbHVlc1swXTtcbiAgICBpZiAoaSA9PT0gbikgcmV0dXJuIHZhbHVlc1tuIC0gMV07XG5cbiAgICB0ID0gKHRpbWUgLSB0aW1lc1tpIC0gMV0pIC8gKHRpbWVzW2ldIC0gdGltZXNbaSAtIDFdKTtcblxuICAgIGlmIChvdXQpIHJldHVybiBvdXQuY29weSh2YWx1ZXNbaSAtIDFdKS5sZXJwKHZhbHVlc1tpXSwgdCk7XG4gICAgcmV0dXJuIHZhbHVlc1tpIC0gMV0gKyB0ICogKHZhbHVlc1tpXSAtIHZhbHVlc1tpIC0gMV0pO1xufTtcblxuXG5Ud2Vlbi5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0ge30pO1xuICAgIHZhciB0aW1lcyA9IHRoaXMudGltZXMsXG4gICAgICAgIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICBqc29uVGltZXMgPSBqc29uLnRpbWVzIHx8IChqc29uLnRpbWVzID0gW10pLFxuICAgICAgICBqc29uVmFsdWVzID0ganNvbi52YWx1ZXMgfHwgKGpzb24udmFsdWVzID0gW10pLFxuICAgICAgICBpO1xuXG4gICAgaSA9IHRpbWVzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSBqc29uVGltZXNbaV0gPSB0aW1lc1tpXTtcblxuICAgIGkgPSB2YWx1ZXMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIGpzb25WYWx1ZXNbaV0gPSB2YWx1ZXNbaV0udG9KU09OID8gdmFsdWVzW2ldLnRvSlNPTihqc29uVmFsdWVzW2ldKSA6IHZhbHVlc1tpXTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5Ud2Vlbi5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIHZhciB0aW1lcyA9IHRoaXMudGltZXMsXG4gICAgICAgIHZhbHVlcyA9IHRoaXMudmFsdWVzLFxuICAgICAgICBqc29uVGltZXMgPSBqc29uLnRpbWVzLFxuICAgICAgICBqc29uVmFsdWVzID0ganNvbi52YWx1ZXMsXG4gICAgICAgIGk7XG5cbiAgICBpID0ganNvblRpbWVzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB0aW1lc1tpXSA9IGZyb21KU09OKGpzb25UaW1lc1tpXSk7XG5cbiAgICBpID0ganNvblZhbHVlcy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkgdmFsdWVzW2ldID0gZnJvbUpTT04oanNvblZhbHVlc1tpXSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuZnVuY3Rpb24gZnJvbUpTT04oanNvbikge1xuICAgIHZhciBjbGFzc2VzID0gQ2xhc3MuX2NsYXNzZXMsXG4gICAgICAgIG1hdGhDbGFzc2VzID0gTWF0aGYuX2NsYXNzZXM7XG5cbiAgICBpZiAodHlwZW9mKGpzb24pICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHJldHVybiBqc29uO1xuICAgIH0gZWxzZSBpZiAobWF0aENsYXNzZXNbanNvbi5fY2xhc3NOYW1lXSkge1xuICAgICAgICByZXR1cm4gTWF0aGYuZnJvbUpTT04oanNvbik7XG4gICAgfSBlbHNlIGlmIChjbGFzc2VzW2pzb24uX2NsYXNzTmFtZV0pIHtcbiAgICAgICAgcmV0dXJuIENsYXNzLmZyb21KU09OKGpzb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBqc29uO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xufVxuXG5cbm1vZHVsZS5leHBvcnRzID0gVHdlZW47XG4iLCJ2YXIgQ2xhc3MgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9jbGFzc1wiKTtcbnZhciBWZWMyID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjMlwiKTtcbnZhciBWZWMzID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjM1wiKTtcbnZhciBDb21wb25lbnQgPSByZXF1aXJlKFwiLi9jb21wb25lbnRcIik7XG52YXIgUGh5czJEID0gcmVxdWlyZShcIi4uLy4uL3BoeXMyZC9waHlzMmRcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBSaWdpZEJvZHkyRChvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIENvbXBvbmVudC5jYWxsKHRoaXMsIFwiUmlnaWRCb2R5MkRcIiwgb3B0cyk7XG5cbiAgICB0aGlzLmJvZHkgPSBuZXcgUGh5czJELlAyUmlnaWRib2R5KG9wdHMpO1xufVxuXG5DbGFzcy5leHRlbmQoUmlnaWRCb2R5MkQsIENvbXBvbmVudCk7XG5cblxuUmlnaWRCb2R5MkQucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMuYm9keS5vZmYoXCJjb2xsaWRlXCIsIG9uQ29sbGlkZSwgdGhpcyk7XG4gICAgdGhpcy5ib2R5Lm9mZihcImNvbGxpZGluZ1wiLCBvbkNvbGxpZGluZywgdGhpcyk7XG4gICAgdGhpcy5ib2R5ID0gb3RoZXIuYm9keS5jbG9uZSgpO1xuICAgIHRoaXMuYm9keS5vbihcImNvbGxpZGVcIiwgb25Db2xsaWRlLCB0aGlzKTtcbiAgICB0aGlzLmJvZHkub24oXCJjb2xsaWRpbmdcIiwgb25Db2xsaWRpbmcsIHRoaXMpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblJpZ2lkQm9keTJELnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICBDb21wb25lbnQucHJvdG90eXBlLmNsZWFyLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLmJvZHkub2ZmKFwiY29sbGlkZVwiLCBvbkNvbGxpZGUsIHRoaXMpO1xuICAgIHRoaXMuYm9keS5vZmYoXCJjb2xsaWRpbmdcIiwgb25Db2xsaWRpbmcsIHRoaXMpO1xuICAgIHRoaXMuYm9keS51c2VyRGF0YSA9IHVuZGVmaW5lZDtcbn07XG5cblxuUmlnaWRCb2R5MkQucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBib2R5ID0gdGhpcy5ib2R5LFxuICAgICAgICBnYW1lT2JqZWN0ID0gdGhpcy5nYW1lT2JqZWN0LFxuICAgICAgICB0cmFuc2Zvcm0gPSBnYW1lT2JqZWN0LnRyYW5zZm9ybSxcbiAgICAgICAgdHJhbnNmb3JtMmQgPSBnYW1lT2JqZWN0LnRyYW5zZm9ybTJkO1xuXG4gICAgaWYgKHRyYW5zZm9ybSkge1xuICAgICAgICBib2R5LnBvc2l0aW9uLmNvcHkodHJhbnNmb3JtLnBvc2l0aW9uKTtcbiAgICAgICAgYm9keS5yb3RhdGlvbiA9IHRyYW5zZm9ybS5yb3RhdGlvbi5yb3RhdGlvblooKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBib2R5LnBvc2l0aW9uLmNvcHkodHJhbnNmb3JtMmQucG9zaXRpb24pO1xuICAgICAgICBib2R5LnJvdGF0aW9uID0gdHJhbnNmb3JtMmQucm90YXRpb247XG4gICAgfVxuXG4gICAgYm9keS5pbml0KCk7XG4gICAgYm9keS51c2VyRGF0YSA9IHRoaXM7XG4gICAgYm9keS5vbihcImNvbGxpZGVcIiwgb25Db2xsaWRlLCB0aGlzKTtcbiAgICBib2R5Lm9uKFwiY29sbGlkaW5nXCIsIG9uQ29sbGlkaW5nLCB0aGlzKTtcbn07XG5cblxudmFyIHpBeGlzID0gbmV3IFZlYzMoMC4wLCAwLjAsIDEuMCk7XG5SaWdpZEJvZHkyRC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBib2R5ID0gdGhpcy5ib2R5LFxuICAgICAgICBnYW1lT2JqZWN0ID0gdGhpcy5nYW1lT2JqZWN0LFxuICAgICAgICB0cmFuc2Zvcm0gPSBnYW1lT2JqZWN0LnRyYW5zZm9ybSxcbiAgICAgICAgdHJhbnNmb3JtMmQgPSBnYW1lT2JqZWN0LnRyYW5zZm9ybTJkO1xuXG4gICAgaWYgKHRyYW5zZm9ybSkge1xuICAgICAgICB0cmFuc2Zvcm0ucG9zaXRpb24uY29weShib2R5LnBvc2l0aW9uKTtcbiAgICAgICAgdHJhbnNmb3JtLnJvdGF0aW9uLmZyb21BeGlzQW5nbGUoekF4aXMsIGJvZHkucm90YXRpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRyYW5zZm9ybTJkLnBvc2l0aW9uLmNvcHkoYm9keS5wb3NpdGlvbik7XG4gICAgICAgIHRyYW5zZm9ybTJkLnJvdGF0aW9uID0gYm9keS5yb3RhdGlvbjtcbiAgICB9XG59O1xuXG5cblJpZ2lkQm9keTJELnByb3RvdHlwZS5hcHBseUZvcmNlID0gZnVuY3Rpb24gKGZvcmNlLCB3b3JsZFBvaW50KSB7XG5cbiAgICB0aGlzLmJvZHkuYXBwbHlGb3JjZShmb3JjZSwgd29ybGRQb2ludCk7XG59O1xuXG5cblJpZ2lkQm9keTJELnByb3RvdHlwZS5hcHBseVRvcnF1ZSA9IGZ1bmN0aW9uICh0b3JxdWUpIHtcblxuICAgIHRoaXMuYm9keS5hcHBseVRvcnF1ZSh0b3JxdWUpO1xufTtcblxuXG5SaWdpZEJvZHkyRC5wcm90b3R5cGUuYXBwbHlJbXB1bHNlID0gZnVuY3Rpb24gKGltcHVsc2UsIHdvcmxkUG9pbnQpIHtcblxuICAgIHRoaXMuYm9keS5hcHBseUltcHVsc2UoaW1wdWxzZSwgd29ybGRQb2ludCk7XG59O1xuXG5cblJpZ2lkQm9keTJELnByb3RvdHlwZS5hcHBseVZlbG9jaXR5ID0gZnVuY3Rpb24gKHZlbG9jaXR5KSB7XG5cbiAgICB0aGlzLmJvZHkuYXBwbHlWZWxvY2l0eSh2ZWxvY2l0eSk7XG59O1xuXG5cblJpZ2lkQm9keTJELnByb3RvdHlwZS5hcHBseUFuZ3VsYXJWZWxvY2l0eSA9IGZ1bmN0aW9uIChhbmd1bGFyVmVsb2NpdHkpIHtcblxuICAgIHRoaXMuYm9keS5hcHBseUFuZ3VsYXJWZWxvY2l0eShhbmd1bGFyVmVsb2NpdHkpO1xufTtcblxuXG5SaWdpZEJvZHkyRC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gQ29tcG9uZW50LnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIGpzb24uYm9keSA9IHRoaXMuYm9keS50b0pTT04oanNvbi5ib2R5KTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5SaWdpZEJvZHkyRC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENvbXBvbmVudC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIHRoaXMuYm9keS5mcm9tSlNPTihqc29uLmJvZHkpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbmZ1bmN0aW9uIG9uQ29sbGlkZShib2R5LCBzaSwgc2opIHtcbiAgICBpZiAoIWJvZHkudXNlckRhdGEpIHJldHVybjtcblxuICAgIHRoaXMuZW1pdChcImNvbGxpZGVcIiwgYm9keS51c2VyRGF0YSwgYm9keSwgc2ksIHNqKTtcbn07XG5cblxuZnVuY3Rpb24gb25Db2xsaWRpbmcoYm9keSwgc2ksIHNqKSB7XG4gICAgaWYgKCFib2R5LnVzZXJEYXRhKSByZXR1cm47XG5cbiAgICB0aGlzLmVtaXQoXCJjb2xsaWRpbmdcIiwgYm9keS51c2VyRGF0YSwgYm9keSwgc2ksIHNqKTtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBSaWdpZEJvZHkyRDtcbiIsInZhciBFbnVtcyA9IHJlcXVpcmUoXCIuLi9lbnVtc1wiKTtcbnZhciBDb21wb25lbnQgPSByZXF1aXJlKFwiLi9jb21wb25lbnRcIik7XG52YXIgQXNzZXRzID0gcmVxdWlyZShcIi4uL2Fzc2V0cy9hc3NldHNcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBTcHJpdGUob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBDb21wb25lbnQuY2FsbCh0aGlzLCBcIlNwcml0ZVwiLCBvcHRzKTtcblxuICAgIHRoaXMudmlzaWJsZSA9IG9wdHMudmlzaWJsZSAhPSB1bmRlZmluZWQgPyAhIW9wdHMudmlzaWJsZSA6IHRydWU7XG4gICAgdGhpcy5ibGVuZGluZyA9IG9wdHMuYmxlbmRpbmcgIT0gdW5kZWZpbmVkID8gb3B0cy5ibGVuZGluZyA6IEVudW1zLkJsZW5kaW5nLkRlZmF1bHQ7XG5cbiAgICB0aGlzLmxheWVyID0gb3B0cy5sYXllciAhPSB1bmRlZmluZWQgPyBvcHRzLmxheWVyIDogMDtcbiAgICB0aGlzLnogPSBvcHRzLnogIT0gdW5kZWZpbmVkID8gb3B0cy56IDogMDtcblxuICAgIHRoaXMuYWxwaGEgPSBvcHRzLmFscGhhICE9IHVuZGVmaW5lZCA/IG9wdHMuYWxwaGEgOiAxO1xuXG4gICAgdGhpcy5tYXRlcmlhbCA9IG9wdHMubWF0ZXJpYWwgIT0gdW5kZWZpbmVkID8gb3B0cy5tYXRlcmlhbCA6IHVuZGVmaW5lZDtcblxuICAgIHRoaXMud2lkdGggPSBvcHRzLndpZHRoIHx8IDE7XG4gICAgdGhpcy5oZWlnaHQgPSBvcHRzLmhlaWdodCB8fCAxO1xuXG4gICAgdGhpcy54ID0gb3B0cy54IHx8IDA7XG4gICAgdGhpcy55ID0gb3B0cy55IHx8IDA7XG4gICAgdGhpcy53ID0gb3B0cy53IHx8IDE7XG4gICAgdGhpcy5oID0gb3B0cy5oIHx8IDE7XG5cbiAgICB0aGlzLl93ZWJnbEluaXR0ZWQgPSBmYWxzZTtcbn1cblxuQ29tcG9uZW50LmV4dGVuZChTcHJpdGUpO1xuXG5cblNwcml0ZS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy52aXNpYmxlID0gb3RoZXIudmlzaWJsZTtcbiAgICB0aGlzLmJsZW5kaW5nID0gb3RoZXIuYmxlbmRpbmc7XG5cbiAgICB0aGlzLmxheWVyID0gb3RoZXIubGF5ZXI7XG4gICAgdGhpcy56ID0gb3RoZXIuejtcblxuICAgIHRoaXMuYWxwaGEgPSBvdGhlci5hbHBoYTtcblxuICAgIHRoaXMubWF0ZXJpYWwgPSBvdGhlci5tYXRlcmlhbDtcblxuICAgIHRoaXMud2lkdGggPSBvdGhlci53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IG90aGVyLmhlaWdodDtcblxuICAgIHRoaXMueCA9IG90aGVyLng7XG4gICAgdGhpcy55ID0gb3RoZXIueTtcbiAgICB0aGlzLncgPSBvdGhlci53O1xuICAgIHRoaXMuaCA9IG90aGVyLmg7XG5cbiAgICB0aGlzLl93ZWJnbEluaXR0ZWQgPSBmYWxzZTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5TcHJpdGUucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgIENvbXBvbmVudC5wcm90b3R5cGUuY2xlYXIuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMubWF0ZXJpYWwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fd2ViZ2xJbml0dGVkID0gZmFsc2U7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuU3ByaXRlLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDb21wb25lbnQucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi52aXNpYmxlID0gdGhpcy52aXNpYmxlO1xuICAgIGpzb24uYmxlbmRpbmcgPSB0aGlzLmJsZW5kaW5nO1xuXG4gICAganNvbi5sYXllciA9IHRoaXMubGF5ZXI7XG4gICAganNvbi56ID0gdGhpcy56O1xuXG4gICAganNvbi5hbHBoYSA9IHRoaXMuYWxwaGE7XG5cbiAgICBqc29uLm1hdGVyaWFsID0gdGhpcy5tYXRlcmlhbCA/IHRoaXMubWF0ZXJpYWwubmFtZSA6IHVuZGVmaW5lZDtcblxuICAgIGpzb24ud2lkdGggPSB0aGlzLndpZHRoO1xuICAgIGpzb24uaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XG5cbiAgICBqc29uLnggPSB0aGlzLng7XG4gICAganNvbi55ID0gdGhpcy55O1xuICAgIGpzb24udyA9IHRoaXMudztcbiAgICBqc29uLmggPSB0aGlzLmg7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuU3ByaXRlLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy52aXNpYmxlID0ganNvbi52aXNpYmxlO1xuICAgIHRoaXMuYmxlbmRpbmcgPSBqc29uLmJsZW5kaW5nO1xuXG4gICAgdGhpcy5sYXllciA9IGpzb24ubGF5ZXI7XG4gICAgdGhpcy56ID0ganNvbi56O1xuXG4gICAgdGhpcy5hbHBoYSA9IGpzb24uYWxwaGE7XG5cbiAgICB0aGlzLm1hdGVyaWFsID0ganNvbi5tYXRlcmlhbCA/IEFzc2V0cy5nZXQoanNvbi5tYXRlcmlhbCkgOiB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLndpZHRoID0ganNvbi53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IGpzb24uaGVpZ2h0O1xuXG4gICAgdGhpcy54ID0ganNvbi54O1xuICAgIHRoaXMueSA9IGpzb24ueTtcbiAgICB0aGlzLncgPSBqc29uLnc7XG4gICAgdGhpcy5oID0ganNvbi5oO1xuXG4gICAgdGhpcy5fd2ViZ2xJbml0dGVkID0gZmFsc2U7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBTcHJpdGU7XG4iLCJ2YXIgVGltZSA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL3RpbWVcIik7XG52YXIgQXNzZXRzID0gcmVxdWlyZShcIi4uL2Fzc2V0cy9hc3NldHNcIik7XG52YXIgQ29tcG9uZW50ID0gcmVxdWlyZShcIi4vY29tcG9uZW50XCIpO1xudmFyIEVudW1zID0gcmVxdWlyZShcIi4uL2VudW1zXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGFicyA9IE1hdGguYWJzLFxuICAgIFdyYXBNb2RlID0gRW51bXMuV3JhcE1vZGU7XG5cblxuLyoqXG4gKiBAY2xhc3MgU3ByaXRlQW5pbWF0aW9uXG4gKiBAZXh0ZW5kcyBDb21wb25lbnRcbiAqIEBicmllZiBiYXNlIGNsYXNzIGZvciBoYW5kbGluZyBzcHJpdGUgYW5pbWF0aW9uIHNoZWV0c1xuICogQHBhcmFtIE9iamVjdCBvcHRpb25zXG4gKi9cbmZ1bmN0aW9uIFNwcml0ZUFuaW1hdGlvbihvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIENvbXBvbmVudC5jYWxsKHRoaXMsIFwiU3ByaXRlQW5pbWF0aW9uXCIsIG9wdHMpO1xuXG4gICAgdGhpcy5zaGVldCA9IG9wdHMuc2hlZXQgIT0gdW5kZWZpbmVkID8gb3B0cy5zaGVldCA6IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuY3VycmVudCA9IG9wdHMuY3VycmVudCAhPSB1bmRlZmluZWQgPyBvcHRzLmN1cnJlbnQgOiBcImlkbGVcIjtcbiAgICB0aGlzLm1vZGUgPSBvcHRzLm1vZGUgIT0gdW5kZWZpbmVkID8gb3B0cy5tb2RlIDogV3JhcE1vZGUuTG9vcDtcblxuICAgIHRoaXMucmF0ZSA9IG9wdHMucmF0ZSAhPSB1bmRlZmluZWQgPyBvcHRzLnJhdGUgOiAxIC8gMjQ7XG5cbiAgICB0aGlzLl90aW1lID0gMDtcbiAgICB0aGlzLl9mcmFtZSA9IDA7XG4gICAgdGhpcy5fb3JkZXIgPSAxO1xuXG4gICAgdGhpcy5wbGF5aW5nID0gdGhpcy5zaGVldCA/IHRydWUgOiBmYWxzZTtcbn1cblxuQ29tcG9uZW50LmV4dGVuZChTcHJpdGVBbmltYXRpb24pO1xuXG5cblNwcml0ZUFuaW1hdGlvbi5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy5zaGVldCA9IG90aGVyLnNoZWV0O1xuXG4gICAgdGhpcy5jdXJyZW50ID0gb3RoZXIuY3VycmVudDtcbiAgICB0aGlzLm1vZGUgPSBvdGhlci5tb2RlO1xuXG4gICAgdGhpcy5yYXRlID0gb3RoZXIucmF0ZTtcblxuICAgIHRoaXMuX3RpbWUgPSBvdGhlci5fdGltZTtcbiAgICB0aGlzLl9mcmFtZSA9IG90aGVyLl9mcmFtZTtcbiAgICB0aGlzLl9vcmRlciA9IG90aGVyLl9vcmRlcjtcblxuICAgIHRoaXMucGxheWluZyA9IG90aGVyLnBsYXlpbmc7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuU3ByaXRlQW5pbWF0aW9uLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICBDb21wb25lbnQucHJvdG90eXBlLmNsZWFyLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLnNoZWV0ID0gdW5kZWZpbmVkO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblNwcml0ZUFuaW1hdGlvbi5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uIChuYW1lLCBtb2RlLCByYXRlKSB7XG4gICAgaWYgKCF0aGlzLnNoZWV0KSByZXR1cm4gdGhpcztcbiAgICBpZiAoKHRoaXMucGxheWluZyAmJiB0aGlzLmN1cnJlbnQgPT09IG5hbWUpIHx8ICF0aGlzLnNoZWV0W25hbWVdKSByZXR1cm4gdGhpcztcblxuICAgIHRoaXMuY3VycmVudCA9IG5hbWU7XG4gICAgdGhpcy5yYXRlID0gcmF0ZSAhPSB1bmRlZmluZWQgPyByYXRlIDogKHJhdGUgPSB0aGlzLnJhdGUpO1xuICAgIHRoaXMubW9kZSA9IG1vZGUgfHwgKG1vZGUgPSB0aGlzLm1vZGUpO1xuICAgIHRoaXMuX2ZyYW1lID0gMDtcbiAgICB0aGlzLl9vcmRlciA9IDE7XG4gICAgdGhpcy5fdGltZSA9IDA7XG5cbiAgICB0aGlzLnBsYXlpbmcgPSB0cnVlO1xuICAgIHRoaXMuZW1pdChcInBsYXlcIiwgbmFtZSwgbW9kZSwgcmF0ZSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuU3ByaXRlQW5pbWF0aW9uLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKCkge1xuXG4gICAgaWYgKHRoaXMucGxheWluZykgdGhpcy5lbWl0KFwic3RvcFwiKTtcbiAgICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcbiAgICB0aGlzLl9mcmFtZSA9IDA7XG4gICAgdGhpcy5fb3JkZXIgPSAxO1xuICAgIHRoaXMuX3RpbWUgPSAwO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblNwcml0ZUFuaW1hdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5wbGF5aW5nKSByZXR1cm47XG4gICAgdmFyIHNwcml0ZSA9IHRoaXMuc3ByaXRlLFxuICAgICAgICBzaGVldCA9IHRoaXMuc2hlZXQsXG4gICAgICAgIGN1cnJlbnQgPSBzaGVldFt0aGlzLmN1cnJlbnRdLFxuICAgICAgICByYXRlLCBkdCwgY291bnQsIGxlbmd0aCwgb3JkZXIsIGZyYW1lLCBtb2RlLCBhbmltYXRpb247XG5cbiAgICBpZiAoIXNwcml0ZSB8fCAhc2hlZXQgfHwgIWN1cnJlbnQpIHJldHVybjtcblxuICAgIHJhdGUgPSB0aGlzLnJhdGU7XG4gICAgZHQgPSBUaW1lLmRlbHRhO1xuICAgIG9yZGVyID0gdGhpcy5fb3JkZXI7XG4gICAgZnJhbWUgPSB0aGlzLl9mcmFtZTtcbiAgICBtb2RlID0gdGhpcy5tb2RlO1xuXG4gICAgaWYgKCFyYXRlIHx8IHJhdGUgPT09IEluZmluaXR5IHx8IHJhdGUgPCAwKSB7XG4gICAgICAgIGZyYW1lID0gYWJzKGZyYW1lKSAlIGN1cnJlbnQubGVuZ3RoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3RpbWUgKz0gZHQ7XG4gICAgICAgIGNvdW50ID0gdGhpcy5fdGltZSAvIHJhdGU7XG5cbiAgICAgICAgaWYgKGNvdW50ID49IDEpIHtcbiAgICAgICAgICAgIHRoaXMuX3RpbWUgPSAwO1xuICAgICAgICAgICAgbGVuZ3RoID0gY3VycmVudC5sZW5ndGg7XG4gICAgICAgICAgICBmcmFtZSArPSAob3JkZXIgKiAoY291bnQgfCAwKSk7XG5cbiAgICAgICAgICAgIGlmIChtb2RlID09PSBXcmFwTW9kZS5Mb29wKSB7XG4gICAgICAgICAgICAgICAgZnJhbWUgPSBmcmFtZSAlIGxlbmd0aDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gV3JhcE1vZGUuT25jZSkge1xuICAgICAgICAgICAgICAgIGlmIChvcmRlciA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZyYW1lID49IGxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUgPSBsZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnJhbWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFtZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gV3JhcE1vZGUuUGluZ1BvbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAob3JkZXIgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmcmFtZSA+PSBsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29yZGVyID0gLTE7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFtZSA9IGxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnJhbWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vcmRlciA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFtZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1vZGUgPT09IFdyYXBNb2RlLkNsYW1wKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9yZGVyID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnJhbWUgPj0gbGVuZ3RoKSBmcmFtZSA9IGxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZyYW1lIDwgMCkgZnJhbWUgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFuaW1hdGlvbiA9IGN1cnJlbnRbZnJhbWVdO1xuICAgIHNwcml0ZS54ID0gYW5pbWF0aW9uWzBdO1xuICAgIHNwcml0ZS55ID0gYW5pbWF0aW9uWzFdO1xuICAgIHNwcml0ZS53ID0gYW5pbWF0aW9uWzJdO1xuICAgIHNwcml0ZS5oID0gYW5pbWF0aW9uWzNdO1xuXG4gICAgdGhpcy5fZnJhbWUgPSBmcmFtZTtcbn07XG5cblxuU3ByaXRlQW5pbWF0aW9uLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDb21wb25lbnQucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi5zaGVldCA9IHRoaXMuc2hlZXQgPyB0aGlzLnNoZWV0Lm5hbWUgOiB1bmRlZmluZWQ7XG5cbiAgICBqc29uLmN1cnJlbnQgPSB0aGlzLmN1cnJlbnQ7XG4gICAganNvbi5tb2RlID0gdGhpcy5tb2RlO1xuXG4gICAganNvbi5yYXRlID0gdGhpcy5yYXRlO1xuXG4gICAganNvbi5fdGltZSA9IHRoaXMuX3RpbWU7XG4gICAganNvbi5fZnJhbWUgPSB0aGlzLl9mcmFtZTtcbiAgICBqc29uLl9vcmRlciA9IHRoaXMuX29yZGVyO1xuXG4gICAganNvbi5wbGF5aW5nID0gdGhpcy5wbGF5aW5nO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cblNwcml0ZUFuaW1hdGlvbi5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENvbXBvbmVudC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIHRoaXMuc2hlZXQgPSBqc29uLnNoZWV0ID8gQXNzZXRzLmdldChqc29uLnNoZWV0KSA6IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuY3VycmVudCA9IGpzb24uY3VycmVudDtcbiAgICB0aGlzLm1vZGUgPSBqc29uLm1vZGU7XG5cbiAgICB0aGlzLnJhdGUgPSBqc29uLnJhdGU7XG5cbiAgICB0aGlzLl90aW1lID0ganNvbi5fdGltZTtcbiAgICB0aGlzLl9mcmFtZSA9IGpzb24uX2ZyYW1lO1xuICAgIHRoaXMuX29yZGVyID0ganNvbi5fb3JkZXI7XG5cbiAgICB0aGlzLnBsYXlpbmcgPSBqc29uLnBsYXlpbmc7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBTcHJpdGVBbmltYXRpb247XG4iLCJ2YXIgTWF0aGYgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9tYXRoZlwiKTtcbnZhciBWZWMzID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjM1wiKTtcbnZhciBRdWF0ID0gcmVxdWlyZShcIi4uLy4uL21hdGgvcXVhdFwiKTtcbnZhciBNYXQzID0gcmVxdWlyZShcIi4uLy4uL21hdGgvbWF0M1wiKTtcbnZhciBNYXQ0ID0gcmVxdWlyZShcIi4uLy4uL21hdGgvbWF0NFwiKTtcbnZhciBDb21wb25lbnQgPSByZXF1aXJlKFwiLi9jb21wb25lbnRcIik7XG52YXIgTG9nID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvbG9nXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIEVQU0lMT04gPSBNYXRoZi5FUFNJTE9OO1xuXG5cbmZ1bmN0aW9uIFRyYW5zZm9ybShvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcbiAgICBvcHRzLnN5bmMgPSBvcHRzLnN5bmMgIT0gdW5kZWZpbmVkID8gb3B0cy5zeW5jIDogdHJ1ZTtcblxuICAgIENvbXBvbmVudC5jYWxsKHRoaXMsIFwiVHJhbnNmb3JtXCIsIG9wdHMpO1xuXG4gICAgdGhpcy5yb290ID0gdGhpcztcbiAgICB0aGlzLmRlcHRoID0gMDtcblxuICAgIHRoaXMucGFyZW50ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcblxuICAgIHRoaXMucG9zaXRpb24gPSBvcHRzLnBvc2l0aW9uICE9IHVuZGVmaW5lZCA/IG9wdHMucG9zaXRpb24gOiBuZXcgVmVjMztcbiAgICB0aGlzLnJvdGF0aW9uID0gb3B0cy5yb3RhdGlvbiAhPSB1bmRlZmluZWQgPyBvcHRzLnJvdGF0aW9uIDogbmV3IFF1YXQ7XG4gICAgdGhpcy5zY2FsZSA9IG9wdHMuc2NhbGUgIT0gdW5kZWZpbmVkID8gb3B0cy5zY2FsZSA6IG5ldyBWZWMzKDEsIDEsIDEpO1xuXG4gICAgdGhpcy5tYXRyaXggPSBuZXcgTWF0NDtcbiAgICB0aGlzLm1hdHJpeFdvcmxkID0gbmV3IE1hdDQ7XG5cbiAgICB0aGlzLm1vZGVsVmlldyA9IG5ldyBNYXQ0O1xuICAgIHRoaXMubm9ybWFsTWF0cml4ID0gbmV3IE1hdDM7XG59XG5cbkNvbXBvbmVudC5leHRlbmQoVHJhbnNmb3JtKTtcblxuXG5UcmFuc2Zvcm0ucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgY2hpbGRyZW4gPSBvdGhlci5jaGlsZHJlbixcbiAgICAgICAgaSA9IGNoaWxkcmVuLmxlbmd0aDtcblxuICAgIHRoaXMucG9zaXRpb24uY29weShvdGhlci5wb3NpdGlvbik7XG4gICAgdGhpcy5zY2FsZS5jb3B5KG90aGVyLnNjYWxlKTtcbiAgICB0aGlzLnJvdGF0aW9uLmNvcHkob3RoZXIucm90YXRpb24pO1xuXG4gICAgd2hpbGUgKGktLSkgdGhpcy5hZGRDaGlsZChjaGlsZHJlbltpXS5nYW1lT2JqZWN0LmNsb25lKCkudHJhbnNmb3JtKTtcbiAgICBpZiAob3RoZXIucGFyZW50KSBvdGhlci5wYXJlbnQuYWRkQ2hpbGQodGhpcyk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblRyYW5zZm9ybS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5jbGVhci5jYWxsKHRoaXMpO1xuICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW4sXG4gICAgICAgIGkgPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLnJlbW92ZUNoaWxkKGNoaWxkcmVuW2ldKTtcblxuICAgIHRoaXMucG9zaXRpb24uc2V0KDAsIDAsIDApO1xuICAgIHRoaXMuc2NhbGUuc2V0KDEsIDEsIDEpO1xuICAgIHRoaXMucm90YXRpb24uc2V0KDAsIDAsIDAsIDEpO1xuXG4gICAgdGhpcy5yb290ID0gdGhpcztcbiAgICB0aGlzLmRlcHRoID0gMDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5UcmFuc2Zvcm0ucHJvdG90eXBlLnRyYW5zbGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmVjID0gbmV3IFZlYzM7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHRyYW5zbGF0aW9uLCByZWxhdGl2ZVRvKSB7XG4gICAgICAgIHZlYy5jb3B5KHRyYW5zbGF0aW9uKTtcblxuICAgICAgICBpZiAocmVsYXRpdmVUbyBpbnN0YW5jZW9mIFRyYW5zZm9ybSkge1xuICAgICAgICAgICAgdmVjLnRyYW5zZm9ybVF1YXQocmVsYXRpdmVUby5yb3RhdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAocmVsYXRpdmVUbyBpbnN0YW5jZW9mIFF1YXQpIHtcbiAgICAgICAgICAgIHZlYy50cmFuc2Zvcm1RdWF0KHJlbGF0aXZlVG8pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wb3NpdGlvbi5hZGQodmVjKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xufSgpO1xuXG5cblRyYW5zZm9ybS5wcm90b3R5cGUucm90YXRlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB2ZWMgPSBuZXcgVmVjMztcblxuICAgIHJldHVybiBmdW5jdGlvbiAocm90YXRpb24sIHJlbGF0aXZlVG8pIHtcbiAgICAgICAgdmVjLmNvcHkocm90YXRpb24pO1xuXG4gICAgICAgIGlmIChyZWxhdGl2ZVRvIGluc3RhbmNlb2YgVHJhbnNmb3JtKSB7XG4gICAgICAgICAgICB2ZWMudHJhbnNmb3JtUXVhdChyZWxhdGl2ZVRvLnJvdGF0aW9uKTtcbiAgICAgICAgfSBlbHNlIGlmIChyZWxhdGl2ZVRvIGluc3RhbmNlb2YgUXVhdCkge1xuICAgICAgICAgICAgdmVjLnRyYW5zZm9ybVF1YXQocmVsYXRpdmVUbyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJvdGF0aW9uLnJvdGF0ZSh2ZWMueCwgdmVjLnksIHZlYy56KTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xufSgpO1xuXG5cblRyYW5zZm9ybS5wcm90b3R5cGUubG9va0F0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtYXQgPSBuZXcgTWF0NCxcbiAgICAgICAgdmVjID0gbmV3IFZlYzMsXG4gICAgICAgIGR1cCA9IG5ldyBWZWMzKDAuMCwgMC4wLCAxLjApO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIHVwKSB7XG4gICAgICAgIHVwID0gdXAgfHwgZHVwO1xuXG4gICAgICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBUcmFuc2Zvcm0pIHtcbiAgICAgICAgICAgIHZlYy5zZXQoMC4wLCAwLjAsIDAuMCkudHJhbnNmb3JtTWF0NCh0YXJnZXQubWF0cml4V29ybGQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmVjLmNvcHkodGFyZ2V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1hdC5sb29rQXQodGhpcy5wb3NpdGlvbiwgdmVjLCB1cCk7XG4gICAgICAgIHRoaXMucm90YXRpb24uZnJvbU1hdDQobWF0KTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xufSgpO1xuXG5cblRyYW5zZm9ybS5wcm90b3R5cGUuZm9sbG93ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0YXJnZXQgPSBuZXcgVmVjMyxcbiAgICAgICAgcG9zaXRpb24gPSBuZXcgVmVjMyxcbiAgICAgICAgZGVsdGEgPSBuZXcgVmVjMztcblxuICAgIHJldHVybiBmdW5jdGlvbiAodHJhbnNmb3JtLCBzcGVlZCkge1xuICAgICAgICBwb3NpdGlvbi5zZXQoMC4wLCAwLjAsIDAuMCkudHJhbnNmb3JtTWF0NCh0aGlzLm1hdHJpeFdvcmxkKTtcbiAgICAgICAgdGFyZ2V0LnNldCgwLjAsIDAuMCwgMC4wKS50cmFuc2Zvcm1NYXQ0KHRyYW5zZm9ybS5tYXRyaXhXb3JsZCk7XG5cbiAgICAgICAgZGVsdGEudnN1Yih0YXJnZXQsIHBvc2l0aW9uKTtcblxuICAgICAgICBpZiAoZGVsdGEubGVuZ3RoU3EoKSA+IEVQU0lMT04pIHRoaXMucG9zaXRpb24uYWRkKGRlbHRhLnNtdWwoc3BlZWQpKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xufSgpO1xuXG5cblRyYW5zZm9ybS5wcm90b3R5cGUuYWRkQ2hpbGQgPSBmdW5jdGlvbiAoY2hpbGQsIG90aGVycykge1xuICAgIGlmICghKGNoaWxkIGluc3RhbmNlb2YgVHJhbnNmb3JtKSkge1xuICAgICAgICBMb2cuZXJyb3IoXCJUcmFuc2Zvcm0uYWRkOiBjYW5cXCd0IGFkZCBwYXNzZWQgYXJndW1lbnQsIGl0IGlzIG5vdCBhbiBpbnN0YW5jZSBvZiBUcmFuc2Zvcm1cIik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLFxuICAgICAgICBpbmRleCA9IGNoaWxkcmVuLmluZGV4T2YoY2hpbGQpLFxuICAgICAgICByb290LCBkZXB0aCwgc2NlbmU7XG5cbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIGlmIChjaGlsZC5wYXJlbnQpIGNoaWxkLnBhcmVudC5yZW1vdmVDaGlsZChjaGlsZCk7XG5cbiAgICAgICAgY2hpbGQucGFyZW50ID0gdGhpcztcbiAgICAgICAgY2hpbGRyZW4ucHVzaChjaGlsZCk7XG5cbiAgICAgICAgcm9vdCA9IHRoaXM7XG4gICAgICAgIGRlcHRoID0gMDtcblxuICAgICAgICB3aGlsZSAocm9vdC5wYXJlbnQpIHtcbiAgICAgICAgICAgIHJvb3QgPSByb290LnBhcmVudDtcbiAgICAgICAgICAgIGRlcHRoKys7XG4gICAgICAgIH1cbiAgICAgICAgY2hpbGQucm9vdCA9IHJvb3Q7XG4gICAgICAgIHRoaXMucm9vdCA9IHJvb3Q7XG5cbiAgICAgICAgdXBkYXRlRGVwdGgodGhpcywgZGVwdGgpO1xuICAgICAgICBpZiAoIW90aGVycykge1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2FtZU9iamVjdCAmJiAoc2NlbmUgPSB0aGlzLmdhbWVPYmplY3Quc2NlbmUpKSB7XG4gICAgICAgICAgICAgICAgc2NlbmUuY29tcG9uZW50TWFuYWdlcnMuVHJhbnNmb3JtLnNvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIlRyYW5zZm9ybS5hZGQ6IGNoaWxkIGlzIG5vdCBhIG1lbWJlciBvZiB0aGlzIFRyYW5zZm9ybVwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuVHJhbnNmb3JtLnByb3RvdHlwZS5hZGRDaGlsZHJlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSwgaWwsIHNjZW5lO1xuXG4gICAgZm9yIChpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgdGhpcy5hZGRDaGlsZChhcmd1bWVudHNbaV0sIHRydWUpO1xuICAgIGlmICh0aGlzLmdhbWVPYmplY3QgJiYgKHNjZW5lID0gdGhpcy5nYW1lT2JqZWN0LnNjZW5lKSkge1xuICAgICAgICBzY2VuZS5jb21wb25lbnRNYW5hZ2Vycy5UcmFuc2Zvcm0uc29ydCgpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuVHJhbnNmb3JtLnByb3RvdHlwZS5yZW1vdmVDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZCwgb3RoZXJzKSB7XG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbixcbiAgICAgICAgaW5kZXggPSBjaGlsZHJlbi5pbmRleE9mKGNoaWxkKSxcbiAgICAgICAgcm9vdCwgZGVwdGgsIHNjZW5lO1xuXG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICBjaGlsZC5wYXJlbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICAgICAgcm9vdCA9IHRoaXM7XG4gICAgICAgIGRlcHRoID0gMDtcblxuICAgICAgICB3aGlsZSAocm9vdC5wYXJlbnQpIHtcbiAgICAgICAgICAgIHJvb3QgPSByb290LnBhcmVudDtcbiAgICAgICAgICAgIGRlcHRoKys7XG4gICAgICAgIH1cbiAgICAgICAgY2hpbGQucm9vdCA9IGNoaWxkO1xuICAgICAgICB0aGlzLnJvb3QgPSByb290O1xuXG4gICAgICAgIHVwZGF0ZURlcHRoKHRoaXMsIGRlcHRoKTtcbiAgICAgICAgaWYgKCFvdGhlcnMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdhbWVPYmplY3QgJiYgKHNjZW5lID0gdGhpcy5nYW1lT2JqZWN0LnNjZW5lKSkge1xuICAgICAgICAgICAgICAgIHNjZW5lLmNvbXBvbmVudE1hbmFnZXJzLlRyYW5zZm9ybS5zb3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBMb2cuZXJyb3IoXCJUcmFuc2Zvcm0ucmVtb3ZlOiBjaGlsZCBpcyBub3QgYSBtZW1iZXIgb2YgdGhpcyBUcmFuc2Zvcm1cIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblRyYW5zZm9ybS5wcm90b3R5cGUucmVtb3ZlQ2hpbGRyZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGksIGlsLCBzY2VuZTtcblxuICAgIGZvciAoaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHRoaXMucmVtb3ZlQ2hpbGQoYXJndW1lbnRzW2ldLCB0cnVlKTtcbiAgICBpZiAodGhpcy5nYW1lT2JqZWN0ICYmIChzY2VuZSA9IHRoaXMuZ2FtZU9iamVjdC5zY2VuZSkpIHtcbiAgICAgICAgc2NlbmUuY29tcG9uZW50TWFuYWdlcnMuVHJhbnNmb3JtLnNvcnQoKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblRyYW5zZm9ybS5wcm90b3R5cGUuZGV0YWNoQ2hpbGRyZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbixcbiAgICAgICAgaSA9IGNoaWxkcmVuLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHRoaXMucmVtb3ZlQ2hpbGQoY2hpbGRyZW5baV0pO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5UcmFuc2Zvcm0ucHJvdG90eXBlLmhhc0NoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG5cbiAgICByZXR1cm4gISF+dGhpcy5jaGlsZHJlbi5pbmRleE9mKGNoaWxkKTtcbn07XG5cblxuVHJhbnNmb3JtLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLFxuICAgICAgICBjaGlsZCxcbiAgICAgICAgaSA9IGNoaWxkcmVuLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY2hpbGQgPSBjaGlsZHJlbltpXTtcblxuICAgICAgICBpZiAoY2hpbGQuZ2FtZU9iamVjdC5uYW1lID09PSBuYW1lKSByZXR1cm4gY2hpbGQuZ2FtZU9iamVjdDtcbiAgICAgICAgaWYgKChjaGlsZCA9IGNoaWxkLmZpbmQobmFtZSkpKSByZXR1cm4gY2hpbGQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cblxuVHJhbnNmb3JtLnByb3RvdHlwZS50b1dvcmxkID0gZnVuY3Rpb24gKHYpIHtcblxuICAgIHJldHVybiB2LnRyYW5zZm9ybU1hdDQodGhpcy5tYXRyaXhXb3JsZCk7XG59O1xuXG5cblRyYW5zZm9ybS5wcm90b3R5cGUudG9Mb2NhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbWF0ID0gbmV3IE1hdDQ7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHYpIHtcblxuICAgICAgICByZXR1cm4gdi50cmFuc2Zvcm1NYXQ0KG1hdC5pbnZlcnNlTWF0KHRoaXMubWF0cml4V29ybGQpKTtcbiAgICB9O1xufSgpO1xuXG5cblRyYW5zZm9ybS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtYXRyaXggPSB0aGlzLm1hdHJpeCxcbiAgICAgICAgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG5cbiAgICBtYXRyaXguY29tcG9zZSh0aGlzLnBvc2l0aW9uLCB0aGlzLnNjYWxlLCB0aGlzLnJvdGF0aW9uKTtcblxuICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgdGhpcy5tYXRyaXhXb3JsZC5tbXVsKHBhcmVudC5tYXRyaXhXb3JsZCwgbWF0cml4KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm1hdHJpeFdvcmxkLmNvcHkobWF0cml4KTtcbiAgICB9XG59O1xuXG5cblRyYW5zZm9ybS5wcm90b3R5cGUudXBkYXRlTWF0cmljZXMgPSBmdW5jdGlvbiAodmlld01hdHJpeCkge1xuXG4gICAgdGhpcy5tb2RlbFZpZXcubW11bCh2aWV3TWF0cml4LCB0aGlzLm1hdHJpeFdvcmxkKTtcbiAgICB0aGlzLm5vcm1hbE1hdHJpeC5pbnZlcnNlTWF0NCh0aGlzLm1vZGVsVmlldykudHJhbnNwb3NlKCk7XG59O1xuXG5cblRyYW5zZm9ybS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gQ29tcG9uZW50LnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLFxuICAgICAgICBqc29uQ2hpbGRyZW4gPSBqc29uLmNoaWxkcmVuIHx8IChqc29uLmNoaWxkcmVuID0gW10pLFxuICAgICAgICBpID0gY2hpbGRyZW4ubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkganNvbkNoaWxkcmVuW2ldID0gY2hpbGRyZW5baV0uX2lkO1xuXG4gICAganNvbi5wb3NpdGlvbiA9IHRoaXMucG9zaXRpb24udG9KU09OKGpzb24ucG9zaXRpb24pO1xuICAgIGpzb24uc2NhbGUgPSB0aGlzLnNjYWxlLnRvSlNPTihqc29uLnNjYWxlKTtcbiAgICBqc29uLnJvdGF0aW9uID0gdGhpcy5yb3RhdGlvbi50b0pTT04oanNvbi5yb3RhdGlvbik7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuVHJhbnNmb3JtLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuICAgIHZhciBjaGlsZHJlbiA9IGpzb24uY2hpbGRyZW4sXG4gICAgICAgIGkgPSBjaGlsZHJlbi5sZW5ndGgsXG4gICAgICAgIGNoaWxkLCBzY2VuZTtcblxuICAgIGlmICh0aGlzLmdhbWVPYmplY3QgJiYgKHNjZW5lID0gdGhpcy5nYW1lT2JqZWN0LnNjZW5lKSkge1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBjaGlsZCA9IHNjZW5lLmZpbmRDb21wb25lbnRCeUpTT05JZChjaGlsZHJlbltpXSk7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5oYXNDaGlsZChjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZENoaWxkKGNoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMub25jZShcInN0YXJ0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzY2VuZSA9IHRoaXMuZ2FtZU9iamVjdC5zY2VuZTtcblxuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIGNoaWxkID0gc2NlbmUuZmluZENvbXBvbmVudEJ5SlNPTklkKGNoaWxkcmVuW2ldKTtcblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5oYXNDaGlsZChjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnBvc2l0aW9uLmZyb21KU09OKGpzb24ucG9zaXRpb24pO1xuICAgIHRoaXMuc2NhbGUuZnJvbUpTT04oanNvbi5zY2FsZSk7XG4gICAgdGhpcy5yb3RhdGlvbi5mcm9tSlNPTihqc29uLnJvdGF0aW9uKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5mdW5jdGlvbiB1cGRhdGVEZXB0aCh0cmFuc2Zvcm0sIGRlcHRoKSB7XG4gICAgdmFyIGNoaWxkcmVuID0gdHJhbnNmb3JtLmNoaWxkcmVuLFxuICAgICAgICBpID0gY2hpbGRyZW4ubGVuZ3RoO1xuXG4gICAgdHJhbnNmb3JtLmRlcHRoID0gZGVwdGg7XG5cbiAgICB3aGlsZSAoaS0tKSB1cGRhdGVEZXB0aChjaGlsZHJlbltpXSwgZGVwdGggKyAxKTtcbn1cblxuXG5tb2R1bGUuZXhwb3J0cyA9IFRyYW5zZm9ybTtcbiIsInZhciBNYXRoZiA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL21hdGhmXCIpO1xudmFyIFZlYzIgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWMyXCIpO1xudmFyIE1hdDMyID0gcmVxdWlyZShcIi4uLy4uL21hdGgvbWF0MzJcIik7XG52YXIgTWF0MyA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL21hdDNcIik7XG52YXIgTWF0NCA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL21hdDRcIik7XG52YXIgQ29tcG9uZW50ID0gcmVxdWlyZShcIi4vY29tcG9uZW50XCIpO1xudmFyIENvbmZpZyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2NvbmZpZ1wiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9sb2dcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgRVBTSUxPTiA9IE1hdGhmLkVQU0lMT047XG5cblxuZnVuY3Rpb24gVHJhbnNmb3JtMkQob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG4gICAgb3B0cy5zeW5jID0gb3B0cy5zeW5jICE9IHVuZGVmaW5lZCA/IG9wdHMuc3luYyA6IHRydWU7XG5cbiAgICBDb21wb25lbnQuY2FsbCh0aGlzLCBcIlRyYW5zZm9ybTJEXCIsIG9wdHMpO1xuXG4gICAgdGhpcy5yb290ID0gdGhpcztcbiAgICB0aGlzLmRlcHRoID0gMDtcblxuICAgIHRoaXMucGFyZW50ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcblxuICAgIHRoaXMucG9zaXRpb24gPSBvcHRzLnBvc2l0aW9uICE9IHVuZGVmaW5lZCA/IG9wdHMucG9zaXRpb24gOiBuZXcgVmVjMjtcbiAgICB0aGlzLnJvdGF0aW9uID0gb3B0cy5yb3RhdGlvbiAhPSB1bmRlZmluZWQgPyBvcHRzLnJvdGF0aW9uIDogMDtcbiAgICB0aGlzLnNjYWxlID0gb3B0cy5zY2FsZSAhPSB1bmRlZmluZWQgPyBvcHRzLnNjYWxlIDogbmV3IFZlYzIoMSwgMSk7XG5cbiAgICB0aGlzLm1hdHJpeCA9IG5ldyBNYXQ0O1xuICAgIHRoaXMubWF0cml4V29ybGQgPSBuZXcgTWF0NDtcblxuICAgIHRoaXMubW9kZWxWaWV3ID0gbmV3IE1hdDQ7XG4gICAgdGhpcy5ub3JtYWxNYXRyaXggPSBuZXcgTWF0Mztcbn1cblxuQ29tcG9uZW50LmV4dGVuZChUcmFuc2Zvcm0yRCk7XG5cblxuVHJhbnNmb3JtMkQucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgY2hpbGRyZW4gPSBvdGhlci5jaGlsZHJlbixcbiAgICAgICAgaSA9IGNoaWxkcmVuLmxlbmd0aDtcblxuICAgIHRoaXMucG9zaXRpb24uY29weShvdGhlci5wb3NpdGlvbik7XG4gICAgdGhpcy5zY2FsZS5jb3B5KG90aGVyLnNjYWxlKTtcbiAgICB0aGlzLnJvdGF0aW9uID0gb3RoZXIucm90YXRpb247XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLmFkZENoaWxkKGNoaWxkcmVuW2ldLmdhbWVPYmplY3QuY2xvbmUoKS50cmFuc2Zvcm0pO1xuICAgIGlmIChvdGhlci5wYXJlbnQpIG90aGVyLnBhcmVudC5hZGRDaGlsZCh0aGlzKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5UcmFuc2Zvcm0yRC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5jbGVhci5jYWxsKHRoaXMpO1xuICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW4sXG4gICAgICAgIGkgPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLnJlbW92ZUNoaWxkKGNoaWxkcmVuW2ldKTtcblxuICAgIHRoaXMucG9zaXRpb24uc2V0KDAsIDApO1xuICAgIHRoaXMuc2NhbGUuc2V0KDEsIDEpO1xuICAgIHRoaXMucm90YXRpb24gPSAwO1xuXG4gICAgdGhpcy5yb290ID0gdGhpcztcbiAgICB0aGlzLmRlcHRoID0gMDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5UcmFuc2Zvcm0yRC5wcm90b3R5cGUudHJhbnNsYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB2ZWMgPSBuZXcgVmVjMjtcblxuICAgIHJldHVybiBmdW5jdGlvbiAodHJhbnNsYXRpb24sIHJlbGF0aXZlVG8pIHtcbiAgICAgICAgdmVjLmNvcHkodHJhbnNsYXRpb24pO1xuXG4gICAgICAgIGlmIChyZWxhdGl2ZVRvIGluc3RhbmNlb2YgVHJhbnNmb3JtMkQpIHtcbiAgICAgICAgICAgIHZlYy50cmFuc2Zvcm1BbmdsZShyZWxhdGl2ZVRvLnJvdGF0aW9uKTtcbiAgICAgICAgfSBlbHNlIGlmIChyZWxhdGl2ZVRvKSB7XG4gICAgICAgICAgICB2ZWMudHJhbnNmb3JtQW5nbGUocmVsYXRpdmVUbyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnBvc2l0aW9uLmFkZCh2ZWMpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG59KCk7XG5cblxuVHJhbnNmb3JtMkQucHJvdG90eXBlLnJvdGF0ZSA9IGZ1bmN0aW9uIChyb3RhdGlvbiwgcmVsYXRpdmVUbykge1xuXG4gICAgaWYgKHJlbGF0aXZlVG8gaW5zdGFuY2VvZiBUcmFuc2Zvcm0yRCkge1xuICAgICAgICByb3RhdGlvbiArPSByZWxhdGl2ZVRvLnJvdGF0aW9uO1xuICAgIH0gZWxzZSBpZiAocmVsYXRpdmVUbykge1xuICAgICAgICByb3RhdGlvbiArPSByZWxhdGl2ZVRvO1xuICAgIH1cblxuICAgIHRoaXMucm90YXRpb24gKz0gcm90YXRpb247XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuVHJhbnNmb3JtMkQucHJvdG90eXBlLmxvb2tBdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbWF0ID0gbmV3IE1hdDMyLFxuICAgICAgICB2ZWMgPSBuZXcgVmVjMjtcblxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0KSB7XG5cbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIFRyYW5zZm9ybTJEKSB7XG4gICAgICAgICAgICB2ZWMuY29weSh0YXJnZXQucG9zaXRpb24pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmVjLmNvcHkodGFyZ2V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1hdC5sb29rQXQodGhpcy5wb3NpdGlvbiwgdmVjKTtcbiAgICAgICAgdGhpcy5yb3RhdGlvbiA9IG1hdC5nZXRSb3RhdGlvbigpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG59KCk7XG5cblxuVHJhbnNmb3JtMkQucHJvdG90eXBlLmZvbGxvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGFyZ2V0ID0gbmV3IFZlYzIsXG4gICAgICAgIHBvc2l0aW9uID0gbmV3IFZlYzIsXG4gICAgICAgIGRlbHRhID0gbmV3IFZlYzI7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHRyYW5zZm9ybSwgc3BlZWQpIHtcbiAgICAgICAgcG9zaXRpb24uc2V0KDAsIDApLnRyYW5zZm9ybU1hdDQodGhpcy5tYXRyaXhXb3JsZCk7XG4gICAgICAgIHRhcmdldC5zZXQoMCwgMCkudHJhbnNmb3JtTWF0NCh0cmFuc2Zvcm0ubWF0cml4V29ybGQpO1xuXG4gICAgICAgIGRlbHRhLnZzdWIodGFyZ2V0LCBwb3NpdGlvbik7XG5cbiAgICAgICAgaWYgKGRlbHRhLmxlbmd0aFNxKCkgPiBFUFNJTE9OKSB0aGlzLnBvc2l0aW9uLmFkZChkZWx0YS5zbXVsKHNwZWVkKSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbn0oKTtcblxuXG5UcmFuc2Zvcm0yRC5wcm90b3R5cGUuYWRkQ2hpbGQgPSBmdW5jdGlvbiAoY2hpbGQsIG90aGVycykge1xuICAgIGlmICghKGNoaWxkIGluc3RhbmNlb2YgVHJhbnNmb3JtMkQpKSB7XG4gICAgICAgIExvZy5lcnJvcihcIlRyYW5zZm9ybTJELmFkZDogY2FuXFwndCBhZGQgcGFzc2VkIGFyZ3VtZW50LCBpdCBpcyBub3QgYW4gaW5zdGFuY2Ugb2YgVHJhbnNmb3JtMkRcIik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLFxuICAgICAgICBpbmRleCA9IGNoaWxkcmVuLmluZGV4T2YoY2hpbGQpLFxuICAgICAgICByb290LCBkZXB0aCwgc2NlbmU7XG5cbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIGlmIChjaGlsZC5wYXJlbnQpIGNoaWxkLnBhcmVudC5yZW1vdmUoY2hpbGQpO1xuXG4gICAgICAgIGNoaWxkLnBhcmVudCA9IHRoaXM7XG4gICAgICAgIGNoaWxkcmVuLnB1c2goY2hpbGQpO1xuXG4gICAgICAgIHJvb3QgPSB0aGlzO1xuICAgICAgICBkZXB0aCA9IDA7XG5cbiAgICAgICAgd2hpbGUgKHJvb3QucGFyZW50KSB7XG4gICAgICAgICAgICByb290ID0gcm9vdC5wYXJlbnQ7XG4gICAgICAgICAgICBkZXB0aCsrO1xuICAgICAgICB9XG4gICAgICAgIGNoaWxkLnJvb3QgPSByb290O1xuICAgICAgICB0aGlzLnJvb3QgPSByb290O1xuXG4gICAgICAgIHVwZGF0ZURlcHRoKHRoaXMsIGRlcHRoKTtcbiAgICAgICAgaWYgKCFvdGhlcnMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdhbWVPYmplY3QgJiYgKHNjZW5lID0gdGhpcy5nYW1lT2JqZWN0LnNjZW5lKSkge1xuICAgICAgICAgICAgICAgIHNjZW5lLmNvbXBvbmVudE1hbmFnZXJzLlRyYW5zZm9ybTJELnNvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIlRyYW5zZm9ybTJELmFkZDogY2hpbGQgaXMgbm90IGEgbWVtYmVyIG9mIHRoaXMgVHJhbnNmb3JtMkRcIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblRyYW5zZm9ybTJELnByb3RvdHlwZS5hZGRDaGlsZHJlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSwgaWwsIHNjZW5lO1xuXG4gICAgZm9yIChpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgdGhpcy5hZGRDaGlsZChhcmd1bWVudHNbaV0sIHRydWUpO1xuICAgIGlmICh0aGlzLmdhbWVPYmplY3QgJiYgKHNjZW5lID0gdGhpcy5nYW1lT2JqZWN0LnNjZW5lKSkge1xuICAgICAgICBzY2VuZS5jb21wb25lbnRNYW5hZ2Vycy5UcmFuc2Zvcm0yRC5zb3J0KCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5UcmFuc2Zvcm0yRC5wcm90b3R5cGUucmVtb3ZlQ2hpbGQgPSBmdW5jdGlvbiAoY2hpbGQsIG90aGVycykge1xuICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW4sXG4gICAgICAgIGluZGV4ID0gY2hpbGRyZW4uaW5kZXhPZihjaGlsZCksXG4gICAgICAgIHJvb3QsIGRlcHRoLCBzY2VuZTtcblxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgY2hpbGQucGFyZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICBjaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgICAgIHJvb3QgPSB0aGlzO1xuICAgICAgICBkZXB0aCA9IDA7XG5cbiAgICAgICAgd2hpbGUgKHJvb3QucGFyZW50KSB7XG4gICAgICAgICAgICByb290ID0gcm9vdC5wYXJlbnQ7XG4gICAgICAgICAgICBkZXB0aCsrO1xuICAgICAgICB9XG4gICAgICAgIGNoaWxkLnJvb3QgPSBjaGlsZDtcbiAgICAgICAgdGhpcy5yb290ID0gcm9vdDtcblxuICAgICAgICB1cGRhdGVEZXB0aCh0aGlzLCBkZXB0aCk7XG4gICAgICAgIGlmICghb3RoZXJzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5nYW1lT2JqZWN0ICYmIChzY2VuZSA9IHRoaXMuZ2FtZU9iamVjdC5zY2VuZSkpIHtcbiAgICAgICAgICAgICAgICBzY2VuZS5jb21wb25lbnRNYW5hZ2Vycy5UcmFuc2Zvcm0yRC5zb3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBMb2cuZXJyb3IoXCJUcmFuc2Zvcm0yRC5yZW1vdmU6IGNoaWxkIGlzIG5vdCBhIG1lbWJlciBvZiB0aGlzIFRyYW5zZm9ybTJEXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5UcmFuc2Zvcm0yRC5wcm90b3R5cGUucmVtb3ZlQ2hpbGRyZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGksIGlsLCBzY2VuZTtcblxuICAgIGZvciAoaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHRoaXMucmVtb3ZlQ2hpbGQoYXJndW1lbnRzW2ldLCB0cnVlKTtcbiAgICBpZiAodGhpcy5nYW1lT2JqZWN0ICYmIChzY2VuZSA9IHRoaXMuZ2FtZU9iamVjdC5zY2VuZSkpIHtcbiAgICAgICAgc2NlbmUuY29tcG9uZW50TWFuYWdlcnMuVHJhbnNmb3JtMkQuc29ydCgpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuVHJhbnNmb3JtMkQucHJvdG90eXBlLmRldGFjaENoaWxkcmVuID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpID0gYXJndW1lbnRzLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHRoaXMucmVtb3ZlQ2hpbGQoY2hpbGRyZW5baV0pO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5UcmFuc2Zvcm0yRC5wcm90b3R5cGUuaGFzQ2hpbGQgPSBmdW5jdGlvbiAoY2hpbGQpIHtcblxuICAgIHJldHVybiAhIX50aGlzLmNoaWxkcmVuLmluZGV4T2YoY2hpbGQpO1xufTtcblxuXG5UcmFuc2Zvcm0yRC5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbixcbiAgICAgICAgY2hpbGQsXG4gICAgICAgIGkgPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNoaWxkID0gY2hpbGRyZW5baV07XG5cbiAgICAgICAgaWYgKGNoaWxkLmdhbWVPYmplY3QubmFtZSA9PT0gbmFtZSkgcmV0dXJuIGNoaWxkO1xuICAgICAgICBpZiAoKGNoaWxkID0gY2hpbGQuZmluZChuYW1lKSkpIHJldHVybiBjaGlsZDtcbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuXG5UcmFuc2Zvcm0yRC5wcm90b3R5cGUudG9Xb3JsZCA9IGZ1bmN0aW9uICh2KSB7XG5cbiAgICByZXR1cm4gdi50cmFuc2Zvcm1NYXQ0KHRoaXMubWF0cml4V29ybGQpO1xufTtcblxuXG5UcmFuc2Zvcm0yRC5wcm90b3R5cGUudG9Mb2NhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbWF0ID0gbmV3IE1hdDQ7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHYpIHtcblxuICAgICAgICByZXR1cm4gdi50cmFuc2Zvcm1NYXQ0KG1hdC5pbnZlcnNlTWF0KHRoaXMubWF0cml4V29ybGQpKTtcbiAgICB9O1xufSgpO1xuXG5cblRyYW5zZm9ybTJELnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG1hdCA9IG5ldyBNYXQzMjtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBtYXRyaXggPSB0aGlzLm1hdHJpeCxcbiAgICAgICAgICAgIHBhcmVudCA9IHRoaXMucGFyZW50O1xuXG4gICAgICAgIG1hdHJpeC5mcm9tTWF0MzIobWF0LmNvbXBvc2UodGhpcy5wb3NpdGlvbiwgdGhpcy5zY2FsZSwgdGhpcy5yb3RhdGlvbikpO1xuXG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMubWF0cml4V29ybGQubW11bChwYXJlbnQubWF0cml4V29ybGQsIG1hdHJpeCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1hdHJpeFdvcmxkLmNvcHkobWF0cml4KTtcbiAgICAgICAgfVxuICAgIH07XG59KCk7XG5cblxuVHJhbnNmb3JtMkQucHJvdG90eXBlLnVwZGF0ZU1hdHJpY2VzID0gZnVuY3Rpb24gKHZpZXdNYXRyaXgpIHtcblxuICAgIHRoaXMubW9kZWxWaWV3Lm1tdWwodmlld01hdHJpeCwgdGhpcy5tYXRyaXhXb3JsZCk7XG4gICAgdGhpcy5ub3JtYWxNYXRyaXguaW52ZXJzZU1hdDQodGhpcy5tb2RlbFZpZXcpLnRyYW5zcG9zZSgpO1xufTtcblxuXG5UcmFuc2Zvcm0yRC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gQ29tcG9uZW50LnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLFxuICAgICAgICBqc29uQ2hpbGRyZW4gPSBqc29uLmNoaWxkcmVuIHx8IChqc29uLmNoaWxkcmVuID0gW10pLFxuICAgICAgICBpID0gY2hpbGRyZW4ubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkganNvbkNoaWxkcmVuW2ldID0gY2hpbGRyZW5baV0uX2lkO1xuXG4gICAganNvbi5wb3NpdGlvbiA9IHRoaXMucG9zaXRpb24udG9KU09OKGpzb24ucG9zaXRpb24pO1xuICAgIGpzb24uc2NhbGUgPSB0aGlzLnNjYWxlLnRvSlNPTihqc29uLnNjYWxlKTtcbiAgICBqc29uLnJvdGF0aW9uID0gdGhpcy5yb3RhdGlvblxuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cblRyYW5zZm9ybTJELnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuICAgIHZhciBjaGlsZHJlbiA9IGpzb24uY2hpbGRyZW4sXG4gICAgICAgIGkgPSBjaGlsZHJlbi5sZW5ndGgsXG4gICAgICAgIGNoaWxkLCBzY2VuZTtcblxuICAgIGlmICh0aGlzLmdhbWVPYmplY3QgJiYgKHNjZW5lID0gdGhpcy5nYW1lT2JqZWN0LnNjZW5lKSkge1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBjaGlsZCA9IHNjZW5lLmZpbmRDb21wb25lbnRCeUpTT05JZChjaGlsZHJlbltpXSk7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5oYXNDaGlsZChjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZENoaWxkKGNoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMub25jZShcInN0YXJ0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzY2VuZSA9IHRoaXMuZ2FtZU9iamVjdC5zY2VuZTtcblxuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIGNoaWxkID0gc2NlbmUuZmluZENvbXBvbmVudEJ5SlNPTklkKGNoaWxkcmVuW2ldKTtcblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5oYXNDaGlsZChjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnBvc2l0aW9uLmZyb21KU09OKGpzb24ucG9zaXRpb24pO1xuICAgIHRoaXMuc2NhbGUuZnJvbUpTT04oanNvbi5zY2FsZSk7XG4gICAgdGhpcy5yb3RhdGlvbiA9IGpzb24ucm90YXRpb247XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuZnVuY3Rpb24gdXBkYXRlRGVwdGgodHJhbnNmb3JtLCBkZXB0aCkge1xuICAgIHZhciBjaGlsZHJlbiA9IHRyYW5zZm9ybS5jaGlsZHJlbixcbiAgICAgICAgaSA9IGNoaWxkcmVuLmxlbmd0aDtcblxuICAgIHRyYW5zZm9ybS5kZXB0aCA9IGRlcHRoO1xuICAgIHdoaWxlIChpLS0pIHVwZGF0ZURlcHRoKGNoaWxkcmVuW2ldLCBkZXB0aCArIDEpO1xufVxuXG5cbm1vZHVsZS5leHBvcnRzID0gVHJhbnNmb3JtMkQ7XG4iLCJ2YXIgRW51bSA9IHJlcXVpcmUoXCIuLi9iYXNlL2VudW1cIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBBeGlzVHlwZTogbmV3IEVudW0oXCJCdXR0b24gTW91c2UgTW91c2VXaGVlbCBUb3VjaCBKb3lzdGlja1wiKSxcblxuICAgIEJsZW5kaW5nOiBuZXcgRW51bShcIkRlZmF1bHQgTm9uZSBBZGRpdGl2ZSBTdWJ0cmFjdGl2ZSBNdWxpcGx5IEN1c3RvbVwiKSxcbiAgICBTaWRlOiBuZXcgRW51bShcIkZyb250IEJhY2sgQm90aFwiKSxcblxuICAgIEN1bGxGYWNlOiBuZXcgRW51bShcIk5vbmUgQmFjayBGcm9udCBGcm9udEJhY2tcIiksXG5cbiAgICBFbWl0dGVyVHlwZTogbmV3IEVudW0oXCJDaXJjbGUgQm94IFNwaGVyZVwiKSxcblxuICAgIExpZ2h0VHlwZTogbmV3IEVudW0oXCJQb2ludCBEaXJlY3Rpb25hbCBTcG90IEhlbWlcIiksXG5cbiAgICBUZXh0Q2xpcHBpbmc6IG5ldyBFbnVtKFwiT3ZlcmZsb3cgQ2xpcFwiKSxcbiAgICBUZXh0QW5jaG9yOiBuZXcgRW51bShcIkxlZnQgQ2VudGVyIFJpZ2h0XCIpLFxuXG4gICAgU2hhZG93TWFwVHlwZTogbmV3IEVudW0oXCJCYXNpY1NoYWRvd01hcCBQQ0ZTaGFkb3dNYXAgUENGU29mdFNoYWRvd01hcFwiKSxcblxuICAgIEZpbHRlck1vZGU6IG5ldyBFbnVtKFwiTm9uZSBMaW5lYXJcIiksXG4gICAgVGV4dHVyZUZvcm1hdDogbmV3IEVudW0oXCJSR0IgUkdCQSBMdW1pbmFuY2UgQWxwaGEgTHVtaW5hbmNlQWxwaGFcIiksXG4gICAgVGV4dHVyZVdyYXA6IG5ldyBFbnVtKFwiUmVwZWF0IENsYW1wIE1pcnJvclJlcGVhdFwiKSxcblxuICAgIFdyYXBNb2RlOiBuZXcgRW51bShcIk9uY2UgTG9vcCBQaW5nUG9uZyBDbGFtcFwiKVxufTtcbiIsInZhciBDbGFzcyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2NsYXNzXCIpO1xudmFyIExvb3AgPSByZXF1aXJlKFwiLi9sb29wXCIpO1xudmFyIFNjZW5lID0gcmVxdWlyZShcIi4uL3NjZW5lXCIpO1xudmFyIEdVSSA9IHJlcXVpcmUoXCIuLi9ndWkvZ3VpXCIpO1xudmFyIExvZyA9IHJlcXVpcmUoXCIuLy4uLy4uL2Jhc2UvbG9nXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gQmFzZUdhbWUoKSB7XG5cbiAgICBDbGFzcy5jYWxsKHRoaXMpO1xuXG4gICAgdGhpcy5fbG9vcCA9IG5ldyBMb29wKHRoaXMubG9vcCwgdGhpcyk7XG5cbiAgICB0aGlzLmd1aXMgPSBbXTtcbiAgICB0aGlzLl9ndWlIYXNoID0ge307XG4gICAgdGhpcy5fZ3VpSlNPTkhhc2ggPSB7fTtcbiAgICB0aGlzLl9ndWlOYW1lSGFzaCA9IHt9O1xuXG4gICAgdGhpcy5zY2VuZXMgPSBbXTtcbiAgICB0aGlzLl9zY2VuZUhhc2ggPSB7fTtcbiAgICB0aGlzLl9zY2VuZUpTT05IYXNoID0ge307XG4gICAgdGhpcy5fc2NlbmVOYW1lSGFzaCA9IHt9O1xufVxuXG5DbGFzcy5leHRlbmQoQmFzZUdhbWUpO1xuXG5cbkJhc2VHYW1lLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5fbG9vcC5yZXN1bWUoKTtcbiAgICB0aGlzLmVtaXQoXCJpbml0XCIpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkJhc2VHYW1lLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2NlbmVzID0gdGhpcy5zY2VuZXMsXG4gICAgICAgIGkgPSBzY2VuZXMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkgdGhpcy5yZW1vdmVTY2VuZShzY2VuZXNbaV0sIHRydWUpO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5CYXNlR2FtZS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMuZW1pdChcImRlc3Ryb3lcIik7XG4gICAgdGhpcy5jbGVhcigpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkJhc2VHYW1lLnByb3RvdHlwZS5hZGRTY2VuZSA9IGZ1bmN0aW9uIChzY2VuZSkge1xuICAgIGlmICghKHNjZW5lIGluc3RhbmNlb2YgU2NlbmUpKSB7XG4gICAgICAgIExvZy5lcnJvcihcIkJhc2VHYW1lLmFkZFNjZW5lOiBjYW4ndCBhZGQgYXJndW1lbnQgdG8gQmFzZUdhbWUsIGl0J3Mgbm90IGFuIGluc3RhbmNlIG9mIFNjZW5lXCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdmFyIHNjZW5lSGFzaCA9IHRoaXMuX3NjZW5lSGFzaCxcbiAgICAgICAgc2NlbmVOYW1lSGFzaCA9IHRoaXMuX3NjZW5lTmFtZUhhc2gsXG4gICAgICAgIG5hbWUgPSBzY2VuZS5uYW1lLFxuICAgICAgICBpZCA9IHNjZW5lLl9pZCxcbiAgICAgICAganNvbjtcblxuICAgIGlmICghc2NlbmVOYW1lSGFzaFtuYW1lXSAmJiAhc2NlbmVIYXNoW2lkXSkge1xuICAgICAgICBqc29uID0gc2NlbmUudG9KU09OKCk7XG5cbiAgICAgICAgc2NlbmVOYW1lSGFzaFtuYW1lXSA9IGpzb247XG4gICAgICAgIHNjZW5lSGFzaFtpZF0gPSBqc29uO1xuICAgICAgICB0aGlzLnNjZW5lcy5wdXNoKGpzb24pO1xuICAgICAgICBpZiAoc2NlbmUuX2pzb25JZCAhPT0gLTEpIHRoaXMuX3NjZW5lSlNPTkhhc2hbc2NlbmUuX2pzb25JZF0gPSBqc29uO1xuXG4gICAgICAgIHRoaXMuZW1pdChcImFkZFNjZW5lXCIsIG5hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIkJhc2VHYW1lLmFkZFNjZW5lOiBTY2VuZSBpcyBhbHJlYWR5IGEgbWVtYmVyIG9mIEJhc2VHYW1lXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5CYXNlR2FtZS5wcm90b3R5cGUuYWRkU2NlbmVzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpLCBpbDtcblxuICAgIGZvciAoaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHRoaXMuYWRkU2NlbmUoYXJndW1lbnRzW2ldKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuQmFzZUdhbWUucHJvdG90eXBlLnJlbW92ZVNjZW5lID0gZnVuY3Rpb24gKHNjZW5lKSB7XG4gICAgaWYgKHR5cGVvZihzY2VuZSkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgc2NlbmUgPSB0aGlzLl9zY2VuZU5hbWVIYXNoW3NjZW5lXTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZihzY2VuZSkgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgc2NlbmUgPSB0aGlzLl9zY2VuZUhhc2hbc2NlbmVdO1xuICAgIH1cbiAgICB2YXIgc2NlbmVzID0gdGhpcy5zY2VuZXMsXG4gICAgICAgIHNjZW5lSGFzaCA9IHRoaXMuX3NjZW5lSGFzaCxcbiAgICAgICAgc2NlbmVOYW1lSGFzaCA9IHRoaXMuX3NjZW5lTmFtZUhhc2gsXG4gICAgICAgIG5hbWUgPSBzY2VuZS5uYW1lLFxuICAgICAgICBpZCA9IHNjZW5lLl9pZCxcbiAgICAgICAganNvbjtcblxuICAgIGlmIChzY2VuZU5hbWVIYXNoW25hbWVdICYmIHNjZW5lSGFzaFtpZF0pIHtcbiAgICAgICAganNvbiA9IHNjZW5lTmFtZUhhc2hbbmFtZV07XG5cbiAgICAgICAgc2NlbmVOYW1lSGFzaFtuYW1lXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgc2NlbmVIYXNoW2lkXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgc2NlbmVzLnNwbGljZShzY2VuZXMuaW5kZXhPZihqc29uKSwgMSk7XG4gICAgICAgIGlmIChqc29uLl9qc29uSWQgIT09IC0xKSB0aGlzLl9zY2VuZUpTT05IYXNoW2pzb24uX2pzb25JZF0gPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgdGhpcy5lbWl0KFwicmVtb3ZlU2NlbmVcIiwgbmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgTG9nLmVycm9yKFwiQmFzZUdhbWUucmVtb3ZlU2NlbmU6IFNjZW5lIG5vdCBhIG1lbWJlciBvZiBCYXNlR2FtZVwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuQmFzZUdhbWUucHJvdG90eXBlLnJlbW92ZVNjZW5lcyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSwgaWw7XG5cbiAgICBmb3IgKGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB0aGlzLnJlbW92ZVNjZW5lKGFyZ3VtZW50c1tpXSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkJhc2VHYW1lLnByb3RvdHlwZS5hZGRHVUkgPSBmdW5jdGlvbiAoZ3VpKSB7XG4gICAgaWYgKCEoZ3VpIGluc3RhbmNlb2YgR1VJKSkge1xuICAgICAgICBMb2cuZXJyb3IoXCJCYXNlR2FtZS5hZGRHVUk6IGNhbid0IGFkZCBhcmd1bWVudCB0byBCYXNlR2FtZSwgaXQncyBub3QgYW4gaW5zdGFuY2Ugb2YgR1VJXCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdmFyIGd1aUhhc2ggPSB0aGlzLl9ndWlIYXNoLFxuICAgICAgICBndWlOYW1lSGFzaCA9IHRoaXMuX2d1aU5hbWVIYXNoLFxuICAgICAgICBuYW1lID0gZ3VpLm5hbWUsXG4gICAgICAgIGlkID0gZ3VpLl9pZCxcbiAgICAgICAganNvbjtcblxuICAgIGlmICghZ3VpTmFtZUhhc2hbbmFtZV0gJiYgIWd1aUhhc2hbaWRdKSB7XG4gICAgICAgIGpzb24gPSBndWkudG9KU09OKCk7XG5cbiAgICAgICAgZ3VpTmFtZUhhc2hbbmFtZV0gPSBqc29uO1xuICAgICAgICBndWlIYXNoW2lkXSA9IGpzb247XG4gICAgICAgIHRoaXMuZ3Vpcy5wdXNoKGpzb24pO1xuICAgICAgICBpZiAoZ3VpLl9qc29uSWQgIT09IC0xKSB0aGlzLl9ndWlKU09OSGFzaFtndWkuX2pzb25JZF0gPSBqc29uO1xuXG4gICAgICAgIHRoaXMuZW1pdChcImFkZEdVSVwiLCBuYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBMb2cuZXJyb3IoXCJCYXNlR2FtZS5hZGRHVUk6IEdVSSBpcyBhbHJlYWR5IGEgbWVtYmVyIG9mIEJhc2VHYW1lXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5CYXNlR2FtZS5wcm90b3R5cGUuYWRkR1VJcyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLmFkZEdVSShhcmd1bWVudHNbaV0pO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5CYXNlR2FtZS5wcm90b3R5cGUucmVtb3ZlR1VJID0gZnVuY3Rpb24gKGd1aSkge1xuICAgIGlmICh0eXBlb2YoZ3VpKSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBndWkgPSB0aGlzLl9ndWlOYW1lSGFzaFtndWldO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mKGd1aSkgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgZ3VpID0gdGhpcy5fZ3VpSGFzaFtndWldO1xuICAgIH1cbiAgICB2YXIgZ3VpcyA9IHRoaXMuZ3VpcyxcbiAgICAgICAgZ3VpSGFzaCA9IHRoaXMuX2d1aUhhc2gsXG4gICAgICAgIGd1aU5hbWVIYXNoID0gdGhpcy5fZ3VpTmFtZUhhc2gsXG4gICAgICAgIG5hbWUgPSBndWkubmFtZSxcbiAgICAgICAgaWQgPSBndWkuX2lkLFxuICAgICAgICBqc29uO1xuXG4gICAgaWYgKGd1aU5hbWVIYXNoW25hbWVdICYmIGd1aUhhc2hbaWRdKSB7XG4gICAgICAgIGpzb24gPSBndWlOYW1lSGFzaFtuYW1lXTtcblxuICAgICAgICBndWlOYW1lSGFzaFtuYW1lXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgZ3VpSGFzaFtpZF0gPSB1bmRlZmluZWQ7XG4gICAgICAgIGd1aXMuc3BsaWNlKGd1aXMuaW5kZXhPZihqc29uKSwgMSk7XG4gICAgICAgIGlmIChqc29uLl9qc29uSWQgIT09IC0xKSB0aGlzLl9ndWlKU09OSGFzaFtqc29uLl9qc29uSWRdID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIHRoaXMuZW1pdChcInJlbW92ZUdVSVwiLCBuYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBMb2cuZXJyb3IoXCJCYXNlR2FtZS5yZW1vdmVHVUk6IEdVSSBub3QgYSBtZW1iZXIgb2YgQmFzZUdhbWVcIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkJhc2VHYW1lLnByb3RvdHlwZS5yZW1vdmVHVUlzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpID0gYXJndW1lbnRzLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHRoaXMucmVtb3ZlR1VJKGFyZ3VtZW50c1tpXSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkJhc2VHYW1lLnByb3RvdHlwZS5maW5kU2NlbmVCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkge1xuXG4gICAgcmV0dXJuIHRoaXMuX3NjZW5lTmFtZUhhc2hbbmFtZV07XG59O1xuXG5cbkJhc2VHYW1lLnByb3RvdHlwZS5maW5kU2NlbmVCeUlkID0gZnVuY3Rpb24gKGlkKSB7XG5cbiAgICByZXR1cm4gdGhpcy5fc2NlbmVIYXNoW2lkXTtcbn07XG5cblxuQmFzZUdhbWUucHJvdG90eXBlLmZpbmRTY2VuZUJ5SlNPTklkID0gZnVuY3Rpb24gKGlkKSB7XG5cbiAgICByZXR1cm4gdGhpcy5fc2NlbmVKU09OSGFzaFtpZF07XG59O1xuXG5cbkJhc2VHYW1lLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMuX2xvb3AucGF1c2UoKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuQmFzZUdhbWUucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMuX2xvb3AucmVzdW1lKCk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkJhc2VHYW1lLnByb3RvdHlwZS5sb29wID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5lbWl0KFwidXBkYXRlXCIsIFRpbWUuc2luY2VTdGFydCk7XG59O1xuXG5cbkJhc2VHYW1lLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDbGFzcy5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbik7XG4gICAgdmFyIHNjZW5lcyA9IHRoaXMuc2NlbmVzLFxuICAgICAgICBqc29uU2NlbmVzID0ganNvbi5zY2VuZXMgfHwgKGpzb24uc2NlbmVzID0gW10pLFxuICAgICAgICBpID0gc2NlbmVzLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIGpzb25TY2VuZXNbaV0gPSBzY2VuZXNbaV07XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuQmFzZUdhbWUucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBDbGFzcy5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcbiAgICB2YXIganNvblNjZW5lcyA9IGpzb24uc2NlbmVzLFxuICAgICAgICBzY2VuZSwganNvblNjZW5lLFxuICAgICAgICBpID0ganNvblNjZW5lcy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGpzb25TY2VuZSA9IGpzb25TY2VuZXNbaV07XG5cbiAgICAgICAgaWYgKChzY2VuZSA9IHRoaXMuZmluZFNjZW5lQnlKU09OSWQoanNvblNjZW5lLl9pZCkpKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZVNjZW5lKHNjZW5lKS5hZGRTY2VuZShqc29uU2NlbmUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hZGRTY2VuZShqc29uU2NlbmUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gQmFzZUdhbWU7XG4iLCJ2YXIgQ2xhc3MgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9jbGFzc1wiKTtcbnZhciBEZXZpY2UgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9kZXZpY2VcIik7XG52YXIgVGltZSA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL3RpbWVcIik7XG52YXIgTWF0aGYgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9tYXRoZlwiKTtcbnZhciBDb25maWcgPSByZXF1aXJlKFwiLi8uLi8uLi9iYXNlL2NvbmZpZ1wiKTtcbnZhciBCYXNlR2FtZSA9IHJlcXVpcmUoXCIuL2Jhc2VfZ2FtZVwiKTtcbnZhciBDYW52YXMgPSByZXF1aXJlKFwiLi4vcmVuZGVyZXIvY2FudmFzXCIpO1xudmFyIFJlbmRlcmVyID0gcmVxdWlyZShcIi4uL3JlbmRlcmVyL3JlbmRlcmVyXCIpO1xudmFyIEdhbWVPYmplY3QgPSByZXF1aXJlKFwiLi4vZ2FtZV9vYmplY3RcIik7XG52YXIgQ29tcG9uZW50ID0gcmVxdWlyZShcIi4uL2NvbXBvbmVudHMvY29tcG9uZW50XCIpO1xudmFyIFNjZW5lID0gcmVxdWlyZShcIi4uL3NjZW5lXCIpO1xudmFyIElucHV0ID0gcmVxdWlyZShcIi4uL2lucHV0L2lucHV0XCIpO1xudmFyIEhhbmRsZXIgPSByZXF1aXJlKFwiLi4vaW5wdXQvaGFuZGxlclwiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi8uLi8uLi9iYXNlL2xvZ1wiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIEdhbWUob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG4gICAgQ29uZmlnLmZyb21KU09OKG9wdHMpO1xuXG4gICAgQmFzZUdhbWUuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMuX2hhbmRsZXIgPSBIYW5kbGVyO1xuICAgIHRoaXMuaW5wdXQgPSBJbnB1dDtcblxuICAgIHRoaXMuZ3VpID0gdW5kZWZpbmVkO1xuXG4gICAgdGhpcy5zY2VuZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmNhbWVyYSA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuY2FudmFzID0gbmV3IENhbnZhcyhvcHRzLmNhbnZhcyk7XG4gICAgdGhpcy5yZW5kZXJlciA9IG5ldyBSZW5kZXJlcihvcHRzLnJlbmRlcmVyKTtcbn1cblxuQmFzZUdhbWUuZXh0ZW5kKEdhbWUpO1xuXG5cbkdhbWUucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNhbnZhcyA9IHRoaXMuY2FudmFzO1xuXG4gICAgY2FudmFzLmluaXQoKTtcbiAgICB0aGlzLnJlbmRlcmVyLmluaXQoY2FudmFzKTtcbiAgICBIYW5kbGVyLnNldEVsZW1lbnQoY2FudmFzLmVsZW1lbnQpO1xuXG4gICAgdGhpcy5fbG9vcC5yZXN1bWUoKTtcbiAgICB0aGlzLmVtaXQoXCJpbml0XCIpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdhbWUucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5pbml0KCk7XG4gICAgdGhpcy5lbWl0KFwic3RhcnRcIik7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR2FtZS5wcm90b3R5cGUuc2V0R1VJID0gZnVuY3Rpb24gKGd1aSkge1xuICAgIGlmICh0eXBlb2YoZ3VpKSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBndWkgPSB0aGlzLl9ndWlOYW1lSGFzaFtndWldO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mKGd1aSkgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgZ3VpID0gdGhpcy5ndWlzW2d1aV07XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX2d1aU5hbWVIYXNoW2d1aS5uYW1lXSAmJiB0aGlzLl9ndWlIYXNoW2d1aS5faWRdKSB7XG4gICAgICAgIGlmICh0aGlzLmd1aSkgdGhpcy5ndWkuZGVzdHJveSgpO1xuXG4gICAgICAgIGd1aSA9IENsYXNzLmZyb21KU09OKGd1aSk7XG4gICAgICAgIHRoaXMuZ3VpID0gZ3VpO1xuXG4gICAgICAgIGd1aS5nYW1lID0gdGhpcztcblxuICAgICAgICBndWkuaW5pdCgpO1xuICAgICAgICBndWkuZW1pdChcImluaXRcIik7XG5cbiAgICAgICAgZ3VpLnN0YXJ0KCk7XG4gICAgICAgIGd1aS5lbWl0KFwic3RhcnRcIik7XG5cbiAgICAgICAgdGhpcy5lbWl0KFwic2V0R1VJXCIsIHRoaXMuZ3VpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBMb2cuZXJyb3IoXCJHYW1lLnNldEdVSTogR1VJIGlzIG5vdCBhIG1lbWJlciBvZiBHYW1lXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HYW1lLnByb3RvdHlwZS5zZXRTY2VuZSA9IGZ1bmN0aW9uIChzY2VuZSkge1xuICAgIGlmICh0eXBlb2Yoc2NlbmUpID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHNjZW5lID0gdGhpcy5fc2NlbmVOYW1lSGFzaFtzY2VuZV07XG4gICAgfSBlbHNlIGlmICh0eXBlb2Yoc2NlbmUpID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHNjZW5lID0gdGhpcy5zY2VuZXNbc2NlbmVdO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9zY2VuZU5hbWVIYXNoW3NjZW5lLm5hbWVdICYmIHRoaXMuX3NjZW5lSGFzaFtzY2VuZS5faWRdKSB7XG4gICAgICAgIGlmICh0aGlzLnNjZW5lKSB0aGlzLnNjZW5lLmRlc3Ryb3koKTtcblxuICAgICAgICBzY2VuZSA9IENsYXNzLmZyb21KU09OKHNjZW5lKTtcbiAgICAgICAgdGhpcy5zY2VuZSA9IHNjZW5lO1xuXG4gICAgICAgIHNjZW5lLmdhbWUgPSB0aGlzO1xuXG4gICAgICAgIHNjZW5lLmluaXQoKTtcbiAgICAgICAgc2NlbmUuZW1pdChcImluaXRcIik7XG5cbiAgICAgICAgc2NlbmUuc3RhcnQoKTtcbiAgICAgICAgc2NlbmUuZW1pdChcInN0YXJ0XCIpO1xuXG4gICAgICAgIHRoaXMuZW1pdChcInNldFNjZW5lXCIsIHRoaXMuc2NlbmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIkdhbWUuc2V0U2NlbmU6IFNjZW5lIGlzIG5vdCBhIG1lbWJlciBvZiBHYW1lXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HYW1lLnByb3RvdHlwZS5zZXRDYW1lcmEgPSBmdW5jdGlvbiAoZ2FtZU9iamVjdCkge1xuICAgIGlmICghKGdhbWVPYmplY3QgaW5zdGFuY2VvZiBHYW1lT2JqZWN0KSkge1xuICAgICAgICBMb2cuZXJyb3IoXCJHYW1lLnNldENhbWVyYTogY2FuJ3Qgc2V0IGFyZ3VtZW50IHRvIEdhbWUncyBBY3RpdmUgQ2FtZXJhLCBpdCdzIG5vdCBhbiBpbnN0YW5jZSBvZiBHYW1lT2JqZWN0XCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdmFyIHNjZW5lID0gdGhpcy5zY2VuZSxcbiAgICAgICAgbGFzdENhbWVyYSA9IHRoaXMuY2FtZXJhLFxuICAgICAgICBpbmRleDtcblxuICAgIGlmICghc2NlbmUpIHtcbiAgICAgICAgTG9nLmVycm9yKFwiR2FtZS5zZXRDYW1lcmE6IGNhbid0IHNldCBjYW1lcmEgd2l0aG91dCBhbiBhY3RpdmUgc2NlbmUsIHVzZSBHYW1lLnNldFNjZW5lIGZpcnN0XCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBpbmRleCA9IHNjZW5lLmdhbWVPYmplY3RzLmluZGV4T2YoZ2FtZU9iamVjdCk7XG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICBMb2cud2FybihcIkdhbWUuc2V0Q2FtZXJhOiBHYW1lT2JqZWN0IGlzIG5vdCBhIG1lbWJlciBvZiB0aGUgYWN0aXZlIFNjZW5lLCBhZGRpbmcgaXQuLi5cIik7XG4gICAgICAgIHNjZW5lLmFkZEdhbWVPYmplY3QoZ2FtZU9iamVjdCk7XG4gICAgfVxuXG4gICAgdGhpcy5jYW1lcmEgPSBnYW1lT2JqZWN0LmNhbWVyYSB8fCBnYW1lT2JqZWN0LmNhbWVyYTJkO1xuXG4gICAgaWYgKHRoaXMuY2FtZXJhKSB7XG4gICAgICAgIHRoaXMuY2FtZXJhLl9hY3RpdmUgPSB0cnVlO1xuICAgICAgICBpZiAobGFzdENhbWVyYSkgbGFzdENhbWVyYS5fYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5lbWl0KFwic2V0Q2FtZXJhXCIsIHRoaXMuY2FtZXJhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBMb2cuZXJyb3IoXCJHYW1lLnNldENhbWVyYTogR2FtZU9iamVjdCBkb2VzJ3QgaGF2ZSBhIENhbWVyYSBvciBhIENhbWVyYTJEIENvbXBvbmVudFwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR2FtZS5wcm90b3R5cGUubG9vcCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY2FtZXJhID0gdGhpcy5jYW1lcmEsXG4gICAgICAgIHNjZW5lID0gdGhpcy5zY2VuZSxcbiAgICAgICAgZ3VpID0gdGhpcy5ndWksXG4gICAgICAgIHJlbmRlcmVyID0gdGhpcy5yZW5kZXJlcjtcblxuICAgIFRpbWUudXBkYXRlKCk7XG4gICAgSW5wdXQudXBkYXRlKCk7XG5cbiAgICB0aGlzLmVtaXQoXCJ1cGRhdGVcIiwgVGltZS5zaW5jZVN0YXJ0KTtcbiAgICBpZiAocmVuZGVyZXIgJiYgY2FtZXJhKSB7XG5cbiAgICAgICAgaWYgKHNjZW5lKSB7XG4gICAgICAgICAgICBzY2VuZS51cGRhdGUoKTtcbiAgICAgICAgICAgIHNjZW5lLmVtaXQoXCJ1cGRhdGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGd1aSkge1xuICAgICAgICAgICAgZ3VpLmFzcGVjdCA9IGNhbWVyYS5hc3BlY3Q7XG4gICAgICAgICAgICBndWkud2lkdGggPSBjYW1lcmEud2lkdGg7XG4gICAgICAgICAgICBndWkuaGVpZ2h0ID0gY2FtZXJhLmhlaWdodDtcbiAgICAgICAgICAgIGd1aS5pbnZXaWR0aCA9IGNhbWVyYS5pbnZXaWR0aDtcbiAgICAgICAgICAgIGd1aS5pbnZIZWlnaHQgPSBjYW1lcmEuaW52SGVpZ2h0O1xuXG4gICAgICAgICAgICBndWkudXBkYXRlKCk7XG4gICAgICAgICAgICBndWkuZW1pdChcInVwZGF0ZVwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlbmRlcmVyLnJlbmRlcihjYW1lcmEsIHNjZW5lLCBndWkpO1xuICAgIH1cbiAgICB0aGlzLmVtaXQoXCJsYXRlVXBkYXRlXCIsIFRpbWUuc2luY2VTdGFydCk7XG59XG5cblxubW9kdWxlLmV4cG9ydHMgPSBHYW1lO1xuIiwidmFyIHJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL3JlcXVlc3RfYW5pbWF0aW9uX2ZyYW1lXCIpO1xudmFyIExvZyA9IHJlcXVpcmUoXCIuLy4uLy4uL2Jhc2UvbG9nXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gTG9vcChjYWxsYmFjaywgY3R4KSB7XG4gICAgY3R4IHx8IChjdHggPSB0aGlzKTtcblxuICAgIHRoaXMucGF1c2VkID0gdHJ1ZTtcblxuICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB0aGlzLmN0eCA9IGN0eCB8fCB0aGlzO1xuXG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICB0aGlzLl9ydW4gPSBmdW5jdGlvbiAobXMpIHtcblxuICAgICAgICBpZiAoX3RoaXMuY2FsbGJhY2spIHtcbiAgICAgICAgICAgIF90aGlzLmNhbGxiYWNrLmNhbGwoY3R4LCBtcyk7XG5cbiAgICAgICAgICAgIGlmICghX3RoaXMucGF1c2VkKSBfdGhpcy5fcHVtcCgpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cbkxvb3AucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuY2FsbGJhY2spIHtcbiAgICAgICAgTG9nLndhcm4oXCJMb29wLnJlc3VtZTogY2FuJ3QgcnVuIGxvb3Agd2l0aG91dCBjYWxsYmFja1wiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMucGF1c2VkID0gZmFsc2U7XG4gICAgdGhpcy5fcHVtcCgpO1xufTtcblxuXG5Mb29wLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMucGF1c2VkID0gdHJ1ZTtcbn07XG5cblxuTG9vcC5wcm90b3R5cGUuaXNSdW5uaW5nID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuICF0aGlzLnBhdXNlZDtcbn07XG5cblxuTG9vcC5wcm90b3R5cGUuaXNQYXVzZWQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gdGhpcy5wYXVzZWQ7XG59O1xuXG5cbkxvb3AucHJvdG90eXBlLl9wdW1wID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuX3J1bik7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gTG9vcDtcbiIsInZhciBDbGFzcyA9IHJlcXVpcmUoXCIuLi9iYXNlL2NsYXNzXCIpO1xudmFyIENvbXBvbmVudCA9IHJlcXVpcmUoXCIuL2NvbXBvbmVudHMvY29tcG9uZW50XCIpO1xudmFyIExvZyA9IHJlcXVpcmUoXCIuLy4uL2Jhc2UvbG9nXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQGNsYXNzIEdhbWVPYmplY3RcbiAqIEBleHRlbmRzIENsYXNzXG4gKiBAbWVtYmVyb2YgT2RpblxuICogQGJyaWVmIEJhc2UgY2xhc3MgZm9yIGVudGl0aWVzIGluIHNjZW5lc1xuICogQHBhcmFtIE9iamVjdCBvcHRpb25zXG4gKi9cbmZ1bmN0aW9uIEdhbWVPYmplY3Qob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBDbGFzcy5jYWxsKHRoaXMpO1xuXG4gICAgdGhpcy5uYW1lID0gb3B0cy5uYW1lICE9IHVuZGVmaW5lZCA/IG9wdHMubmFtZSA6IFwiR2FtZU9iamVjdF9cIiArIHRoaXMuX2lkO1xuXG4gICAgdGhpcy5zY2VuZSA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMudGFncyA9IFtdO1xuXG4gICAgdGhpcy5jb21wb25lbnRzID0gW107XG4gICAgdGhpcy5fY29tcG9uZW50VHlwZSA9IHt9O1xuICAgIHRoaXMuX2NvbXBvbmVudEhhc2ggPSB7fTtcbiAgICB0aGlzLl9jb21wb25lbnRKU09OSGFzaCA9IHt9O1xuXG4gICAgaWYgKG9wdHMudGFnKSB0aGlzLmFkZFRhZyhvcHRzLnRhZyk7XG4gICAgaWYgKG9wdHMudGFncykgdGhpcy5hZGRUYWdzLmFwcGx5KHRoaXMsIG9wdHMudGFncyk7XG5cbiAgICBpZiAob3B0cy5jb21wb25lbnRzKSB0aGlzLmFkZENvbXBvbmVudHMuYXBwbHkodGhpcywgb3B0cy5jb21wb25lbnRzKTtcbn1cblxuQ2xhc3MuZXh0ZW5kKEdhbWVPYmplY3QpO1xuXG5cbkdhbWVPYmplY3QucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cyxcbiAgICAgICAgb3RoZXJDb21wb25lbnRzID0gb3RoZXIuY29tcG9uZW50cyxcbiAgICAgICAgdGFncyA9IG90aGVyLnRhZ3MsXG4gICAgICAgIG90aGVyQ29tcG9uZW50LCBjb21wb25lbnQsXG4gICAgICAgIGkgPSBjb21wb25lbnRzLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY29tcG9uZW50ID0gY29tcG9uZW50c1tpXTtcbiAgICAgICAgaWYgKCFvdGhlci5oYXNDb21wb25lbnQoY29tcG9uZW50Ll9jbGFzc05hbWUpKSB0aGlzLnJlbW92ZUNvbXBvbmVudChjb21wb25lbnQpO1xuICAgIH1cblxuICAgIGkgPSBvdGhlckNvbXBvbmVudHMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgb3RoZXJDb21wb25lbnQgPSBvdGhlckNvbXBvbmVudHNbaV07XG5cbiAgICAgICAgaWYgKChjb21wb25lbnQgPSB0aGlzLmdldENvbXBvbmVudChvdGhlckNvbXBvbmVudC5fdHlwZSkpKSB7XG4gICAgICAgICAgICBjb21wb25lbnQuY29weShvdGhlckNvbXBvbmVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFkZENvbXBvbmVudChvdGhlckNvbXBvbmVudC5jbG9uZSgpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGkgPSB0YWdzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB0aGlzLmFkZFRhZyh0YWdzW2ldKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HYW1lT2JqZWN0LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cyxcbiAgICAgICAgdGFncyA9IHRoaXMudGFncyxcbiAgICAgICAgY29tcG9uZW50TGVuZ3RoID0gY29tcG9uZW50cy5sZW5ndGgsXG4gICAgICAgIGk7XG5cbiAgICBpID0gY29tcG9uZW50TGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIGNvbXBvbmVudHNbaV0uY2xlYXIoKTtcblxuICAgIGkgPSB0YWdzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB0aGlzLnJlbW92ZVRhZyh0YWdzW2ldKTtcblxuICAgIGkgPSBjb21wb25lbnRMZW5ndGg7XG4gICAgd2hpbGUgKGktLSkgdGhpcy5yZW1vdmVDb21wb25lbnQoY29tcG9uZW50c1tpXSk7XG5cbiAgICB0aGlzLm9mZigpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdhbWVPYmplY3QucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLnNjZW5lKSB7XG4gICAgICAgIExvZy5lcnJvcihcIkdhbWVPYmplY3QuZGVzdHJveTogY2FuJ3QgZGVzdHJveSBHYW1lT2JqZWN0IGlmIGl0J3Mgbm90IGFkZGVkIHRvIGEgU2NlbmVcIik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHRoaXMuc2NlbmUucmVtb3ZlR2FtZU9iamVjdCh0aGlzKTtcbiAgICB0aGlzLmVtaXQoXCJkZXN0cm95XCIpO1xuXG4gICAgdGhpcy5jbGVhcigpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdhbWVPYmplY3QucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuc2NlbmUpIHtcbiAgICAgICAgTG9nLmVycm9yKFwiR2FtZU9iamVjdC5yZW1vdmU6IGNhbid0IHJlbW92ZSBHYW1lT2JqZWN0IGlmIGl0J3Mgbm90IGFkZGVkIHRvIGEgU2NlbmVcIik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHRoaXMuc2NlbmUucmVtb3ZlR2FtZU9iamVjdCh0aGlzKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR2FtZU9iamVjdC5wcm90b3R5cGUuYWRkVGFnID0gZnVuY3Rpb24gKHRhZykge1xuICAgIHZhciB0YWdzID0gdGhpcy50YWdzO1xuXG4gICAgaWYgKHRhZ3MuaW5kZXhPZih0YWcpID09PSAtMSkgdGFncy5wdXNoKHRhZyk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR2FtZU9iamVjdC5wcm90b3R5cGUuYWRkVGFncyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLmFkZFRhZyhhcmd1bWVudHNbaV0pO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HYW1lT2JqZWN0LnByb3RvdHlwZS5yZW1vdmVUYWcgPSBmdW5jdGlvbiAodGFnKSB7XG4gICAgdmFyIHRhZ3MgPSB0aGlzLnRhZ3MsXG4gICAgICAgIGluZGV4ID0gdGFncy5pbmRleE9mKHRhZyk7XG5cbiAgICBpZiAoaW5kZXggIT09IC0xKSB0YWdzLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR2FtZU9iamVjdC5wcm90b3R5cGUucmVtb3ZlVGFncyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLnJlbW92ZVRhZyhhcmd1bWVudHNbaV0pO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HYW1lT2JqZWN0LnByb3RvdHlwZS5oYXNUYWcgPSBmdW5jdGlvbiAodGFnKSB7XG5cbiAgICByZXR1cm4gdGhpcy50YWdzLmluZGV4T2YodGFnKSAhPT0gLTE7XG59O1xuXG5cbkdhbWVPYmplY3QucHJvdG90eXBlLmFkZENvbXBvbmVudCA9IGZ1bmN0aW9uIChjb21wb25lbnQsIG90aGVycykge1xuICAgIGlmICh0eXBlb2YoY29tcG9uZW50KSA9PT0gXCJzdHJpbmdcIikgY29tcG9uZW50ID0gbmV3IENsYXNzLl9jbGFzc2VzW2NvbXBvbmVudF07XG4gICAgaWYgKCEoY29tcG9uZW50IGluc3RhbmNlb2YgQ29tcG9uZW50KSkge1xuICAgICAgICBMb2cuZXJyb3IoXCJHYW1lT2JqZWN0LmFkZENvbXBvbmVudDogY2FuJ3QgYWRkIHBhc3NlZCBhcmd1bWVudCwgaXQgaXMgbm90IGFuIGluc3RhbmNlIG9mIENvbXBvbmVudFwiKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHZhciBuYW1lID0gY29tcG9uZW50Ll9uYW1lLFxuICAgICAgICBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLFxuICAgICAgICBjb21wLCBpLCBqO1xuXG5cbiAgICBpZiAoIXRoaXNbbmFtZV0pIHtcbiAgICAgICAgaWYgKGNvbXBvbmVudC5nYW1lT2JqZWN0KSBjb21wb25lbnQgPSBjb21wb25lbnQuY2xvbmUoKTtcblxuICAgICAgICBjb21wb25lbnRzLnB1c2goY29tcG9uZW50KTtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50VHlwZVtjb21wb25lbnQuX3R5cGVdID0gY29tcG9uZW50O1xuICAgICAgICB0aGlzLl9jb21wb25lbnRIYXNoW2NvbXBvbmVudC5faWRdID0gY29tcG9uZW50O1xuICAgICAgICBpZiAoY29tcG9uZW50Ll9qc29uSWQgIT09IC0xKSB0aGlzLl9jb21wb25lbnRKU09OSGFzaFtjb21wb25lbnQuX2pzb25JZF0gPSBjb21wb25lbnQ7XG5cbiAgICAgICAgY29tcG9uZW50LmdhbWVPYmplY3QgPSB0aGlzO1xuICAgICAgICB0aGlzW25hbWVdID0gY29tcG9uZW50O1xuXG4gICAgICAgIGlmICghb3RoZXJzKSB7XG4gICAgICAgICAgICBpID0gY29tcG9uZW50cy5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgY29tcCA9IGNvbXBvbmVudHNbaV07XG4gICAgICAgICAgICAgICAgaWYgKCFjb21wKSBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgIGogPSBjb21wb25lbnRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoai0tKSBjb21wW2NvbXBvbmVudHNbal0uX25hbWVdID0gY29tcG9uZW50c1tqXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29tcG9uZW50LmluaXQoKTtcbiAgICAgICAgICAgIGNvbXBvbmVudC5lbWl0KFwiaW5pdFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZW1pdChcImFkZFwiICsgY29tcG9uZW50Ll90eXBlLCBjb21wb25lbnQpO1xuICAgICAgICB0aGlzLmVtaXQoXCJhZGRDb21wb25lbnRcIiwgY29tcG9uZW50KTtcbiAgICAgICAgY29tcG9uZW50LmVtaXQoXCJhZGRcIiwgdGhpcyk7XG5cbiAgICAgICAgaWYgKHRoaXMuc2NlbmUpIHRoaXMuc2NlbmUuX2FkZENvbXBvbmVudChjb21wb25lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIkdhbWVPYmplY3QuYWRkQ29tcG9uZW50OiBHYW1lT2JqZWN0IGFscmVhZHkgaGFzIGEobikgXCIgKyBjb21wb25lbnQuX3R5cGUgKyBcIiBDb21wb25lbnRcIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdhbWVPYmplY3QucHJvdG90eXBlLmFkZENvbXBvbmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsXG4gICAgICAgIGNvbXBvbmVudHMgPSB0aGlzLmNvbXBvbmVudHMsXG4gICAgICAgIGNvbXBvbmVudCwgbmFtZSxcbiAgICAgICAgaSwgajtcblxuICAgIGkgPSBsZW5ndGg7XG4gICAgd2hpbGUgKGktLSkgdGhpcy5hZGRDb21wb25lbnQoYXJndW1lbnRzW2ldLCB0cnVlKTtcblxuICAgIGkgPSBjb21wb25lbnRzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbXBvbmVudCA9IGNvbXBvbmVudHNbaV07XG4gICAgICAgIGlmICghY29tcG9uZW50KSBjb250aW51ZTtcblxuICAgICAgICBqID0gY29tcG9uZW50cy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChqLS0pIHtcbiAgICAgICAgICAgIG5hbWUgPSBjb21wb25lbnRzW2pdLl9uYW1lO1xuICAgICAgICAgICAgY29tcG9uZW50W25hbWVdID0gY29tcG9uZW50c1tqXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGkgPSBjb21wb25lbnRzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbXBvbmVudCA9IGNvbXBvbmVudHNbaV07XG4gICAgICAgIGNvbXBvbmVudC5pbml0KCk7XG4gICAgICAgIGNvbXBvbmVudC5lbWl0KFwiaW5pdFwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR2FtZU9iamVjdC5wcm90b3R5cGUucmVtb3ZlQ29tcG9uZW50ID0gZnVuY3Rpb24gKGNvbXBvbmVudCwgY2xlYXIsIG90aGVycykge1xuICAgIGlmICh0eXBlb2YoY29tcG9uZW50KSA9PT0gXCJzdHJpbmdcIikgY29tcG9uZW50ID0gdGhpcy5nZXRDb21wb25lbnQoY29tcG9uZW50KTtcbiAgICBpZiAoIShjb21wb25lbnQgaW5zdGFuY2VvZiBDb21wb25lbnQpKSB7XG4gICAgICAgIExvZy5lcnJvcihcIkdhbWVPYmplY3QucmVtb3ZlQ29tcG9uZW50OiBjYW4ndCByZW1vdmUgcGFzc2VkIGFyZ3VtZW50LCBpdCBpcyBub3QgYW4gaW5zdGFuY2Ugb2YgQ29tcG9uZW50XCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdmFyIG5hbWUgPSBjb21wb25lbnQuX25hbWUsXG4gICAgICAgIGNvbXBvbmVudHMgPSB0aGlzLmNvbXBvbmVudHMsXG4gICAgICAgIGNvbXAsIGksIGo7XG5cbiAgICBpZiAodGhpc1tuYW1lXSkge1xuICAgICAgICBjb21wb25lbnQuZW1pdChcInJlbW92ZVwiLCB0aGlzKTtcbiAgICAgICAgdGhpcy5lbWl0KFwicmVtb3ZlXCIgKyBjb21wb25lbnQuX3R5cGUsIGNvbXBvbmVudCk7XG4gICAgICAgIHRoaXMuZW1pdChcInJlbW92ZUNvbXBvbmVudFwiLCBjb21wb25lbnQpO1xuXG4gICAgICAgIGlmICghb3RoZXJzKSB7XG4gICAgICAgICAgICBpID0gY29tcG9uZW50cy5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgY29tcCA9IGNvbXBvbmVudHNbaV07XG4gICAgICAgICAgICAgICAgaWYgKCFjb21wKSBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgIGogPSBjb21wb25lbnRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoai0tKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSBjb21wb25lbnRzW2pdLl9uYW1lKSBjb21wW25hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbXBvbmVudHMuc3BsaWNlKGNvbXBvbmVudHMuaW5kZXhPZihjb21wb25lbnQpLCAxKTtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50VHlwZVtjb21wb25lbnQuX3R5cGVdID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9jb21wb25lbnRIYXNoW2NvbXBvbmVudC5faWRdID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoY29tcG9uZW50Ll9qc29uSWQgIT09IC0xKSB0aGlzLl9jb21wb25lbnRKU09OSGFzaFtjb21wb25lbnQuX2pzb25JZF0gPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgY29tcG9uZW50LmdhbWVPYmplY3QgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXNbbmFtZV0gPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgaWYgKHRoaXMuc2NlbmUpIHRoaXMuc2NlbmUuX3JlbW92ZUNvbXBvbmVudChjb21wb25lbnQpO1xuICAgICAgICBpZiAoY2xlYXIpIGNvbXBvbmVudC5jbGVhcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIkdhbWVPYmplY3QucmVtb3ZlQ29tcG9uZW50OiBHYW1lT2JqZWN0IGRvZXMgbm90IGhhdmUgYShuKSBcIiArIHR5cGUgKyBcIiBDb21wb25lbnRcIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdhbWVPYmplY3QucHJvdG90eXBlLnJlbW92ZUNvbXBvbmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsXG4gICAgICAgIGNvbXBvbmVudHMgPSB0aGlzLmNvbXBvbmVudHMsXG4gICAgICAgIHRvUmVtb3ZlID0gYXJndW1lbnRzLFxuICAgICAgICBjb21wb25lbnQsIG5hbWUsXG4gICAgICAgIGksIGo7XG5cbiAgICBpID0gbGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHRoaXMucmVtb3ZlQ29tcG9uZW50KGFyZ3VtZW50c1tpXSwgbnVsbCwgdHJ1ZSk7XG5cbiAgICBpID0gY29tcG9uZW50cy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjb21wb25lbnQgPSBjb21wb25lbnRzW2ldO1xuICAgICAgICBpZiAoIWNvbXBvbmVudCkgY29udGludWU7XG5cbiAgICAgICAgbmFtZSA9IGNvbXBvbmVudC5fbmFtZTtcbiAgICAgICAgaiA9IHRvUmVtb3ZlLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGotLSkge1xuICAgICAgICAgICAgaWYgKG5hbWUgPT09IHRvUmVtb3ZlW2ldLl9uYW1lKSBjb21wb25lbnRbbmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR2FtZU9iamVjdC5wcm90b3R5cGUuZ2V0Q29tcG9uZW50ID0gZnVuY3Rpb24gKHR5cGUpIHtcblxuICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRUeXBlW3R5cGVdO1xufTtcblxuXG5HYW1lT2JqZWN0LnByb3RvdHlwZS5oYXNDb21wb25lbnQgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgIHZhciBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLFxuICAgICAgICBpID0gY29tcG9uZW50cy5sZW5ndGg7XG4gICAgO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZiAoY29tcG9uZW50c1tpXS5fdHlwZSA9PT0gdHlwZSkgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuXG5HYW1lT2JqZWN0LnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB2YXIgdHJhbnNmb3JtID0gdGhpcy50cmFuc2Zvcm0gfHwgdGhpcy50cmFuc2Zvcm0yZCxcbiAgICAgICAgY2hpbGRyZW4sIGNoaWxkLCBpO1xuXG4gICAgaWYgKCF0cmFuc2Zvcm0pIHJldHVybiB1bmRlZmluZWQ7XG5cbiAgICBjaGlsZHJlbiA9IHRyYW5zZm9ybS5jaGlsZHJlbjtcbiAgICBpID0gY2hpbGRyZW4ubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjaGlsZCA9IGNoaWxkcmVuW2ldO1xuXG4gICAgICAgIGlmIChjaGlsZC5nYW1lT2JqZWN0Lm5hbWUgPT09IG5hbWUpIHJldHVybiBjaGlsZC5nYW1lT2JqZWN0O1xuICAgICAgICBpZiAoKGNoaWxkID0gY2hpbGQuZmluZChuYW1lKSkpIHJldHVybiBjaGlsZDtcbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuXG5HYW1lT2JqZWN0LnByb3RvdHlwZS5maW5kQ29tcG9uZW50QnlJZCA9IGZ1bmN0aW9uIChpZCkge1xuXG4gICAgcmV0dXJuIHRoaXMuX2NvbXBvbmVudEhhc2hbaWRdO1xufTtcblxuXG5HYW1lT2JqZWN0LnByb3RvdHlwZS5maW5kQ29tcG9uZW50QnlKU09OSWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRKU09OSGFzaFtpZF07XG59O1xuXG5cbkdhbWVPYmplY3QucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiA9IENsYXNzLnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcbiAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cyxcbiAgICAgICAganNvbkNvbXBvbmVudHMgPSBqc29uLmNvbXBvbmVudHMgfHwgKGpzb24uY29tcG9uZW50cyA9IFtdKSxcbiAgICAgICAgdGFncyA9IHRoaXMudGFncyxcbiAgICAgICAganNvblRhZ3MgPSBqc29uLnRhZ3MgfHwgKGpzb24udGFncyA9IFtdKSxcbiAgICAgICAgY29tcG9uZW50LFxuICAgICAgICBpID0gY29tcG9uZW50cy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGlmICgoY29tcG9uZW50ID0gY29tcG9uZW50c1tpXSkuanNvbikganNvbkNvbXBvbmVudHNbaV0gPSBjb21wb25lbnQudG9KU09OKGpzb25Db21wb25lbnRzW2ldKTtcbiAgICB9XG4gICAgaSA9IHRhZ3MubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIGpzb25UYWdzW2ldID0gdGFnc1tpXTtcblxuICAgIGpzb24ubmFtZSA9IHRoaXMubmFtZTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5HYW1lT2JqZWN0LnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgQ2xhc3MucHJvdG90eXBlLmZyb21KU09OLmNhbGwodGhpcywganNvbik7XG4gICAgdmFyIGNvbXBvbmVudHMgPSB0aGlzLmNvbXBvbmVudHMsXG4gICAgICAgIGpzb25Db21wb25lbnRzID0ganNvbi5jb21wb25lbnRzIHx8IChqc29uLmNvbXBvbmVudHMgPSBbXSksXG4gICAgICAgIGNvbXBvbmVudCwganNvbkNvbXBvbmVudCwgdGFnLFxuICAgICAgICB0YWdzID0gdGhpcy50YWdzLFxuICAgICAgICBqc29uVGFncyA9IGpzb24udGFncyB8fCAoanNvbi50YWdzID0gW10pLFxuICAgICAgICBpID0gY29tcG9uZW50cy5sZW5ndGgsXG4gICAgICAgIGhhcywgdHlwZSwgajtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY29tcG9uZW50ID0gY29tcG9uZW50c1tpXTtcbiAgICAgICAgdHlwZSA9IGNvbXBvbmVudC5fdHlwZTtcbiAgICAgICAgaGFzID0gZmFsc2U7XG5cbiAgICAgICAgaiA9IGpzb25Db21wb25lbnRzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGotLSkge1xuICAgICAgICAgICAganNvbkNvbXBvbmVudCA9IGpzb25Db21wb25lbnRzW2ldO1xuICAgICAgICAgICAgaWYgKHR5cGUgPT09IGpzb25Db21wb25lbnQuX3R5cGUpIGhhcyA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWhhcykgdGhpcy5yZW1vdmVDb21wb25lbnQoY29tcG9uZW50KTtcbiAgICB9XG5cbiAgICBpID0ganNvbkNvbXBvbmVudHMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgaWYgKCEoanNvbkNvbXBvbmVudCA9IGpzb25Db21wb25lbnRzW2ldKSkgY29udGludWU7XG5cbiAgICAgICAgaWYgKChjb21wb25lbnQgPSB0aGlzLmZpbmRDb21wb25lbnRCeUpTT05JZChqc29uQ29tcG9uZW50Ll9pZCkpIHx8IChjb21wb25lbnQgPSB0aGlzLmdldENvbXBvbmVudChqc29uQ29tcG9uZW50Ll90eXBlKSkpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5mcm9tSlNPTihqc29uQ29tcG9uZW50KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KENsYXNzLmZyb21KU09OKGpzb25Db21wb25lbnQpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGkgPSBqc29uVGFncy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZiAodGFncy5pbmRleE9mKCh0YWcgPSBqc29uVGFnc1tpXSkpID09PSAtMSkgdGFncy5wdXNoKHRhZyk7XG4gICAgfVxuXG4gICAgdGhpcy5uYW1lID0ganNvbi5uYW1lO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZU9iamVjdDtcbiIsInZhciBDbGFzcyA9IHJlcXVpcmUoXCIuLi8uLi8uLi9iYXNlL2NsYXNzXCIpO1xudmFyIEdVSUNvbXBvbmVudCA9IHJlcXVpcmUoXCIuLi9jb21wb25lbnRzL2d1aV9jb21wb25lbnRcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBHVUlDb21wb25lbnRNYW5hZ2VyKG9yZGVyKSB7XG5cbiAgICBDbGFzcy5jYWxsKHRoaXMpO1xuXG4gICAgdGhpcy5vcmRlciA9IG9yZGVyIHx8IDA7XG5cbiAgICB0aGlzLmd1aSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmNvbXBvbmVudHMgPSBbXTtcbn1cblxuQ2xhc3MuZXh0ZW5kKEdVSUNvbXBvbmVudE1hbmFnZXIpO1xuXG5cbkdVSUNvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoZm4sIGN0eCkge1xuICAgIHZhciBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLFxuICAgICAgICBpID0gMCxcbiAgICAgICAgaWwgPSBjb21wb25lbnRzLmxlbmd0aDtcblxuICAgIGlmIChjdHgpIHtcbiAgICAgICAgZm9yICg7IGkgPCBpbDsgaSsrKSBmbi5jYWxsKGN0eCwgY29tcG9uZW50c1tpXSwgaSwgY29tcG9uZW50cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9yICg7IGkgPCBpbDsgaSsrKSBmbihjb21wb25lbnRzW2ldLCBpLCBjb21wb25lbnRzKTtcbiAgICB9XG59O1xuXG5cbkdVSUNvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLFxuICAgICAgICBpID0gMCxcbiAgICAgICAgaWwgPSBjb21wb25lbnRzLmxlbmd0aDtcblxuICAgIGZvciAoOyBpIDwgaWw7IGkrKykgY29tcG9uZW50c1tpXS5zdGFydCgpO1xufTtcblxuXG5HVUlDb21wb25lbnRNYW5hZ2VyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLFxuICAgICAgICBpID0gMCxcbiAgICAgICAgaWwgPSBjb21wb25lbnRzLmxlbmd0aDtcblxuICAgIGZvciAoOyBpIDwgaWw7IGkrKykgY29tcG9uZW50c1tpXS5pbml0KCk7XG59O1xuXG5cbkdVSUNvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cyxcbiAgICAgICAgaSA9IDAsXG4gICAgICAgIGlsID0gY29tcG9uZW50cy5sZW5ndGg7XG5cbiAgICBmb3IgKDsgaSA8IGlsOyBpKyspIGNvbXBvbmVudHNbaV0udXBkYXRlKCk7XG59O1xuXG5cbkdVSUNvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLnNvcnQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLmNvbXBvbmVudHMuc29ydCh0aGlzLnNvcnRGdW5jdGlvbik7XG59O1xuXG5cbkdVSUNvbXBvbmVudE1hbmFnZXIucHJvdG90eXBlLnNvcnRGdW5jdGlvbiA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cbiAgICByZXR1cm4gYS5faWQgLSBiLl9pZDtcbn07XG5cblxuR1VJQ29tcG9uZW50TWFuYWdlci5wcm90b3R5cGUuZW1wdHkgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gdGhpcy5jb21wb25lbnRzLmxlbmd0aCA9PT0gMDtcbn07XG5cblxuR1VJQ29tcG9uZW50TWFuYWdlci5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGNvbXBvbmVudCkge1xuICAgIGlmICghKGNvbXBvbmVudCBpbnN0YW5jZW9mIEdVSUNvbXBvbmVudCkpIHtcbiAgICAgICAgTG9nLmVycm9yKHRoaXMuX2NsYXNzTmFtZSArIFwiLmFkZDogY2FuJ3QgYWRkIGFyZ3VtZW50IHRvIFwiICsgdGhpcy5fY2xhc3NOYW1lICsgXCIsIGl0J3Mgbm90IGFuIGluc3RhbmNlIG9mIEdVSUNvbXBvbmVudFwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cyxcbiAgICAgICAgaW5kZXggPSBjb21wb25lbnRzLmluZGV4T2YoY29tcG9uZW50KTtcblxuICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgTG9nLmVycm9yKHRoaXMuX2NsYXNzTmFtZSArIFwiLmFkZDogR1VJQ29tcG9uZW50IGlzIGFscmVhZHkgYSBtZW1iZXIgb2YgXCIgKyB0aGlzLl9jbGFzc05hbWUpO1xuICAgIH1cbn07XG5cblxuR1VJQ29tcG9uZW50TWFuYWdlci5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGNvbXBvbmVudCkge1xuICAgIGlmICghKGNvbXBvbmVudCBpbnN0YW5jZW9mIEdVSUNvbXBvbmVudCkpIHtcbiAgICAgICAgTG9nLmVycm9yKHRoaXMuX2NsYXNzTmFtZSArIFwiLnJlbW92ZTogY2FuJ3QgcmVtb3ZlIGFyZ3VtZW50IGZyb20gXCIgKyB0aGlzLl9jbGFzc05hbWUgKyBcIiwgaXQncyBub3QgYW4gaW5zdGFuY2Ugb2YgR1VJQ29tcG9uZW50XCIpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLFxuICAgICAgICBpbmRleCA9IGNvbXBvbmVudHMuaW5kZXhPZihjb21wb25lbnQpO1xuXG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICBjb21wb25lbnRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgTG9nLmVycm9yKHRoaXMuX2NsYXNzTmFtZSArIFwiLnJlbW92ZTogR1VJQ29tcG9uZW50IGlzIG5vdCBhIG1lbWJlciBvZiBcIiArIHRoaXMuX2NsYXNzTmFtZSk7XG4gICAgfVxufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEdVSUNvbXBvbmVudE1hbmFnZXI7XG4iLCJ2YXIgQ2xhc3MgPSByZXF1aXJlKFwiLi4vLi4vLi4vYmFzZS9jbGFzc1wiKTtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4uLy4uLy4uL2Jhc2UvdXRpbFwiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi4vLi4vLi4vYmFzZS9sb2dcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgY2FtZWxpemUgPSB1dGlsLmNhbWVsaXplO1xuXG5cbmZ1bmN0aW9uIEdVSUNvbXBvbmVudCh0eXBlLCBvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcbiAgICBpZiAoIXR5cGUpIExvZy5lcnJvcihcIkdVSUNvbXBvbmVudCBkZWZpbmVkIHdpdGhvdXQgYSB0eXBlLCB1c2UgR1VJQ29tcG9uZW50LmNhbGwodGhpcywgXFxcIkdVSUNvbXBvbmVudE5hbWVcXFwiLCB7IHN5bmM6IEJvb2xlYW4sIGpzb246IEJvb2xlYW4gfSlcIik7XG5cblxuICAgIENsYXNzLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLl90eXBlID0gdHlwZSB8fCBcIlVua25vd25HVUlDb21wb25lbnRcIjtcbiAgICB0aGlzLl9uYW1lID0gY2FtZWxpemUodGhpcy5fdHlwZSwgdHJ1ZSk7XG5cbiAgICB0aGlzLnN5bmMgPSBvcHRzLnN5bmMgIT0gdW5kZWZpbmVkID8gISFvcHRzLnN5bmMgOiBmYWxzZTtcbiAgICB0aGlzLmpzb24gPSBvcHRzLmpzb24gIT0gdW5kZWZpbmVkID8gISFvcHRzLmpzb24gOiB0cnVlO1xuXG4gICAgdGhpcy5ndWlPYmplY3QgPSB1bmRlZmluZWQ7XG59XG5cbkNsYXNzLmV4dGVuZChHVUlDb21wb25lbnQpO1xuXG5cbkdVSUNvbXBvbmVudC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcblxufTtcblxuXG5HVUlDb21wb25lbnQucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuXG59O1xuXG5cbkdVSUNvbXBvbmVudC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuXG59O1xuXG5cbkdVSUNvbXBvbmVudC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLm9mZigpO1xufTtcblxuXG5HVUlDb21wb25lbnQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmd1aU9iamVjdCkge1xuICAgICAgICBMb2cuZXJyb3IoXCJHVUlDb21wb25lbnQuZGVzdHJveTogY2FuJ3QgZGVzdHJveSBHVUlDb21wb25lbnQgaWYgaXQncyBub3QgYWRkZWQgdG8gYSBHYW1lT2JqZWN0XCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICB0aGlzLmd1aU9iamVjdC5yZW1vdmVHVUlDb21wb25lbnQodGhpcywgdHJ1ZSk7XG4gICAgdGhpcy5lbWl0KFwiZGVzdHJveVwiKTtcblxuICAgIHRoaXMuY2xlYXIoKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUlDb21wb25lbnQucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuZ3VpT2JqZWN0KSB7XG4gICAgICAgIExvZy5lcnJvcihcIkdVSUNvbXBvbmVudC5kZXN0cm95OiBjYW4ndCBkZXN0cm95IEdVSUNvbXBvbmVudCBpZiBpdCdzIG5vdCBhZGRlZCB0byBhIEdhbWVPYmplY3RcIik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHRoaXMuZ3VpT2JqZWN0LnJlbW92ZUdVSUNvbXBvbmVudCh0aGlzLCB0cnVlKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR1VJQ29tcG9uZW50LnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDbGFzcy5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICBqc29uLl90eXBlID0gdGhpcy5fdHlwZTtcbiAgICBqc29uLnN5bmMgPSB0aGlzLnN5bmM7XG4gICAganNvbi5qc29uID0gdGhpcy5qc29uO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbkdVSUNvbXBvbmVudC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENsYXNzLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy5zeW5jID0ganNvbi5zeW5jO1xuICAgIHRoaXMuanNvbiA9IGpzb24uanNvbjtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEdVSUNvbXBvbmVudDtcbiIsInZhciBNYXRoZiA9IHJlcXVpcmUoXCIuLi8uLi8uLi9tYXRoL21hdGhmXCIpO1xudmFyIFJlY3QgPSByZXF1aXJlKFwiLi4vLi4vLi4vbWF0aC9yZWN0XCIpO1xudmFyIFZlYzIgPSByZXF1aXJlKFwiLi4vLi4vLi4vbWF0aC92ZWMyXCIpO1xudmFyIE1hdDMyID0gcmVxdWlyZShcIi4uLy4uLy4uL21hdGgvbWF0MzJcIik7XG52YXIgTWF0MyA9IHJlcXVpcmUoXCIuLi8uLi8uLi9tYXRoL21hdDNcIik7XG52YXIgTWF0NCA9IHJlcXVpcmUoXCIuLi8uLi8uLi9tYXRoL21hdDRcIik7XG52YXIgR1VJQ29tcG9uZW50ID0gcmVxdWlyZShcIi4vZ3VpX2NvbXBvbmVudFwiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi4vLi4vLi4vYmFzZS9sb2dcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgRVBTSUxPTiA9IE1hdGhmLkVQU0lMT047XG5cblxuZnVuY3Rpb24gR1VJVHJhbnNmb3JtKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuICAgIG9wdHMuc3luYyA9IG9wdHMuc3luYyAhPSB1bmRlZmluZWQgPyBvcHRzLnN5bmMgOiB0cnVlO1xuXG4gICAgR1VJQ29tcG9uZW50LmNhbGwodGhpcywgXCJHVUlUcmFuc2Zvcm1cIiwgb3B0cyk7XG5cbiAgICB0aGlzLnJvb3QgPSB0aGlzO1xuICAgIHRoaXMuZGVwdGggPSAwO1xuXG4gICAgdGhpcy5wYXJlbnQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xuXG4gICAgdGhpcy5wb3NpdGlvbiA9IG9wdHMucG9zaXRpb24gIT0gdW5kZWZpbmVkID8gb3B0cy5wb3NpdGlvbiA6IG5ldyBSZWN0O1xuICAgIHRoaXMucm90YXRpb24gPSBvcHRzLnJvdGF0aW9uICE9IHVuZGVmaW5lZCA/IG9wdHMucm90YXRpb24gOiAwO1xuICAgIHRoaXMuc2NhbGUgPSBvcHRzLnNjYWxlICE9IHVuZGVmaW5lZCA/IG9wdHMuc2NhbGUgOiBuZXcgVmVjMigxLCAxKTtcblxuICAgIHRoaXMubWF0cml4ID0gbmV3IE1hdDMyO1xuICAgIHRoaXMubWF0cml4V29ybGQgPSBuZXcgTWF0MzI7XG5cbiAgICB0aGlzLm1vZGVsVmlldyA9IG5ldyBNYXQ0O1xuICAgIHRoaXMuX21hdHJpY2VzTmVlZHNVcGRhdGUgPSBmYWxzZTtcbn1cblxuR1VJQ29tcG9uZW50LmV4dGVuZChHVUlUcmFuc2Zvcm0pO1xuXG5cbkdVSVRyYW5zZm9ybS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciBjaGlsZHJlbiA9IG90aGVyLmNoaWxkcmVuLFxuICAgICAgICBpID0gY2hpbGRyZW4ubGVuZ3RoO1xuXG4gICAgdGhpcy5wb3NpdGlvbi5jb3B5KG90aGVyLnBvc2l0aW9uKTtcbiAgICB0aGlzLnNjYWxlLmNvcHkob3RoZXIuc2NhbGUpO1xuICAgIHRoaXMucm90YXRpb24gPSBvdGhlci5yb3RhdGlvbjtcblxuICAgIHdoaWxlIChpLS0pIHRoaXMuYWRkQ2hpbGQoY2hpbGRyZW5baV0uZ3VpT2JqZWN0LmNsb25lKCkuZ3VpVHJhbnNmb3JtKTtcbiAgICBpZiAob3RoZXIucGFyZW50KSBvdGhlci5wYXJlbnQuYWRkQ2hpbGQodGhpcyk7XG5cbiAgICB0aGlzLl9tYXRyaWNlc05lZWRzVXBkYXRlID0gdHJ1ZTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUlUcmFuc2Zvcm0ucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgIEdVSUNvbXBvbmVudC5wcm90b3R5cGUuY2xlYXIuY2FsbCh0aGlzKTtcbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLFxuICAgICAgICBpID0gY2hpbGRyZW4ubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkgdGhpcy5yZW1vdmVDaGlsZChjaGlsZHJlbltpXSk7XG5cbiAgICB0aGlzLnBvc2l0aW9uLnNldCgwLCAwLCAwLCAwKTtcbiAgICB0aGlzLnNjYWxlLnNldCgxLCAxKTtcbiAgICB0aGlzLnJvdGF0aW9uID0gMDtcblxuICAgIHRoaXMucm9vdCA9IHRoaXM7XG4gICAgdGhpcy5kZXB0aCA9IDA7XG5cbiAgICB0aGlzLl9tYXRyaWNlc05lZWRzVXBkYXRlID0gdHJ1ZTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUlUcmFuc2Zvcm0ucHJvdG90eXBlLnRyYW5zbGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmVjID0gbmV3IFZlYzI7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHRyYW5zbGF0aW9uLCByZWxhdGl2ZVRvKSB7XG4gICAgICAgIHZhciBwb3NpdGlvbiA9IHRoaXMucG9zaXRpb247XG5cbiAgICAgICAgdmVjLmNvcHkodHJhbnNsYXRpb24pO1xuXG4gICAgICAgIGlmIChyZWxhdGl2ZVRvIGluc3RhbmNlb2YgR1VJVHJhbnNmb3JtKSB7XG4gICAgICAgICAgICB2ZWMudHJhbnNmb3JtQW5nbGUocmVsYXRpdmVUby5yb3RhdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAocmVsYXRpdmVUbykge1xuICAgICAgICAgICAgdmVjLnRyYW5zZm9ybUFuZ2xlKHJlbGF0aXZlVG8pO1xuICAgICAgICB9XG5cbiAgICAgICAgcG9zaXRpb24ueCArPSB2ZWMueDtcbiAgICAgICAgcG9zaXRpb24ueSArPSB2ZWMueTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xufSgpO1xuXG5cbkdVSVRyYW5zZm9ybS5wcm90b3R5cGUucm90YXRlID0gZnVuY3Rpb24gKHJvdGF0aW9uLCByZWxhdGl2ZVRvKSB7XG5cbiAgICBpZiAocmVsYXRpdmVUbyBpbnN0YW5jZW9mIEdVSVRyYW5zZm9ybSkge1xuICAgICAgICByb3RhdGlvbiArPSByZWxhdGl2ZVRvLnJvdGF0aW9uO1xuICAgIH0gZWxzZSBpZiAocmVsYXRpdmVUbykge1xuICAgICAgICByb3RhdGlvbiArPSByZWxhdGl2ZVRvO1xuICAgIH1cblxuICAgIHRoaXMucm90YXRpb24gKz0gcm90YXRpb247XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR1VJVHJhbnNmb3JtLnByb3RvdHlwZS5sb29rQXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG1hdCA9IG5ldyBNYXQzMixcbiAgICAgICAgdmVjID0gbmV3IFZlYzIsXG4gICAgICAgIHZlY18yID0gbmV3IFZlYzI7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCkge1xuXG4gICAgICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBHVUlUcmFuc2Zvcm0pIHtcbiAgICAgICAgICAgIHZlYy5jb3B5KHRhcmdldC5wb3NpdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2ZWMuY29weSh0YXJnZXQpO1xuICAgICAgICB9XG5cbiAgICAgICAgbWF0Lmxvb2tBdCh0aGlzLnBvc2l0aW9uLmNlbnRlcih2ZWNfMiksIHZlYyk7XG4gICAgICAgIHRoaXMucm90YXRpb24gPSBtYXQuZ2V0Um90YXRpb24oKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xufSgpO1xuXG5cbkdVSVRyYW5zZm9ybS5wcm90b3R5cGUuZm9sbG93ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0YXJnZXQgPSBuZXcgVmVjMixcbiAgICAgICAgcG9zID0gbmV3IFZlYzIsXG4gICAgICAgIGRlbHRhID0gbmV3IFZlYzI7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHRyYW5zZm9ybSwgc3BlZWQpIHtcbiAgICAgICAgdmFyIHBvc2l0aW9uID0gdGhpcy5wb3NpdGlvbjtcblxuICAgICAgICBwb3Muc2V0KDAsIDApLnRyYW5zZm9ybU1hdDMyKHRoaXMubWF0cml4V29ybGQpO1xuICAgICAgICB0YXJnZXQuc2V0KDAsIDApLnRyYW5zZm9ybU1hdDMyKHRyYW5zZm9ybS5tYXRyaXhXb3JsZCk7XG5cbiAgICAgICAgZGVsdGEudnN1Yih0YXJnZXQsIHBvcyk7XG5cbiAgICAgICAgaWYgKGRlbHRhLmxlbmd0aFNxKCkgPiBFUFNJTE9OKSB7XG4gICAgICAgICAgICBwb3NpdGlvbi54ICs9IGRlbHRhLnggKiBzcGVlZDtcbiAgICAgICAgICAgIHBvc2l0aW9uLnkgKz0gZGVsdGEueSAqIHNwZWVkO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbn0oKTtcblxuXG5HVUlUcmFuc2Zvcm0ucHJvdG90eXBlLmFkZENoaWxkID0gZnVuY3Rpb24gKGNoaWxkLCBvdGhlcnMpIHtcbiAgICBpZiAoIShjaGlsZCBpbnN0YW5jZW9mIEdVSVRyYW5zZm9ybSkpIHtcbiAgICAgICAgTG9nLmVycm9yKFwiR1VJVHJhbnNmb3JtLmFkZDogY2FuXFwndCBhZGQgcGFzc2VkIGFyZ3VtZW50LCBpdCBpcyBub3QgYW4gaW5zdGFuY2Ugb2YgR1VJVHJhbnNmb3JtXCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbixcbiAgICAgICAgaW5kZXggPSBjaGlsZHJlbi5pbmRleE9mKGNoaWxkKSxcbiAgICAgICAgcm9vdCwgZGVwdGgsIGd1aTtcblxuICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgaWYgKGNoaWxkLnBhcmVudCkgY2hpbGQucGFyZW50LnJlbW92ZShjaGlsZCk7XG5cbiAgICAgICAgY2hpbGQucGFyZW50ID0gdGhpcztcbiAgICAgICAgY2hpbGRyZW4ucHVzaChjaGlsZCk7XG5cbiAgICAgICAgcm9vdCA9IHRoaXM7XG4gICAgICAgIGRlcHRoID0gMDtcblxuICAgICAgICB3aGlsZSAocm9vdC5wYXJlbnQpIHtcbiAgICAgICAgICAgIHJvb3QgPSByb290LnBhcmVudDtcbiAgICAgICAgICAgIGRlcHRoKys7XG4gICAgICAgIH1cbiAgICAgICAgY2hpbGQucm9vdCA9IHJvb3Q7XG4gICAgICAgIHRoaXMucm9vdCA9IHJvb3Q7XG5cbiAgICAgICAgdXBkYXRlRGVwdGgodGhpcywgZGVwdGgpO1xuICAgICAgICBpZiAoIW90aGVycykge1xuICAgICAgICAgICAgaWYgKHRoaXMuZ3VpT2JqZWN0ICYmIChndWkgPSB0aGlzLmd1aU9iamVjdC5ndWkpKSB7XG4gICAgICAgICAgICAgICAgZ3VpLmNvbXBvbmVudE1hbmFnZXJzLkdVSVRyYW5zZm9ybS5zb3J0KHRoaXMuc29ydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBMb2cuZXJyb3IoXCJHVUlUcmFuc2Zvcm0uYWRkOiBjaGlsZCBpcyBub3QgYSBtZW1iZXIgb2YgdGhpcyBHVUlUcmFuc2Zvcm1cIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdVSVRyYW5zZm9ybS5wcm90b3R5cGUuYWRkQ2hpbGRyZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGksIGlsLCBndWk7XG5cbiAgICBmb3IgKGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB0aGlzLmFkZENoaWxkKGFyZ3VtZW50c1tpXSwgdHJ1ZSk7XG4gICAgaWYgKHRoaXMuZ3VpT2JqZWN0ICYmIChndWkgPSB0aGlzLmd1aU9iamVjdC5ndWkpKSB7XG4gICAgICAgIGd1aS5jb21wb25lbnRNYW5hZ2Vycy5HVUlUcmFuc2Zvcm0uc29ydCh0aGlzLnNvcnQpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR1VJVHJhbnNmb3JtLnByb3RvdHlwZS5yZW1vdmVDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZCwgb3RoZXJzKSB7XG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbixcbiAgICAgICAgaW5kZXggPSBjaGlsZHJlbi5pbmRleE9mKGNoaWxkKSxcbiAgICAgICAgcm9vdCwgZGVwdGgsIGd1aTtcblxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgY2hpbGQucGFyZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICBjaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgICAgIHJvb3QgPSB0aGlzO1xuICAgICAgICBkZXB0aCA9IDA7XG5cbiAgICAgICAgd2hpbGUgKHJvb3QucGFyZW50KSB7XG4gICAgICAgICAgICByb290ID0gcm9vdC5wYXJlbnQ7XG4gICAgICAgICAgICBkZXB0aCsrO1xuICAgICAgICB9XG4gICAgICAgIGNoaWxkLnJvb3QgPSBjaGlsZDtcbiAgICAgICAgdGhpcy5yb290ID0gcm9vdDtcblxuICAgICAgICB1cGRhdGVEZXB0aCh0aGlzLCBkZXB0aCk7XG4gICAgICAgIGlmICghb3RoZXJzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5ndWlPYmplY3QgJiYgKGd1aSA9IHRoaXMuZ3VpT2JqZWN0Lmd1aSkpIHtcbiAgICAgICAgICAgICAgICBndWkuY29tcG9uZW50TWFuYWdlcnMuR1VJVHJhbnNmb3JtLnNvcnQodGhpcy5zb3J0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIkdVSVRyYW5zZm9ybS5yZW1vdmU6IGNoaWxkIGlzIG5vdCBhIG1lbWJlciBvZiB0aGlzIEdVSVRyYW5zZm9ybVwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR1VJVHJhbnNmb3JtLnByb3RvdHlwZS5yZW1vdmVDaGlsZHJlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSwgaWwsIGd1aTtcblxuICAgIGZvciAoaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHRoaXMucmVtb3ZlQ2hpbGQoYXJndW1lbnRzW2ldLCB0cnVlKTtcbiAgICBpZiAodGhpcy5ndWlPYmplY3QgJiYgKGd1aSA9IHRoaXMuZ3VpT2JqZWN0Lmd1aSkpIHtcbiAgICAgICAgZ3VpLmNvbXBvbmVudE1hbmFnZXJzLkdVSVRyYW5zZm9ybS5zb3J0KHRoaXMuc29ydCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUlUcmFuc2Zvcm0ucHJvdG90eXBlLmRldGFjaENoaWxkcmVuID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpID0gYXJndW1lbnRzLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHRoaXMucmVtb3ZlQ2hpbGQoY2hpbGRyZW5baV0pO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUlUcmFuc2Zvcm0ucHJvdG90eXBlLmhhc0NoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG5cbiAgICByZXR1cm4gISF+dGhpcy5jaGlsZHJlbi5pbmRleE9mKGNoaWxkKTtcbn07XG5cblxuR1VJVHJhbnNmb3JtLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLFxuICAgICAgICBjaGlsZCxcbiAgICAgICAgaSA9IGNoaWxkcmVuLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY2hpbGQgPSBjaGlsZHJlbltpXTtcblxuICAgICAgICBpZiAoY2hpbGQuZ3VpT2JqZWN0Lm5hbWUgPT09IG5hbWUpIHJldHVybiBjaGlsZDtcbiAgICAgICAgaWYgKChjaGlsZCA9IGNoaWxkLmZpbmQobmFtZSkpKSByZXR1cm4gY2hpbGQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cblxuR1VJVHJhbnNmb3JtLnByb3RvdHlwZS50b1dvcmxkID0gZnVuY3Rpb24gKHYpIHtcblxuICAgIHJldHVybiB2LnRyYW5zZm9ybU1hdDMyKHRoaXMubWF0cml4V29ybGQpO1xufTtcblxuXG5HVUlUcmFuc2Zvcm0ucHJvdG90eXBlLnRvTG9jYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG1hdCA9IG5ldyBNYXQzMjtcblxuICAgIHJldHVybiBmdW5jdGlvbiAodikge1xuXG4gICAgICAgIHJldHVybiB2LnRyYW5zZm9ybU1hdDMyKG1hdC5pbnZlcnNlTWF0KHRoaXMubWF0cml4V29ybGQpKTtcbiAgICB9O1xufSgpO1xuXG5cbkdVSVRyYW5zZm9ybS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtYXRyaXggPSB0aGlzLm1hdHJpeCxcbiAgICAgICAgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG5cbiAgICBtYXRyaXguY29tcG9zZSh0aGlzLnBvc2l0aW9uLCB0aGlzLnNjYWxlLCB0aGlzLnJvdGF0aW9uKTtcblxuICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgdGhpcy5tYXRyaXhXb3JsZC5tbXVsKHBhcmVudC5tYXRyaXhXb3JsZCwgbWF0cml4KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm1hdHJpeFdvcmxkLmNvcHkobWF0cml4KTtcbiAgICB9XG5cbiAgICB0aGlzLl9tYXRyaWNlc05lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxuR1VJVHJhbnNmb3JtLnByb3RvdHlwZS51cGRhdGVNYXRyaWNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbWF0ID0gbmV3IE1hdDQ7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHZpZXdNYXRyaXgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9tYXRyaWNlc05lZWRzVXBkYXRlKSByZXR1cm47XG5cbiAgICAgICAgdGhpcy5tb2RlbFZpZXcubW11bCh2aWV3TWF0cml4LCBtYXQuZnJvbU1hdDMyKHRoaXMubWF0cml4V29ybGQpKTtcbiAgICAgICAgdGhpcy5fbWF0cmljZXNOZWVkc1VwZGF0ZSA9IGZhbHNlO1xuICAgIH07XG59KCk7XG5cblxuR1VJVHJhbnNmb3JtLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBHVUlDb21wb25lbnQucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW4sXG4gICAgICAgIGpzb25DaGlsZHJlbiA9IGpzb24uY2hpbGRyZW4gfHwgKGpzb24uY2hpbGRyZW4gPSBbXSksXG4gICAgICAgIGkgPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSBqc29uQ2hpbGRyZW5baV0gPSBjaGlsZHJlbltpXS5faWQ7XG5cbiAgICBqc29uLnBvc2l0aW9uID0gdGhpcy5wb3NpdGlvbi50b0pTT04oanNvbi5wb3NpdGlvbik7XG4gICAganNvbi5zY2FsZSA9IHRoaXMuc2NhbGUudG9KU09OKGpzb24uc2NhbGUpO1xuICAgIGpzb24ucm90YXRpb24gPSB0aGlzLnJvdGF0aW9uXG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuR1VJVHJhbnNmb3JtLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgR1VJQ29tcG9uZW50LnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuICAgIHZhciBjaGlsZHJlbiA9IGpzb24uY2hpbGRyZW4sXG4gICAgICAgIGkgPSBjaGlsZHJlbi5sZW5ndGgsXG4gICAgICAgIGNoaWxkLCBndWk7XG5cbiAgICBpZiAodGhpcy5ndWlPYmplY3QgJiYgKGd1aSA9IHRoaXMuZ3VpT2JqZWN0Lmd1aSkpIHtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgY2hpbGQgPSBndWkuZmluZEdVSUNvbXBvbmVudEJ5SlNPTklkKGNoaWxkcmVuW2ldKTtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLmhhc0NoaWxkKGNoaWxkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5vbmNlKFwic3RhcnRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGd1aSA9IHRoaXMuZ3VpT2JqZWN0Lmd1aTtcblxuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIGNoaWxkID0gZ3VpLmZpbmRHVUlDb21wb25lbnRCeUpTT05JZChjaGlsZHJlbltpXSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaGFzQ2hpbGQoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5wb3NpdGlvbi5mcm9tSlNPTihqc29uLnBvc2l0aW9uKTtcbiAgICB0aGlzLnNjYWxlLmZyb21KU09OKGpzb24uc2NhbGUpO1xuICAgIHRoaXMucm90YXRpb24gPSBqc29uLnJvdGF0aW9uO1xuXG4gICAgdGhpcy5fbWF0cmljZXNOZWVkc1VwZGF0ZSA9IHRydWU7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuZnVuY3Rpb24gdXBkYXRlRGVwdGgodHJhbnNmb3JtLCBkZXB0aCkge1xuICAgIHZhciBjaGlsZHJlbiA9IHRyYW5zZm9ybS5jaGlsZHJlbixcbiAgICAgICAgaSA9IGNoaWxkcmVuLmxlbmd0aDtcblxuICAgIHRyYW5zZm9ybS5kZXB0aCA9IGRlcHRoO1xuICAgIHdoaWxlIChpLS0pIHVwZGF0ZURlcHRoKGNoaWxkcmVuW2ldLCBkZXB0aCArIDEpO1xufVxuXG5cbm1vZHVsZS5leHBvcnRzID0gR1VJVHJhbnNmb3JtO1xuIiwidmFyIENsYXNzID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvY2xhc3NcIik7XG52YXIgR1VJT2JqZWN0ID0gcmVxdWlyZShcIi4vZ3VpX29iamVjdFwiKTtcbnZhciBHVUlDb21wb25lbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vY29tcG9uZW50X21hbmFnZXJzL2d1aV9jb21wb25lbnRfbWFuYWdlclwiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9sb2dcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG4vKipcbiAqIEdVSXMgbWFuYWdlIEdVSU9iamVjdHMgYW5kIHRoZWlyIEdVSUNvbXBvbmVudHNcbiAqIEBjbGFzcyBPZGluLkdVSVxuICogQGV4dGVuZHMgT2Rpbi5DbGFzc1xuICogQHBhcmFtIE9iamVjdCBvcHRpb25zXG4gKi9cbmZ1bmN0aW9uIEdVSShvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIENsYXNzLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLmdhbWUgPSB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLm5hbWUgPSBvcHRzLm5hbWUgIT0gdW5kZWZpbmVkID8gb3B0cy5uYW1lIDogXCJHVUlfXCIgKyB0aGlzLl9pZDtcblxuICAgIHRoaXMud2lkdGggPSA5NjA7XG4gICAgdGhpcy5oZWlnaHQgPSA2NDA7XG4gICAgdGhpcy5hc3BlY3QgPSB0aGlzLndpZHRoIC8gdGhpcy5oZWlnaHQ7XG4gICAgdGhpcy5pbnZXaWR0aCA9IDEgLyB0aGlzLndpZHRoO1xuICAgIHRoaXMuaW52SGVpZ2h0ID0gMSAvIHRoaXMuaGVpZ2h0O1xuXG4gICAgdGhpcy5ndWlPYmplY3RzID0gW107XG4gICAgdGhpcy5fZ3VpT2JqZWN0SGFzaCA9IHt9O1xuICAgIHRoaXMuX2d1aU9iamVjdEpTT05IYXNoID0ge307XG5cbiAgICB0aGlzLmNvbXBvbmVudE1hbmFnZXJzID0ge307XG4gICAgdGhpcy5fY29tcG9uZW50TWFuYWdlclR5cGVzID0gW107XG4gICAgdGhpcy5fY29tcG9uZW50SGFzaCA9IHt9O1xuICAgIHRoaXMuX2NvbXBvbmVudEpTT05IYXNoID0ge307XG5cbiAgICBpZiAob3B0cy5ndWlPYmplY3RzKSB0aGlzLmFkZEdVSU9iamVjdHMuYXBwbHkodGhpcywgb3B0cy5ndWlPYmplY3RzKTtcbn1cblxuQ2xhc3MuZXh0ZW5kKEdVSSk7XG5cblxuR1VJLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIG90aGVyR1VJT2JqZWN0cyA9IG90aGVyLmd1aU9iamVjdHMsXG4gICAgICAgIGkgPSBvdGhlckdVSU9iamVjdHMubGVuZ3RoO1xuXG4gICAgdGhpcy5jbGVhcigpO1xuICAgIHRoaXMubmFtZSA9IG90aGVyLm5hbWUgKyBcIi5cIiArIHRoaXMuX2lkO1xuXG4gICAgd2hpbGUgKGktLSkgdGhpcy5hZGRHVUlPYmplY3Qob3RoZXJHVUlPYmplY3RzW2ldLmNsb25lKCkpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdVSS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZ3VpT2JqZWN0cyA9IHRoaXMuZ3VpT2JqZWN0cyxcbiAgICAgICAgaSwgaWw7XG5cbiAgICBmb3IgKGkgPSAwLCBpbCA9IGd1aU9iamVjdHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgZ3VpT2JqZWN0c1tpXS5lbWl0KFwiaW5pdFwiKTtcbn07XG5cblxuR1VJLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY29tcG9uZW50TWFuYWdlclR5cGVzID0gdGhpcy5fY29tcG9uZW50TWFuYWdlclR5cGVzLFxuICAgICAgICBndWlPYmplY3RzID0gdGhpcy5ndWlPYmplY3RzLFxuICAgICAgICBpLCBpbDtcblxuICAgIGZvciAoaSA9IDAsIGlsID0gY29tcG9uZW50TWFuYWdlclR5cGVzLmxlbmd0aDsgaSA8IGlsOyBpKyspIGNvbXBvbmVudE1hbmFnZXJUeXBlc1tpXS5zdGFydCgpO1xuICAgIGZvciAoaSA9IDAsIGlsID0gZ3VpT2JqZWN0cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBndWlPYmplY3RzW2ldLmVtaXQoXCJzdGFydFwiKTtcbn07XG5cblxuR1VJLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNvbXBvbmVudE1hbmFnZXJUeXBlcyA9IHRoaXMuX2NvbXBvbmVudE1hbmFnZXJUeXBlcyxcbiAgICAgICAgaSwgaWw7XG5cbiAgICBmb3IgKGkgPSAwLCBpbCA9IGNvbXBvbmVudE1hbmFnZXJUeXBlcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBjb21wb25lbnRNYW5hZ2VyVHlwZXNbaV0udXBkYXRlKCk7XG59O1xuXG5cbkdVSS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGd1aU9iamVjdHMgPSB0aGlzLmd1aU9iamVjdHMsXG4gICAgICAgIGkgPSBndWlPYmplY3RzLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHRoaXMucmVtb3ZlR1VJT2JqZWN0KGd1aU9iamVjdHNbaV0sIHRydWUpO1xuXG4gICAgdGhpcy5vZmYoKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUkucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLmVtaXQoXCJkZXN0cm95XCIpO1xuICAgIHRoaXMuY2xlYXIoKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUkucHJvdG90eXBlLmFkZEdVSU9iamVjdCA9IGZ1bmN0aW9uIChndWlPYmplY3QpIHtcbiAgICBpZiAoIShndWlPYmplY3QgaW5zdGFuY2VvZiBHVUlPYmplY3QpKSB7XG4gICAgICAgIExvZy5lcnJvcihcIkdVSS5hZGRHVUlPYmplY3Q6IGNhbid0IGFkZCBhcmd1bWVudCB0byBHVUksIGl0J3Mgbm90IGFuIGluc3RhbmNlIG9mIEdVSU9iamVjdFwiKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHZhciBndWlPYmplY3RzID0gdGhpcy5ndWlPYmplY3RzLFxuICAgICAgICBpbmRleCA9IGd1aU9iamVjdHMuaW5kZXhPZihndWlPYmplY3QpLFxuICAgICAgICBjb21wb25lbnRzLCB0cmFuc2Zvcm0sIGNoaWxkcmVuLCBjaGlsZCxcbiAgICAgICAgaTtcblxuICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgaWYgKGd1aU9iamVjdC5ndWkpIGd1aU9iamVjdC5ndWkucmVtb3ZlR1VJT2JqZWN0KGd1aU9iamVjdCk7XG5cbiAgICAgICAgZ3VpT2JqZWN0cy5wdXNoKGd1aU9iamVjdCk7XG4gICAgICAgIHRoaXMuX2d1aU9iamVjdEhhc2hbZ3VpT2JqZWN0Ll9pZF0gPSBndWlPYmplY3Q7XG4gICAgICAgIGlmIChndWlPYmplY3QuX2pzb25JZCAhPT0gLTEpIHRoaXMuX2d1aU9iamVjdEpTT05IYXNoW2d1aU9iamVjdC5fanNvbklkXSA9IGd1aU9iamVjdDtcblxuICAgICAgICBndWlPYmplY3QuZ3VpID0gdGhpcztcblxuICAgICAgICBjb21wb25lbnRzID0gZ3VpT2JqZWN0LmNvbXBvbmVudHM7XG4gICAgICAgIGkgPSBjb21wb25lbnRzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkgdGhpcy5fYWRkR1VJQ29tcG9uZW50KGNvbXBvbmVudHNbaV0pO1xuXG4gICAgICAgIGlmICgodHJhbnNmb3JtID0gZ3VpT2JqZWN0Lmd1aVRyYW5zZm9ybSkpIHtcbiAgICAgICAgICAgIGkgPSAoY2hpbGRyZW4gPSB0cmFuc2Zvcm0uY2hpbGRyZW4pLmxlbmd0aDtcblxuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIGlmICgoY2hpbGQgPSBjaGlsZHJlbltpXS5ndWlPYmplY3QpICYmICF0aGlzLmhhc0dVSU9iamVjdChjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRHVUlPYmplY3QoY2hpbGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmdhbWUpIGd1aU9iamVjdC5lbWl0KFwiaW5pdFwiKTtcbiAgICAgICAgdGhpcy5lbWl0KFwiYWRkR1VJT2JqZWN0XCIsIGd1aU9iamVjdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgTG9nLmVycm9yKFwiR1VJLmFkZEdVSU9iamVjdDogR1VJT2JqZWN0IGlzIGFscmVhZHkgYSBtZW1iZXIgb2YgR1VJXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUkucHJvdG90eXBlLmFkZEdVSU9iamVjdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGkgPSAwLFxuICAgICAgICBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cbiAgICBmb3IgKDsgaSA8IGlsOyBpKyspIHRoaXMuYWRkR1VJT2JqZWN0KGFyZ3VtZW50c1tpXSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdVSS5wcm90b3R5cGUuX2FkZEdVSUNvbXBvbmVudCA9IGZ1bmN0aW9uIChjb21wb25lbnQpIHtcbiAgICBpZiAoIWNvbXBvbmVudCkgcmV0dXJuO1xuICAgIHZhciB0eXBlID0gY29tcG9uZW50Ll90eXBlLFxuICAgICAgICBjb21wb25lbnRNYW5hZ2VycyA9IHRoaXMuY29tcG9uZW50TWFuYWdlcnMsXG4gICAgICAgIGNvbXBvbmVudE1hbmFnZXIgPSBjb21wb25lbnRNYW5hZ2Vyc1t0eXBlXSxcbiAgICAgICAgY29tcG9uZW50TWFuYWdlclR5cGVzID0gdGhpcy5fY29tcG9uZW50TWFuYWdlclR5cGVzLFxuICAgICAgICBpc05ldyA9ICFjb21wb25lbnRNYW5hZ2VyO1xuXG4gICAgaWYgKGlzTmV3KSB7XG4gICAgICAgIGNvbXBvbmVudE1hbmFnZXIgPSBjb21wb25lbnRNYW5hZ2Vyc1t0eXBlXSA9IG5ldyAoQ2xhc3MuX2NsYXNzZXNbdHlwZSArIFwiR1VJQ29tcG9uZW50TWFuYWdlclwiXSB8fCBHVUlDb21wb25lbnRNYW5hZ2VyKTtcbiAgICAgICAgY29tcG9uZW50TWFuYWdlclR5cGVzLnB1c2goY29tcG9uZW50TWFuYWdlcik7XG4gICAgICAgIGNvbXBvbmVudE1hbmFnZXJUeXBlcy5zb3J0KHNvcnRHVUlDb21wb25lbnRNYW5hZ2VyVHlwZXMpO1xuICAgICAgICBjb21wb25lbnRNYW5hZ2VyLmd1aSA9IHRoaXM7XG4gICAgfVxuXG4gICAgY29tcG9uZW50TWFuYWdlci5hZGQoY29tcG9uZW50KTtcbiAgICBjb21wb25lbnRNYW5hZ2VyLnNvcnQoKTtcblxuICAgIHRoaXMuX2NvbXBvbmVudEhhc2hbY29tcG9uZW50Ll9pZF0gPSBjb21wb25lbnQ7XG4gICAgaWYgKGNvbXBvbmVudC5fanNvbklkICE9PSAtMSkgdGhpcy5fY29tcG9uZW50SlNPTkhhc2hbY29tcG9uZW50Ll9qc29uSWRdID0gY29tcG9uZW50O1xuXG4gICAgdGhpcy5lbWl0KFwiYWRkXCIgKyB0eXBlLCBjb21wb25lbnQpO1xuICAgIHRoaXMuZW1pdChcImFkZEdVSUNvbXBvbmVudFwiLCBjb21wb25lbnQpO1xuXG4gICAgaWYgKHRoaXMuZ2FtZSkge1xuICAgICAgICBjb21wb25lbnQuc3RhcnQoKTtcbiAgICAgICAgY29tcG9uZW50LmVtaXQoXCJzdGFydFwiKTtcbiAgICB9XG59O1xuXG5cbmZ1bmN0aW9uIHNvcnRHVUlDb21wb25lbnRNYW5hZ2VyVHlwZXMoYSwgYikge1xuXG4gICAgcmV0dXJuIGEub3JkZXIgLSBiLm9yZGVyO1xufVxuXG5cbkdVSS5wcm90b3R5cGUucmVtb3ZlR1VJT2JqZWN0ID0gZnVuY3Rpb24gKGd1aU9iamVjdCwgY2xlYXIpIHtcbiAgICBpZiAoIShndWlPYmplY3QgaW5zdGFuY2VvZiBHVUlPYmplY3QpKSB7XG4gICAgICAgIExvZy5lcnJvcihcIkdVSS5yZW1vdmVHVUlPYmplY3Q6IGNhbid0IHJlbW92ZSBhcmd1bWVudCBmcm9tIEdVSSwgaXQncyBub3QgYW4gaW5zdGFuY2Ugb2YgR1VJT2JqZWN0XCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdmFyIGd1aU9iamVjdHMgPSB0aGlzLmd1aU9iamVjdHMsXG4gICAgICAgIGluZGV4ID0gZ3VpT2JqZWN0cy5pbmRleE9mKGd1aU9iamVjdCksXG4gICAgICAgIGNvbXBvbmVudHMsIHRyYW5zZm9ybSwgY2hpbGRyZW4sIGNoaWxkLFxuICAgICAgICBpO1xuXG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuXG4gICAgICAgIGd1aU9iamVjdHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5fZ3VpT2JqZWN0SGFzaFtndWlPYmplY3QuX2lkXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGd1aU9iamVjdC5fanNvbklkICE9PSAtMSkgdGhpcy5fZ3VpT2JqZWN0SlNPTkhhc2hbZ3VpT2JqZWN0Ll9qc29uSWRdID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIGd1aU9iamVjdC5ndWkgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgY29tcG9uZW50cyA9IGd1aU9iamVjdC5jb21wb25lbnRzO1xuICAgICAgICBpID0gY29tcG9uZW50cy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpLS0pIHRoaXMuX3JlbW92ZUdVSUNvbXBvbmVudChjb21wb25lbnRzW2ldLCBjbGVhcik7XG5cbiAgICAgICAgaWYgKCh0cmFuc2Zvcm0gPSBndWlPYmplY3QuZ3VpVHJhbnNmb3JtKSkge1xuICAgICAgICAgICAgaSA9IChjaGlsZHJlbiA9IHRyYW5zZm9ybS5jaGlsZHJlbikubGVuZ3RoO1xuXG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgaWYgKChjaGlsZCA9IGNoaWxkcmVuW2ldLmd1aU9iamVjdCkgJiYgdGhpcy5oYXNHVUlPYmplY3QoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlR1VJT2JqZWN0KGNoaWxkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVtaXQoXCJyZW1vdmVHVUlPYmplY3RcIiwgZ3VpT2JqZWN0KTtcbiAgICAgICAgZ3VpT2JqZWN0LmVtaXQoXCJyZW1vdmVcIiwgZ3VpT2JqZWN0KTtcbiAgICAgICAgaWYgKGNsZWFyKSBndWlPYmplY3QuY2xlYXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBMb2cuZXJyb3IoXCJHVUkucmVtb3ZlR1VJT2JqZWN0OiBHVUlPYmplY3QgaXMgbm90IGEgbWVtYmVyIG9mIEdVSVwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR1VJLnByb3RvdHlwZS5yZW1vdmVHVUlPYmplY3RzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpID0gMCxcbiAgICAgICAgaWwgPSBhcmd1bWVudHMubGVuZ3RoO1xuXG4gICAgZm9yICg7IGkgPCBpbDsgaSsrKSB0aGlzLnJlbW92ZUdVSU9iamVjdChhcmd1bWVudHNbaV0pO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUkucHJvdG90eXBlLl9yZW1vdmVHVUlDb21wb25lbnQgPSBmdW5jdGlvbiAoY29tcG9uZW50LCBjbGVhcikge1xuICAgIGlmICghY29tcG9uZW50KSByZXR1cm47XG4gICAgdmFyIHR5cGUgPSBjb21wb25lbnQuX3R5cGUsXG4gICAgICAgIGNvbXBvbmVudE1hbmFnZXJzID0gdGhpcy5jb21wb25lbnRNYW5hZ2VycyxcbiAgICAgICAgY29tcG9uZW50TWFuYWdlciA9IGNvbXBvbmVudE1hbmFnZXJzW3R5cGVdLFxuICAgICAgICBjb21wb25lbnRNYW5hZ2VyVHlwZXMgPSB0aGlzLl9jb21wb25lbnRNYW5hZ2VyVHlwZXM7XG5cbiAgICBjb21wb25lbnRNYW5hZ2VyLnJlbW92ZShjb21wb25lbnQpO1xuICAgIHRoaXMuX2NvbXBvbmVudEhhc2hbY29tcG9uZW50Ll9pZF0gPSB1bmRlZmluZWQ7XG4gICAgaWYgKGNvbXBvbmVudC5fanNvbklkICE9PSAtMSkgdGhpcy5fY29tcG9uZW50SlNPTkhhc2hbY29tcG9uZW50Ll9qc29uSWRdID0gdW5kZWZpbmVkO1xuXG4gICAgaWYgKGNvbXBvbmVudE1hbmFnZXIuZW1wdHkoKSkge1xuICAgICAgICBjb21wb25lbnRNYW5hZ2Vyc1t0eXBlXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgY29tcG9uZW50TWFuYWdlclR5cGVzLnNwbGljZShjb21wb25lbnRNYW5hZ2VyVHlwZXMuaW5kZXhPZihjb21wb25lbnRNYW5hZ2VyKSwgMSk7XG4gICAgICAgIGNvbXBvbmVudE1hbmFnZXIuZ3VpID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHRoaXMuZW1pdChcInJlbW92ZVwiICsgdHlwZSwgY29tcG9uZW50KTtcbiAgICB0aGlzLmVtaXQoXCJyZW1vdmVHVUlDb21wb25lbnRcIiwgY29tcG9uZW50KTtcblxuICAgIGlmIChjbGVhcikgY29tcG9uZW50LmNsZWFyKCk7XG59O1xuXG5cbkdVSS5wcm90b3R5cGUuaGFzR1VJT2JqZWN0ID0gZnVuY3Rpb24gKGd1aU9iamVjdCkge1xuXG4gICAgcmV0dXJuICEhfnRoaXMuZ3VpT2JqZWN0cy5pbmRleE9mKGd1aU9iamVjdCk7XG59O1xuXG5cbkdVSS5wcm90b3R5cGUuZmluZEJ5VGFnID0gZnVuY3Rpb24gKHRhZywgb3V0KSB7XG4gICAgb3V0IHx8IChvdXQgPSBbXSk7XG4gICAgdmFyIGd1aU9iamVjdHMgPSB0aGlzLmd1aU9iamVjdHMsXG4gICAgICAgIGd1aU9iamVjdCwgaSA9IGd1aU9iamVjdHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZiAoKGd1aU9iamVjdCA9IGd1aU9iamVjdHNbaV0pLmhhc1RhZyh0YWcpKSBvdXQucHVzaChndWlPYmplY3QpO1xuICAgIH1cblxuICAgIHJldHVybiBvdXQ7XG59O1xuXG5cbkdVSS5wcm90b3R5cGUuZmluZEJ5VGFnRmlyc3QgPSBmdW5jdGlvbiAodGFnKSB7XG4gICAgdmFyIGd1aU9iamVjdHMgPSB0aGlzLmd1aU9iamVjdHMsXG4gICAgICAgIGd1aU9iamVjdCwgaSA9IGd1aU9iamVjdHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZiAoKGd1aU9iamVjdCA9IGd1aU9iamVjdHNbaV0pLmhhc1RhZyh0YWcpKSByZXR1cm4gZ3VpT2JqZWN0O1xuICAgIH1cblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5cbkdVSS5wcm90b3R5cGUuZmluZEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9ndWlPYmplY3RIYXNoW2lkXTtcbn07XG5cblxuR1VJLnByb3RvdHlwZS5maW5kQnlKU09OSWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9ndWlPYmplY3RKU09OSGFzaFtpZF07XG59O1xuXG5cbkdVSS5wcm90b3R5cGUuZmluZEdVSUNvbXBvbmVudEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRIYXNoW2lkXTtcbn07XG5cblxuR1VJLnByb3RvdHlwZS5maW5kR1VJQ29tcG9uZW50QnlKU09OSWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRKU09OSGFzaFtpZF07XG59O1xuXG5cbkdVSS5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdmFyIGd1aU9iamVjdHMgPSB0aGlzLmd1aU9iamVjdHMsXG4gICAgICAgIGNoaWxkLCBpID0gZ3VpT2JqZWN0cy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNoaWxkID0gZ3VpT2JqZWN0c1tpXTtcblxuICAgICAgICBpZiAoY2hpbGQubmFtZSA9PT0gbmFtZSkgcmV0dXJuIGNoaWxkO1xuICAgICAgICBpZiAoKGNoaWxkID0gY2hpbGQuZmluZChuYW1lKSkpIHJldHVybiBjaGlsZDtcbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuXG5HVUkucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiA9IENsYXNzLnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcbiAgICB2YXIgZ3VpT2JqZWN0cyA9IHRoaXMuZ3VpT2JqZWN0cyxcbiAgICAgICAganNvbkdVSU9iamVjdHMgPSBqc29uLmd1aU9iamVjdHMgfHwgKGpzb24uZ3VpT2JqZWN0cyA9IFtdKSxcbiAgICAgICAgZ3VpT2JqZWN0LFxuICAgICAgICBpID0gZ3VpT2JqZWN0cy5sZW5ndGg7XG5cbiAgICBqc29uLm5hbWUgPSB0aGlzLm5hbWU7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGlmICgoZ3VpT2JqZWN0ID0gZ3VpT2JqZWN0c1tpXSkpIGpzb25HVUlPYmplY3RzW2ldID0gZ3VpT2JqZWN0LnRvSlNPTihqc29uR1VJT2JqZWN0c1tpXSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbkdVSS5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENsYXNzLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuICAgIHZhciBqc29uR1VJT2JqZWN0cyA9IGpzb24uZ3VpT2JqZWN0cyxcbiAgICAgICAgZ3VpT2JqZWN0LCBqc29uR1VJT2JqZWN0LFxuICAgICAgICBpID0ganNvbkdVSU9iamVjdHMubGVuZ3RoO1xuXG4gICAgdGhpcy5uYW1lID0ganNvbi5uYW1lO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZiAoIShqc29uR1VJT2JqZWN0ID0ganNvbkdVSU9iamVjdHNbaV0pKSBjb250aW51ZTtcblxuICAgICAgICBpZiAoKGd1aU9iamVjdCA9IHRoaXMuX2d1aU9iamVjdEpTT05IYXNoW2pzb25HVUlPYmplY3QuX2lkXSkpIHtcbiAgICAgICAgICAgIGd1aU9iamVjdC5mcm9tSlNPTihqc29uR1VJT2JqZWN0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWRkR1VJT2JqZWN0KENsYXNzLmZyb21KU09OKGpzb25HVUlPYmplY3QpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEdVSTtcbiIsInZhciBDbGFzcyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2NsYXNzXCIpO1xudmFyIEdVSUNvbXBvbmVudCA9IHJlcXVpcmUoXCIuL2NvbXBvbmVudHMvZ3VpX2NvbXBvbmVudFwiKTtcbnZhciBHVUlUcmFuc2Zvcm0gPSByZXF1aXJlKFwiLi9jb21wb25lbnRzL2d1aV90cmFuc2Zvcm1cIik7XG52YXIgTG9nID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvbG9nXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQGNsYXNzIEdVSU9iamVjdFxuICogQGV4dGVuZHMgQ2xhc3NcbiAqIEBtZW1iZXJvZiBPZGluXG4gKiBAYnJpZWYgQmFzZSBjbGFzcyBmb3IgZW50aXRpZXMgaW4gc2NlbmVzXG4gKiBAcGFyYW0gT2JqZWN0IG9wdGlvbnNcbiAqL1xuZnVuY3Rpb24gR1VJT2JqZWN0KG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQ2xhc3MuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMubmFtZSA9IG9wdHMubmFtZSAhPSB1bmRlZmluZWQgPyBvcHRzLm5hbWUgOiBcIkdVSU9iamVjdF9cIiArIHRoaXMuX2lkO1xuXG4gICAgdGhpcy5zY2VuZSA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMudGFncyA9IFtdO1xuXG4gICAgdGhpcy5jb21wb25lbnRzID0gW107XG4gICAgdGhpcy5fY29tcG9uZW50VHlwZSA9IHt9O1xuICAgIHRoaXMuX2NvbXBvbmVudEhhc2ggPSB7fTtcbiAgICB0aGlzLl9jb21wb25lbnRKU09OSGFzaCA9IHt9O1xuXG4gICAgaWYgKG9wdHMudGFnKSB0aGlzLmFkZFRhZyhvcHRzLnRhZyk7XG4gICAgaWYgKG9wdHMudGFncykgdGhpcy5hZGRUYWdzLmFwcGx5KHRoaXMsIG9wdHMudGFncyk7XG5cbiAgICB0aGlzLmFkZEdVSUNvbXBvbmVudChuZXcgR1VJVHJhbnNmb3JtKTtcbiAgICBpZiAob3B0cy5jb21wb25lbnRzKSB0aGlzLmFkZEdVSUNvbXBvbmVudHMuYXBwbHkodGhpcywgb3B0cy5jb21wb25lbnRzKTtcbn1cblxuQ2xhc3MuZXh0ZW5kKEdVSU9iamVjdCk7XG5cblxuR1VJT2JqZWN0LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIGNvbXBvbmVudHMgPSB0aGlzLmNvbXBvbmVudHMsXG4gICAgICAgIG90aGVyR1VJQ29tcG9uZW50cyA9IG90aGVyLmNvbXBvbmVudHMsXG4gICAgICAgIHRhZ3MgPSBvdGhlci50YWdzLFxuICAgICAgICBvdGhlckdVSUNvbXBvbmVudCwgY29tcG9uZW50LFxuICAgICAgICBpID0gY29tcG9uZW50cy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbXBvbmVudCA9IGNvbXBvbmVudHNbaV07XG4gICAgICAgIGlmICghb3RoZXIuaGFzR1VJQ29tcG9uZW50KGNvbXBvbmVudC5fY2xhc3NOYW1lKSkgdGhpcy5yZW1vdmVHVUlDb21wb25lbnQoY29tcG9uZW50KTtcbiAgICB9XG5cbiAgICBpID0gb3RoZXJHVUlDb21wb25lbnRzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIG90aGVyR1VJQ29tcG9uZW50ID0gb3RoZXJHVUlDb21wb25lbnRzW2ldO1xuXG4gICAgICAgIGlmICgoY29tcG9uZW50ID0gdGhpcy5nZXRHVUlDb21wb25lbnQob3RoZXJHVUlDb21wb25lbnQuX3R5cGUpKSkge1xuICAgICAgICAgICAgY29tcG9uZW50LmNvcHkob3RoZXJHVUlDb21wb25lbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hZGRHVUlDb21wb25lbnQob3RoZXJHVUlDb21wb25lbnQuY2xvbmUoKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpID0gdGFncy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkgdGhpcy5hZGRUYWcodGFnc1tpXSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR1VJT2JqZWN0LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cyxcbiAgICAgICAgdGFncyA9IHRoaXMudGFncyxcbiAgICAgICAgY29tcG9uZW50TGVuZ3RoID0gY29tcG9uZW50cy5sZW5ndGgsXG4gICAgICAgIGk7XG5cbiAgICBpID0gY29tcG9uZW50TGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIGNvbXBvbmVudHNbaV0uY2xlYXIoKTtcblxuICAgIGkgPSB0YWdzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB0aGlzLnJlbW92ZVRhZyh0YWdzW2ldKTtcblxuICAgIGkgPSBjb21wb25lbnRMZW5ndGg7XG4gICAgd2hpbGUgKGktLSkgdGhpcy5yZW1vdmVHVUlDb21wb25lbnQoY29tcG9uZW50c1tpXSk7XG5cbiAgICB0aGlzLm9mZigpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdVSU9iamVjdC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuc2NlbmUpIHtcbiAgICAgICAgTG9nLmVycm9yKFwiR1VJT2JqZWN0LmRlc3Ryb3k6IGNhbid0IGRlc3Ryb3kgR1VJT2JqZWN0IGlmIGl0J3Mgbm90IGFkZGVkIHRvIGEgU2NlbmVcIik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHRoaXMuc2NlbmUucmVtb3ZlR1VJT2JqZWN0KHRoaXMpO1xuICAgIHRoaXMuZW1pdChcImRlc3Ryb3lcIik7XG5cbiAgICB0aGlzLmNsZWFyKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR1VJT2JqZWN0LnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLnNjZW5lKSB7XG4gICAgICAgIExvZy5lcnJvcihcIkdVSU9iamVjdC5yZW1vdmU6IGNhbid0IHJlbW92ZSBHVUlPYmplY3QgaWYgaXQncyBub3QgYWRkZWQgdG8gYSBTY2VuZVwiKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgdGhpcy5zY2VuZS5yZW1vdmVHVUlPYmplY3QodGhpcyk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdVSU9iamVjdC5wcm90b3R5cGUuYWRkVGFnID0gZnVuY3Rpb24gKHRhZykge1xuICAgIHZhciB0YWdzID0gdGhpcy50YWdzO1xuXG4gICAgaWYgKHRhZ3MuaW5kZXhPZih0YWcpID09PSAtMSkgdGFncy5wdXNoKHRhZyk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR1VJT2JqZWN0LnByb3RvdHlwZS5hZGRUYWdzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpID0gYXJndW1lbnRzLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHRoaXMuYWRkVGFnKGFyZ3VtZW50c1tpXSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdVSU9iamVjdC5wcm90b3R5cGUucmVtb3ZlVGFnID0gZnVuY3Rpb24gKHRhZykge1xuICAgIHZhciB0YWdzID0gdGhpcy50YWdzLFxuICAgICAgICBpbmRleCA9IHRhZ3MuaW5kZXhPZih0YWcpO1xuXG4gICAgaWYgKGluZGV4ICE9PSAtMSkgdGFncy5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdVSU9iamVjdC5wcm90b3R5cGUucmVtb3ZlVGFncyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLnJlbW92ZVRhZyhhcmd1bWVudHNbaV0pO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUlPYmplY3QucHJvdG90eXBlLmhhc1RhZyA9IGZ1bmN0aW9uICh0YWcpIHtcblxuICAgIHJldHVybiB0aGlzLnRhZ3MuaW5kZXhPZih0YWcpICE9PSAtMTtcbn07XG5cblxuR1VJT2JqZWN0LnByb3RvdHlwZS5hZGRHVUlDb21wb25lbnQgPSBmdW5jdGlvbiAoY29tcG9uZW50LCBvdGhlcnMpIHtcbiAgICBpZiAodHlwZW9mKGNvbXBvbmVudCkgPT09IFwic3RyaW5nXCIpIGNvbXBvbmVudCA9IG5ldyBDbGFzcy5fY2xhc3Nlc1tjb21wb25lbnRdO1xuICAgIGlmICghKGNvbXBvbmVudCBpbnN0YW5jZW9mIEdVSUNvbXBvbmVudCkpIHtcbiAgICAgICAgTG9nLmVycm9yKFwiR1VJT2JqZWN0LmFkZEdVSUNvbXBvbmVudDogY2FuJ3QgYWRkIHBhc3NlZCBhcmd1bWVudCwgaXQgaXMgbm90IGFuIGluc3RhbmNlIG9mIEdVSUNvbXBvbmVudFwiKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHZhciBuYW1lID0gY29tcG9uZW50Ll9uYW1lLFxuICAgICAgICBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLFxuICAgICAgICBjb21wLCBpLCBqO1xuXG5cbiAgICBpZiAoIXRoaXNbbmFtZV0pIHtcbiAgICAgICAgaWYgKGNvbXBvbmVudC5nYW1lT2JqZWN0KSBjb21wb25lbnQgPSBjb21wb25lbnQuY2xvbmUoKTtcblxuICAgICAgICBjb21wb25lbnRzLnB1c2goY29tcG9uZW50KTtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50VHlwZVtjb21wb25lbnQuX3R5cGVdID0gY29tcG9uZW50O1xuICAgICAgICB0aGlzLl9jb21wb25lbnRIYXNoW2NvbXBvbmVudC5faWRdID0gY29tcG9uZW50O1xuICAgICAgICBpZiAoY29tcG9uZW50Ll9qc29uSWQgIT09IC0xKSB0aGlzLl9jb21wb25lbnRKU09OSGFzaFtjb21wb25lbnQuX2pzb25JZF0gPSBjb21wb25lbnQ7XG5cbiAgICAgICAgY29tcG9uZW50LmdhbWVPYmplY3QgPSB0aGlzO1xuICAgICAgICB0aGlzW25hbWVdID0gY29tcG9uZW50O1xuXG4gICAgICAgIGlmICghb3RoZXJzKSB7XG4gICAgICAgICAgICBpID0gY29tcG9uZW50cy5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgY29tcCA9IGNvbXBvbmVudHNbaV07XG4gICAgICAgICAgICAgICAgaWYgKCFjb21wKSBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgIGogPSBjb21wb25lbnRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoai0tKSBjb21wW2NvbXBvbmVudHNbal0uX25hbWVdID0gY29tcG9uZW50c1tqXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29tcG9uZW50LmluaXQoKTtcbiAgICAgICAgICAgIGNvbXBvbmVudC5lbWl0KFwiaW5pdFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZW1pdChcImFkZFwiICsgY29tcG9uZW50Ll90eXBlLCBjb21wb25lbnQpO1xuICAgICAgICB0aGlzLmVtaXQoXCJhZGRHVUlDb21wb25lbnRcIiwgY29tcG9uZW50KTtcbiAgICAgICAgY29tcG9uZW50LmVtaXQoXCJhZGRcIiwgdGhpcyk7XG5cbiAgICAgICAgaWYgKHRoaXMuc2NlbmUpIHRoaXMuc2NlbmUuX2FkZEdVSUNvbXBvbmVudChjb21wb25lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIkdVSU9iamVjdC5hZGRHVUlDb21wb25lbnQ6IEdVSU9iamVjdCBhbHJlYWR5IGhhcyBhKG4pIFwiICsgY29tcG9uZW50Ll90eXBlICsgXCIgR1VJQ29tcG9uZW50XCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5HVUlPYmplY3QucHJvdG90eXBlLmFkZEdVSUNvbXBvbmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsXG4gICAgICAgIGNvbXBvbmVudHMgPSB0aGlzLmNvbXBvbmVudHMsXG4gICAgICAgIGNvbXBvbmVudCwgbmFtZSxcbiAgICAgICAgaSwgajtcblxuICAgIGkgPSBsZW5ndGg7XG4gICAgd2hpbGUgKGktLSkgdGhpcy5hZGRHVUlDb21wb25lbnQoYXJndW1lbnRzW2ldLCB0cnVlKTtcblxuICAgIGkgPSBjb21wb25lbnRzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbXBvbmVudCA9IGNvbXBvbmVudHNbaV07XG4gICAgICAgIGlmICghY29tcG9uZW50KSBjb250aW51ZTtcblxuICAgICAgICBqID0gY29tcG9uZW50cy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChqLS0pIHtcbiAgICAgICAgICAgIG5hbWUgPSBjb21wb25lbnRzW2pdLl9uYW1lO1xuICAgICAgICAgICAgY29tcG9uZW50W25hbWVdID0gY29tcG9uZW50c1tqXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGkgPSBjb21wb25lbnRzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbXBvbmVudCA9IGNvbXBvbmVudHNbaV07XG4gICAgICAgIGNvbXBvbmVudC5pbml0KCk7XG4gICAgICAgIGNvbXBvbmVudC5lbWl0KFwiaW5pdFwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR1VJT2JqZWN0LnByb3RvdHlwZS5yZW1vdmVHVUlDb21wb25lbnQgPSBmdW5jdGlvbiAoY29tcG9uZW50LCBjbGVhciwgb3RoZXJzKSB7XG4gICAgaWYgKHR5cGVvZihjb21wb25lbnQpID09PSBcInN0cmluZ1wiKSBjb21wb25lbnQgPSB0aGlzLmdldEdVSUNvbXBvbmVudChjb21wb25lbnQpO1xuICAgIGlmICghKGNvbXBvbmVudCBpbnN0YW5jZW9mIEdVSUNvbXBvbmVudCkpIHtcbiAgICAgICAgTG9nLmVycm9yKFwiR1VJT2JqZWN0LnJlbW92ZUdVSUNvbXBvbmVudDogY2FuJ3QgcmVtb3ZlIHBhc3NlZCBhcmd1bWVudCwgaXQgaXMgbm90IGFuIGluc3RhbmNlIG9mIEdVSUNvbXBvbmVudFwiKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHZhciBuYW1lID0gY29tcG9uZW50Ll9uYW1lLFxuICAgICAgICBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLFxuICAgICAgICBjb21wLCBpLCBqO1xuXG4gICAgaWYgKHRoaXNbbmFtZV0pIHtcbiAgICAgICAgY29tcG9uZW50LmVtaXQoXCJyZW1vdmVcIiwgdGhpcyk7XG4gICAgICAgIHRoaXMuZW1pdChcInJlbW92ZVwiICsgY29tcG9uZW50Ll90eXBlLCBjb21wb25lbnQpO1xuICAgICAgICB0aGlzLmVtaXQoXCJyZW1vdmVHVUlDb21wb25lbnRcIiwgY29tcG9uZW50KTtcblxuICAgICAgICBpZiAoIW90aGVycykge1xuICAgICAgICAgICAgaSA9IGNvbXBvbmVudHMubGVuZ3RoO1xuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIGNvbXAgPSBjb21wb25lbnRzW2ldO1xuICAgICAgICAgICAgICAgIGlmICghY29tcCkgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICBqID0gY29tcG9uZW50cy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGotLSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gY29tcG9uZW50c1tqXS5fbmFtZSkgY29tcFtuYW1lXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb21wb25lbnRzLnNwbGljZShjb21wb25lbnRzLmluZGV4T2YoY29tcG9uZW50KSwgMSk7XG4gICAgICAgIHRoaXMuX2NvbXBvbmVudFR5cGVbY29tcG9uZW50Ll90eXBlXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50SGFzaFtjb21wb25lbnQuX2lkXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGNvbXBvbmVudC5fanNvbklkICE9PSAtMSkgdGhpcy5fY29tcG9uZW50SlNPTkhhc2hbY29tcG9uZW50Ll9qc29uSWRdID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIGNvbXBvbmVudC5nYW1lT2JqZWN0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzW25hbWVdID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIGlmICh0aGlzLnNjZW5lKSB0aGlzLnNjZW5lLl9yZW1vdmVHVUlDb21wb25lbnQoY29tcG9uZW50KTtcbiAgICAgICAgaWYgKGNsZWFyKSBjb21wb25lbnQuY2xlYXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBMb2cuZXJyb3IoXCJHVUlPYmplY3QucmVtb3ZlR1VJQ29tcG9uZW50OiBHVUlPYmplY3QgZG9lcyBub3QgaGF2ZSBhKG4pIFwiICsgdHlwZSArIFwiIEdVSUNvbXBvbmVudFwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuR1VJT2JqZWN0LnByb3RvdHlwZS5yZW1vdmVHVUlDb21wb25lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoLFxuICAgICAgICBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLFxuICAgICAgICB0b1JlbW92ZSA9IGFyZ3VtZW50cyxcbiAgICAgICAgY29tcG9uZW50LCBuYW1lLFxuICAgICAgICBpLCBqO1xuXG4gICAgaSA9IGxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB0aGlzLnJlbW92ZUdVSUNvbXBvbmVudChhcmd1bWVudHNbaV0sIG51bGwsIHRydWUpO1xuXG4gICAgaSA9IGNvbXBvbmVudHMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY29tcG9uZW50ID0gY29tcG9uZW50c1tpXTtcbiAgICAgICAgaWYgKCFjb21wb25lbnQpIGNvbnRpbnVlO1xuXG4gICAgICAgIG5hbWUgPSBjb21wb25lbnQuX25hbWU7XG4gICAgICAgIGogPSB0b1JlbW92ZS5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChqLS0pIHtcbiAgICAgICAgICAgIGlmIChuYW1lID09PSB0b1JlbW92ZVtpXS5fbmFtZSkgY29tcG9uZW50W25hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkdVSU9iamVjdC5wcm90b3R5cGUuZ2V0R1VJQ29tcG9uZW50ID0gZnVuY3Rpb24gKHR5cGUpIHtcblxuICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRUeXBlW3R5cGVdO1xufTtcblxuXG5HVUlPYmplY3QucHJvdG90eXBlLmhhc0dVSUNvbXBvbmVudCA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgdmFyIGNvbXBvbmVudHMgPSB0aGlzLmNvbXBvbmVudHMsXG4gICAgICAgIGkgPSBjb21wb25lbnRzLmxlbmd0aDtcbiAgICA7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGlmIChjb21wb25lbnRzW2ldLl90eXBlID09PSB0eXBlKSByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5cbkdVSU9iamVjdC5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdmFyIHRyYW5zZm9ybSA9IHRoaXMuZ3VpVHJhbnNmb3JtLFxuICAgICAgICBjaGlsZHJlbiwgY2hpbGQsIGk7XG5cbiAgICBpZiAoIXRyYW5zZm9ybSkgcmV0dXJuIHVuZGVmaW5lZDtcblxuICAgIGNoaWxkcmVuID0gdHJhbnNmb3JtLmNoaWxkcmVuO1xuICAgIGkgPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNoaWxkID0gY2hpbGRyZW5baV07XG5cbiAgICAgICAgaWYgKGNoaWxkLmdhbWVPYmplY3QubmFtZSA9PT0gbmFtZSkgcmV0dXJuIGNoaWxkLmdhbWVPYmplY3Q7XG4gICAgICAgIGlmICgoY2hpbGQgPSBjaGlsZC5maW5kKG5hbWUpKSkgcmV0dXJuIGNoaWxkO1xuICAgIH1cblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5cbkdVSU9iamVjdC5wcm90b3R5cGUuZmluZEdVSUNvbXBvbmVudEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRIYXNoW2lkXTtcbn07XG5cblxuR1VJT2JqZWN0LnByb3RvdHlwZS5maW5kR1VJQ29tcG9uZW50QnlKU09OSWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRKU09OSGFzaFtpZF07XG59O1xuXG5cbkdVSU9iamVjdC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gQ2xhc3MucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuICAgIHZhciBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLFxuICAgICAgICBqc29uR1VJQ29tcG9uZW50cyA9IGpzb24uY29tcG9uZW50cyB8fCAoanNvbi5jb21wb25lbnRzID0gW10pLFxuICAgICAgICB0YWdzID0gdGhpcy50YWdzLFxuICAgICAgICBqc29uVGFncyA9IGpzb24udGFncyB8fCAoanNvbi50YWdzID0gW10pLFxuICAgICAgICBjb21wb25lbnQsXG4gICAgICAgIGkgPSBjb21wb25lbnRzLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgaWYgKChjb21wb25lbnQgPSBjb21wb25lbnRzW2ldKS5qc29uKSBqc29uR1VJQ29tcG9uZW50c1tpXSA9IGNvbXBvbmVudC50b0pTT04oanNvbkdVSUNvbXBvbmVudHNbaV0pO1xuICAgIH1cbiAgICBpID0gdGFncy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkganNvblRhZ3NbaV0gPSB0YWdzW2ldO1xuXG4gICAganNvbi5uYW1lID0gdGhpcy5uYW1lO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbkdVSU9iamVjdC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENsYXNzLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuICAgIHZhciBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLFxuICAgICAgICBqc29uR1VJQ29tcG9uZW50cyA9IGpzb24uY29tcG9uZW50cyB8fCAoanNvbi5jb21wb25lbnRzID0gW10pLFxuICAgICAgICBjb21wb25lbnQsIGpzb25HVUlDb21wb25lbnQsIHRhZyxcbiAgICAgICAgdGFncyA9IHRoaXMudGFncyxcbiAgICAgICAganNvblRhZ3MgPSBqc29uLnRhZ3MgfHwgKGpzb24udGFncyA9IFtdKSxcbiAgICAgICAgaSA9IGNvbXBvbmVudHMubGVuZ3RoLFxuICAgICAgICBoYXMsIHR5cGUsIGo7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbXBvbmVudCA9IGNvbXBvbmVudHNbaV07XG4gICAgICAgIHR5cGUgPSBjb21wb25lbnQuX3R5cGU7XG4gICAgICAgIGhhcyA9IGZhbHNlO1xuXG4gICAgICAgIGogPSBqc29uR1VJQ29tcG9uZW50cy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChqLS0pIHtcbiAgICAgICAgICAgIGpzb25HVUlDb21wb25lbnQgPSBqc29uR1VJQ29tcG9uZW50c1tpXTtcbiAgICAgICAgICAgIGlmICh0eXBlID09PSBqc29uR1VJQ29tcG9uZW50Ll90eXBlKSBoYXMgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFoYXMpIHRoaXMucmVtb3ZlR1VJQ29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgfVxuXG4gICAgaSA9IGpzb25HVUlDb21wb25lbnRzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGlmICghKGpzb25HVUlDb21wb25lbnQgPSBqc29uR1VJQ29tcG9uZW50c1tpXSkpIGNvbnRpbnVlO1xuXG4gICAgICAgIGlmICgoY29tcG9uZW50ID0gdGhpcy5maW5kR1VJQ29tcG9uZW50QnlKU09OSWQoanNvbkdVSUNvbXBvbmVudC5faWQpKSB8fCAoY29tcG9uZW50ID0gdGhpcy5nZXRHVUlDb21wb25lbnQoanNvbkdVSUNvbXBvbmVudC5fdHlwZSkpKSB7XG4gICAgICAgICAgICBjb21wb25lbnQuZnJvbUpTT04oanNvbkdVSUNvbXBvbmVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFkZEdVSUNvbXBvbmVudChDbGFzcy5mcm9tSlNPTihqc29uR1VJQ29tcG9uZW50KSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpID0ganNvblRhZ3MubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgaWYgKHRhZ3MuaW5kZXhPZigodGFnID0ganNvblRhZ3NbaV0pKSA9PT0gLTEpIHRhZ3MucHVzaCh0YWcpO1xuICAgIH1cblxuICAgIHRoaXMubmFtZSA9IGpzb24ubmFtZTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEdVSU9iamVjdDtcbiIsInZhciBFbnVtcyA9IHJlcXVpcmUoXCIuLi9lbnVtc1wiKTtcbnZhciBBeGlzID0gcmVxdWlyZShcIi4vYXhpc1wiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9sb2dcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgQXhpc1R5cGUgPSBFbnVtcy5BeGlzVHlwZTtcblxuXG5mdW5jdGlvbiBBeGVzKCkge1xuXG4gICAgQXJyYXkuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMuaGFzaCA9IHt9O1xuICAgIHRoaXMuX1NZTkMgPSB7fTtcblxuICAgIHRoaXMuYWRkKHtcbiAgICAgICAgbmFtZTogXCJob3Jpem9udGFsXCIsXG4gICAgICAgIHBvc0J1dHRvbjogXCJyaWdodFwiLFxuICAgICAgICBuZWdCdXR0b246IFwibGVmdFwiLFxuICAgICAgICBhbHRQb3NCdXR0b246IFwiZFwiLFxuICAgICAgICBhbHROZWdCdXR0b246IFwiYVwiLFxuICAgICAgICB0eXBlOiBBeGlzVHlwZS5CdXR0b25cbiAgICB9KTtcblxuICAgIHRoaXMuYWRkKHtcbiAgICAgICAgbmFtZTogXCJ2ZXJ0aWNhbFwiLFxuICAgICAgICBwb3NCdXR0b246IFwidXBcIixcbiAgICAgICAgbmVnQnV0dG9uOiBcImRvd25cIixcbiAgICAgICAgYWx0UG9zQnV0dG9uOiBcIndcIixcbiAgICAgICAgYWx0TmVnQnV0dG9uOiBcInNcIixcbiAgICAgICAgdHlwZTogQXhpc1R5cGUuQnV0dG9uXG4gICAgfSk7XG5cbiAgICB0aGlzLmFkZCh7XG4gICAgICAgIG5hbWU6IFwiZmlyZVwiLFxuICAgICAgICBwb3NCdXR0b246IFwiY3RybFwiLFxuICAgICAgICBuZWdCdXR0b246IFwiXCIsXG4gICAgICAgIGFsdFBvc0J1dHRvbjogXCJtb3VzZTBcIixcbiAgICAgICAgYWx0TmVnQnV0dG9uOiBcIlwiLFxuICAgICAgICB0eXBlOiBBeGlzVHlwZS5CdXR0b25cbiAgICB9KTtcblxuICAgIHRoaXMuYWRkKHtcbiAgICAgICAgbmFtZTogXCJqdW1wXCIsXG4gICAgICAgIHBvc0J1dHRvbjogXCJzcGFjZVwiLFxuICAgICAgICBuZWdCdXR0b246IFwiXCIsXG4gICAgICAgIGFsdFBvc0J1dHRvbjogXCJtb3VzZTJcIixcbiAgICAgICAgYWx0TmVnQnV0dG9uOiBcIlwiLFxuICAgICAgICB0eXBlOiBBeGlzVHlwZS5CdXR0b25cbiAgICB9KTtcblxuICAgIHRoaXMuYWRkKHtcbiAgICAgICAgbmFtZTogXCJtb3VzZVhcIixcbiAgICAgICAgdHlwZTogQXhpc1R5cGUuTW91c2UsXG4gICAgICAgIGF4aXM6IFwieFwiXG4gICAgfSk7XG5cbiAgICB0aGlzLmFkZCh7XG4gICAgICAgIG5hbWU6IFwibW91c2VZXCIsXG4gICAgICAgIHR5cGU6IEF4aXNUeXBlLk1vdXNlLFxuICAgICAgICBheGlzOiBcInlcIlxuICAgIH0pO1xuXG4gICAgdGhpcy5hZGQoe1xuICAgICAgICBuYW1lOiBcInRvdWNoWFwiLFxuICAgICAgICB0eXBlOiBBeGlzVHlwZS5Ub3VjaCxcbiAgICAgICAgYXhpczogXCJ4XCJcbiAgICB9KTtcblxuICAgIHRoaXMuYWRkKHtcbiAgICAgICAgbmFtZTogXCJ0b3VjaFlcIixcbiAgICAgICAgdHlwZTogQXhpc1R5cGUuVG91Y2gsXG4gICAgICAgIGF4aXM6IFwieVwiXG4gICAgfSk7XG5cbiAgICB0aGlzLmFkZCh7XG4gICAgICAgIG5hbWU6IFwibW91c2VXaGVlbFwiLFxuICAgICAgICB0eXBlOiBBeGlzVHlwZS5Nb3VzZVdoZWVsXG4gICAgfSk7XG59XG5cbkF4ZXMucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShBcnJheS5wcm90b3R5cGUpO1xuQXhlcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBBeGVzO1xuXG5cbkF4ZXMucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChuYW1lLCBvcHRzKSB7XG4gICAgaWYgKHR5cGVvZihuYW1lKSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICBvcHRzID0gbmFtZTtcbiAgICAgICAgbmFtZSA9IG9wdHMubmFtZTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaGFzaFtuYW1lXSkge1xuICAgICAgICBMb2cuZXJyb3IoXCJBeGVzLmFkZDogQXhlcyBhbHJlYWR5IGhhdmUgQXhpcyBuYW1lZCBcIiArIG5hbWUgKyBcIiB1c2UgQXhlcy5nZXQoXFxcIlwiICsgbmFtZSArIFwiXFxcIikgYW5kIGVkaXQgaXQgaW5zdGVhZFwiKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcbiAgICBvcHRzLm5hbWUgPSBuYW1lO1xuICAgIHZhciBheGlzID0gbmV3IEF4aXMob3B0cyk7XG5cbiAgICB0aGlzLnB1c2goYXhpcyk7XG4gICAgdGhpcy5oYXNoW25hbWVdID0gYXhpcztcblxuICAgIHJldHVybiBheGlzO1xufTtcblxuXG5BeGVzLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAobmFtZSkge1xuXG4gICAgcmV0dXJuIHRoaXMuaGFzaFtuYW1lXTtcbn07XG5cblxuQXhlcy5wcm90b3R5cGUudG9TWU5DID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0gdGhpcy5fU1lOQyk7XG4gICAgdmFyIGpzb25BeGVzID0ganNvbi5heGVzIHx8IChqc29uLmF4ZXMgPSBbXSksXG4gICAgICAgIGk7XG5cbiAgICBmb3IgKGkgPSB0aGlzLmxlbmd0aDsgaS0tOykganNvbkF4ZXNbaV0gPSB0aGlzW2ldLnRvU1lOQyhqc29uQXhlc1tpXSk7XG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbkF4ZXMucHJvdG90eXBlLmZyb21TWU5DID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICB2YXIgYXhpc0hhc2ggPSB0aGlzLmhhc2gsXG4gICAgICAgIGpzb25BeGVzID0ganNvbi5heGVzIHx8IChqc29uLmF4ZXMgPSBbXSksXG4gICAgICAgIGF4aXMsIGpzb25BeGlzLFxuICAgICAgICBpO1xuXG4gICAgZm9yIChpID0ganNvbkF4ZXMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgIGpzb25BeGlzID0ganNvbkF4ZXNbaV07XG5cbiAgICAgICAgaWYgKChheGlzID0gYXhpc0hhc2hbanNvbkF4aXMubmFtZV0pKSB7XG4gICAgICAgICAgICBheGlzLmZyb21TWU5DKGpzb25BeGlzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWRkKGpzb25BeGlzLm5hbWUpLmZyb21KU09OKGpzb25BeGlzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5BeGVzLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gfHwgKGpzb24gPSB7fSk7XG4gICAgdmFyIGpzb25BeGVzID0ganNvbi5heGVzIHx8IChqc29uLmF4ZXMgPSBbXSksXG4gICAgICAgIGk7XG5cbiAgICBmb3IgKGkgPSB0aGlzLmxlbmd0aDsgaS0tOykganNvbkF4ZXNbaV0gPSB0aGlzW2ldLnRvSlNPTihqc29uQXhlc1tpXSk7XG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbkF4ZXMucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICB2YXIgYXhpc0hhc2ggPSB0aGlzLmhhc2gsXG4gICAgICAgIGpzb25BeGVzID0ganNvbi5heGVzIHx8IChqc29uLmF4ZXMgPSBbXSksXG4gICAgICAgIGF4aXMsIGpzb25BeGlzLFxuICAgICAgICBpO1xuXG4gICAgZm9yIChpID0ganNvbkF4ZXMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgIGpzb25BeGlzID0ganNvbkF4ZXNbaV07XG5cbiAgICAgICAgaWYgKChheGlzID0gYXhpc0hhc2hbanNvbkF4aXMubmFtZV0pKSB7XG4gICAgICAgICAgICBheGlzLmZyb21KU09OKGpzb25BeGlzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWRkKGpzb25BeGlzLm5hbWUpLmZyb21KU09OKGpzb25BeGlzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEF4ZXM7XG4iLCJ2YXIgRW51bXMgPSByZXF1aXJlKFwiLi4vZW51bXNcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgQXhpc1R5cGUgPSBFbnVtcy5BeGlzVHlwZTtcblxuXG5mdW5jdGlvbiBBeGlzKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgdGhpcy5uYW1lID0gb3B0cy5uYW1lICE9IHVuZGVmaW5lZCA/IG9wdHMubmFtZSA6IFwidW5rbm93blwiO1xuXG4gICAgdGhpcy5uZWdCdXR0b24gPSBvcHRzLm5lZ0J1dHRvbiAhPSB1bmRlZmluZWQgPyBvcHRzLm5lZ0J1dHRvbiA6IFwiXCI7XG4gICAgdGhpcy5wb3NCdXR0b24gPSBvcHRzLnBvc0J1dHRvbiAhPSB1bmRlZmluZWQgPyBvcHRzLnBvc0J1dHRvbiA6IFwiXCI7XG5cbiAgICB0aGlzLmFsdE5lZ0J1dHRvbiA9IG9wdHMuYWx0TmVnQnV0dG9uICE9IHVuZGVmaW5lZCA/IG9wdHMuYWx0TmVnQnV0dG9uIDogXCJcIjtcbiAgICB0aGlzLmFsdFBvc0J1dHRvbiA9IG9wdHMuYWx0UG9zQnV0dG9uICE9IHVuZGVmaW5lZCA/IG9wdHMuYWx0UG9zQnV0dG9uIDogXCJcIjtcblxuICAgIHRoaXMuZ3Jhdml0eSA9IG9wdHMuZ3Jhdml0eSAhPSB1bmRlZmluZWQgPyBvcHRzLmdyYXZpdHkgOiAzO1xuICAgIHRoaXMuc2Vuc2l0aXZpdHkgPSBvcHRzLnNlbnNpdGl2aXR5ICE9IHVuZGVmaW5lZCA/IG9wdHMuc2Vuc2l0aXZpdHkgOiAzO1xuXG4gICAgdGhpcy5kZWFkID0gb3B0cy5kZWFkICE9IHVuZGVmaW5lZCA/IG9wdHMuZGVhZCA6IDAuMDAxO1xuXG4gICAgdGhpcy50eXBlID0gb3B0cy50eXBlICE9IHVuZGVmaW5lZCA/IG9wdHMudHlwZSA6IEF4aXNUeXBlLkJVVFRPTjtcbiAgICB0aGlzLmF4aXMgPSBvcHRzLmF4aXMgIT0gdW5kZWZpbmVkID8gb3B0cy5heGlzIDogXCJ4XCI7XG4gICAgdGhpcy5pbmRleCA9IG9wdHMuaW5kZXggIT0gdW5kZWZpbmVkID8gb3B0cy5pbmRleCA6IDA7XG5cbiAgICB0aGlzLmpveU51bSA9IG9wdHMuam95TnVtICE9IHVuZGVmaW5lZCA/IG9wdHMuam95TnVtIDogMDtcblxuICAgIHRoaXMudmFsdWUgPSAwO1xuXG4gICAgdGhpcy5fU1lOQyA9IHt9O1xufTtcblxuXG5BeGlzLnByb3RvdHlwZS50b1NZTkMgPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gfHwgKGpzb24gPSB0aGlzLl9TWU5DKTtcblxuICAgIGpzb24ubmFtZSA9IHRoaXMubmFtZTtcbiAgICBqc29uLnZhbHVlID0gdGhpcy52YWx1ZTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5BeGlzLnByb3RvdHlwZS5mcm9tU1lOQyA9IGZ1bmN0aW9uIChqc29uKSB7XG5cbiAgICB0aGlzLm5hbWUgPSBqc29uLm5hbWU7XG4gICAgdGhpcy52YWx1ZSA9IGpzb24udmFsdWU7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuQXhpcy5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0ge30pO1xuXG4gICAganNvbi5uYW1lID0gdGhpcy5uYW1lO1xuXG4gICAganNvbi5uZWdCdXR0b24gPSB0aGlzLm5lZ0J1dHRvbjtcbiAgICBqc29uLnBvc0J1dHRvbiA9IHRoaXMucG9zQnV0dG9uO1xuXG4gICAganNvbi5hbHROZWdCdXR0b24gPSB0aGlzLmFsdE5lZ0J1dHRvbjtcbiAgICBqc29uLmFsdFBvc0J1dHRvbiA9IHRoaXMuYWx0UG9zQnV0dG9uO1xuXG4gICAganNvbi5ncmF2aXR5ID0gdGhpcy5ncmF2aXR5O1xuICAgIGpzb24uc2Vuc2l0aXZpdHkgPSB0aGlzLnNlbnNpdGl2aXR5O1xuXG4gICAganNvbi5kZWFkID0gdGhpcy5kZWFkO1xuXG4gICAganNvbi50eXBlID0gdGhpcy50eXBlO1xuICAgIGpzb24uYXhpcyA9IHRoaXMuYXhpcztcbiAgICBqc29uLmluZGV4ID0gdGhpcy5pbmRleDtcblxuICAgIGpzb24uam95TnVtID0gdGhpcy5qb3lOdW07XG5cbiAgICBqc29uLnZhbHVlID0gdGhpcy52YWx1ZTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5BeGlzLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG5cbiAgICB0aGlzLm5hbWUgPSBqc29uLm5hbWU7XG5cbiAgICB0aGlzLm5lZ0J1dHRvbiA9IGpzb24ubmVnQnV0dG9uO1xuICAgIHRoaXMucG9zQnV0dG9uID0ganNvbi5wb3NCdXR0b247XG5cbiAgICB0aGlzLmFsdE5lZ0J1dHRvbiA9IGpzb24uYWx0TmVnQnV0dG9uO1xuICAgIHRoaXMuYWx0UG9zQnV0dG9uID0ganNvbi5hbHRQb3NCdXR0b247XG5cbiAgICB0aGlzLmdyYXZpdHkgPSBqc29uLmdyYXZpdHk7XG4gICAgdGhpcy5zZW5zaXRpdml0eSA9IGpzb24uc2Vuc2l0aXZpdHk7XG5cbiAgICB0aGlzLmRlYWQgPSBqc29uLmRlYWQ7XG5cbiAgICB0aGlzLnR5cGUgPSBqc29uLnR5cGU7XG4gICAgdGhpcy5heGlzID0ganNvbi5heGlzO1xuICAgIHRoaXMuaW5kZXggPSBqc29uLmluZGV4O1xuXG4gICAgdGhpcy5qb3lOdW0gPSBqc29uLmpveU51bTtcblxuICAgIHRoaXMudmFsdWUgPSBqc29uLnZhbHVlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gQXhpcztcbiIsIlwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIEJ1dHRvbihuYW1lKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcblxuICAgIHRoaXMudGltZURvd24gPSAtMTtcbiAgICB0aGlzLnRpbWVVcCA9IC0xO1xuXG4gICAgdGhpcy5mcmFtZURvd24gPSAtMTtcbiAgICB0aGlzLmZyYW1lVXAgPSAtMTtcblxuICAgIHRoaXMudmFsdWUgPSBmYWxzZTtcbiAgICB0aGlzLl9maXJzdCA9IHRydWU7XG5cbiAgICB0aGlzLl9TWU5DID0ge307XG59O1xuXG5cbkJ1dHRvbi5wcm90b3R5cGUudG9TWU5DID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0gdGhpcy5fU1lOQyk7XG5cbiAgICBqc29uLm5hbWUgPSB0aGlzLm5hbWU7XG4gICAganNvbi50aW1lRG93biA9IHRoaXMudGltZURvd247XG4gICAganNvbi50aW1lVXAgPSB0aGlzLnRpbWVVcDtcbiAgICBqc29uLmZyYW1lRG93biA9IHRoaXMuZnJhbWVEb3duO1xuICAgIGpzb24uZnJhbWVVcCA9IHRoaXMuZnJhbWVVcDtcbiAgICBqc29uLnZhbHVlID0gdGhpcy52YWx1ZTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5CdXR0b24ucHJvdG90eXBlLmZyb21TWU5DID0gZnVuY3Rpb24gKGpzb24pIHtcblxuICAgIHRoaXMubmFtZSA9IGpzb24ubmFtZTtcbiAgICB0aGlzLnRpbWVEb3duID0ganNvbi50aW1lRG93bjtcbiAgICB0aGlzLnRpbWVVcCA9IGpzb24udGltZVVwO1xuICAgIHRoaXMuZnJhbWVEb3duID0ganNvbi5mcmFtZURvd247XG4gICAgdGhpcy5mcmFtZVVwID0ganNvbi5mcmFtZVVwO1xuICAgIHRoaXMudmFsdWUgPSBqc29uLnZhbHVlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbkJ1dHRvbi5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0ge30pO1xuXG4gICAganNvbi5uYW1lID0gdGhpcy5uYW1lO1xuICAgIGpzb24udGltZURvd24gPSB0aGlzLnRpbWVEb3duO1xuICAgIGpzb24udGltZVVwID0gdGhpcy50aW1lVXA7XG4gICAganNvbi5mcmFtZURvd24gPSB0aGlzLmZyYW1lRG93bjtcbiAgICBqc29uLmZyYW1lVXAgPSB0aGlzLmZyYW1lVXA7XG4gICAganNvbi52YWx1ZSA9IHRoaXMudmFsdWU7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuQnV0dG9uLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG5cbiAgICB0aGlzLm5hbWUgPSBqc29uLm5hbWU7XG4gICAgdGhpcy50aW1lRG93biA9IGpzb24udGltZURvd247XG4gICAgdGhpcy50aW1lVXAgPSBqc29uLnRpbWVVcDtcbiAgICB0aGlzLmZyYW1lRG93biA9IGpzb24uZnJhbWVEb3duO1xuICAgIHRoaXMuZnJhbWVVcCA9IGpzb24uZnJhbWVVcDtcbiAgICB0aGlzLnZhbHVlID0ganNvbi52YWx1ZTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEJ1dHRvbjtcbiIsInZhciBUaW1lID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvdGltZVwiKTtcbnZhciBCdXR0b24gPSByZXF1aXJlKFwiLi9idXR0b25cIik7XG52YXIgTG9nID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvbG9nXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gQnV0dG9ucygpIHtcblxuICAgIEFycmF5LmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLmhhc2ggPSB7fTtcbiAgICB0aGlzLl9TWU5DID0ge307XG5cbiAgICB0aGlzLmFkZChcIm1vdXNlMFwiKTtcbiAgICB0aGlzLmFkZChcIm1vdXNlMVwiKTtcbiAgICB0aGlzLmFkZChcIm1vdXNlMlwiKTtcbn1cblxuQnV0dG9ucy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEFycmF5LnByb3RvdHlwZSk7XG5CdXR0b25zLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEJ1dHRvbnM7XG5cblxuQnV0dG9ucy5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICBpZiAodGhpcy5oYXNoW25hbWVdKSB7XG4gICAgICAgIExvZy5lcnJvcihcIkJ1dHRvbnMuYWRkOiBCdXR0b25zIGFscmVhZHkgaGF2ZSBCdXR0b24gbmFtZSBcIiArIG5hbWUpO1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICB2YXIgYnV0dG9uID0gbmV3IEJ1dHRvbihuYW1lKTtcblxuICAgIHRoaXMucHVzaChidXR0b24pO1xuICAgIHRoaXMuaGFzaFtuYW1lXSA9IGJ1dHRvbjtcblxuICAgIHJldHVybiBidXR0b247XG59O1xuXG5cbkJ1dHRvbnMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChuYW1lKSB7XG5cbiAgICByZXR1cm4gdGhpcy5oYXNoW25hbWVdO1xufTtcblxuXG5CdXR0b25zLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdmFyIGJ1dHRvbiA9IHRoaXMuaGFzaFtuYW1lXSB8fCB0aGlzLmFkZChuYW1lKTtcblxuICAgIGlmIChidXR0b24uX2ZpcnN0KSB7XG4gICAgICAgIGJ1dHRvbi5mcmFtZURvd24gPSBUaW1lLmZyYW1lQ291bnQgKyAxO1xuICAgICAgICBidXR0b24udGltZURvd24gPSBUaW1lLnN0YW1wKCk7XG4gICAgICAgIGJ1dHRvbi5fZmlyc3QgPSBmYWxzZTtcbiAgICB9XG4gICAgYnV0dG9uLnZhbHVlID0gdHJ1ZTtcblxuICAgIHJldHVybiBidXR0b247XG59O1xuXG5cbkJ1dHRvbnMucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdmFyIGJ1dHRvbiA9IHRoaXMuaGFzaFtuYW1lXSB8fCB0aGlzLmFkZChuYW1lKTtcblxuICAgIGJ1dHRvbi5mcmFtZVVwID0gVGltZS5mcmFtZUNvdW50ICsgMTtcbiAgICBidXR0b24udGltZVVwID0gVGltZS5zdGFtcCgpO1xuICAgIGJ1dHRvbi52YWx1ZSA9IGZhbHNlO1xuICAgIGJ1dHRvbi5fZmlyc3QgPSB0cnVlO1xuXG4gICAgcmV0dXJuIGJ1dHRvbjtcbn07XG5cblxuQnV0dG9ucy5wcm90b3R5cGUudG9TWU5DID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0gdGhpcy5fU1lOQyk7XG4gICAgdmFyIGpzb25CdXR0b25zID0ganNvbi5idXR0b25zIHx8IChqc29uLmJ1dHRvbnMgPSBbXSksXG4gICAgICAgIGk7XG5cbiAgICBmb3IgKGkgPSB0aGlzLmxlbmd0aDsgaS0tOykganNvbkJ1dHRvbnNbaV0gPSB0aGlzW2ldLnRvU1lOQyhqc29uQnV0dG9uc1tpXSk7XG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbkJ1dHRvbnMucHJvdG90eXBlLmZyb21TWU5DID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICB2YXIgYnV0dG9uSGFzaCA9IHRoaXMuaGFzaCxcbiAgICAgICAganNvbkJ1dHRvbnMgPSBqc29uLmJ1dHRvbnMgfHwgKGpzb24uYnV0dG9ucyA9IFtdKSxcbiAgICAgICAgYnV0dG9uLCBqc29uQnV0dG9uLFxuICAgICAgICBpO1xuXG4gICAgZm9yIChpID0ganNvbkJ1dHRvbnMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgIGpzb25CdXR0b24gPSBqc29uQnV0dG9uc1tpXTtcblxuICAgICAgICBpZiAoKGJ1dHRvbiA9IGJ1dHRvbkhhc2hbanNvbkJ1dHRvbi5uYW1lXSkpIHtcbiAgICAgICAgICAgIGJ1dHRvbi5mcm9tU1lOQyhqc29uQnV0dG9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWRkKGpzb25CdXR0b24ubmFtZSkuZnJvbUpTT04oanNvbkJ1dHRvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuQnV0dG9ucy5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0ge30pO1xuICAgIHZhciBqc29uQnV0dG9ucyA9IGpzb24uYnV0dG9ucyB8fCAoanNvbi5idXR0b25zID0gW10pLFxuICAgICAgICBpO1xuXG4gICAgZm9yIChpID0gdGhpcy5sZW5ndGg7IGktLTspIGpzb25CdXR0b25zW2ldID0gdGhpc1tpXS50b0pTT04oanNvbkJ1dHRvbnNba2V5XSk7XG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbkJ1dHRvbnMucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICB2YXIgYnV0dG9uSGFzaCA9IHRoaXMuaGFzaCxcbiAgICAgICAganNvbkJ1dHRvbnMgPSBqc29uLmJ1dHRvbnMgfHwgKGpzb24uYnV0dG9ucyA9IFtdKSxcbiAgICAgICAgYnV0dG9uLCBqc29uQnV0dG9uLFxuICAgICAgICBpO1xuXG4gICAgZm9yIChpID0ganNvbkJ1dHRvbnMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgIGpzb25CdXR0b24gPSBqc29uQnV0dG9uc1tpXTtcblxuICAgICAgICBpZiAoKGJ1dHRvbiA9IGJ1dHRvbkhhc2hbanNvbkJ1dHRvbi5uYW1lXSkpIHtcbiAgICAgICAgICAgIGJ1dHRvbi5mcm9tSlNPTihqc29uQnV0dG9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWRkKGpzb25CdXR0b24ubmFtZSkuZnJvbUpTT04oanNvbkJ1dHRvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBCdXR0b25zO1xuIiwidmFyIEV2ZW50RW1pdHRlciA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2V2ZW50X2VtaXR0ZXJcIik7XG52YXIgRG9tID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvZG9tXCIpO1xudmFyIE9iamVjdFBvb2wgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9vYmplY3RfcG9vbFwiKTtcbnZhciBWZWMyID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjMlwiKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoXCIuL2lucHV0XCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIG1pbiA9IE1hdGgubWluLFxuICAgIG1heCA9IE1hdGgubWF4LFxuXG4gICAgYWRkRXZlbnQgPSBEb20uYWRkRXZlbnQsXG4gICAgcmVtb3ZlRXZlbnQgPSBEb20ucmVtb3ZlRXZlbnQ7XG5cblxuZnVuY3Rpb24gSGFuZGxlcigpIHtcblxuICAgIEV2ZW50RW1pdHRlci5jYWxsKHRoaXMpO1xuXG4gICAgdGhpcy5lbGVtZW50ID0gdW5kZWZpbmVkO1xufVxuXG5FdmVudEVtaXR0ZXIuZXh0ZW5kKEhhbmRsZXIpO1xuXG5cbkhhbmRsZXIucHJvdG90eXBlLnNldEVsZW1lbnQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgIGlmICh0aGlzLmVsZW1lbnQpIHRoaXMucmVtb3ZlRWxlbWVudCgpO1xuXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcblxuICAgIGFkZEV2ZW50KGVsZW1lbnQsIFwibW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3V0IG1vdXNld2hlZWwgRE9NTW91c2VTY3JvbGxcIiwgaGFuZGxlTW91c2UsIElucHV0KTtcbiAgICBhZGRFdmVudCh0b3AsIFwia2V5ZG93biBrZXl1cFwiLCBoYW5kbGVLZXlzLCBJbnB1dCk7XG5cbiAgICBhZGRFdmVudChlbGVtZW50LCBcInRvdWNoc3RhcnQgdG91Y2htb3ZlIHRvdWNoZW5kIHRvdWNoY2FuY2VsXCIsIGhhbmRsZVRvdWNoZXMsIElucHV0KTtcbiAgICBhZGRFdmVudCh3aW5kb3csIFwiZGV2aWNlbW90aW9uXCIsIGhhbmRsZURldmljZW1vdGlvbiwgSW5wdXQpO1xufTtcblxuXG5IYW5kbGVyLnByb3RvdHlwZS5yZW1vdmVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5lbGVtZW50KSByZXR1cm47XG4gICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XG5cbiAgICByZW1vdmVFdmVudChlbGVtZW50LCBcIm1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW91dCBtb3VzZXdoZWVsIERPTU1vdXNlU2Nyb2xsXCIsIGhhbmRsZU1vdXNlLCBJbnB1dCk7XG4gICAgcmVtb3ZlRXZlbnQodG9wLCBcImtleWRvd24ga2V5dXBcIiwgaGFuZGxlS2V5cywgSW5wdXQpO1xuXG4gICAgcmVtb3ZlRXZlbnQoZWxlbWVudCwgXCJ0b3VjaHN0YXJ0IHRvdWNobW92ZSB0b3VjaGVuZCB0b3VjaGNhbmNlbFwiLCBoYW5kbGVUb3VjaGVzLCBJbnB1dCk7XG4gICAgcmVtb3ZlRXZlbnQod2luZG93LCBcImRldmljZW1vdGlvblwiLCBoYW5kbGVEZXZpY2Vtb3Rpb24sIElucHV0KTtcblxuICAgIHRoaXMuZWxlbWVudCA9IHVuZGVmaW5lZDtcbn07XG5cblxuZnVuY3Rpb24gaGFuZGxlRGV2aWNlbW90aW9uKGUpIHtcbiAgICB2YXIgYWNjID0gZS5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5LFxuICAgICAgICBhY2NlbGVyYXRpb247XG5cbiAgICBpZiAoYWNjICYmIChhY2MueCB8fCBhY2MueSB8fCBhY2MueikpIHtcbiAgICAgICAgYWNjZWxlcmF0aW9uID0gdGhpcy5hY2NlbGVyYXRpb247XG5cbiAgICAgICAgYWNjZWxlcmF0aW9uLnggPSBhY2MueDtcbiAgICAgICAgYWNjZWxlcmF0aW9uLnkgPSBhY2MueTtcbiAgICAgICAgYWNjZWxlcmF0aW9uLnogPSBhY2MuejtcblxuICAgICAgICB0aGlzLmVtaXQoXCJhY2NlbGVyYXRpb25cIik7XG4gICAgfVxufVxuXG5cbmZ1bmN0aW9uIGhhbmRsZVRvdWNoZXMoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB2YXIgdHlwZSA9IGUudHlwZSxcbiAgICAgICAgdG91Y2hlcyA9IHRoaXMudG91Y2hlcyxcbiAgICAgICAgdGFyZ2V0VG91Y2hlcyA9IGUudGFyZ2V0VG91Y2hlcyxcbiAgICAgICAgY2hhbmdlZFRvdWNoZXMgPSBlLmNoYW5nZWRUb3VjaGVzLFxuICAgICAgICBpLCBpbDtcblxuICAgIGlmICh0eXBlID09PSBcInRvdWNoc3RhcnRcIikge1xuXG4gICAgICAgIGZvciAoaSA9IDAsIGlsID0gdGFyZ2V0VG91Y2hlcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB0aGlzLmVtaXQoXCJ0b3VjaHN0YXJ0XCIsIHRvdWNoZXMuc3RhcnQoaSwgdGFyZ2V0VG91Y2hlc1tpXSkpO1xuXG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcInRvdWNoZW5kXCIpIHtcblxuICAgICAgICBmb3IgKGkgPSAwLCBpbCA9IGNoYW5nZWRUb3VjaGVzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHRoaXMuZW1pdChcInRvdWNoZW5kXCIsIHRvdWNoZXMuZW5kKGkpKTtcblxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJ0b3VjaGNhbmNlbFwiKSB7XG5cbiAgICAgICAgdG91Y2hlcy5jYW5jZWwoKTtcbiAgICAgICAgdGhpcy5lbWl0KFwidG91Y2hjYW5jZWxcIik7XG5cbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwidG91Y2htb3ZlXCIpIHtcblxuICAgICAgICBpZiAodGhpcy50b3VjaGVzTW92ZU5lZWRzVXBkYXRlKSB7XG5cbiAgICAgICAgICAgIGZvciAoaSA9IDAsIGlsID0gY2hhbmdlZFRvdWNoZXMubGVuZ3RoOyBpIDwgaWw7IGkrKykgdGhpcy5lbWl0KFwidG91Y2htb3ZlXCIsIHRvdWNoZXMubW92ZShpLCBjaGFuZ2VkVG91Y2hlc1tpXSkpO1xuICAgICAgICAgICAgdGhpcy50b3VjaGVzTW92ZU5lZWRzVXBkYXRlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG59XG5cblxudmFyIG1vdXNlRmlyc3QgPSBmYWxzZSxcbiAgICBtb3VzZUxhc3QgPSBuZXcgVmVjMixcbiAgICBtb3VzZVdoZWVsID0gMDtcblxuZnVuY3Rpb24gaGFuZGxlTW91c2UoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB2YXIgdHlwZSA9IGUudHlwZSxcbiAgICAgICAgYnV0dG9uO1xuXG4gICAgaWYgKHR5cGUgPT09IFwibW91c2Vkb3duXCIpIHtcbiAgICAgICAgYnV0dG9uID0gTU9VU0VfQlVUVE9OU1tlLmJ1dHRvbl07XG5cbiAgICAgICAgdGhpcy5idXR0b25zLm9uKGJ1dHRvbik7XG4gICAgICAgIHVwZGF0ZU1vdXNlUG9zaXRpb24odGhpcywgZSk7XG4gICAgICAgIHRoaXMuZW1pdChcIm1vdXNlZG93blwiLCBidXR0b24pO1xuXG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcIm1vdXNldXBcIikge1xuICAgICAgICBidXR0b24gPSBNT1VTRV9CVVRUT05TW2UuYnV0dG9uXTtcblxuICAgICAgICB0aGlzLmJ1dHRvbnMub2ZmKGJ1dHRvbik7XG4gICAgICAgIHVwZGF0ZU1vdXNlUG9zaXRpb24odGhpcywgZSk7XG4gICAgICAgIHRoaXMuZW1pdChcIm1vdXNldXBcIiwgYnV0dG9uKTtcblxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJtb3VzZW91dFwiKSB7XG4gICAgICAgIGJ1dHRvbiA9IE1PVVNFX0JVVFRPTlNbZS5idXR0b25dO1xuXG4gICAgICAgIHRoaXMuYnV0dG9ucy5vZmYoYnV0dG9uKTtcbiAgICAgICAgdXBkYXRlTW91c2VQb3NpdGlvbih0aGlzLCBlKTtcbiAgICAgICAgdGhpcy5lbWl0KFwibW91c2VvdXRcIiwgYnV0dG9uKTtcblxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJtb3VzZXdoZWVsXCIgfHwgdHlwZSA9PT0gXCJET01Nb3VzZVNjcm9sbFwiKSB7XG5cbiAgICAgICAgbW91c2VXaGVlbCA9IG1heCgtMSwgbWluKDEsIChlLndoZWVsRGVsdGEgfHwgLWUuZGV0YWlsKSkpO1xuICAgICAgICB0aGlzLm1vdXNlV2hlZWwgPSBtb3VzZVdoZWVsO1xuICAgICAgICB0aGlzLmVtaXQoXCJtb3VzZXdoZWVsXCIsIG1vdXNlV2hlZWwpO1xuXG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcIm1vdXNlbW92ZVwiKSB7XG5cbiAgICAgICAgaWYgKHRoaXMubW91c2VNb3ZlTmVlZHNVcGRhdGUpIHtcblxuICAgICAgICAgICAgdXBkYXRlTW91c2VQb3NpdGlvbih0aGlzLCBlKTtcbiAgICAgICAgICAgIHRoaXMubW91c2VNb3ZlTmVlZHNVcGRhdGUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZW1pdChcIm1vdXNlbW92ZVwiKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG5mdW5jdGlvbiB1cGRhdGVNb3VzZVBvc2l0aW9uKGlucHV0LCBlKSB7XG4gICAgdmFyIHBvc2l0aW9uID0gaW5wdXQubW91c2VQb3NpdGlvbixcbiAgICAgICAgZGVsdGEgPSBpbnB1dC5tb3VzZURlbHRhLFxuICAgICAgICBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50LFxuICAgICAgICBvZmZzZXRYID0gZWxlbWVudC5vZmZzZXRMZWZ0IHx8IDAsXG4gICAgICAgIG9mZnNldFkgPSBlbGVtZW50Lm9mZnNldFRvcCB8fCAwLFxuICAgICAgICB4ID0gKGUucGFnZVggfHwgZS5jbGllbnRYKSAtIG9mZnNldFgsXG4gICAgICAgIHkgPSAoZS5wYWdlWSB8fCBlLmNsaWVudFkpIC0gb2Zmc2V0WTtcblxuICAgIG1vdXNlTGFzdC54ID0gbW91c2VGaXJzdCA/IHBvc2l0aW9uLnggOiB4O1xuICAgIG1vdXNlTGFzdC55ID0gbW91c2VGaXJzdCA/IHBvc2l0aW9uLnkgOiB5O1xuXG4gICAgcG9zaXRpb24ueCA9IHg7XG4gICAgcG9zaXRpb24ueSA9IHk7XG5cbiAgICBkZWx0YS54ID0gcG9zaXRpb24ueCAtIG1vdXNlTGFzdC54O1xuICAgIGRlbHRhLnkgPSBwb3NpdGlvbi55IC0gbW91c2VMYXN0Lnk7XG5cbiAgICBtb3VzZUZpcnN0ID0gdHJ1ZTtcbn1cblxuXG5mdW5jdGlvbiBoYW5kbGVLZXlzKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdmFyIHR5cGUgPSBlLnR5cGUsXG4gICAgICAgIGtleSA9IEtFWV9DT0RFU1tlLmtleUNvZGVdO1xuXG4gICAgaWYgKHR5cGUgPT09IFwia2V5ZG93blwiKSB7XG4gICAgICAgIHRoaXMuYnV0dG9ucy5vbihrZXkpO1xuICAgICAgICB0aGlzLmVtaXQoXCJrZXlkb3duXCIsIGtleSk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcImtleXVwXCIpIHtcbiAgICAgICAgdGhpcy5idXR0b25zLm9mZihrZXkpO1xuICAgICAgICB0aGlzLmVtaXQoXCJrZXl1cFwiLCBrZXkpO1xuICAgIH1cbn1cblxudmFyIE1PVVNFX0JVVFRPTlMgPSB7XG4gICAgXCIwXCI6IFwibW91c2UwXCIsXG4gICAgXCIxXCI6IFwibW91c2UxXCIsXG4gICAgXCIyXCI6IFwibW91c2UyXCJcbn1cblxudmFyIEtFWV9DT0RFUyA9IHtcbiAgICA4OiBcImJhY2tzcGFjZVwiLFxuICAgIDk6IFwidGFiXCIsXG4gICAgMTM6IFwiZW50ZXJcIixcbiAgICAxNjogXCJzaGlmdFwiLFxuICAgIDE3OiBcImN0cmxcIixcbiAgICAxODogXCJhbHRcIixcbiAgICAxOTogXCJwYXVzZVwiLFxuICAgIDIwOiBcImNhcHNsb2NrXCIsXG4gICAgMjc6IFwiZXNjYXBlXCIsXG4gICAgMzI6IFwic3BhY2VcIixcbiAgICAzMzogXCJwYWdldXBcIixcbiAgICAzNDogXCJwYWdlZG93blwiLFxuICAgIDM1OiBcImVuZFwiLFxuICAgIDM3OiBcImxlZnRcIixcbiAgICAzODogXCJ1cFwiLFxuICAgIDM5OiBcInJpZ2h0XCIsXG4gICAgNDA6IFwiZG93blwiLFxuICAgIDQ1OiBcImluc2VydFwiLFxuICAgIDQ2OiBcImRlbGV0ZVwiLFxuICAgIDExMjogXCJmMVwiLFxuICAgIDExMzogXCJmMlwiLFxuICAgIDExNDogXCJmM1wiLFxuICAgIDExNTogXCJmNFwiLFxuICAgIDExNjogXCJmNVwiLFxuICAgIDExNzogXCJmNlwiLFxuICAgIDExODogXCJmN1wiLFxuICAgIDExOTogXCJmOFwiLFxuICAgIDEyMDogXCJmOVwiLFxuICAgIDEyMTogXCJmMTBcIixcbiAgICAxMjI6IFwiZjExXCIsXG4gICAgMTIzOiBcImYxMlwiLFxuICAgIDE0NDogXCJudW1sb2NrXCIsXG4gICAgMTQ1OiBcInNjcm9sbGxvY2tcIixcbiAgICAxODY6IFwic2VtaWNvbG9uXCIsXG4gICAgMTg3OiBcImVxdWFsXCIsXG4gICAgMTg4OiBcImNvbW1hXCIsXG4gICAgMTg5OiBcImRhc2hcIixcbiAgICAxOTA6IFwicGVyaW9kXCIsXG4gICAgMTkxOiBcInNsYXNoXCIsXG4gICAgMTkyOiBcImdyYXZlYWNjZW50XCIsXG4gICAgMjE5OiBcIm9wZW5icmFja2V0XCIsXG4gICAgMjIwOiBcImJhY2tzbGFzaFwiLFxuICAgIDIyMTogXCJjbG9zZWJyYWtldFwiLFxuICAgIDIyMjogXCJzaW5nbGVxdW90ZVwiXG59O1xuXG5mb3IgKHZhciBpID0gNDg7IGkgPD0gOTA7IGkrKykgS0VZX0NPREVTW2ldID0gU3RyaW5nLmZyb21DaGFyQ29kZShpKS50b0xvd2VyQ2FzZSgpO1xuXG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IEhhbmRsZXI7XG4iLCJ2YXIgRXZlbnRFbWl0dGVyID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvZXZlbnRfZW1pdHRlclwiKTtcbnZhciBPYmplY3RQb29sID0gcmVxdWlyZShcIi4uLy4uL2Jhc2Uvb2JqZWN0X3Bvb2xcIik7XG52YXIgVGltZSA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL3RpbWVcIik7XG52YXIgTWF0aGYgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9tYXRoZlwiKTtcbnZhciBWZWMyID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjMlwiKTtcbnZhciBWZWMzID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjM1wiKTtcbnZhciBFbnVtcyA9IHJlcXVpcmUoXCIuLi9lbnVtc1wiKTtcbnZhciBCdXR0b25zID0gcmVxdWlyZShcIi4vYnV0dG9uc1wiKTtcbnZhciBCdXR0b24gPSByZXF1aXJlKFwiLi9idXR0b25cIik7XG52YXIgQXhlcyA9IHJlcXVpcmUoXCIuL2F4ZXNcIik7XG52YXIgQXhpcyA9IHJlcXVpcmUoXCIuL2F4aXNcIik7XG52YXIgVG91Y2hlcyA9IHJlcXVpcmUoXCIuL3RvdWNoZXNcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgYWJzID0gTWF0aC5hYnMsXG4gICAgc2lnbiA9IE1hdGhmLnNpZ24sXG4gICAgY2xhbXAgPSBNYXRoZi5jbGFtcCxcblxuICAgIEF4aXNUeXBlID0gRW51bXMuQXhpc1R5cGUsXG4gICAgTU9VU0VfQlVUVE9OUyA9IHtcbiAgICAgICAgXCIwXCI6IFwibW91c2UwXCIsXG4gICAgICAgIFwiMVwiOiBcIm1vdXNlMVwiLFxuICAgICAgICBcIjJcIjogXCJtb3VzZTJcIlxuICAgIH07XG5cblxuZnVuY3Rpb24gSW5wdXQoKSB7XG5cbiAgICBFdmVudEVtaXR0ZXIuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMuYXhlcyA9IG5ldyBBeGVzO1xuICAgIHRoaXMuYnV0dG9ucyA9IG5ldyBCdXR0b25zO1xuXG4gICAgdGhpcy5tb3VzZVdoZWVsID0gMDtcbiAgICB0aGlzLm1vdXNlUG9zaXRpb24gPSBuZXcgVmVjMjtcbiAgICB0aGlzLm1vdXNlRGVsdGEgPSBuZXcgVmVjMjtcbiAgICB0aGlzLm1vdXNlTW92ZU5lZWRzVXBkYXRlID0gZmFsc2U7XG5cbiAgICB0aGlzLnRvdWNoZXMgPSBuZXcgVG91Y2hlcztcbiAgICB0aGlzLnRvdWNoZXNNb3ZlTmVlZHNVcGRhdGUgPSBmYWxzZTtcbiAgICB0aGlzLmFjY2VsZXJhdGlvbiA9IG5ldyBWZWMzO1xuXG4gICAgdGhpcy5mcmFtZUNvdW50ID0gMDtcbiAgICB0aGlzLl9mcmFtZUNvdW50ID0gdW5kZWZpbmVkO1xuXG4gICAgdGhpcy50aW1lID0gMDtcbiAgICB0aGlzLl90aW1lID0gdW5kZWZpbmVkO1xuXG4gICAgdGhpcy5fU1lOQyA9IHt9O1xufVxuXG5FdmVudEVtaXR0ZXIuZXh0ZW5kKElucHV0KTtcblxuXG5JbnB1dC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBheGVzID0gdGhpcy5heGVzLFxuICAgICAgICBidXR0b25zID0gdGhpcy5idXR0b25zLmhhc2gsXG4gICAgICAgIGJ1dHRvbiwgYWx0QnV0dG9uLFxuICAgICAgICBheGlzLCB2YWx1ZSwgdHlwZSwgdG91Y2gsIHNlbnNpdGl2aXR5LCBwb3MsIG5lZywgdG1wLCBkdCA9IFRpbWUuZGVsdGEsXG4gICAgICAgIGk7XG5cbiAgICB0aGlzLmZyYW1lQ291bnQgPSB0aGlzLl9mcmFtZUNvdW50ID8gdGhpcy5fZnJhbWVDb3VudCA6IFRpbWUuZnJhbWVDb3VudDtcbiAgICB0aGlzLnRpbWUgPSB0aGlzLl90aW1lID8gdGhpcy5fdGltZSA6IFRpbWUuc3RhbXAoKTtcblxuICAgIHRoaXMubW91c2VNb3ZlTmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMudG91Y2hlc01vdmVOZWVkc1VwZGF0ZSA9IHRydWU7XG5cbiAgICBmb3IgKGkgPSBheGVzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICBheGlzID0gYXhlc1tpXTtcbiAgICAgICAgdmFsdWUgPSBheGlzLnZhbHVlO1xuICAgICAgICB0eXBlID0gYXhpcy50eXBlO1xuICAgICAgICBzZW5zaXRpdml0eSA9IGF4aXMuc2Vuc2l0aXZpdHk7XG5cbiAgICAgICAgaWYgKHR5cGUgPT09IEF4aXNUeXBlLkJ1dHRvbikge1xuICAgICAgICAgICAgYnV0dG9uID0gYnV0dG9uc1theGlzLm5lZ0J1dHRvbl07XG4gICAgICAgICAgICBhbHRCdXR0b24gPSBidXR0b25zW2F4aXMuYWx0TmVnQnV0dG9uXTtcbiAgICAgICAgICAgIG5lZyA9IGJ1dHRvbiAmJiBidXR0b24udmFsdWUgfHwgYWx0QnV0dG9uICYmIGFsdEJ1dHRvbi52YWx1ZTtcblxuICAgICAgICAgICAgYnV0dG9uID0gYnV0dG9uc1theGlzLnBvc0J1dHRvbl07XG4gICAgICAgICAgICBhbHRCdXR0b24gPSBidXR0b25zW2F4aXMuYWx0UG9zQnV0dG9uXTtcbiAgICAgICAgICAgIHBvcyA9IGJ1dHRvbiAmJiBidXR0b24udmFsdWUgfHwgYWx0QnV0dG9uICYmIGFsdEJ1dHRvbi52YWx1ZTtcblxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IEF4aXNUeXBlLk1vdXNlKSB7XG4gICAgICAgICAgICBheGlzLnZhbHVlID0gdGhpcy5tb3VzZURlbHRhW2F4aXMuYXhpc107XG4gICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IEF4aXNUeXBlLlRvdWNoKSB7XG4gICAgICAgICAgICB0b3VjaCA9IHRoaXMudG91Y2hlc1theGlzLmluZGV4XTtcblxuICAgICAgICAgICAgaWYgKHRvdWNoKSB7XG4gICAgICAgICAgICAgICAgYXhpcy52YWx1ZSA9IHRvdWNoLmRlbHRhW2F4aXMuYXhpc107XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IEF4aXNUeXBlLk1vdXNlV2hlZWwpIHtcbiAgICAgICAgICAgIHZhbHVlICs9IHRoaXMubW91c2VXaGVlbDtcblxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IEF4aXNUeXBlLkpveXN0aWNrKSB7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChuZWcpIHZhbHVlIC09IHNlbnNpdGl2aXR5ICogZHQ7XG4gICAgICAgIGlmIChwb3MpIHZhbHVlICs9IHNlbnNpdGl2aXR5ICogZHQ7XG5cbiAgICAgICAgaWYgKCFwb3MgJiYgIW5lZyAmJiB2YWx1ZSAhPT0gMCkge1xuICAgICAgICAgICAgdG1wID0gYWJzKHZhbHVlKTtcbiAgICAgICAgICAgIHZhbHVlIC09IGNsYW1wKHNpZ24odmFsdWUpICogYXhpcy5ncmF2aXR5ICogZHQsIC10bXAsIHRtcCk7XG4gICAgICAgIH1cblxuICAgICAgICB2YWx1ZSA9IGNsYW1wKHZhbHVlLCAtMSwgMSk7XG4gICAgICAgIGlmIChhYnModmFsdWUpIDw9IGF4aXMuZGVhZCkgdmFsdWUgPSAwO1xuXG4gICAgICAgIGF4aXMudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICB0aGlzLm1vdXNlV2hlZWwgPSAwO1xufTtcblxuXG5JbnB1dC5wcm90b3R5cGUuYXhpcyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdmFyIGF4aXMgPSB0aGlzLmF4ZXMuaGFzaFtuYW1lXTtcbiAgICByZXR1cm4gYXhpcyA/IGF4aXMudmFsdWUgOiAwO1xufTtcblxuXG5JbnB1dC5wcm90b3R5cGUubW91c2VCdXR0b24gPSBmdW5jdGlvbiAoaWQpIHtcbiAgICB2YXIgYnV0dG9uID0gdGhpcy5idXR0b25zLmhhc2hbTU9VU0VfQlVUVE9OU1tpZF1dO1xuXG4gICAgcmV0dXJuIGJ1dHRvbiAmJiBidXR0b24udmFsdWU7XG59O1xuXG5cbklucHV0LnByb3RvdHlwZS5tb3VzZUJ1dHRvbkRvd24gPSBmdW5jdGlvbiAoaWQpIHtcbiAgICB2YXIgYnV0dG9uID0gdGhpcy5idXR0b25zLmhhc2hbTU9VU0VfQlVUVE9OU1tpZF1dO1xuXG4gICAgcmV0dXJuIGJ1dHRvbiAmJiBidXR0b24udmFsdWUgJiYgKGJ1dHRvbi5mcmFtZURvd24gPj0gdGhpcy5mcmFtZUNvdW50KTtcbn07XG5cblxuSW5wdXQucHJvdG90eXBlLm1vdXNlQnV0dG9uVXAgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICB2YXIgYnV0dG9uID0gdGhpcy5idXR0b25zLmhhc2hbTU9VU0VfQlVUVE9OU1tpZF1dO1xuXG4gICAgcmV0dXJuIGJ1dHRvbiAmJiAoYnV0dG9uLmZyYW1lVXAgPj0gdGhpcy5mcmFtZUNvdW50KVxufTtcblxuXG5JbnB1dC5wcm90b3R5cGUuYW55S2V5ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBidXR0b25zID0gdGhpcy5idXR0b25zLFxuICAgICAgICBpO1xuXG4gICAgZm9yIChpID0gYnV0dG9ucy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgaWYgKGJ1dHRvbnNbaV0udmFsdWUpIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5cbklucHV0LnByb3RvdHlwZS5hbnlLZXlEb3duID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBidXR0b25zID0gdGhpcy5idXR0b25zLFxuICAgICAgICBidXR0b24sXG4gICAgICAgIGk7XG5cbiAgICBmb3IgKGkgPSBidXR0b25zLmxlbmd0aDsgaS0tOykge1xuICAgICAgICBpZiAoKGJ1dHRvbiA9IGJ1dHRvbnNbaV0pLnZhbHVlICYmIChidXR0b24uZnJhbWVEb3duID49IHRoaXMuZnJhbWVDb3VudCkpIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5cbklucHV0LnByb3RvdHlwZS5rZXkgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHZhciBidXR0b24gPSB0aGlzLmJ1dHRvbnMuaGFzaFtuYW1lXTtcblxuICAgIHJldHVybiBidXR0b24gJiYgYnV0dG9uLnZhbHVlO1xufTtcblxuXG5JbnB1dC5wcm90b3R5cGUua2V5RG93biA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdmFyIGJ1dHRvbiA9IHRoaXMuYnV0dG9ucy5oYXNoW25hbWVdO1xuXG4gICAgcmV0dXJuIGJ1dHRvbiAmJiBidXR0b24udmFsdWUgJiYgKGJ1dHRvbi5mcmFtZURvd24gPj0gdGhpcy5mcmFtZUNvdW50KTtcbn07XG5cblxuSW5wdXQucHJvdG90eXBlLmtleVVwID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB2YXIgYnV0dG9uID0gdGhpcy5idXR0b25zLmhhc2hbbmFtZV07XG5cbiAgICByZXR1cm4gYnV0dG9uICYmIChidXR0b24uZnJhbWVVcCA+PSB0aGlzLmZyYW1lQ291bnQpO1xufTtcblxuXG5JbnB1dC5wcm90b3R5cGUudG9TWU5DID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0gdGhpcy5fU1lOQyk7XG5cbiAgICBqc29uLl9mcmFtZUNvdW50ID0gVGltZS5mcmFtZUNvdW50O1xuICAgIGpzb24uX3RpbWUgPSBUaW1lLnN0YW1wKCk7XG5cbiAgICBqc29uLmJ1dHRvbnMgPSB0aGlzLmJ1dHRvbnMudG9TWU5DKGpzb24uYnV0dG9ucyk7XG5cbiAgICBqc29uLm1vdXNlUG9zaXRpb24gPSB0aGlzLm1vdXNlUG9zaXRpb24udG9KU09OKGpzb24ubW91c2VQb3NpdGlvbik7XG4gICAganNvbi5tb3VzZURlbHRhID0gdGhpcy5tb3VzZURlbHRhLnRvSlNPTihqc29uLm1vdXNlRGVsdGEpO1xuXG4gICAganNvbi5hY2NlbGVyYXRpb24gPSB0aGlzLmFjY2VsZXJhdGlvbi50b0pTT04oanNvbi5hY2NlbGVyYXRpb24pO1xuICAgIGpzb24udG91Y2hlcyA9IHRoaXMudG91Y2hlcy50b1NZTkMoanNvbi50b3VjaGVzKTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5JbnB1dC5wcm90b3R5cGUuZnJvbVNZTkMgPSBmdW5jdGlvbiAoanNvbikge1xuXG4gICAgdGhpcy5fZnJhbWVDb3VudCA9IGpzb24uX2ZyYW1lQ291bnQ7XG4gICAgdGhpcy5fdGltZSA9IGpzb24uX3RpbWU7XG5cbiAgICB0aGlzLmJ1dHRvbnMuZnJvbVNZTkMoanNvbi5idXR0b25zKTtcblxuICAgIHRoaXMubW91c2VQb3NpdGlvbi5mcm9tSlNPTihqc29uLm1vdXNlUG9zaXRpb24pO1xuICAgIHRoaXMubW91c2VEZWx0YS5mcm9tSlNPTihqc29uLm1vdXNlRGVsdGEpO1xuXG4gICAgdGhpcy5hY2NlbGVyYXRpb24uZnJvbUpTT04oanNvbi5hY2NlbGVyYXRpb24pO1xuICAgIHRoaXMudG91Y2hlcy5mcm9tU1lOQyhqc29uLnRvdWNoZXMpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbklucHV0LnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gfHwgKGpzb24gPSB7fSk7XG5cbiAgICBqc29uLmJ1dHRvbnMgPSB0aGlzLmJ1dHRvbnMudG9KU09OKGpzb24uYnV0dG9ucyk7XG4gICAganNvbi5heGVzID0gdGhpcy5heGVzLnRvSlNPTihqc29uLmF4ZXMpO1xuXG4gICAganNvbi5tb3VzZVBvc2l0aW9uID0gdGhpcy5tb3VzZVBvc2l0aW9uLnRvSlNPTihqc29uLm1vdXNlUG9zaXRpb24pO1xuICAgIGpzb24ubW91c2VEZWx0YSA9IHRoaXMubW91c2VEZWx0YS50b0pTT04oanNvbi5tb3VzZURlbHRhKTtcblxuICAgIGpzb24uYWNjZWxlcmF0aW9uID0gdGhpcy5hY2NlbGVyYXRpb24udG9KU09OKGpzb24uYWNjZWxlcmF0aW9uKTtcbiAgICBqc29uLnRvdWNoZXMgPSB0aGlzLnRvdWNoZXMudG9KU09OKGpzb24udG91Y2hlcyk7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuSW5wdXQucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcblxuICAgIHRoaXMuYnV0dG9ucy5mcm9tSlNPTihqc29uLmJ1dHRvbnMpO1xuICAgIHRoaXMuYXhlcy5mcm9tSlNPTihqc29uLmF4ZXMpO1xuXG4gICAgdGhpcy5tb3VzZVBvc2l0aW9uLmZyb21KU09OKGpzb24ubW91c2VQb3NpdGlvbik7XG4gICAgdGhpcy5tb3VzZURlbHRhLmZyb21KU09OKGpzb24ubW91c2VEZWx0YSk7XG5cbiAgICB0aGlzLmFjY2VsZXJhdGlvbi5mcm9tSlNPTihqc29uLmFjY2VsZXJhdGlvbik7XG4gICAgdGhpcy50b3VjaGVzLmZyb21KU09OKGpzb24udG91Y2hlcyk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBuZXcgSW5wdXQ7XG4iLCJ2YXIgVmVjMiA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3ZlYzJcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBUb3VjaCgpIHtcblxuICAgIHRoaXMuaWQgPSAtMTtcblxuICAgIHRoaXMucmFkaXVzWCA9IDA7XG4gICAgdGhpcy5yYWRpdXNZID0gMDtcbiAgICB0aGlzLnJvdGF0aW9uQW5nbGUgPSAwO1xuICAgIHRoaXMuZm9yY2UgPSAwO1xuXG4gICAgdGhpcy5kZWx0YSA9IG5ldyBWZWMyO1xuICAgIHRoaXMucG9zaXRpb24gPSBuZXcgVmVjMjtcblxuICAgIHRoaXMuX2xhc3QgPSBuZXcgVmVjMjtcbiAgICB0aGlzLl9maXJzdCA9IGZhbHNlO1xuXG4gICAgdGhpcy5fU1lOQyA9IHt9O1xufTtcblxuXG5Ub3VjaC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLmlkID0gLTE7XG5cbiAgICB0aGlzLnBvc2l0aW9uLnNldCgwLCAwKTtcbiAgICB0aGlzLmRlbHRhLnNldCgwLCAwKTtcbiAgICB0aGlzLl9sYXN0LnNldCgwLCAwKTtcblxuICAgIHRoaXMucmFkaXVzWCA9IDA7XG4gICAgdGhpcy5yYWRpdXNZID0gMDtcbiAgICB0aGlzLnJvdGF0aW9uQW5nbGUgPSAwO1xuICAgIHRoaXMuZm9yY2UgPSAwO1xuXG4gICAgdGhpcy5fZmlyc3QgPSBmYWxzZTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5Ub3VjaC5wcm90b3R5cGUuZnJvbUV2ZW50ID0gZnVuY3Rpb24gKGUpIHtcbiAgICB2YXIgcG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uLFxuICAgICAgICBkZWx0YSA9IHRoaXMuZGVsdGEsXG4gICAgICAgIGxhc3QgPSB0aGlzLl9sYXN0LFxuICAgICAgICBmaXJzdCA9IHRoaXMuX2ZpcnN0LFxuICAgICAgICBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50LFxuICAgICAgICBvZmZzZXRYID0gZWxlbWVudC5vZmZzZXRMZWZ0LFxuICAgICAgICBvZmZzZXRZID0gZWxlbWVudC5vZmZzZXRUb3AsXG4gICAgICAgIHggPSAoZS5wYWdlWCB8fCBlLmNsaWVudFgpIC0gb2Zmc2V0WCxcbiAgICAgICAgeSA9IChlLnBhZ2VZIHx8IGUuY2xpZW50WSkgLSBvZmZzZXRZO1xuXG4gICAgbGFzdC54ID0gZmlyc3QgPyBwb3NpdGlvbi54IDogeDtcbiAgICBsYXN0LnkgPSBmaXJzdCA/IHBvc2l0aW9uLnkgOiB5O1xuXG4gICAgcG9zaXRpb24ueCA9IHg7XG4gICAgcG9zaXRpb24ueSA9IHk7XG5cbiAgICBkZWx0YS54ID0gcG9zaXRpb24ueCAtIGxhc3QueDtcbiAgICBkZWx0YS55ID0gcG9zaXRpb24ueSAtIGxhc3QueTtcblxuICAgIHRoaXMucmFkaXVzWCA9IChlLnJhZGl1c1ggfHwgZS53ZWJraXRSYWRpdXNYIHx8IGUubW96UmFkaXVzWCB8fCBlLm9SYWRpdXNYIHx8IGUubXNSYWRpdXNYIHx8IDEpO1xuICAgIHRoaXMucmFkaXVzWSA9IChlLnJhZGl1c1kgfHwgZS53ZWJraXRSYWRpdXNZIHx8IGUubW96UmFkaXVzWSB8fCBlLm9SYWRpdXNZIHx8IGUubXNSYWRpdXNZIHx8IDEpO1xuICAgIHRoaXMucm90YXRpb25BbmdsZSA9IChlLnJvdGF0aW9uQW5nbGUgfHwgZS53ZWJraXRSb3RhdGlvbkFuZ2xlIHx8IGUubW96Um90YXRpb25BbmdsZSB8fCBlLm9Sb3RhdGlvbkFuZ2xlIHx8IGUubXNSb3RhdGlvbkFuZ2xlIHx8IDApO1xuICAgIHRoaXMuZm9yY2UgPSAoZS5mb3JjZSB8fCBlLndlYmtpdEZvcmNlIHx8IGUubW96Rm9yY2UgfHwgZS5vRm9yY2UgfHwgZS5tc0ZvcmNlIHx8IDEpO1xuXG4gICAgdGhpcy5fZmlyc3QgPSB0cnVlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblRvdWNoLnByb3RvdHlwZS50b1NZTkMgPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gfHwgKGpzb24gPSB0aGlzLl9TWU5DKTtcblxuICAgIGpzb24uaWQgPSB0aGlzLmlkO1xuXG4gICAganNvbi5kZWx0YSA9IHRoaXMuZGVsdGEudG9KU09OKGpzb24uZGVsdGEpO1xuICAgIGpzb24ucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uLnRvSlNPTihqc29uLnBvc2l0aW9uKTtcblxuICAgIGpzb24uX2xhc3QgPSB0aGlzLl9sYXN0LnRvSlNPTihqc29uLl9sYXN0KTtcbiAgICBqc29uLl9maXJzdCA9IHRoaXMuX2ZpcnN0O1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cblRvdWNoLnByb3RvdHlwZS5mcm9tU1lOQyA9IGZ1bmN0aW9uIChqc29uKSB7XG5cbiAgICB0aGlzLmlkID0ganNvbi5pZDtcblxuICAgIHRoaXMuZGVsdGEuZnJvbUpTT04oanNvbi5kZWx0YSk7XG4gICAgdGhpcy5wb3NpdGlvbi5mcm9tSlNPTihqc29uLnBvc2l0aW9uKTtcblxuICAgIHRoaXMuX2xhc3QuZnJvbUpTT04oanNvbi5fbGFzdCk7XG4gICAgdGhpcy5fZmlyc3QgPSBqc29uLl9maXJzdDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5Ub3VjaC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0ge30pO1xuXG4gICAganNvbi5pZCA9IHRoaXMuaWQ7XG5cbiAgICBqc29uLmRlbHRhID0gdGhpcy5kZWx0YS50b0pTT04oanNvbi5kZWx0YSk7XG4gICAganNvbi5wb3NpdGlvbiA9IHRoaXMucG9zaXRpb24udG9KU09OKGpzb24ucG9zaXRpb24pO1xuXG4gICAganNvbi5fbGFzdCA9IHRoaXMuX2xhc3QudG9KU09OKGpzb24uX2xhc3QpO1xuICAgIGpzb24uX2ZpcnN0ID0gdGhpcy5fZmlyc3Q7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuVG91Y2gucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICB0aGlzLmlkID0ganNvbi5pZDtcblxuICAgIHRoaXMuZGVsdGEuZnJvbUpTT04oanNvbi5kZWx0YSk7XG4gICAgdGhpcy5wb3NpdGlvbi5mcm9tSlNPTihqc29uLnBvc2l0aW9uKTtcblxuICAgIHRoaXMuX2xhc3QuZnJvbUpTT04oanNvbi5fbGFzdCk7XG4gICAgdGhpcy5fZmlyc3QgPSBqc29uLl9maXJzdDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFRvdWNoO1xuIiwidmFyIE9iamVjdFBvb2wgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9vYmplY3RfcG9vbFwiKTtcbnZhciBUb3VjaCA9IHJlcXVpcmUoXCIuL3RvdWNoXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIFRPVUNIX1BPT0wgPSBuZXcgT2JqZWN0UG9vbChUb3VjaCksXG4gICAgT0JKRUNUX1BPT0wgPSBuZXcgT2JqZWN0UG9vbChPYmplY3QpO1xuXG5cbmZ1bmN0aW9uIFRvdWNoZXMoKSB7XG5cbiAgICBBcnJheS5jYWxsKHRoaXMpO1xuICAgIHRoaXMuX1NZTkMgPSB7fTtcbn1cblxuVG91Y2hlcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEFycmF5LnByb3RvdHlwZSk7XG5Ub3VjaGVzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFRvdWNoZXM7XG5Ub3VjaGVzLlRPVUNIX1BPT0wgPSBUT1VDSF9QT09MO1xuXG5cblRvdWNoZXMucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKGluZGV4LCB0YXJnZXRUb3VjaCkge1xuICAgIHZhciB0b3VjaCA9IFRPVUNIX1BPT0wuY3JlYXRlKCk7XG5cbiAgICB0b3VjaC5jbGVhcigpO1xuICAgIHRvdWNoLmlkID0gdGFyZ2V0VG91Y2guaWRlbnRpZmllcjtcbiAgICB0b3VjaC5mcm9tRXZlbnQodGFyZ2V0VG91Y2gpO1xuXG4gICAgdGhpcy5wdXNoKHRvdWNoKTtcblxuICAgIHJldHVybiB0b3VjaDtcbn07XG5cblxuVG91Y2hlcy5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgdmFyIHRvdWNoID0gdGhpc1tpbmRleF07XG5cbiAgICBUT1VDSF9QT09MLnJlbW92ZU9iamVjdCh0b3VjaCk7XG4gICAgdGhpcy5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgcmV0dXJuIHRvdWNoO1xufTtcblxuXG5Ub3VjaGVzLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICBUT1VDSF9QT09MLmNsZWFyKCk7XG4gICAgdGhpcy5sZW5ndGggPSAwO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblRvdWNoZXMucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbiAoaW5kZXgsIHRhcmdldFRvdWNoKSB7XG4gICAgdmFyIHRvdWNoID0gdGhpc1tpbmRleF07XG5cbiAgICB0b3VjaC5mcm9tRXZlbnQodGFyZ2V0VG91Y2gpO1xuXG4gICAgcmV0dXJuIHRvdWNoO1xufTtcblxuXG5Ub3VjaGVzLnByb3RvdHlwZS50b1NZTkMgPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gfHwgKGpzb24gPSB0aGlzLl9TWU5DKTtcbiAgICB2YXIganNvblRvdWNoZXMgPSBqc29uLnRvdWNoZXMgfHwgKGpzb24udG91Y2hlcyA9IFtdKSxcbiAgICAgICAgaSA9IHRoaXMubGVuZ3RoO1xuXG4gICAganNvblRvdWNoZXMubGVuZ3RoID0gMDtcbiAgICBPQkpFQ1RfUE9PTC5jbGVhcigpO1xuXG4gICAgd2hpbGUgKGktLSkganNvblRvdWNoZXNbaV0gPSB0aGlzW2ldLnRvU1lOQyhPQkpFQ1RfUE9PTC5jcmVhdGUoKSk7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuVG91Y2hlcy5wcm90b3R5cGUuZnJvbVNZTkMgPSBmdW5jdGlvbiAoanNvbikge1xuICAgIHZhciBqc29uVG91Y2hlcyA9IGpzb24udG91Y2hlcyxcbiAgICAgICAgaSA9IGpzb25Ub3VjaGVzLmxlbmd0aDtcblxuICAgIHRoaXMubGVuZ3RoID0gMDtcbiAgICBUT1VDSF9QT09MLmNsZWFyKCk7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzW2ldID0gVE9VQ0hfUE9PTC5jcmVhdGUoKS5mcm9tU1lOQyhqc29uVG91Y2hlc1tpXSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuVG91Y2hlcy5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0ge30pO1xuICAgIHZhciBqc29uVG91Y2hlcyA9IGpzb24udG91Y2hlcyB8fCAoanNvbi50b3VjaGVzID0gW10pLFxuICAgICAgICBpO1xuXG4gICAgZm9yIChpID0gdGhpcy5sZW5ndGg7IGktLTspIGpzb25Ub3VjaGVzW2ldID0gdGhpc1tpXS50b0pTT04oanNvblRvdWNoZXNbaV0pO1xuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5Ub3VjaGVzLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgdmFyIGpzb25Ub3VjaGVzID0ganNvbi50b3VjaGVzLFxuICAgICAgICB0b3VjaCwgaSwgaiwgdGw7XG5cbiAgICBmb3IgKGkgPSBqc29uVG91Y2hlcy5sZW5ndGgsIHRsID0gdGhpcy5sZW5ndGgsIGogPSB0bDsgaS0tOykge1xuICAgICAgICBpZiAoaSA8IHRsKSB7XG4gICAgICAgICAgICB0aGlzLnNwbGljZShqLS0sIDEpO1xuICAgICAgICAgICAgVE9VQ0hfUE9PTC5yZW1vdmVPYmplY3QodGhpc1tqXSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoKHRvdWNoID0gdGhpc1tpXSkpIHtcbiAgICAgICAgICAgIHRvdWNoLmZyb21KU09OKGpzb25Ub3VjaGVzW2ldKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXNbaV0gPSBUT1VDSF9QT09MLmNyZWF0ZSgpLmZyb21KU09OKGpzb25Ub3VjaGVzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFRvdWNoZXM7XG4iLCJ2YXIgQ2xhc3MgPSByZXF1aXJlKFwiLi4vYmFzZS9jbGFzc1wiKTtcbnZhciBPYmplY3RQb29sID0gcmVxdWlyZShcIi4uL2Jhc2Uvb2JqZWN0X3Bvb2xcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBQcmVmYWIob2JqZWN0KSB7XG5cbiAgICBDbGFzcy5jYWxsKHRoaXMpO1xuXG4gICAgdGhpcy5vYmplY3QgPSBvYmplY3QudG9KU09OKCk7XG4gICAgdGhpcy5vYmplY3RQb29sID0gbmV3IE9iamVjdFBvb2wob2JqZWN0LmNvbnN0cnVjdG9yKTtcbn1cblxuQ2xhc3MuZXh0ZW5kKFByZWZhYik7XG5cblxuUHJlZmFiLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9iamVjdCA9IHRoaXMub2JqZWN0UG9vbC5jcmVhdGUoKTtcblxuICAgIG9iamVjdC5mcm9tSlNPTih0aGlzLm9iamVjdCk7XG4gICAgb2JqZWN0Lm9uKFwicmVtb3ZlXCIsIG9uUmVtb3ZlLCB0aGlzKTtcblxuICAgIHJldHVybiBvYmplY3Q7XG59O1xuXG5cblByZWZhYi5wcm90b3R5cGUuc2V0T2JqZWN0ID0gZnVuY3Rpb24gKG9iamVjdCkge1xuXG4gICAgdGhpcy5vYmplY3QgPSBvYmplY3QudG9KU09OKCk7XG4gICAgdGhpcy5vYmplY3RQb29sID0gbmV3IE9iamVjdFBvb2wob2JqZWN0LmNvbnN0cnVjdG9yKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5QcmVmYWIucHJvdG90eXBlLmVtcHR5ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5vYmplY3RQb29sLmVtcHR5KCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuUHJlZmFiLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDbGFzcy5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICBqc29uLm9iamVjdCA9IHRoaXMub2JqZWN0O1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cblByZWZhYi5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENsYXNzLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy5vYmplY3QgPSBqc29uLm9iamVjdDtcbiAgICB0aGlzLm9iamVjdFBvb2wgPSBuZXcgT2JqZWN0UG9vbChDbGFzcy5fY2xhc3Nlc1tqc29uLm9iamVjdC5fY2xhc3NOYW1lXSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuZnVuY3Rpb24gb25SZW1vdmUob2JqZWN0KSB7XG5cbiAgICB0aGlzLm9iamVjdFBvb2wucmVtb3ZlT2JqZWN0KG9iamVjdCk7XG4gICAgb2JqZWN0Lm9mZihcInJlbW92ZVwiLCBvblJlbW92ZSwgdGhpcyk7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUHJlZmFiO1xuIiwidmFyIEV2ZW50RW1pdHRlciA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2V2ZW50X2VtaXR0ZXJcIik7XG52YXIgRGV2aWNlID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvZGV2aWNlXCIpO1xudmFyIERvbSA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2RvbVwiKTtcbnZhciBDb25maWcgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9jb25maWdcIik7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGFkZEV2ZW50ID0gRG9tLmFkZEV2ZW50LFxuICAgIHJlbW92ZUV2ZW50ID0gRG9tLnJlbW92ZUV2ZW50LFxuICAgIGFkZE1ldGEgPSBEb20uYWRkTWV0YSxcbiAgICBmbG9vciA9IE1hdGguZmxvb3IsXG5cbiAgICBDQU5WQVNfSUQgPSAwLFxuICAgIFNDQUxFX1JFRyA9IC8tc2NhbGVcXHMgKj1cXHMqWy4wLTldKy9nLFxuICAgIENBTlZBU19TVFlMRSA9IFtcbiAgICAgICAgXCJwb3NpdGlvbjogZml4ZWQ7XCIsXG4gICAgICAgIFwidG9wOiA1MCU7XCIsXG4gICAgICAgIFwibGVmdDogNTAlO1wiLFxuICAgICAgICBcInBhZGRpbmc6IDBweDtcIixcbiAgICAgICAgXCJtYXJnaW46IDBweDtcIlxuICAgIF0uam9pbihcIlxcblwiKSxcbiAgICBWSUVXUE9SVCwgVklFV1BPUlRfV0lEVEgsIFZJRVdQT1JUX0hFSUdIVCwgVklFV1BPUlRfU0NBTEU7XG5cbmFkZE1ldGEoXCJ2aWV3cG9ydFwiLCBcInZpZXdwb3J0XCIsIFwiaW5pdGlhbC1zY2FsZT0xLCBtaW5pbXVtLXNjYWxlPTEsIG1heGltdW0tc2NhbGU9MSwgdXNlci1zY2FsYWJsZT1ub1wiKTtcbmFkZE1ldGEoXCJ2aWV3cG9ydC13aWR0aFwiLCBcInZpZXdwb3J0XCIsIFwid2lkdGg9ZGV2aWNlLXdpZHRoXCIpO1xuYWRkTWV0YShcInZpZXdwb3J0LWhlaWdodFwiLCBcInZpZXdwb3J0XCIsIFwiaGVpZ2h0PWRldmljZS1oZWlnaHRcIik7XG5cblZJRVdQT1JUID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWV3cG9ydFwiKTtcblZJRVdQT1JUX1dJRFRIID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWV3cG9ydC13aWR0aFwiKTtcblZJRVdQT1JUX0hFSUdIVCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlld3BvcnQtaGVpZ2h0XCIpO1xuVklFV1BPUlRfU0NBTEUgPSBWSUVXUE9SVC5nZXRBdHRyaWJ1dGUoXCJjb250ZW50XCIpO1xuXG5mdW5jdGlvbiB3aW5kb3dPblJlc2l6ZSgpIHtcbiAgICBWSUVXUE9SVC5zZXRBdHRyaWJ1dGUoXCJjb250ZW50XCIsIFZJRVdQT1JUX1NDQUxFLnJlcGxhY2UoU0NBTEVfUkVHLCBcIi1zY2FsZT1cIiArIERldmljZS5pbnZQaXhlbFJhdGlvKSk7XG4gICAgVklFV1BPUlRfV0lEVEguc2V0QXR0cmlidXRlKFwiY29udGVudFwiLCBcIndpZHRoPVwiICsgd2luZG93LmlubmVyV2lkdGgpO1xuICAgIFZJRVdQT1JUX0hFSUdIVC5zZXRBdHRyaWJ1dGUoXCJjb250ZW50XCIsIFwiaGVpZ2h0PVwiICsgd2luZG93LmlubmVySGVpZ2h0KTtcbiAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMSk7XG59XG5cbmFkZEV2ZW50KHdpbmRvdywgXCJyZXNpemUgb3JpZW50YXRpb25jaGFuZ2VcIiwgd2luZG93T25SZXNpemUpO1xud2luZG93T25SZXNpemUoKTtcblxuLyoqXG4gKiBAY2xhc3MgQ2FudmFzXG4gKiBAZXh0ZW5kcyBFdmVudEVtaXR0ZXJcbiAqIEBicmllZiBjYW52YXMgaGVscGVyXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICovXG5cbmZ1bmN0aW9uIENhbnZhcyhvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIEV2ZW50RW1pdHRlci5jYWxsKHRoaXMpO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciBjYW52YXNJZFxuICAgICAqIEBtZW1iZXJvZiBDYW52YXNcbiAgICAgKi9cbiAgICB0aGlzLmNhbnZhc0lkID0gKytDQU5WQVNfSUQ7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgQm9vbGVhbiBmdWxsU2NyZWVuXG4gICAgICogQG1lbWJlcm9mIENhbnZhc1xuICAgICAqL1xuICAgIHRoaXMuZnVsbFNjcmVlbiA9IG9wdHMuZnVsbFNjcmVlbiA/IG9wdHMuZnVsbFNjcmVlbiA6IChvcHRzLndpZHRoID09IHVuZGVmaW5lZCAmJiBvcHRzLmhlaWdodCA9PSB1bmRlZmluZWQpID8gdHJ1ZSA6IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IFN0cmluZyBjdXN0b21DdXJzb3JcbiAgICAgKiBAbWVtYmVyb2YgQ2FudmFzXG4gICAgICovXG4gICAgdGhpcy5jdXN0b21DdXJzb3IgPSBvcHRzLmN1c3RvbUN1cnNvciAhPSB1bmRlZmluZWQgPyBvcHRzLmN1c3RvbUN1cnNvciA6IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IEJvb2xlYW4gaGlkZU1vdXNlXG4gICAgICogQG1lbWJlcm9mIENhbnZhc1xuICAgICAqL1xuICAgIHRoaXMuaGlkZU1vdXNlID0gb3B0cy5oaWRlTW91c2UgIT0gdW5kZWZpbmVkID8gb3B0cy5oaWRlTW91c2UgOiBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBOdW1iZXIgd2lkdGhcbiAgICAgKiBAbWVtYmVyb2YgQ2FudmFzXG4gICAgICovXG4gICAgdGhpcy53aWR0aCA9IG9wdHMud2lkdGggIT0gdW5kZWZpbmVkID8gb3B0cy53aWR0aCA6IHdpbmRvdy5pbm5lcldpZHRoO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciBoZWlnaHRcbiAgICAgKiBAbWVtYmVyb2YgQ2FudmFzXG4gICAgICovXG4gICAgdGhpcy5oZWlnaHQgPSBvcHRzLmhlaWdodCAhPSB1bmRlZmluZWQgPyBvcHRzLmhlaWdodCA6IHdpbmRvdy5pbm5lckhlaWdodDtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBOdW1iZXIgYXNwZWN0XG4gICAgICogQG1lbWJlcm9mIENhbnZhc1xuICAgICAqL1xuICAgIHRoaXMuYXNwZWN0ID0gdGhpcy53aWR0aCAvIHRoaXMuaGVpZ2h0O1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciBwaXhlbFdpZHRoXG4gICAgICogQG1lbWJlcm9mIENhbnZhc1xuICAgICAqL1xuICAgIHRoaXMucGl4ZWxXaWR0aCA9IHRoaXMud2lkdGg7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIHBpeGVsSGVpZ2h0XG4gICAgICogQG1lbWJlcm9mIENhbnZhc1xuICAgICAqL1xuICAgIHRoaXMucGl4ZWxIZWlnaHQgPSB0aGlzLmhlaWdodDtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBIVE1MQ2FudmFzRWxlbWVudCBlbGVtZW50XG4gICAgICogQG1lbWJlcm9mIENhbnZhc1xuICAgICAqL1xuICAgIHRoaXMuZWxlbWVudCA9IHVuZGVmaW5lZDtcbn1cblxuRXZlbnRFbWl0dGVyLmV4dGVuZChDYW52YXMpO1xuXG5cbkNhbnZhcy5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5lbGVtZW50KSB0aGlzLmRlc3Ryb3koKTtcbiAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksXG4gICAgICAgIHN0eWxlID0gZWxlbWVudC5zdHlsZTtcblxuICAgIGVsZW1lbnQuaWQgPSBcImNhbnZhcy1cIiArIHRoaXMuY2FudmFzSWQ7XG4gICAgc3R5bGUuY3NzVGV4dCA9IENBTlZBU19TVFlMRTtcbiAgICBzdHlsZS5jdXJzb3IgPSB0aGlzLmN1c3RvbUN1cnNvciA/IFwidXJsKFwiICsgdGhpcy5jdXN0b21DdXJzb3IgKyBcIilcIiA6IHRoaXMuaGlkZU1vdXNlID8gXCJub25lXCIgOiBcImRlZmF1bHRcIjtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuXG4gICAgaWYgKCFDb25maWcuZGVidWcpIHtcbiAgICAgICAgZWxlbWVudC5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGFkZEV2ZW50KHdpbmRvdywgXCJyZXNpemUgb3JpZW50YXRpb25jaGFuZ2VcIiwgdGhpcy5oYW5kbGVSZXNpemUsIHRoaXMpO1xuXG4gICAgZWxlbWVudC5yZXF1ZXN0UG9pbnRlckxvY2sgfHwgKGVsZW1lbnQucmVxdWVzdFBvaW50ZXJMb2NrID0gKFxuICAgIGVsZW1lbnQud2Via2l0UmVxdWVzdFBvaW50ZXJMb2NrIHx8XG4gICAgZWxlbWVudC5tb3pSZXF1ZXN0UG9pbnRlckxvY2sgfHxcbiAgICBlbGVtZW50Lm9SZXF1ZXN0UG9pbnRlckxvY2sgfHxcbiAgICBlbGVtZW50Lm1zUmVxdWVzdFBvaW50ZXJMb2NrXG4gICAgKSk7XG4gICAgZWxlbWVudC5leGl0UG9pbnRlckxvY2sgfHwgKGVsZW1lbnQuZXhpdFBvaW50ZXJMb2NrID0gKFxuICAgIGRvY3VtZW50LndlYmtpdEV4aXRQb2ludGVyTG9jayB8fFxuICAgIGRvY3VtZW50Lm1vekV4aXRQb2ludGVyTG9jayB8fFxuICAgIGRvY3VtZW50Lm9FeGl0UG9pbnRlckxvY2sgfHxcbiAgICBkb2N1bWVudC5tc0V4aXRQb2ludGVyTG9ja1xuICAgICkpO1xuICAgIGVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4gfHwgKGVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4gPSAoXG4gICAgZWxlbWVudC53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbiB8fFxuICAgIGVsZW1lbnQubW96UmVxdWVzdEZ1bGxzY3JlZW4gfHxcbiAgICBlbGVtZW50Lm9SZXF1ZXN0RnVsbHNjcmVlbiB8fFxuICAgIGVsZW1lbnQubXNSZXF1ZXN0RnVsbHNjcmVlblxuICAgICkpO1xuICAgIGVsZW1lbnQuZXhpdEZ1bGxzY3JlZW4gfHwgKGVsZW1lbnQuZXhpdEZ1bGxzY3JlZW4gPSAoXG4gICAgZWxlbWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbiB8fFxuICAgIGVsZW1lbnQubW96RXhpdEZ1bGxzY3JlZW4gfHxcbiAgICBlbGVtZW50Lm9FeGl0RnVsbHNjcmVlbiB8fFxuICAgIGVsZW1lbnQubXNFeGl0RnVsbHNjcmVlblxuICAgICkpO1xuXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmhhbmRsZVJlc2l6ZSgpO1xufTtcblxuXG5DYW52YXMucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5lbGVtZW50KSByZXR1cm4gdGhpcztcblxuICAgIHJlbW92ZUV2ZW50KHdpbmRvdywgXCJyZXNpemUgb3JpZW50YXRpb25jaGFuZ2VcIiwgdGhpcy5oYW5kbGVSZXNpemUsIHRoaXMpO1xuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50KTtcbiAgICB0aGlzLmVsZW1lbnQgPSB1bmRlZmluZWQ7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZXRGdWxsc2NyZWVuXG4gKiBAbWVtYmVyb2YgQ2FudmFzXG4gKiBAYnJpZWYgc2V0cyBmdWxsU2NyZWVuIGJvb2xlYW5cbiAqIEBwYXJhbSBOdW1iZXIgd2lkdGhcbiAqL1xuQ2FudmFzLnByb3RvdHlwZS5zZXRGdWxsc2NyZWVuID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgaWYgKCF0aGlzLmVsZW1lbnQgfHwgdGhpcy5mdWxsU2NyZWVuID09PSB2YWx1ZSkgcmV0dXJuIHRoaXM7XG5cbiAgICB0aGlzLmZ1bGxTY3JlZW4gPSAhIXZhbHVlO1xuICAgIHRoaXMuaGFuZGxlUmVzaXplKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZXRXaWR0aFxuICogQG1lbWJlcm9mIENhbnZhc1xuICogQGJyaWVmIHNldHMgd2lkdGggYW5kIHVwZGF0ZXMgYXNwZWN0XG4gKiBAcGFyYW0gTnVtYmVyIHdpZHRoXG4gKi9cbkNhbnZhcy5wcm90b3R5cGUuc2V0V2lkdGggPSBmdW5jdGlvbiAod2lkdGgpIHtcbiAgICBpZiAoIXRoaXMuZWxlbWVudCB8fCB0aGlzLndpZHRoID09PSB3aWR0aCkgcmV0dXJuIHRoaXM7XG5cbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5mdWxsU2NyZWVuID0gZmFsc2U7XG4gICAgdGhpcy5hc3BlY3QgPSB0aGlzLndpZHRoIC8gdGhpcy5oZWlnaHQ7XG5cbiAgICB0aGlzLmhhbmRsZVJlc2l6ZSgpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0SGVpZ2h0XG4gKiBAbWVtYmVyb2YgQ2FudmFzXG4gKiBAYnJpZWYgc2V0cyBoZWlnaHQgYW5kIHVwZGF0ZXMgYXNwZWN0XG4gKiBAcGFyYW0gTnVtYmVyIGhlaWdodFxuICovXG5DYW52YXMucHJvdG90eXBlLnNldEhlaWdodCA9IGZ1bmN0aW9uIChoZWlnaHQpIHtcbiAgICBpZiAoIXRoaXMuZWxlbWVudCB8fCB0aGlzLmhlaWdodCA9PT0gaGVpZ2h0KSByZXR1cm4gdGhpcztcblxuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIHRoaXMuZnVsbFNjcmVlbiA9IGZhbHNlO1xuICAgIHRoaXMuYXNwZWN0ID0gdGhpcy53aWR0aCAvIHRoaXMuaGVpZ2h0O1xuXG4gICAgdGhpcy5oYW5kbGVSZXNpemUoKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHN0eWxlXG4gKiBAbWVtYmVyb2YgQ2FudmFzXG4gKiBAYnJpZWYgc2V0cyBzdHlsZSBvZiBodG1sIGVsZW1lbnRcbiAqIEBwYXJhbSBTdHJpbmcga2V5XG4gKiBAcGFyYW0gU3RyaW5nIHZhbHVlXG4gKi9cbkNhbnZhcy5wcm90b3R5cGUuc3R5bGUgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgIGlmICghdGhpcy5lbGVtZW50KSByZXR1cm4gdGhpcztcblxuICAgIHRoaXMuZWxlbWVudC5zdHlsZVtrZXldID0gdmFsdWU7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0QmFja2dyb3VuZENvbG9yXG4gKiBAbWVtYmVyb2YgQ2FudmFzXG4gKiBAYnJpZWYgc2V0cyBodG1sIGJhY2tncm91bmQgY29sb3JcbiAqIEBwYXJhbSBTdHJpbmcgY29sb3JcbiAqL1xuQ2FudmFzLnByb3RvdHlwZS5zZXRCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAoY29sb3IpIHtcbiAgICBpZiAoIXRoaXMuZWxlbWVudCkgcmV0dXJuIHRoaXM7XG5cbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZCA9IGNvbG9yO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5DYW52YXMucHJvdG90eXBlLmhhbmRsZVJlc2l6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdyA9IHdpbmRvdy5pbm5lcldpZHRoLFxuICAgICAgICBoID0gd2luZG93LmlubmVySGVpZ2h0LFxuICAgICAgICBhc3BlY3QgPSB3IC8gaCxcbiAgICAgICAgZWxlbWVudCA9IHRoaXMuZWxlbWVudCxcbiAgICAgICAgc3R5bGUgPSBlbGVtZW50LnN0eWxlLFxuICAgICAgICB3aWR0aCwgaGVpZ2h0O1xuXG4gICAgaWYgKHRoaXMuZnVsbFNjcmVlbikge1xuICAgICAgICB3aWR0aCA9IHc7XG4gICAgICAgIGhlaWdodCA9IGg7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGFzcGVjdCA+IHRoaXMuYXNwZWN0KSB7XG4gICAgICAgICAgICB3aWR0aCA9IGggKiB0aGlzLmFzcGVjdDtcbiAgICAgICAgICAgIGhlaWdodCA9IGg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB3aWR0aCA9IHc7XG4gICAgICAgICAgICBoZWlnaHQgPSB3IC8gdGhpcy5hc3BlY3Q7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnBpeGVsV2lkdGggPSBmbG9vcih3aWR0aCk7XG4gICAgdGhpcy5waXhlbEhlaWdodCA9IGZsb29yKGhlaWdodCk7XG5cbiAgICBlbGVtZW50LndpZHRoID0gd2lkdGg7XG4gICAgZWxlbWVudC5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICBzdHlsZS5tYXJnaW5MZWZ0ID0gLWZsb29yKCh3aWR0aCArIDEpICogMC41KSArIFwicHhcIjtcbiAgICBzdHlsZS5tYXJnaW5Ub3AgPSAtZmxvb3IoKGhlaWdodCArIDEpICogMC41KSArIFwicHhcIjtcblxuICAgIHN0eWxlLndpZHRoID0gZmxvb3Iod2lkdGgpICsgXCJweFwiO1xuICAgIHN0eWxlLmhlaWdodCA9IGZsb29yKGhlaWdodCkgKyBcInB4XCI7XG5cbiAgICB0aGlzLmVtaXQoXCJyZXNpemVcIik7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gQ2FudmFzO1xuIiwidmFyIENsYXNzID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvY2xhc3NcIik7XG52YXIgRW51bXMgPSByZXF1aXJlKFwiLi4vZW51bXNcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAY2xhc3MgUmVuZGVyVGFyZ2V0XG4gKiBAZXh0ZW5kcyBDbGFzc1xuICogQGJyaWVmIFdlYkdMIFJlbmRlciBUYXJnZXQgaGVscGVyXG4gKi9cblxuZnVuY3Rpb24gUmVuZGVyVGFyZ2V0KG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQ2xhc3MuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMud2lkdGggPSBvcHRzLndpZHRoIHx8IDUxMjtcbiAgICB0aGlzLmhlaWdodCA9IG9wdHMuaGVpZ2h0IHx8IDUxMjtcblxuICAgIHRoaXMuaW52V2lkdGggPSAxIC8gdGhpcy53aWR0aDtcbiAgICB0aGlzLmludkhlaWdodCA9IDEgLyB0aGlzLmhlaWdodDtcblxuICAgIHRoaXMuZGVwdGhPbmx5ID0gb3B0cy5kZXB0aE9ubHkgIT0gdW5kZWZpbmVkID8gISFvcHRzLmRlcHRoT25seSA6IGZhbHNlO1xuICAgIHRoaXMuZGVwdGhCdWZmZXIgPSBvcHRzLmRlcHRoQnVmZmVyICE9IHVuZGVmaW5lZCA/ICEhb3B0cy5kZXB0aEJ1ZmZlciA6IHRydWU7XG4gICAgdGhpcy5zdGVuY2lsQnVmZmVyID0gb3B0cy5zdGVuY2lsQnVmZmVyICE9IHVuZGVmaW5lZCA/ICEhb3B0cy5zdGVuY2lsQnVmZmVyIDogdHJ1ZTtcblxuICAgIHRoaXMuZ2VuZXJhdGVNaXBtYXAgPSBvcHRzLmdlbmVyYXRlTWlwbWFwICE9IHVuZGVmaW5lZCA/ICEhb3B0cy5nZW5lcmF0ZU1pcG1hcCA6IHRydWU7XG4gICAgdGhpcy5mbGlwWSA9IG9wdHMuZmxpcFkgIT0gdW5kZWZpbmVkID8gISFvcHRzLmZsaXBZIDogdHJ1ZTtcbiAgICB0aGlzLnByZW11bHRpcGx5QWxwaGEgPSBvcHRzLnByZW11bHRpcGx5QWxwaGEgIT0gdW5kZWZpbmVkID8gISFvcHRzLnByZW11bHRpcGx5QWxwaGEgOiBmYWxzZTtcblxuICAgIHRoaXMuYW5pc290cm9weSA9IG9wdHMuYW5pc290cm9weSAhPSB1bmRlZmluZWQgPyBvcHRzLmFuaXNvdHJvcHkgOiAxO1xuXG4gICAgdGhpcy5maWx0ZXIgPSBvcHRzLmZpbHRlciAhPSB1bmRlZmluZWQgPyBvcHRzLmZpbHRlciA6IEVudW1zLkZpbHRlck1vZGUuTGluZWFyO1xuICAgIHRoaXMuZm9ybWF0ID0gb3B0cy5mb3JtYXQgIT0gdW5kZWZpbmVkID8gb3B0cy5mb3JtYXQgOiBFbnVtcy5UZXh0dXJlRm9ybWF0LlJHQkE7XG4gICAgdGhpcy53cmFwID0gb3B0cy53cmFwICE9IHVuZGVmaW5lZCA/IG9wdHMud3JhcCA6IEVudW1zLlRleHR1cmVXcmFwLlJlcGVhdDtcblxuICAgIHRoaXMuX3dlYmdsVXNlZCA9IDA7XG4gICAgdGhpcy5fd2ViZ2wgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fd2ViZ2xGcmFtZWJ1ZmZlciA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl93ZWJnbFJlbmRlcmJ1ZmZlciA9IHVuZGVmaW5lZDtcbn1cblxuQ2xhc3MuZXh0ZW5kKFJlbmRlclRhcmdldCk7XG5cblxuUmVuZGVyVGFyZ2V0LnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiBuZXcgUmVuZGVyVGFyZ2V0KCkuY29weSh0aGlzKTtcbn07XG5cblxuUmVuZGVyVGFyZ2V0LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICB0aGlzLndpZHRoID0gb3RoZXIud2lkdGg7XG4gICAgdGhpcy5oZWlnaHQgPSBvdGhlci5oZWlnaHQ7XG5cbiAgICB0aGlzLmludldpZHRoID0gb3RoZXIuaW52V2lkdGg7XG4gICAgdGhpcy5pbnZIZWlnaHQgPSBvdGhlci5pbnZIZWlnaHQ7XG5cbiAgICB0aGlzLmdlbmVyYXRlTWlwbWFwID0gb3RoZXIuZ2VuZXJhdGVNaXBtYXA7XG4gICAgdGhpcy5mbGlwWSA9IG90aGVyLmZsaXBZO1xuICAgIHRoaXMucHJlbXVsdGlwbHlBbHBoYSA9IG90aGVyLnByZW11bHRpcGx5QWxwaGE7XG5cbiAgICB0aGlzLmFuaXNvdHJvcHkgPSBvdGhlci5hbmlzb3Ryb3B5O1xuXG4gICAgdGhpcy5maWx0ZXIgPSBvdGhlci5maWx0ZXI7XG4gICAgdGhpcy5mb3JtYXQgPSBvdGhlci5mb3JtYXQ7XG4gICAgdGhpcy53cmFwID0gb3RoZXIud3JhcDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5SZW5kZXJUYXJnZXQucHJvdG90eXBlLnNldFdpZHRoID0gZnVuY3Rpb24gKHdpZHRoKSB7XG5cbiAgICB0aGlzLndpZHRoID0gd2lkdGggfHwgdGhpcy53aWR0aDtcbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxuUmVuZGVyVGFyZ2V0LnByb3RvdHlwZS5zZXRIZWlnaHQgPSBmdW5jdGlvbiAoaGVpZ2h0KSB7XG5cbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodCB8fCB0aGlzLmhlaWdodDtcbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxuUmVuZGVyVGFyZ2V0LnByb3RvdHlwZS5zZXRNaXBtYXAgPSBmdW5jdGlvbiAodmFsdWUpIHtcblxuICAgIHRoaXMuZ2VuZXJhdGVNaXBtYXAgPSB2YWx1ZSAhPSB1bmRlZmluZWQgPyAhIXZhbHVlIDogIXRoaXMuZ2VuZXJhdGVNaXBtYXA7XG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG59O1xuXG5cblJlbmRlclRhcmdldC5wcm90b3R5cGUuc2V0QW5pc290cm9weSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXG4gICAgdGhpcy5hbmlzb3Ryb3B5ID0gdmFsdWU7XG4gICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7XG59O1xuXG5cblJlbmRlclRhcmdldC5wcm90b3R5cGUuc2V0RmlsdGVyID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cbiAgICB0aGlzLmZpbHRlciA9IHZhbHVlO1xuICAgIHRoaXMubmVlZHNVcGRhdGUgPSB0cnVlO1xufTtcblxuXG5SZW5kZXJUYXJnZXQucHJvdG90eXBlLnNldEZvcm1hdCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXG4gICAgdGhpcy5mb3JtYXQgPSB2YWx1ZTtcbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxuUmVuZGVyVGFyZ2V0LnByb3RvdHlwZS5zZXRXcmFwID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cbiAgICB0aGlzLndyYXAgPSB2YWx1ZTtcbiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07XG5cblxuUmVuZGVyVGFyZ2V0LnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDbGFzcy5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICBqc29uLndpZHRoID0gdGhpcy53aWR0aDtcbiAgICBqc29uLmhlaWdodCA9IHRoaXMuaGVpZ2h0O1xuXG4gICAganNvbi5pbnZXaWR0aCA9IHRoaXMuaW52V2lkdGg7XG4gICAganNvbi5pbnZIZWlnaHQgPSB0aGlzLmludkhlaWdodDtcblxuICAgIGpzb24uZ2VuZXJhdGVNaXBtYXAgPSB0aGlzLmdlbmVyYXRlTWlwbWFwO1xuICAgIGpzb24uZmxpcFkgPSB0aGlzLmZsaXBZO1xuICAgIGpzb24ucHJlbXVsdGlwbHlBbHBoYSA9IHRoaXMucHJlbXVsdGlwbHlBbHBoYTtcblxuICAgIGpzb24uYW5pc290cm9weSA9IHRoaXMuYW5pc290cm9weTtcblxuICAgIGpzb24uZmlsdGVyID0gdGhpcy5maWx0ZXI7XG4gICAganNvbi5mb3JtYXQgPSB0aGlzLmZvcm1hdDtcbiAgICBqc29uLndyYXAgPSB0aGlzLndyYXA7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuUmVuZGVyVGFyZ2V0LnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgQ2xhc3MucHJvdG90eXBlLmZyb21KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICB0aGlzLndpZHRoID0ganNvbi53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IGpzb24uaGVpZ2h0O1xuXG4gICAgdGhpcy5pbnZXaWR0aCA9IGpzb24uaW52V2lkdGg7XG4gICAgdGhpcy5pbnZIZWlnaHQgPSBqc29uLmludkhlaWdodDtcblxuICAgIHRoaXMuZ2VuZXJhdGVNaXBtYXAgPSBqc29uLmdlbmVyYXRlTWlwbWFwO1xuICAgIHRoaXMuZmxpcFkgPSBqc29uLmZsaXBZO1xuICAgIHRoaXMucHJlbXVsdGlwbHlBbHBoYSA9IGpzb24ucHJlbXVsdGlwbHlBbHBoYTtcblxuICAgIHRoaXMuYW5pc290cm9weSA9IGpzb24uYW5pc290cm9weTtcblxuICAgIHRoaXMuZmlsdGVyID0ganNvbi5maWx0ZXI7XG4gICAgdGhpcy5mb3JtYXQgPSBqc29uLmZvcm1hdDtcbiAgICB0aGlzLndyYXAgPSBqc29uLndyYXA7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBSZW5kZXJUYXJnZXQ7XG4iLCJ2YXIgUmVuZGVyVGFyZ2V0ID0gcmVxdWlyZShcIi4vcmVuZGVyX3RhcmdldFwiKTtcblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBjbGFzcyBSZW5kZXJUYXJnZXRDdWJlXG4gKiBAZXh0ZW5kcyBSZW5kZXJUYXJnZXRcbiAqIEBicmllZiBXZWJHTCBSZW5kZXIgVGFyZ2V0IGhlbHBlclxuICovXG5cbmZ1bmN0aW9uIFJlbmRlclRhcmdldEN1YmUob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBSZW5kZXJUYXJnZXQuY2FsbCh0aGlzLCBvcHRzKTtcblxuICAgIHRoaXMuYWN0aXZlQ3ViZUZhY2UgPSAwO1xufVxuXG5SZW5kZXJUYXJnZXQuZXh0ZW5kKFJlbmRlclRhcmdldEN1YmUpO1xuXG5cblJlbmRlclRhcmdldEN1YmUucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIG5ldyBSZW5kZXJUYXJnZXRDdWJlKCkuY29weSh0aGlzKTtcbn07XG5cblxuUmVuZGVyVGFyZ2V0Q3ViZS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIFJlbmRlclRhcmdldC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsIG90aGVyKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5SZW5kZXJUYXJnZXRDdWJlLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBSZW5kZXJUYXJnZXQucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi5hY3RpdmVDdWJlRmFjZSA9IHRoaXMuYWN0aXZlQ3ViZUZhY2U7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuUmVuZGVyVGFyZ2V0Q3ViZS5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIFJlbmRlclRhcmdldC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIHRoaXMuYWN0aXZlQ3ViZUZhY2UgPSBqc29uLmFjdGl2ZUN1YmVGYWNlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUmVuZGVyVGFyZ2V0Q3ViZTtcbiIsInZhciBFdmVudEVtaXR0ZXIgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9ldmVudF9lbWl0dGVyXCIpO1xudmFyIERldmljZSA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2RldmljZVwiKTtcbnZhciBEb20gPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9kb21cIik7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL3V0aWxcIik7XG5cbnZhciBNYXRoZiA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL21hdGhmXCIpO1xudmFyIENvbG9yID0gcmVxdWlyZShcIi4uLy4uL21hdGgvY29sb3JcIik7XG52YXIgUmVjdCA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3JlY3RcIik7XG52YXIgUmVjdE9mZnNldCA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3JlY3Rfb2Zmc2V0XCIpO1xudmFyIFZlYzIgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWMyXCIpO1xudmFyIFZlYzMgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWMzXCIpO1xudmFyIFZlYzQgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWM0XCIpO1xudmFyIFF1YXQgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9xdWF0XCIpO1xudmFyIE1hdDIgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9tYXQyXCIpO1xudmFyIE1hdDMgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9tYXQzXCIpO1xudmFyIE1hdDQgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9tYXQ0XCIpO1xuXG52YXIgRW51bXMgPSByZXF1aXJlKFwiLi4vZW51bXNcIik7XG52YXIgTG9nID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvbG9nXCIpO1xudmFyIENvbmZpZyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2NvbmZpZ1wiKTtcbnZhciBSZW5kZXJUYXJnZXQgPSByZXF1aXJlKFwiLi9yZW5kZXJfdGFyZ2V0XCIpO1xudmFyIFJlbmRlclRhcmdldEN1YmUgPSByZXF1aXJlKFwiLi9yZW5kZXJfdGFyZ2V0X2N1YmVcIik7XG52YXIgU2hhZGVyQ2h1bmtzID0gcmVxdWlyZShcIi4vc2hhZGVyX2NodW5rc1wiKTtcblxudmFyIFRleHR1cmUgPSByZXF1aXJlKFwiLi4vYXNzZXRzL3RleHR1cmVcIik7XG52YXIgVGV4dHVyZUN1YmUgPSByZXF1aXJlKFwiLi4vYXNzZXRzL3RleHR1cmVfY3ViZVwiKTtcbnZhciBNZXNoRmlsdGVyID0gcmVxdWlyZShcIi4uL2NvbXBvbmVudHMvbWVzaF9maWx0ZXJcIik7XG52YXIgU3ByaXRlID0gcmVxdWlyZShcIi4uL2NvbXBvbmVudHMvc3ByaXRlXCIpO1xudmFyIEVtaXR0ZXIgPSByZXF1aXJlKFwiLi4vY29tcG9uZW50cy9wYXJ0aWNsZV9zeXN0ZW0vZW1pdHRlclwiKTtcbnZhciBFbWl0dGVyMkQgPSByZXF1aXJlKFwiLi4vY29tcG9uZW50cy9wYXJ0aWNsZV9zeXN0ZW0vZW1pdHRlcl8yZFwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBCbGVuZGluZyA9IEVudW1zLkJsZW5kaW5nLFxuICAgIFNoYWRvd01hcFR5cGUgPSBFbnVtcy5TaGFkb3dNYXBUeXBlLFxuICAgIEN1bGxGYWNlID0gRW51bXMuQ3VsbEZhY2UsXG4gICAgU2lkZSA9IEVudW1zLlNpZGUsXG5cbiAgICBMaWdodFR5cGUgPSBFbnVtcy5MaWdodFR5cGUsXG5cbiAgICBGaWx0ZXJNb2RlID0gRW51bXMuRmlsdGVyTW9kZSxcbiAgICBUZXh0dXJlRm9ybWF0ID0gRW51bXMuVGV4dHVyZUZvcm1hdCxcbiAgICBUZXh0dXJlV3JhcCA9IEVudW1zLlRleHR1cmVXcmFwLFxuXG4gICAgZ2V0V2ViR0xDb250ZXh0ID0gRG9tLmdldFdlYkdMQ29udGV4dCxcbiAgICBhZGRFdmVudCA9IERvbS5hZGRFdmVudCxcbiAgICByZW1vdmVFdmVudCA9IERvbS5yZW1vdmVFdmVudCxcblxuICAgIGNyZWF0ZVByb2dyYW0gPSBEb20uY3JlYXRlUHJvZ3JhbSxcblxuICAgIG1lcmdlID0gdXRpbC5tZXJnZSxcblxuICAgIG1heCA9IE1hdGgubWF4LFxuICAgIGZsb29yID0gTWF0aC5mbG9vcixcbiAgICBjbGFtcCA9IE1hdGhmLmNsYW1wLFxuICAgIGlzUG93ZXJPZlR3byA9IE1hdGhmLmlzUG93ZXJPZlR3byxcblxuICAgIGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5LFxuICAgIEVNUFRZX0FSUkFZID0gW107XG5cbi8qKlxuICogQGNsYXNzIFJlbmRlcmVyXG4gKiBAZXh0ZW5kcyBFdmVudEVtaXR0ZXJcbiAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zXG4gKi9cblxuZnVuY3Rpb24gUmVuZGVyZXIob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBFdmVudEVtaXR0ZXIuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMuYXV0b0NsZWFyID0gb3B0cy5hdXRvQ2xlYXIgIT0gdW5kZWZpbmVkID8gb3B0cy5hdXRvQ2xlYXIgOiB0cnVlO1xuICAgIHRoaXMuYXV0b0NsZWFyQ29sb3IgPSBvcHRzLmF1dG9DbGVhckNvbG9yICE9IHVuZGVmaW5lZCA/IG9wdHMuYXV0b0NsZWFyQ29sb3IgOiB0cnVlO1xuICAgIHRoaXMuYXV0b0NsZWFyRGVwdGggPSBvcHRzLmF1dG9DbGVhckRlcHRoICE9IHVuZGVmaW5lZCA/IG9wdHMuYXV0b0NsZWFyRGVwdGggOiB0cnVlO1xuICAgIHRoaXMuYXV0b0NsZWFyU3RlbmNpbCA9IG9wdHMuYXV0b0NsZWFyU3RlbmNpbCAhPSB1bmRlZmluZWQgPyBvcHRzLmF1dG9DbGVhclN0ZW5jaWwgOiB0cnVlO1xuXG4gICAgdGhpcy5zaGFkb3dNYXBFbmFibGVkID0gb3B0cy5zaGFkb3dNYXBFbmFibGVkICE9IHVuZGVmaW5lZCA/IG9wdHMuc2hhZG93TWFwRW5hYmxlZCA6IHRydWU7XG4gICAgdGhpcy5zaGFkb3dNYXBBdXRvVXBkYXRlID0gb3B0cy5zaGFkb3dNYXBBdXRvVXBkYXRlICE9IHVuZGVmaW5lZCA/IG9wdHMuc2hhZG93TWFwQXV0b1VwZGF0ZSA6IHRydWU7XG4gICAgdGhpcy5zaGFkb3dNYXBUeXBlID0gb3B0cy5zaGFkb3dNYXBUeXBlICE9IHVuZGVmaW5lZCA/IG9wdHMuc2hhZG93TWFwVHlwZSA6IFNoYWRvd01hcFR5cGUuUENGU2hhZG93TWFwO1xuICAgIHRoaXMuc2hhZG93TWFwQ3VsbEZhY2UgPSBvcHRzLnNoYWRvd01hcEN1bGxGYWNlICE9IHVuZGVmaW5lZCA/IG9wdHMuc2hhZG93TWFwQ3VsbEZhY2UgOiBDdWxsRmFjZS5Gcm9udDtcbiAgICB0aGlzLnNoYWRvd01hcERlYnVnID0gb3B0cy5zaGFkb3dNYXBEZWJ1ZyAhPSB1bmRlZmluZWQgPyBvcHRzLnNoYWRvd01hcERlYnVnIDogZmFsc2U7XG4gICAgdGhpcy5zaGFkb3dNYXBDYXNjYWRlID0gb3B0cy5zaGFkb3dNYXBDYXNjYWRlICE9IHVuZGVmaW5lZCA/IG9wdHMuc2hhZG93TWFwQ2FzY2FkZSA6IGZhbHNlO1xuXG4gICAgdmFyIF9sYXN0Q2FtZXJhID0gdW5kZWZpbmVkLFxuICAgICAgICBfbGFzdFJlc2l6ZUZuID0gdW5kZWZpbmVkLFxuICAgICAgICBfbGFzdFNjZW5lID0gdW5kZWZpbmVkLFxuICAgICAgICBfbGFzdEdVSSA9IHVuZGVmaW5lZCxcblxuICAgICAgICBfbWF0NCA9IG5ldyBNYXQ0LFxuICAgICAgICBfcHJvalNjcmVlbk1hdHJpeCA9IG5ldyBNYXQ0LFxuICAgICAgICBfcXVhdCA9IG5ldyBRdWF0LFxuICAgICAgICBfdmVjdG9yMiA9IG5ldyBWZWMyLFxuICAgICAgICBfdmVjdG9yMyA9IG5ldyBWZWMzLFxuICAgICAgICBfdmVjdG9yM18yID0gbmV3IFZlYzMsXG4gICAgICAgIF92ZWN0b3I0ID0gbmV3IFZlYzQsXG4gICAgICAgIF9yZWN0ID0gbmV3IFJlY3QsXG4gICAgICAgIF9yZWN0XzIgPSBuZXcgUmVjdCxcbiAgICAgICAgX3JlY3RPZmZzZXQgPSBuZXcgUmVjdE9mZnNldCxcbiAgICAgICAgX2NvbG9yID0gbmV3IENvbG9yLFxuXG4gICAgICAgIF9zaGFkZXJzID0ge30sXG4gICAgICAgIF9sYXN0QnVmZmVycyA9IHVuZGVmaW5lZCxcbiAgICAgICAgX3Nwcml0ZUJ1ZmZlcnMgPSB1bmRlZmluZWQsXG5cbiAgICAgICAgX3RleHRUZXh0dXJlcyA9IHt9LFxuICAgICAgICBfY2FudmFzMmQgPSB1bmRlZmluZWQsXG4gICAgICAgIF9jdHggPSB1bmRlZmluZWQ7XG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIHJlbmRlclxuICAgICAqIEBtZW1iZXJvZiBSZW5kZXJlclxuICAgICAqIEBicmllZiByZW5kZXJlcnMgc2NlbmUgZnJvbSBjYW1lcmEncyBwZXJzcGVjdGl2ZVxuICAgICAqIEBwYXJhbSBDYW1lcmEgY2FtZXJhXG4gICAgICogQHBhcmFtIFNjZW5lIHNjZW5lXG4gICAgICogQHBhcmFtIEdVSSBndWlcbiAgICAgKiBAcGFyYW0gUmVuZGVyVGFyZ2V0IHJlbmRlclRhcmdldFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlbmRlcihjYW1lcmEsIHNjZW5lLCBndWksIHJlbmRlclRhcmdldCkge1xuICAgICAgICBpZiAoIV9jb250ZXh0IHx8ICFjYW1lcmEpIHJldHVybjtcbiAgICAgICAgdmFyIGxpbmVXaWR0aCwgYmxlbmRpbmcsIGN1bGxGYWNlLFxuICAgICAgICAgICAgYmFja2dyb3VuZCA9IGNhbWVyYS5iYWNrZ3JvdW5kLFxuICAgICAgICAgICAgaSwgaWw7XG5cbiAgICAgICAgc2V0UmVuZGVyVGFyZ2V0KHJlbmRlclRhcmdldCk7XG5cbiAgICAgICAgaWYgKF9sYXN0Q2xlYXJDb2xvci5yICE9PSBiYWNrZ3JvdW5kLnIgfHwgX2xhc3RDbGVhckNvbG9yLmcgIT09IGJhY2tncm91bmQuZyB8fCBfbGFzdENsZWFyQ29sb3IuYiAhPT0gYmFja2dyb3VuZC5iKSB7XG4gICAgICAgICAgICBfbGFzdENsZWFyQ29sb3IuY29weShiYWNrZ3JvdW5kKTtcbiAgICAgICAgICAgIF9nbC5jbGVhckNvbG9yKGJhY2tncm91bmQuciwgYmFja2dyb3VuZC5nLCBiYWNrZ3JvdW5kLmIsIDEpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmF1dG9DbGVhcikgY2xlYXJDYW52YXModHJ1ZSwgdGhpcy5hdXRvQ2xlYXJEZXB0aCwgdGhpcy5hdXRvQ2xlYXJTdGVuY2lsKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX2xhc3RDYW1lcmEgIT09IGNhbWVyYSkge1xuXG4gICAgICAgICAgICBpZiAoY2FtZXJhLmF1dG9SZXNpemUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdyA9IF9jYW52YXMucGl4ZWxXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgaCA9IF9jYW52YXMucGl4ZWxIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICBjYW1lcmEuc2V0KHcsIGgpO1xuICAgICAgICAgICAgICAgIHNldFZpZXdwb3J0KDAsIDAsIHcsIGgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKF9sYXN0UmVzaXplRm4pIF9jYW52YXMub2ZmKFwicmVzaXplXCIsIF9sYXN0UmVzaXplRm4pO1xuXG4gICAgICAgICAgICAgICAgX2xhc3RSZXNpemVGbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHcgPSB0aGlzLnBpeGVsV2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICBoID0gdGhpcy5waXhlbEhlaWdodDtcblxuICAgICAgICAgICAgICAgICAgICBjYW1lcmEuc2V0KHcsIGgpO1xuICAgICAgICAgICAgICAgICAgICBzZXRWaWV3cG9ydCgwLCAwLCB3LCBoKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgX2NhbnZhcy5vbihcInJlc2l6ZVwiLCBfbGFzdFJlc2l6ZUZuKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2V0Vmlld3BvcnQoMCwgMCwgY2FtZXJhLndpZHRoLCBjYW1lcmEuaGVpZ2h0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2xhc3RDYW1lcmEgPSBjYW1lcmE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNjZW5lICYmIF9sYXN0U2NlbmUgIT09IHNjZW5lKSB7XG4gICAgICAgICAgICBpZiAoX2xhc3RTY2VuZSkgcmVtb3ZlU2NlbmVFdmVudHMoX2xhc3RTY2VuZSk7XG4gICAgICAgICAgICBhZGRTY2VuZUV2ZW50cyhzY2VuZSk7XG5cbiAgICAgICAgICAgIF9sYXN0U2NlbmUgPSBzY2VuZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ3VpICYmIF9sYXN0R1VJICE9PSBndWkpIHtcbiAgICAgICAgICAgIGlmIChfbGFzdEdVSSkgcmVtb3ZlR1VJRXZlbnRzKF9sYXN0R1VJKTtcbiAgICAgICAgICAgIGFkZEdVSUV2ZW50cyhndWkpO1xuXG4gICAgICAgICAgICBfbGFzdFNjZW5lID0gZ3VpO1xuICAgICAgICB9XG5cbiAgICAgICAgX3Byb2pTY3JlZW5NYXRyaXgubW11bChjYW1lcmEucHJvamVjdGlvbiwgY2FtZXJhLnZpZXcpO1xuICAgICAgICBpZiAodGhpcy5hdXRvQ2xlYXIpIGNsZWFyQ2FudmFzKHRoaXMuYXV0b0NsZWFyQ29sb3IsIHRoaXMuYXV0b0NsZWFyRGVwdGgsIHRoaXMuYXV0b0NsZWFyU3RlbmNpbCk7XG5cbiAgICAgICAgbGluZVdpZHRoID0gX2xhc3RMaW5lV2lkdGg7XG4gICAgICAgIGJsZW5kaW5nID0gX2xhc3RCbGVuZGluZztcbiAgICAgICAgY3VsbEZhY2UgPSBfbGFzdEN1bGxGYWNlO1xuXG4gICAgICAgIGlmIChzY2VuZSkge1xuICAgICAgICAgICAgdmFyIGNvbXBvbmVudE1hbmFnZXJzID0gc2NlbmUuY29tcG9uZW50TWFuYWdlcnMsXG4gICAgICAgICAgICAgICAgYW1iaWVudCA9IHNjZW5lLndvcmxkLmFtYmllbnQsXG4gICAgICAgICAgICAgICAgbGlnaHRzID0gY29tcG9uZW50TWFuYWdlcnMuTGlnaHQsXG4gICAgICAgICAgICAgICAgbWVzaEZpbHRlcnMgPSBjb21wb25lbnRNYW5hZ2Vycy5NZXNoRmlsdGVyLFxuICAgICAgICAgICAgICAgIHNwcml0ZXMgPSBjb21wb25lbnRNYW5hZ2Vycy5TcHJpdGUsXG4gICAgICAgICAgICAgICAgcGFydGljbGVTeXN0ZW1zID0gY29tcG9uZW50TWFuYWdlcnMuUGFydGljbGVTeXN0ZW07XG5cbiAgICAgICAgICAgIGxpZ2h0cyA9IGxpZ2h0cyA/IGxpZ2h0cy5jb21wb25lbnRzIDogRU1QVFlfQVJSQVk7XG5cbiAgICAgICAgICAgIGlmIChtZXNoRmlsdGVycykgcmVuZGVyTWVzaEZpbHRlcnMoY2FtZXJhLCBsaWdodHMsIGFtYmllbnQsIG1lc2hGaWx0ZXJzKTtcbiAgICAgICAgICAgIGlmIChzcHJpdGVzKSByZW5kZXJTcHJpdGVzKGNhbWVyYSwgbGlnaHRzLCBhbWJpZW50LCBzcHJpdGVzKTtcbiAgICAgICAgICAgIGlmIChwYXJ0aWNsZVN5c3RlbXMpIHJlbmRlclBhcnRpY2xlU3lzdGVtcyhjYW1lcmEsIGxpZ2h0cywgYW1iaWVudCwgcGFydGljbGVTeXN0ZW1zKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ3VpKSB7XG4gICAgICAgICAgICB2YXIgY29tcG9uZW50TWFuYWdlcnMgPSBndWkuY29tcG9uZW50TWFuYWdlcnMsXG4gICAgICAgICAgICAgICAgZ3VpQ29udGVudHMgPSBjb21wb25lbnRNYW5hZ2Vycy5HVUlDb250ZW50LFxuICAgICAgICAgICAgICAgIGd1aUNvbnRlbnQsIHRyYW5zZm9ybTtcblxuICAgICAgICAgICAgdXNlRGVwdGggJiYgc2V0RGVwdGhUZXN0KGZhbHNlKTtcblxuICAgICAgICAgICAgZ3VpQ29udGVudHMgPSBndWlDb250ZW50cyA/IGd1aUNvbnRlbnRzLmNvbXBvbmVudHMgOiBFTVBUWV9BUlJBWTtcblxuICAgICAgICAgICAgZm9yIChpID0gMCwgaWwgPSBndWlDb250ZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZ3VpQ29udGVudCA9IGd1aUNvbnRlbnRzW2ldO1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybSA9IGd1aUNvbnRlbnQuZ3VpVHJhbnNmb3JtO1xuXG4gICAgICAgICAgICAgICAgaWYgKCF0cmFuc2Zvcm0pIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtLnVwZGF0ZU1hdHJpY2VzKGNhbWVyYS5ndWlQcm9qZWN0aW9uKTtcbiAgICAgICAgICAgICAgICByZW5kZXJHVUlDb250ZW50KGNhbWVyYSwgdHJhbnNmb3JtLCBndWlDb250ZW50KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdXNlRGVwdGggJiYgc2V0RGVwdGhUZXN0KHRydWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2V0Q3VsbEZhY2UoY3VsbEZhY2UpO1xuICAgICAgICBzZXRCbGVuZGluZyhibGVuZGluZyk7XG4gICAgICAgIHNldExpbmVXaWR0aChsaW5lV2lkdGgpO1xuICAgIH07XG4gICAgdGhpcy5yZW5kZXIgPSByZW5kZXI7XG5cblxuICAgIHZhciBfZ3VpQnVmZmVycyA9IHVuZGVmaW5lZCxcbiAgICAgICAgX2d1aUNvbnRlbnRTaGFkZXIgPSB1bmRlZmluZWQ7XG5cbiAgICBmdW5jdGlvbiByZW5kZXJHVUlDb250ZW50KGNhbWVyYSwgdHJhbnNmb3JtLCBndWlDb250ZW50KSB7XG4gICAgICAgIGlmICghX2d1aUJ1ZmZlcnMpIGNyZWF0ZUdVSUJ1ZmZlcnMoKTtcbiAgICAgICAgaWYgKCFfZ3VpQ29udGVudFNoYWRlcikgY3JlYXRlR1VJQ29udGVudFNoYWRlcigpO1xuXG4gICAgICAgIHZhciBmb3JjZSA9IHNldFByb2dyYW0oX2d1aUNvbnRlbnRTaGFkZXIucHJvZ3JhbSksXG4gICAgICAgICAgICB1bmlmb3JtcyA9IF9ndWlDb250ZW50U2hhZGVyLnVuaWZvcm1zLFxuICAgICAgICAgICAgYXR0cmlidXRlcyA9IF9ndWlDb250ZW50U2hhZGVyLmF0dHJpYnV0ZXMsXG5cbiAgICAgICAgICAgIHRleHR1cmUgPSBndWlDb250ZW50LnRleHR1cmUsXG4gICAgICAgICAgICB0ZXh0ID0gZ3VpQ29udGVudC50ZXh0LFxuXG4gICAgICAgICAgICBzdHlsZSA9IGd1aUNvbnRlbnQuc3R5bGUsXG4gICAgICAgICAgICBzdHlsZVN0YXRlID0gc3R5bGUuX3N0YXRlLFxuICAgICAgICAgICAgc3RhdGUgPSBzdHlsZVtzdHlsZVN0YXRlXSxcblxuICAgICAgICAgICAgaW5uZXJSZWN0ID0gX3JlY3QuY29weSh0cmFuc2Zvcm0ucG9zaXRpb24pLFxuICAgICAgICAgICAgb3V0ZXJSZWN0ID0gX3JlY3RfMjtcblxuICAgICAgICBpZiAodGV4dHVyZSkge1xuXG4gICAgICAgIH0gZWxzZSBpZiAodGV4dCkge1xuICAgICAgICAgICAgdGV4dHVyZSA9IGNyZWF0ZVRleHRUZXh0dXJlKGd1aUNvbnRlbnQsIGlubmVyUmVjdCwgdGV4dCwgc3R5bGUsIHN0YXRlKTtcbiAgICAgICAgICAgIG91dGVyUmVjdC5jb3B5KGlubmVyUmVjdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoX2xhc3RCdWZmZXJzICE9PSBfZ3VpQnVmZmVycykge1xuICAgICAgICAgICAgZGlzYWJsZUF0dHJpYnV0ZXMoKTtcblxuICAgICAgICAgICAgYXR0cmlidXRlcy5wb3NpdGlvbi5zZXQoX2d1aUJ1ZmZlcnMuX3dlYmdsVmVydGV4QnVmZmVyKTtcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMudXYuc2V0KF9ndWlCdWZmZXJzLl93ZWJnbFV2QnVmZmVyKTtcblxuICAgICAgICAgICAgX2xhc3RCdWZmZXJzID0gX2d1aUJ1ZmZlcnM7XG4gICAgICAgIH1cblxuICAgICAgICBzdHlsZS5wYWRkaW5nLmFkZChvdXRlclJlY3QpO1xuICAgICAgICBzdHlsZS5tYXJnaW4uYWRkKG91dGVyUmVjdCk7XG5cbiAgICAgICAgdW5pZm9ybXMubXZwTWF0cml4LnNldCh0cmFuc2Zvcm0ubW9kZWxWaWV3LCBmb3JjZSk7XG4gICAgICAgIHVuaWZvcm1zLnNpemUuc2V0KF92ZWN0b3IyLnNldChvdXRlclJlY3Qud2lkdGgsIG91dGVyUmVjdC5oZWlnaHQpLCBmb3JjZSk7XG4gICAgICAgIHVuaWZvcm1zLmNyb3Auc2V0KF92ZWN0b3I0LnNldCgwLCAwLCAxLCAxKSwgZm9yY2UpO1xuICAgICAgICB1bmlmb3Jtcy5hbHBoYS5zZXQoc3R5bGUuYWxwaGEsIGZvcmNlKTtcblxuICAgICAgICBfZ2wuYWN0aXZlVGV4dHVyZShfZ2wuVEVYVFVSRTApO1xuICAgICAgICBfZ2wuYmluZFRleHR1cmUoX2dsLlRFWFRVUkVfMkQsIHRleHR1cmUuX3dlYmdsKTtcbiAgICAgICAgX2dsLnVuaWZvcm0xaSh1bmlmb3Jtcy50ZXh0dXJlLmxvY2F0aW9uLCAwKTtcblxuICAgICAgICBfZ2wuZHJhd0FycmF5cyhfZ2wuVFJJQU5HTEVfU1RSSVAsIDAsIF9ndWlCdWZmZXJzLl93ZWJnbFZlcnRleENvdW50KTtcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVRleHRUZXh0dXJlKGd1aUNvbnRlbnQsIGlubmVyUmVjdCwgdGV4dCwgc3R5bGUsIHN0YXRlKSB7XG4gICAgICAgIHZhciB0ZXh0dXJlID0gX3RleHRUZXh0dXJlc1tndWlDb250ZW50Ll9pZF07XG4gICAgICAgIGlmICghZ3VpQ29udGVudC5fbmVlZHNVcGRhdGUpIHtcbiAgICAgICAgICAgIGlubmVyUmVjdC53aWR0aCA9IHRleHR1cmUud2lkdGg7XG4gICAgICAgICAgICBpbm5lclJlY3QuaGVpZ2h0ID0gdGV4dHVyZS5oZWlnaHQ7XG4gICAgICAgICAgICByZXR1cm4gdGV4dHVyZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBjYW52YXMgPSBfY2FudmFzMmQsXG4gICAgICAgICAgICBURVhUVVJFXzJEID0gX2dsLlRFWFRVUkVfMkQsXG5cbiAgICAgICAgICAgIGxpbmVIZWlnaHQgPSBzdHlsZS5saW5lSGVpZ2h0LFxuICAgICAgICAgICAgbGluZVNwYWNpbmcgPSBzdHlsZS5saW5lU3BhY2luZyxcbiAgICAgICAgICAgIGhhbGZMaW5lU3BhY2luZyA9IGxpbmVTcGFjaW5nICogMC41LFxuICAgICAgICAgICAgZm9udEhlaWdodCA9IGRldGVybWluZUZvbnRIZWlnaHQoc3R5bGUuZm9udCksXG4gICAgICAgICAgICBjdHhTdHlsZSA9IHN0eWxlLmZvbnRTdHlsZSArIFwiIFwiICsgc3R5bGUuZm9udFNpemUgKyBcInB0IFwiICsgc3R5bGUuZm9udCxcblxuICAgICAgICAgICAgbWF4V2lkdGggPSBpbm5lclJlY3Qud2lkdGgsXG4gICAgICAgICAgICBtYXhIZWlnaHQgPSBpbm5lclJlY3QuaGVpZ2h0LFxuICAgICAgICAgICAgd2lkdGgsIGhlaWdodCxcblxuICAgICAgICAgICAgbGluZXMgPSB3d0xhc3RMaW5lcyxcbiAgICAgICAgICAgIGxpbmUsIHggPSAwLFxuICAgICAgICAgICAgeSA9IDAsXG4gICAgICAgICAgICBpLCBpbDtcblxuICAgICAgICB0ZXh0dXJlID0gdGV4dHVyZSB8fCAoX3RleHRUZXh0dXJlc1tndWlDb250ZW50Ll9pZF0gPSB7fSk7XG5cbiAgICAgICAgX2N0eC5mb250ID0gY3R4U3R5bGU7XG4gICAgICAgIGxpbmVIZWlnaHQgPSBsaW5lSGVpZ2h0ID4gZm9udEhlaWdodCA/IGxpbmVIZWlnaHQgOiBmb250SGVpZ2h0O1xuXG4gICAgICAgIGlmIChzdHlsZS53b3JkV3JhcCAmJiAhc3R5bGUuc3RyZXRjaFdpZHRoKSB7XG4gICAgICAgICAgICB3b3JkV3JhcCh0ZXh0LCBtYXhXaWR0aCwgbGluZUhlaWdodCwgbGluZVNwYWNpbmcpO1xuICAgICAgICAgICAgd2lkdGggPSB3d0xhc3RYO1xuICAgICAgICAgICAgaGVpZ2h0ID0gd3dMYXN0WTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxpbmVzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICBsaW5lcy5wdXNoKHRleHQpO1xuICAgICAgICAgICAgd2lkdGggPSBfY3R4Lm1lYXN1cmVUZXh0KHRleHQpLndpZHRoO1xuICAgICAgICAgICAgaGVpZ2h0ID0gbGluZUhlaWdodCArIGxpbmVTcGFjaW5nO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FudmFzLndpZHRoID0gc3R5bGUuZml4ZWRXaWR0aCB8fCB3aWR0aDtcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IHN0eWxlLmZpeGVkSGVpZ2h0IHx8IGhlaWdodDtcblxuICAgICAgICBfY3R4LmZvbnQgPSBjdHhTdHlsZTtcbiAgICAgICAgX2N0eC5maWxsU3R5bGUgPSBzdGF0ZS50ZXh0LnRvUkdCKCk7XG4gICAgICAgIF9jdHgudGV4dEFsaWduID0gXCJsZWZ0XCI7XG4gICAgICAgIF9jdHgudGV4dEJhc2VsaW5lID0gXCJ0b3BcIjtcblxuICAgICAgICBmb3IgKGkgPSAwLCBpbCA9IGxpbmVzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHtcbiAgICAgICAgICAgIGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgICAgICAgIHkgKz0gaGFsZkxpbmVTcGFjaW5nO1xuICAgICAgICAgICAgX2N0eC5maWxsVGV4dChsaW5lLCB4LCB5KTtcbiAgICAgICAgICAgIHkgKz0gbGluZUhlaWdodCArIGhhbGZMaW5lU3BhY2luZztcbiAgICAgICAgfVxuXG5cbiAgICAgICAgdGV4dHVyZS53aWR0aCA9IGlubmVyUmVjdC53aWR0aCA9IHdpZHRoO1xuICAgICAgICB0ZXh0dXJlLmhlaWdodCA9IGlubmVyUmVjdC5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgICAgdGV4dHVyZS5fd2ViZ2wgPSB0ZXh0dXJlLl93ZWJnbCB8fCAodGV4dHVyZS5fd2ViZ2wgPSBfZ2wuY3JlYXRlVGV4dHVyZSgpKTtcblxuICAgICAgICBfZ2wuYmluZFRleHR1cmUoVEVYVFVSRV8yRCwgdGV4dHVyZS5fd2ViZ2wpO1xuXG4gICAgICAgIF9nbC5waXhlbFN0b3JlaShfZ2wuVU5QQUNLX0ZMSVBfWV9XRUJHTCwgMCk7XG5cbiAgICAgICAgX2dsLnRleEltYWdlMkQoVEVYVFVSRV8yRCwgMCwgX2dsLlJHQkEsIF9nbC5SR0JBLCBfZ2wuVU5TSUdORURfQllURSwgY2FudmFzKTtcblxuICAgICAgICBfZ2wudGV4UGFyYW1ldGVyaShURVhUVVJFXzJELCBfZ2wuVEVYVFVSRV9NQUdfRklMVEVSLCBfZ2wuTkVBUkVTVCk7XG4gICAgICAgIF9nbC50ZXhQYXJhbWV0ZXJpKFRFWFRVUkVfMkQsIF9nbC5URVhUVVJFX01JTl9GSUxURVIsIF9nbC5ORUFSRVNUKTtcblxuICAgICAgICBfZ2wudGV4UGFyYW1ldGVyaShURVhUVVJFXzJELCBfZ2wuVEVYVFVSRV9XUkFQX1MsIF9nbC5DTEFNUF9UT19FREdFKTtcbiAgICAgICAgX2dsLnRleFBhcmFtZXRlcmkoVEVYVFVSRV8yRCwgX2dsLlRFWFRVUkVfV1JBUF9ULCBfZ2wuQ0xBTVBfVE9fRURHRSk7XG5cbiAgICAgICAgX2dsLmJpbmRUZXh0dXJlKFRFWFRVUkVfMkQsIG51bGwpO1xuXG4gICAgICAgIGd1aUNvbnRlbnQuX25lZWRzVXBkYXRlID0gZmFsc2U7XG5cbiAgICAgICAgcmV0dXJuIHRleHR1cmU7XG4gICAgfVxuXG5cbiAgICB2YXIgd3dMYXN0TGluZXMgPSBbXSxcbiAgICAgICAgd3dMYXN0WCA9IDAsXG4gICAgICAgIHd3TGFzdFkgPSAwO1xuXG4gICAgZnVuY3Rpb24gd29yZFdyYXAodGV4dCwgbWF4V2lkdGgsIGxpbmVIZWlnaHQsIGxpbmVTcGFjaW5nKSB7XG4gICAgICAgIHd3TGFzdExpbmVzLmxlbmd0aCA9IDA7XG4gICAgICAgIHd3TGFzdFggPSAwO1xuICAgICAgICB3d0xhc3RZID0gbGluZUhlaWdodCArIGxpbmVTcGFjaW5nO1xuXG4gICAgICAgIHZhciB3b3JkcyA9IHRleHQuc3BsaXQoXCIgXCIpLFxuICAgICAgICAgICAgbGluZSA9IFwiXCIsXG4gICAgICAgICAgICB3b3JkLCB0ZXN0TGluZSwgdGVzdFdpZHRoLFxuICAgICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgICBpbCA9IHdvcmRzLmxlbmd0aDtcblxuICAgICAgICBmb3IgKDsgaSA8IGlsOyBpKyspIHtcbiAgICAgICAgICAgIHdvcmQgPSB3b3Jkc1tpXTtcbiAgICAgICAgICAgIHRlc3RMaW5lID0gbGluZSArIHdvcmQgKyBcIiBcIjtcbiAgICAgICAgICAgIHRlc3RXaWR0aCA9IF9jdHgubWVhc3VyZVRleHQodGVzdExpbmUpLndpZHRoO1xuXG4gICAgICAgICAgICBpZiAodGVzdFdpZHRoID4gbWF4V2lkdGggJiYgaSA+IDApIHtcbiAgICAgICAgICAgICAgICB3d0xhc3RMaW5lcy5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgICAgIGxpbmUgPSB3b3JkICsgXCIgXCI7XG4gICAgICAgICAgICAgICAgd3dMYXN0WSArPSBsaW5lSGVpZ2h0ICsgbGluZVNwYWNpbmc7XG5cbiAgICAgICAgICAgICAgICB0ZXN0V2lkdGggPSBfY3R4Lm1lYXN1cmVUZXh0KGxpbmUpLndpZHRoO1xuICAgICAgICAgICAgICAgIHd3TGFzdFggPSB0ZXN0V2lkdGggPiB3d0xhc3RYID8gdGVzdFdpZHRoIDogd3dMYXN0WDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGluZSA9IHRlc3RMaW5lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHd3TGFzdExpbmVzLnB1c2gobGluZSk7XG4gICAgfVxuXG5cbiAgICB2YXIgaGVpZ2h0Q2FjaGUgPSB7fTtcblxuICAgIGZ1bmN0aW9uIGRldGVybWluZUZvbnRIZWlnaHQoZm9udFN0eWxlKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBoZWlnaHRDYWNoZVtmb250U3R5bGVdO1xuXG4gICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICB2YXIgYm9keSA9IGRvY3VtZW50LmJvZHkgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJib2R5XCIpWzBdLFxuICAgICAgICAgICAgICAgIGR1bW15ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcbiAgICAgICAgICAgICAgICBkdW1teVRleHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIk1cIik7XG5cbiAgICAgICAgICAgIGR1bW15LmFwcGVuZENoaWxkKGR1bW15VGV4dCk7XG4gICAgICAgICAgICBkdW1teS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImZvbnQ6IFwiICsgZm9udFN0eWxlICsgXCI7Zm9udC1zaXplOjFlbTtsaW5lLWhlaWdodDoxO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDtwYWRkaW5nOjA7bWFyZ2luOjA7XCIpO1xuICAgICAgICAgICAgYm9keS5hcHBlbmRDaGlsZChkdW1teSk7XG5cbiAgICAgICAgICAgIHJlc3VsdCA9IGR1bW15Lm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgIGhlaWdodENhY2hlW2ZvbnRTdHlsZV0gPSByZXN1bHQ7XG5cbiAgICAgICAgICAgIGJvZHkucmVtb3ZlQ2hpbGQoZHVtbXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIHJlbmRlck1lc2hGaWx0ZXJzKGNhbWVyYSwgbGlnaHRzLCBhbWJpZW50LCBtZXNoRmlsdGVycykge1xuICAgICAgICB2YXIgY29tcG9uZW50cyA9IG1lc2hGaWx0ZXJzLmNvbXBvbmVudHMsXG4gICAgICAgICAgICBtZXNoRmlsdGVyLCB0cmFuc2Zvcm0sIGksIGlsO1xuXG4gICAgICAgIGZvciAoaSA9IDAsIGlsID0gY29tcG9uZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7XG4gICAgICAgICAgICBtZXNoRmlsdGVyID0gY29tcG9uZW50c1tpXTtcbiAgICAgICAgICAgIHRyYW5zZm9ybSA9IG1lc2hGaWx0ZXIudHJhbnNmb3JtIHx8IG1lc2hGaWx0ZXIudHJhbnNmb3JtMmQ7XG5cbiAgICAgICAgICAgIGlmICghdHJhbnNmb3JtKSBjb250aW51ZTtcblxuICAgICAgICAgICAgdHJhbnNmb3JtLnVwZGF0ZU1hdHJpY2VzKGNhbWVyYS52aWV3KTtcbiAgICAgICAgICAgIHJlbmRlck1lc2hGaWx0ZXIoY2FtZXJhLCBsaWdodHMsIGFtYmllbnQsIHRyYW5zZm9ybSwgbWVzaEZpbHRlcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW5kZXJNZXNoRmlsdGVyKGNhbWVyYSwgbGlnaHRzLCBhbWJpZW50LCB0cmFuc2Zvcm0sIG1lc2hGaWx0ZXIpIHtcbiAgICAgICAgdmFyIG1lc2ggPSBtZXNoRmlsdGVyLm1lc2gsXG4gICAgICAgICAgICBtYXRlcmlhbCA9IG1lc2hGaWx0ZXIubWF0ZXJpYWwsXG4gICAgICAgICAgICBzaWRlLCBzaGFkZXI7XG5cbiAgICAgICAgaWYgKCFtZXNoIHx8ICFtYXRlcmlhbCkgcmV0dXJuO1xuXG4gICAgICAgIHNldEJsZW5kaW5nKG1hdGVyaWFsLmJsZW5kaW5nKTtcblxuICAgICAgICBzaWRlID0gbWF0ZXJpYWwuc2lkZTtcbiAgICAgICAgaWYgKHNpZGUgPT09IFNpZGUuRnJvbnQpIHtcbiAgICAgICAgICAgIHNldEN1bGxGYWNlKEN1bGxGYWNlLkJhY2spO1xuICAgICAgICB9IGVsc2UgaWYgKHNpZGUgPT09IFNpZGUuQmFjaykge1xuICAgICAgICAgICAgc2V0Q3VsbEZhY2UoQ3VsbEZhY2UuRnJvbnQpO1xuICAgICAgICB9IGVsc2UgaWYgKHNpZGUgPT09IFNpZGUuQm90aCkge1xuICAgICAgICAgICAgc2V0Q3VsbEZhY2UoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNyZWF0ZU1lc2hCdWZmZXJzKG1lc2gpO1xuICAgICAgICBzaGFkZXIgPSBjcmVhdGVTaGFkZXIobWVzaCwgbWF0ZXJpYWwsIGxpZ2h0cyk7XG4gICAgICAgIHNoYWRlci5iaW5kTWF0ZXJpYWwobWVzaEZpbHRlciwgbWVzaCwgbWF0ZXJpYWwsIHRyYW5zZm9ybSwgY2FtZXJhLCBsaWdodHMsIGFtYmllbnQpO1xuXG4gICAgICAgIGlmICghbWVzaEZpbHRlci5fd2ViZ2xNZXNoSW5pdHRlZCkge1xuICAgICAgICAgICAgbWVzaC5fd2ViZ2xVc2VkICs9IDE7XG4gICAgICAgICAgICBzaGFkZXIubWFya0FzVXNlZChtYXRlcmlhbCk7XG4gICAgICAgICAgICBtZXNoRmlsdGVyLl93ZWJnbE1lc2hJbml0dGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtYXRlcmlhbC53aXJlZnJhbWUpIHtcbiAgICAgICAgICAgIHNldExpbmVXaWR0aChtYXRlcmlhbC53aXJlZnJhbWVMaW5lV2lkdGgpO1xuICAgICAgICAgICAgX2dsLmRyYXdFbGVtZW50cyhfZ2wuTElORVMsIG1lc2guX3dlYmdsTGluZUNvdW50LCBfZ2wuVU5TSUdORURfU0hPUlQsIDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX2dsLmRyYXdFbGVtZW50cyhfZ2wuVFJJQU5HTEVTLCBtZXNoLl93ZWJnbEluZGV4Q291bnQsIF9nbC5VTlNJR05FRF9TSE9SVCwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIHJlbmRlclNwcml0ZXMoY2FtZXJhLCBsaWdodHMsIGFtYmllbnQsIHNwcml0ZXMpIHtcbiAgICAgICAgdmFyIGxheWVycyA9IHNwcml0ZXMubGF5ZXJzLFxuICAgICAgICAgICAgc3ByaXRlLCB0cmFuc2Zvcm0sIGNvbXBvbmVudHMsIGksIGlsLCBqLCBqbDtcblxuICAgICAgICBmb3IgKGkgPSAwLCBpbCA9IGxheWVycy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7XG4gICAgICAgICAgICBjb21wb25lbnRzID0gbGF5ZXJzW2ldO1xuICAgICAgICAgICAgaWYgKCFjb21wb25lbnRzKSBjb250aW51ZTtcblxuICAgICAgICAgICAgZm9yIChqID0gMCwgamwgPSBjb21wb25lbnRzLmxlbmd0aDsgaiA8IGpsOyBqKyspIHtcbiAgICAgICAgICAgICAgICBzcHJpdGUgPSBjb21wb25lbnRzW2pdO1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybSA9IHNwcml0ZS50cmFuc2Zvcm0gfHwgc3ByaXRlLnRyYW5zZm9ybTJkO1xuXG4gICAgICAgICAgICAgICAgaWYgKCF0cmFuc2Zvcm0pIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtLnVwZGF0ZU1hdHJpY2VzKGNhbWVyYS52aWV3KTtcbiAgICAgICAgICAgICAgICByZW5kZXJTcHJpdGUoY2FtZXJhLCBsaWdodHMsIGFtYmllbnQsIHRyYW5zZm9ybSwgc3ByaXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbmRlclNwcml0ZShjYW1lcmEsIGxpZ2h0cywgYW1iaWVudCwgdHJhbnNmb3JtLCBzcHJpdGUpIHtcbiAgICAgICAgdmFyIG1hdGVyaWFsID0gc3ByaXRlLm1hdGVyaWFsLFxuICAgICAgICAgICAgc2lkZSwgc2hhZGVyO1xuXG4gICAgICAgIGlmICghbWF0ZXJpYWwpIHJldHVybjtcbiAgICAgICAgaWYgKCFfc3ByaXRlQnVmZmVycykgY3JlYXRlU3ByaXRlKCk7XG5cbiAgICAgICAgc2V0QmxlbmRpbmcobWF0ZXJpYWwuYmxlbmRpbmcpO1xuXG4gICAgICAgIHNpZGUgPSBtYXRlcmlhbC5zaWRlO1xuICAgICAgICBpZiAoc2lkZSA9PT0gU2lkZS5Gcm9udCkge1xuICAgICAgICAgICAgc2V0Q3VsbEZhY2UoQ3VsbEZhY2UuQmFjayk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2lkZSA9PT0gU2lkZS5CYWNrKSB7XG4gICAgICAgICAgICBzZXRDdWxsRmFjZShDdWxsRmFjZS5Gcm9udCk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2lkZSA9PT0gU2lkZS5Cb3RoKSB7XG4gICAgICAgICAgICBzZXRDdWxsRmFjZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2hhZGVyID0gY3JlYXRlU2hhZGVyKHNwcml0ZSwgbWF0ZXJpYWwsIGxpZ2h0cyk7XG5cbiAgICAgICAgaWYgKCFzcHJpdGUuX3dlYmdsSW5pdHRlZCkge1xuICAgICAgICAgICAgc2hhZGVyLm1hcmtBc1VzZWQobWF0ZXJpYWwpO1xuICAgICAgICAgICAgc3ByaXRlLl93ZWJnbEluaXR0ZWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgc2hhZGVyLmJpbmRNYXRlcmlhbChzcHJpdGUsIHNwcml0ZSwgbWF0ZXJpYWwsIHRyYW5zZm9ybSwgY2FtZXJhLCBsaWdodHMsIGFtYmllbnQpO1xuXG4gICAgICAgIGlmIChtYXRlcmlhbC53aXJlZnJhbWUpIHtcbiAgICAgICAgICAgIHNldExpbmVXaWR0aChtYXRlcmlhbC53aXJlZnJhbWVMaW5lV2lkdGgpO1xuICAgICAgICAgICAgX2dsLmRyYXdBcnJheXMoX2dsLkxJTkVfU1RSSVAsIDAsIF9zcHJpdGVCdWZmZXJzLl93ZWJnbFZlcnRleENvdW50KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF9nbC5kcmF3QXJyYXlzKF9nbC5UUklBTkdMRV9TVFJJUCwgMCwgX3Nwcml0ZUJ1ZmZlcnMuX3dlYmdsVmVydGV4Q291bnQpO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiByZW5kZXJQYXJ0aWNsZVN5c3RlbXMoY2FtZXJhLCBsaWdodHMsIGFtYmllbnQsIHBhcnRpY2xlU3lzdGVtcykge1xuICAgICAgICB2YXIgY29tcG9uZW50cyA9IHBhcnRpY2xlU3lzdGVtcy5jb21wb25lbnRzLFxuICAgICAgICAgICAgcGFydGljbGVTeXN0ZW0sIHRyYW5zZm9ybSwgaSwgaWw7XG5cbiAgICAgICAgZm9yIChpID0gMCwgaWwgPSBjb21wb25lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHtcbiAgICAgICAgICAgIHBhcnRpY2xlU3lzdGVtID0gY29tcG9uZW50c1tpXTtcbiAgICAgICAgICAgIHRyYW5zZm9ybSA9IHBhcnRpY2xlU3lzdGVtLnRyYW5zZm9ybSB8fCBwYXJ0aWNsZVN5c3RlbS50cmFuc2Zvcm0yZDtcblxuICAgICAgICAgICAgaWYgKCF0cmFuc2Zvcm0pIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICB0cmFuc2Zvcm0udXBkYXRlTWF0cmljZXMoY2FtZXJhLnZpZXcpO1xuICAgICAgICAgICAgcmVuZGVyUGFydGljbGVTeXN0ZW0oY2FtZXJhLCBsaWdodHMsIGFtYmllbnQsIHRyYW5zZm9ybSwgcGFydGljbGVTeXN0ZW0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVuZGVyUGFydGljbGVTeXN0ZW0oY2FtZXJhLCBsaWdodHMsIGFtYmllbnQsIHRyYW5zZm9ybSwgcGFydGljbGVTeXN0ZW0pIHtcbiAgICAgICAgdmFyIGVtaXR0ZXJzID0gcGFydGljbGVTeXN0ZW0uZW1pdHRlcnMsXG4gICAgICAgICAgICBtYXRlcmlhbCA9IHBhcnRpY2xlU3lzdGVtLm1hdGVyaWFsLFxuICAgICAgICAgICAgc2hhZGVyLCBlbWl0dGVyLFxuICAgICAgICAgICAgaSA9IGVtaXR0ZXJzLmxlbmd0aDtcblxuICAgICAgICBzZXRDdWxsRmFjZShDdWxsRmFjZS5CYWNrKTtcblxuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBlbWl0dGVyID0gZW1pdHRlcnNbaV07XG5cbiAgICAgICAgICAgIGlmIChlbWl0dGVyIGluc3RhbmNlb2YgRW1pdHRlcikge1xuICAgICAgICAgICAgICAgIG1hdGVyaWFsID0gZW1pdHRlci5tYXRlcmlhbDtcbiAgICAgICAgICAgICAgICBpZiAoIW1hdGVyaWFsKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBzZXRCbGVuZGluZyhtYXRlcmlhbC5ibGVuZGluZyk7XG4gICAgICAgICAgICAgICAgc2V0Q3VsbEZhY2UoQ3VsbEZhY2UuQmFjayk7XG5cbiAgICAgICAgICAgICAgICBjcmVhdGVFbWl0dGVyQnVmZmVycyhlbWl0dGVyLCB0cmFuc2Zvcm0pO1xuICAgICAgICAgICAgICAgIHNoYWRlciA9IGNyZWF0ZVNoYWRlcihlbWl0dGVyLCBtYXRlcmlhbCwgbGlnaHRzKTtcbiAgICAgICAgICAgICAgICBzaGFkZXIuYmluZE1hdGVyaWFsKHBhcnRpY2xlU3lzdGVtLCBlbWl0dGVyLCBtYXRlcmlhbCwgdHJhbnNmb3JtLCBjYW1lcmEsIGxpZ2h0cywgYW1iaWVudCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWVtaXR0ZXIuX3dlYmdsSW5pdHRlZCkge1xuICAgICAgICAgICAgICAgICAgICBzaGFkZXIubWFya0FzVXNlZChtYXRlcmlhbCk7XG4gICAgICAgICAgICAgICAgICAgIGVtaXR0ZXIuX3dlYmdsSW5pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX2dsLmRyYXdBcnJheXMoX2dsLlBPSU5UUywgMCwgZW1pdHRlci5fd2ViZ2xQYXJ0aWNsZUNvdW50KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZW1pdHRlciBpbnN0YW5jZW9mIEVtaXR0ZXIyRCkge1xuICAgICAgICAgICAgICAgIG1hdGVyaWFsID0gZW1pdHRlci5tYXRlcmlhbDtcbiAgICAgICAgICAgICAgICBpZiAoIW1hdGVyaWFsKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBzZXRCbGVuZGluZyhtYXRlcmlhbC5ibGVuZGluZyk7XG4gICAgICAgICAgICAgICAgc2V0Q3VsbEZhY2UoQ3VsbEZhY2UuQmFjayk7XG5cbiAgICAgICAgICAgICAgICBjcmVhdGVFbWl0dGVyMkRCdWZmZXJzKGVtaXR0ZXIsIHRyYW5zZm9ybSk7XG4gICAgICAgICAgICAgICAgc2hhZGVyID0gY3JlYXRlU2hhZGVyKGVtaXR0ZXIsIG1hdGVyaWFsLCBsaWdodHMpO1xuICAgICAgICAgICAgICAgIHNoYWRlci5iaW5kTWF0ZXJpYWwocGFydGljbGVTeXN0ZW0sIGVtaXR0ZXIsIG1hdGVyaWFsLCB0cmFuc2Zvcm0sIGNhbWVyYSwgbGlnaHRzLCBhbWJpZW50KTtcblxuICAgICAgICAgICAgICAgIGlmICghZW1pdHRlci5fd2ViZ2xJbml0dGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYWRlci5tYXJrQXNVc2VkKG1hdGVyaWFsKTtcbiAgICAgICAgICAgICAgICAgICAgZW1pdHRlci5fd2ViZ2xJbml0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfZ2wuZHJhd0FycmF5cyhfZ2wuUE9JTlRTLCAwLCBlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQ291bnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkU2NlbmVFdmVudHMoc2NlbmUpIHtcbiAgICAgICAgdmFyIGNvbXBvbmVudE1hbmFnZXJzID0gc2NlbmUuY29tcG9uZW50TWFuYWdlcnMsXG4gICAgICAgICAgICBtZXNoRmlsdGVycyA9IGNvbXBvbmVudE1hbmFnZXJzLk1lc2hGaWx0ZXIgfHwgRU1QVFlfQVJSQVksXG4gICAgICAgICAgICBzcHJpdGVzID0gY29tcG9uZW50TWFuYWdlcnMuU3ByaXRlIHx8IEVNUFRZX0FSUkFZLFxuICAgICAgICAgICAgcGFydGljbGVTeXN0ZW1zID0gY29tcG9uZW50TWFuYWdlcnMuUGFydGljbGVTeXN0ZW0gfHwgRU1QVFlfQVJSQVksXG4gICAgICAgICAgICBpO1xuXG4gICAgICAgIG1lc2hGaWx0ZXJzLmZvckVhY2gob25NZXNoRmlsdGVyQWRkKTtcbiAgICAgICAgc3ByaXRlcy5mb3JFYWNoKG9uU3ByaXRlQWRkKTtcbiAgICAgICAgcGFydGljbGVTeXN0ZW1zLmZvckVhY2gob25QYXJ0aWNsZVN5c3RlbUFkZCk7XG5cbiAgICAgICAgc2NlbmUub24oXCJhZGRNZXNoRmlsdGVyXCIsIG9uTWVzaEZpbHRlckFkZCk7XG4gICAgICAgIHNjZW5lLm9uKFwiYWRkU3ByaXRlXCIsIG9uU3ByaXRlQWRkKTtcbiAgICAgICAgc2NlbmUub24oXCJhZGRQYXJ0aWNsZVN5c3RlbVwiLCBvblBhcnRpY2xlU3lzdGVtQWRkKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVTY2VuZUV2ZW50cyhzY2VuZSkge1xuXG4gICAgICAgIHNjZW5lLm9mZihcImFkZE1lc2hGaWx0ZXJcIiwgb25NZXNoRmlsdGVyQWRkKTtcbiAgICAgICAgc2NlbmUub2ZmKFwiYWRkU3ByaXRlXCIsIG9uU3ByaXRlQWRkKTtcbiAgICAgICAgc2NlbmUub2ZmKFwiYWRkUGFydGljbGVTeXN0ZW1cIiwgb25NZXNoRmlsdGVyQWRkKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbk1lc2hGaWx0ZXJBZGQobWVzaEZpbHRlcikge1xuXG4gICAgICAgIG1lc2hGaWx0ZXIub24oXCJyZW1vdmVcIiwgb25NZXNoRmlsdGVyUmVtb3ZlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblNwcml0ZUFkZChzcHJpdGUpIHtcblxuICAgICAgICBzcHJpdGUub24oXCJyZW1vdmVcIiwgb25TcHJpdGVSZW1vdmUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uUGFydGljbGVTeXN0ZW1BZGQocGFydGljbGVTeXN0ZW0pIHtcblxuICAgICAgICBwYXJ0aWNsZVN5c3RlbS5vbihcInJlbW92ZVwiLCBvblBhcnRpY2xlU3lzdGVtUmVtb3ZlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbk1lc2hGaWx0ZXJSZW1vdmUoKSB7XG4gICAgICAgIHZhciBtZXNoID0gdGhpcy5tZXNoO1xuXG4gICAgICAgIGRlbGV0ZU1lc2hCdWZmZXJzKG1lc2gpO1xuICAgICAgICBkZWxldGVTaGFkZXIobWVzaCk7XG5cbiAgICAgICAgdGhpcy5vZmYoXCJyZW1vdmVcIiwgb25NZXNoRmlsdGVyUmVtb3ZlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblNwcml0ZVJlbW92ZSgpIHtcblxuICAgICAgICBkZWxldGVTaGFkZXIodGhpcyk7XG5cbiAgICAgICAgdGhpcy5vZmYoXCJyZW1vdmVcIiwgb25TcHJpdGVSZW1vdmUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uUGFydGljbGVTeXN0ZW1SZW1vdmUoKSB7XG4gICAgICAgIHZhciBlbWl0dGVycyA9IHRoaXMuZW1pdHRlcnMsXG4gICAgICAgICAgICBlbWl0dGVyLCBpID0gZW1pdHRlcnMubGVuZ3RoO1xuXG4gICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgIGVtaXR0ZXIgPSBlbWl0dGVyc1tpXTtcblxuICAgICAgICAgICAgZGVsZXRlRW1pdHRlckJ1ZmZlcnMoZW1pdHRlcik7XG4gICAgICAgICAgICBkZWxldGVTaGFkZXIoZW1pdHRlcik7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm9mZihcInJlbW92ZVwiLCBvblBhcnRpY2xlU3lzdGVtUmVtb3ZlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVNZXNoQnVmZmVycyhtZXNoKSB7XG4gICAgICAgIGlmIChtZXNoLl93ZWJnbFVzZWQgPiAxKSB7XG4gICAgICAgICAgICBtZXNoLl93ZWJnbFVzZWQgLT0gMTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtZXNoLl93ZWJnbFZlcnRleEJ1ZmZlciAhPSB1bmRlZmluZWQpIF9nbC5kZWxldGVCdWZmZXIobWVzaC5fd2ViZ2xWZXJ0ZXhCdWZmZXIpO1xuICAgICAgICBpZiAobWVzaC5fd2ViZ2xOb3JtYWxCdWZmZXIgIT0gdW5kZWZpbmVkKSBfZ2wuZGVsZXRlQnVmZmVyKG1lc2guX3dlYmdsTm9ybWFsQnVmZmVyKTtcbiAgICAgICAgaWYgKG1lc2guX3dlYmdsVGFuZ2VudEJ1ZmZlciAhPSB1bmRlZmluZWQpIF9nbC5kZWxldGVCdWZmZXIobWVzaC5fd2ViZ2xUYW5nZW50QnVmZmVyKTtcbiAgICAgICAgaWYgKG1lc2guX3dlYmdsQ29sb3JCdWZmZXIgIT0gdW5kZWZpbmVkKSBfZ2wuZGVsZXRlQnVmZmVyKG1lc2guX3dlYmdsQ29sb3JCdWZmZXIpO1xuICAgICAgICBpZiAobWVzaC5fd2ViZ2xVdkJ1ZmZlciAhPSB1bmRlZmluZWQpIF9nbC5kZWxldGVCdWZmZXIobWVzaC5fd2ViZ2xVdkJ1ZmZlcik7XG4gICAgICAgIGlmIChtZXNoLl93ZWJnbFV2MkJ1ZmZlciAhPSB1bmRlZmluZWQpIF9nbC5kZWxldGVCdWZmZXIobWVzaC5fd2ViZ2xVdjJCdWZmZXIpO1xuXG4gICAgICAgIGlmIChtZXNoLl93ZWJnbEJvbmVJbmRleEJ1ZmZlciAhPSB1bmRlZmluZWQpIF9nbC5kZWxldGVCdWZmZXIobWVzaC5fd2ViZ2xCb25lSW5kZXhCdWZmZXIpO1xuICAgICAgICBpZiAobWVzaC5fd2ViZ2xCb25lV2VpZ2h0QnVmZmVyICE9IHVuZGVmaW5lZCkgX2dsLmRlbGV0ZUJ1ZmZlcihtZXNoLl93ZWJnbEJvbmVXZWlnaHRCdWZmZXIpO1xuXG4gICAgICAgIGlmIChtZXNoLl93ZWJnbEluZGV4QnVmZmVyICE9IHVuZGVmaW5lZCkgX2dsLmRlbGV0ZUJ1ZmZlcihtZXNoLl93ZWJnbEluZGV4QnVmZmVyKTtcbiAgICAgICAgaWYgKG1lc2guX3dlYmdsTGluZUJ1ZmZlciAhPSB1bmRlZmluZWQpIF9nbC5kZWxldGVCdWZmZXIobWVzaC5fd2ViZ2xMaW5lQnVmZmVyKTtcblxuICAgICAgICBtZXNoLl93ZWJnbFZlcnRleEFycmF5ID0gbWVzaC5fd2ViZ2xWZXJ0ZXhBcnJheSA9IHVuZGVmaW5lZDtcbiAgICAgICAgbWVzaC5fd2ViZ2xOb3JtYWxCdWZmZXIgPSBtZXNoLl93ZWJnbE5vcm1hbEFycmF5ID0gdW5kZWZpbmVkO1xuICAgICAgICBtZXNoLl93ZWJnbFRhbmdlbnRCdWZmZXIgPSBtZXNoLl93ZWJnbFRhbmdlbnRBcnJheSA9IHVuZGVmaW5lZDtcbiAgICAgICAgbWVzaC5fd2ViZ2xDb2xvckJ1ZmZlciA9IG1lc2guX3dlYmdsQ29sb3JBcnJheSA9IHVuZGVmaW5lZDtcbiAgICAgICAgbWVzaC5fd2ViZ2xVdkJ1ZmZlciA9IG1lc2guX3dlYmdsVXZBcnJheSA9IHVuZGVmaW5lZDtcbiAgICAgICAgbWVzaC5fd2ViZ2xVdjJCdWZmZXIgPSBtZXNoLl93ZWJnbFV2MkFycmF5ID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIG1lc2guX3dlYmdsQm9uZUluZGV4QnVmZmVyID0gbWVzaC5fd2ViZ2xCb25lSW5kZXhBcnJheSA9IHVuZGVmaW5lZDtcbiAgICAgICAgbWVzaC5fd2ViZ2xCb25lV2VpZ2h0QnVmZmVyID0gbWVzaC5fd2ViZ2xCb25lV2VpZ2h0QXJyYXkgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgbWVzaC5fd2ViZ2xJbmRleEJ1ZmZlciA9IG1lc2guX3dlYmdsSW5kZXhBcnJheSA9IHVuZGVmaW5lZDtcbiAgICAgICAgbWVzaC5fd2ViZ2xMaW5lQnVmZmVyID0gbWVzaC5fd2ViZ2xMaW5lQXJyYXkgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgbWVzaC5fd2ViZ2xVc2VkID0gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVFbWl0dGVyQnVmZmVycyhlbWl0dGVyKSB7XG5cbiAgICAgICAgaWYgKGVtaXR0ZXIuX3dlYmdsVmVydGV4QnVmZmVyICE9IHVuZGVmaW5lZCkgX2dsLmRlbGV0ZUJ1ZmZlcihlbWl0dGVyLl93ZWJnbFZlcnRleEJ1ZmZlcik7XG4gICAgICAgIGlmIChlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQnVmZmVyICE9IHVuZGVmaW5lZCkgX2dsLmRlbGV0ZUJ1ZmZlcihlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQnVmZmVyKTtcbiAgICAgICAgaWYgKGVtaXR0ZXIuX3dlYmdsUGFydGljbGVDb2xvckJ1ZmZlciAhPSB1bmRlZmluZWQpIF9nbC5kZWxldGVCdWZmZXIoZW1pdHRlci5fd2ViZ2xQYXJ0aWNsZUNvbG9yQnVmZmVyKTtcblxuICAgICAgICBlbWl0dGVyLl93ZWJnbFZlcnRleEJ1ZmZlciA9IGVtaXR0ZXIuX3dlYmdsVmVydGV4QXJyYXkgPSB1bmRlZmluZWQ7XG4gICAgICAgIGVtaXR0ZXIuX3dlYmdsUGFydGljbGVCdWZmZXIgPSBlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQXJyYXkgPSB1bmRlZmluZWQ7XG4gICAgICAgIGVtaXR0ZXIuX3dlYmdsUGFydGljbGVDb2xvckJ1ZmZlciA9IGVtaXR0ZXIuX3dlYmdsUGFydGljbGVDb2xvckFycmF5ID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZEdVSUV2ZW50cyhndWkpIHtcbiAgICAgICAgdmFyIGNvbXBvbmVudE1hbmFnZXJzID0gZ3VpLmNvbXBvbmVudE1hbmFnZXJzLFxuICAgICAgICAgICAgZ3VpQ29udGVudHMgPSBjb21wb25lbnRNYW5hZ2Vycy5HVUlDb250ZW50O1xuXG4gICAgICAgIGlmIChndWlDb250ZW50cykgZ3VpQ29udGVudHMuZm9yRWFjaChvbkdVSUNvbnRlbnRBZGQpO1xuICAgICAgICBndWkub24oXCJhZGRHVUlDb250ZW50XCIsIG9uR1VJQ29udGVudEFkZCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVtb3ZlR1VJRXZlbnRzKGd1aSkge1xuXG4gICAgICAgIGd1aS5vZmYoXCJhZGRHVUlDb250ZW50XCIsIG9uR1VJQ29udGVudEFkZCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25HVUlDb250ZW50QWRkKGd1aUNvbnRlbnQpIHtcblxuICAgICAgICBndWlDb250ZW50Lm9uKFwicmVtb3ZlXCIsIG9uR1VJQ29udGVudFJlbW92ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25HVUlDb250ZW50UmVtb3ZlKCkge1xuXG4gICAgICAgIGRlbGV0ZVNoYWRlcih0aGlzKTtcblxuICAgICAgICB0aGlzLm9mZihcInJlbW92ZVwiLCBvbkdVSUNvbnRlbnRSZW1vdmUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbGV0ZVNoYWRlcihvYmopIHtcbiAgICAgICAgdmFyIHNoYWRlciA9IF9zaGFkZXJzW29iai5faWRdO1xuICAgICAgICBpZiAoIXNoYWRlcikgcmV0dXJuO1xuICAgICAgICB2YXIgbWF0ZXJpYWwgPSBvYmoubWF0ZXJpYWwgfHwgb2JqLm1hdGVyaWFscyxcbiAgICAgICAgICAgIGk7XG5cbiAgICAgICAgaWYgKG1hdGVyaWFsKSB7XG4gICAgICAgICAgICBpID0gbWF0ZXJpYWwubGVuZ3RoO1xuXG4gICAgICAgICAgICBpZiAoaSkge1xuICAgICAgICAgICAgICAgIHdoaWxlIChpLS0pIGRlbGV0ZU1hdGVyaWFsKG1hdGVyaWFsW2ldKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlTWF0ZXJpYWwobWF0ZXJpYWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNoYWRlci51c2VkID4gMSkge1xuICAgICAgICAgICAgc2hhZGVyLnVzZWQtLTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIF9zaGFkZXJzW29iai5faWRdID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoc2hhZGVyLnByb2dyYW0pIF9nbC5kZWxldGVQcm9ncmFtKHNoYWRlci5wcm9ncmFtKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVNYXRlcmlhbChtYXRlcmlhbCkge1xuICAgICAgICB2YXIgbWF0ZXJpYWxVbmlmb3JtcyA9IG1hdGVyaWFsLnVuaWZvcm1zLFxuICAgICAgICAgICAga2V5O1xuXG4gICAgICAgIGZvciAoa2V5IGluIG1hdGVyaWFsVW5pZm9ybXMpIGRlbGV0ZVRleHR1cmUobWF0ZXJpYWxVbmlmb3Jtc1trZXldKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVUZXh0dXJlKG9iaikge1xuICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgVGV4dHVyZSkge1xuICAgICAgICAgICAgaWYgKG9iai5fd2ViZ2xVc2VkID4gMSkge1xuICAgICAgICAgICAgICAgIG9iai5fd2ViZ2xVc2VkIC09IDE7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfZ2wuZGVsZXRlVGV4dHVyZShvYmouX3dlYmdsKTtcbiAgICAgICAgICAgIG9iai5fd2ViZ2wgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBvYmouX3dlYmdsVXNlZCA9IDA7XG4gICAgICAgIH0gZWxzZSBpZiAob2JqIGluc3RhbmNlb2YgVGV4dHVyZUN1YmUpIHtcbiAgICAgICAgICAgIGlmIChvYmouX3dlYmdsVXNlZCA+IDEpIHtcbiAgICAgICAgICAgICAgICBvYmouX3dlYmdsVXNlZCAtPSAxO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGogPSBvYmouX3dlYmdsLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChqLS0pIHtcbiAgICAgICAgICAgICAgICBfZ2wuZGVsZXRlVGV4dHVyZShvYmouX3dlYmdsW2pdKTtcbiAgICAgICAgICAgICAgICBvYmouX3dlYmdsW2pdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIG9iai5fd2ViZ2xVc2VkID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZU1lc2hCdWZmZXJzKG1lc2gpIHtcbiAgICAgICAgaWYgKCFtZXNoLmR5bmFtaWMgJiYgbWVzaC5fd2ViZ2xCdWZmZXJzSW5pdHRlZCkgcmV0dXJuO1xuICAgICAgICB2YXIgRFJBVyA9IG1lc2guZHluYW1pYyA/IF9nbC5EWU5BTUlDX0RSQVcgOiBfZ2wuU1RBVElDX0RSQVcsXG4gICAgICAgICAgICBBUlJBWV9CVUZGRVIgPSBfZ2wuQVJSQVlfQlVGRkVSLFxuICAgICAgICAgICAgRUxFTUVOVF9BUlJBWV9CVUZGRVIgPSBfZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIsXG4gICAgICAgICAgICBidWZmZXJBcnJheSwgaXRlbXMsIGl0ZW0sIGksIGxlbiwgb2Zmc2V0LCB2ZXJ0ZXhJbmRleDtcblxuICAgICAgICBpdGVtcyA9IG1lc2gudmVydGljZXMgfHwgRU1QVFlfQVJSQVk7XG4gICAgICAgIGxlbiA9IGl0ZW1zLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiAmJiBtZXNoLnZlcnRpY2VzTmVlZFVwZGF0ZSkge1xuICAgICAgICAgICAgYnVmZmVyQXJyYXkgPSBtZXNoLl93ZWJnbFZlcnRleEFycmF5O1xuICAgICAgICAgICAgaWYgKCFidWZmZXJBcnJheSB8fCBidWZmZXJBcnJheS5sZW5ndGggIT09IGxlbiAqIDMpIHtcbiAgICAgICAgICAgICAgICBidWZmZXJBcnJheSA9IG1lc2guX3dlYmdsVmVydGV4QXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KGxlbiAqIDMpO1xuICAgICAgICAgICAgICAgIG1lc2guX3dlYmdsVmVydGV4Q291bnQgPSBsZW47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGkgPSBsZW47XG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgaXRlbSA9IGl0ZW1zW2ldO1xuICAgICAgICAgICAgICAgIG9mZnNldCA9IGkgKiAzO1xuXG4gICAgICAgICAgICAgICAgYnVmZmVyQXJyYXlbb2Zmc2V0XSA9IGl0ZW0ueDtcbiAgICAgICAgICAgICAgICBidWZmZXJBcnJheVtvZmZzZXQgKyAxXSA9IGl0ZW0ueTtcbiAgICAgICAgICAgICAgICBidWZmZXJBcnJheVtvZmZzZXQgKyAyXSA9IGl0ZW0uejtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbWVzaC5fd2ViZ2xWZXJ0ZXhCdWZmZXIgPSBtZXNoLl93ZWJnbFZlcnRleEJ1ZmZlciB8fCBfZ2wuY3JlYXRlQnVmZmVyKCk7XG4gICAgICAgICAgICBfZ2wuYmluZEJ1ZmZlcihBUlJBWV9CVUZGRVIsIG1lc2guX3dlYmdsVmVydGV4QnVmZmVyKTtcbiAgICAgICAgICAgIF9nbC5idWZmZXJEYXRhKEFSUkFZX0JVRkZFUiwgYnVmZmVyQXJyYXksIERSQVcpO1xuXG4gICAgICAgICAgICBtZXNoLnZlcnRpY2VzTmVlZFVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaXRlbXMgPSBtZXNoLm5vcm1hbHMgfHwgRU1QVFlfQVJSQVk7XG4gICAgICAgIGxlbiA9IGl0ZW1zLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiAmJiBtZXNoLm5vcm1hbHNOZWVkVXBkYXRlKSB7XG4gICAgICAgICAgICBidWZmZXJBcnJheSA9IG1lc2guX3dlYmdsTm9ybWFsQXJyYXk7XG4gICAgICAgICAgICBpZiAoIWJ1ZmZlckFycmF5IHx8IGJ1ZmZlckFycmF5Lmxlbmd0aCAhPT0gbGVuICogMykgYnVmZmVyQXJyYXkgPSBtZXNoLl93ZWJnbE5vcm1hbEFycmF5ID0gbmV3IEZsb2F0MzJBcnJheShsZW4gKiAzKTtcblxuICAgICAgICAgICAgaSA9IGxlbjtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgICBpdGVtID0gaXRlbXNbaV07XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gaSAqIDM7XG5cbiAgICAgICAgICAgICAgICBidWZmZXJBcnJheVtvZmZzZXRdID0gaXRlbS54O1xuICAgICAgICAgICAgICAgIGJ1ZmZlckFycmF5W29mZnNldCArIDFdID0gaXRlbS55O1xuICAgICAgICAgICAgICAgIGJ1ZmZlckFycmF5W29mZnNldCArIDJdID0gaXRlbS56O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtZXNoLl93ZWJnbE5vcm1hbEJ1ZmZlciA9IG1lc2guX3dlYmdsTm9ybWFsQnVmZmVyIHx8IF9nbC5jcmVhdGVCdWZmZXIoKTtcbiAgICAgICAgICAgIF9nbC5iaW5kQnVmZmVyKEFSUkFZX0JVRkZFUiwgbWVzaC5fd2ViZ2xOb3JtYWxCdWZmZXIpO1xuICAgICAgICAgICAgX2dsLmJ1ZmZlckRhdGEoQVJSQVlfQlVGRkVSLCBidWZmZXJBcnJheSwgRFJBVyk7XG5cbiAgICAgICAgICAgIG1lc2gubm9ybWFsc05lZWRVcGRhdGUgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGl0ZW1zID0gbWVzaC50YW5nZW50cyB8fCBFTVBUWV9BUlJBWTtcbiAgICAgICAgbGVuID0gaXRlbXMubGVuZ3RoO1xuICAgICAgICBpZiAobGVuICYmIG1lc2gudGFuZ2VudHNOZWVkVXBkYXRlKSB7XG4gICAgICAgICAgICBidWZmZXJBcnJheSA9IG1lc2guX3dlYmdsVGFuZ2VudEFycmF5O1xuICAgICAgICAgICAgaWYgKCFidWZmZXJBcnJheSB8fCBidWZmZXJBcnJheS5sZW5ndGggIT09IGxlbiAqIDQpIGJ1ZmZlckFycmF5ID0gbWVzaC5fd2ViZ2xUYW5nZW50QXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KGxlbiAqIDQpO1xuXG4gICAgICAgICAgICBpID0gbGVuO1xuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIGl0ZW0gPSBpdGVtc1tpXTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBpICogNDtcblxuICAgICAgICAgICAgICAgIGJ1ZmZlckFycmF5W29mZnNldF0gPSBpdGVtLng7XG4gICAgICAgICAgICAgICAgYnVmZmVyQXJyYXlbb2Zmc2V0ICsgMV0gPSBpdGVtLnk7XG4gICAgICAgICAgICAgICAgYnVmZmVyQXJyYXlbb2Zmc2V0ICsgMl0gPSBpdGVtLno7XG4gICAgICAgICAgICAgICAgYnVmZmVyQXJyYXlbb2Zmc2V0ICsgM10gPSBpdGVtLnc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1lc2guX3dlYmdsVGFuZ2VudEJ1ZmZlciA9IG1lc2guX3dlYmdsVGFuZ2VudEJ1ZmZlciB8fCBfZ2wuY3JlYXRlQnVmZmVyKCk7XG4gICAgICAgICAgICBfZ2wuYmluZEJ1ZmZlcihBUlJBWV9CVUZGRVIsIG1lc2guX3dlYmdsVGFuZ2VudEJ1ZmZlcik7XG4gICAgICAgICAgICBfZ2wuYnVmZmVyRGF0YShBUlJBWV9CVUZGRVIsIGJ1ZmZlckFycmF5LCBEUkFXKTtcblxuICAgICAgICAgICAgbWVzaC50YW5nZW50c05lZWRVcGRhdGUgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGl0ZW1zID0gbWVzaC5pbmRpY2VzIHx8IEVNUFRZX0FSUkFZO1xuICAgICAgICBsZW4gPSBpdGVtcy5sZW5ndGg7XG4gICAgICAgIGlmIChsZW4gJiYgbWVzaC5pbmRpY2VzTmVlZFVwZGF0ZSkge1xuICAgICAgICAgICAgYnVmZmVyQXJyYXkgPSBtZXNoLl93ZWJnbEluZGV4QXJyYXk7XG4gICAgICAgICAgICBpZiAoIWJ1ZmZlckFycmF5IHx8IGJ1ZmZlckFycmF5Lmxlbmd0aCAhPT0gbGVuKSB7XG4gICAgICAgICAgICAgICAgYnVmZmVyQXJyYXkgPSBtZXNoLl93ZWJnbEluZGV4QXJyYXkgPSBuZXcgVWludDE2QXJyYXkobGVuKTtcbiAgICAgICAgICAgICAgICBtZXNoLl93ZWJnbEluZGV4Q291bnQgPSBsZW47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGkgPSBsZW47XG4gICAgICAgICAgICB3aGlsZSAoaS0tKSBidWZmZXJBcnJheVtpXSA9IGl0ZW1zW2ldO1xuXG4gICAgICAgICAgICBtZXNoLl93ZWJnbEluZGV4QnVmZmVyID0gbWVzaC5fd2ViZ2xJbmRleEJ1ZmZlciB8fCBfZ2wuY3JlYXRlQnVmZmVyKCk7XG4gICAgICAgICAgICBfZ2wuYmluZEJ1ZmZlcihFTEVNRU5UX0FSUkFZX0JVRkZFUiwgbWVzaC5fd2ViZ2xJbmRleEJ1ZmZlcik7XG4gICAgICAgICAgICBfZ2wuYnVmZmVyRGF0YShFTEVNRU5UX0FSUkFZX0JVRkZFUiwgYnVmZmVyQXJyYXksIERSQVcpO1xuXG4gICAgICAgICAgICBidWZmZXJBcnJheSA9IG1lc2guX3dlYmdsTGluZUFycmF5O1xuICAgICAgICAgICAgaWYgKCFidWZmZXJBcnJheSB8fCBidWZmZXJBcnJheS5sZW5ndGggIT09IGxlbiAqIDMpIHtcbiAgICAgICAgICAgICAgICBidWZmZXJBcnJheSA9IG1lc2guX3dlYmdsTGluZUFycmF5ID0gbmV3IFVpbnQxNkFycmF5KGxlbiAqIDMpO1xuICAgICAgICAgICAgICAgIG1lc2guX3dlYmdsTGluZUNvdW50ID0gbGVuICogMztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaSA9IGxlbjtcbiAgICAgICAgICAgIHZlcnRleEluZGV4ID0gb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcblxuICAgICAgICAgICAgICAgIGJ1ZmZlckFycmF5W29mZnNldF0gPSBpdGVtc1t2ZXJ0ZXhJbmRleF07XG4gICAgICAgICAgICAgICAgYnVmZmVyQXJyYXlbb2Zmc2V0ICsgMV0gPSBpdGVtc1t2ZXJ0ZXhJbmRleCArIDFdO1xuXG4gICAgICAgICAgICAgICAgYnVmZmVyQXJyYXlbb2Zmc2V0ICsgMl0gPSBpdGVtc1t2ZXJ0ZXhJbmRleF07XG4gICAgICAgICAgICAgICAgYnVmZmVyQXJyYXlbb2Zmc2V0ICsgM10gPSBpdGVtc1t2ZXJ0ZXhJbmRleCArIDJdO1xuXG4gICAgICAgICAgICAgICAgYnVmZmVyQXJyYXlbb2Zmc2V0ICsgNF0gPSBpdGVtc1t2ZXJ0ZXhJbmRleCArIDFdO1xuICAgICAgICAgICAgICAgIGJ1ZmZlckFycmF5W29mZnNldCArIDVdID0gaXRlbXNbdmVydGV4SW5kZXggKyAyXTtcblxuICAgICAgICAgICAgICAgIG9mZnNldCArPSA2O1xuICAgICAgICAgICAgICAgIHZlcnRleEluZGV4ICs9IDM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1lc2guX3dlYmdsTGluZUJ1ZmZlciA9IG1lc2guX3dlYmdsTGluZUJ1ZmZlciB8fCBfZ2wuY3JlYXRlQnVmZmVyKCk7XG4gICAgICAgICAgICBfZ2wuYmluZEJ1ZmZlcihFTEVNRU5UX0FSUkFZX0JVRkZFUiwgbWVzaC5fd2ViZ2xMaW5lQnVmZmVyKTtcbiAgICAgICAgICAgIF9nbC5idWZmZXJEYXRhKEVMRU1FTlRfQVJSQVlfQlVGRkVSLCBidWZmZXJBcnJheSwgRFJBVyk7XG5cbiAgICAgICAgICAgIG1lc2guaW5kaWNlc05lZWRVcGRhdGUgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGl0ZW1zID0gbWVzaC5jb2xvcnMgfHwgRU1QVFlfQVJSQVk7XG4gICAgICAgIGxlbiA9IGl0ZW1zLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiAmJiBtZXNoLmNvbG9yc05lZWRVcGRhdGUpIHtcbiAgICAgICAgICAgIGJ1ZmZlckFycmF5ID0gbWVzaC5fd2ViZ2xDb2xvckFycmF5O1xuICAgICAgICAgICAgaWYgKCFidWZmZXJBcnJheSB8fCBidWZmZXJBcnJheS5sZW5ndGggIT09IGxlbiAqIDMpIGJ1ZmZlckFycmF5ID0gbWVzaC5fd2ViZ2xDb2xvckFycmF5ID0gbmV3IEZsb2F0MzJBcnJheShsZW4gKiAzKTtcblxuICAgICAgICAgICAgaSA9IGxlbjtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgICBpdGVtID0gaXRlbXNbaV07XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gaSAqIDM7XG5cbiAgICAgICAgICAgICAgICBidWZmZXJBcnJheVtvZmZzZXRdID0gaXRlbS54O1xuICAgICAgICAgICAgICAgIGJ1ZmZlckFycmF5W29mZnNldCArIDFdID0gaXRlbS55O1xuICAgICAgICAgICAgICAgIGJ1ZmZlckFycmF5W29mZnNldCArIDJdID0gaXRlbS56O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtZXNoLl93ZWJnbENvbG9yQnVmZmVyID0gbWVzaC5fd2ViZ2xDb2xvckJ1ZmZlciB8fCBfZ2wuY3JlYXRlQnVmZmVyKCk7XG4gICAgICAgICAgICBfZ2wuYmluZEJ1ZmZlcihBUlJBWV9CVUZGRVIsIG1lc2guX3dlYmdsQ29sb3JCdWZmZXIpO1xuICAgICAgICAgICAgX2dsLmJ1ZmZlckRhdGEoQVJSQVlfQlVGRkVSLCBidWZmZXJBcnJheSwgRFJBVyk7XG5cbiAgICAgICAgICAgIG1lc2guY29sb3JzTmVlZFVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaXRlbXMgPSBtZXNoLnV2cyB8fCBFTVBUWV9BUlJBWTtcbiAgICAgICAgbGVuID0gaXRlbXMubGVuZ3RoO1xuICAgICAgICBpZiAobGVuICYmIG1lc2gudXZzTmVlZFVwZGF0ZSkge1xuICAgICAgICAgICAgYnVmZmVyQXJyYXkgPSBtZXNoLl93ZWJnbFV2QXJyYXk7XG4gICAgICAgICAgICBpZiAoIWJ1ZmZlckFycmF5IHx8IGJ1ZmZlckFycmF5Lmxlbmd0aCAhPT0gbGVuICogMikgYnVmZmVyQXJyYXkgPSBtZXNoLl93ZWJnbFV2QXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KGxlbiAqIDIpO1xuXG4gICAgICAgICAgICBpID0gbGVuO1xuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIGl0ZW0gPSBpdGVtc1tpXTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBpICogMjtcblxuICAgICAgICAgICAgICAgIGJ1ZmZlckFycmF5W29mZnNldF0gPSBpdGVtLng7XG4gICAgICAgICAgICAgICAgYnVmZmVyQXJyYXlbb2Zmc2V0ICsgMV0gPSBpdGVtLnk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1lc2guX3dlYmdsVXZCdWZmZXIgPSBtZXNoLl93ZWJnbFV2QnVmZmVyIHx8IF9nbC5jcmVhdGVCdWZmZXIoKTtcbiAgICAgICAgICAgIF9nbC5iaW5kQnVmZmVyKEFSUkFZX0JVRkZFUiwgbWVzaC5fd2ViZ2xVdkJ1ZmZlcik7XG4gICAgICAgICAgICBfZ2wuYnVmZmVyRGF0YShBUlJBWV9CVUZGRVIsIGJ1ZmZlckFycmF5LCBEUkFXKTtcblxuICAgICAgICAgICAgbWVzaC51dnNOZWVkVXBkYXRlID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpdGVtcyA9IG1lc2gudXYycyB8fCBFTVBUWV9BUlJBWTtcbiAgICAgICAgbGVuID0gaXRlbXMubGVuZ3RoO1xuICAgICAgICBpZiAobGVuICYmIG1lc2gudXYyc05lZWRVcGRhdGUpIHtcbiAgICAgICAgICAgIGJ1ZmZlckFycmF5ID0gbWVzaC5fd2ViZ2xVdjJBcnJheTtcbiAgICAgICAgICAgIGlmICghYnVmZmVyQXJyYXkgfHwgYnVmZmVyQXJyYXkubGVuZ3RoICE9PSBsZW4gKiAyKSBidWZmZXJBcnJheSA9IG1lc2guX3dlYmdsVXYyQXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KGxlbiAqIDIpO1xuXG4gICAgICAgICAgICBpID0gbGVuO1xuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIGl0ZW0gPSBpdGVtc1tpXTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBpICogMjtcblxuICAgICAgICAgICAgICAgIGJ1ZmZlckFycmF5W29mZnNldF0gPSBpdGVtLng7XG4gICAgICAgICAgICAgICAgYnVmZmVyQXJyYXlbb2Zmc2V0ICsgMV0gPSBpdGVtLnk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1lc2guX3dlYmdsVXYyQnVmZmVyID0gbWVzaC5fd2ViZ2xVdjJCdWZmZXIgfHwgX2dsLmNyZWF0ZUJ1ZmZlcigpO1xuICAgICAgICAgICAgX2dsLmJpbmRCdWZmZXIoQVJSQVlfQlVGRkVSLCBtZXNoLl93ZWJnbFV2MkJ1ZmZlcik7XG4gICAgICAgICAgICBfZ2wuYnVmZmVyRGF0YShBUlJBWV9CVUZGRVIsIGJ1ZmZlckFycmF5LCBEUkFXKTtcblxuICAgICAgICAgICAgbWVzaC51dnNOZWVkVXBkYXRlID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpdGVtcyA9IG1lc2guYm9uZUluZGljZXMgfHwgRU1QVFlfQVJSQVk7XG4gICAgICAgIGxlbiA9IGl0ZW1zLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiAmJiBtZXNoLmJvbmVJbmRpY2VzTmVlZFVwZGF0ZSkge1xuICAgICAgICAgICAgYnVmZmVyQXJyYXkgPSBtZXNoLl93ZWJnbEJvbmVJbmRleEFycmF5O1xuICAgICAgICAgICAgaWYgKCFidWZmZXJBcnJheSB8fCBidWZmZXJBcnJheS5sZW5ndGggIT09IGxlbikgYnVmZmVyQXJyYXkgPSBtZXNoLl93ZWJnbEJvbmVJbmRleEFycmF5ID0gbmV3IEZsb2F0MzJBcnJheShsZW4pO1xuXG4gICAgICAgICAgICBpID0gbGVuO1xuICAgICAgICAgICAgd2hpbGUgKGktLSkgYnVmZmVyQXJyYXlbaV0gPSBpdGVtc1tpXTtcblxuICAgICAgICAgICAgbWVzaC5fd2ViZ2xCb25lSW5kZXhCdWZmZXIgPSBtZXNoLl93ZWJnbEJvbmVJbmRleEJ1ZmZlciB8fCBfZ2wuY3JlYXRlQnVmZmVyKCk7XG4gICAgICAgICAgICBfZ2wuYmluZEJ1ZmZlcihBUlJBWV9CVUZGRVIsIG1lc2guX3dlYmdsQm9uZUluZGV4QnVmZmVyKTtcbiAgICAgICAgICAgIF9nbC5idWZmZXJEYXRhKEFSUkFZX0JVRkZFUiwgYnVmZmVyQXJyYXksIERSQVcpO1xuXG4gICAgICAgICAgICBtZXNoLmJvbmVJbmRpY2VzTmVlZFVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaXRlbXMgPSBtZXNoLmJvbmVXZWlnaHRzIHx8IEVNUFRZX0FSUkFZO1xuICAgICAgICBsZW4gPSBpdGVtcy5sZW5ndGg7XG4gICAgICAgIGlmIChsZW4gJiYgbWVzaC5ib25lV2VpZ2h0c05lZWRVcGRhdGUpIHtcbiAgICAgICAgICAgIGJ1ZmZlckFycmF5ID0gbWVzaC5fd2ViZ2xCb25lV2VpZ2h0QXJyYXk7XG4gICAgICAgICAgICBpZiAoIWJ1ZmZlckFycmF5IHx8IGJ1ZmZlckFycmF5Lmxlbmd0aCAhPT0gbGVuKSBidWZmZXJBcnJheSA9IG1lc2guX3dlYmdsQm9uZVdlaWdodEFycmF5ID0gbmV3IEZsb2F0MzJBcnJheShsZW4pO1xuXG4gICAgICAgICAgICBpID0gbGVuO1xuICAgICAgICAgICAgd2hpbGUgKGktLSkgYnVmZmVyQXJyYXlbaV0gPSBpdGVtc1tpXTtcblxuICAgICAgICAgICAgbWVzaC5fd2ViZ2xCb25lV2VpZ2h0QnVmZmVyID0gbWVzaC5fd2ViZ2xCb25lV2VpZ2h0QnVmZmVyIHx8IF9nbC5jcmVhdGVCdWZmZXIoKTtcbiAgICAgICAgICAgIF9nbC5iaW5kQnVmZmVyKEFSUkFZX0JVRkZFUiwgbWVzaC5fd2ViZ2xCb25lV2VpZ2h0QnVmZmVyKTtcbiAgICAgICAgICAgIF9nbC5idWZmZXJEYXRhKEFSUkFZX0JVRkZFUiwgYnVmZmVyQXJyYXksIERSQVcpO1xuXG4gICAgICAgICAgICBtZXNoLmJvbmVXZWlnaHRzTmVlZFVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgbWVzaC5fd2ViZ2xCdWZmZXJzSW5pdHRlZCA9IHRydWU7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBjcmVhdGVFbWl0dGVyQnVmZmVycyhlbWl0dGVyLCB0cmFuc2Zvcm0pIHtcbiAgICAgICAgdmFyIE1BWCA9IEVtaXR0ZXIuTUFYX1BBUlRJQ0xFUyxcblxuICAgICAgICAgICAgRFJBVyA9IF9nbC5EWU5BTUlDX0RSQVcsXG4gICAgICAgICAgICBBUlJBWV9CVUZGRVIgPSBfZ2wuQVJSQVlfQlVGRkVSLFxuXG4gICAgICAgICAgICBwb3NpdGlvbkFycmF5LCBkYXRhQXJyYXksIGNvbG9yQXJyYXksXG4gICAgICAgICAgICBwb3NpdGlvbkJ1ZmZlciwgZGF0YUJ1ZmZlciwgY29sb3JCdWZmZXIsXG5cbiAgICAgICAgICAgIHBhcnRpY2xlcyA9IGVtaXR0ZXIucGFydGljbGVzLFxuICAgICAgICAgICAgcGFydGljbGUsXG4gICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgIGxlbiA9IHBhcnRpY2xlcy5sZW5ndGgsXG4gICAgICAgICAgICBvZmZzZXQsIHBvc2l0aW9uLCBjb2xvcixcbiAgICAgICAgICAgIG1lLCB4LCB5LCB6LFxuICAgICAgICAgICAgbTEzLCBtMjMsIG0zMywgbTQzLFxuICAgICAgICAgICAgbTE0LCBtMjQsIG0zNCwgbTQ0XG5cbiAgICAgICAgaWYgKGxlbikge1xuICAgICAgICAgICAgaWYgKGVtaXR0ZXIuc29ydCkge1xuICAgICAgICAgICAgICAgIGVtaXR0ZXIud29ybGRTcGFjZSA/IF9tYXQ0LmNvcHkoX3Byb2pTY3JlZW5NYXRyaXgpIDogX21hdDQubW11bChfcHJvalNjcmVlbk1hdHJpeCwgdHJhbnNmb3JtLm1hdHJpeFdvcmxkKTtcbiAgICAgICAgICAgICAgICBtZSA9IF9tYXQ0LmVsZW1lbnRzO1xuICAgICAgICAgICAgICAgIG0xMyA9IG1lWzJdO1xuICAgICAgICAgICAgICAgIG0yMyA9IG1lWzZdO1xuICAgICAgICAgICAgICAgIG0zMyA9IG1lWzEwXTtcbiAgICAgICAgICAgICAgICBtNDMgPSBtZVsxNF07XG4gICAgICAgICAgICAgICAgbTE0ID0gbWVbM107XG4gICAgICAgICAgICAgICAgbTI0ID0gbWVbN107XG4gICAgICAgICAgICAgICAgbTM0ID0gbWVbMTFdO1xuICAgICAgICAgICAgICAgIG00NCA9IG1lWzE1XTtcblxuICAgICAgICAgICAgICAgIGkgPSBsZW47XG4gICAgICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgICAgICBwYXJ0aWNsZSA9IHBhcnRpY2xlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSBwYXJ0aWNsZS5wb3NpdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgeCA9IHBvc2l0aW9uLng7XG4gICAgICAgICAgICAgICAgICAgIHkgPSBwb3NpdGlvbi55O1xuICAgICAgICAgICAgICAgICAgICB6ID0gcG9zaXRpb24uejtcblxuICAgICAgICAgICAgICAgICAgICBwYXJ0aWNsZS56ID0gKG0xMyAqIHggKyBtMjMgKiB5ICsgbTMzICogeiArIG00MykgLyAobTE0ICogeCArIG0yNCAqIHkgKyBtMzQgKiB6ICsgbTQ0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBwYXJ0aWNsZXMuc29ydCh6U29ydCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHBvc2l0aW9uQXJyYXkgPSBlbWl0dGVyLl93ZWJnbFZlcnRleEFycmF5IHx8IChlbWl0dGVyLl93ZWJnbFZlcnRleEFycmF5ID0gbmV3IEZsb2F0MzJBcnJheShNQVggKiAzKSk7XG4gICAgICAgICAgICBkYXRhQXJyYXkgPSBlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQXJyYXkgfHwgKGVtaXR0ZXIuX3dlYmdsUGFydGljbGVBcnJheSA9IG5ldyBGbG9hdDMyQXJyYXkoTUFYICogMykpO1xuICAgICAgICAgICAgY29sb3JBcnJheSA9IGVtaXR0ZXIuX3dlYmdsUGFydGljbGVDb2xvckFycmF5IHx8IChlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQ29sb3JBcnJheSA9IG5ldyBGbG9hdDMyQXJyYXkoTUFYICogMykpO1xuXG4gICAgICAgICAgICBpID0gbGVuO1xuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIHBhcnRpY2xlID0gcGFydGljbGVzW2ldO1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gcGFydGljbGUucG9zaXRpb247XG4gICAgICAgICAgICAgICAgY29sb3IgPSBwYXJ0aWNsZS5jb2xvcjtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBpICogMztcblxuICAgICAgICAgICAgICAgIHBvc2l0aW9uQXJyYXlbb2Zmc2V0XSA9IHBvc2l0aW9uLng7XG4gICAgICAgICAgICAgICAgcG9zaXRpb25BcnJheVtvZmZzZXQgKyAxXSA9IHBvc2l0aW9uLnk7XG4gICAgICAgICAgICAgICAgcG9zaXRpb25BcnJheVtvZmZzZXQgKyAyXSA9IHBvc2l0aW9uLno7XG5cbiAgICAgICAgICAgICAgICBkYXRhQXJyYXlbb2Zmc2V0XSA9IHBhcnRpY2xlLmFuZ2xlO1xuICAgICAgICAgICAgICAgIGRhdGFBcnJheVtvZmZzZXQgKyAxXSA9IHBhcnRpY2xlLnNpemU7XG4gICAgICAgICAgICAgICAgZGF0YUFycmF5W29mZnNldCArIDJdID0gcGFydGljbGUuYWxwaGE7XG5cbiAgICAgICAgICAgICAgICBjb2xvckFycmF5W29mZnNldF0gPSBjb2xvci5yO1xuICAgICAgICAgICAgICAgIGNvbG9yQXJyYXlbb2Zmc2V0ICsgMV0gPSBjb2xvci5nO1xuICAgICAgICAgICAgICAgIGNvbG9yQXJyYXlbb2Zmc2V0ICsgMl0gPSBjb2xvci5iO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwb3NpdGlvbkJ1ZmZlciA9IGVtaXR0ZXIuX3dlYmdsVmVydGV4QnVmZmVyIHx8IChlbWl0dGVyLl93ZWJnbFZlcnRleEJ1ZmZlciA9IF9nbC5jcmVhdGVCdWZmZXIoKSk7XG4gICAgICAgICAgICBfZ2wuYmluZEJ1ZmZlcihBUlJBWV9CVUZGRVIsIHBvc2l0aW9uQnVmZmVyKTtcbiAgICAgICAgICAgIF9nbC5idWZmZXJEYXRhKEFSUkFZX0JVRkZFUiwgcG9zaXRpb25BcnJheSwgRFJBVyk7XG5cbiAgICAgICAgICAgIGRhdGFCdWZmZXIgPSBlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQnVmZmVyIHx8IChlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQnVmZmVyID0gX2dsLmNyZWF0ZUJ1ZmZlcigpKTtcbiAgICAgICAgICAgIF9nbC5iaW5kQnVmZmVyKEFSUkFZX0JVRkZFUiwgZGF0YUJ1ZmZlcik7XG4gICAgICAgICAgICBfZ2wuYnVmZmVyRGF0YShBUlJBWV9CVUZGRVIsIGRhdGFBcnJheSwgRFJBVyk7XG5cbiAgICAgICAgICAgIGNvbG9yQnVmZmVyID0gZW1pdHRlci5fd2ViZ2xQYXJ0aWNsZUNvbG9yQnVmZmVyIHx8IChlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQ29sb3JCdWZmZXIgPSBfZ2wuY3JlYXRlQnVmZmVyKCkpO1xuICAgICAgICAgICAgX2dsLmJpbmRCdWZmZXIoQVJSQVlfQlVGRkVSLCBjb2xvckJ1ZmZlcik7XG4gICAgICAgICAgICBfZ2wuYnVmZmVyRGF0YShBUlJBWV9CVUZGRVIsIGNvbG9yQXJyYXksIERSQVcpO1xuICAgICAgICB9XG5cbiAgICAgICAgZW1pdHRlci5fd2ViZ2xQYXJ0aWNsZUNvdW50ID0gbGVuO1xuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gY3JlYXRlRW1pdHRlcjJEQnVmZmVycyhlbWl0dGVyKSB7XG4gICAgICAgIHZhciBNQVggPSBFbWl0dGVyMkQuTUFYX1BBUlRJQ0xFUyxcblxuICAgICAgICAgICAgRFJBVyA9IF9nbC5EWU5BTUlDX0RSQVcsXG4gICAgICAgICAgICBBUlJBWV9CVUZGRVIgPSBfZ2wuQVJSQVlfQlVGRkVSLFxuXG4gICAgICAgICAgICBwb3NpdGlvbkFycmF5LCBkYXRhQXJyYXksIGNvbG9yQXJyYXksXG4gICAgICAgICAgICBwb3NpdGlvbkJ1ZmZlciwgZGF0YUJ1ZmZlciwgY29sb3JCdWZmZXIsXG5cbiAgICAgICAgICAgIHBhcnRpY2xlcyA9IGVtaXR0ZXIucGFydGljbGVzLFxuICAgICAgICAgICAgcGFydGljbGUsXG4gICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgIGxlbiA9IHBhcnRpY2xlcy5sZW5ndGgsXG4gICAgICAgICAgICBvZmZzZXQsIHBvc2l0aW9uLCBjb2xvcjtcblxuICAgICAgICBpZiAobGVuKSB7XG4gICAgICAgICAgICBwb3NpdGlvbkFycmF5ID0gZW1pdHRlci5fd2ViZ2xWZXJ0ZXhBcnJheSB8fCAoZW1pdHRlci5fd2ViZ2xWZXJ0ZXhBcnJheSA9IG5ldyBGbG9hdDMyQXJyYXkoTUFYICogMykpO1xuICAgICAgICAgICAgZGF0YUFycmF5ID0gZW1pdHRlci5fd2ViZ2xQYXJ0aWNsZUFycmF5IHx8IChlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KE1BWCAqIDMpKTtcbiAgICAgICAgICAgIGNvbG9yQXJyYXkgPSBlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQ29sb3JBcnJheSB8fCAoZW1pdHRlci5fd2ViZ2xQYXJ0aWNsZUNvbG9yQXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KE1BWCAqIDMpKTtcblxuICAgICAgICAgICAgaSA9IGxlbjtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgICBwYXJ0aWNsZSA9IHBhcnRpY2xlc1tpXTtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHBhcnRpY2xlLnBvc2l0aW9uO1xuICAgICAgICAgICAgICAgIGNvbG9yID0gcGFydGljbGUuY29sb3I7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gaSAqIDM7XG5cbiAgICAgICAgICAgICAgICBwb3NpdGlvbkFycmF5W29mZnNldF0gPSBwb3NpdGlvbi54O1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uQXJyYXlbb2Zmc2V0ICsgMV0gPSBwb3NpdGlvbi55O1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uQXJyYXlbb2Zmc2V0ICsgMl0gPSAwLjA7XG5cbiAgICAgICAgICAgICAgICBkYXRhQXJyYXlbb2Zmc2V0XSA9IHBhcnRpY2xlLmFuZ2xlO1xuICAgICAgICAgICAgICAgIGRhdGFBcnJheVtvZmZzZXQgKyAxXSA9IHBhcnRpY2xlLnNpemU7XG4gICAgICAgICAgICAgICAgZGF0YUFycmF5W29mZnNldCArIDJdID0gcGFydGljbGUuYWxwaGE7XG5cbiAgICAgICAgICAgICAgICBjb2xvckFycmF5W29mZnNldF0gPSBjb2xvci5yO1xuICAgICAgICAgICAgICAgIGNvbG9yQXJyYXlbb2Zmc2V0ICsgMV0gPSBjb2xvci5nO1xuICAgICAgICAgICAgICAgIGNvbG9yQXJyYXlbb2Zmc2V0ICsgMl0gPSBjb2xvci5iO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwb3NpdGlvbkJ1ZmZlciA9IGVtaXR0ZXIuX3dlYmdsVmVydGV4QnVmZmVyIHx8IChlbWl0dGVyLl93ZWJnbFZlcnRleEJ1ZmZlciA9IF9nbC5jcmVhdGVCdWZmZXIoKSk7XG4gICAgICAgICAgICBfZ2wuYmluZEJ1ZmZlcihBUlJBWV9CVUZGRVIsIHBvc2l0aW9uQnVmZmVyKTtcbiAgICAgICAgICAgIF9nbC5idWZmZXJEYXRhKEFSUkFZX0JVRkZFUiwgcG9zaXRpb25BcnJheSwgRFJBVyk7XG5cbiAgICAgICAgICAgIGRhdGFCdWZmZXIgPSBlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQnVmZmVyIHx8IChlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQnVmZmVyID0gX2dsLmNyZWF0ZUJ1ZmZlcigpKTtcbiAgICAgICAgICAgIF9nbC5iaW5kQnVmZmVyKEFSUkFZX0JVRkZFUiwgZGF0YUJ1ZmZlcik7XG4gICAgICAgICAgICBfZ2wuYnVmZmVyRGF0YShBUlJBWV9CVUZGRVIsIGRhdGFBcnJheSwgRFJBVyk7XG5cbiAgICAgICAgICAgIGNvbG9yQnVmZmVyID0gZW1pdHRlci5fd2ViZ2xQYXJ0aWNsZUNvbG9yQnVmZmVyIHx8IChlbWl0dGVyLl93ZWJnbFBhcnRpY2xlQ29sb3JCdWZmZXIgPSBfZ2wuY3JlYXRlQnVmZmVyKCkpO1xuICAgICAgICAgICAgX2dsLmJpbmRCdWZmZXIoQVJSQVlfQlVGRkVSLCBjb2xvckJ1ZmZlcik7XG4gICAgICAgICAgICBfZ2wuYnVmZmVyRGF0YShBUlJBWV9CVUZGRVIsIGNvbG9yQXJyYXksIERSQVcpO1xuICAgICAgICB9XG5cbiAgICAgICAgZW1pdHRlci5fd2ViZ2xQYXJ0aWNsZUNvdW50ID0gbGVuO1xuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gelNvcnQoYSwgYikge1xuXG4gICAgICAgIHJldHVybiBiLnogLSBhLno7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBjcmVhdGVTaGFkZXIob2JqLCBtYXRlcmlhbCwgbGlnaHRzKSB7XG4gICAgICAgIGlmICghbWF0ZXJpYWwubmVlZHNVcGRhdGUgJiYgKF9zaGFkZXJzW29iai5faWRdKSkgcmV0dXJuIF9zaGFkZXJzW29iai5faWRdO1xuXG4gICAgICAgIHZhciBzaGFkZXIgPSBtYXRlcmlhbC5zaGFkZXIsXG4gICAgICAgICAgICB1bmlmb3JtcyA9IG1hdGVyaWFsLnVuaWZvcm1zLFxuICAgICAgICAgICAgT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzID0gISFfZXh0ZW5zaW9ucy5PRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMsXG4gICAgICAgICAgICBwYXJhbWV0ZXJzID0ge307XG5cbiAgICAgICAgcGFyYW1ldGVycy5tb2JpbGUgPSBEZXZpY2UubW9iaWxlO1xuXG4gICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBNZXNoRmlsdGVyKSB7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLm1lc2ggPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIFNwcml0ZSkge1xuICAgICAgICAgICAgcGFyYW1ldGVycy5zcHJpdGUgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIEVtaXR0ZXIpIHtcbiAgICAgICAgICAgIHBhcmFtZXRlcnMuZW1pdHRlciA9IHRydWU7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLndvcmxkU3BhY2UgPSBvYmoud29ybGRTcGFjZTtcbiAgICAgICAgfSBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBFbWl0dGVyMkQpIHtcbiAgICAgICAgICAgIHBhcmFtZXRlcnMuZW1pdHRlciA9IHRydWU7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmVtaXR0ZXIyZCA9IHRydWU7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLndvcmxkU3BhY2UgPSBvYmoud29ybGRTcGFjZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHBhcmFtZXRlcnMudXNlTGlnaHRzID0gc2hhZGVyLmxpZ2h0cztcbiAgICAgICAgcGFyYW1ldGVycy51c2VTaGFkb3dzID0gc2hhZGVyLnNoYWRvd3M7XG4gICAgICAgIHBhcmFtZXRlcnMudXNlRm9nID0gc2hhZGVyLmZvZztcbiAgICAgICAgcGFyYW1ldGVycy51c2VCb25lcyA9IG9iai51c2VCb25lcyAmJiBvYmouYm9uZXMubGVuZ3RoID4gMDtcbiAgICAgICAgcGFyYW1ldGVycy51c2VWZXJ0ZXhMaXQgPSBzaGFkZXIudmVydGV4TGl0O1xuICAgICAgICBwYXJhbWV0ZXJzLnVzZVNwZWN1bGFyID0gc2hhZGVyLnNwZWN1bGFyO1xuXG4gICAgICAgIHBhcmFtZXRlcnMudXNlTm9ybWFsID0gISF1bmlmb3Jtcy5ub3JtYWxNYXA7XG4gICAgICAgIHBhcmFtZXRlcnMudXNlQnVtcCA9ICEhdW5pZm9ybXMuYnVtcE1hcDtcblxuICAgICAgICBwYXJhbWV0ZXJzLnBvc2l0aW9ucyA9IHRydWU7XG4gICAgICAgIHBhcmFtZXRlcnMubm9ybWFscyA9IHBhcmFtZXRlcnMudXNlTm9ybWFsIHx8IChvYmoubm9ybWFscyAmJiBvYmoubm9ybWFscy5sZW5ndGggPiAwKTtcbiAgICAgICAgcGFyYW1ldGVycy50YW5nZW50cyA9IHBhcmFtZXRlcnMudXNlTm9ybWFsIHx8IChvYmoudGFuZ2VudHMgJiYgb2JqLnRhbmdlbnRzLmxlbmd0aCA+IDApO1xuICAgICAgICBwYXJhbWV0ZXJzLnV2cyA9IHBhcmFtZXRlcnMuc3ByaXRlIHx8IChvYmoudXZzICYmIG9iai51dnMubGVuZ3RoID4gMCk7XG4gICAgICAgIHBhcmFtZXRlcnMuY29sb3JzID0gcGFyYW1ldGVycy5zcHJpdGUgfHwgKG9iai5jb2xvcnMgJiYgb2JqLmNvbG9ycy5sZW5ndGggPiAwKTtcblxuICAgICAgICBwYXJhbWV0ZXJzLk9FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyA9IE9FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyAmJiBzaGFkZXIuT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzO1xuXG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnVzZUJvbmVzKSBwYXJhbWV0ZXJzLmJvbmVzID0gb2JqLmJvbmVzLmxlbmd0aDtcbiAgICAgICAgYWxsb2NhdGVMaWdodHMobGlnaHRzLCBwYXJhbWV0ZXJzKTtcbiAgICAgICAgYWxsb2NhdGVTaGFkb3dzKGxpZ2h0cywgcGFyYW1ldGVycyk7XG5cbiAgICAgICAgcGFyYW1ldGVycy5zaGFkb3dNYXBFbmFibGVkID0gX3RoaXMuc2hhZG93TWFwRW5hYmxlZCAmJiBtYXRlcmlhbC5yZWNlaXZlU2hhZG93ICYmIHBhcmFtZXRlcnMubWF4U2hhZG93cyA+IDA7XG4gICAgICAgIHBhcmFtZXRlcnMuc2hhZG93TWFwVHlwZSA9IF90aGlzLnNoYWRvd01hcFR5cGU7XG4gICAgICAgIHBhcmFtZXRlcnMuc2hhZG93TWFwRGVidWcgPSBfdGhpcy5zaGFkb3dNYXBEZWJ1ZztcbiAgICAgICAgcGFyYW1ldGVycy5zaGFkb3dNYXBDYXNjYWRlID0gX3RoaXMuc2hhZG93TWFwQ2FzY2FkZTtcblxuICAgICAgICBtYXRlcmlhbC5uZWVkc1VwZGF0ZSA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gKF9zaGFkZXJzW29iai5faWRdID0gY3JlYXRlU2hhZGVyUHJvZ3JhbShzaGFkZXIudmVydGV4LCBzaGFkZXIuZnJhZ21lbnQsIHBhcmFtZXRlcnMpKTtcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGFsbG9jYXRlTGlnaHRzKGxpZ2h0cywgcGFyYW1ldGVycykge1xuICAgICAgICB2YXIgbWF4UG9pbnRMaWdodHMgPSAwLFxuICAgICAgICAgICAgbWF4RGlyZWN0aW9uYWxMaWdodHMgPSAwLFxuICAgICAgICAgICAgbWF4U3BvdExpZ2h0cyA9IDAsXG4gICAgICAgICAgICBtYXhIZW1pTGlnaHRzID0gMCxcbiAgICAgICAgICAgIGxpZ2h0LCB0eXBlLFxuICAgICAgICAgICAgaSA9IGxpZ2h0cy5sZW5ndGg7XG5cbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgbGlnaHQgPSBsaWdodHNbaV07XG4gICAgICAgICAgICBpZiAoIWxpZ2h0LnZpc2libGUgfHwgbGlnaHQub25seVNoYWRvdykgY29udGludWU7XG4gICAgICAgICAgICB0eXBlID0gbGlnaHQudHlwZTtcblxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IExpZ2h0VHlwZS5Qb2ludCkge1xuICAgICAgICAgICAgICAgIG1heFBvaW50TGlnaHRzKys7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IExpZ2h0VHlwZS5EaXJlY3Rpb25hbCkge1xuICAgICAgICAgICAgICAgIG1heERpcmVjdGlvbmFsTGlnaHRzKys7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IExpZ2h0VHlwZS5TcG90KSB7XG4gICAgICAgICAgICAgICAgbWF4U3BvdExpZ2h0cysrO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBMaWdodFR5cGUuSGVtaSkge1xuICAgICAgICAgICAgICAgIG1heEhlbWlMaWdodHMrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHBhcmFtZXRlcnMubWF4UG9pbnRMaWdodHMgPSBtYXhQb2ludExpZ2h0cztcbiAgICAgICAgcGFyYW1ldGVycy5tYXhEaXJlY3Rpb25hbExpZ2h0cyA9IG1heERpcmVjdGlvbmFsTGlnaHRzO1xuICAgICAgICBwYXJhbWV0ZXJzLm1heFNwb3RMaWdodHMgPSBtYXhTcG90TGlnaHRzO1xuICAgICAgICBwYXJhbWV0ZXJzLm1heEhlbWlMaWdodHMgPSBtYXhIZW1pTGlnaHRzO1xuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gYWxsb2NhdGVTaGFkb3dzKGxpZ2h0cywgcGFyYW1ldGVycykge1xuICAgICAgICB2YXIgbWF4U2hhZG93cyA9IDAsXG4gICAgICAgICAgICBsaWdodCwgdHlwZSxcbiAgICAgICAgICAgIGkgPSBsaWdodHMubGVuZ3RoO1xuXG4gICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgIGxpZ2h0ID0gbGlnaHRzW2ldO1xuICAgICAgICAgICAgaWYgKCFsaWdodC52aXNpYmxlIHx8ICFsaWdodC5jYXN0U2hhZG93KSBjb250aW51ZTtcbiAgICAgICAgICAgIHR5cGUgPSBsaWdodC50eXBlO1xuXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gTGlnaHRUeXBlLkRpcmVjdGlvbmFsKSB7XG4gICAgICAgICAgICAgICAgbWF4U2hhZG93cysrO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBMaWdodFR5cGUuU3BvdCkge1xuICAgICAgICAgICAgICAgIG1heFNoYWRvd3MrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHBhcmFtZXRlcnMubWF4U2hhZG93cyA9IG1heFNoYWRvd3M7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlU2hhZGVyUHJvZ3JhbSh2ZXJ0ZXhTaGFkZXIsIGZyYWdtZW50U2hhZGVyLCBwYXJhbWV0ZXJzKSB7XG4gICAgICAgIHZhciBjaHVua3MgPSBbXSxcbiAgICAgICAgICAgIGtleSwgcHJvZ3JhbSwgY29kZSwga2V5O1xuXG4gICAgICAgIGNodW5rcy5wdXNoKHZlcnRleFNoYWRlciwgZnJhZ21lbnRTaGFkZXIpO1xuICAgICAgICBmb3IgKGtleSBpbiBwYXJhbWV0ZXJzKSBjaHVua3MucHVzaChrZXksIHBhcmFtZXRlcnNba2V5XSk7XG5cbiAgICAgICAgY29kZSA9IGNodW5rcy5qb2luKCk7XG5cbiAgICAgICAgZm9yIChrZXkgaW4gX3NoYWRlcnMpIHtcbiAgICAgICAgICAgIHByb2dyYW0gPSBfc2hhZGVyc1trZXldO1xuXG4gICAgICAgICAgICBpZiAocHJvZ3JhbS5jb2RlID09PSBjb2RlKSB7XG4gICAgICAgICAgICAgICAgcHJvZ3JhbS51c2VkKys7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb2dyYW07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBwcm9ncmFtID0gbmV3IFNoYWRlcih2ZXJ0ZXhTaGFkZXIsIGZyYWdtZW50U2hhZGVyLCBwYXJhbWV0ZXJzLCBjb2RlKS5idWlsZFNoYWRlcigpO1xuICAgICAgICByZXR1cm4gcHJvZ3JhbTtcbiAgICB9XG5cblxuICAgIHZhciBIRUFERVIgPSAvKFtcXHNcXFNdKik/KHZvaWRbXFxzXSttYWluKS8sXG4gICAgICAgIE1BSU5fRlVOQ1RJT04gPSAvdm9pZFtcXHNdK21haW4oW1xcc10rKT8oXFwoKHZvaWQpP1xcKSkoW1xcc10rKT97KFtefV0qKX0vLFxuICAgICAgICBNQUlOX1NQTElURVIgPSAvdm9pZFtcXHNdK21haW4oW1xcc10rKT8oXFwoKHZvaWQpP1xcKSkoW1xcc10rKT97LztcblxuICAgIGZ1bmN0aW9uIFNoYWRlcih2ZXJ0ZXgsIGZyYWdtZW50LCBwYXJhbWV0ZXJzLCBjb2RlKSB7XG5cbiAgICAgICAgdGhpcy52ZXJ0ZXggPSB2ZXJ0ZXg7XG4gICAgICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJzID0gcGFyYW1ldGVycztcbiAgICAgICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICAgICAgdGhpcy51c2VkID0gMDtcblxuICAgICAgICB0aGlzLnByb2dyYW0gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy51bmlmb3JtcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fY3VzdG9tQXR0cmlidXRlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fY3VzdG9tVW5pZm9ybXMgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgU2hhZGVyLnByb3RvdHlwZS5tYXJrQXNVc2VkID0gZnVuY3Rpb24gKG1hdGVyaWFsKSB7XG4gICAgICAgIHRoaXMudXNlZCArPSAxO1xuXG4gICAgICAgIGlmIChtYXRlcmlhbCkge1xuICAgICAgICAgICAgdmFyIHVuaWZvcm1zID0gbWF0ZXJpYWwudW5pZm9ybXMsXG4gICAgICAgICAgICAgICAgdW5pZm9ybSwga2V5O1xuXG4gICAgICAgICAgICBmb3IgKGtleSBpbiB1bmlmb3Jtcykge1xuICAgICAgICAgICAgICAgIHVuaWZvcm0gPSB1bmlmb3Jtc1trZXldO1xuXG4gICAgICAgICAgICAgICAgaWYgKHVuaWZvcm0gaW5zdGFuY2VvZiBUZXh0dXJlKSB7XG4gICAgICAgICAgICAgICAgICAgIHVuaWZvcm0uX3dlYmdsVXNlZCArPSAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodW5pZm9ybSBpbnN0YW5jZW9mIFRleHR1cmVDdWJlKSB7XG4gICAgICAgICAgICAgICAgICAgIHVuaWZvcm0uX3dlYmdsVXNlZCArPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIFNoYWRlci5wcm90b3R5cGUuYmluZE1hdGVyaWFsID0gZnVuY3Rpb24gKGNvbXBvbmVudCwgb2JqLCBtYXRlcmlhbCwgdHJhbnNmb3JtLCBjYW1lcmEsIGxpZ2h0cywgYW1iaWVudCkge1xuICAgICAgICB2YXIgcHJvZ3JhbSA9IHRoaXMucHJvZ3JhbSxcbiAgICAgICAgICAgIHBhcmFtZXRlcnMgPSB0aGlzLnBhcmFtZXRlcnMsXG4gICAgICAgICAgICB1bmlmb3JtcyA9IHRoaXMudW5pZm9ybXMsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzLFxuICAgICAgICAgICAgZm9yY2UgPSBzZXRQcm9ncmFtKHByb2dyYW0pLFxuICAgICAgICAgICAgc3ByaXRlID0gcGFyYW1ldGVycy5zcHJpdGUsXG4gICAgICAgICAgICB0ZXh0dXJlLCB3LCBoLCBpLCBsZW5ndGgsIHBhcnRpY2xlU2l6ZVJhdGlvLCBib25lLCBib25lVHJhbnNmb3JtLCBib25lcywgdUJvbmVzUG9zLCB1Qm9uZXNTY2wsIHVCb25lc1JvdDtcblxuICAgICAgICBpZiAoc3ByaXRlKSB7XG4gICAgICAgICAgICBpZiAoX2xhc3RCdWZmZXJzICE9PSBfc3ByaXRlQnVmZmVycykge1xuICAgICAgICAgICAgICAgIGRpc2FibGVBdHRyaWJ1dGVzKCk7XG5cbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnBvc2l0aW9uLnNldChfc3ByaXRlQnVmZmVycy5fd2ViZ2xWZXJ0ZXhCdWZmZXIpO1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMudXYuc2V0KF9zcHJpdGVCdWZmZXJzLl93ZWJnbFV2QnVmZmVyKTtcblxuICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLm5vcm1hbCkgYXR0cmlidXRlcy5ub3JtYWwuc2V0KF9zcHJpdGVCdWZmZXJzLl93ZWJnbE5vcm1hbEJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMudGFuZ2VudCkgYXR0cmlidXRlcy50YW5nZW50LnNldChfc3ByaXRlQnVmZmVycy5fd2ViZ2xUYW5nZW50QnVmZmVyKTtcblxuICAgICAgICAgICAgICAgIF9sYXN0QnVmZmVycyA9IF9zcHJpdGVCdWZmZXJzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKF9sYXN0QnVmZmVycyAhPT0gb2JqKSB7XG4gICAgICAgICAgICAgICAgZGlzYWJsZUF0dHJpYnV0ZXMoKTtcblxuICAgICAgICAgICAgICAgIGlmIChvYmouX3dlYmdsVmVydGV4QnVmZmVyICYmIGF0dHJpYnV0ZXMucG9zaXRpb24pIGF0dHJpYnV0ZXMucG9zaXRpb24uc2V0KG9iai5fd2ViZ2xWZXJ0ZXhCdWZmZXIpO1xuICAgICAgICAgICAgICAgIGlmIChvYmouX3dlYmdsTm9ybWFsQnVmZmVyICYmIGF0dHJpYnV0ZXMubm9ybWFsKSBhdHRyaWJ1dGVzLm5vcm1hbC5zZXQob2JqLl93ZWJnbE5vcm1hbEJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgaWYgKG9iai5fd2ViZ2xUYW5nZW50QnVmZmVyICYmIGF0dHJpYnV0ZXMudGFuZ2VudCkgYXR0cmlidXRlcy50YW5nZW50LnNldChvYmouX3dlYmdsVGFuZ2VudEJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgaWYgKG9iai5fd2ViZ2xDb2xvckJ1ZmZlciAmJiBhdHRyaWJ1dGVzLmNvbG9yKSBhdHRyaWJ1dGVzLmNvbG9yLnNldChvYmouX3dlYmdsQ29sb3JCdWZmZXIpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG9iai5fd2ViZ2xVdkJ1ZmZlciAmJiBhdHRyaWJ1dGVzLnV2KSBhdHRyaWJ1dGVzLnV2LnNldChvYmouX3dlYmdsVXZCdWZmZXIpO1xuICAgICAgICAgICAgICAgIGlmIChvYmouX3dlYmdsVXYyQnVmZmVyICYmIGF0dHJpYnV0ZXMudXYyKSBhdHRyaWJ1dGVzLnV2Mi5zZXQob2JqLl93ZWJnbFV2MkJ1ZmZlcik7XG5cbiAgICAgICAgICAgICAgICBpZiAob2JqLl93ZWJnbEJvbmVJbmRleEJ1ZmZlciAmJiBhdHRyaWJ1dGVzLmJvbmVJbmRleCkgYXR0cmlidXRlcy5ib25lSW5kZXguc2V0KG9iai5fd2ViZ2xCb25lSW5kZXhCdWZmZXIpO1xuICAgICAgICAgICAgICAgIGlmIChvYmouX3dlYmdsQm9uZVdlaWdodEJ1ZmZlciAmJiBhdHRyaWJ1dGVzLmJvbmVXZWlnaHQpIGF0dHJpYnV0ZXMuYm9uZVdlaWdodC5zZXQob2JqLl93ZWJnbEJvbmVXZWlnaHRCdWZmZXIpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG9iai5fd2ViZ2xQYXJ0aWNsZUJ1ZmZlciAmJiBhdHRyaWJ1dGVzLmRhdGEpIGF0dHJpYnV0ZXMuZGF0YS5zZXQob2JqLl93ZWJnbFBhcnRpY2xlQnVmZmVyKTtcbiAgICAgICAgICAgICAgICBpZiAob2JqLl93ZWJnbFBhcnRpY2xlQ29sb3JCdWZmZXIgJiYgYXR0cmlidXRlcy5wYXJ0aWNsZUNvbG9yKSBhdHRyaWJ1dGVzLnBhcnRpY2xlQ29sb3Iuc2V0KG9iai5fd2ViZ2xQYXJ0aWNsZUNvbG9yQnVmZmVyKTtcblxuICAgICAgICAgICAgICAgIGlmIChtYXRlcmlhbC53aXJlZnJhbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5fd2ViZ2xMaW5lQnVmZmVyKSBfZ2wuYmluZEJ1ZmZlcihfZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIsIG9iai5fd2ViZ2xMaW5lQnVmZmVyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLl93ZWJnbEluZGV4QnVmZmVyKSBfZ2wuYmluZEJ1ZmZlcihfZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIsIG9iai5fd2ViZ2xJbmRleEJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX2xhc3RCdWZmZXJzID0gb2JqO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNwcml0ZSkge1xuICAgICAgICAgICAgdGV4dHVyZSA9IG1hdGVyaWFsLnVuaWZvcm1zLmRpZmZ1c2VNYXA7XG4gICAgICAgICAgICBpZiAoIXRleHR1cmUpIHRocm93IFwiU2hhZGVyLmJpbmQ6IFNwcml0ZSBtYXRlcmlhbCBhbmQgc2hhZGVyIHJlcXVpcmVzIGRpZmZ1c2VNYXBcIjtcblxuICAgICAgICAgICAgdyA9IHRleHR1cmUuaW52V2lkdGg7XG4gICAgICAgICAgICBoID0gdGV4dHVyZS5pbnZIZWlnaHQ7XG5cbiAgICAgICAgICAgIHVuaWZvcm1zLnNpemUuc2V0KF92ZWN0b3IyLnNldChvYmoud2lkdGgsIG9iai5oZWlnaHQpLCBmb3JjZSk7XG4gICAgICAgICAgICB1bmlmb3Jtcy5jcm9wLnNldChfdmVjdG9yNC5zZXQob2JqLnggKiB3LCBvYmoueSAqIGgsIG9iai53ICogdywgb2JqLmggKiBoKSwgZm9yY2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuZW1pdHRlciAmJiBwYXJhbWV0ZXJzLndvcmxkU3BhY2UpIHtcbiAgICAgICAgICAgIGlmICh1bmlmb3Jtcy5tb2RlbE1hdHJpeCkgdW5pZm9ybXMubW9kZWxNYXRyaXguc2V0KF9tYXQ0LmlkZW50aXR5KCksIGZvcmNlKTtcbiAgICAgICAgICAgIGlmICh1bmlmb3Jtcy5tb2RlbFZpZXdNYXRyaXgpIHVuaWZvcm1zLm1vZGVsVmlld01hdHJpeC5zZXQoY2FtZXJhLnZpZXcsIGZvcmNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh1bmlmb3Jtcy5tb2RlbE1hdHJpeCkgdW5pZm9ybXMubW9kZWxNYXRyaXguc2V0KHRyYW5zZm9ybS5tYXRyaXhXb3JsZCwgZm9yY2UpO1xuICAgICAgICAgICAgaWYgKHVuaWZvcm1zLm1vZGVsVmlld01hdHJpeCkgdW5pZm9ybXMubW9kZWxWaWV3TWF0cml4LnNldCh0cmFuc2Zvcm0ubW9kZWxWaWV3LCBmb3JjZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVuaWZvcm1zLnBhcnRpY2xlU2l6ZVJhdGlvKSB7XG4gICAgICAgICAgICBwYXJ0aWNsZVNpemVSYXRpbyA9IChfY3VycmVudFdpZHRoIDwgX2N1cnJlbnRIZWlnaHQgPyBfY3VycmVudFdpZHRoIDogX2N1cnJlbnRIZWlnaHQpO1xuXG4gICAgICAgICAgICBpZiAocGFyYW1ldGVycy5lbWl0dGVyMmQgfHwgY2FtZXJhLmNhbWVyYTJkIHx8IGNhbWVyYS5vcnRob2dyYXBoaWMpIHtcbiAgICAgICAgICAgICAgICBwYXJ0aWNsZVNpemVSYXRpbyAqPSAxLjAgLyAoY2FtZXJhLm9ydGhvZ3JhcGhpY1NpemUgKiAyLjApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYXJ0aWNsZVNpemVSYXRpbyAqPSAyLjA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHVuaWZvcm1zLnBhcnRpY2xlU2l6ZVJhdGlvLnNldChwYXJ0aWNsZVNpemVSYXRpbyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodW5pZm9ybXMucHJvamVjdGlvbk1hdHJpeCkgdW5pZm9ybXMucHJvamVjdGlvbk1hdHJpeC5zZXQoY2FtZXJhLnByb2plY3Rpb24sIGZvcmNlKTtcbiAgICAgICAgaWYgKHVuaWZvcm1zLnZpZXdNYXRyaXgpIHVuaWZvcm1zLnZpZXdNYXRyaXguc2V0KGNhbWVyYS52aWV3LCBmb3JjZSk7XG4gICAgICAgIGlmICh1bmlmb3Jtcy5ub3JtYWxNYXRyaXgpIHVuaWZvcm1zLm5vcm1hbE1hdHJpeC5zZXQodHJhbnNmb3JtLm5vcm1hbE1hdHJpeCwgZm9yY2UpO1xuICAgICAgICBpZiAodW5pZm9ybXMuY2FtZXJhUG9zaXRpb24pIHVuaWZvcm1zLmNhbWVyYVBvc2l0aW9uLnNldChfdmVjdG9yMy5wb3NpdGlvbkZyb21NYXQ0KChjYW1lcmEudHJhbnNmb3JtIHx8IGNhbWVyYS50cmFuc2Zvcm0yZCkubWF0cml4V29ybGQpLCBmb3JjZSk7XG4gICAgICAgIGlmICh1bmlmb3Jtcy5hbWJpZW50KSB1bmlmb3Jtcy5hbWJpZW50LnNldChhbWJpZW50LCBmb3JjZSk7XG5cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMudXNlQm9uZXMpIHtcbiAgICAgICAgICAgIHVCb25lc1BvcyA9IHVuaWZvcm1zLmJvbmVzUG9zO1xuICAgICAgICAgICAgdUJvbmVzU2NsID0gdW5pZm9ybXMuYm9uZXNTY2w7XG4gICAgICAgICAgICB1Qm9uZXNSb3QgPSB1bmlmb3Jtcy5ib25lc1JvdDtcbiAgICAgICAgICAgIGJvbmVzID0gY29tcG9uZW50Ll9ib25lcztcbiAgICAgICAgICAgIGkgPSBib25lcy5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgYm9uZSA9IGJvbmVzW2ldO1xuICAgICAgICAgICAgICAgIGJvbmVUcmFuc2Zvcm0gPSBib25lLnRyYW5zZm9ybTtcbiAgICAgICAgICAgICAgICBfbWF0NC5tbXVsKGJvbmUudW5pZm9ybSwgYm9uZS5iaW5kUG9zZSkuZGVjb21wb3NlKF92ZWN0b3IzLCBfdmVjdG9yM18yLCBfcXVhdCk7XG5cbiAgICAgICAgICAgICAgICB1Qm9uZXNQb3NbaV0uc2V0KF92ZWN0b3IzKTtcbiAgICAgICAgICAgICAgICB1Qm9uZXNTY2xbaV0uc2V0KF92ZWN0b3IzXzIpO1xuICAgICAgICAgICAgICAgIHVCb25lc1JvdFtpXS5zZXQoX3F1YXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZvcmNlICYmIHBhcmFtZXRlcnMudXNlTGlnaHRzICYmIChsZW5ndGggPSBsaWdodHMubGVuZ3RoKSkge1xuICAgICAgICAgICAgdmFyIG1heFBvaW50TGlnaHRzID0gcGFyYW1ldGVycy5tYXhQb2ludExpZ2h0cyxcbiAgICAgICAgICAgICAgICBtYXhEaXJlY3Rpb25hbExpZ2h0cyA9IHBhcmFtZXRlcnMubWF4RGlyZWN0aW9uYWxMaWdodHMsXG4gICAgICAgICAgICAgICAgbWF4U3BvdExpZ2h0cyA9IHBhcmFtZXRlcnMubWF4U3BvdExpZ2h0cyxcbiAgICAgICAgICAgICAgICBtYXhIZW1pTGlnaHRzID0gcGFyYW1ldGVycy5tYXhIZW1pTGlnaHRzLFxuXG4gICAgICAgICAgICAgICAgcG9pbnRMaWdodHMgPSAwLFxuICAgICAgICAgICAgICAgIHBvaW50TGlnaHRDb2xvciA9IHVuaWZvcm1zLnBvaW50TGlnaHRDb2xvcixcbiAgICAgICAgICAgICAgICBwb2ludExpZ2h0UG9zaXRpb24gPSB1bmlmb3Jtcy5wb2ludExpZ2h0UG9zaXRpb24sXG4gICAgICAgICAgICAgICAgcG9pbnRMaWdodERpc3RhbmNlID0gdW5pZm9ybXMucG9pbnRMaWdodERpc3RhbmNlLFxuXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uYWxMaWdodHMgPSAwLFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbmFsTGlnaHRDb2xvciA9IHVuaWZvcm1zLmRpcmVjdGlvbmFsTGlnaHRDb2xvcixcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb25hbExpZ2h0RGlyZWN0aW9uID0gdW5pZm9ybXMuZGlyZWN0aW9uYWxMaWdodERpcmVjdGlvbixcblxuICAgICAgICAgICAgICAgIHNwb3RMaWdodHMgPSAwLFxuICAgICAgICAgICAgICAgIHNwb3RMaWdodENvbG9yID0gdW5pZm9ybXMuc3BvdExpZ2h0Q29sb3IsXG4gICAgICAgICAgICAgICAgc3BvdExpZ2h0UG9zaXRpb24gPSB1bmlmb3Jtcy5zcG90TGlnaHRQb3NpdGlvbixcbiAgICAgICAgICAgICAgICBzcG90TGlnaHREaXJlY3Rpb24gPSB1bmlmb3Jtcy5zcG90TGlnaHREaXJlY3Rpb24sXG4gICAgICAgICAgICAgICAgc3BvdExpZ2h0RGlzdGFuY2UgPSB1bmlmb3Jtcy5zcG90TGlnaHREaXN0YW5jZSxcbiAgICAgICAgICAgICAgICBzcG90TGlnaHRBbmdsZUNvcyA9IHVuaWZvcm1zLnNwb3RMaWdodEFuZ2xlQ29zLFxuICAgICAgICAgICAgICAgIHNwb3RMaWdodEV4cG9uZW50ID0gdW5pZm9ybXMuc3BvdExpZ2h0RXhwb25lbnQsXG5cbiAgICAgICAgICAgICAgICBoZW1pTGlnaHRzID0gMCxcbiAgICAgICAgICAgICAgICBoZW1pTGlnaHRDb2xvciA9IHVuaWZvcm1zLmhlbWlMaWdodENvbG9yLFxuICAgICAgICAgICAgICAgIGhlbWlMaWdodERpcmVjdGlvbiA9IHVuaWZvcm1zLmhlbWlMaWdodERpcmVjdGlvbixcblxuICAgICAgICAgICAgICAgIGxpZ2h0LCB0eXBlO1xuXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsaWdodCA9IGxpZ2h0c1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoIWxpZ2h0LnZpc2libGUpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgdHlwZSA9IGxpZ2h0LnR5cGU7XG4gICAgICAgICAgICAgICAgX2NvbG9yLmNvcHkobGlnaHQuY29sb3IpLnNtdWwobGlnaHQuZW5lcmd5KTtcblxuICAgICAgICAgICAgICAgIGlmIChwb2ludExpZ2h0Q29sb3IubGVuZ3RoICYmIHR5cGUgPT09IExpZ2h0VHlwZS5Qb2ludCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9pbnRMaWdodHMgPj0gbWF4UG9pbnRMaWdodHMpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIF92ZWN0b3IzLnBvc2l0aW9uRnJvbU1hdDQoKGxpZ2h0LnRyYW5zZm9ybSB8fCBsaWdodC50cmFuc2Zvcm0yZCkubWF0cml4V29ybGQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHBvaW50TGlnaHRDb2xvcltwb2ludExpZ2h0c10uc2V0KF9jb2xvciwgZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICBwb2ludExpZ2h0UG9zaXRpb25bcG9pbnRMaWdodHNdLnNldChfdmVjdG9yMywgZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICBwb2ludExpZ2h0RGlzdGFuY2VbcG9pbnRMaWdodHNdLnNldChsaWdodC5kaXN0YW5jZSwgZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICBwb2ludExpZ2h0cysrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uYWxMaWdodENvbG9yLmxlbmd0aCAmJiB0eXBlID09PSBMaWdodFR5cGUuRGlyZWN0aW9uYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRpcmVjdGlvbmFsTGlnaHRzID49IG1heERpcmVjdGlvbmFsTGlnaHRzKSBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgICAgICBfdmVjdG9yMy5wb3NpdGlvbkZyb21NYXQ0KChsaWdodC50cmFuc2Zvcm0gfHwgbGlnaHQudHJhbnNmb3JtMmQpLm1hdHJpeFdvcmxkKS5zdWIobGlnaHQudGFyZ2V0KS5ub3JtYWxpemUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF92ZWN0b3IzLmxlbmd0aFNxKCkgPT09IDApIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbmFsTGlnaHRDb2xvcltkaXJlY3Rpb25hbExpZ2h0c10uc2V0KF9jb2xvciwgZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb25hbExpZ2h0RGlyZWN0aW9uW2RpcmVjdGlvbmFsTGlnaHRzXS5zZXQoX3ZlY3RvcjMsIGZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uYWxMaWdodHMrKztcblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3BvdExpZ2h0Q29sb3IubGVuZ3RoICYmIHR5cGUgPT09IExpZ2h0VHlwZS5TcG90KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzcG90TGlnaHRzID49IG1heFNwb3RMaWdodHMpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIF92ZWN0b3IzLnBvc2l0aW9uRnJvbU1hdDQoKGxpZ2h0LnRyYW5zZm9ybSB8fCBsaWdodC50cmFuc2Zvcm0yZCkubWF0cml4V29ybGQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3ZlY3RvcjMubGVuZ3RoU3EoKSA9PT0gMCkgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICAgICAgX3ZlY3RvcjNfMi5jb3B5KF92ZWN0b3IzKS5zdWIobGlnaHQudGFyZ2V0KS5ub3JtYWxpemUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF92ZWN0b3IzXzIubGVuZ3RoU3EoKSA9PT0gMCkgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICAgICAgc3BvdExpZ2h0Q29sb3Jbc3BvdExpZ2h0c10uc2V0KF9jb2xvciwgZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICBzcG90TGlnaHRQb3NpdGlvbltzcG90TGlnaHRzXS5zZXQoX3ZlY3RvcjMsIGZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgc3BvdExpZ2h0RGlyZWN0aW9uW3Nwb3RMaWdodHNdLnNldChfdmVjdG9yM18yLCBmb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHNwb3RMaWdodERpc3RhbmNlW3Nwb3RMaWdodHNdLnNldChsaWdodC5kaXN0YW5jZSwgZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICBzcG90TGlnaHRBbmdsZUNvc1tzcG90TGlnaHRzXS5zZXQobGlnaHQuX2FuZ2xlQ29zLCBmb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHNwb3RMaWdodEV4cG9uZW50W3Nwb3RMaWdodHNdLnNldChsaWdodC5leHBvbmVudCwgZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICBzcG90TGlnaHRzKys7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhlbWlMaWdodENvbG9yLmxlbmd0aCAmJiB0eXBlID09PSBMaWdodFR5cGUuSGVtaSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGVtaUxpZ2h0cyA+PSBtYXhIZW1pTGlnaHRzKSBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgICAgICBfdmVjdG9yMy5wb3NpdGlvbkZyb21NYXQ0KChsaWdodC50cmFuc2Zvcm0gfHwgbGlnaHQudHJhbnNmb3JtMmQpLm1hdHJpeFdvcmxkKS5zdWIobGlnaHQudGFyZ2V0KS5ub3JtYWxpemUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF92ZWN0b3IzLmxlbmd0aFNxKCkgPT09IDApIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGhlbWlMaWdodENvbG9yW2hlbWlMaWdodHNdLnNldChfY29sb3IsIGZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgaGVtaUxpZ2h0RGlyZWN0aW9uW2hlbWlMaWdodHNdLnNldChfdmVjdG9yMywgZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICBoZW1pTGlnaHRzKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYmluZEN1c3RvbVVuaWZvcm1zKHRoaXMuX2N1c3RvbVVuaWZvcm1zLCB1bmlmb3JtcywgbWF0ZXJpYWwubmFtZSwgbWF0ZXJpYWwudW5pZm9ybXMsIGZvcmNlKTtcbiAgICAgICAgX3RleHR1cmVJbmRleCA9IDA7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGJpbmRDdXN0b21Vbmlmb3JtcyhjdXN0b21Vbmlmb3JtcywgdW5pZm9ybXMsIG1hdGVyaWFsTmFtZSwgbWF0ZXJpYWxVbmlmb3JtcywgZm9yY2UpIHtcbiAgICAgICAgdmFyIGkgPSBjdXN0b21Vbmlmb3Jtcy5sZW5ndGgsXG4gICAgICAgICAgICBjdXN0b21Vbmlmb3JtLCB1bmlmb3JtVmFsdWUsIGxlbmd0aCwgbmFtZSwgdmFsdWUsIGo7XG5cbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgY3VzdG9tVW5pZm9ybSA9IGN1c3RvbVVuaWZvcm1zW2ldO1xuICAgICAgICAgICAgbmFtZSA9IGN1c3RvbVVuaWZvcm07XG5cbiAgICAgICAgICAgIHVuaWZvcm1WYWx1ZSA9IHVuaWZvcm1zW25hbWVdO1xuICAgICAgICAgICAgdmFsdWUgPSBtYXRlcmlhbFVuaWZvcm1zW25hbWVdO1xuXG4gICAgICAgICAgICBpZiAoIXVuaWZvcm1WYWx1ZSkgY29udGludWU7XG4gICAgICAgICAgICBpZiAoIXZhbHVlKSB0aHJvdyBcIldlYkdMUmVuZGVyZXIgYmluZFNoYWRlcjogbWF0ZXJpYWwgXCIgKyBtYXRlcmlhbE5hbWUgKyBcIiB3YXMgbm90IGdpdmVuIGEgdW5pZm9ybSBuYW1lZCBcIiArIG5hbWU7XG5cbiAgICAgICAgICAgIGlmICgobGVuZ3RoID0gdW5pZm9ybVZhbHVlLmxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICBqID0gbGVuZ3RoO1xuICAgICAgICAgICAgICAgIHdoaWxlIChqLS0pIHVuaWZvcm1WYWx1ZS5zZXQodmFsdWVbal0sIGZvcmNlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdW5pZm9ybVZhbHVlLnNldCh2YWx1ZSwgZm9yY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgU2hhZGVyLnByb3RvdHlwZS5idWlsZFNoYWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmFtZXRlcnMgPSB0aGlzLnBhcmFtZXRlcnMsXG4gICAgICAgICAgICB2ZXJ0ZXhTaGFkZXIgPSB0aGlzLnZlcnRleCxcbiAgICAgICAgICAgIGZyYWdtZW50U2hhZGVyID0gdGhpcy5mcmFnbWVudCxcbiAgICAgICAgICAgIHNwcml0ZSA9IHBhcmFtZXRlcnMuc3ByaXRlLFxuICAgICAgICAgICAgZW1pdHRlciA9IHBhcmFtZXRlcnMuZW1pdHRlcixcbiAgICAgICAgICAgIHVzZUxpZ2h0cyA9IHBhcmFtZXRlcnMudXNlTGlnaHRzLFxuICAgICAgICAgICAgdXNlU2hhZG93cyA9IHBhcmFtZXRlcnMudXNlU2hhZG93cyxcbiAgICAgICAgICAgIHVzZUZvZyA9IHBhcmFtZXRlcnMudXNlRm9nLFxuICAgICAgICAgICAgdXNlQm9uZXMgPSBwYXJhbWV0ZXJzLnVzZUJvbmVzLFxuICAgICAgICAgICAgdXNlVmVydGV4TGl0ID0gcGFyYW1ldGVycy51c2VWZXJ0ZXhMaXQsXG4gICAgICAgICAgICB1c2VTcGVjdWxhciA9IHBhcmFtZXRlcnMudXNlU3BlY3VsYXIsXG4gICAgICAgICAgICBPRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMgPSBwYXJhbWV0ZXJzLk9FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyxcblxuICAgICAgICAgICAgZGVmaW5lc1ByZWZpeCA9IFtcbiAgICAgICAgICAgICAgICBcInByZWNpc2lvbiBcIiArIF9wcmVjaXNpb24gKyBcIiBmbG9hdDtcIixcbiAgICAgICAgICAgICAgICBcInByZWNpc2lvbiBcIiArIF9wcmVjaXNpb24gKyBcIiBpbnQ7XCIsXG5cbiAgICAgICAgICAgICAgICB1c2VGb2cgPyBcIiNkZWZpbmUgVVNFX0ZPR1wiIDogXCJcIixcbiAgICAgICAgICAgICAgICB1c2VMaWdodHMgPyBcIiNkZWZpbmUgVVNFX0xJR0hUU1wiIDogXCJcIixcbiAgICAgICAgICAgICAgICB1c2VTaGFkb3dzID8gXCIjZGVmaW5lIFVTRV9TSEFET1dTXCIgOiBcIlwiLFxuICAgICAgICAgICAgICAgIHVzZUJvbmVzID8gXCIjZGVmaW5lIFVTRV9TS0lOTklOR1wiIDogXCJcIixcbiAgICAgICAgICAgICAgICBzcHJpdGUgPyBcIiNkZWZpbmUgSVNfU1BSSVRFXCIgOiBcIlwiLFxuXG4gICAgICAgICAgICAgICAgdXNlTGlnaHRzID8gXCIjZGVmaW5lIE1BWF9ESVJfTElHSFRTIFwiICsgcGFyYW1ldGVycy5tYXhEaXJlY3Rpb25hbExpZ2h0cyA6IFwiXCIsXG4gICAgICAgICAgICAgICAgdXNlTGlnaHRzID8gXCIjZGVmaW5lIE1BWF9QT0lOVF9MSUdIVFMgXCIgKyBwYXJhbWV0ZXJzLm1heFBvaW50TGlnaHRzIDogXCJcIixcbiAgICAgICAgICAgICAgICB1c2VMaWdodHMgPyBcIiNkZWZpbmUgTUFYX1NQT1RfTElHSFRTIFwiICsgcGFyYW1ldGVycy5tYXhTcG90TGlnaHRzIDogXCJcIixcbiAgICAgICAgICAgICAgICB1c2VMaWdodHMgPyBcIiNkZWZpbmUgTUFYX0hFTUlfTElHSFRTIFwiICsgcGFyYW1ldGVycy5tYXhIZW1pTGlnaHRzIDogXCJcIixcblxuICAgICAgICAgICAgICAgIHVzZVNoYWRvd3MgPyBcIiNkZWZpbmUgTUFYX1NIQURPV1MgXCIgKyBwYXJhbWV0ZXJzLm1heFNoYWRvd3MgOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiXCJcbiAgICAgICAgICAgIF0uam9pbihcIlxcblwiKSxcblxuICAgICAgICAgICAgdmVydGV4UHJlZml4ID0gW1xuICAgICAgICAgICAgICAgIGRlZmluZXNQcmVmaXgsXG5cbiAgICAgICAgICAgICAgICBcInVuaWZvcm0gbWF0NCBtb2RlbE1hdHJpeDtcIixcbiAgICAgICAgICAgICAgICBcInVuaWZvcm0gbWF0NCBtb2RlbFZpZXdNYXRyaXg7XCIsXG4gICAgICAgICAgICAgICAgXCJ1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDtcIixcbiAgICAgICAgICAgICAgICBcInVuaWZvcm0gbWF0NCB2aWV3TWF0cml4O1wiLFxuICAgICAgICAgICAgICAgIFwidW5pZm9ybSBtYXQzIG5vcm1hbE1hdHJpeDtcIixcbiAgICAgICAgICAgICAgICBcInVuaWZvcm0gdmVjMyBjYW1lcmFQb3NpdGlvbjtcIixcblxuICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMucG9zaXRpb25zID8gXCJhdHRyaWJ1dGUgdmVjMyBwb3NpdGlvbjtcIiA6IFwiXCIsXG4gICAgICAgICAgICAgICAgcGFyYW1ldGVycy5ub3JtYWxzID8gXCJhdHRyaWJ1dGUgdmVjMyBub3JtYWw7XCIgOiBcIlwiLFxuICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMudGFuZ2VudHMgPyBcImF0dHJpYnV0ZSB2ZWM0IHRhbmdlbnQ7XCIgOiBcIlwiLFxuICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMudXZzID8gXCJhdHRyaWJ1dGUgdmVjMiB1djtcIiA6IFwiXCIsXG4gICAgICAgICAgICAgICAgcGFyYW1ldGVycy5jb2xvcnMgPyBcImF0dHJpYnV0ZSB2ZWMzIGNvbG9yO1wiIDogXCJcIixcbiAgICAgICAgICAgICAgICBlbWl0dGVyID8gXCJhdHRyaWJ1dGUgdmVjMyBkYXRhO1wiIDogXCJcIixcblxuICAgICAgICAgICAgICAgIHVzZUJvbmVzID8gXCJhdHRyaWJ1dGUgdmVjMyBib25lSW5kZXg7XCIgOiBcIlwiLFxuICAgICAgICAgICAgICAgIHVzZUJvbmVzID8gXCJhdHRyaWJ1dGUgdmVjMyBib25lV2VpZ2h0O1wiIDogXCJcIixcbiAgICAgICAgICAgICAgICB1c2VCb25lcyA/IFwidW5pZm9ybSB2ZWM0IGJvbmVzUm90W1wiICsgcGFyYW1ldGVycy5ib25lcyArIFwiXTtcIiA6IFwiXCIsXG4gICAgICAgICAgICAgICAgdXNlQm9uZXMgPyBcInVuaWZvcm0gdmVjMyBib25lc1NjbFtcIiArIHBhcmFtZXRlcnMuYm9uZXMgKyBcIl07XCIgOiBcIlwiLFxuICAgICAgICAgICAgICAgIHVzZUJvbmVzID8gXCJ1bmlmb3JtIHZlYzMgYm9uZXNQb3NbXCIgKyBwYXJhbWV0ZXJzLmJvbmVzICsgXCJdO1wiIDogXCJcIlxuICAgICAgICAgICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgICAgICAgICBmcmFnbWVudFByZWZpeCA9IFtcbiAgICAgICAgICAgICAgICBPRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMgPyBcIiNleHRlbnNpb24gR0xfT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzIDogZW5hYmxlXCIgOiBcIlwiLFxuICAgICAgICAgICAgICAgIGRlZmluZXNQcmVmaXgsXG5cbiAgICAgICAgICAgICAgICBcInVuaWZvcm0gbWF0NCB2aWV3TWF0cml4O1wiLFxuICAgICAgICAgICAgICAgIFwidW5pZm9ybSB2ZWMzIGNhbWVyYVBvc2l0aW9uO1wiXG4gICAgICAgICAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICAgICAgICAgIGdsVmVydGV4U2hhZGVyID0gdmVydGV4UHJlZml4ICsgXCJcXG5cIiArIHZlcnRleFNoYWRlcixcbiAgICAgICAgICAgIGdsRnJhZ21lbnRTaGFkZXIgPSBmcmFnbWVudFByZWZpeCArIFwiXFxuXCIgKyBmcmFnbWVudFNoYWRlcixcblxuICAgICAgICAgICAgbWFpbiA9IFwidm9pZCBtYWluKHZvaWQpIHtcXG5cIixcbiAgICAgICAgICAgIGZvb3RlciA9IFwiXFxufVwiLFxuXG4gICAgICAgICAgICB2ZXJ0ZXhIZWFkZXIgPSBnbFZlcnRleFNoYWRlci5tYXRjaChIRUFERVIpWzFdLFxuICAgICAgICAgICAgdmVydGV4TWFpbiA9IGdsVmVydGV4U2hhZGVyLm1hdGNoKE1BSU5fRlVOQ1RJT04pWzVdLFxuICAgICAgICAgICAgZnJhZ21lbnRIZWFkZXIgPSBnbEZyYWdtZW50U2hhZGVyLm1hdGNoKEhFQURFUilbMV0sXG4gICAgICAgICAgICBmcmFnbWVudE1haW4gPSBnbEZyYWdtZW50U2hhZGVyLm1hdGNoKE1BSU5fRlVOQ1RJT04pWzVdO1xuXG4gICAgICAgIGlmIChzcHJpdGUpIHtcbiAgICAgICAgICAgIHZlcnRleEhlYWRlciArPSBTaGFkZXJDaHVua3Muc3ByaXRlX2hlYWRlcjtcbiAgICAgICAgICAgIHZlcnRleE1haW4gKz0gU2hhZGVyQ2h1bmtzLnNwcml0ZV92ZXJ0ZXhfYWZ0ZXI7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZW1pdHRlcikge1xuICAgICAgICAgICAgdmVydGV4SGVhZGVyICs9IFNoYWRlckNodW5rcy5wYXJ0aWNsZV9oZWFkZXJfdmVydGV4ICsgU2hhZGVyQ2h1bmtzLnBhcnRpY2xlX2hlYWRlcjtcbiAgICAgICAgICAgIGZyYWdtZW50SGVhZGVyICs9IFNoYWRlckNodW5rcy5wYXJ0aWNsZV9oZWFkZXI7XG4gICAgICAgICAgICBpZiAocGFyYW1ldGVycy5lbWl0dGVyMmQpIHtcbiAgICAgICAgICAgICAgICB2ZXJ0ZXhNYWluID0gU2hhZGVyQ2h1bmtzLnBhcnRpY2xlX3ZlcnRleF9zaXplXzJkICsgdmVydGV4TWFpbjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmVydGV4TWFpbiA9IFNoYWRlckNodW5rcy5wYXJ0aWNsZV92ZXJ0ZXhfc2l6ZSArIHZlcnRleE1haW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2ZXJ0ZXhNYWluID0gU2hhZGVyQ2h1bmtzLnBhcnRpY2xlX3ZlcnRleCArIHZlcnRleE1haW47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzKSB7XG4gICAgICAgICAgICBpZiAocGFyYW1ldGVycy51c2VOb3JtYWwpIGZyYWdtZW50SGVhZGVyICs9IFNoYWRlckNodW5rcy5wZXJ0dXJiTm9ybWFsMkFyYjtcbiAgICAgICAgICAgIGlmIChwYXJhbWV0ZXJzLnVzZUJ1bXApIGZyYWdtZW50SGVhZGVyICs9IFNoYWRlckNodW5rcy5kSGR4eV9md2QgKyBTaGFkZXJDaHVua3MucGVydHVyYk5vcm1hbEFyYjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh1c2VMaWdodHMpIHtcbiAgICAgICAgICAgIGlmICh1c2VWZXJ0ZXhMaXQpIHtcbiAgICAgICAgICAgICAgICB2ZXJ0ZXhIZWFkZXIgKz0gU2hhZGVyQ2h1bmtzLmxpZ2h0cyArIFNoYWRlckNodW5rcy5WZXJ0ZXhMaWdodDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmVydGV4SGVhZGVyICs9IFNoYWRlckNodW5rcy5wZXJQaXhlbFZhcnlpbmdIZWFkZXI7XG4gICAgICAgICAgICAgICAgdmVydGV4TWFpbiA9IFNoYWRlckNodW5rcy5wZXJQaXhlbFZhcnlpbmdNYWluICsgdmVydGV4TWFpbjtcblxuICAgICAgICAgICAgICAgIGZyYWdtZW50SGVhZGVyICs9IFNoYWRlckNodW5rcy5saWdodHMgKyBTaGFkZXJDaHVua3MucGVyUGl4ZWxWYXJ5aW5nSGVhZGVyO1xuICAgICAgICAgICAgICAgIGlmICh1c2VTcGVjdWxhcikge1xuICAgICAgICAgICAgICAgICAgICBmcmFnbWVudEhlYWRlciArPSBTaGFkZXJDaHVua3MuUGl4ZWxMaWdodDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmcmFnbWVudEhlYWRlciArPSBTaGFkZXJDaHVua3MuUGl4ZWxMaWdodE5vU3BlYztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChlbWl0dGVyKSB7XG4gICAgICAgICAgICAgICAgdmVydGV4TWFpbiA9IFNoYWRlckNodW5rcy5tdlBvc2l0aW9uX2VtaXR0ZXIgKyB2ZXJ0ZXhNYWluO1xuICAgICAgICAgICAgICAgIHZlcnRleE1haW4gPSBTaGFkZXJDaHVua3Mud29ybGRQb3NpdGlvbl9lbWl0dGVyICsgdmVydGV4TWFpbjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmVydGV4TWFpbiA9IChzcHJpdGUgPyBTaGFkZXJDaHVua3MubXZQb3NpdGlvbl9zcHJpdGUgOiBTaGFkZXJDaHVua3MubXZQb3NpdGlvbikgKyB2ZXJ0ZXhNYWluO1xuICAgICAgICAgICAgICAgIHZlcnRleE1haW4gPSAoc3ByaXRlID8gU2hhZGVyQ2h1bmtzLndvcmxkUG9zaXRpb25fc3ByaXRlIDogU2hhZGVyQ2h1bmtzLndvcmxkUG9zaXRpb24pICsgdmVydGV4TWFpbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYXJhbWV0ZXJzLm5vcm1hbHMpIHZlcnRleE1haW4gPSBTaGFkZXJDaHVua3MudHJhbnNmb3JtZWROb3JtYWwgKyB2ZXJ0ZXhNYWluO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGVtaXR0ZXIpIHtcbiAgICAgICAgICAgICAgICB2ZXJ0ZXhNYWluID0gU2hhZGVyQ2h1bmtzLm12UG9zaXRpb25fZW1pdHRlciArIHZlcnRleE1haW47XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZlcnRleE1haW4gPSAoc3ByaXRlID8gU2hhZGVyQ2h1bmtzLm12UG9zaXRpb25fc3ByaXRlIDogU2hhZGVyQ2h1bmtzLm12UG9zaXRpb24pICsgdmVydGV4TWFpbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh1c2VCb25lcykge1xuICAgICAgICAgICAgdmVydGV4SGVhZGVyICs9IFNoYWRlckNodW5rcy5jb21wb3NlTWF0NDtcbiAgICAgICAgICAgIHZlcnRleEhlYWRlciArPSBTaGFkZXJDaHVua3MuZ2V0Qm9uZU1hdHJpeDtcbiAgICAgICAgICAgIGlmIChwYXJhbWV0ZXJzLm5vcm1hbHMpIHZlcnRleE1haW4gPSBTaGFkZXJDaHVua3MuYm9uZU5vcm1hbCArIHZlcnRleE1haW47XG4gICAgICAgICAgICB2ZXJ0ZXhNYWluID0gU2hhZGVyQ2h1bmtzLmJvbmUgKyB2ZXJ0ZXhNYWluO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2xWZXJ0ZXhTaGFkZXIgPSB2ZXJ0ZXhIZWFkZXIgKyBtYWluICsgdmVydGV4TWFpbiArIGZvb3RlcjtcbiAgICAgICAgZ2xGcmFnbWVudFNoYWRlciA9IGZyYWdtZW50SGVhZGVyICsgbWFpbiArIGZyYWdtZW50TWFpbiArIGZvb3RlcjtcblxuICAgICAgICB0aGlzLnByb2dyYW0gPSBjcmVhdGVQcm9ncmFtKF9nbCwgZ2xWZXJ0ZXhTaGFkZXIsIGdsRnJhZ21lbnRTaGFkZXIpO1xuXG4gICAgICAgIHBhcnNlVW5pZm9ybXNBdHRyaWJ1dGVzQXJyYXlzKHZlcnRleFNoYWRlciwgZnJhZ21lbnRTaGFkZXIsICh0aGlzLl9jdXN0b21BdHRyaWJ1dGVzID0gW10pLCAodGhpcy5fY3VzdG9tVW5pZm9ybXMgPSBbXSkpO1xuICAgICAgICBwYXJzZVVuaWZvcm1zQXR0cmlidXRlcyh0aGlzLnByb2dyYW0sIGdsVmVydGV4U2hhZGVyLCBnbEZyYWdtZW50U2hhZGVyLCAodGhpcy5hdHRyaWJ1dGVzID0ge30pLCAodGhpcy51bmlmb3JtcyA9IHt9KSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuXG4gICAgdmFyIHVzZURlcHRoID0gIW9wdHMuZGlzYWJsZURlcHRoLFxuXG4gICAgICAgIF90aGlzID0gdGhpcyxcblxuICAgICAgICBfZ2wgPSB1bmRlZmluZWQsXG4gICAgICAgIF9jYW52YXMgPSB1bmRlZmluZWQsXG4gICAgICAgIF9lbGVtZW50ID0gdW5kZWZpbmVkLFxuICAgICAgICBfY29udGV4dCA9IGZhbHNlLFxuXG4gICAgICAgIF9leHRlbnNpb25zID0gdW5kZWZpbmVkLFxuXG4gICAgICAgIF9wcmVjaXNpb24gPSBcImhpZ2hwXCIsXG4gICAgICAgIF9tYXhBbmlzb3Ryb3B5ID0gMCxcbiAgICAgICAgX21heFRleHR1cmVzID0gMCxcbiAgICAgICAgX21heFZlcnRleFRleHR1cmVzID0gMCxcbiAgICAgICAgX21heFRleHR1cmVTaXplID0gMCxcbiAgICAgICAgX21heEN1YmVUZXh0dXJlU2l6ZSA9IDAsXG4gICAgICAgIF9tYXhSZW5kZXJCdWZmZXJTaXplID0gMCxcblxuICAgICAgICBfbWF4VW5pZm9ybXMgPSAwLFxuICAgICAgICBfbWF4VmFyeWluZ3MgPSAwLFxuICAgICAgICBfbWF4QXR0cmlidXRlcyA9IDAsXG5cbiAgICAgICAgX3ZpZXdwb3J0WCA9IDAsXG4gICAgICAgIF92aWV3cG9ydFkgPSAwLFxuICAgICAgICBfdmlld3BvcnRXaWR0aCA9IDEsXG4gICAgICAgIF92aWV3cG9ydEhlaWdodCA9IDEsXG5cbiAgICAgICAgX2N1cnJlbnRXaWR0aCA9IDEsXG4gICAgICAgIF9jdXJyZW50SGVpZ2h0ID0gMSxcblxuICAgICAgICBfdGV4dHVyZUluZGV4ID0gMCxcblxuICAgICAgICBfbGFzdENsZWFyQ29sb3IgPSBuZXcgQ29sb3IsXG4gICAgICAgIF9sYXN0Q2xlYXJBbHBoYSA9IDEsXG4gICAgICAgIF9sYXN0QmxlbmRpbmcgPSAtMSxcbiAgICAgICAgX2xhc3RDdWxsRmFjZSA9IC0xLFxuICAgICAgICBfY3VsbEZhY2VEaXNhYmxlZCA9IHRydWUsXG4gICAgICAgIF9sYXN0RGVwdGhUZXN0ID0gLTEsXG4gICAgICAgIF9sYXN0RGVwdGhXcml0ZSA9IC0xLFxuICAgICAgICBfbGFzdExpbmVXaWR0aCA9IC0xLFxuXG4gICAgICAgIF9jdXJyZW50RnJhbWVidWZmZXIgPSBudWxsLFxuXG4gICAgICAgIF9lbmFibGVkQXR0cmlidXRlcyA9IHVuZGVmaW5lZCxcbiAgICAgICAgX2xhc3RQcm9ncmFtID0gdW5kZWZpbmVkLFxuXG4gICAgICAgIF9hdHRyaWJ1dGVzID0gbWVyZ2Uob3B0cy5hdHRyaWJ1dGVzIHx8IHt9LCB7XG4gICAgICAgICAgICBhbHBoYTogdHJ1ZSxcbiAgICAgICAgICAgIGFudGlhbGlhczogdHJ1ZSxcbiAgICAgICAgICAgIGRlcHRoOiB0cnVlLFxuICAgICAgICAgICAgcHJlbXVsdGlwbGllZEFscGhhOiB0cnVlLFxuICAgICAgICAgICAgcHJlc2VydmVEcmF3aW5nQnVmZmVyOiBmYWxzZSxcbiAgICAgICAgICAgIHN0ZW5jaWw6IHRydWVcbiAgICAgICAgfSk7XG5cbiAgICB0aGlzLmluaXQgPSBmdW5jdGlvbiAoY2FudmFzKSB7XG4gICAgICAgIGlmIChfY2FudmFzKSB0aGlzLmNsZWFyKCk7XG5cbiAgICAgICAgX2NhbnZhcyA9IGNhbnZhcztcbiAgICAgICAgX2VsZW1lbnQgPSBjYW52YXMuZWxlbWVudDtcblxuICAgICAgICBfY2FudmFzMmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuICAgICAgICBfY3R4ID0gX2NhbnZhczJkLmdldENvbnRleHQoXCIyZFwiKTtcblxuICAgICAgICBpbml0R0woKTtcbiAgICAgICAgX2NvbnRleHQgPSB0cnVlO1xuICAgICAgICBzZXREZWZhdWx0R0xTdGF0ZSgpO1xuXG4gICAgICAgIGFkZEV2ZW50KF9lbGVtZW50LCBcIndlYmdsY29udGV4dGxvc3RcIiwgaGFuZGxlV2ViR0xDb250ZXh0TG9zdCwgdGhpcyk7XG4gICAgICAgIGFkZEV2ZW50KF9lbGVtZW50LCBcIndlYmdsY29udGV4dHJlc3RvcmVkXCIsIGhhbmRsZVdlYkdMQ29udGV4dFJlc3RvcmVkLCB0aGlzKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG5cbiAgICB0aGlzLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIV9jYW52YXMpIHJldHVybiB0aGlzO1xuXG4gICAgICAgIHRoaXMub2ZmKCk7XG5cbiAgICAgICAgcmVtb3ZlRXZlbnQoZWxlbWVudCwgXCJ3ZWJnbGNvbnRleHRsb3N0XCIsIGhhbmRsZVdlYkdMQ29udGV4dExvc3QsIHRoaXMpO1xuICAgICAgICByZW1vdmVFdmVudChlbGVtZW50LCBcIndlYmdsY29udGV4dHJlc3RvcmVkXCIsIGhhbmRsZVdlYkdMQ29udGV4dFJlc3RvcmVkLCB0aGlzKTtcblxuICAgICAgICBfZ2wgPSB1bmRlZmluZWRcbiAgICAgICAgX2NhbnZhcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgX2VsZW1lbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIF9jb250ZXh0ID0gZmFsc2U7XG5cbiAgICAgICAgX2V4dGVuc2lvbnMgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgX3ByZWNpc2lvbiA9IFwiaGlnaHBcIjtcbiAgICAgICAgX21heEFuaXNvdHJvcHkgPSAwO1xuICAgICAgICBfbWF4VGV4dHVyZXMgPSAwO1xuICAgICAgICBfbWF4VmVydGV4VGV4dHVyZXMgPSAwO1xuICAgICAgICBfbWF4VGV4dHVyZVNpemUgPSAwO1xuICAgICAgICBfbWF4Q3ViZVRleHR1cmVTaXplID0gMDtcbiAgICAgICAgX21heFJlbmRlckJ1ZmZlclNpemUgPSAwO1xuXG4gICAgICAgIF9tYXhVbmlmb3JtcyA9IDA7XG4gICAgICAgIF9tYXhWYXJ5aW5ncyA9IDA7XG4gICAgICAgIF9tYXhBdHRyaWJ1dGVzID0gMDtcblxuICAgICAgICBfdmlld3BvcnRYID0gMDtcbiAgICAgICAgX3ZpZXdwb3J0WSA9IDA7XG4gICAgICAgIF92aWV3cG9ydFdpZHRoID0gMTtcbiAgICAgICAgX3ZpZXdwb3J0SGVpZ2h0ID0gMTtcblxuICAgICAgICBfdGV4dHVyZUluZGV4ID0gMDtcblxuICAgICAgICBfbGFzdENsZWFyQ29sb3Iuc2V0KDAsIDAsIDApO1xuICAgICAgICBfbGFzdENsZWFyQWxwaGEgPSAxO1xuICAgICAgICBfbGFzdEJsZW5kaW5nID0gLTE7XG4gICAgICAgIF9sYXN0Q3VsbEZhY2UgPSAtMTtcbiAgICAgICAgX2N1bGxGYWNlRGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICBfbGFzdERlcHRoVGVzdCA9IC0xO1xuICAgICAgICBfbGFzdERlcHRoV3JpdGUgPSAtMTtcbiAgICAgICAgX2xhc3RMaW5lV2lkdGggPSAtMTtcblxuICAgICAgICBfY3VycmVudEZyYW1lYnVmZmVyID0gbnVsbDtcblxuICAgICAgICBfZW5hYmxlZEF0dHJpYnV0ZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIF9sYXN0UHJvZ3JhbSA9IHVuZGVmaW5lZDtcblxuICAgICAgICBfc2hhZGVycyA9IHt9O1xuICAgICAgICBfc3ByaXRlQnVmZmVycyA9IHVuZGVmaW5lZDtcbiAgICAgICAgX2xhc3RCdWZmZXJzID0gdW5kZWZpbmVkO1xuICAgICAgICBfbGFzdENhbWVyYSA9IHVuZGVmaW5lZDtcbiAgICAgICAgX2xhc3RSZXNpemVGbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgX2xhc3RTY2VuZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgX2xhc3RHVUkgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgX3RleHRUZXh0dXJlcyA9IHt9O1xuICAgICAgICBfY2FudmFzMmQgPSB1bmRlZmluZWQ7XG4gICAgICAgIF9jdHggPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgX2d1aUNvbnRlbnRTaGFkZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIF9ndWlCdWZmZXJzID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImdsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2dsO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgZGVmaW5lUHJvcGVydHkodGhpcywgXCJjYW52YXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfY2FudmFzO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgZGVmaW5lUHJvcGVydHkodGhpcywgXCJlbGVtZW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2VsZW1lbnQ7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInByZWNpc2lvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9wcmVjaXNpb247XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1heEFuaXNvdHJvcHlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbWF4QW5pc290cm9weTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGRlZmluZVByb3BlcnR5KHRoaXMsIFwibWF4VGV4dHVyZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbWF4VGV4dHVyZXM7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1heFZlcnRleFRleHR1cmVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX21heFZlcnRleFRleHR1cmVzO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgZGVmaW5lUHJvcGVydHkodGhpcywgXCJtYXhUZXh0dXJlU2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9tYXhUZXh0dXJlU2l6ZTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGRlZmluZVByb3BlcnR5KHRoaXMsIFwibWF4Q3ViZVRleHR1cmVTaXplXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX21heEN1YmVUZXh0dXJlU2l6ZTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGRlZmluZVByb3BlcnR5KHRoaXMsIFwibWF4UmVuZGVyQnVmZmVyU2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9tYXhSZW5kZXJCdWZmZXJTaXplO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgZGVmaW5lUHJvcGVydHkodGhpcywgXCJtYXhVbmlmb3Jtc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9tYXhVbmlmb3JtcztcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGRlZmluZVByb3BlcnR5KHRoaXMsIFwibWF4VmFyeWluZ3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbWF4VmFyeWluZ3M7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1heEF0dHJpYnV0ZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbWF4QXR0cmlidXRlcztcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlQnVmZmVyKG9iaiwgbmFtZSwgYXJyYXkpIHtcblxuICAgICAgICBvYmpbbmFtZV0gPSBvYmpbbmFtZV0gfHwgX2dsLmNyZWF0ZUJ1ZmZlcigpO1xuICAgICAgICBfZ2wuYmluZEJ1ZmZlcihfZ2wuQVJSQVlfQlVGRkVSLCBvYmpbbmFtZV0pO1xuICAgICAgICBfZ2wuYnVmZmVyRGF0YShfZ2wuQVJSQVlfQlVGRkVSLCBhcnJheSwgX2dsLlNUQVRJQ19EUkFXKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVTcHJpdGUoKSB7XG4gICAgICAgIF9zcHJpdGVCdWZmZXJzID0ge307XG5cbiAgICAgICAgY3JlYXRlQnVmZmVyKF9zcHJpdGVCdWZmZXJzLCBcIl93ZWJnbFZlcnRleEJ1ZmZlclwiLCBuZXcgRmxvYXQzMkFycmF5KFstMC41LCAwLjUsIDAuMCwgLTAuNSwgLTAuNSwgMC4wLFxuICAgICAgICAgICAgMC41LCAwLjUsIDAuMCxcbiAgICAgICAgICAgIDAuNSwgLTAuNSwgMC4wXG4gICAgICAgIF0pKTtcbiAgICAgICAgY3JlYXRlQnVmZmVyKF9zcHJpdGVCdWZmZXJzLCBcIl93ZWJnbFV2QnVmZmVyXCIsIG5ldyBGbG9hdDMyQXJyYXkoW1xuICAgICAgICAgICAgMC4wLCAwLjAsXG4gICAgICAgICAgICAwLjAsIDEuMCxcbiAgICAgICAgICAgIDEuMCwgMC4wLFxuICAgICAgICAgICAgMS4wLCAxLjBcbiAgICAgICAgXSkpO1xuICAgICAgICBjcmVhdGVCdWZmZXIoX3Nwcml0ZUJ1ZmZlcnMsIFwiX3dlYmdsTm9ybWFsQnVmZmVyXCIsIG5ldyBGbG9hdDMyQXJyYXkoW1xuICAgICAgICAgICAgMC4wLCAwLjAsIDEuMCxcbiAgICAgICAgICAgIDAuMCwgMC4wLCAxLjAsXG4gICAgICAgICAgICAwLjAsIDAuMCwgMS4wLFxuICAgICAgICAgICAgMC4wLCAwLjAsIDEuMCxcbiAgICAgICAgXSkpO1xuICAgICAgICBjcmVhdGVCdWZmZXIoX3Nwcml0ZUJ1ZmZlcnMsIFwiX3dlYmdsVGFuZ2VudEJ1ZmZlclwiLCBuZXcgRmxvYXQzMkFycmF5KFtcbiAgICAgICAgICAgIDAuMCwgMC4wLCAwLjAsIDEuMCxcbiAgICAgICAgICAgIDAuMCwgMS4wLCAwLjAsIDEuMCxcbiAgICAgICAgICAgIDEuMCwgMC4wLCAwLjAsIDEuMCxcbiAgICAgICAgICAgIDEuMCwgMS4wLCAwLjAsIDEuMCxcbiAgICAgICAgXSkpO1xuICAgICAgICBfc3ByaXRlQnVmZmVycy5fd2ViZ2xWZXJ0ZXhDb3VudCA9IDQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlR1VJQnVmZmVycygpIHtcbiAgICAgICAgX2d1aUJ1ZmZlcnMgPSB7fTtcblxuICAgICAgICBjcmVhdGVCdWZmZXIoX2d1aUJ1ZmZlcnMsIFwiX3dlYmdsVmVydGV4QnVmZmVyXCIsIG5ldyBGbG9hdDMyQXJyYXkoW1xuICAgICAgICAgICAgMC4wLCAwLjAsIDAuMCxcbiAgICAgICAgICAgIDAuMCwgMS4wLCAwLjAsXG4gICAgICAgICAgICAxLjAsIDAuMCwgMC4wLFxuICAgICAgICAgICAgMS4wLCAxLjAsIDAuMFxuICAgICAgICBdKSk7XG4gICAgICAgIGNyZWF0ZUJ1ZmZlcihfZ3VpQnVmZmVycywgXCJfd2ViZ2xVdkJ1ZmZlclwiLCBuZXcgRmxvYXQzMkFycmF5KFtcbiAgICAgICAgICAgIDAuMCwgMC4wLFxuICAgICAgICAgICAgMC4wLCAxLjAsXG4gICAgICAgICAgICAxLjAsIDAuMCxcbiAgICAgICAgICAgIDEuMCwgMS4wXG4gICAgICAgIF0pKTtcblxuICAgICAgICBfZ3VpQnVmZmVycy5fd2ViZ2xWZXJ0ZXhDb3VudCA9IDQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlR1VJQ29udGVudFNoYWRlcigpIHtcbiAgICAgICAgdmFyIHNoYWRlciA9IF9ndWlDb250ZW50U2hhZGVyID0gbmV3IFNoYWRlcixcbiAgICAgICAgICAgIGhlYWRlciA9IFtcbiAgICAgICAgICAgICAgICBcInByZWNpc2lvbiBcIiArIF9wcmVjaXNpb24gKyBcIiBmbG9hdDtcIixcbiAgICAgICAgICAgICAgICBcInByZWNpc2lvbiBcIiArIF9wcmVjaXNpb24gKyBcIiBpbnQ7XCIsXG4gICAgICAgICAgICAgICAgXCJcIlxuICAgICAgICAgICAgXS5qb2luKFwiXFxuXCIpLFxuICAgICAgICAgICAgdmVydGV4U2hhZGVyID0gaGVhZGVyICsgZ3VpQ29udGVudF92ZXJ0ZXgsXG4gICAgICAgICAgICBmcmFnbWVudFNoYWRlciA9IGhlYWRlciArIGd1aUNvbnRlbnRfZnJhZ21lbnQ7XG5cbiAgICAgICAgc2hhZGVyLnByb2dyYW0gPSBjcmVhdGVQcm9ncmFtKF9nbCwgdmVydGV4U2hhZGVyLCBmcmFnbWVudFNoYWRlcik7XG4gICAgICAgIHBhcnNlVW5pZm9ybXNBdHRyaWJ1dGVzKHNoYWRlci5wcm9ncmFtLCB2ZXJ0ZXhTaGFkZXIsIGZyYWdtZW50U2hhZGVyLCAoc2hhZGVyLmF0dHJpYnV0ZXMgPSB7fSksIChzaGFkZXIudW5pZm9ybXMgPSB7fSkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFZpZXdwb3J0KHgsIHksIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgeCB8fCAoeCA9IDApO1xuICAgICAgICB5IHx8ICh5ID0gMCk7XG4gICAgICAgIHdpZHRoIHx8ICh3aWR0aCA9IF9jYW52YXMucGl4ZWxXaWR0aCk7XG4gICAgICAgIGhlaWdodCB8fCAoaGVpZ2h0ID0gX2NhbnZhcy5waXhlbEhlaWdodCk7XG5cbiAgICAgICAgaWYgKF92aWV3cG9ydFggIT09IHggfHwgX3ZpZXdwb3J0WSAhPT0geSB8fCBfdmlld3BvcnRXaWR0aCAhPT0gd2lkdGggfHwgX3ZpZXdwb3J0SGVpZ2h0ICE9PSBoZWlnaHQpIHtcbiAgICAgICAgICAgIF92aWV3cG9ydFggPSB4O1xuICAgICAgICAgICAgX3ZpZXdwb3J0WSA9IHk7XG4gICAgICAgICAgICBfdmlld3BvcnRXaWR0aCA9IHdpZHRoO1xuICAgICAgICAgICAgX3ZpZXdwb3J0SGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgICAgICAgICBfZ2wudmlld3BvcnQoeCwgeSwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnNldFZpZXdwb3J0ID0gc2V0Vmlld3BvcnQ7XG5cblxuICAgIGZ1bmN0aW9uIHNldERlcHRoVGVzdChkZXB0aFRlc3QpIHtcblxuICAgICAgICBpZiAoX2xhc3REZXB0aFRlc3QgIT09IGRlcHRoVGVzdCkge1xuXG4gICAgICAgICAgICBpZiAoZGVwdGhUZXN0KSB7XG4gICAgICAgICAgICAgICAgX2dsLmVuYWJsZShfZ2wuREVQVEhfVEVTVCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIF9nbC5kaXNhYmxlKF9nbC5ERVBUSF9URVNUKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2xhc3REZXB0aFRlc3QgPSBkZXB0aFRlc3Q7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnNldERlcHRoVGVzdCA9IHNldERlcHRoVGVzdDtcblxuXG4gICAgZnVuY3Rpb24gc2V0RGVwdGhXcml0ZShkZXB0aFdyaXRlKSB7XG5cbiAgICAgICAgaWYgKF9sYXN0RGVwdGhXcml0ZSAhPT0gZGVwdGhXcml0ZSkge1xuXG4gICAgICAgICAgICBfZ2wuZGVwdGhNYXNrKGRlcHRoV3JpdGUpO1xuICAgICAgICAgICAgX2xhc3REZXB0aFdyaXRlID0gZGVwdGhXcml0ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuc2V0RGVwdGhXcml0ZSA9IHNldERlcHRoV3JpdGU7XG5cblxuICAgIGZ1bmN0aW9uIHNldExpbmVXaWR0aCh3aWR0aCkge1xuXG4gICAgICAgIGlmIChfbGFzdExpbmVXaWR0aCAhPT0gd2lkdGgpIHtcblxuICAgICAgICAgICAgX2dsLmxpbmVXaWR0aCh3aWR0aCk7XG4gICAgICAgICAgICBfbGFzdExpbmVXaWR0aCA9IHdpZHRoO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5zZXRMaW5lV2lkdGggPSBzZXRMaW5lV2lkdGg7XG5cblxuICAgIGZ1bmN0aW9uIHNldEN1bGxGYWNlKGN1bGxGYWNlKSB7XG5cbiAgICAgICAgaWYgKF9sYXN0Q3VsbEZhY2UgIT09IGN1bGxGYWNlKSB7XG4gICAgICAgICAgICBpZiAoIV9sYXN0Q3VsbEZhY2UgfHwgX2xhc3RDdWxsRmFjZSA9PT0gQ3VsbEZhY2UuTm9uZSkgX2N1bGxGYWNlRGlzYWJsZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICBpZiAoY3VsbEZhY2UgPT09IEN1bGxGYWNlLkZyb250KSB7XG4gICAgICAgICAgICAgICAgaWYgKF9jdWxsRmFjZURpc2FibGVkKSBfZ2wuZW5hYmxlKF9nbC5DVUxMX0ZBQ0UpO1xuICAgICAgICAgICAgICAgIF9nbC5jdWxsRmFjZShfZ2wuRlJPTlQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjdWxsRmFjZSA9PT0gQ3VsbEZhY2UuQmFjaykge1xuICAgICAgICAgICAgICAgIGlmIChfY3VsbEZhY2VEaXNhYmxlZCkgX2dsLmVuYWJsZShfZ2wuQ1VMTF9GQUNFKTtcbiAgICAgICAgICAgICAgICBfZ2wuY3VsbEZhY2UoX2dsLkJBQ0spO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjdWxsRmFjZSA9PT0gQ3VsbEZhY2UuRnJvbnRCYWNrKSB7XG4gICAgICAgICAgICAgICAgaWYgKF9jdWxsRmFjZURpc2FibGVkKSBfZ2wuZW5hYmxlKF9nbC5DVUxMX0ZBQ0UpO1xuICAgICAgICAgICAgICAgIF9nbC5jdWxsRmFjZShfZ2wuRlJPTlRfQU5EX0JBQ0spO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBfZ2wuZGlzYWJsZShfZ2wuQ1VMTF9GQUNFKTtcbiAgICAgICAgICAgICAgICBfbGFzdEN1bGxGYWNlID0gQ3VsbEZhY2UuTm9uZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9sYXN0Q3VsbEZhY2UgPSBjdWxsRmFjZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuc2V0Q3VsbEZhY2UgPSBzZXRDdWxsRmFjZTtcblxuXG4gICAgZnVuY3Rpb24gc2V0QmxlbmRpbmcoYmxlbmRpbmcpIHtcblxuICAgICAgICBpZiAoYmxlbmRpbmcgIT09IF9sYXN0QmxlbmRpbmcpIHtcblxuICAgICAgICAgICAgaWYgKGJsZW5kaW5nID09PSBCbGVuZGluZy5Ob25lKSB7XG4gICAgICAgICAgICAgICAgX2dsLmRpc2FibGUoX2dsLkJMRU5EKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYmxlbmRpbmcgPT09IEJsZW5kaW5nLkFkZGl0aXZlKSB7XG4gICAgICAgICAgICAgICAgX2dsLmVuYWJsZShfZ2wuQkxFTkQpO1xuICAgICAgICAgICAgICAgIF9nbC5ibGVuZEVxdWF0aW9uKF9nbC5GVU5DX0FERCk7XG4gICAgICAgICAgICAgICAgX2dsLmJsZW5kRnVuYyhfZ2wuU1JDX0FMUEhBLCBfZ2wuT05FKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYmxlbmRpbmcgPT09IEJsZW5kaW5nLlN1YnRyYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgX2dsLmVuYWJsZShfZ2wuQkxFTkQpO1xuICAgICAgICAgICAgICAgIF9nbC5ibGVuZEVxdWF0aW9uKF9nbC5GVU5DX0FERCk7XG4gICAgICAgICAgICAgICAgX2dsLmJsZW5kRnVuYyhfZ2wuWkVSTywgX2dsLk9ORV9NSU5VU19TUkNfQ09MT1IpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChibGVuZGluZyA9PT0gQmxlbmRpbmcuTXVsaXBseSkge1xuICAgICAgICAgICAgICAgIF9nbC5lbmFibGUoX2dsLkJMRU5EKTtcbiAgICAgICAgICAgICAgICBfZ2wuYmxlbmRFcXVhdGlvbihfZ2wuRlVOQ19BREQpO1xuICAgICAgICAgICAgICAgIF9nbC5ibGVuZEZ1bmMoX2dsLlpFUk8sIF9nbC5TUkNfQ09MT1IpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChibGVuZGluZyA9PT0gQmxlbmRpbmcuRGVmYXVsdCkge1xuICAgICAgICAgICAgICAgIF9nbC5lbmFibGUoX2dsLkJMRU5EKTtcbiAgICAgICAgICAgICAgICBfZ2wuYmxlbmRFcXVhdGlvblNlcGFyYXRlKF9nbC5GVU5DX0FERCwgX2dsLkZVTkNfQUREKTtcbiAgICAgICAgICAgICAgICBfZ2wuYmxlbmRGdW5jU2VwYXJhdGUoX2dsLlNSQ19BTFBIQSwgX2dsLk9ORV9NSU5VU19TUkNfQUxQSEEsIF9nbC5PTkUsIF9nbC5PTkVfTUlOVVNfU1JDX0FMUEhBKTtcbiAgICAgICAgICAgICAgICBfbGFzdEJsZW5kaW5nID0gQmxlbmRpbmcuRGVmYXVsdDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9sYXN0QmxlbmRpbmcgPSBibGVuZGluZztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuc2V0QmxlbmRpbmcgPSBzZXRCbGVuZGluZztcblxuXG4gICAgZnVuY3Rpb24gc2V0U2Npc3Nvcih4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7XG5cbiAgICAgICAgX2dsLnNjaXNzb3IoeCwgeSwgd2lkdGgsIGhlaWdodCk7XG4gICAgfTtcbiAgICB0aGlzLnNldFNjaXNzb3IgPSBzZXRTY2lzc29yO1xuXG5cbiAgICBmdW5jdGlvbiBzZXRDbGVhckNvbG9yKGNvbG9yLCBhbHBoYSkge1xuICAgICAgICBhbHBoYSB8fCAoYWxwaGEgPSAxKTtcblxuICAgICAgICBpZiAoIV9sYXN0Q2xlYXJDb2xvci5lcXVhbHMoY29sb3IpIHx8IGFscGhhICE9PSBfbGFzdENsZWFyQWxwaGEpIHtcblxuICAgICAgICAgICAgX2xhc3RDbGVhckNvbG9yLmNvcHkoY29sb3IpO1xuICAgICAgICAgICAgX2xhc3RDbGVhckFscGhhID0gYWxwaGE7XG5cbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5jbGVhckNvbG9yKF9sYXN0Q2xlYXJDb2xvci5yLCBfbGFzdENsZWFyQ29sb3IuZywgX2xhc3RDbGVhckNvbG9yLmIsIF9sYXN0Q2xlYXJBbHBoYSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnNldENsZWFyQ29sb3IgPSBzZXRDbGVhckNvbG9yO1xuXG5cbiAgICBmdW5jdGlvbiBjbGVhckNhbnZhcyhjb2xvciwgZGVwdGgsIHN0ZW5jaWwpIHtcbiAgICAgICAgdmFyIGJpdHMgPSAwO1xuXG4gICAgICAgIGlmIChjb2xvciA9PT0gdW5kZWZpbmVkIHx8IGNvbG9yKSBiaXRzIHw9IF9nbC5DT0xPUl9CVUZGRVJfQklUO1xuICAgICAgICBpZiAoZGVwdGggPT09IHVuZGVmaW5lZCB8fCBkZXB0aCkgYml0cyB8PSBfZ2wuREVQVEhfQlVGRkVSX0JJVDtcbiAgICAgICAgaWYgKHN0ZW5jaWwgPT09IHVuZGVmaW5lZCB8fCBzdGVuY2lsKSBiaXRzIHw9IF9nbC5TVEVOQ0lMX0JVRkZFUl9CSVQ7XG5cbiAgICAgICAgX2dsLmNsZWFyKGJpdHMpO1xuICAgIH1cblxuICAgIHRoaXMuY2xlYXJDYW52YXMgPSBjbGVhckNhbnZhcztcblxuXG4gICAgZnVuY3Rpb24gY2xlYXJDb2xvcigpIHtcblxuICAgICAgICBfZ2wuY2xlYXIoX2dsLkNPTE9SX0JVRkZFUl9CSVQpO1xuICAgIH1cblxuICAgIHRoaXMuY2xlYXJDb2xvciA9IGNsZWFyQ29sb3I7XG5cblxuICAgIGZ1bmN0aW9uIGNsZWFyRGVwdGgoKSB7XG5cbiAgICAgICAgX2dsLmNsZWFyKF9nbC5ERVBUSF9CVUZGRVJfQklUKTtcbiAgICB9XG5cbiAgICB0aGlzLmNsZWFyRGVwdGggPSBjbGVhckRlcHRoO1xuXG5cbiAgICBmdW5jdGlvbiBjbGVhclN0ZW5jaWwoKSB7XG5cbiAgICAgICAgX2dsLmNsZWFyKF9nbC5TVEVOQ0lMX0JVRkZFUl9CSVQpO1xuICAgIH1cblxuICAgIHRoaXMuY2xlYXJTdGVuY2lsID0gY2xlYXJTdGVuY2lsO1xuXG5cbiAgICBmdW5jdGlvbiBzZXRQcm9ncmFtKHByb2dyYW0pIHtcblxuICAgICAgICBpZiAoX2xhc3RQcm9ncmFtICE9PSBwcm9ncmFtKSB7XG4gICAgICAgICAgICBfZ2wudXNlUHJvZ3JhbShwcm9ncmFtKTtcbiAgICAgICAgICAgIF9sYXN0UHJvZ3JhbSA9IHByb2dyYW07XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICB0aGlzLnNldFByb2dyYW0gPSBzZXRQcm9ncmFtO1xuXG5cbiAgICBmdW5jdGlvbiBlbmFibGVBdHRyaWJ1dGUoYXR0cmlidXRlKSB7XG5cbiAgICAgICAgaWYgKF9lbmFibGVkQXR0cmlidXRlc1thdHRyaWJ1dGVdID09PSAwKSB7XG4gICAgICAgICAgICBfZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkoYXR0cmlidXRlKTtcbiAgICAgICAgICAgIF9lbmFibGVkQXR0cmlidXRlc1thdHRyaWJ1dGVdID0gMTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5lbmFibGVBdHRyaWJ1dGUgPSBlbmFibGVBdHRyaWJ1dGU7XG5cblxuICAgIGZ1bmN0aW9uIGRpc2FibGVBdHRyaWJ1dGVzKCkge1xuICAgICAgICB2YXIgaSA9IF9tYXhBdHRyaWJ1dGVzO1xuXG4gICAgICAgIHdoaWxlIChpLS0pIHtcblxuICAgICAgICAgICAgaWYgKF9lbmFibGVkQXR0cmlidXRlc1tpXSA9PT0gMSkge1xuICAgICAgICAgICAgICAgIF9nbC5kaXNhYmxlVmVydGV4QXR0cmliQXJyYXkoaSk7XG4gICAgICAgICAgICAgICAgX2VuYWJsZWRBdHRyaWJ1dGVzW2ldID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5kaXNhYmxlQXR0cmlidXRlcyA9IGRpc2FibGVBdHRyaWJ1dGVzO1xuXG5cbiAgICBmdW5jdGlvbiBzZXRUZXh0dXJlKGxvY2F0aW9uLCB0ZXh0dXJlKSB7XG4gICAgICAgIGlmICghdGV4dHVyZSkgcmV0dXJuO1xuICAgICAgICB2YXIgaW5kZXgsIGdsVGV4dHVyZTtcblxuICAgICAgICBpZiAoX3RleHR1cmVJbmRleCA+PSBfbWF4VGV4dHVyZXMpIHtcbiAgICAgICAgICAgIExvZy53YXJuKFwiUmVuZGVyZXIgc2V0VGV4dXJlOiB1c2luZyBcIiArIF90ZXh0dXJlSW5kZXggKyBcIiB0ZXh0dXJlIHVuaXRzLCBHUFUgb25seSBzdXBwb3J0cyBcIiArIF9tYXhUZXh0dXJlcyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoKCF0ZXh0dXJlLm5lZWRzVXBkYXRlIHx8IHRleHR1cmUgaW5zdGFuY2VvZiBSZW5kZXJUYXJnZXQpICYmIChnbFRleHR1cmUgPSB0ZXh0dXJlLl93ZWJnbCkpIHtcbiAgICAgICAgICAgIGluZGV4ID0gX3RleHR1cmVJbmRleCsrO1xuXG4gICAgICAgICAgICBfZ2wuYWN0aXZlVGV4dHVyZShfZ2wuVEVYVFVSRTAgKyBpbmRleCk7XG4gICAgICAgICAgICBfZ2wuYmluZFRleHR1cmUoX2dsLlRFWFRVUkVfMkQsIGdsVGV4dHVyZSk7XG4gICAgICAgICAgICBfZ2wudW5pZm9ybTFpKGxvY2F0aW9uLCBpbmRleCk7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGV4dHVyZS5yYXcpIHJldHVybjtcblxuICAgICAgICBnbFRleHR1cmUgPSB0ZXh0dXJlLl93ZWJnbCB8fCAodGV4dHVyZS5fd2ViZ2wgPSBfZ2wuY3JlYXRlVGV4dHVyZSgpKTtcbiAgICAgICAgaW5kZXggPSBfdGV4dHVyZUluZGV4Kys7XG5cbiAgICAgICAgdmFyIHJhdyA9IHRleHR1cmUucmF3LFxuICAgICAgICAgICAgVEZBID0gX2V4dGVuc2lvbnMuRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljLFxuXG4gICAgICAgICAgICBpc1BPVCA9IGlzUG93ZXJPZlR3byhyYXcud2lkdGgpICYmIGlzUG93ZXJPZlR3byhyYXcuaGVpZ2h0KSxcbiAgICAgICAgICAgIGFuaXNvdHJvcHkgPSBjbGFtcCh0ZXh0dXJlLmFuaXNvdHJvcHkgfHwgMSwgMSwgX21heEFuaXNvdHJvcHkpLFxuXG4gICAgICAgICAgICBURVhUVVJFXzJEID0gX2dsLlRFWFRVUkVfMkQsXG4gICAgICAgICAgICBnZW5lcmF0ZU1pcG1hcCA9IHRleHR1cmUuZ2VuZXJhdGVNaXBtYXAsXG4gICAgICAgICAgICBmaWx0ZXIgPSB0ZXh0dXJlLmZpbHRlcixcbiAgICAgICAgICAgIGZvcm1hdCA9IHRleHR1cmUuZm9ybWF0LFxuICAgICAgICAgICAgd3JhcCA9IHRleHR1cmUud3JhcCxcbiAgICAgICAgICAgIFdSQVAsIE1BR19GSUxURVIsIE1JTl9GSUxURVIsIEZPUk1BVDtcblxuICAgICAgICBpZiAoZmlsdGVyID09PSBGaWx0ZXJNb2RlLk5vbmUpIHtcbiAgICAgICAgICAgIE1BR19GSUxURVIgPSBfZ2wuTkVBUkVTVDtcbiAgICAgICAgICAgIGlmIChnZW5lcmF0ZU1pcG1hcCAmJiBpc1BPVCkge1xuICAgICAgICAgICAgICAgIE1JTl9GSUxURVIgPSBfZ2wuTElORUFSX01JUE1BUF9ORUFSRVNUO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBNSU5fRklMVEVSID0gX2dsLk5FQVJFU1Q7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7IC8vRmlsdGVyTW9kZS5MaW5lYXJcbiAgICAgICAgICAgIE1BR19GSUxURVIgPSBfZ2wuTElORUFSO1xuICAgICAgICAgICAgaWYgKGdlbmVyYXRlTWlwbWFwICYmIGlzUE9UKSB7XG4gICAgICAgICAgICAgICAgTUlOX0ZJTFRFUiA9IF9nbC5MSU5FQVJfTUlQTUFQX0xJTkVBUjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgTUlOX0ZJTFRFUiA9IF9nbC5MSU5FQVI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZm9ybWF0ID09PSBUZXh0dXJlRm9ybWF0LlJHQikge1xuICAgICAgICAgICAgRk9STUFUID0gX2dsLlJHQjtcbiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09IFRleHR1cmVGb3JtYXQuUkdCQSkge1xuICAgICAgICAgICAgRk9STUFUID0gX2dsLlJHQkE7XG4gICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSBUZXh0dXJlRm9ybWF0Lkx1bWluYW5jZUFscGhhKSB7XG4gICAgICAgICAgICBGT1JNQVQgPSBfZ2wuTFVNSU5BTkNFX0FMUEhBO1xuICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gVGV4dHVyZUZvcm1hdC5MdW1pbmFuY2UpIHtcbiAgICAgICAgICAgIEZPUk1BVCA9IF9nbC5MVU1JTkFOQ0U7XG4gICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSBUZXh0dXJlRm9ybWF0LkFscGhhKSB7XG4gICAgICAgICAgICBGT1JNQVQgPSBfZ2wuQUxQSEE7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAod3JhcCA9PT0gVGV4dHVyZVdyYXAuQ2xhbXApIHtcbiAgICAgICAgICAgIFdSQVAgPSBfZ2wuQ0xBTVBfVE9fRURHRTtcbiAgICAgICAgfSBlbHNlIGlmICh3cmFwID09PSBUZXh0dXJlV3JhcC5NaXJyb3JSZXBlYXQpIHtcbiAgICAgICAgICAgIFdSQVAgPSBpc1BPVCA/IF9nbC5NSVJST1JFRF9SRVBFQVQgOiBfZ2wuQ0xBTVBfVE9fRURHRTtcbiAgICAgICAgfSBlbHNlIHsgLy9UZXh0dXJlV3JhcC5SZXBlYXRcbiAgICAgICAgICAgIFdSQVAgPSBpc1BPVCA/IF9nbC5SRVBFQVQgOiBfZ2wuQ0xBTVBfVE9fRURHRTtcbiAgICAgICAgfVxuXG4gICAgICAgIF9nbC5hY3RpdmVUZXh0dXJlKF9nbC5URVhUVVJFMCArIGluZGV4KTtcbiAgICAgICAgX2dsLmJpbmRUZXh0dXJlKFRFWFRVUkVfMkQsIGdsVGV4dHVyZSk7XG4gICAgICAgIF9nbC51bmlmb3JtMWkobG9jYXRpb24sIGluZGV4KTtcblxuICAgICAgICBfZ2wucGl4ZWxTdG9yZWkoX2dsLlVOUEFDS19GTElQX1lfV0VCR0wsIHRleHR1cmUuZmxpcFkgPyAxIDogMCk7XG4gICAgICAgIF9nbC5waXhlbFN0b3JlaShfZ2wuVU5QQUNLX1BSRU1VTFRJUExZX0FMUEhBX1dFQkdMLCB0ZXh0dXJlLnByZW11bHRpcGx5QWxwaGEgPyAxIDogMCk7XG5cbiAgICAgICAgX2dsLnRleEltYWdlMkQoVEVYVFVSRV8yRCwgMCwgRk9STUFULCBGT1JNQVQsIF9nbC5VTlNJR05FRF9CWVRFLCBjbGFtcFRvTWF4U2l6ZShyYXcsIF9tYXhUZXh0dXJlU2l6ZSkpO1xuXG4gICAgICAgIF9nbC50ZXhQYXJhbWV0ZXJpKFRFWFRVUkVfMkQsIF9nbC5URVhUVVJFX01BR19GSUxURVIsIE1BR19GSUxURVIpO1xuICAgICAgICBfZ2wudGV4UGFyYW1ldGVyaShURVhUVVJFXzJELCBfZ2wuVEVYVFVSRV9NSU5fRklMVEVSLCBNSU5fRklMVEVSKTtcblxuICAgICAgICBfZ2wudGV4UGFyYW1ldGVyaShURVhUVVJFXzJELCBfZ2wuVEVYVFVSRV9XUkFQX1MsIFdSQVApO1xuICAgICAgICBfZ2wudGV4UGFyYW1ldGVyaShURVhUVVJFXzJELCBfZ2wuVEVYVFVSRV9XUkFQX1QsIFdSQVApO1xuXG4gICAgICAgIGlmIChURkEpIF9nbC50ZXhQYXJhbWV0ZXJmKFRFWFRVUkVfMkQsIFRGQS5URVhUVVJFX01BWF9BTklTT1RST1BZX0VYVCwgYW5pc290cm9weSk7XG4gICAgICAgIGlmIChnZW5lcmF0ZU1pcG1hcCAmJiBpc1BPVCkgX2dsLmdlbmVyYXRlTWlwbWFwKFRFWFRVUkVfMkQpO1xuXG4gICAgICAgIHRleHR1cmUubmVlZHNVcGRhdGUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRUZXh0dXJlQ3ViZShsb2NhdGlvbiwgY3ViZVRleHR1cmUpIHtcbiAgICAgICAgaWYgKCFjdWJlVGV4dHVyZSB8fCAhY3ViZVRleHR1cmUucmF3KSByZXR1cm47XG4gICAgICAgIHZhciBnbFRleHR1cmUgPSBjdWJlVGV4dHVyZS5fd2ViZ2wsXG4gICAgICAgICAgICBpbmRleDtcblxuICAgICAgICBpZiAoX3RleHR1cmVJbmRleCA+PSBfbWF4VGV4dHVyZXMpIHtcbiAgICAgICAgICAgIExvZy53YXJuKFwiUmVuZGVyZXIgc2V0VGV4dHVyZUN1YmU6IHVzaW5nIFwiICsgX3RleHR1cmVJbmRleCArIFwiIHRleHR1cmUgdW5pdHMsIEdQVSBvbmx5IHN1cHBvcnRzIFwiICsgX21heFRleHR1cmVzKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY3ViZVRleHR1cmUubmVlZHNVcGRhdGUgJiYgZ2xUZXh0dXJlKSB7XG4gICAgICAgICAgICBpbmRleCA9IF90ZXh0dXJlSW5kZXgrKztcblxuICAgICAgICAgICAgX2dsLmFjdGl2ZVRleHR1cmUoX2dsLlRFWFRVUkUwICsgaW5kZXgpO1xuICAgICAgICAgICAgX2dsLmJpbmRUZXh0dXJlKF9nbC5URVhUVVJFX0NVQkVfTUFQLCBnbFRleHR1cmUpO1xuICAgICAgICAgICAgX2dsLnVuaWZvcm0xaShsb2NhdGlvbiwgaW5kZXgpO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBnbFRleHR1cmUgPSBjdWJlVGV4dHVyZS5fd2ViZ2wgfHwgKGN1YmVUZXh0dXJlLl93ZWJnbCA9IF9nbC5jcmVhdGVUZXh0dXJlKCkpO1xuICAgICAgICBpbmRleCA9IF90ZXh0dXJlSW5kZXgrKztcblxuICAgICAgICB2YXIgcmF3ID0gY3ViZVRleHR1cmUucmF3LFxuICAgICAgICAgICAgVEZBID0gX2V4dGVuc2lvbnMuRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljLFxuXG4gICAgICAgICAgICBmaXJzdCA9IHJhd1swXSxcbiAgICAgICAgICAgIGlzUE9UID0gaXNQb3dlck9mVHdvKGZpcnN0LndpZHRoKSAmJiBpc1Bvd2VyT2ZUd28oZmlyc3QuaGVpZ2h0KSxcbiAgICAgICAgICAgIGFuaXNvdHJvcHkgPSBjbGFtcChjdWJlVGV4dHVyZS5hbmlzb3Ryb3B5IHx8IDEsIDEsIF9tYXhBbmlzb3Ryb3B5KSxcblxuICAgICAgICAgICAgVEVYVFVSRV9DVUJFX01BUCA9IF9nbC5URVhUVVJFX0NVQkVfTUFQLFxuICAgICAgICAgICAgVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YID0gX2dsLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWCxcbiAgICAgICAgICAgIFVOU0lHTkVEX0JZVEUgPSBfZ2wuVU5TSUdORURfQllURSxcblxuICAgICAgICAgICAgZ2VuZXJhdGVNaXBtYXAgPSBjdWJlVGV4dHVyZS5nZW5lcmF0ZU1pcG1hcCxcbiAgICAgICAgICAgIGZpbHRlciA9IGN1YmVUZXh0dXJlLmZpbHRlcixcbiAgICAgICAgICAgIGZvcm1hdCA9IGN1YmVUZXh0dXJlLmZvcm1hdCxcbiAgICAgICAgICAgIHdyYXAgPSBjdWJlVGV4dHVyZS53cmFwLFxuICAgICAgICAgICAgV1JBUCwgTUFHX0ZJTFRFUiwgTUlOX0ZJTFRFUiwgRk9STUFUO1xuXG4gICAgICAgIGlmIChmaWx0ZXIgPT09IEZpbHRlck1vZGUuTm9uZSkge1xuICAgICAgICAgICAgTUFHX0ZJTFRFUiA9IF9nbC5ORUFSRVNUO1xuICAgICAgICAgICAgaWYgKGdlbmVyYXRlTWlwbWFwICYmIGlzUE9UKSB7XG4gICAgICAgICAgICAgICAgTUlOX0ZJTFRFUiA9IF9nbC5MSU5FQVJfTUlQTUFQX05FQVJFU1Q7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIE1JTl9GSUxURVIgPSBfZ2wuTkVBUkVTVDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHsgLy9GaWx0ZXJNb2RlLkxpbmVhclxuICAgICAgICAgICAgTUFHX0ZJTFRFUiA9IF9nbC5MSU5FQVI7XG4gICAgICAgICAgICBpZiAoZ2VuZXJhdGVNaXBtYXAgJiYgaXNQT1QpIHtcbiAgICAgICAgICAgICAgICBNSU5fRklMVEVSID0gX2dsLkxJTkVBUl9NSVBNQVBfTElORUFSO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBNSU5fRklMVEVSID0gX2dsLkxJTkVBUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmb3JtYXQgPT09IFRleHR1cmVGb3JtYXQuUkdCKSB7XG4gICAgICAgICAgICBGT1JNQVQgPSBfZ2wuUkdCO1xuICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gVGV4dHVyZUZvcm1hdC5SR0JBKSB7XG4gICAgICAgICAgICBGT1JNQVQgPSBfZ2wuUkdCQTtcbiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09IFRleHR1cmVGb3JtYXQuTHVtaW5hbmNlQWxwaGEpIHtcbiAgICAgICAgICAgIEZPUk1BVCA9IF9nbC5MVU1JTkFOQ0VfQUxQSEE7XG4gICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSBUZXh0dXJlRm9ybWF0Lkx1bWluYW5jZSkge1xuICAgICAgICAgICAgRk9STUFUID0gX2dsLkxVTUlOQU5DRTtcbiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09IFRleHR1cmVGb3JtYXQuQWxwaGEpIHtcbiAgICAgICAgICAgIEZPUk1BVCA9IF9nbC5BTFBIQTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh3cmFwID09PSBUZXh0dXJlV3JhcC5DbGFtcCkge1xuICAgICAgICAgICAgV1JBUCA9IF9nbC5DTEFNUF9UT19FREdFO1xuICAgICAgICB9IGVsc2UgeyAvL1RleHR1cmVXcmFwLlJlcGVhdFxuICAgICAgICAgICAgV1JBUCA9IGlzUE9UID8gX2dsLlJFUEVBVCA6IF9nbC5DTEFNUF9UT19FREdFO1xuICAgICAgICB9XG5cbiAgICAgICAgX2dsLmFjdGl2ZVRleHR1cmUoX2dsLlRFWFRVUkUwICsgaW5kZXgpO1xuICAgICAgICBfZ2wuYmluZFRleHR1cmUoVEVYVFVSRV9DVUJFX01BUCwgZ2xUZXh0dXJlKTtcbiAgICAgICAgX2dsLnVuaWZvcm0xaShsb2NhdGlvbiwgaW5kZXgpO1xuXG4gICAgICAgIF9nbC5waXhlbFN0b3JlaShfZ2wuVU5QQUNLX0ZMSVBfWV9XRUJHTCwgY3ViZVRleHR1cmUuZmxpcFkgPyAxIDogMCk7XG4gICAgICAgIF9nbC5waXhlbFN0b3JlaShfZ2wuVU5QQUNLX1BSRU1VTFRJUExZX0FMUEhBX1dFQkdMLCBjdWJlVGV4dHVyZS5wcmVtdWx0aXBseUFscGhhID8gMSA6IDApO1xuXG4gICAgICAgIF9nbC50ZXhJbWFnZTJEKF9nbC5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1gsIDAsIEZPUk1BVCwgRk9STUFULCBVTlNJR05FRF9CWVRFLCBjbGFtcFRvTWF4U2l6ZShyYXdbMF0sIF9tYXhDdWJlVGV4dHVyZVNpemUpKTtcbiAgICAgICAgX2dsLnRleEltYWdlMkQoX2dsLlRFWFRVUkVfQ1VCRV9NQVBfTkVHQVRJVkVfWCwgMCwgRk9STUFULCBGT1JNQVQsIFVOU0lHTkVEX0JZVEUsIGNsYW1wVG9NYXhTaXplKHJhd1sxXSwgX21heEN1YmVUZXh0dXJlU2l6ZSkpO1xuICAgICAgICBfZ2wudGV4SW1hZ2UyRChfZ2wuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9ZLCAwLCBGT1JNQVQsIEZPUk1BVCwgVU5TSUdORURfQllURSwgY2xhbXBUb01heFNpemUocmF3WzJdLCBfbWF4Q3ViZVRleHR1cmVTaXplKSk7XG4gICAgICAgIF9nbC50ZXhJbWFnZTJEKF9nbC5URVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1ksIDAsIEZPUk1BVCwgRk9STUFULCBVTlNJR05FRF9CWVRFLCBjbGFtcFRvTWF4U2l6ZShyYXdbM10sIF9tYXhDdWJlVGV4dHVyZVNpemUpKTtcbiAgICAgICAgX2dsLnRleEltYWdlMkQoX2dsLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWiwgMCwgRk9STUFULCBGT1JNQVQsIFVOU0lHTkVEX0JZVEUsIGNsYW1wVG9NYXhTaXplKHJhd1s0XSwgX21heEN1YmVUZXh0dXJlU2l6ZSkpO1xuICAgICAgICBfZ2wudGV4SW1hZ2UyRChfZ2wuVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9aLCAwLCBGT1JNQVQsIEZPUk1BVCwgVU5TSUdORURfQllURSwgY2xhbXBUb01heFNpemUocmF3WzVdLCBfbWF4Q3ViZVRleHR1cmVTaXplKSk7XG5cbiAgICAgICAgX2dsLnRleFBhcmFtZXRlcmkoVEVYVFVSRV9DVUJFX01BUCwgX2dsLlRFWFRVUkVfTUFHX0ZJTFRFUiwgTUFHX0ZJTFRFUik7XG4gICAgICAgIF9nbC50ZXhQYXJhbWV0ZXJpKFRFWFRVUkVfQ1VCRV9NQVAsIF9nbC5URVhUVVJFX01JTl9GSUxURVIsIE1JTl9GSUxURVIpO1xuXG4gICAgICAgIF9nbC50ZXhQYXJhbWV0ZXJpKFRFWFRVUkVfQ1VCRV9NQVAsIF9nbC5URVhUVVJFX1dSQVBfUywgV1JBUCk7XG4gICAgICAgIF9nbC50ZXhQYXJhbWV0ZXJpKFRFWFRVUkVfQ1VCRV9NQVAsIF9nbC5URVhUVVJFX1dSQVBfVCwgV1JBUCk7XG5cbiAgICAgICAgaWYgKFRGQSkgX2dsLnRleFBhcmFtZXRlcmYoVEVYVFVSRV9DVUJFX01BUCwgVEZBLlRFWFRVUkVfTUFYX0FOSVNPVFJPUFlfRVhULCBhbmlzb3Ryb3B5KTtcbiAgICAgICAgaWYgKGdlbmVyYXRlTWlwbWFwICYmIGlzUE9UKSBfZ2wuZ2VuZXJhdGVNaXBtYXAoVEVYVFVSRV9DVUJFX01BUCk7XG5cbiAgICAgICAgY3ViZVRleHR1cmUubmVlZHNVcGRhdGUgPSBmYWxzZTtcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGNsYW1wVG9NYXhTaXplKGltYWdlLCBtYXhTaXplKSB7XG4gICAgICAgIGlmIChpbWFnZS5oZWlnaHQgPD0gbWF4U2l6ZSAmJiBpbWFnZS53aWR0aCA8PSBtYXhTaXplKSByZXR1cm4gaW1hZ2U7XG4gICAgICAgIHZhciBtYXhEaW0gPSAxIC8gbWF4KGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpLFxuICAgICAgICAgICAgbmV3V2lkdGggPSBmbG9vcihpbWFnZS53aWR0aCAqIG1heFNpemUgKiBtYXhEaW0pLFxuICAgICAgICAgICAgbmV3SGVpZ2h0ID0gZmxvb3IoaW1hZ2UuaGVpZ2h0ICogbWF4U2l6ZSAqIG1heERpbSksXG4gICAgICAgICAgICBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLFxuICAgICAgICAgICAgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblxuICAgICAgICBjYW52YXMud2lkdGggPSBuZXdXaWR0aDtcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IG5ld0hlaWdodDtcbiAgICAgICAgY3R4LmRyYXdJbWFnZShpbWFnZSwgMCwgMCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCwgMCwgMCwgbmV3V2lkdGgsIG5ld0hlaWdodCk7XG5cbiAgICAgICAgTG9nLm9uY2UoXCJSZW5kZXJlciBjbGFtcFRvTWF4U2l6ZTogaW1hZ2UgaGVpZ2h0IGxhcmdlciB0aGFuIG1hY2hpbmVzIG1heCBzaXplIChtYXggPSBcIiArIG1heFNpemUgKyBcIilcIik7XG5cbiAgICAgICAgcmV0dXJuIGNhbnZhcztcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIHNldFJlbmRlclRhcmdldChyZW5kZXJUYXJnZXQpIHtcbiAgICAgICAgdmFyIGlzUmVuZGVyVGFyZ2V0ID0gISFyZW5kZXJUYXJnZXQsXG4gICAgICAgICAgICBpc0N1YmUgPSByZW5kZXJUYXJnZXQgaW5zdGFuY2VvZiBSZW5kZXJUYXJnZXRDdWJlLFxuICAgICAgICAgICAgZnJhbWVidWZmZXIgPSBudWxsLFxuICAgICAgICAgICAgd2lkdGgsIGhlaWdodCwgdngsIHZ5O1xuXG4gICAgICAgIGlmIChpc1JlbmRlclRhcmdldCAmJiAhcmVuZGVyVGFyZ2V0Ll93ZWJnbEZyYW1lYnVmZmVyKSB7XG4gICAgICAgICAgICB3aWR0aCA9IHJlbmRlclRhcmdldC53aWR0aDtcbiAgICAgICAgICAgIGhlaWdodCA9IHJlbmRlclRhcmdldC5oZWlnaHQ7XG4gICAgICAgICAgICByZW5kZXJUYXJnZXQuX3dlYmdsID0gX2dsLmNyZWF0ZVRleHR1cmUoKTtcblxuICAgICAgICAgICAgdmFyIFRGQSA9IF9leHRlbnNpb25zLkVYVF90ZXh0dXJlX2ZpbHRlcl9hbmlzb3Ryb3BpYyxcbiAgICAgICAgICAgICAgICBpc1BPVCA9IGlzUG93ZXJPZlR3byh3aWR0aCkgJiYgaXNQb3dlck9mVHdvKGhlaWdodCksXG4gICAgICAgICAgICAgICAgYW5pc290cm9weSA9IGNsYW1wKHJlbmRlclRhcmdldC5hbmlzb3Ryb3B5IHx8IDEsIDEsIF9tYXhBbmlzb3Ryb3B5KSxcblxuICAgICAgICAgICAgICAgIEdMX1RFWFRVUkVfVFlQRSA9IGlzQ3ViZSA/IF9nbC5URVhUVVJFX0NVQkVfTUFQIDogX2dsLlRFWFRVUkVfMkQsXG4gICAgICAgICAgICAgICAgVU5TSUdORURfQllURSA9IF9nbC5VTlNJR05FRF9CWVRFLFxuICAgICAgICAgICAgICAgIFVOU0lHTkVEX1NIT1JUID0gX2dsLlVOU0lHTkVEX1NIT1JULFxuICAgICAgICAgICAgICAgIERFUFRIX0NPTVBPTkVOVCA9IF9nbC5ERVBUSF9DT01QT05FTlQsXG5cbiAgICAgICAgICAgICAgICBnZW5lcmF0ZU1pcG1hcCA9IHJlbmRlclRhcmdldC5nZW5lcmF0ZU1pcG1hcCxcbiAgICAgICAgICAgICAgICBmaWx0ZXIgPSByZW5kZXJUYXJnZXQuZmlsdGVyLFxuICAgICAgICAgICAgICAgIGZvcm1hdCA9IHJlbmRlclRhcmdldC5mb3JtYXQsXG4gICAgICAgICAgICAgICAgd3JhcCA9IHJlbmRlclRhcmdldC53cmFwLFxuICAgICAgICAgICAgICAgIFdSQVAsIE1BR19GSUxURVIsIE1JTl9GSUxURVIsIEZPUk1BVCxcbiAgICAgICAgICAgICAgICB3ZWJnbEZyYW1lYnVmZmVyLCB3ZWJnbFJlbmRlcmJ1ZmZlciwgZGVwdGhPbmx5ID0gcmVuZGVyVGFyZ2V0LmRlcHRoT25seSxcbiAgICAgICAgICAgICAgICBpO1xuXG4gICAgICAgICAgICBpZiAoZmlsdGVyID09PSBGaWx0ZXJNb2RlLk5vbmUpIHtcbiAgICAgICAgICAgICAgICBNQUdfRklMVEVSID0gX2dsLk5FQVJFU1Q7XG4gICAgICAgICAgICAgICAgaWYgKGdlbmVyYXRlTWlwbWFwICYmIGlzUE9UKSB7XG4gICAgICAgICAgICAgICAgICAgIE1JTl9GSUxURVIgPSBfZ2wuTElORUFSX01JUE1BUF9ORUFSRVNUO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIE1JTl9GSUxURVIgPSBfZ2wuTkVBUkVTVDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgeyAvL0ZpbHRlck1vZGUuTGluZWFyXG4gICAgICAgICAgICAgICAgTUFHX0ZJTFRFUiA9IF9nbC5MSU5FQVI7XG4gICAgICAgICAgICAgICAgaWYgKGdlbmVyYXRlTWlwbWFwICYmIGlzUE9UKSB7XG4gICAgICAgICAgICAgICAgICAgIE1JTl9GSUxURVIgPSBfZ2wuTElORUFSX01JUE1BUF9MSU5FQVI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgTUlOX0ZJTFRFUiA9IF9nbC5MSU5FQVI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZm9ybWF0ID09PSBUZXh0dXJlRm9ybWF0LlJHQikge1xuICAgICAgICAgICAgICAgIEZPUk1BVCA9IF9nbC5SR0I7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gVGV4dHVyZUZvcm1hdC5SR0JBKSB7XG4gICAgICAgICAgICAgICAgRk9STUFUID0gX2dsLlJHQkE7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gVGV4dHVyZUZvcm1hdC5MdW1pbmFuY2VBbHBoYSkge1xuICAgICAgICAgICAgICAgIEZPUk1BVCA9IF9nbC5MVU1JTkFOQ0VfQUxQSEE7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gVGV4dHVyZUZvcm1hdC5MdW1pbmFuY2UpIHtcbiAgICAgICAgICAgICAgICBGT1JNQVQgPSBfZ2wuTFVNSU5BTkNFO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09IFRleHR1cmVGb3JtYXQuQWxwaGEpIHtcbiAgICAgICAgICAgICAgICBGT1JNQVQgPSBfZ2wuQUxQSEE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh3cmFwID09PSBUZXh0dXJlV3JhcC5DbGFtcCkge1xuICAgICAgICAgICAgICAgIFdSQVAgPSBfZ2wuQ0xBTVBfVE9fRURHRTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAod3JhcCA9PT0gVGV4dHVyZVdyYXAuTWlycm9yUmVwZWF0KSB7XG4gICAgICAgICAgICAgICAgV1JBUCA9IGlzUE9UID8gX2dsLk1JUlJPUkVEX1JFUEVBVCA6IF9nbC5DTEFNUF9UT19FREdFO1xuICAgICAgICAgICAgfSBlbHNlIHsgLy9UZXh0dXJlV3JhcC5SZXBlYXRcbiAgICAgICAgICAgICAgICBXUkFQID0gaXNQT1QgPyBfZ2wuUkVQRUFUIDogX2dsLkNMQU1QX1RPX0VER0U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9nbC5iaW5kVGV4dHVyZShHTF9URVhUVVJFX1RZUEUsIHJlbmRlclRhcmdldC5fd2ViZ2wpO1xuXG4gICAgICAgICAgICBfZ2wucGl4ZWxTdG9yZWkoX2dsLlVOUEFDS19GTElQX1lfV0VCR0wsIHJlbmRlclRhcmdldC5mbGlwWSA/IDEgOiAwKTtcbiAgICAgICAgICAgIF9nbC5waXhlbFN0b3JlaShfZ2wuVU5QQUNLX1BSRU1VTFRJUExZX0FMUEhBX1dFQkdMLCByZW5kZXJUYXJnZXQucHJlbXVsdGlwbHlBbHBoYSA/IDEgOiAwKTtcblxuICAgICAgICAgICAgaWYgKGlzQ3ViZSkge1xuICAgICAgICAgICAgICAgIHdlYmdsRnJhbWVidWZmZXIgPSByZW5kZXJUYXJnZXQuX3dlYmdsRnJhbWVidWZmZXIgPSBbXTtcbiAgICAgICAgICAgICAgICB3ZWJnbFJlbmRlcmJ1ZmZlciA9IHJlbmRlclRhcmdldC5fd2ViZ2xSZW5kZXJidWZmZXIgPSBbXTtcblxuICAgICAgICAgICAgICAgIGlmIChyZW5kZXJUYXJnZXQuZGVwdGhPbmx5KSB7XG4gICAgICAgICAgICAgICAgICAgIF9nbC50ZXhJbWFnZTJEKF9nbC5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1gsIDAsIERFUFRIX0NPTVBPTkVOVCwgd2lkdGgsIGhlaWdodCwgMCwgREVQVEhfQ09NUE9ORU5ULCBVTlNJR05FRF9CWVRFLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgX2dsLnRleEltYWdlMkQoX2dsLlRFWFRVUkVfQ1VCRV9NQVBfTkVHQVRJVkVfWCwgMCwgREVQVEhfQ09NUE9ORU5ULCB3aWR0aCwgaGVpZ2h0LCAwLCBERVBUSF9DT01QT05FTlQsIFVOU0lHTkVEX0JZVEUsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICBfZ2wudGV4SW1hZ2UyRChfZ2wuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9ZLCAwLCBERVBUSF9DT01QT05FTlQsIHdpZHRoLCBoZWlnaHQsIDAsIERFUFRIX0NPTVBPTkVOVCwgVU5TSUdORURfQllURSwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIF9nbC50ZXhJbWFnZTJEKF9nbC5URVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1ksIDAsIERFUFRIX0NPTVBPTkVOVCwgd2lkdGgsIGhlaWdodCwgMCwgREVQVEhfQ09NUE9ORU5ULCBVTlNJR05FRF9CWVRFLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgX2dsLnRleEltYWdlMkQoX2dsLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWiwgMCwgREVQVEhfQ09NUE9ORU5ULCB3aWR0aCwgaGVpZ2h0LCAwLCBERVBUSF9DT01QT05FTlQsIFVOU0lHTkVEX0JZVEUsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICBfZ2wudGV4SW1hZ2UyRChfZ2wuVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9aLCAwLCBERVBUSF9DT01QT05FTlQsIHdpZHRoLCBoZWlnaHQsIDAsIERFUFRIX0NPTVBPTkVOVCwgVU5TSUdORURfQllURSwgbnVsbCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX2dsLnRleEltYWdlMkQoX2dsLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWCwgMCwgRk9STUFULCB3aWR0aCwgaGVpZ2h0LCAwLCBGT1JNQVQsIFVOU0lHTkVEX0JZVEUsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICBfZ2wudGV4SW1hZ2UyRChfZ2wuVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9YLCAwLCBGT1JNQVQsIHdpZHRoLCBoZWlnaHQsIDAsIEZPUk1BVCwgVU5TSUdORURfQllURSwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIF9nbC50ZXhJbWFnZTJEKF9nbC5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1ksIDAsIEZPUk1BVCwgd2lkdGgsIGhlaWdodCwgMCwgRk9STUFULCBVTlNJR05FRF9CWVRFLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgX2dsLnRleEltYWdlMkQoX2dsLlRFWFRVUkVfQ1VCRV9NQVBfTkVHQVRJVkVfWSwgMCwgRk9STUFULCB3aWR0aCwgaGVpZ2h0LCAwLCBGT1JNQVQsIFVOU0lHTkVEX0JZVEUsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICBfZ2wudGV4SW1hZ2UyRChfZ2wuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9aLCAwLCBGT1JNQVQsIHdpZHRoLCBoZWlnaHQsIDAsIEZPUk1BVCwgVU5TSUdORURfQllURSwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIF9nbC50ZXhJbWFnZTJEKF9nbC5URVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1osIDAsIEZPUk1BVCwgd2lkdGgsIGhlaWdodCwgMCwgRk9STUFULCBVTlNJR05FRF9CWVRFLCBudWxsKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfZ2wudGV4UGFyYW1ldGVyaShHTF9URVhUVVJFX1RZUEUsIF9nbC5URVhUVVJFX01BR19GSUxURVIsIE1BR19GSUxURVIpO1xuICAgICAgICAgICAgICAgIF9nbC50ZXhQYXJhbWV0ZXJpKEdMX1RFWFRVUkVfVFlQRSwgX2dsLlRFWFRVUkVfTUlOX0ZJTFRFUiwgTUlOX0ZJTFRFUik7XG5cbiAgICAgICAgICAgICAgICBfZ2wudGV4UGFyYW1ldGVyaShHTF9URVhUVVJFX1RZUEUsIF9nbC5URVhUVVJFX1dSQVBfUywgV1JBUCk7XG4gICAgICAgICAgICAgICAgX2dsLnRleFBhcmFtZXRlcmkoR0xfVEVYVFVSRV9UWVBFLCBfZ2wuVEVYVFVSRV9XUkFQX1QsIFdSQVApO1xuXG4gICAgICAgICAgICAgICAgaSA9IDY7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgICAgICB3ZWJnbEZyYW1lYnVmZmVyW2ldID0gX2dsLmNyZWF0ZUZyYW1lYnVmZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIHdlYmdsUmVuZGVyYnVmZmVyW2ldID0gX2dsLmNyZWF0ZVJlbmRlcmJ1ZmZlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgIHNldHVwRnJhbWVCdWZmZXIod2ViZ2xGcmFtZWJ1ZmZlcltpXSwgcmVuZGVyVGFyZ2V0LCBfZ2wuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YICsgaSk7XG4gICAgICAgICAgICAgICAgICAgIHNldHVwUmVuZGVyQnVmZmVyKHdlYmdsUmVuZGVyYnVmZmVyW2ldLCByZW5kZXJUYXJnZXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVuZGVyVGFyZ2V0Ll93ZWJnbEZyYW1lYnVmZmVyID0gX2dsLmNyZWF0ZUZyYW1lYnVmZmVyKCk7XG4gICAgICAgICAgICAgICAgcmVuZGVyVGFyZ2V0Ll93ZWJnbFJlbmRlcmJ1ZmZlciA9IF9nbC5jcmVhdGVSZW5kZXJidWZmZXIoKTtcblxuICAgICAgICAgICAgICAgIGlmIChyZW5kZXJUYXJnZXQuZGVwdGhPbmx5KSB7XG4gICAgICAgICAgICAgICAgICAgIF9nbC50ZXhJbWFnZTJEKEdMX1RFWFRVUkVfVFlQRSwgMCwgREVQVEhfQ09NUE9ORU5ULCB3aWR0aCwgaGVpZ2h0LCAwLCBERVBUSF9DT01QT05FTlQsIFVOU0lHTkVEX1NIT1JULCBudWxsKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfZ2wudGV4SW1hZ2UyRChHTF9URVhUVVJFX1RZUEUsIDAsIEZPUk1BVCwgd2lkdGgsIGhlaWdodCwgMCwgRk9STUFULCBVTlNJR05FRF9CWVRFLCBudWxsKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfZ2wudGV4UGFyYW1ldGVyaShHTF9URVhUVVJFX1RZUEUsIF9nbC5URVhUVVJFX01BR19GSUxURVIsIE1BR19GSUxURVIpO1xuICAgICAgICAgICAgICAgIF9nbC50ZXhQYXJhbWV0ZXJpKEdMX1RFWFRVUkVfVFlQRSwgX2dsLlRFWFRVUkVfTUlOX0ZJTFRFUiwgTUlOX0ZJTFRFUik7XG5cbiAgICAgICAgICAgICAgICBfZ2wudGV4UGFyYW1ldGVyaShHTF9URVhUVVJFX1RZUEUsIF9nbC5URVhUVVJFX1dSQVBfUywgV1JBUCk7XG4gICAgICAgICAgICAgICAgX2dsLnRleFBhcmFtZXRlcmkoR0xfVEVYVFVSRV9UWVBFLCBfZ2wuVEVYVFVSRV9XUkFQX1QsIFdSQVApO1xuXG4gICAgICAgICAgICAgICAgc2V0dXBGcmFtZUJ1ZmZlcihyZW5kZXJUYXJnZXQuX3dlYmdsRnJhbWVidWZmZXIsIHJlbmRlclRhcmdldCwgR0xfVEVYVFVSRV9UWVBFKTtcbiAgICAgICAgICAgICAgICBzZXR1cFJlbmRlckJ1ZmZlcihyZW5kZXJUYXJnZXQuX3dlYmdsUmVuZGVyYnVmZmVyLCByZW5kZXJUYXJnZXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoVEZBKSBfZ2wudGV4UGFyYW1ldGVyZihHTF9URVhUVVJFX1RZUEUsIFRGQS5URVhUVVJFX01BWF9BTklTT1RST1BZX0VYVCwgYW5pc290cm9weSk7XG4gICAgICAgICAgICBpZiAoZ2VuZXJhdGVNaXBtYXAgJiYgaXNQT1QpIF9nbC5nZW5lcmF0ZU1pcG1hcChHTF9URVhUVVJFX1RZUEUpO1xuXG4gICAgICAgICAgICBfZ2wuYmluZFRleHR1cmUoR0xfVEVYVFVSRV9UWVBFLCBudWxsKTtcblxuICAgICAgICAgICAgX2dsLmJpbmRSZW5kZXJidWZmZXIoX2dsLlJFTkRFUkJVRkZFUiwgbnVsbCk7XG4gICAgICAgICAgICBfZ2wuYmluZEZyYW1lYnVmZmVyKF9nbC5GUkFNRUJVRkZFUiwgbnVsbCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNSZW5kZXJUYXJnZXQpIHtcbiAgICAgICAgICAgIGlmIChpc0N1YmUpIHtcbiAgICAgICAgICAgICAgICBmcmFtZWJ1ZmZlciA9IHJlbmRlclRhcmdldC5fd2ViZ2xGcmFtZWJ1ZmZlcltyZW5kZXJUYXJnZXQuYWN0aXZlQ3ViZUZhY2VdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmcmFtZWJ1ZmZlciA9IHJlbmRlclRhcmdldC5fd2ViZ2xGcmFtZWJ1ZmZlcjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdnggPSAwO1xuICAgICAgICAgICAgdnkgPSAwO1xuICAgICAgICAgICAgd2lkdGggPSByZW5kZXJUYXJnZXQud2lkdGg7XG4gICAgICAgICAgICBoZWlnaHQgPSByZW5kZXJUYXJnZXQuaGVpZ2h0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdnggPSBfdmlld3BvcnRYO1xuICAgICAgICAgICAgdnkgPSBfdmlld3BvcnRZO1xuICAgICAgICAgICAgd2lkdGggPSBfdmlld3BvcnRXaWR0aDtcbiAgICAgICAgICAgIGhlaWdodCA9IF92aWV3cG9ydEhlaWdodDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmcmFtZWJ1ZmZlciAhPT0gX2N1cnJlbnRGcmFtZWJ1ZmZlcikge1xuICAgICAgICAgICAgX2dsLmJpbmRGcmFtZWJ1ZmZlcihfZ2wuRlJBTUVCVUZGRVIsIGZyYW1lYnVmZmVyKTtcbiAgICAgICAgICAgIHNldFZpZXdwb3J0KHZ4LCB2eSwgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgICAgIF9jdXJyZW50RnJhbWVidWZmZXIgPSBmcmFtZWJ1ZmZlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIF9jdXJyZW50V2lkdGggPSB3aWR0aDtcbiAgICAgICAgX2N1cnJlbnRIZWlnaHQgPSBoZWlnaHQ7XG4gICAgfVxuXG4gICAgdGhpcy5zZXRSZW5kZXJUYXJnZXQgPSBzZXRSZW5kZXJUYXJnZXQ7XG5cblxuICAgIGZ1bmN0aW9uIHNldHVwRnJhbWVCdWZmZXIoZnJhbWVidWZmZXIsIHJlbmRlclRhcmdldCwgdGV4dHVyZVRhcmdldCkge1xuICAgICAgICBfZ2wuYmluZEZyYW1lYnVmZmVyKF9nbC5GUkFNRUJVRkZFUiwgZnJhbWVidWZmZXIpO1xuICAgICAgICBfZ2wuZnJhbWVidWZmZXJUZXh0dXJlMkQoX2dsLkZSQU1FQlVGRkVSLCBfZ2wuQ09MT1JfQVRUQUNITUVOVDAsIHRleHR1cmVUYXJnZXQsIHJlbmRlclRhcmdldC5fd2ViZ2wsIDApO1xuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gc2V0dXBSZW5kZXJCdWZmZXIocmVuZGVyYnVmZmVyLCByZW5kZXJUYXJnZXQpIHtcblxuICAgICAgICBfZ2wuYmluZFJlbmRlcmJ1ZmZlcihfZ2wuUkVOREVSQlVGRkVSLCByZW5kZXJidWZmZXIpO1xuXG4gICAgICAgIGlmIChyZW5kZXJUYXJnZXQuZGVwdGhCdWZmZXIgJiYgIXJlbmRlclRhcmdldC5zdGVuY2lsQnVmZmVyKSB7XG5cbiAgICAgICAgICAgIF9nbC5yZW5kZXJidWZmZXJTdG9yYWdlKF9nbC5SRU5ERVJCVUZGRVIsIF9nbC5ERVBUSF9DT01QT05FTlQxNiwgcmVuZGVyVGFyZ2V0LndpZHRoLCByZW5kZXJUYXJnZXQuaGVpZ2h0KTtcbiAgICAgICAgICAgIF9nbC5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcihfZ2wuRlJBTUVCVUZGRVIsIF9nbC5ERVBUSF9BVFRBQ0hNRU5ULCBfZ2wuUkVOREVSQlVGRkVSLCByZW5kZXJidWZmZXIpO1xuICAgICAgICB9IGVsc2UgaWYgKCFyZW5kZXJUYXJnZXQuZGVwdGhCdWZmZXIgJiYgcmVuZGVyVGFyZ2V0LnN0ZW5jaWxCdWZmZXIpIHtcblxuICAgICAgICAgICAgX2dsLnJlbmRlcmJ1ZmZlclN0b3JhZ2UoX2dsLlJFTkRFUkJVRkZFUiwgX2dsLlNURU5DSUxfSU5ERVg4LCByZW5kZXJUYXJnZXQud2lkdGgsIHJlbmRlclRhcmdldC5oZWlnaHQpO1xuICAgICAgICAgICAgX2dsLmZyYW1lYnVmZmVyUmVuZGVyYnVmZmVyKF9nbC5GUkFNRUJVRkZFUiwgX2dsLlNURU5DSUxfQVRUQUNITUVOVCwgX2dsLlJFTkRFUkJVRkZFUiwgcmVuZGVyYnVmZmVyKTtcbiAgICAgICAgfSBlbHNlIGlmIChyZW5kZXJUYXJnZXQuZGVwdGhCdWZmZXIgJiYgcmVuZGVyVGFyZ2V0LnN0ZW5jaWxCdWZmZXIpIHtcblxuICAgICAgICAgICAgX2dsLnJlbmRlcmJ1ZmZlclN0b3JhZ2UoX2dsLlJFTkRFUkJVRkZFUiwgX2dsLkRFUFRIX1NURU5DSUwsIHJlbmRlclRhcmdldC53aWR0aCwgcmVuZGVyVGFyZ2V0LmhlaWdodCk7XG4gICAgICAgICAgICBfZ2wuZnJhbWVidWZmZXJSZW5kZXJidWZmZXIoX2dsLkZSQU1FQlVGRkVSLCBfZ2wuREVQVEhfU1RFTkNJTF9BVFRBQ0hNRU5ULCBfZ2wuUkVOREVSQlVGRkVSLCByZW5kZXJidWZmZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX2dsLnJlbmRlcmJ1ZmZlclN0b3JhZ2UoX2dsLlJFTkRFUkJVRkZFUiwgX2dsLlJHQkE0LCByZW5kZXJUYXJnZXQud2lkdGgsIHJlbmRlclRhcmdldC5oZWlnaHQpO1xuICAgICAgICB9XG4gICAgfTtcblxuXG4gICAgZnVuY3Rpb24gaGFuZGxlV2ViR0xDb250ZXh0TG9zdChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgTG9nLndhcm4oXCJSZW5kZXJlcjogd2ViZ2wgY29udGV4dCB3YXMgbG9zdFwiKTtcblxuICAgICAgICBfY29udGV4dCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmVtaXQoXCJ3ZWJnbGNvbnRleHRsb3N0XCIsIGUpO1xuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gaGFuZGxlV2ViR0xDb250ZXh0UmVzdG9yZWQoZSkge1xuICAgICAgICBMb2cubG9nKFwiUmVuZGVyZXI6IHdlYmdsIGNvbnRleHQgd2FzIHJlc3RvcmVkXCIpO1xuXG4gICAgICAgIGluaXRHTCgpO1xuICAgICAgICBzZXREZWZhdWx0R0xTdGF0ZSgpO1xuXG4gICAgICAgIF9jb250ZXh0ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lbWl0KFwid2ViZ2xjb250ZXh0cmVzdG9yZWRcIiwgZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0R1BVSW5mbygpIHtcbiAgICAgICAgdmFyIFZFUlRFWF9TSEFERVIgPSBfZ2wuVkVSVEVYX1NIQURFUixcbiAgICAgICAgICAgIEZSQUdNRU5UX1NIQURFUiA9IF9nbC5GUkFHTUVOVF9TSEFERVIsXG4gICAgICAgICAgICBISUdIX0ZMT0FUID0gX2dsLkhJR0hfRkxPQVQsXG4gICAgICAgICAgICBNRURJVU1fRkxPQVQgPSBfZ2wuTUVESVVNX0ZMT0FULFxuXG4gICAgICAgICAgICBFWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWMgPSBfZXh0ZW5zaW9ucy5FWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWMsXG5cbiAgICAgICAgICAgIHZzSGlnaHBGbG9hdCA9IF9nbC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQoVkVSVEVYX1NIQURFUiwgSElHSF9GTE9BVCksXG4gICAgICAgICAgICB2c01lZGl1bXBGbG9hdCA9IF9nbC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQoVkVSVEVYX1NIQURFUiwgTUVESVVNX0ZMT0FUKSxcblxuICAgICAgICAgICAgZnNIaWdocEZsb2F0ID0gX2dsLmdldFNoYWRlclByZWNpc2lvbkZvcm1hdChGUkFHTUVOVF9TSEFERVIsIEhJR0hfRkxPQVQpLFxuICAgICAgICAgICAgZnNNZWRpdW1wRmxvYXQgPSBfZ2wuZ2V0U2hhZGVyUHJlY2lzaW9uRm9ybWF0KEZSQUdNRU5UX1NIQURFUiwgTUVESVVNX0ZMT0FUKSxcblxuICAgICAgICAgICAgaGlnaHBBdmFpbGFibGUgPSB2c0hpZ2hwRmxvYXQucHJlY2lzaW9uID4gMCAmJiBmc0hpZ2hwRmxvYXQucHJlY2lzaW9uID4gMCxcbiAgICAgICAgICAgIG1lZGl1bXBBdmFpbGFibGUgPSB2c01lZGl1bXBGbG9hdC5wcmVjaXNpb24gPiAwICYmIGZzTWVkaXVtcEZsb2F0LnByZWNpc2lvbiA+IDAsXG5cbiAgICAgICAgICAgIHByZWNpc2lvbiA9IFwiaGlnaHBcIjtcblxuICAgICAgICBpZiAoIWhpZ2hwQXZhaWxhYmxlIHx8IERldmljZS5tb2JpbGUpIHtcbiAgICAgICAgICAgIGlmIChtZWRpdW1wQXZhaWxhYmxlKSB7XG4gICAgICAgICAgICAgICAgcHJlY2lzaW9uID0gXCJtZWRpdW1wXCI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHByZWNpc2lvbiA9IFwibG93cFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgX3ByZWNpc2lvbiA9IHByZWNpc2lvbjtcbiAgICAgICAgX21heEFuaXNvdHJvcHkgPSBFWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWMgPyBfZ2wuZ2V0UGFyYW1ldGVyKEVYVF90ZXh0dXJlX2ZpbHRlcl9hbmlzb3Ryb3BpYy5NQVhfVEVYVFVSRV9NQVhfQU5JU09UUk9QWV9FWFQpIDogMTtcbiAgICAgICAgX21heFRleHR1cmVzID0gX2dsLmdldFBhcmFtZXRlcihfZ2wuTUFYX1RFWFRVUkVfSU1BR0VfVU5JVFMpO1xuICAgICAgICBfbWF4VmVydGV4VGV4dHVyZXMgPSBfZ2wuZ2V0UGFyYW1ldGVyKF9nbC5NQVhfVkVSVEVYX1RFWFRVUkVfSU1BR0VfVU5JVFMpO1xuICAgICAgICBfbWF4VGV4dHVyZVNpemUgPSBfZ2wuZ2V0UGFyYW1ldGVyKF9nbC5NQVhfVEVYVFVSRV9TSVpFKTtcbiAgICAgICAgX21heEN1YmVUZXh0dXJlU2l6ZSA9IF9nbC5nZXRQYXJhbWV0ZXIoX2dsLk1BWF9DVUJFX01BUF9URVhUVVJFX1NJWkUpO1xuICAgICAgICBfbWF4UmVuZGVyQnVmZmVyU2l6ZSA9IF9nbC5nZXRQYXJhbWV0ZXIoX2dsLk1BWF9SRU5ERVJCVUZGRVJfU0laRSk7XG5cbiAgICAgICAgX21heFVuaWZvcm1zID0gbWF4KF9nbC5nZXRQYXJhbWV0ZXIoX2dsLk1BWF9GUkFHTUVOVF9VTklGT1JNX1ZFQ1RPUlMpLCBfZ2wuZ2V0UGFyYW1ldGVyKF9nbC5NQVhfVkVSVEVYX1VOSUZPUk1fVkVDVE9SUykpICogNDtcbiAgICAgICAgX21heFZhcnlpbmdzID0gX2dsLmdldFBhcmFtZXRlcihfZ2wuTUFYX1ZBUllJTkdfVkVDVE9SUykgKiA0O1xuICAgICAgICBfbWF4QXR0cmlidXRlcyA9IF9nbC5nZXRQYXJhbWV0ZXIoX2dsLk1BWF9WRVJURVhfQVRUUklCUyk7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBnZXRFeHRlbnNpb25zKCkge1xuICAgICAgICBfZXh0ZW5zaW9ucyA9IHt9O1xuXG4gICAgICAgIGdldEV4dGVuc2lvbihcIkVYVF90ZXh0dXJlX2ZpbHRlcl9hbmlzb3Ryb3BpY1wiKTtcblxuICAgICAgICBnZXRFeHRlbnNpb24oXCJXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfczN0Y1wiKTtcbiAgICAgICAgX2V4dGVuc2lvbnMuV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3MzdGNfZm9ybWF0cyA9IF9leHRlbnNpb25zLldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9zM3RjID8gX2dsLmdldFBhcmFtZXRlcihfZ2wuQ09NUFJFU1NFRF9URVhUVVJFX0ZPUk1BVFMpIDogbnVsbDtcblxuICAgICAgICBnZXRFeHRlbnNpb24oXCJPRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXNcIik7XG4gICAgfVxuXG5cbiAgICB2YXIgZ2V0RXh0ZW5zaW9uX3ByZWZpeGVzID0gW1wiV0VCS0lUXCIsIFwiTU9aXCIsIFwiT1wiLCBcIk1TXCIsIFwid2Via2l0XCIsIFwibW96XCIsIFwib1wiLCBcIm1zXCJdLFxuICAgICAgICBnZXRFeHRlbnNpb25fbGVuZ3RoID0gZ2V0RXh0ZW5zaW9uX3ByZWZpeGVzLmxlbmd0aDtcblxuICAgIGZ1bmN0aW9uIGdldEV4dGVuc2lvbihuYW1lKSB7XG4gICAgICAgIHZhciBleHRlbnNpb24gPSBfZXh0ZW5zaW9uc1tuYW1lXSB8fCAoX2V4dGVuc2lvbnNbbmFtZV0gPSBfZ2wuZ2V0RXh0ZW5zaW9uKG5hbWUpKTtcblxuICAgICAgICBpZiAoZXh0ZW5zaW9uID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGkgPSBnZXRFeHRlbnNpb25fbGVuZ3RoO1xuXG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgaWYgKChleHRlbnNpb24gPSBfZ2wuZ2V0RXh0ZW5zaW9uKGdldEV4dGVuc2lvbl9wcmVmaXhlc1tpXSArIFwiX1wiICsgbmFtZSkpKSByZXR1cm4gKF9leHRlbnNpb25zW25hbWVdID0gZXh0ZW5zaW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBleHRlbnNpb247XG4gICAgfVxuXG4gICAgdGhpcy5nZXRFeHRlbnNpb24gPSBnZXRFeHRlbnNpb247XG5cblxuICAgIGZ1bmN0aW9uIGluaXRHTCgpIHtcbiAgICAgICAgX2dsID0gZ2V0V2ViR0xDb250ZXh0KF9lbGVtZW50LCBfYXR0cmlidXRlcyk7XG5cbiAgICAgICAgX2dsLmdldFNoYWRlclByZWNpc2lvbkZvcm1hdCB8fCAoX2dsLmdldFNoYWRlclByZWNpc2lvbkZvcm1hdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmFuZ2VNaW46IDEsXG4gICAgICAgICAgICAgICAgcmFuZ2VNYXg6IDEsXG4gICAgICAgICAgICAgICAgcHJlY2lzaW9uOiAxXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICBnZXRFeHRlbnNpb25zKCk7XG4gICAgICAgIGdldEdQVUluZm8oKTtcblxuICAgICAgICBfZW5hYmxlZEF0dHJpYnV0ZXMgPSBuZXcgVWludDhBcnJheShfbWF4QXR0cmlidXRlcyk7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBzZXREZWZhdWx0R0xTdGF0ZSgpIHtcblxuICAgICAgICBfZ2wuY2xlYXJDb2xvcigwLCAwLCAwLCAxKTtcbiAgICAgICAgdXNlRGVwdGggJiYgX2dsLmNsZWFyRGVwdGgoMSk7XG4gICAgICAgIF9nbC5jbGVhclN0ZW5jaWwoMCk7XG5cbiAgICAgICAgdXNlRGVwdGggJiYgc2V0RGVwdGhUZXN0KHRydWUpO1xuICAgICAgICB1c2VEZXB0aCAmJiBfZ2wuZGVwdGhGdW5jKF9nbC5MRVFVQUwpO1xuXG4gICAgICAgIF9nbC5mcm9udEZhY2UoX2dsLkNDVyk7XG5cbiAgICAgICAgc2V0Q3VsbEZhY2UoQ3VsbEZhY2UuQmFjayk7XG4gICAgICAgIHNldEJsZW5kaW5nKEJsZW5kaW5nLkRlZmF1bHQpO1xuICAgICAgICBzZXRMaW5lV2lkdGgoMSk7XG5cbiAgICAgICAgc2V0Vmlld3BvcnQoKTtcbiAgICB9XG5cblxuICAgIHZhciBTSEFERVJfU1BMSVRFUiA9IC9bXFxuO10rLyxcbiAgICAgICAgQVRUUklCVVJFID0gL2F0dHJpYnV0ZVxccysoW2Etel0rXFxzKyk/KFtBLVphLXowLTldKylcXHMrKFthLXpBLVpfMC05XSspXFxzKihcXFtcXHMqKC4rKVxccypcXF0pPy8sXG4gICAgICAgIFVOSUZPUk0gPSAvdW5pZm9ybVxccysoW2Etel0rXFxzKyk/KFtBLVphLXowLTldKylcXHMrKFthLXpBLVpfMC05XSspXFxzKihcXFtcXHMqKC4rKVxccypcXF0pPy8sXG4gICAgICAgIERFRklORSA9IC8jZGVmaW5lXFxzKyhbYS16QS1aXzAtOV0rKT9cXHMrKFswLTldKyk/LztcblxuICAgIGZ1bmN0aW9uIHBhcnNlVW5pZm9ybXNBdHRyaWJ1dGVzQXJyYXlzKHZlcnRleFNoYWRlciwgZnJhZ21lbnRTaGFkZXIsIGF0dHJpYnV0ZXMsIHVuaWZvcm1zKSB7XG4gICAgICAgIHZhciBzcmMgPSB2ZXJ0ZXhTaGFkZXIgKyBmcmFnbWVudFNoYWRlcixcbiAgICAgICAgICAgIGxpbmVzID0gc3JjLnNwbGl0KFNIQURFUl9TUExJVEVSKSxcbiAgICAgICAgICAgIG1hdGNoQXR0cmlidXRlcywgbWF0Y2hVbmlmb3JtcyxcbiAgICAgICAgICAgIGkgPSBsaW5lcy5sZW5ndGgsXG4gICAgICAgICAgICBsaW5lO1xuXG4gICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgIGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgICAgICAgIG1hdGNoQXR0cmlidXRlcyA9IGxpbmUubWF0Y2goQVRUUklCVVJFKTtcbiAgICAgICAgICAgIG1hdGNoVW5pZm9ybXMgPSBsaW5lLm1hdGNoKFVOSUZPUk0pO1xuXG4gICAgICAgICAgICBpZiAobWF0Y2hBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5wdXNoKG1hdGNoQXR0cmlidXRlc1szXSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoVW5pZm9ybXMpIHtcbiAgICAgICAgICAgICAgICB1bmlmb3Jtcy5wdXNoKG1hdGNoVW5pZm9ybXNbM10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5wYXJzZVVuaWZvcm1zQXR0cmlidXRlc0FycmF5cyA9IHBhcnNlVW5pZm9ybXNBdHRyaWJ1dGVzQXJyYXlzO1xuXG4gICAgZnVuY3Rpb24gcGFyc2VVbmlmb3Jtc0F0dHJpYnV0ZXMocHJvZ3JhbSwgdmVydGV4U2hhZGVyLCBmcmFnbWVudFNoYWRlciwgYXR0cmlidXRlcywgdW5pZm9ybXMpIHtcbiAgICAgICAgdmFyIHNyYyA9IHZlcnRleFNoYWRlciArIGZyYWdtZW50U2hhZGVyLFxuICAgICAgICAgICAgbGluZXMgPSBzcmMuc3BsaXQoU0hBREVSX1NQTElURVIpLFxuICAgICAgICAgICAgZGVmaW5lcyA9IHt9LCBtYXRjaEF0dHJpYnV0ZXMsIG1hdGNoVW5pZm9ybXMsIG1hdGNoRGVmaW5lcyxcbiAgICAgICAgICAgIHVuaWZvcm1BcnJheSwgbmFtZSwgdHlwZSwgbG9jYXRpb24sIGxlbmd0aCwgbGluZSxcbiAgICAgICAgICAgIGksIGo7XG5cbiAgICAgICAgaSA9IGxpbmVzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgbWF0Y2hEZWZpbmVzID0gbGluZXNbaV0ubWF0Y2goREVGSU5FKTtcbiAgICAgICAgICAgIGlmIChtYXRjaERlZmluZXMpIGRlZmluZXNbbWF0Y2hEZWZpbmVzWzFdXSA9IE51bWJlcihtYXRjaERlZmluZXNbMl0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaSA9IGxpbmVzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgbGluZSA9IGxpbmVzW2ldO1xuICAgICAgICAgICAgbWF0Y2hBdHRyaWJ1dGVzID0gbGluZS5tYXRjaChBVFRSSUJVUkUpO1xuICAgICAgICAgICAgbWF0Y2hVbmlmb3JtcyA9IGxpbmUubWF0Y2goVU5JRk9STSk7XG5cbiAgICAgICAgICAgIGlmIChtYXRjaEF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICBuYW1lID0gbWF0Y2hBdHRyaWJ1dGVzWzNdO1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXNbbmFtZV0gPSBjcmVhdGVBdHRyaWJ1dGUobWF0Y2hBdHRyaWJ1dGVzWzJdLCBfZ2wuZ2V0QXR0cmliTG9jYXRpb24ocHJvZ3JhbSwgbmFtZSkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtYXRjaFVuaWZvcm1zKSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IG1hdGNoVW5pZm9ybXNbMl07XG4gICAgICAgICAgICAgICAgbmFtZSA9IG1hdGNoVW5pZm9ybXNbM107XG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gbWF0Y2hVbmlmb3Jtc1s1XTtcblxuICAgICAgICAgICAgICAgIGlmIChsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoID0gZGVmaW5lc1tsZW5ndGgudHJpbSgpXSB8fCBsZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHVuaWZvcm1BcnJheSA9IHVuaWZvcm1zW25hbWVdID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgaiA9IGxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGotLSkgdW5pZm9ybUFycmF5W2pdID0gY3JlYXRlVW5pZm9ybSh0eXBlLCBfZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHByb2dyYW0sIG5hbWUgKyBcIltcIiArIGogKyBcIl1cIikpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uID0gX2dsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCBuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKSB1bmlmb3Jtc1tuYW1lXSA9IGNyZWF0ZVVuaWZvcm0odHlwZSwgbG9jYXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMucGFyc2VVbmlmb3Jtc0F0dHJpYnV0ZXMgPSBwYXJzZVVuaWZvcm1zQXR0cmlidXRlcztcblxuXG4gICAgZnVuY3Rpb24gY3JlYXRlQXR0cmlidXRlKHR5cGUsIGxvY2F0aW9uKSB7XG4gICAgICAgIGlmIChsb2NhdGlvbiA8IDApIHJldHVybiBudWxsO1xuXG4gICAgICAgIGlmICh0eXBlID09PSBcImludFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEF0dHJpYnV0ZTFpKGxvY2F0aW9uKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBcImZsb2F0XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXR0cmlidXRlMWYobG9jYXRpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwidmVjMlwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEF0dHJpYnV0ZTJmKGxvY2F0aW9uKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBcInZlYzNcIikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBBdHRyaWJ1dGUzZihsb2NhdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJ2ZWM0XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXR0cmlidXRlNGYobG9jYXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcblxuXG4gICAgZnVuY3Rpb24gQXR0cmlidXRlMWkobG9jYXRpb24pIHtcbiAgICAgICAgdGhpcy5sb2NhdGlvbiA9IGxvY2F0aW9uO1xuICAgIH1cblxuICAgIEF0dHJpYnV0ZTFpLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGxvY2F0aW9uID0gdGhpcy5sb2NhdGlvbjtcblxuICAgICAgICBpZiAobG9jYXRpb24gPiAtMSkge1xuICAgICAgICAgICAgX2dsLmJpbmRCdWZmZXIoX2dsLkFSUkFZX0JVRkZFUiwgdmFsdWUpO1xuICAgICAgICAgICAgZW5hYmxlQXR0cmlidXRlKGxvY2F0aW9uKTtcbiAgICAgICAgICAgIF9nbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKGxvY2F0aW9uLCAxLCBfZ2wuRkxPQVQsIGZhbHNlLCAwLCAwKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBBdHRyaWJ1dGUxZihsb2NhdGlvbikge1xuICAgICAgICB0aGlzLmxvY2F0aW9uID0gbG9jYXRpb247XG4gICAgfVxuXG4gICAgQXR0cmlidXRlMWYucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbG9jYXRpb24gPSB0aGlzLmxvY2F0aW9uO1xuXG4gICAgICAgIGlmIChsb2NhdGlvbiA+IC0xKSB7XG4gICAgICAgICAgICBfZ2wuYmluZEJ1ZmZlcihfZ2wuQVJSQVlfQlVGRkVSLCB2YWx1ZSk7XG4gICAgICAgICAgICBlbmFibGVBdHRyaWJ1dGUobG9jYXRpb24pO1xuICAgICAgICAgICAgX2dsLnZlcnRleEF0dHJpYlBvaW50ZXIobG9jYXRpb24sIDEsIF9nbC5GTE9BVCwgZmFsc2UsIDAsIDApO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIEF0dHJpYnV0ZTJmKGxvY2F0aW9uKSB7XG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgICB9XG5cbiAgICBBdHRyaWJ1dGUyZi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBsb2NhdGlvbiA9IHRoaXMubG9jYXRpb247XG5cbiAgICAgICAgaWYgKGxvY2F0aW9uID4gLTEpIHtcbiAgICAgICAgICAgIF9nbC5iaW5kQnVmZmVyKF9nbC5BUlJBWV9CVUZGRVIsIHZhbHVlKTtcbiAgICAgICAgICAgIGVuYWJsZUF0dHJpYnV0ZShsb2NhdGlvbik7XG4gICAgICAgICAgICBfZ2wudmVydGV4QXR0cmliUG9pbnRlcihsb2NhdGlvbiwgMiwgX2dsLkZMT0FULCBmYWxzZSwgMCwgMCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gQXR0cmlidXRlM2YobG9jYXRpb24pIHtcbiAgICAgICAgdGhpcy5sb2NhdGlvbiA9IGxvY2F0aW9uO1xuICAgIH1cblxuICAgIEF0dHJpYnV0ZTNmLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGxvY2F0aW9uID0gdGhpcy5sb2NhdGlvbjtcblxuICAgICAgICBpZiAobG9jYXRpb24gPiAtMSkge1xuICAgICAgICAgICAgX2dsLmJpbmRCdWZmZXIoX2dsLkFSUkFZX0JVRkZFUiwgdmFsdWUpO1xuICAgICAgICAgICAgZW5hYmxlQXR0cmlidXRlKGxvY2F0aW9uKTtcbiAgICAgICAgICAgIF9nbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKGxvY2F0aW9uLCAzLCBfZ2wuRkxPQVQsIGZhbHNlLCAwLCAwKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBBdHRyaWJ1dGU0Zihsb2NhdGlvbikge1xuICAgICAgICB0aGlzLmxvY2F0aW9uID0gbG9jYXRpb247XG4gICAgfVxuXG4gICAgQXR0cmlidXRlNGYucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbG9jYXRpb24gPSB0aGlzLmxvY2F0aW9uO1xuXG4gICAgICAgIGlmIChsb2NhdGlvbiA+IC0xKSB7XG4gICAgICAgICAgICBfZ2wuYmluZEJ1ZmZlcihfZ2wuQVJSQVlfQlVGRkVSLCB2YWx1ZSk7XG4gICAgICAgICAgICBlbmFibGVBdHRyaWJ1dGUobG9jYXRpb24pO1xuICAgICAgICAgICAgX2dsLnZlcnRleEF0dHJpYlBvaW50ZXIobG9jYXRpb24sIDQsIF9nbC5GTE9BVCwgZmFsc2UsIDAsIDApO1xuICAgICAgICB9XG4gICAgfTtcblxuXG4gICAgZnVuY3Rpb24gY3JlYXRlVW5pZm9ybSh0eXBlLCBsb2NhdGlvbikge1xuICAgICAgICBpZiAoIWxvY2F0aW9uKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBpZiAodHlwZSA9PT0gXCJpbnRcIikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBVbmlmb3JtMWkobG9jYXRpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiZmxvYXRcIikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBVbmlmb3JtMWYobG9jYXRpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwidmVjMlwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFVuaWZvcm0yZihsb2NhdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJ2ZWMzXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVW5pZm9ybTNmKGxvY2F0aW9uKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBcInZlYzRcIikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBVbmlmb3JtNGYobG9jYXRpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwibWF0MlwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFVuaWZvcm1NYXRyaXgyZnYobG9jYXRpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwibWF0M1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFVuaWZvcm1NYXRyaXgzZnYobG9jYXRpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwibWF0NFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFVuaWZvcm1NYXRyaXg0ZnYobG9jYXRpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwic2FtcGxlcjJEXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVW5pZm9ybVRleHR1cmUobG9jYXRpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwic2FtcGxlckN1YmVcIikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBVbmlmb3JtVGV4dHVyZUN1YmUobG9jYXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gVW5pZm9ybTFmKGxvY2F0aW9uKSB7XG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBVbmlmb3JtMWYucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh2YWx1ZSwgZm9yY2UpIHtcbiAgICAgICAgaWYgKGZvcmNlIHx8IHRoaXMudmFsdWUgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICBfZ2wudW5pZm9ybTFmKHRoaXMubG9jYXRpb24sIHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBVbmlmb3JtMWkobG9jYXRpb24pIHtcbiAgICAgICAgdGhpcy5sb2NhdGlvbiA9IGxvY2F0aW9uO1xuICAgICAgICB0aGlzLnZhbHVlID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIFVuaWZvcm0xaS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHZhbHVlLCBmb3JjZSkge1xuICAgICAgICBpZiAoZm9yY2UgfHwgdGhpcy52YWx1ZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgIF9nbC51bmlmb3JtMWkodGhpcy5sb2NhdGlvbiwgdmFsdWUpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFVuaWZvcm0yZihsb2NhdGlvbikge1xuICAgICAgICB0aGlzLmxvY2F0aW9uID0gbG9jYXRpb247XG4gICAgICAgIHRoaXMudmFsdWUgPSBuZXcgVmVjMihOYU4sIE5hTik7XG4gICAgfVxuXG4gICAgVW5pZm9ybTJmLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAodmFsdWUsIGZvcmNlKSB7XG4gICAgICAgIGlmIChmb3JjZSB8fCB0aGlzLnZhbHVlLm5vdEVxdWFscyh2YWx1ZSkpIHtcbiAgICAgICAgICAgIF9nbC51bmlmb3JtMmYodGhpcy5sb2NhdGlvbiwgdmFsdWUueCwgdmFsdWUueSk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlLmNvcHkodmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFVuaWZvcm0zZihsb2NhdGlvbikge1xuICAgICAgICB0aGlzLmxvY2F0aW9uID0gbG9jYXRpb247XG4gICAgICAgIHRoaXMudmFsdWUgPSBuZXcgVmVjMyhOYU4sIE5hTiwgTmFOKTtcbiAgICB9XG5cbiAgICBVbmlmb3JtM2YucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh2YWx1ZSwgZm9yY2UpIHtcbiAgICAgICAgaWYgKGZvcmNlIHx8IHRoaXMudmFsdWUubm90RXF1YWxzKHZhbHVlKSkge1xuICAgICAgICAgICAgX2dsLnVuaWZvcm0zZih0aGlzLmxvY2F0aW9uLCB2YWx1ZS54LCB2YWx1ZS55LCB2YWx1ZS56KTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUuY29weSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gVW5pZm9ybTRmKGxvY2F0aW9uKSB7XG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBWZWM0KE5hTiwgTmFOLCBOYU4sIE5hTik7XG4gICAgfVxuXG4gICAgVW5pZm9ybTRmLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAodmFsdWUsIGZvcmNlKSB7XG4gICAgICAgIGlmIChmb3JjZSB8fCB0aGlzLnZhbHVlLm5vdEVxdWFscyh2YWx1ZSkpIHtcbiAgICAgICAgICAgIF9nbC51bmlmb3JtNGYodGhpcy5sb2NhdGlvbiwgdmFsdWUueCwgdmFsdWUueSwgdmFsdWUueiwgdmFsdWUudyk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlLmNvcHkodmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFVuaWZvcm1NYXRyaXgyZnYobG9jYXRpb24pIHtcbiAgICAgICAgdGhpcy5sb2NhdGlvbiA9IGxvY2F0aW9uO1xuICAgICAgICB0aGlzLnZhbHVlID0gbmV3IE1hdDIoXG4gICAgICAgICAgICBOYU4sIE5hTixcbiAgICAgICAgICAgIE5hTiwgTmFOXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgVW5pZm9ybU1hdHJpeDJmdi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHZhbHVlLCBmb3JjZSkge1xuICAgICAgICBpZiAoZm9yY2UgfHwgdGhpcy52YWx1ZS5ub3RFcXVhbHModmFsdWUpKSB7XG4gICAgICAgICAgICBfZ2wudW5pZm9ybU1hdHJpeDJmdih0aGlzLmxvY2F0aW9uLCBmYWxzZSwgdmFsdWUuZWxlbWVudHMpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZS5jb3B5KHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBVbmlmb3JtTWF0cml4M2Z2KGxvY2F0aW9uKSB7XG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBNYXQzKFxuICAgICAgICAgICAgTmFOLCBOYU4sIE5hTixcbiAgICAgICAgICAgIE5hTiwgTmFOLCBOYU4sXG4gICAgICAgICAgICBOYU4sIE5hTiwgTmFOXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgVW5pZm9ybU1hdHJpeDNmdi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHZhbHVlLCBmb3JjZSkge1xuICAgICAgICBpZiAoZm9yY2UgfHwgdGhpcy52YWx1ZS5ub3RFcXVhbHModmFsdWUpKSB7XG4gICAgICAgICAgICBfZ2wudW5pZm9ybU1hdHJpeDNmdih0aGlzLmxvY2F0aW9uLCBmYWxzZSwgdmFsdWUuZWxlbWVudHMpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZS5jb3B5KHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBVbmlmb3JtTWF0cml4NGZ2KGxvY2F0aW9uKSB7XG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBNYXQ0KFxuICAgICAgICAgICAgTmFOLCBOYU4sIE5hTiwgTmFOLFxuICAgICAgICAgICAgTmFOLCBOYU4sIE5hTiwgTmFOLFxuICAgICAgICAgICAgTmFOLCBOYU4sIE5hTiwgTmFOLFxuICAgICAgICAgICAgTmFOLCBOYU4sIE5hTiwgTmFOXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgVW5pZm9ybU1hdHJpeDRmdi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHZhbHVlLCBmb3JjZSkge1xuICAgICAgICBpZiAoZm9yY2UgfHwgdGhpcy52YWx1ZS5ub3RFcXVhbHModmFsdWUpKSB7XG4gICAgICAgICAgICBfZ2wudW5pZm9ybU1hdHJpeDRmdih0aGlzLmxvY2F0aW9uLCBmYWxzZSwgdmFsdWUuZWxlbWVudHMpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZS5jb3B5KHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBVbmlmb3JtVGV4dHVyZShsb2NhdGlvbikge1xuICAgICAgICB0aGlzLmxvY2F0aW9uID0gbG9jYXRpb247XG4gICAgfVxuXG4gICAgVW5pZm9ybVRleHR1cmUucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBzZXRUZXh0dXJlKHRoaXMubG9jYXRpb24sIHZhbHVlKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gVW5pZm9ybVRleHR1cmVDdWJlKGxvY2F0aW9uKSB7XG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgICB9XG5cbiAgICBVbmlmb3JtVGV4dHVyZUN1YmUucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBzZXRUZXh0dXJlQ3ViZSh0aGlzLmxvY2F0aW9uLCB2YWx1ZSk7XG4gICAgfTtcbn1cblxuRXZlbnRFbWl0dGVyLmV4dGVuZChSZW5kZXJlcik7XG5cblxudmFyIGd1aUNvbnRlbnRfdmVydGV4ID0gW1xuICAgIFwiYXR0cmlidXRlIHZlYzMgcG9zaXRpb247XCIsXG4gICAgXCJhdHRyaWJ1dGUgdmVjMiB1djtcIixcblxuICAgIFwidW5pZm9ybSBtYXQ0IG12cE1hdHJpeDtcIixcbiAgICBcInVuaWZvcm0gdmVjMiBzaXplO1wiLFxuICAgIFwidW5pZm9ybSB2ZWM0IGNyb3A7XCIsXG5cbiAgICBcInZhcnlpbmcgdmVjMiB2VXY7XCIsXG5cbiAgICBcInZvaWQgbWFpbigpIHtcIixcbiAgICBcIlx0dlV2LnggPSB1di54ICogY3JvcC56ICsgY3JvcC54O1wiLFxuICAgIFwiXHR2VXYueSA9IHV2LnkgKiBjcm9wLncgKyBjcm9wLnk7XCIsXG4gICAgXCJcdGdsX1Bvc2l0aW9uID0gbXZwTWF0cml4ICogdmVjNChwb3NpdGlvbi54eSAqIHNpemUsIHBvc2l0aW9uLnosIDEuMCk7XCIsXG4gICAgXCJ9XCJcbl0uam9pbihcIlxcblwiKTtcblxudmFyIGd1aUNvbnRlbnRfZnJhZ21lbnQgPSBbXG4gICAgXCJ1bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlO1wiLFxuICAgIFwidW5pZm9ybSBmbG9hdCBhbHBoYTtcIixcblxuICAgIFwidmFyeWluZyB2ZWMyIHZVdjtcIixcblxuICAgIFwidm9pZCBtYWluKCkge1wiLFxuICAgIFwiXHR2ZWM0IGZpbmFsQ29sb3IgPSB0ZXh0dXJlMkQodGV4dHVyZSwgdlV2KTtcIixcbiAgICBcIlx0Z2xfRnJhZ0NvbG9yID0gdmVjNChmaW5hbENvbG9yLnh5eiwgZmluYWxDb2xvci53ICogYWxwaGEpO1wiLFxuICAgIFwifVwiXG5dLmpvaW4oXCJcXG5cIik7XG5cblxubW9kdWxlLmV4cG9ydHMgPSBSZW5kZXJlcjtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBTaGFkZXJDaHVua3MgPSB7XG4gICAgZEhkeHlfZndkOiBbXG4gICAgICAgIFwidmVjMiBkSGR4eV9md2Qoc2FtcGxlcjJEIG1hcCwgdmVjMiB1diwgZmxvYXQgc2NhbGUpIHtcIixcblxuICAgICAgICBcIlx0dmVjMiBkU1RkeCA9IGRGZHgodXYpO1wiLFxuICAgICAgICBcIlx0dmVjMiBkU1RkeSA9IGRGZHkodXYpO1wiLFxuXG4gICAgICAgIFwiXHRmbG9hdCBIbGwgPSBzY2FsZSAqIHRleHR1cmUyRChtYXAsIHV2KS54O1wiLFxuICAgICAgICBcIlx0ZmxvYXQgZEJ4ID0gc2NhbGUgKiB0ZXh0dXJlMkQobWFwLCB1diArIGRTVGR4KS54IC0gSGxsO1wiLFxuICAgICAgICBcIlx0ZmxvYXQgZEJ5ID0gc2NhbGUgKiB0ZXh0dXJlMkQobWFwLCB1diArIGRTVGR5KS54IC0gSGxsO1wiLFxuXG4gICAgICAgIFwiXHRyZXR1cm4gdmVjMihkQngsIGRCeSk7XCIsXG4gICAgICAgIFwifVwiLFxuICAgICAgICBcIlwiXG4gICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgcGVydHVyYk5vcm1hbEFyYjogW1xuICAgICAgICBcInZlYzMgcGVydHVyYk5vcm1hbEFyYih2ZWMzIHN1cmZfcG9zLCB2ZWMzIHN1cmZfbm9ybSwgdmVjMiBkSGR4eSkge1wiLFxuXG4gICAgICAgIFwiXHR2ZWMzIHZTaWdtYVggPSBkRmR4KHN1cmZfcG9zKTtcIixcbiAgICAgICAgXCJcdHZlYzMgdlNpZ21hWSA9IGRGZHkoc3VyZl9wb3MpO1wiLFxuICAgICAgICBcIlx0dmVjMyB2TiA9IHN1cmZfbm9ybTtcIixcblxuICAgICAgICBcIlx0dmVjMyBSMSA9IGNyb3NzKHZTaWdtYVksIHZOKTtcIixcbiAgICAgICAgXCJcdHZlYzMgUjIgPSBjcm9zcyh2TiwgdlNpZ21hWCk7XCIsXG5cbiAgICAgICAgXCJcdGZsb2F0IGZEZXQgPSBkb3QodlNpZ21hWCwgUjEpO1wiLFxuICAgICAgICBcIlx0dmVjMyB2R3JhZCA9IHNpZ24oZkRldCkgKiAoZEhkeHkueCAqIFIxICsgZEhkeHkueSAqIFIyKTtcIixcblxuICAgICAgICBcIlx0cmV0dXJuIG5vcm1hbGl6ZShhYnMoZkRldCkgKiBzdXJmX25vcm0gLSB2R3JhZCk7XCIsXG4gICAgICAgIFwifVwiLFxuICAgICAgICBcIlwiXG4gICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgcGVydHVyYk5vcm1hbDJBcmI6IFtcbiAgICAgICAgXCJ2ZWMzIHBlcnR1cmJOb3JtYWwyQXJiKHNhbXBsZXIyRCBtYXAsIHZlYzIgdXYsIHZlYzMgZXllX3BvcywgdmVjMyBzdXJmX25vcm0sIGZsb2F0IHNjYWxlKSB7XCIsXG5cbiAgICAgICAgXCJcdHZlYzMgcTAgPSBkRmR4KGV5ZV9wb3MueHl6KTtcIixcbiAgICAgICAgXCJcdHZlYzMgcTEgPSBkRmR5KGV5ZV9wb3MueHl6KTtcIixcbiAgICAgICAgXCJcdHZlYzIgc3QwID0gZEZkeCh1di5zdCk7XCIsXG4gICAgICAgIFwiXHR2ZWMyIHN0MSA9IGRGZHkodXYuc3QpO1wiLFxuXG4gICAgICAgIFwiXHR2ZWMzIFMgPSBub3JtYWxpemUocTAgKiBzdDEudCAtIHExICogc3QwLnQpO1wiLFxuICAgICAgICBcIlx0dmVjMyBUID0gbm9ybWFsaXplKC1xMCAqIHN0MS5zICsgcTEgKiBzdDAucyk7XCIsXG4gICAgICAgIFwiXHR2ZWMzIE4gPSBub3JtYWxpemUoc3VyZl9ub3JtKTtcIixcblxuICAgICAgICBcIlx0dmVjMyBtYXBOID0gdGV4dHVyZTJEKG1hcCwgdXYpLnh5eiAqIDIuMCAtIDEuMDtcIixcbiAgICAgICAgXCJcdG1hcE4ueHkgPSBzY2FsZSAqIG1hcE4ueHk7XCIsXG4gICAgICAgIFwiXHRtYXQzIHRzbiA9IG1hdDMoUywgVCwgTik7XCIsXG5cbiAgICAgICAgXCJcdHJldHVybiBub3JtYWxpemUodHNuICogbWFwTik7XCIsXG4gICAgICAgIFwifVwiLFxuICAgICAgICBcIlwiXG4gICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgY29tcG9zZU1hdDQ6IFtcbiAgICAgICAgXCJtYXQ0IGNvbXBvc2VNYXQ0KHZlYzMgcG9zaXRpb24sIHZlYzMgc2NhbGUsIHZlYzQgcm90YXRpb24pIHtcIixcbiAgICAgICAgXCJcdG1hdDQgbWF0O1wiLFxuICAgICAgICBcIlx0ZmxvYXQgeCA9IHJvdGF0aW9uLngsIHkgPSByb3RhdGlvbi55LCB6ID0gcm90YXRpb24ueiwgdyA9IHJvdGF0aW9uLncsXCIsXG5cbiAgICAgICAgXCJcdFx0eDIgPSB4ICsgeCwgeTIgPSB5ICsgeSwgejIgPSB6ICsgeixcIixcbiAgICAgICAgXCJcdFx0eHggPSB4ICogeDIsIHh5ID0geCAqIHkyLCB4eiA9IHggKiB6MixcIixcbiAgICAgICAgXCJcdFx0eXkgPSB5ICogeTIsIHl6ID0geSAqIHoyLCB6eiA9IHogKiB6MixcIixcbiAgICAgICAgXCJcdFx0d3ggPSB3ICogeDIsIHd5ID0gdyAqIHkyLCB3eiA9IHcgKiB6MixcIixcblxuICAgICAgICBcIlx0XHRzeCA9IHNjYWxlLngsIHN5ID0gc2NhbGUueSwgc3ogPSBzY2FsZS56O1wiLFxuXG4gICAgICAgIFwiXHRtYXRbMF1bMF0gPSAoMS4wIC0gKHl5ICsgenopKSAqIHN4O1wiLFxuICAgICAgICBcIlx0bWF0WzFdWzBdID0gKHh5IC0gd3opICogc3k7XCIsXG4gICAgICAgIFwiXHRtYXRbMl1bMF0gPSAoeHogKyB3eSkgKiBzejtcIixcblxuICAgICAgICBcIlx0bWF0WzBdWzFdID0gKHh5ICsgd3opICogc3g7XCIsXG4gICAgICAgIFwiXHRtYXRbMV1bMV0gPSAoMS4wIC0gKHh4ICsgenopKSAqIHN5O1wiLFxuICAgICAgICBcIlx0bWF0WzJdWzFdID0gKHl6IC0gd3gpICogc3o7XCIsXG5cbiAgICAgICAgXCJcdG1hdFswXVsyXSA9ICh4eiAtIHd5KSAqIHN4O1wiLFxuICAgICAgICBcIlx0bWF0WzFdWzJdID0gKHl6ICsgd3gpICogc3k7XCIsXG4gICAgICAgIFwiXHRtYXRbMl1bMl0gPSAoMS4wIC0gKHh4ICsgeXkpKSAqIHN6O1wiLFxuXG4gICAgICAgIFwiXHRtYXRbMF1bM10gPSAwLjA7XCIsXG4gICAgICAgIFwiXHRtYXRbMV1bM10gPSAwLjA7XCIsXG4gICAgICAgIFwiXHRtYXRbMl1bM10gPSAwLjA7XCIsXG5cbiAgICAgICAgXCJcdG1hdFszXVswXSA9IHBvc2l0aW9uLng7XCIsXG4gICAgICAgIFwiXHRtYXRbM11bMV0gPSBwb3NpdGlvbi55O1wiLFxuICAgICAgICBcIlx0bWF0WzNdWzJdID0gcG9zaXRpb24uejtcIixcbiAgICAgICAgXCJcdG1hdFszXVszXSA9IDEuMDtcIixcblxuICAgICAgICBcIlx0cmV0dXJuIG1hdDtcIixcbiAgICAgICAgXCJ9XCIsXG4gICAgICAgIFwiXCJcbiAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICBnZXRCb25lTWF0cml4OiBbXG4gICAgICAgIFwiI2lmZGVmIFVTRV9TS0lOTklOR1wiLFxuICAgICAgICBcIm1hdDQgZ2V0Qm9uZU1hdHJpeCgpIHtcIixcbiAgICAgICAgXCJcdG1hdDQgcmVzdWx0ID0gYm9uZVdlaWdodC54ICogY29tcG9zZU1hdDQoYm9uZXNQb3NbaW50KGJvbmVJbmRleC54KV0sIGJvbmVzU2NsW2ludChib25lSW5kZXgueCldLCBib25lc1JvdFtpbnQoYm9uZUluZGV4LngpXSk7XCIsXG4gICAgICAgIFwiXHRyZXN1bHQgPSByZXN1bHQgKyBib25lV2VpZ2h0LnkgKiBjb21wb3NlTWF0NChib25lc1Bvc1tpbnQoYm9uZUluZGV4LnkpXSwgYm9uZXNTY2xbaW50KGJvbmVJbmRleC55KV0sIGJvbmVzUm90W2ludChib25lSW5kZXgueSldKTtcIixcbiAgICAgICAgXCJcdHJlc3VsdCA9IHJlc3VsdCArIGJvbmVXZWlnaHQueiAqIGNvbXBvc2VNYXQ0KGJvbmVzUG9zW2ludChib25lSW5kZXgueildLCBib25lc1NjbFtpbnQoYm9uZUluZGV4LnopXSwgYm9uZXNSb3RbaW50KGJvbmVJbmRleC56KV0pO1wiLFxuICAgICAgICBcIlx0cmV0dXJuIHJlc3VsdDtcIixcbiAgICAgICAgXCJ9XCIsXG4gICAgICAgIFwiI2VuZGlmXCIsXG4gICAgICAgIFwiXCJcbiAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICBib25lOiBbXG4gICAgICAgIFwiXHQjaWZkZWYgVVNFX1NLSU5OSU5HXCIsXG4gICAgICAgIFwiXHRcdG1hdDQgYm9uZU1hdHJpeCA9IGdldEJvbmVNYXRyaXgoKTtcIixcblxuICAgICAgICBcIlx0XHQjaWZkZWYgVVNFX01PUlBIVEFSR0VUU1wiLFxuICAgICAgICBcIlx0XHRcdHZlYzQgYm9uZVZlcnRleCA9IHZlYzQoIG1vcnBoZWQsIDEuMCApO1wiLFxuICAgICAgICBcIlx0XHQjZWxzZVwiLFxuICAgICAgICBcIlx0XHRcdHZlYzQgYm9uZVZlcnRleCA9IHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcIixcbiAgICAgICAgXCJcdFx0I2VuZGlmXCIsXG5cbiAgICAgICAgXCJcdFx0dmVjNCBib25lID0gYm9uZU1hdHJpeCAqIGJvbmVWZXJ0ZXg7XCIsXG4gICAgICAgIFwiXHQjZW5kaWZcIixcbiAgICAgICAgXCJcIlxuICAgIF0uam9pbihcIlxcblwiKSxcblxuICAgIGJvbmVOb3JtYWw6IFtcbiAgICAgICAgXCJcdCNpZmRlZiBVU0VfU0tJTk5JTkdcIixcbiAgICAgICAgXCJcdFx0I2lmZGVmIFVTRV9NT1JQSE5PUk1BTFNcIixcbiAgICAgICAgXCJcdFx0XHR2ZWM0IGJvbmVOb3JtYWwgPSBib25lTWF0cml4ICogdmVjNCggbW9ycGhlZE5vcm1hbCwgMC4wICk7XCIsXG4gICAgICAgIFwiXHRcdCNlbHNlXCIsXG4gICAgICAgIFwiXHRcdFx0dmVjNCBib25lTm9ybWFsID0gYm9uZU1hdHJpeCAqIHZlYzQoIG5vcm1hbCwgMC4wICk7XCIsXG4gICAgICAgIFwiXHRcdCNlbmRpZlwiLFxuICAgICAgICBcIlx0I2VuZGlmXCIsXG4gICAgICAgIFwiXCJcbiAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICB0cmFuc2Zvcm1lZE5vcm1hbDogW1xuICAgICAgICBcIlx0I2lmZGVmIFVTRV9TS0lOTklOR1wiLFxuICAgICAgICBcIlx0dmVjMyBvYmplY3ROb3JtYWwgPSBib25lTm9ybWFsLnh5ejtcIixcbiAgICAgICAgXCJcdCNlbmRpZlwiLFxuXG4gICAgICAgIFwiXHQjaWYgIWRlZmluZWQoIFVTRV9TS0lOTklORyApICYmIGRlZmluZWQoIFVTRV9NT1JQSE5PUk1BTFMgKVwiLFxuICAgICAgICBcIlx0dmVjMyBvYmplY3ROb3JtYWwgPSBtb3JwaGVkTm9ybWFsO1wiLFxuICAgICAgICBcIlx0I2VuZGlmXCIsXG5cbiAgICAgICAgXCJcdCNpZiAhZGVmaW5lZCggVVNFX1NLSU5OSU5HICkgJiYgISBkZWZpbmVkKCBVU0VfTU9SUEhOT1JNQUxTIClcIixcbiAgICAgICAgXCJcdHZlYzMgb2JqZWN0Tm9ybWFsID0gbm9ybWFsO1wiLFxuICAgICAgICBcIlx0I2VuZGlmXCIsXG5cbiAgICAgICAgXCJcdHZlYzMgdHJhbnNmb3JtZWROb3JtYWwgPSBub3JtYWxNYXRyaXggKiBvYmplY3ROb3JtYWw7XCIsXG4gICAgICAgIFwiXCJcbiAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICB3b3JsZFBvc2l0aW9uOiBbXG4gICAgICAgIFwiXHQjaWZkZWYgVVNFX1NLSU5OSU5HXCIsXG4gICAgICAgIFwiXHR2ZWM0IHdvcmxkUG9zaXRpb24gPSBtb2RlbE1hdHJpeCAqIGJvbmU7XCIsXG4gICAgICAgIFwiXHQjZW5kaWZcIixcblxuICAgICAgICBcIlx0I2lmIGRlZmluZWQoIFVTRV9NT1JQSFRBUkdFVFMgKSAmJiAhIGRlZmluZWQoIFVTRV9TS0lOTklORyApXCIsXG4gICAgICAgIFwiXHR2ZWM0IHdvcmxkUG9zaXRpb24gPSBtb2RlbE1hdHJpeCAqIHZlYzQoIG1vcnBoZWQsIDEuMCApO1wiLFxuICAgICAgICBcIlx0I2VuZGlmXCIsXG5cbiAgICAgICAgXCJcdCNpZiAhIGRlZmluZWQoIFVTRV9NT1JQSFRBUkdFVFMgKSAmJiAhIGRlZmluZWQoIFVTRV9TS0lOTklORyApXCIsXG4gICAgICAgIFwiXHR2ZWM0IHdvcmxkUG9zaXRpb24gPSBtb2RlbE1hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcIixcbiAgICAgICAgXCJcdCNlbmRpZlwiLFxuICAgICAgICBcIlwiXG4gICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgd29ybGRQb3NpdGlvbl9zcHJpdGU6IFtcbiAgICAgICAgXCJcdHZlYzQgd29ybGRQb3NpdGlvbiA9IG1vZGVsTWF0cml4ICogdmVjNCggcG9zaXRpb24ueHkgKiBzaXplLCBwb3NpdGlvbi56LCAxLjAgKTtcIixcbiAgICAgICAgXCJcIlxuICAgIF0uam9pbihcIlxcblwiKSxcblxuICAgIHdvcmxkUG9zaXRpb25fZW1pdHRlcjogW1xuICAgICAgICBcIlx0dmVjNCB3b3JsZFBvc2l0aW9uID0gbW9kZWxNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7XCIsXG4gICAgICAgIFwiXCJcbiAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICBtdlBvc2l0aW9uOiBbXG4gICAgICAgIFwiXHQjaWZkZWYgVVNFX1NLSU5OSU5HXCIsXG4gICAgICAgIFwiXHR2ZWM0IG12UG9zaXRpb24gPSBtb2RlbFZpZXdNYXRyaXggKiBib25lO1wiLFxuICAgICAgICBcIlx0I2VuZGlmXCIsXG5cbiAgICAgICAgXCJcdCNpZiAhZGVmaW5lZCggVVNFX1NLSU5OSU5HICkgJiYgZGVmaW5lZCggVVNFX01PUlBIVEFSR0VUUyApXCIsXG4gICAgICAgIFwiXHR2ZWM0IG12UG9zaXRpb24gPSBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBtb3JwaGVkLCAxLjAgKTtcIixcbiAgICAgICAgXCJcdCNlbmRpZlwiLFxuXG4gICAgICAgIFwiXHQjaWYgIWRlZmluZWQoIFVTRV9TS0lOTklORyApICYmICFkZWZpbmVkKCBVU0VfTU9SUEhUQVJHRVRTIClcIixcbiAgICAgICAgXCJcdHZlYzQgbXZQb3NpdGlvbiA9IG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcIixcbiAgICAgICAgXCJcdCNlbmRpZlwiLFxuICAgICAgICBcIlwiXG4gICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgbXZQb3NpdGlvbl9zcHJpdGU6IFtcbiAgICAgICAgXCJcdHZlYzQgbXZQb3NpdGlvbiA9IG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLnh5ICogc2l6ZSwgcG9zaXRpb24ueiwgMS4wICk7XCIsXG4gICAgICAgIFwiXCJcbiAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICBtdlBvc2l0aW9uX2VtaXR0ZXI6IFtcbiAgICAgICAgXCJcdHZlYzQgbXZQb3NpdGlvbiA9IG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcIixcbiAgICAgICAgXCJcIlxuICAgIF0uam9pbihcIlxcblwiKSxcblxuICAgIHBhcnRpY2xlX2hlYWRlcl92ZXJ0ZXg6IFtcbiAgICAgICAgXCJhdHRyaWJ1dGUgdmVjMyBwYXJ0aWNsZUNvbG9yO1wiLFxuICAgICAgICBcInVuaWZvcm0gZmxvYXQgcGFydGljbGVTaXplUmF0aW87XCIsXG4gICAgICAgIFwiXCJcbiAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICBwYXJ0aWNsZV9oZWFkZXI6IFtcbiAgICAgICAgXCJ2YXJ5aW5nIGZsb2F0IHZBbmdsZTtcIixcbiAgICAgICAgXCJ2YXJ5aW5nIGZsb2F0IHZBbHBoYTtcIixcbiAgICAgICAgXCJ2YXJ5aW5nIGZsb2F0IHZTaXplO1wiLFxuICAgICAgICBcInZhcnlpbmcgdmVjMyB2UGFydGljbGVDb2xvcjtcIixcbiAgICAgICAgXCJcIlxuICAgIF0uam9pbihcIlxcblwiKSxcblxuICAgIHBhcnRpY2xlX3ZlcnRleDogW1xuICAgICAgICBcIlx0dkFuZ2xlID0gZGF0YS54O1wiLFxuICAgICAgICBcIlx0dkFscGhhID0gZGF0YS56O1wiLFxuICAgICAgICBcIlx0dlNpemUgPSBkYXRhLnk7XCIsXG4gICAgICAgIFwiXHR2UGFydGljbGVDb2xvciA9IHBhcnRpY2xlQ29sb3I7XCIsXG4gICAgICAgIFwiXCJcbiAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICBwYXJ0aWNsZV92ZXJ0ZXhfc2l6ZTogW1xuICAgICAgICBcIlx0Z2xfUG9pbnRTaXplID0gdlNpemUgKiAocGFydGljbGVTaXplUmF0aW8gLyBsZW5ndGgobXZQb3NpdGlvbi54eXopKTtcXG5cIixcbiAgICAgICAgXCJcIlxuICAgIF0uam9pbihcIlxcblwiKSxcblxuICAgIHBhcnRpY2xlX3ZlcnRleF9zaXplXzJkOiBbXG4gICAgICAgIFwiXHRnbF9Qb2ludFNpemUgPSB2U2l6ZSAqIHBhcnRpY2xlU2l6ZVJhdGlvO1xcblwiLFxuICAgICAgICBcIlwiXG4gICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgc3ByaXRlX2hlYWRlcjogW1xuICAgICAgICBcInVuaWZvcm0gdmVjMiBzaXplO1wiLFxuICAgICAgICBcInVuaWZvcm0gdmVjNCBjcm9wO1wiLFxuICAgICAgICBcIlwiXG4gICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgc3ByaXRlX3ZlcnRleF9hZnRlcjogW1xuICAgICAgICBcIlx0dlV2LnggPSB2VXYueCAqIGNyb3AueiArIGNyb3AueDtcIixcbiAgICAgICAgXCJcdHZVdi55ID0gdlV2LnkgKiBjcm9wLncgKyBjcm9wLnk7XCIsXG4gICAgICAgIFwiXCJcbiAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICBsaWdodHM6IFtcbiAgICAgICAgXCJ1bmlmb3JtIHZlYzMgYW1iaWVudDtcIixcblxuICAgICAgICBcIiNpZiBNQVhfRElSX0xJR0hUUyA+IDBcIixcblxuICAgICAgICBcInVuaWZvcm0gdmVjMyBkaXJlY3Rpb25hbExpZ2h0Q29sb3JbIE1BWF9ESVJfTElHSFRTIF07XCIsXG4gICAgICAgIFwidW5pZm9ybSB2ZWMzIGRpcmVjdGlvbmFsTGlnaHREaXJlY3Rpb25bIE1BWF9ESVJfTElHSFRTIF07XCIsXG5cbiAgICAgICAgXCIjZW5kaWZcIixcblxuICAgICAgICBcIiNpZiBNQVhfSEVNSV9MSUdIVFMgPiAwXCIsXG5cbiAgICAgICAgXCJ1bmlmb3JtIHZlYzMgaGVtaUxpZ2h0Q29sb3JbIE1BWF9IRU1JX0xJR0hUUyBdO1wiLFxuICAgICAgICBcInVuaWZvcm0gdmVjMyBoZW1pTGlnaHREaXJlY3Rpb25bIE1BWF9IRU1JX0xJR0hUUyBdO1wiLFxuXG4gICAgICAgIFwiI2VuZGlmXCIsXG5cbiAgICAgICAgXCIjaWYgTUFYX1BPSU5UX0xJR0hUUyA+IDBcIixcblxuICAgICAgICBcInVuaWZvcm0gdmVjMyBwb2ludExpZ2h0Q29sb3JbIE1BWF9QT0lOVF9MSUdIVFMgXTtcIixcbiAgICAgICAgXCJ1bmlmb3JtIHZlYzMgcG9pbnRMaWdodFBvc2l0aW9uWyBNQVhfUE9JTlRfTElHSFRTIF07XCIsXG4gICAgICAgIFwidW5pZm9ybSBmbG9hdCBwb2ludExpZ2h0RGlzdGFuY2VbIE1BWF9QT0lOVF9MSUdIVFMgXTtcIixcblxuICAgICAgICBcIiNlbmRpZlwiLFxuXG4gICAgICAgIFwiI2lmIE1BWF9TUE9UX0xJR0hUUyA+IDBcIixcblxuICAgICAgICBcInVuaWZvcm0gdmVjMyBzcG90TGlnaHRDb2xvclsgTUFYX1NQT1RfTElHSFRTIF07XCIsXG4gICAgICAgIFwidW5pZm9ybSB2ZWMzIHNwb3RMaWdodFBvc2l0aW9uWyBNQVhfU1BPVF9MSUdIVFMgXTtcIixcbiAgICAgICAgXCJ1bmlmb3JtIHZlYzMgc3BvdExpZ2h0RGlyZWN0aW9uWyBNQVhfU1BPVF9MSUdIVFMgXTtcIixcbiAgICAgICAgXCJ1bmlmb3JtIGZsb2F0IHNwb3RMaWdodERpc3RhbmNlWyBNQVhfU1BPVF9MSUdIVFMgXTtcIixcbiAgICAgICAgXCJ1bmlmb3JtIGZsb2F0IHNwb3RMaWdodEFuZ2xlQ29zWyBNQVhfU1BPVF9MSUdIVFMgXTtcIixcbiAgICAgICAgXCJ1bmlmb3JtIGZsb2F0IHNwb3RMaWdodEV4cG9uZW50WyBNQVhfU1BPVF9MSUdIVFMgXTtcIixcblxuICAgICAgICBcIiNlbmRpZlwiLFxuICAgICAgICBcIlwiXG4gICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgVmVydGV4TGlnaHQ6IFtcbiAgICAgICAgXCJ2b2lkIFZlcnRleExpZ2h0KHZlYzMgbm9ybWFsLCB2ZWMzIHdvcmxkUG9zaXRpb24sIHZlYzMgdmlld1Bvc2l0aW9uLCBpbm91dCB2ZWMzIGRpZmZ1c2VMaWdodCkge1wiLFxuXG4gICAgICAgIFwiXHQjaWYgTUFYX0RJUl9MSUdIVFMgPiAwXCIsXG4gICAgICAgIFwiXHRcdGZvciggaW50IGkgPSAwOyBpIDwgTUFYX0RJUl9MSUdIVFM7IGkgKysgKSB7XCIsXG5cbiAgICAgICAgXCJcdFx0XHR2ZWM0IGxEaXJlY3Rpb24gPSB2aWV3TWF0cml4ICogdmVjNCggZGlyZWN0aW9uYWxMaWdodERpcmVjdGlvblsgaSBdLCAwLjAgKTtcIixcbiAgICAgICAgXCJcdFx0XHR2ZWMzIGRpclZlY3RvciA9IG5vcm1hbGl6ZSggbERpcmVjdGlvbi54eXogKTtcIixcblxuICAgICAgICBcIlx0XHRcdGZsb2F0IGRvdFByb2R1Y3QgPSBkb3QoIG5vcm1hbCwgZGlyVmVjdG9yICk7XCIsXG4gICAgICAgIFwiXHRcdFx0dmVjMyBkaXJlY3Rpb25hbExpZ2h0V2VpZ2h0aW5nID0gdmVjMyggbWF4KCBkb3RQcm9kdWN0LCAwLjAgKSApO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0ZGlmZnVzZUxpZ2h0ICs9IGRpcmVjdGlvbmFsTGlnaHRDb2xvclsgaSBdICogZGlyZWN0aW9uYWxMaWdodFdlaWdodGluZztcIixcbiAgICAgICAgXCJcdFx0fVwiLFxuICAgICAgICBcIlx0I2VuZGlmXCIsXG5cbiAgICAgICAgXCJcdCNpZiBNQVhfUE9JTlRfTElHSFRTID4gMFwiLFxuICAgICAgICBcIlx0XHRmb3IoIGludCBpID0gMDsgaSA8IE1BWF9QT0lOVF9MSUdIVFM7IGkgKysgKSB7XCIsXG5cbiAgICAgICAgXCJcdFx0XHR2ZWM0IGxQb3NpdGlvbiA9IHZpZXdNYXRyaXggKiB2ZWM0KCBwb2ludExpZ2h0UG9zaXRpb25bIGkgXSwgMS4wICk7XCIsXG4gICAgICAgIFwiXHRcdFx0dmVjMyBsVmVjdG9yID0gbFBvc2l0aW9uLnh5eiArIHZpZXdQb3NpdGlvbjtcIixcblxuICAgICAgICBcIlx0XHRcdGZsb2F0IGxEaXN0YW5jZSA9IDEuMDtcIixcbiAgICAgICAgXCJcdFx0XHRpZiAoIHBvaW50TGlnaHREaXN0YW5jZVsgaSBdID4gMC4wICkge1wiLFxuICAgICAgICBcIlx0XHRcdFx0bERpc3RhbmNlID0gMS4wIC0gbWluKCAoIGxlbmd0aCggbFZlY3RvciApIC8gcG9pbnRMaWdodERpc3RhbmNlWyBpIF0gKSwgMS4wICk7XCIsXG4gICAgICAgIFwiXHRcdFx0fVwiLFxuXG4gICAgICAgIFwiXHRcdFx0bFZlY3RvciA9IG5vcm1hbGl6ZSggbFZlY3RvciApO1wiLFxuICAgICAgICBcIlx0XHRcdGZsb2F0IGRvdFByb2R1Y3QgPSBkb3QoIG5vcm1hbCwgbFZlY3RvciApO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0dmVjMyBwb2ludExpZ2h0V2VpZ2h0aW5nID0gdmVjMyggbWF4KCBkb3RQcm9kdWN0LCAwLjAgKSApO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0ZGlmZnVzZUxpZ2h0ICs9IHBvaW50TGlnaHRDb2xvclsgaSBdICogcG9pbnRMaWdodFdlaWdodGluZyAqIGxEaXN0YW5jZTtcIixcbiAgICAgICAgXCJcdFx0fVwiLFxuICAgICAgICBcIlx0I2VuZGlmXCIsXG5cbiAgICAgICAgXCJcdCNpZiBNQVhfU1BPVF9MSUdIVFMgPiAwXCIsXG4gICAgICAgIFwiXHRcdGZvciggaW50IGkgPSAwOyBpIDwgTUFYX1NQT1RfTElHSFRTOyBpICsrICkge1wiLFxuXG4gICAgICAgIFwiXHRcdFx0dmVjNCBsUG9zaXRpb24gPSB2aWV3TWF0cml4ICogdmVjNCggc3BvdExpZ2h0UG9zaXRpb25bIGkgXSwgMS4wICk7XCIsXG4gICAgICAgIFwiXHRcdFx0dmVjMyBsVmVjdG9yID0gbFBvc2l0aW9uLnh5eiArIHZpZXdQb3NpdGlvbjtcIixcblxuICAgICAgICBcIlx0XHRcdGZsb2F0IHNwb3RFZmZlY3QgPSBkb3QoIHNwb3RMaWdodERpcmVjdGlvblsgaSBdLCBub3JtYWxpemUoIHNwb3RMaWdodFBvc2l0aW9uWyBpIF0gLSB3b3JsZFBvc2l0aW9uICkgKTtcIixcblxuICAgICAgICBcIlx0XHRcdGlmICggc3BvdEVmZmVjdCA+IHNwb3RMaWdodEFuZ2xlQ29zWyBpIF0gKSB7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRcdHNwb3RFZmZlY3QgPSBtYXgoIHBvdyggc3BvdEVmZmVjdCwgc3BvdExpZ2h0RXhwb25lbnRbIGkgXSApLCAwLjAgKTtcIixcblxuICAgICAgICBcIlx0XHRcdFx0ZmxvYXQgbERpc3RhbmNlID0gMS4wO1wiLFxuICAgICAgICBcIlx0XHRcdFx0aWYgKCBzcG90TGlnaHREaXN0YW5jZVsgaSBdID4gMC4wICkge1wiLFxuICAgICAgICBcIlx0XHRcdFx0XHRsRGlzdGFuY2UgPSAxLjAgLSBtaW4oICggbGVuZ3RoKCBsVmVjdG9yICkgLyBzcG90TGlnaHREaXN0YW5jZVsgaSBdICksIDEuMCApO1wiLFxuICAgICAgICBcIlx0XHRcdFx0fVwiLFxuXG4gICAgICAgIFwiXHRcdFx0XHRsVmVjdG9yID0gbm9ybWFsaXplKCBsVmVjdG9yICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRcdGZsb2F0IGRvdFByb2R1Y3QgPSBkb3QoIG5vcm1hbCwgbFZlY3RvciApO1wiLFxuICAgICAgICBcIlx0XHRcdFx0dmVjMyBzcG90TGlnaHRXZWlnaHRpbmcgPSB2ZWMzKCBtYXgoIGRvdFByb2R1Y3QsIDAuMCApICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRcdGRpZmZ1c2VMaWdodCArPSBzcG90TGlnaHRDb2xvclsgaSBdICogc3BvdExpZ2h0V2VpZ2h0aW5nICogbERpc3RhbmNlICogc3BvdEVmZmVjdDtcIixcbiAgICAgICAgXCJcdFx0XHR9XCIsXG5cbiAgICAgICAgXCJcdFx0fVwiLFxuICAgICAgICBcIlx0I2VuZGlmXCIsXG5cbiAgICAgICAgXCJcdCNpZiBNQVhfSEVNSV9MSUdIVFMgPiAwXCIsXG4gICAgICAgIFwiXHRcdGZvciggaW50IGkgPSAwOyBpIDwgTUFYX0hFTUlfTElHSFRTOyBpICsrICkge1wiLFxuXG4gICAgICAgIFwiXHRcdFx0dmVjNCBsRGlyZWN0aW9uID0gdmlld01hdHJpeCAqIHZlYzQoIGhlbWlMaWdodERpcmVjdGlvblsgaSBdLCAwLjAgKTtcIixcbiAgICAgICAgXCJcdFx0XHR2ZWMzIGxWZWN0b3IgPSBub3JtYWxpemUoIGxEaXJlY3Rpb24ueHl6ICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRmbG9hdCBkb3RQcm9kdWN0ID0gZG90KCBub3JtYWwsIGxWZWN0b3IgKTtcIixcbiAgICAgICAgXCJcdFx0XHRmbG9hdCBoZW1pRGlmZnVzZVdlaWdodCA9IDAuNSAqIGRvdFByb2R1Y3QgKyAwLjU7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRkaWZmdXNlTGlnaHQgKz0gaGVtaUxpZ2h0Q29sb3JbIGkgXSAqIGhlbWlEaWZmdXNlV2VpZ2h0O1wiLFxuICAgICAgICBcIlx0XHR9XCIsXG4gICAgICAgIFwiXHQjZW5kaWZcIixcblxuICAgICAgICBcIlx0ZGlmZnVzZUxpZ2h0ICs9IGFtYmllbnQ7XCIsXG4gICAgICAgIFwifVwiLFxuICAgICAgICBcIlwiXG4gICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgcGVyUGl4ZWxWYXJ5aW5nSGVhZGVyOiBbXG4gICAgICAgIFwidmFyeWluZyB2ZWMzIHZXb3JsZFBvc2l0aW9uO1wiLFxuICAgICAgICBcInZhcnlpbmcgdmVjMyB2Vmlld1Bvc2l0aW9uO1wiLFxuICAgICAgICBcInZhcnlpbmcgdmVjMyB2Tm9ybWFsO1wiLFxuICAgICAgICBcIlwiXG4gICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgcGVyUGl4ZWxWYXJ5aW5nTWFpbjogW1xuICAgICAgICBcIlx0dldvcmxkUG9zaXRpb24gPSB3b3JsZFBvc2l0aW9uLnh5ejtcIixcbiAgICAgICAgXCJcdHZWaWV3UG9zaXRpb24gPSAtbXZQb3NpdGlvbi54eXo7XCIsXG4gICAgICAgIFwiXHR2Tm9ybWFsID0gdHJhbnNmb3JtZWROb3JtYWw7XCIsXG4gICAgXS5qb2luKFwiXFxuXCIpLFxuXG4gICAgUGl4ZWxMaWdodDogW1xuICAgICAgICBcInZvaWQgUGl4ZWxMaWdodCh2ZWMzIG5vcm1hbCwgdmVjMyBzcGVjdWxhckNvbG9yLCBmbG9hdCBzcGVjdWxhclN0cmVuZ3RoLCBmbG9hdCBzaGluaW5lc3MsIGlub3V0IHZlYzMgZGlmZnVzZUxpZ2h0LCBpbm91dCB2ZWMzIHNwZWN1bGFyTGlnaHQpIHtcIixcbiAgICAgICAgXCJcdCNpZiBNQVhfRElSX0xJR0hUUyA+IDBcIixcbiAgICAgICAgXCJcdFx0Zm9yKCBpbnQgaSA9IDA7IGkgPCBNQVhfRElSX0xJR0hUUzsgaSArKyApIHtcIixcblxuICAgICAgICBcIlx0XHRcdHZlYzQgbERpcmVjdGlvbiA9IHZpZXdNYXRyaXggKiB2ZWM0KCBkaXJlY3Rpb25hbExpZ2h0RGlyZWN0aW9uWyBpIF0sIDAuMCApO1wiLFxuICAgICAgICBcIlx0XHRcdHZlYzMgZGlyVmVjdG9yID0gbm9ybWFsaXplKCBsRGlyZWN0aW9uLnh5eiApO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgZG90UHJvZHVjdCA9IGRvdCggbm9ybWFsLCBkaXJWZWN0b3IgKTtcIixcbiAgICAgICAgXCJcdFx0XHR2ZWMzIGRpcmVjdGlvbmFsTGlnaHRXZWlnaHRpbmcgPSB2ZWMzKCBtYXgoIGRvdFByb2R1Y3QsIDAuMCApICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRkaWZmdXNlTGlnaHQgKz0gZGlyZWN0aW9uYWxMaWdodENvbG9yWyBpIF0gKiBkaXJlY3Rpb25hbExpZ2h0V2VpZ2h0aW5nO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0dmVjMyBkaXJIYWxmVmVjdG9yID0gbm9ybWFsaXplKCBkaXJWZWN0b3IgKyB2Vmlld1Bvc2l0aW9uICk7XCIsXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgZGlyRG90Tm9ybWFsSGFsZiA9IG1heCggZG90KCBub3JtYWwsIGRpckhhbGZWZWN0b3IgKSwgMC4wICk7XCIsXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgZGlyU3BlY3VsYXJXZWlnaHQgPSBzcGVjdWxhclN0cmVuZ3RoICogbWF4KCBwb3coIGRpckRvdE5vcm1hbEhhbGYsIHNoaW5pbmVzcyApLCAwLjAgKTtcIixcbiAgICAgICAgXCJcdFx0XHRmbG9hdCBzcGVjdWxhck5vcm1hbGl6YXRpb24gPSAoIHNoaW5pbmVzcyArIDIuMDAwMSApIC8gOC4wO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0dmVjMyBzY2hsaWNrID0gc3BlY3VsYXJDb2xvciArIHZlYzMoIDEuMCAtIHNwZWN1bGFyQ29sb3IgKSAqIHBvdyggMS4wIC0gZG90KCBkaXJWZWN0b3IsIGRpckhhbGZWZWN0b3IgKSwgNS4wICk7XCIsXG4gICAgICAgIFwiXHRcdFx0c3BlY3VsYXJMaWdodCArPSBzY2hsaWNrICogZGlyZWN0aW9uYWxMaWdodENvbG9yWyBpIF0gKiBkaXJTcGVjdWxhcldlaWdodCAqIGRpcmVjdGlvbmFsTGlnaHRXZWlnaHRpbmcgKiBzcGVjdWxhck5vcm1hbGl6YXRpb247XCIsXG4gICAgICAgIFwiXHRcdH1cIixcbiAgICAgICAgXCJcdCNlbmRpZlwiLFxuXG4gICAgICAgIFwiXHQjaWYgTUFYX1BPSU5UX0xJR0hUUyA+IDBcIixcbiAgICAgICAgXCJcdFx0Zm9yKCBpbnQgaSA9IDA7IGkgPCBNQVhfUE9JTlRfTElHSFRTOyBpICsrICkge1wiLFxuXG4gICAgICAgIFwiXHRcdFx0dmVjNCBsUG9zaXRpb24gPSB2aWV3TWF0cml4ICogdmVjNCggcG9pbnRMaWdodFBvc2l0aW9uWyBpIF0sIDEuMCApO1wiLFxuICAgICAgICBcIlx0XHRcdHZlYzMgbFZlY3RvciA9IGxQb3NpdGlvbi54eXogKyB2Vmlld1Bvc2l0aW9uO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgbERpc3RhbmNlID0gMS4wO1wiLFxuICAgICAgICBcIlx0XHRcdGlmICggcG9pbnRMaWdodERpc3RhbmNlWyBpIF0gPiAwLjAgKSB7XCIsXG4gICAgICAgIFwiXHRcdFx0XHRsRGlzdGFuY2UgPSAxLjAgLSBtaW4oICggbGVuZ3RoKCBsVmVjdG9yICkgLyBwb2ludExpZ2h0RGlzdGFuY2VbIGkgXSApLCAxLjAgKTtcIixcbiAgICAgICAgXCJcdFx0XHR9XCIsXG5cbiAgICAgICAgXCJcdFx0XHRsVmVjdG9yID0gbm9ybWFsaXplKCBsVmVjdG9yICk7XCIsXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgZG90UHJvZHVjdCA9IGRvdCggbm9ybWFsLCBsVmVjdG9yICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHR2ZWMzIHBvaW50TGlnaHRXZWlnaHRpbmcgPSB2ZWMzKCBtYXgoIGRvdFByb2R1Y3QsIDAuMCApICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRkaWZmdXNlTGlnaHQgKz0gcG9pbnRMaWdodENvbG9yWyBpIF0gKiBwb2ludExpZ2h0V2VpZ2h0aW5nICogbERpc3RhbmNlO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0dmVjMyBwb2ludEhhbGZWZWN0b3IgPSBub3JtYWxpemUoIGxWZWN0b3IgKyB2Vmlld1Bvc2l0aW9uICk7XCIsXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgcG9pbnREaWZmdXNlV2VpZ2h0ID0gbWF4KCBkb3RQcm9kdWN0LCAwLjAgKTtcIixcbiAgICAgICAgXCJcdFx0XHRmbG9hdCBwb2ludERvdE5vcm1hbEhhbGYgPSBtYXgoIGRvdCggbm9ybWFsLCBwb2ludEhhbGZWZWN0b3IgKSwgMC4wICk7XCIsXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgcG9pbnRTcGVjdWxhcldlaWdodCA9IHNwZWN1bGFyU3RyZW5ndGggKiBtYXgoIHBvdyggcG9pbnREb3ROb3JtYWxIYWxmLCBzaGluaW5lc3MgKSwgMC4wICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRmbG9hdCBzcGVjdWxhck5vcm1hbGl6YXRpb24gPSAoIHNoaW5pbmVzcyArIDIuMDAwMSApIC8gOC4wO1wiLFxuICAgICAgICBcIlx0XHRcdHZlYzMgc2NobGljayA9IHNwZWN1bGFyQ29sb3IgKyB2ZWMzKCAxLjAgLSBzcGVjdWxhckNvbG9yICkgKiBwb3coIDEuMCAtIGRvdCggbFZlY3RvciwgcG9pbnRIYWxmVmVjdG9yICksIDUuMCApO1wiLFxuICAgICAgICBcIlx0XHRcdHNwZWN1bGFyTGlnaHQgKz0gc2NobGljayAqIHBvaW50TGlnaHRDb2xvclsgaSBdICogcG9pbnRTcGVjdWxhcldlaWdodCAqIHBvaW50RGlmZnVzZVdlaWdodCAqIGxEaXN0YW5jZSAqIHNwZWN1bGFyTm9ybWFsaXphdGlvbjtcIixcbiAgICAgICAgXCJcdFx0fVwiLFxuICAgICAgICBcIlx0I2VuZGlmXCIsXG5cbiAgICAgICAgXCJcdCNpZiBNQVhfU1BPVF9MSUdIVFMgPiAwXCIsXG4gICAgICAgIFwiXHRcdGZvciggaW50IGkgPSAwOyBpIDwgTUFYX1NQT1RfTElHSFRTOyBpICsrICkge1wiLFxuXG4gICAgICAgIFwiXHRcdFx0dmVjNCBsUG9zaXRpb24gPSB2aWV3TWF0cml4ICogdmVjNCggc3BvdExpZ2h0UG9zaXRpb25bIGkgXSwgMS4wICk7XCIsXG4gICAgICAgIFwiXHRcdFx0dmVjMyBsVmVjdG9yID0gbFBvc2l0aW9uLnh5eiArIHZWaWV3UG9zaXRpb247XCIsXG5cbiAgICAgICAgXCJcdFx0XHRmbG9hdCBzcG90RWZmZWN0ID0gZG90KCBzcG90TGlnaHREaXJlY3Rpb25bIGkgXSwgbm9ybWFsaXplKCBzcG90TGlnaHRQb3NpdGlvblsgaSBdIC0gdldvcmxkUG9zaXRpb24gKSApO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0aWYgKCBzcG90RWZmZWN0ID4gc3BvdExpZ2h0QW5nbGVDb3NbIGkgXSApIHtcIixcblxuICAgICAgICBcIlx0XHRcdFx0c3BvdEVmZmVjdCA9IG1heCggcG93KCBzcG90RWZmZWN0LCBzcG90TGlnaHRFeHBvbmVudFsgaSBdICksIDAuMCApO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0XHRmbG9hdCBsRGlzdGFuY2UgPSAxLjA7XCIsXG4gICAgICAgIFwiXHRcdFx0XHRpZiAoIHNwb3RMaWdodERpc3RhbmNlWyBpIF0gPiAwLjAgKSB7XCIsXG4gICAgICAgIFwiXHRcdFx0XHRcdGxEaXN0YW5jZSA9IDEuMCAtIG1pbiggKCBsZW5ndGgoIGxWZWN0b3IgKSAvIHNwb3RMaWdodERpc3RhbmNlWyBpIF0gKSwgMS4wICk7XCIsXG4gICAgICAgIFwiXHRcdFx0XHR9XCIsXG5cbiAgICAgICAgXCJcdFx0XHRcdGxWZWN0b3IgPSBub3JtYWxpemUoIGxWZWN0b3IgKTtcIixcblxuICAgICAgICBcIlx0XHRcdFx0ZmxvYXQgZG90UHJvZHVjdCA9IGRvdCggbm9ybWFsLCBsVmVjdG9yICk7XCIsXG4gICAgICAgIFwiXHRcdFx0XHR2ZWMzIHNwb3RMaWdodFdlaWdodGluZyA9IHZlYzMoIG1heCggZG90UHJvZHVjdCwgMC4wICkgKTtcIixcblxuICAgICAgICBcIlx0XHRcdFx0ZGlmZnVzZUxpZ2h0ICs9IHNwb3RMaWdodENvbG9yWyBpIF0gKiBzcG90TGlnaHRXZWlnaHRpbmcgKiBsRGlzdGFuY2UgKiBzcG90RWZmZWN0O1wiLFxuXG4gICAgICAgIFwiXHRcdFx0XHR2ZWMzIHNwb3RIYWxmVmVjdG9yID0gbm9ybWFsaXplKCBsVmVjdG9yICsgdlZpZXdQb3NpdGlvbiApO1wiLFxuICAgICAgICBcIlx0XHRcdFx0ZmxvYXQgc3BvdERpZmZ1c2VXZWlnaHQgPSBtYXgoIGRvdFByb2R1Y3QsIDAuMCApO1wiLFxuICAgICAgICBcIlx0XHRcdFx0ZmxvYXQgc3BvdERvdE5vcm1hbEhhbGYgPSBtYXgoIGRvdCggbm9ybWFsLCBzcG90SGFsZlZlY3RvciApLCAwLjAgKTtcIixcbiAgICAgICAgXCJcdFx0XHRcdGZsb2F0IHNwb3RTcGVjdWxhcldlaWdodCA9IHNwZWN1bGFyU3RyZW5ndGggKiBtYXgoIHBvdyggc3BvdERvdE5vcm1hbEhhbGYsIHNoaW5pbmVzcyApLCAwLjAgKTtcIixcblxuICAgICAgICBcIlx0XHRcdFx0ZmxvYXQgc3BlY3VsYXJOb3JtYWxpemF0aW9uID0gKCBzaGluaW5lc3MgKyAyLjAwMDEgKSAvIDguMDtcIixcblxuICAgICAgICBcIlx0XHRcdFx0dmVjMyBzY2hsaWNrID0gc3BlY3VsYXJDb2xvciArIHZlYzMoIDEuMCAtIHNwZWN1bGFyQ29sb3IgKSAqIHBvdyggMS4wIC0gZG90KCBsVmVjdG9yLCBzcG90SGFsZlZlY3RvciApLCA1LjAgKTtcIixcbiAgICAgICAgXCJcdFx0XHRcdHNwZWN1bGFyTGlnaHQgKz0gc2NobGljayAqIHNwb3RMaWdodENvbG9yWyBpIF0gKiBzcG90U3BlY3VsYXJXZWlnaHQgKiBzcG90RGlmZnVzZVdlaWdodCAqIGxEaXN0YW5jZSAqIHNwZWN1bGFyTm9ybWFsaXphdGlvbiAqIHNwb3RFZmZlY3Q7XCIsXG4gICAgICAgIFwiXHRcdFx0fVwiLFxuXG4gICAgICAgIFwiXHRcdH1cIixcbiAgICAgICAgXCJcdCNlbmRpZlwiLFxuXG4gICAgICAgIFwiXHQjaWYgTUFYX0hFTUlfTElHSFRTID4gMFwiLFxuICAgICAgICBcIlx0XHRmb3IoIGludCBpID0gMDsgaSA8IE1BWF9IRU1JX0xJR0hUUzsgaSArKyApIHtcIixcblxuICAgICAgICBcIlx0XHRcdHZlYzQgbERpcmVjdGlvbiA9IHZpZXdNYXRyaXggKiB2ZWM0KCBoZW1pTGlnaHREaXJlY3Rpb25bIGkgXSwgMC4wICk7XCIsXG4gICAgICAgIFwiXHRcdFx0dmVjMyBsVmVjdG9yID0gbm9ybWFsaXplKCBsRGlyZWN0aW9uLnh5eiApO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgZG90UHJvZHVjdCA9IGRvdCggbm9ybWFsLCBsVmVjdG9yICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRmbG9hdCBoZW1pRGlmZnVzZVdlaWdodCA9IDAuNSAqIGRvdFByb2R1Y3QgKyAwLjU7XCIsXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgaGVtaURpZmZ1c2VXZWlnaHRCYWNrID0gLTAuNSAqIGRvdFByb2R1Y3QgKyAwLjU7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRkaWZmdXNlTGlnaHQgKz0gaGVtaUxpZ2h0Q29sb3JbIGkgXSAqIGhlbWlEaWZmdXNlV2VpZ2h0O1wiLFxuXG4gICAgICAgIFwiXHRcdFx0dmVjMyBoZW1pSGFsZlZlY3RvciA9IG5vcm1hbGl6ZSggbFZlY3RvciArIHZWaWV3UG9zaXRpb24gKTtcIixcbiAgICAgICAgXCJcdFx0XHRmbG9hdCBoZW1pRG90Tm9ybWFsSGFsZiA9IG1heCggZG90KCBub3JtYWwsIGhlbWlIYWxmVmVjdG9yICksIDAuMCApO1wiLFxuICAgICAgICBcIlx0XHRcdGZsb2F0IGhlbWlTcGVjdWxhcldlaWdodCA9IHNwZWN1bGFyU3RyZW5ndGggKiBtYXgoIHBvdyggaGVtaURvdE5vcm1hbEhhbGYsIHNoaW5pbmVzcyApLCAwLjAgKTtcIixcblxuICAgICAgICBcIlx0XHRcdGZsb2F0IHNwZWN1bGFyTm9ybWFsaXphdGlvbiA9ICggc2hpbmluZXNzICsgMi4wMDAxICkgLyA4LjA7XCIsXG4gICAgICAgIFwiXHRcdFx0dmVjMyBzY2hsaWNrID0gc3BlY3VsYXJDb2xvciArIHZlYzMoIDEuMCAtIHNwZWN1bGFyQ29sb3IgKSAqIHBvdyggMS4wIC0gZG90KCBsVmVjdG9yLCBoZW1pSGFsZlZlY3RvciApLCA1LjAgKTtcIixcbiAgICAgICAgXCJcdFx0XHRzcGVjdWxhckxpZ2h0ICs9IHNjaGxpY2sgKiBoZW1pTGlnaHRDb2xvclsgaSBdICogaGVtaVNwZWN1bGFyV2VpZ2h0ICogaGVtaURpZmZ1c2VXZWlnaHQgKiBzcGVjdWxhck5vcm1hbGl6YXRpb247XCIsXG4gICAgICAgIFwiXHRcdH1cIixcbiAgICAgICAgXCJcdCNlbmRpZlwiLFxuXG4gICAgICAgIFwiXHRkaWZmdXNlTGlnaHQgKz0gYW1iaWVudDtcIixcbiAgICAgICAgXCJ9XCIsXG4gICAgICAgIFwiXCJcbiAgICBdLmpvaW4oXCJcXG5cIiksXG5cbiAgICBQaXhlbExpZ2h0Tm9TcGVjOiBbXG4gICAgICAgIFwidmVjMyBQaXhlbExpZ2h0Tm9TcGVjKHZlYzMgbm9ybWFsKSB7XCIsXG4gICAgICAgIFwiXHR2ZWMzIGRpZmZ1c2VMaWdodDtcIixcblxuICAgICAgICBcIlx0I2lmIE1BWF9ESVJfTElHSFRTID4gMFwiLFxuICAgICAgICBcIlx0XHRmb3IoIGludCBpID0gMDsgaSA8IE1BWF9ESVJfTElHSFRTOyBpICsrICkge1wiLFxuXG4gICAgICAgIFwiXHRcdFx0dmVjNCBsRGlyZWN0aW9uID0gdmlld01hdHJpeCAqIHZlYzQoIGRpcmVjdGlvbmFsTGlnaHREaXJlY3Rpb25bIGkgXSwgMC4wICk7XCIsXG4gICAgICAgIFwiXHRcdFx0dmVjMyBkaXJWZWN0b3IgPSBub3JtYWxpemUoIGxEaXJlY3Rpb24ueHl6ICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRmbG9hdCBkb3RQcm9kdWN0ID0gZG90KCBub3JtYWwsIGRpclZlY3RvciApO1wiLFxuICAgICAgICBcIlx0XHRcdHZlYzMgZGlyZWN0aW9uYWxMaWdodFdlaWdodGluZyA9IHZlYzMoIG1heCggZG90UHJvZHVjdCwgMC4wICkgKTtcIixcblxuICAgICAgICBcIlx0XHRcdGRpZmZ1c2VMaWdodCArPSBkaXJlY3Rpb25hbExpZ2h0Q29sb3JbIGkgXSAqIGRpcmVjdGlvbmFsTGlnaHRXZWlnaHRpbmc7XCIsXG4gICAgICAgIFwiXHRcdH1cIixcbiAgICAgICAgXCJcdCNlbmRpZlwiLFxuXG4gICAgICAgIFwiXHQjaWYgTUFYX1BPSU5UX0xJR0hUUyA+IDBcIixcbiAgICAgICAgXCJcdFx0Zm9yKCBpbnQgaSA9IDA7IGkgPCBNQVhfUE9JTlRfTElHSFRTOyBpICsrICkge1wiLFxuXG4gICAgICAgIFwiXHRcdFx0dmVjNCBsUG9zaXRpb24gPSB2aWV3TWF0cml4ICogdmVjNCggcG9pbnRMaWdodFBvc2l0aW9uWyBpIF0sIDEuMCApO1wiLFxuICAgICAgICBcIlx0XHRcdHZlYzMgbFZlY3RvciA9IGxQb3NpdGlvbi54eXogKyB2Vmlld1Bvc2l0aW9uO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgbERpc3RhbmNlID0gMS4wO1wiLFxuICAgICAgICBcIlx0XHRcdGlmICggcG9pbnRMaWdodERpc3RhbmNlWyBpIF0gPiAwLjAgKSB7XCIsXG4gICAgICAgIFwiXHRcdFx0XHRsRGlzdGFuY2UgPSAxLjAgLSBtaW4oICggbGVuZ3RoKCBsVmVjdG9yICkgLyBwb2ludExpZ2h0RGlzdGFuY2VbIGkgXSApLCAxLjAgKTtcIixcbiAgICAgICAgXCJcdFx0XHR9XCIsXG5cbiAgICAgICAgXCJcdFx0XHRsVmVjdG9yID0gbm9ybWFsaXplKCBsVmVjdG9yICk7XCIsXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgZG90UHJvZHVjdCA9IGRvdCggbm9ybWFsLCBsVmVjdG9yICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHR2ZWMzIHBvaW50TGlnaHRXZWlnaHRpbmcgPSB2ZWMzKCBtYXgoIGRvdFByb2R1Y3QsIDAuMCApICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRkaWZmdXNlTGlnaHQgKz0gcG9pbnRMaWdodENvbG9yWyBpIF0gKiBwb2ludExpZ2h0V2VpZ2h0aW5nICogbERpc3RhbmNlO1wiLFxuICAgICAgICBcIlx0XHR9XCIsXG4gICAgICAgIFwiXHQjZW5kaWZcIixcblxuICAgICAgICBcIlx0I2lmIE1BWF9TUE9UX0xJR0hUUyA+IDBcIixcbiAgICAgICAgXCJcdFx0Zm9yKCBpbnQgaSA9IDA7IGkgPCBNQVhfU1BPVF9MSUdIVFM7IGkgKysgKSB7XCIsXG5cbiAgICAgICAgXCJcdFx0XHR2ZWM0IGxQb3NpdGlvbiA9IHZpZXdNYXRyaXggKiB2ZWM0KCBzcG90TGlnaHRQb3NpdGlvblsgaSBdLCAxLjAgKTtcIixcbiAgICAgICAgXCJcdFx0XHR2ZWMzIGxWZWN0b3IgPSBsUG9zaXRpb24ueHl6ICsgdlZpZXdQb3NpdGlvbjtcIixcblxuICAgICAgICBcIlx0XHRcdGZsb2F0IHNwb3RFZmZlY3QgPSBkb3QoIHNwb3RMaWdodERpcmVjdGlvblsgaSBdLCBub3JtYWxpemUoIHNwb3RMaWdodFBvc2l0aW9uWyBpIF0gLSB2V29ybGRQb3NpdGlvbiApICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRpZiAoIHNwb3RFZmZlY3QgPiBzcG90TGlnaHRBbmdsZUNvc1sgaSBdICkge1wiLFxuXG4gICAgICAgIFwiXHRcdFx0XHRzcG90RWZmZWN0ID0gbWF4KCBwb3coIHNwb3RFZmZlY3QsIHNwb3RMaWdodEV4cG9uZW50WyBpIF0gKSwgMC4wICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRcdGZsb2F0IGxEaXN0YW5jZSA9IDEuMDtcIixcbiAgICAgICAgXCJcdFx0XHRcdGlmICggc3BvdExpZ2h0RGlzdGFuY2VbIGkgXSA+IDAuMCApIHtcIixcbiAgICAgICAgXCJcdFx0XHRcdFx0bERpc3RhbmNlID0gMS4wIC0gbWluKCAoIGxlbmd0aCggbFZlY3RvciApIC8gc3BvdExpZ2h0RGlzdGFuY2VbIGkgXSApLCAxLjAgKTtcIixcbiAgICAgICAgXCJcdFx0XHRcdH1cIixcblxuICAgICAgICBcIlx0XHRcdFx0bFZlY3RvciA9IG5vcm1hbGl6ZSggbFZlY3RvciApO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0XHRmbG9hdCBkb3RQcm9kdWN0ID0gZG90KCBub3JtYWwsIGxWZWN0b3IgKTtcIixcbiAgICAgICAgXCJcdFx0XHRcdHZlYzMgc3BvdExpZ2h0V2VpZ2h0aW5nID0gdmVjMyggbWF4KCBkb3RQcm9kdWN0LCAwLjAgKSApO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0XHRkaWZmdXNlTGlnaHQgKz0gc3BvdExpZ2h0Q29sb3JbIGkgXSAqIHNwb3RMaWdodFdlaWdodGluZyAqIGxEaXN0YW5jZSAqIHNwb3RFZmZlY3Q7XCIsXG4gICAgICAgIFwiXHRcdFx0fVwiLFxuXG4gICAgICAgIFwiXHRcdH1cIixcbiAgICAgICAgXCJcdCNlbmRpZlwiLFxuXG4gICAgICAgIFwiXHQjaWYgTUFYX0hFTUlfTElHSFRTID4gMFwiLFxuICAgICAgICBcIlx0XHRmb3IoIGludCBpID0gMDsgaSA8IE1BWF9IRU1JX0xJR0hUUzsgaSArKyApIHtcIixcblxuICAgICAgICBcIlx0XHRcdHZlYzQgbERpcmVjdGlvbiA9IHZpZXdNYXRyaXggKiB2ZWM0KCBoZW1pTGlnaHREaXJlY3Rpb25bIGkgXSwgMC4wICk7XCIsXG4gICAgICAgIFwiXHRcdFx0dmVjMyBsVmVjdG9yID0gbm9ybWFsaXplKCBsRGlyZWN0aW9uLnh5eiApO1wiLFxuXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgZG90UHJvZHVjdCA9IGRvdCggbm9ybWFsLCBsVmVjdG9yICk7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRmbG9hdCBoZW1pRGlmZnVzZVdlaWdodCA9IDAuNSAqIGRvdFByb2R1Y3QgKyAwLjU7XCIsXG4gICAgICAgIFwiXHRcdFx0ZmxvYXQgaGVtaURpZmZ1c2VXZWlnaHRCYWNrID0gLTAuNSAqIGRvdFByb2R1Y3QgKyAwLjU7XCIsXG5cbiAgICAgICAgXCJcdFx0XHRkaWZmdXNlTGlnaHQgKz0gaGVtaUxpZ2h0Q29sb3JbIGkgXSAqIGhlbWlEaWZmdXNlV2VpZ2h0O1wiLFxuICAgICAgICBcIlx0XHR9XCIsXG4gICAgICAgIFwiXHQjZW5kaWZcIixcblxuICAgICAgICBcIlx0ZGlmZnVzZUxpZ2h0ICs9IGFtYmllbnQ7XCIsXG5cbiAgICAgICAgXCJcdHJldHVybiBkaWZmdXNlTGlnaHQ7XCIsXG4gICAgICAgIFwifVwiLFxuICAgICAgICBcIlwiXG4gICAgXS5qb2luKFwiXFxuXCIpXG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gU2hhZGVyQ2h1bmtzO1xuIiwidmFyIENsYXNzID0gcmVxdWlyZShcIi4uL2Jhc2UvY2xhc3NcIik7XG52YXIgR2FtZU9iamVjdCA9IHJlcXVpcmUoXCIuL2dhbWVfb2JqZWN0XCIpO1xudmFyIENvbXBvbmVudE1hbmFnZXIgPSByZXF1aXJlKFwiLi9jb21wb25lbnRfbWFuYWdlcnMvY29tcG9uZW50X21hbmFnZXJcIik7XG52YXIgV29ybGQgPSByZXF1aXJlKFwiLi93b3JsZC93b3JsZFwiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi8uLi9iYXNlL2xvZ1wiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbi8qKlxuICogU2NlbmVzIG1hbmFnZSBHYW1lT2JqZWN0cyBhbmQgdGhlaXIgQ29tcG9uZW50c1xuICogQGNsYXNzIE9kaW4uU2NlbmVcbiAqIEBleHRlbmRzIE9kaW4uQ2xhc3NcbiAqIEBwYXJhbSBPYmplY3Qgb3B0aW9uc1xuICovXG5mdW5jdGlvbiBTY2VuZShvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIENsYXNzLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLmdhbWUgPSB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLm5hbWUgPSBvcHRzLm5hbWUgIT0gdW5kZWZpbmVkID8gb3B0cy5uYW1lIDogXCJTY2VuZV9cIiArIHRoaXMuX2lkO1xuXG4gICAgdGhpcy53b3JsZCA9IHVuZGVmaW5lZDtcblxuICAgIHRoaXMuZ2FtZU9iamVjdHMgPSBbXTtcbiAgICB0aGlzLl9nYW1lT2JqZWN0SGFzaCA9IHt9O1xuICAgIHRoaXMuX2dhbWVPYmplY3RKU09OSGFzaCA9IHt9O1xuXG4gICAgdGhpcy5jb21wb25lbnRNYW5hZ2VycyA9IHt9O1xuICAgIHRoaXMuX2NvbXBvbmVudE1hbmFnZXJUeXBlcyA9IFtdO1xuICAgIHRoaXMuX2NvbXBvbmVudEhhc2ggPSB7fTtcbiAgICB0aGlzLl9jb21wb25lbnRKU09OSGFzaCA9IHt9O1xuXG4gICAgdGhpcy5zZXRXb3JsZChvcHRzLndvcmxkIGluc3RhbmNlb2YgV29ybGQgPyBvcHRzLndvcmxkIDogbmV3IFdvcmxkKG9wdHMud29ybGQpKTtcbiAgICBpZiAob3B0cy5nYW1lT2JqZWN0cykgdGhpcy5hZGRHYW1lT2JqZWN0cy5hcHBseSh0aGlzLCBvcHRzLmdhbWVPYmplY3RzKTtcbn1cblxuQ2xhc3MuZXh0ZW5kKFNjZW5lKTtcblxuXG5TY2VuZS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciBvdGhlckdhbWVPYmplY3RzID0gb3RoZXIuZ2FtZU9iamVjdHMsXG4gICAgICAgIGkgPSBvdGhlckdhbWVPYmplY3RzLmxlbmd0aDtcblxuICAgIHRoaXMuY2xlYXIoKTtcbiAgICB0aGlzLm5hbWUgPSBvdGhlci5uYW1lICsgXCIuXCIgKyB0aGlzLl9pZDtcblxuICAgIHdoaWxlIChpLS0pIHRoaXMuYWRkR2FtZU9iamVjdChvdGhlckdhbWVPYmplY3RzW2ldLmNsb25lKCkpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblNjZW5lLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBnYW1lT2JqZWN0cyA9IHRoaXMuZ2FtZU9iamVjdHMsXG4gICAgICAgIGksIGlsO1xuXG4gICAgdGhpcy53b3JsZCAmJiB0aGlzLndvcmxkLmluaXQoKTtcblxuICAgIGZvciAoaSA9IDAsIGlsID0gZ2FtZU9iamVjdHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgZ2FtZU9iamVjdHNbaV0uZW1pdChcImluaXRcIik7XG59O1xuXG5cblNjZW5lLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY29tcG9uZW50TWFuYWdlclR5cGVzID0gdGhpcy5fY29tcG9uZW50TWFuYWdlclR5cGVzLFxuICAgICAgICBnYW1lT2JqZWN0cyA9IHRoaXMuZ2FtZU9iamVjdHMsXG4gICAgICAgIGksIGlsO1xuXG4gICAgdGhpcy53b3JsZCAmJiB0aGlzLndvcmxkLnN0YXJ0KCk7XG5cbiAgICBmb3IgKGkgPSAwLCBpbCA9IGNvbXBvbmVudE1hbmFnZXJUeXBlcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBjb21wb25lbnRNYW5hZ2VyVHlwZXNbaV0uc3RhcnQoKTtcbiAgICBmb3IgKGkgPSAwLCBpbCA9IGdhbWVPYmplY3RzLmxlbmd0aDsgaSA8IGlsOyBpKyspIGdhbWVPYmplY3RzW2ldLmVtaXQoXCJzdGFydFwiKTtcbn07XG5cblxuU2NlbmUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY29tcG9uZW50TWFuYWdlclR5cGVzID0gdGhpcy5fY29tcG9uZW50TWFuYWdlclR5cGVzLFxuICAgICAgICBjb21wb25lbnRNYW5hZ2VyVHlwZSwgaSwgaWw7XG5cbiAgICB0aGlzLndvcmxkICYmIHRoaXMud29ybGQudXBkYXRlKCk7XG5cbiAgICBmb3IgKGkgPSAwLCBpbCA9IGNvbXBvbmVudE1hbmFnZXJUeXBlcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7XG4gICAgICAgIGlmICgoY29tcG9uZW50TWFuYWdlclR5cGUgPSBjb21wb25lbnRNYW5hZ2VyVHlwZXNbaV0pKSBjb21wb25lbnRNYW5hZ2VyVHlwZS51cGRhdGUoKTtcbiAgICB9XG59O1xuXG5cblNjZW5lLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZ2FtZU9iamVjdHMgPSB0aGlzLmdhbWVPYmplY3RzLFxuICAgICAgICBpID0gZ2FtZU9iamVjdHMubGVuZ3RoO1xuXG4gICAgdGhpcy5yZW1vdmVXb3JsZCgpO1xuICAgIHdoaWxlIChpLS0pIHRoaXMucmVtb3ZlR2FtZU9iamVjdChnYW1lT2JqZWN0c1tpXSwgdHJ1ZSk7XG5cbiAgICB0aGlzLm9mZigpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblNjZW5lLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5lbWl0KFwiZGVzdHJveVwiKTtcbiAgICB0aGlzLmNsZWFyKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuU2NlbmUucHJvdG90eXBlLnNldFdvcmxkID0gZnVuY3Rpb24gKHdvcmxkKSB7XG4gICAgaWYgKHRoaXMud29ybGQpIHRoaXMucmVtb3ZlV29ybGQoKTtcblxuICAgIHdvcmxkLnNjZW5lID0gdGhpcztcbiAgICB0aGlzLndvcmxkID0gd29ybGQ7XG5cbiAgICBpZiAodGhpcy5nYW1lKSB3b3JsZC5pbml0KCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuU2NlbmUucHJvdG90eXBlLnJlbW92ZVdvcmxkID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy53b3JsZCkgcmV0dXJuIHRoaXM7XG4gICAgdmFyIHdvcmxkID0gdGhpcy53b3JsZDtcblxuICAgIHdvcmxkLnNjZW5lID0gdW5kZWZpbmVkO1xuICAgIHRoaXMud29ybGQgPSB1bmRlZmluZWQ7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuU2NlbmUucHJvdG90eXBlLmFkZEdhbWVPYmplY3QgPSBmdW5jdGlvbiAoZ2FtZU9iamVjdCkge1xuICAgIGlmICghKGdhbWVPYmplY3QgaW5zdGFuY2VvZiBHYW1lT2JqZWN0KSkge1xuICAgICAgICBMb2cuZXJyb3IoXCJTY2VuZS5hZGRHYW1lT2JqZWN0OiBjYW4ndCBhZGQgYXJndW1lbnQgdG8gU2NlbmUsIGl0J3Mgbm90IGFuIGluc3RhbmNlIG9mIEdhbWVPYmplY3RcIik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB2YXIgZ2FtZU9iamVjdHMgPSB0aGlzLmdhbWVPYmplY3RzLFxuICAgICAgICBpbmRleCA9IGdhbWVPYmplY3RzLmluZGV4T2YoZ2FtZU9iamVjdCksXG4gICAgICAgIGNvbXBvbmVudHMsIHRyYW5zZm9ybSwgY2hpbGRyZW4sIGNoaWxkLFxuICAgICAgICBpO1xuXG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICBpZiAoZ2FtZU9iamVjdC5zY2VuZSkgZ2FtZU9iamVjdC5zY2VuZS5yZW1vdmVHYW1lT2JqZWN0KGdhbWVPYmplY3QpO1xuXG4gICAgICAgIGdhbWVPYmplY3RzLnB1c2goZ2FtZU9iamVjdCk7XG4gICAgICAgIHRoaXMuX2dhbWVPYmplY3RIYXNoW2dhbWVPYmplY3QuX2lkXSA9IGdhbWVPYmplY3Q7XG4gICAgICAgIGlmIChnYW1lT2JqZWN0Ll9qc29uSWQgIT09IC0xKSB0aGlzLl9nYW1lT2JqZWN0SlNPTkhhc2hbZ2FtZU9iamVjdC5fanNvbklkXSA9IGdhbWVPYmplY3Q7XG5cbiAgICAgICAgZ2FtZU9iamVjdC5zY2VuZSA9IHRoaXM7XG5cbiAgICAgICAgY29tcG9uZW50cyA9IGdhbWVPYmplY3QuY29tcG9uZW50cztcbiAgICAgICAgaSA9IGNvbXBvbmVudHMubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaS0tKSB0aGlzLl9hZGRDb21wb25lbnQoY29tcG9uZW50c1tpXSk7XG5cbiAgICAgICAgaWYgKCh0cmFuc2Zvcm0gPSBnYW1lT2JqZWN0LnRyYW5zZm9ybSB8fCBnYW1lT2JqZWN0LnRyYW5zZm9ybTJkKSkge1xuICAgICAgICAgICAgaSA9IChjaGlsZHJlbiA9IHRyYW5zZm9ybS5jaGlsZHJlbikubGVuZ3RoO1xuXG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgaWYgKChjaGlsZCA9IGNoaWxkcmVuW2ldLmdhbWVPYmplY3QpICYmICF0aGlzLmhhc0dhbWVPYmplY3QoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkR2FtZU9iamVjdChjaGlsZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZ2FtZSkgZ2FtZU9iamVjdC5lbWl0KFwiaW5pdFwiKTtcbiAgICAgICAgdGhpcy5lbWl0KFwiYWRkR2FtZU9iamVjdFwiLCBnYW1lT2JqZWN0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBMb2cuZXJyb3IoXCJTY2VuZS5hZGRHYW1lT2JqZWN0OiBHYW1lT2JqZWN0IGlzIGFscmVhZHkgYSBtZW1iZXIgb2YgU2NlbmVcIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblNjZW5lLnByb3RvdHlwZS5hZGRHYW1lT2JqZWN0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSA9IDAsXG4gICAgICAgIGlsID0gYXJndW1lbnRzLmxlbmd0aDtcblxuICAgIGZvciAoOyBpIDwgaWw7IGkrKykgdGhpcy5hZGRHYW1lT2JqZWN0KGFyZ3VtZW50c1tpXSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblNjZW5lLnByb3RvdHlwZS5fYWRkQ29tcG9uZW50ID0gZnVuY3Rpb24gKGNvbXBvbmVudCkge1xuICAgIGlmICghY29tcG9uZW50KSByZXR1cm47XG4gICAgdmFyIHR5cGUgPSBjb21wb25lbnQuX3R5cGUsXG4gICAgICAgIGNvbXBvbmVudE1hbmFnZXJzID0gdGhpcy5jb21wb25lbnRNYW5hZ2VycyxcbiAgICAgICAgY29tcG9uZW50TWFuYWdlciA9IGNvbXBvbmVudE1hbmFnZXJzW3R5cGVdLFxuICAgICAgICBjb21wb25lbnRNYW5hZ2VyVHlwZXMgPSB0aGlzLl9jb21wb25lbnRNYW5hZ2VyVHlwZXMsXG4gICAgICAgIGlzTmV3ID0gIWNvbXBvbmVudE1hbmFnZXI7XG5cbiAgICBpZiAoaXNOZXcpIHtcbiAgICAgICAgY29tcG9uZW50TWFuYWdlciA9IGNvbXBvbmVudE1hbmFnZXJzW3R5cGVdID0gbmV3IChDbGFzcy5fY2xhc3Nlc1t0eXBlICsgXCJDb21wb25lbnRNYW5hZ2VyXCJdIHx8IENvbXBvbmVudE1hbmFnZXIpO1xuICAgICAgICBjb21wb25lbnRNYW5hZ2VyVHlwZXMucHVzaChjb21wb25lbnRNYW5hZ2VyKTtcbiAgICAgICAgY29tcG9uZW50TWFuYWdlclR5cGVzLnNvcnQoc29ydENvbXBvbmVudE1hbmFnZXJUeXBlcyk7XG4gICAgICAgIGNvbXBvbmVudE1hbmFnZXIuc2NlbmUgPSB0aGlzO1xuICAgIH1cblxuICAgIGNvbXBvbmVudE1hbmFnZXIuYWRkKGNvbXBvbmVudCk7XG4gICAgY29tcG9uZW50TWFuYWdlci5zb3J0KCk7XG5cbiAgICB0aGlzLl9jb21wb25lbnRIYXNoW2NvbXBvbmVudC5faWRdID0gY29tcG9uZW50O1xuICAgIGlmIChjb21wb25lbnQuX2pzb25JZCAhPT0gLTEpIHRoaXMuX2NvbXBvbmVudEpTT05IYXNoW2NvbXBvbmVudC5fanNvbklkXSA9IGNvbXBvbmVudDtcblxuICAgIHRoaXMuZW1pdChcImFkZFwiICsgdHlwZSwgY29tcG9uZW50KTtcbiAgICB0aGlzLmVtaXQoXCJhZGRDb21wb25lbnRcIiwgY29tcG9uZW50KTtcblxuICAgIGlmICh0aGlzLmdhbWUpIHtcbiAgICAgICAgY29tcG9uZW50LnN0YXJ0KCk7XG4gICAgICAgIGNvbXBvbmVudC5lbWl0KFwic3RhcnRcIik7XG4gICAgfVxufTtcblxuXG5mdW5jdGlvbiBzb3J0Q29tcG9uZW50TWFuYWdlclR5cGVzKGEsIGIpIHtcblxuICAgIHJldHVybiBhLm9yZGVyIC0gYi5vcmRlcjtcbn1cblxuXG5TY2VuZS5wcm90b3R5cGUucmVtb3ZlR2FtZU9iamVjdCA9IGZ1bmN0aW9uIChnYW1lT2JqZWN0LCBjbGVhcikge1xuICAgIGlmICghKGdhbWVPYmplY3QgaW5zdGFuY2VvZiBHYW1lT2JqZWN0KSkge1xuICAgICAgICBMb2cuZXJyb3IoXCJTY2VuZS5yZW1vdmVHYW1lT2JqZWN0OiBjYW4ndCByZW1vdmUgYXJndW1lbnQgZnJvbSBTY2VuZSwgaXQncyBub3QgYW4gaW5zdGFuY2Ugb2YgR2FtZU9iamVjdFwiKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHZhciBnYW1lT2JqZWN0cyA9IHRoaXMuZ2FtZU9iamVjdHMsXG4gICAgICAgIGluZGV4ID0gZ2FtZU9iamVjdHMuaW5kZXhPZihnYW1lT2JqZWN0KSxcbiAgICAgICAgY29tcG9uZW50cywgdHJhbnNmb3JtLCBjaGlsZHJlbiwgY2hpbGQsXG4gICAgICAgIGk7XG5cbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG5cbiAgICAgICAgZ2FtZU9iamVjdHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5fZ2FtZU9iamVjdEhhc2hbZ2FtZU9iamVjdC5faWRdID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoZ2FtZU9iamVjdC5fanNvbklkICE9PSAtMSkgdGhpcy5fZ2FtZU9iamVjdEpTT05IYXNoW2dhbWVPYmplY3QuX2pzb25JZF0gPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgZ2FtZU9iamVjdC5zY2VuZSA9IHVuZGVmaW5lZDtcblxuICAgICAgICBjb21wb25lbnRzID0gZ2FtZU9iamVjdC5jb21wb25lbnRzO1xuICAgICAgICBpID0gY29tcG9uZW50cy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpLS0pIHRoaXMuX3JlbW92ZUNvbXBvbmVudChjb21wb25lbnRzW2ldLCBjbGVhcik7XG5cbiAgICAgICAgaWYgKCh0cmFuc2Zvcm0gPSBnYW1lT2JqZWN0LnRyYW5zZm9ybSB8fCBnYW1lT2JqZWN0LnRyYW5zZm9ybTJkKSkge1xuICAgICAgICAgICAgaSA9IChjaGlsZHJlbiA9IHRyYW5zZm9ybS5jaGlsZHJlbikubGVuZ3RoO1xuXG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgaWYgKChjaGlsZCA9IGNoaWxkcmVuW2ldLmdhbWVPYmplY3QpICYmIHRoaXMuaGFzR2FtZU9iamVjdChjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVHYW1lT2JqZWN0KGNoaWxkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVtaXQoXCJyZW1vdmVHYW1lT2JqZWN0XCIsIGdhbWVPYmplY3QpO1xuICAgICAgICBnYW1lT2JqZWN0LmVtaXQoXCJyZW1vdmVcIiwgZ2FtZU9iamVjdCk7XG4gICAgICAgIGlmIChjbGVhcikgZ2FtZU9iamVjdC5jbGVhcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIlNjZW5lLnJlbW92ZUdhbWVPYmplY3Q6IEdhbWVPYmplY3QgaXMgbm90IGEgbWVtYmVyIG9mIFNjZW5lXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5TY2VuZS5wcm90b3R5cGUucmVtb3ZlR2FtZU9iamVjdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGkgPSAwLFxuICAgICAgICBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cbiAgICBmb3IgKDsgaSA8IGlsOyBpKyspIHRoaXMucmVtb3ZlR2FtZU9iamVjdChhcmd1bWVudHNbaV0pO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5TY2VuZS5wcm90b3R5cGUuX3JlbW92ZUNvbXBvbmVudCA9IGZ1bmN0aW9uIChjb21wb25lbnQsIGNsZWFyKSB7XG4gICAgaWYgKCFjb21wb25lbnQpIHJldHVybjtcbiAgICB2YXIgdHlwZSA9IGNvbXBvbmVudC5fdHlwZSxcbiAgICAgICAgY29tcG9uZW50TWFuYWdlcnMgPSB0aGlzLmNvbXBvbmVudE1hbmFnZXJzLFxuICAgICAgICBjb21wb25lbnRNYW5hZ2VyID0gY29tcG9uZW50TWFuYWdlcnNbdHlwZV0sXG4gICAgICAgIGNvbXBvbmVudE1hbmFnZXJUeXBlcyA9IHRoaXMuX2NvbXBvbmVudE1hbmFnZXJUeXBlcztcblxuICAgIGNvbXBvbmVudE1hbmFnZXIucmVtb3ZlKGNvbXBvbmVudCk7XG4gICAgdGhpcy5fY29tcG9uZW50SGFzaFtjb21wb25lbnQuX2lkXSA9IHVuZGVmaW5lZDtcbiAgICBpZiAoY29tcG9uZW50Ll9qc29uSWQgIT09IC0xKSB0aGlzLl9jb21wb25lbnRKU09OSGFzaFtjb21wb25lbnQuX2pzb25JZF0gPSB1bmRlZmluZWQ7XG5cbiAgICBpZiAoY29tcG9uZW50TWFuYWdlci5lbXB0eSgpKSB7XG4gICAgICAgIGNvbXBvbmVudE1hbmFnZXJzW3R5cGVdID0gdW5kZWZpbmVkO1xuICAgICAgICBjb21wb25lbnRNYW5hZ2VyVHlwZXMuc3BsaWNlKGNvbXBvbmVudE1hbmFnZXJUeXBlcy5pbmRleE9mKGNvbXBvbmVudE1hbmFnZXIpLCAxKTtcbiAgICAgICAgY29tcG9uZW50TWFuYWdlci5zY2VuZSA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB0aGlzLmVtaXQoXCJyZW1vdmVcIiArIHR5cGUsIGNvbXBvbmVudCk7XG4gICAgdGhpcy5lbWl0KFwicmVtb3ZlQ29tcG9uZW50XCIsIGNvbXBvbmVudCk7XG5cbiAgICBpZiAoY2xlYXIpIGNvbXBvbmVudC5jbGVhcigpO1xufTtcblxuXG5TY2VuZS5wcm90b3R5cGUuaGFzR2FtZU9iamVjdCA9IGZ1bmN0aW9uIChnYW1lT2JqZWN0KSB7XG5cbiAgICByZXR1cm4gISF+dGhpcy5nYW1lT2JqZWN0cy5pbmRleE9mKGdhbWVPYmplY3QpO1xufTtcblxuXG5TY2VuZS5wcm90b3R5cGUuZmluZEJ5VGFnID0gZnVuY3Rpb24gKHRhZywgb3V0KSB7XG4gICAgb3V0IHx8IChvdXQgPSBbXSk7XG4gICAgdmFyIGdhbWVPYmplY3RzID0gdGhpcy5nYW1lT2JqZWN0cyxcbiAgICAgICAgZ2FtZU9iamVjdCwgaSA9IGdhbWVPYmplY3RzLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgaWYgKChnYW1lT2JqZWN0ID0gZ2FtZU9iamVjdHNbaV0pLmhhc1RhZyh0YWcpKSBvdXQucHVzaChnYW1lT2JqZWN0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gb3V0O1xufTtcblxuXG5TY2VuZS5wcm90b3R5cGUuZmluZEJ5VGFnRmlyc3QgPSBmdW5jdGlvbiAodGFnKSB7XG4gICAgdmFyIGdhbWVPYmplY3RzID0gdGhpcy5nYW1lT2JqZWN0cyxcbiAgICAgICAgZ2FtZU9iamVjdCwgaSA9IGdhbWVPYmplY3RzLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgaWYgKChnYW1lT2JqZWN0ID0gZ2FtZU9iamVjdHNbaV0pLmhhc1RhZyh0YWcpKSByZXR1cm4gZ2FtZU9iamVjdDtcbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuXG5TY2VuZS5wcm90b3R5cGUuZmluZEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9nYW1lT2JqZWN0SGFzaFtpZF07XG59O1xuXG5cblNjZW5lLnByb3RvdHlwZS5maW5kQnlKU09OSWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9nYW1lT2JqZWN0SlNPTkhhc2hbaWRdO1xufTtcblxuXG5TY2VuZS5wcm90b3R5cGUuZmluZENvbXBvbmVudEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRIYXNoW2lkXTtcbn07XG5cblxuU2NlbmUucHJvdG90eXBlLmZpbmRDb21wb25lbnRCeUpTT05JZCA9IGZ1bmN0aW9uIChpZCkge1xuXG4gICAgcmV0dXJuIHRoaXMuX2NvbXBvbmVudEpTT05IYXNoW2lkXTtcbn07XG5cblxuU2NlbmUucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHZhciBnYW1lT2JqZWN0cyA9IHRoaXMuZ2FtZU9iamVjdHMsXG4gICAgICAgIGNoaWxkLCBpID0gZ2FtZU9iamVjdHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjaGlsZCA9IGdhbWVPYmplY3RzW2ldO1xuXG4gICAgICAgIGlmIChjaGlsZC5uYW1lID09PSBuYW1lKSByZXR1cm4gY2hpbGQ7XG4gICAgICAgIGlmICgoY2hpbGQgPSBjaGlsZC5maW5kKG5hbWUpKSkgcmV0dXJuIGNoaWxkO1xuICAgIH1cblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5cblNjZW5lLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDbGFzcy5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbik7XG4gICAgdmFyIGdhbWVPYmplY3RzID0gdGhpcy5nYW1lT2JqZWN0cyxcbiAgICAgICAganNvbkdhbWVPYmplY3RzID0ganNvbi5nYW1lT2JqZWN0cyB8fCAoanNvbi5nYW1lT2JqZWN0cyA9IFtdKSxcbiAgICAgICAgZ2FtZU9iamVjdCxcbiAgICAgICAgaSA9IGdhbWVPYmplY3RzLmxlbmd0aDtcblxuICAgIGpzb24ubmFtZSA9IHRoaXMubmFtZTtcbiAgICBqc29uLndvcmxkID0gdGhpcy53b3JsZC50b0pTT04oanNvbi53b3JsZCk7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGlmICgoZ2FtZU9iamVjdCA9IGdhbWVPYmplY3RzW2ldKSkganNvbkdhbWVPYmplY3RzW2ldID0gZ2FtZU9iamVjdC50b0pTT04oanNvbkdhbWVPYmplY3RzW2ldKTtcbiAgICB9XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuU2NlbmUucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBDbGFzcy5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcbiAgICB2YXIganNvbkdhbWVPYmplY3RzID0ganNvbi5nYW1lT2JqZWN0cyxcbiAgICAgICAgZ2FtZU9iamVjdCwganNvbkdhbWVPYmplY3QsXG4gICAgICAgIGkgPSBqc29uR2FtZU9iamVjdHMubGVuZ3RoO1xuXG4gICAgdGhpcy5uYW1lID0ganNvbi5uYW1lO1xuXG4gICAgaWYgKHRoaXMud29ybGQuX2NsYXNzTmFtZSA9PT0ganNvbi53b3JsZC5fY2xhc3NOYW1lKSB7XG4gICAgICAgIHRoaXMud29ybGQuZnJvbUpTT04oanNvbi53b3JsZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZXRXb3JsZChDbGFzcy5mcm9tSlNPTihqc29uLndvcmxkKSk7XG4gICAgfVxuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZiAoIShqc29uR2FtZU9iamVjdCA9IGpzb25HYW1lT2JqZWN0c1tpXSkpIGNvbnRpbnVlO1xuXG4gICAgICAgIGlmICgoZ2FtZU9iamVjdCA9IHRoaXMuX2dhbWVPYmplY3RKU09OSGFzaFtqc29uR2FtZU9iamVjdC5faWRdKSkge1xuICAgICAgICAgICAgZ2FtZU9iamVjdC5mcm9tSlNPTihqc29uR2FtZU9iamVjdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFkZEdhbWVPYmplY3QoQ2xhc3MuZnJvbUpTT04oanNvbkdhbWVPYmplY3QpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFNjZW5lO1xuIiwidmFyIENsYXNzID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvY2xhc3NcIik7XG52YXIgQ29sb3IgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9jb2xvclwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIFdvcmxkKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgQ2xhc3MuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMuc2NlbmUgPSB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLmFtYmllbnQgPSBvcHRzLmFtYmllbnQgIT0gdW5kZWZpbmVkID8gb3B0cy5hbWJpZW50IDogbmV3IENvbG9yO1xufVxuXG5DbGFzcy5leHRlbmQoV29ybGQpO1xuXG5cbldvcmxkLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuXG59O1xuXG5cbldvcmxkLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcblxufTtcblxuXG5Xb3JsZC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuXG59O1xuXG5cbldvcmxkLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5Xb3JsZC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuc2NlbmUpIHtcbiAgICAgICAgTG9nLmVycm9yKFwiV29ybGQuZGVzdHJveTogY2FuJ3QgZGVzdHJveSBXb3JsZCBpZiBpdCdzIG5vdCBzZXQgdG8gYSBTY2VuZVwiKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgdGhpcy5zY2VuZS5yZW1vdmVXb3JsZCgpO1xuICAgIHRoaXMuZW1pdChcImRlc3Ryb3lcIik7XG5cbiAgICB0aGlzLmNsZWFyKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuV29ybGQucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiA9IENsYXNzLnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIGpzb24uYW1iaWVudCA9IHRoaXMuYW1iaWVudC50b0pTT04oanNvbi5hbWJpZW50KTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5Xb3JsZC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENsYXNzLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy5hbWJpZW50LmZyb21KU09OKGpzb24uYW1iaWVudCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBXb3JsZDtcbiIsInZhciB1dGlsID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvdXRpbFwiKTtcbnZhciBUaW1lID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvdGltZVwiKTtcbnZhciBDb2xvciA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL2NvbG9yXCIpO1xudmFyIFdvcmxkID0gcmVxdWlyZShcIi4vd29ybGRcIik7XG52YXIgUGh5czJEID0gcmVxdWlyZShcIi4uLy4uL3BoeXMyZC9waHlzMmRcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG5mdW5jdGlvbiBXb3JsZDJEKG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgV29ybGQuY2FsbCh0aGlzLCBvcHRzKTtcblxuICAgIHRoaXMuc3BhY2UgPSBuZXcgUGh5czJELlAyU3BhY2Uob3B0cy5zcGFjZSk7XG59XG5cbldvcmxkLmV4dGVuZChXb3JsZDJEKTtcblxuXG5Xb3JsZDJELnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzcGFjZSA9IHRoaXMuc3BhY2UsXG4gICAgICAgIHNjZW5lID0gdGhpcy5zY2VuZSxcbiAgICAgICAgUmlnaWRCb2RpZXMgPSBzY2VuZS5jb21wb25lbnRNYW5hZ2Vycy5SaWdpZEJvZHkyRDtcblxuICAgIGZ1bmN0aW9uIGFkZEJvZHkoY29tcG9uZW50KSB7XG5cbiAgICAgICAgc3BhY2UuYWRkQm9keShjb21wb25lbnQuYm9keSk7XG4gICAgfVxuXG4gICAgaWYgKFJpZ2lkQm9kaWVzKSBSaWdpZEJvZGllcy5mb3JFYWNoKGFkZEJvZHkpO1xuICAgIHNjZW5lLm9uKFwiYWRkUmlnaWRCb2R5MkRcIiwgYWRkQm9keSk7XG5cbiAgICBzY2VuZS5vbihcInJlbW92ZVJpZ2lkQm9keTJEXCIsIGZ1bmN0aW9uIChjb21wb25lbnQpIHtcbiAgICAgICAgc3BhY2UucmVtb3ZlQm9keShjb21wb25lbnQuYm9keSk7XG4gICAgfSk7XG59O1xuXG5cbldvcmxkMkQucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMuc3BhY2Uuc3RlcChUaW1lLmRlbHRhKTtcbn07XG5cblxuV29ybGQyRC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgV29ybGQucHJvdG90eXBlLmNsZWFyLmNhbGwodGhpcyk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuV29ybGQyRC5wcm90b3R5cGUudG9TWU5DID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gV29ybGQucHJvdG90eXBlLnRvU1lOQy5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cbldvcmxkMkQucHJvdG90eXBlLmZyb21TWU5DID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBXb3JsZC5wcm90b3R5cGUuZnJvbVNZTkMuY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5Xb3JsZDJELnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBXb3JsZC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICBqc29uLnNwYWNlID0gdGhpcy5zcGFjZS50b0pTT04oanNvbi5zcGFjZSk7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuV29ybGQyRC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIFdvcmxkLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy5zcGFjZS5mcm9tSlNPTihqc29uLnNwYWNlKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFdvcmxkMkQ7XG4iLCJ2YXIgTWF0aGYgPSByZXF1aXJlKFwiLi9tYXRoZlwiKTtcbnZhciBWZWMyID0gcmVxdWlyZShcIi4vdmVjMlwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbi8qKlxuICogQGNsYXNzIEFBQkIyXG4gKiAyZCBheGlzIGFsaWduZWQgYm91bmRpbmcgYm94XG4gKiBAcGFyYW0gVmVjMiBtaW5cbiAqIEBwYXJhbSBWZWMyIG1heFxuICovXG5mdW5jdGlvbiBBQUJCMihtaW4sIG1heCkge1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IFZlYzIgbWluXG4gICAgICogQG1lbWJlcm9mIE9kaW4uQUFCQjJcbiAgICAgKi9cbiAgICB0aGlzLm1pbiA9IG1pbiB8fCBuZXcgVmVjMihJbmZpbml0eSwgSW5maW5pdHkpO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IFZlYzIgbWF4XG4gICAgICogQG1lbWJlcm9mIE9kaW4uQUFCQjJcbiAgICAgKi9cbiAgICB0aGlzLm1heCA9IG1heCB8fCBuZXcgVmVjMigtSW5maW5pdHksIC1JbmZpbml0eSk7XG59XG5cbi8qKlxuICogQG1ldGhvZCBjbG9uZVxuICogQG1lbWJlcm9mIE9kaW4uQUFCQjJcbiAqIHJldHVybnMgbmV3IGNvcHkgb2YgdGhpc1xuICogQHJldHVybiBBQUJCMlxuICovXG5BQUJCMi5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gbmV3IEFBQkIyKHRoaXMubWluLmNsb25lKCksIHRoaXMubWF4LmNsb25lKCkpO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNvcHlcbiAqIEBtZW1iZXJvZiBPZGluLkFBQkIyXG4gKiBjb3BpZXMgb3RoZXIgQUFCQlxuICogQHBhcmFtIEFBQkIyIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQUFCQjIucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMubWluLmNvcHkob3RoZXIubWluKTtcbiAgICB0aGlzLm1heC5jb3B5KG90aGVyLm1heCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZXRcbiAqIEBtZW1iZXJvZiBPZGluLkFBQkIyXG4gKiBzZXQgbWluIGFuZCBtYXggdmVjdG9yc1xuICogQHBhcmFtIFZlYzIgbWluXG4gKiBAcGFyYW0gVmVjMiBtYXhcbiAqIEByZXR1cm4gdGhpc1xuICovXG5BQUJCMi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKG1pbiwgbWF4KSB7XG5cbiAgICB0aGlzLm1pbi5jb3B5KG1pbik7XG4gICAgdGhpcy5tYXguY29weShtYXgpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZXhwYW5kUG9pbnRcbiAqIEBtZW1iZXJvZiBPZGluLkFBQkIyXG4gKiBAcGFyYW0gVmVjMiB2XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQUFCQjIucHJvdG90eXBlLmV4cGFuZFBvaW50ID0gZnVuY3Rpb24gKHYpIHtcblxuICAgIHRoaXMubWluLm1pbih2KTtcbiAgICB0aGlzLm1heC5tYXgodik7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBleHBhbmRWZWNcbiAqIEBtZW1iZXJvZiBPZGluLkFBQkIyXG4gKiBAcGFyYW0gVmVjMiB2XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQUFCQjIucHJvdG90eXBlLmV4cGFuZFZlYyA9IGZ1bmN0aW9uICh2KSB7XG5cbiAgICB0aGlzLm1pbi5zdWIodik7XG4gICAgdGhpcy5tYXguYWRkKHYpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZXhwYW5kU2NhbGFyXG4gKiBAbWVtYmVyb2YgT2Rpbi5BQUJCMlxuICogQHBhcmFtIE51bWJlciBzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQUFCQjIucHJvdG90eXBlLmV4cGFuZFNjYWxhciA9IGZ1bmN0aW9uIChzKSB7XG5cbiAgICB0aGlzLm1pbi5zc3ViKHMpO1xuICAgIHRoaXMubWF4LnNhZGQocyk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB1bmlvblxuICogQG1lbWJlcm9mIE9kaW4uQUFCQjJcbiAqIGpvaW5zIHRoaXMgYW5kIGFub3RoZXIgYWFiYlxuICogQHBhcmFtIEFBQkIyIGFhYmJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5BQUJCMi5wcm90b3R5cGUudW5pb24gPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMubWluLm1pbihvdGhlci5taW4pO1xuICAgIHRoaXMubWF4Lm1heChvdGhlci5tYXgpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgY2xlYXJcbiAqIEBtZW1iZXJvZiBPZGluLkFBQkIyXG4gKiBjbGVhcnMgYWFiYlxuICogQHJldHVybiB0aGlzXG4gKi9cbkFBQkIyLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMubWluLnNldChJbmZpbml0eSwgSW5maW5pdHkpO1xuICAgIHRoaXMubWF4LnNldCgtSW5maW5pdHksIC1JbmZpbml0eSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjb250YWluc1xuICogQG1lbWJlcm9mIE9kaW4uQUFCQjJcbiAqIGNoZWNrcyBpZiBBQUJCIGNvbnRhaW5zIHBvaW50XG4gKiBAcGFyYW0gVmVjMiBwb2ludFxuICogQHJldHVybiBCb29sZWFuXG4gKi9cbkFBQkIyLnByb3RvdHlwZS5jb250YWlucyA9IGZ1bmN0aW9uIChwb2ludCkge1xuICAgIHZhciBtaW4gPSB0aGlzLm1pbixcbiAgICAgICAgbWF4ID0gdGhpcy5tYXgsXG4gICAgICAgIHB4ID0gcG9pbnQueCxcbiAgICAgICAgcHkgPSBwb2ludC55O1xuXG4gICAgcmV0dXJuICEoXG4gICAgcHggPCBtaW4ueCB8fCBweCA+IG1heC54IHx8XG4gICAgcHkgPCBtaW4ueSB8fCBweSA+IG1heC55XG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBpbnRlcnNlY3RzXG4gKiBAbWVtYmVyb2YgT2Rpbi5BQUJCMlxuICogY2hlY2tzIGlmIEFBQkIgaW50ZXJzZWN0cyBBQUJCXG4gKiBAcGFyYW0gQUFCQjIgb3RoZXJcbiAqIEByZXR1cm4gQm9vbGVhblxuICovXG5BQUJCMi5wcm90b3R5cGUuaW50ZXJzZWN0cyA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciBhTWluID0gdGhpcy5taW4sXG4gICAgICAgIGFNYXggPSB0aGlzLm1heCxcbiAgICAgICAgYk1pbiA9IG90aGVyLm1pbixcbiAgICAgICAgYk1heCA9IG90aGVyLm1heDtcblxuICAgIHJldHVybiAhKFxuICAgIGJNYXgueCA8IGFNaW4ueCB8fCBiTWluLnggPiBhTWF4LnggfHxcbiAgICBiTWF4LnkgPCBhTWluLnkgfHwgYk1pbi55ID4gYU1heC55XG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tUG9pbnRzXG4gKiBAbWVtYmVyb2YgT2Rpbi5BQUJCMlxuICogc2V0IG1pbiBhbmQgbWF4IGZyb20gYXJyYXkgb2YgdmVjdG9yc1xuICogQHBhcmFtIEFycmF5IHBvaW50c1xuICogQHJldHVybiB0aGlzXG4gKi9cbkFBQkIyLnByb3RvdHlwZS5mcm9tUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykge1xuICAgIHZhciB2LCBpID0gcG9pbnRzLmxlbmd0aCxcbiAgICAgICAgbWlueCA9IEluZmluaXR5LFxuICAgICAgICBtaW55ID0gSW5maW5pdHksXG4gICAgICAgIG1heHggPSAtSW5maW5pdHksXG4gICAgICAgIG1heHkgPSAtSW5maW5pdHksXG4gICAgICAgIG1pbiA9IHRoaXMubWluLFxuICAgICAgICBtYXggPSB0aGlzLm1heCxcbiAgICAgICAgeCwgeTtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgdiA9IHBvaW50c1tpXTtcbiAgICAgICAgeCA9IHYueDtcbiAgICAgICAgeSA9IHYueTtcblxuICAgICAgICBtaW54ID0gbWlueCA+IHggPyB4IDogbWlueDtcbiAgICAgICAgbWlueSA9IG1pbnkgPiB5ID8geSA6IG1pbnk7XG5cbiAgICAgICAgbWF4eCA9IG1heHggPCB4ID8geCA6IG1heHg7XG4gICAgICAgIG1heHkgPSBtYXh5IDwgeSA/IHkgOiBtYXh5O1xuICAgIH1cblxuICAgIG1pbi54ID0gbWlueDtcbiAgICBtaW4ueSA9IG1pbnk7XG4gICAgbWF4LnggPSBtYXh4O1xuICAgIG1heC55ID0gbWF4eTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21DZW50ZXJTaXplXG4gKiBAbWVtYmVyb2YgT2Rpbi5BQUJCMlxuICogc2V0cyB0aGlzIGZyb20gYSBjZW50ZXIgcG9pbnQgYW5kIGEgc2l6ZSB2ZWN0b3JcbiAqIEBwYXJhbSBWZWMyIGNlbnRlclxuICogQHBhcmFtIFZlYzIgc2l6ZVxuICogQHJldHVybiB0aGlzXG4gKi9cbkFBQkIyLnByb3RvdHlwZS5mcm9tQ2VudGVyU2l6ZSA9IGZ1bmN0aW9uIChjZW50ZXIsIHNpemUpIHtcbiAgICB2YXIgbWluID0gdGhpcy5taW4sXG4gICAgICAgIG1heCA9IHRoaXMubWF4LFxuICAgICAgICB4ID0gY2VudGVyLngsXG4gICAgICAgIHkgPSBjZW50ZXIueSxcbiAgICAgICAgaHggPSBzaXplLnggKiAwLjUsXG4gICAgICAgIGh5ID0gc2l6ZS55ICogMC41O1xuXG4gICAgbWluLnggPSB4IC0gaHg7XG4gICAgbWluLnkgPSB5IC0gaHk7XG5cbiAgICBtYXgueCA9IHggKyBoeDtcbiAgICBtYXgueSA9IHkgKyBoeTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWVtYmVyb2YgT2Rpbi5BQUJCMlxuICogQHBhcmFtIE9kaW4uQUFCQjIgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5BQUJCMi5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICByZXR1cm4gISghdGhpcy5taW4uZXF1YWxzKG90aGVyLm1pbikgfHwgIXRoaXMubWF4LmVxdWFscyhvdGhlci5tYXgpKTtcbn07XG5cbi8qKlxuICogQG1lbWJlcm9mIE9kaW4uQUFCQjJcbiAqIEBwYXJhbSBPZGluLkFBQkIyIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQUFCQjIucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgcmV0dXJuICh0aGlzLm1pbi5ub3RFcXVhbHMob3RoZXIubWluKSB8fCB0aGlzLm1heC5ub3RFcXVhbHMob3RoZXIubWF4KSk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbUpTT05cbiAqIEBtZW1iZXJvZiBPZGluLkFBQkIyXG4gKiBzZXRzIHZhbHVlcyBmcm9tIGpzb24gb2JqZWN0XG4gKiBAcGFyYW0gT2JqZWN0IGpzb25cbiAqIEByZXR1cm4gdGhpc1xuICovXG5BQUJCMi5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuXG4gICAgdGhpcy5taW4uZnJvbUpTT04oanNvbi5taW4pO1xuICAgIHRoaXMubWF4LmZyb21KU09OKGpzb24ubWF4KTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRvSlNPTlxuICogQG1lbWJlcm9mIE9kaW4uQUFCQjJcbiAqIHJldHVybnMganNvbiBvYmplY3RcbiAqIEByZXR1cm4gT2JqZWN0XG4gKi9cbkFBQkIyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gfHwgKGpzb24gPSB7fSk7XG5cbiAgICBqc29uLm1pbiA9IHRoaXMubWluLnRvSlNPTihqc29uLm1pbik7XG4gICAganNvbi5tYXggPSB0aGlzLm1heC50b0pTT04oanNvbi5tYXgpO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdG9TdHJpbmdcbiAqIEBtZW1iZXJvZiBPZGluLkFBQkIyXG4gKiBjb252ZXJ0cyBBQUJCIHRvIHN0cmluZyBcIkFBQkIyKCBtaW46IFZlYzIoIC0xLCAtMSApLCBtYXg6IFZlYzIoIDEsIDEgKSApXCJcbiAqIEByZXR1cm4gU3RyaW5nXG4gKi9cbkFBQkIyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbWluID0gdGhpcy5taW4sXG4gICAgICAgIG1heCA9IHRoaXMubWF4O1xuXG4gICAgcmV0dXJuIFwiQUFCQjIoIG1pbjogXCIgKyBtaW4gKyBcIiwgbWF4OiBcIiArIG1heCArIFwiIClcIjtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBBQUJCMjtcbiIsInZhciBNYXRoZiA9IHJlcXVpcmUoXCIuL21hdGhmXCIpO1xudmFyIFZlYzMgPSByZXF1aXJlKFwiLi92ZWMzXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuLyoqXG4gKiBAY2xhc3MgQUFCQjNcbiAqIDJkIGF4aXMgYWxpZ25lZCBib3VuZGluZyBib3hcbiAqIEBwYXJhbSBWZWMzIG1pblxuICogQHBhcmFtIFZlYzMgbWF4XG4gKi9cbmZ1bmN0aW9uIEFBQkIzKG1pbiwgbWF4KSB7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgVmVjMyBtaW5cbiAgICAgKiBAbWVtYmVyb2YgT2Rpbi5BQUJCM1xuICAgICAqL1xuICAgIHRoaXMubWluID0gbWluIHx8IG5ldyBWZWMzKEluZmluaXR5LCBJbmZpbml0eSwgSW5maW5pdHkpO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IFZlYzMgbWF4XG4gICAgICogQG1lbWJlcm9mIE9kaW4uQUFCQjNcbiAgICAgKi9cbiAgICB0aGlzLm1heCA9IG1heCB8fCBuZXcgVmVjMygtSW5maW5pdHksIC1JbmZpbml0eSwgLUluZmluaXR5KTtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGNsb25lXG4gKiBAbWVtYmVyb2YgT2Rpbi5BQUJCM1xuICogcmV0dXJucyBuZXcgY29weSBvZiB0aGlzXG4gKiBAcmV0dXJuIEFBQkIzXG4gKi9cbkFBQkIzLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiBuZXcgQUFCQjModGhpcy5taW4uY2xvbmUoKSwgdGhpcy5tYXguY2xvbmUoKSk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgY29weVxuICogQG1lbWJlcm9mIE9kaW4uQUFCQjNcbiAqIGNvcGllcyBvdGhlciBBQUJCXG4gKiBAcGFyYW0gQUFCQjMgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5BQUJCMy5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy5taW4uY29weShvdGhlci5taW4pO1xuICAgIHRoaXMubWF4LmNvcHkob3RoZXIubWF4KTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNldFxuICogQG1lbWJlcm9mIE9kaW4uQUFCQjNcbiAqIHNldCBtaW4gYW5kIG1heCB2ZWN0b3JzXG4gKiBAcGFyYW0gVmVjMyBtaW5cbiAqIEBwYXJhbSBWZWMzIG1heFxuICogQHJldHVybiB0aGlzXG4gKi9cbkFBQkIzLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobWluLCBtYXgpIHtcblxuICAgIHRoaXMubWluLmNvcHkobWluKTtcbiAgICB0aGlzLm1heC5jb3B5KG1heCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBleHBhbmRQb2ludFxuICogQG1lbWJlcm9mIE9kaW4uQUFCQjNcbiAqIEBwYXJhbSBWZWMzIHZcbiAqIEByZXR1cm4gdGhpc1xuICovXG5BQUJCMy5wcm90b3R5cGUuZXhwYW5kUG9pbnQgPSBmdW5jdGlvbiAodikge1xuXG4gICAgdGhpcy5taW4ubWluKHYpO1xuICAgIHRoaXMubWF4Lm1heCh2KTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGV4cGFuZFZlY1xuICogQG1lbWJlcm9mIE9kaW4uQUFCQjNcbiAqIEBwYXJhbSBWZWMzIHZcbiAqIEByZXR1cm4gdGhpc1xuICovXG5BQUJCMy5wcm90b3R5cGUuZXhwYW5kVmVjID0gZnVuY3Rpb24gKHYpIHtcblxuICAgIHRoaXMubWluLnN1Yih2KTtcbiAgICB0aGlzLm1heC5hZGQodik7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBleHBhbmRTY2FsYXJcbiAqIEBtZW1iZXJvZiBPZGluLkFBQkIzXG4gKiBAcGFyYW0gTnVtYmVyIHNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5BQUJCMy5wcm90b3R5cGUuZXhwYW5kU2NhbGFyID0gZnVuY3Rpb24gKHMpIHtcblxuICAgIHRoaXMubWluLnNzdWIocyk7XG4gICAgdGhpcy5tYXguc2FkZChzKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHVuaW9uXG4gKiBAbWVtYmVyb2YgT2Rpbi5BQUJCM1xuICogam9pbnMgdGhpcyBhbmQgYW5vdGhlciBhYWJiXG4gKiBAcGFyYW0gQUFCQjMgYWFiYlxuICogQHJldHVybiB0aGlzXG4gKi9cbkFBQkIzLnByb3RvdHlwZS51bmlvbiA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy5taW4ubWluKG90aGVyLm1pbik7XG4gICAgdGhpcy5tYXgubWF4KG90aGVyLm1heCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjbGVhclxuICogQG1lbWJlcm9mIE9kaW4uQUFCQjNcbiAqIGNsZWFycyBhYWJiXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQUFCQjMucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5taW4uc2V0KEluZmluaXR5LCBJbmZpbml0eSwgSW5maW5pdHkpO1xuICAgIHRoaXMubWF4LnNldCgtSW5maW5pdHksIC1JbmZpbml0eSwgLUluZmluaXR5KTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNvbnRhaW5zXG4gKiBAbWVtYmVyb2YgT2Rpbi5BQUJCM1xuICogY2hlY2tzIGlmIEFBQkIgY29udGFpbnMgcG9pbnRcbiAqIEBwYXJhbSBWZWMzIHBvaW50XG4gKiBAcmV0dXJuIEJvb2xlYW5cbiAqL1xuQUFCQjMucHJvdG90eXBlLmNvbnRhaW5zID0gZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgdmFyIG1pbiA9IHRoaXMubWluLFxuICAgICAgICBtYXggPSB0aGlzLm1heCxcbiAgICAgICAgcHggPSBwb2ludC54LFxuICAgICAgICBweSA9IHBvaW50LnksXG4gICAgICAgIHB6ID0gcG9pbnQuejtcblxuICAgIHJldHVybiAhKFxuICAgIHB4IDwgbWluLnggfHwgcHggPiBtYXgueCB8fFxuICAgIHB5IDwgbWluLnkgfHwgcHkgPiBtYXgueSB8fFxuICAgIHB6IDwgbWluLnogfHwgcHogPiBtYXguelxuICAgICk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgaW50ZXJzZWN0c1xuICogQG1lbWJlcm9mIE9kaW4uQUFCQjNcbiAqIGNoZWNrcyBpZiBBQUJCIGludGVyc2VjdHMgQUFCQlxuICogQHBhcmFtIEFBQkIzIG90aGVyXG4gKiBAcmV0dXJuIEJvb2xlYW5cbiAqL1xuQUFCQjMucHJvdG90eXBlLmludGVyc2VjdHMgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYU1pbiA9IHRoaXMubWluLFxuICAgICAgICBhTWF4ID0gdGhpcy5tYXgsXG4gICAgICAgIGJNaW4gPSBvdGhlci5taW4sXG4gICAgICAgIGJNYXggPSBvdGhlci5tYXg7XG5cbiAgICByZXR1cm4gIShcbiAgICBiTWF4LnggPCBhTWluLnggfHwgYk1pbi54ID4gYU1heC54IHx8XG4gICAgYk1heC55IDwgYU1pbi55IHx8IGJNaW4ueSA+IGFNYXgueSB8fFxuICAgIGJNYXgueiA8IGFNaW4ueiB8fCBiTWluLnogPiBhTWF4LnpcbiAgICApO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21Qb2ludHNcbiAqIEBtZW1iZXJvZiBPZGluLkFBQkIzXG4gKiBzZXQgbWluIGFuZCBtYXggZnJvbSBhcnJheSBvZiB2ZWN0b3JzXG4gKiBAcGFyYW0gQXJyYXkgcG9pbnRzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQUFCQjMucHJvdG90eXBlLmZyb21Qb2ludHMgPSBmdW5jdGlvbiAocG9pbnRzKSB7XG4gICAgdmFyIHYsIGkgPSBwb2ludHMubGVuZ3RoLFxuICAgICAgICBtaW54ID0gSW5maW5pdHksXG4gICAgICAgIG1pbnkgPSBJbmZpbml0eSxcbiAgICAgICAgbWlueiA9IEluZmluaXR5LFxuICAgICAgICBtYXh4ID0gLUluZmluaXR5LFxuICAgICAgICBtYXh5ID0gLUluZmluaXR5LFxuICAgICAgICBtYXh6ID0gLUluZmluaXR5LFxuICAgICAgICBtaW4gPSB0aGlzLm1pbixcbiAgICAgICAgbWF4ID0gdGhpcy5tYXgsXG4gICAgICAgIHgsIHksIHo7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIHYgPSBwb2ludHNbaV07XG4gICAgICAgIHggPSB2Lng7XG4gICAgICAgIHkgPSB2Lnk7XG4gICAgICAgIHogPSB2Lno7XG5cbiAgICAgICAgbWlueCA9IG1pbnggPiB4ID8geCA6IG1pbng7XG4gICAgICAgIG1pbnkgPSBtaW55ID4geSA/IHkgOiBtaW55O1xuICAgICAgICBtaW56ID0gbWlueiA+IHogPyB6IDogbWluejtcblxuICAgICAgICBtYXh4ID0gbWF4eCA8IHggPyB4IDogbWF4eDtcbiAgICAgICAgbWF4eSA9IG1heHkgPCB5ID8geSA6IG1heHk7XG4gICAgICAgIG1heHogPSBtYXh6IDwgeiA/IHogOiBtYXh6O1xuICAgIH1cblxuICAgIG1pbi54ID0gbWlueDtcbiAgICBtaW4ueSA9IG1pbnk7XG4gICAgbWluLnogPSBtaW56O1xuICAgIG1heC54ID0gbWF4eDtcbiAgICBtYXgueSA9IG1heHk7XG4gICAgbWF4LnogPSBtYXh6O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbUNlbnRlclNpemVcbiAqIEBtZW1iZXJvZiBPZGluLkFBQkIzXG4gKiBzZXRzIHRoaXMgZnJvbSBhIGNlbnRlciBwb2ludCBhbmQgYSBzaXplIHZlY3RvclxuICogQHBhcmFtIFZlYzMgY2VudGVyXG4gKiBAcGFyYW0gVmVjMyBzaXplXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQUFCQjMucHJvdG90eXBlLmZyb21DZW50ZXJTaXplID0gZnVuY3Rpb24gKGNlbnRlciwgc2l6ZSkge1xuICAgIHZhciBtaW4gPSB0aGlzLm1pbixcbiAgICAgICAgbWF4ID0gdGhpcy5tYXgsXG4gICAgICAgIHggPSBjZW50ZXIueCxcbiAgICAgICAgeSA9IGNlbnRlci55LFxuICAgICAgICB6ID0gY2VudGVyLnosXG4gICAgICAgIGh4ID0gc2l6ZS54ICogMC41LFxuICAgICAgICBoeSA9IHNpemUueSAqIDAuNSxcbiAgICAgICAgaHogPSBzaXplLnogKiAwLjU7XG5cbiAgICBtaW4ueCA9IHggLSBoeDtcbiAgICBtaW4ueSA9IHkgLSBoeTtcbiAgICBtaW4ueiA9IHogLSBoejtcblxuICAgIG1heC54ID0geCArIGh4O1xuICAgIG1heC55ID0geSArIGh5O1xuICAgIG1heC56ID0geiArIGh6O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZW1iZXJvZiBPZGluLkFBQkIzXG4gKiBAcGFyYW0gT2Rpbi5BQUJCMyBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cbkFBQkIzLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHJldHVybiAhKCF0aGlzLm1pbi5lcXVhbHMob3RoZXIubWluKSB8fCAhdGhpcy5tYXguZXF1YWxzKG90aGVyLm1heCkpO1xufTtcblxuLyoqXG4gKiBAbWVtYmVyb2YgT2Rpbi5BQUJCM1xuICogQHBhcmFtIE9kaW4uQUFCQjMgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5BQUJCMy5wcm90b3R5cGUubm90RXF1YWxzID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICByZXR1cm4gKHRoaXMubWluLm5vdEVxdWFscyhvdGhlci5taW4pIHx8IHRoaXMubWF4Lm5vdEVxdWFscyhvdGhlci5tYXgpKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tSlNPTlxuICogQG1lbWJlcm9mIE9kaW4uQUFCQjNcbiAqIHNldHMgdmFsdWVzIGZyb20ganNvbiBvYmplY3RcbiAqIEBwYXJhbSBPYmplY3QganNvblxuICogQHJldHVybiB0aGlzXG4gKi9cbkFBQkIzLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG5cbiAgICB0aGlzLm1pbi5mcm9tSlNPTihqc29uLm1pbik7XG4gICAgdGhpcy5tYXguZnJvbUpTT04oanNvbi5tYXgpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdG9KU09OXG4gKiBAbWVtYmVyb2YgT2Rpbi5BQUJCM1xuICogcmV0dXJucyBqc29uIG9iamVjdFxuICogQHJldHVybiBPYmplY3RcbiAqL1xuQUFCQjMucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiB8fCAoanNvbiA9IHt9KTtcblxuICAgIGpzb24ubWluID0gdGhpcy5taW4udG9KU09OKGpzb24ubWluKTtcbiAgICBqc29uLm1heCA9IHRoaXMubWF4LnRvSlNPTihqc29uLm1heCk7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b1N0cmluZ1xuICogQG1lbWJlcm9mIE9kaW4uQUFCQjNcbiAqIGNvbnZlcnRzIEFBQkIgdG8gc3RyaW5nIFwiQUFCQjMoIG1pbjogVmVjMyggLTEsIC0xICksIG1heDogVmVjMyggMSwgMSApIClcIlxuICogQHJldHVybiBTdHJpbmdcbiAqL1xuQUFCQjMucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtaW4gPSB0aGlzLm1pbixcbiAgICAgICAgbWF4ID0gdGhpcy5tYXg7XG5cbiAgICByZXR1cm4gXCJBQUJCMyggbWluOiBcIiArIG1pbiArIFwiLCBtYXg6IFwiICsgbWF4ICsgXCIgKVwiO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEFBQkIzO1xuIiwidmFyIE1hdGhmID0gcmVxdWlyZShcIi4vbWF0aGZcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgc3FydCA9IE1hdGguc3FydCxcbiAgICBmbG9vciA9IE1hdGguZmxvb3IsXG4gICAgY2xhbXAwMSA9IE1hdGhmLmNsYW1wMDEsXG4gICAgZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG5cbi8qKlxuICogQGNsYXNzIENvbG9yXG4gKiByZ2IgY29sb3IsIHZhbHVlcyAwLjAgLSAxXG4gKiBAcGFyYW0gTnVtYmVyIHJcbiAqIEBwYXJhbSBOdW1iZXIgZ1xuICogQHBhcmFtIE51bWJlciBiXG4gKi9cbmZ1bmN0aW9uIENvbG9yKHIsIGcsIGIpIHtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBOdW1iZXIgclxuICAgICAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gICAgICovXG4gICAgdGhpcy5yID0gMC4wO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciBnXG4gICAgICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAgICAgKi9cbiAgICB0aGlzLmcgPSAwLjA7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIGJcbiAgICAgKiBAbWVtYmVyb2YgT2Rpbi5Db2xvclxuICAgICAqL1xuICAgIHRoaXMuYiA9IDAuMDtcblxuICAgIHRoaXMuX3IgPSAwLjA7XG4gICAgdGhpcy5fZyA9IDAuMDtcbiAgICB0aGlzLl9iID0gMC4wO1xuICAgIHRoaXMuX2hleCA9IFwiIzAwMDAwMFwiO1xuICAgIHRoaXMuX3JnYiA9IFwicmdiKDAsMCwwKVwiO1xuXG4gICAgdGhpcy5zZXQociwgZywgYik7XG59XG5cbk1hdGhmLl9jbGFzc2VzW1wiQ29sb3JcIl0gPSBDb2xvcjtcblxuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcInhcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5yID0gdmFsdWU7XG4gICAgfVxufSk7XG5kZWZpbmVQcm9wZXJ0eShDb2xvci5wcm90b3R5cGUsIFwieVwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmc7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmcgPSB2YWx1ZTtcbiAgICB9XG59KTtcbmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJ6XCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYjtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuYiA9IHZhbHVlO1xuICAgIH1cbn0pO1xuXG4vKipcbiAqIEBtZXRob2QgY2xvbmVcbiAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gKiByZXR1cm5zIG5ldyBpbnN0YW5jZSBvZiB0aGlzXG4gKiBAcmV0dXJuIENvbG9yXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiBuZXcgQ29sb3IodGhpcy5yLCB0aGlzLmcsIHRoaXMuYik7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgY29weVxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIGNvcGllcyBvdGhlclxuICogQHBhcmFtIENvbG9yIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQ29sb3IucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMuciA9IG90aGVyLnI7XG4gICAgdGhpcy5nID0gb3RoZXIuZztcbiAgICB0aGlzLmIgPSBvdGhlci5iO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0XG4gKiBAbWVtYmVyb2YgT2Rpbi5Db2xvclxuICogc2V0cyB2YWx1ZXMgb2YgdGhpc1xuICogQHBhcmFtIE51bWJlciByXG4gKiBAcGFyYW0gTnVtYmVyIGdcbiAqIEBwYXJhbSBOdW1iZXIgYlxuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAociwgZywgYikge1xuICAgIHZhciB0eXBlID0gdHlwZW9mKHIpO1xuXG4gICAgaWYgKHR5cGUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgdGhpcy5yID0gcjtcbiAgICAgICAgdGhpcy5nID0gZztcbiAgICAgICAgdGhpcy5iID0gYjtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdGhpcy5zZXRTdHlsZShyKTtcbiAgICB9IGVsc2UgaWYgKHIgaW5zdGFuY2VvZiBDb2xvcikge1xuICAgICAgICB0aGlzLnIgPSByLnI7XG4gICAgICAgIHRoaXMuZyA9IHIuZztcbiAgICAgICAgdGhpcy5iID0gci5iO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNldFJHQlxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIHNldHMgcmdiIHZhbHVlcyBvZiB0aGlzXG4gKiBAcGFyYW0gTnVtYmVyIHJcbiAqIEBwYXJhbSBOdW1iZXIgZ1xuICogQHBhcmFtIE51bWJlciBiXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQ29sb3IucHJvdG90eXBlLnNldFJHQiA9IGZ1bmN0aW9uIChyLCBnLCBiKSB7XG5cbiAgICB0aGlzLnIgPSByO1xuICAgIHRoaXMuZyA9IGc7XG4gICAgdGhpcy5iID0gYjtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNldFN0eWxlXG4gKiBAbWVtYmVyb2YgT2Rpbi5Db2xvclxuICogc2V0cyB2YWx1ZXMgb2YgdGhpcyBmcm9tIHN0cmluZ1xuICogQHBhcmFtIFN0cmluZyBzdHlsZVxuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5zZXRTdHlsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcmdiMjU1ID0gL15yZ2JcXCgoXFxkKyksKFxcZCspLChcXGQrKVxcKSQvaSxcbiAgICAgICAgcmdiMTAwID0gL15yZ2JcXCgoXFxkKylcXCUsKFxcZCspXFwlLChcXGQrKVxcJVxcKSQvaSxcbiAgICAgICAgaGV4NiA9IC9eXFwjKFswLjAtOWEtZl17Nn0pJC9pLFxuICAgICAgICBoZXgzID0gL15cXCMoWzAuMC05YS1mXSkoWzAuMC05YS1mXSkoWzAuMC05YS1mXSkkL2ksXG4gICAgICAgIGhleDN0bzYgPSAvIyguKSguKSguKS8sXG4gICAgICAgIGhleDN0bzZTdHJpbmcgPSBcIiMkMSQxJDIkMiQzJDNcIixcbiAgICAgICAgY29sb3JOYW1lID0gL14oXFx3KykkL2ksXG4gICAgICAgIGludjI1NSA9IDEuMCAvIDI1NS4wLFxuICAgICAgICBpbnYxMDAgPSAxLjAgLyAxMDAuMDtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoc3R5bGUpIHtcblxuICAgICAgICBpZiAocmdiMjU1LnRlc3Qoc3R5bGUpKSB7XG4gICAgICAgICAgICB2YXIgY29sb3IgPSByZ2IyNTUuZXhlYyhzdHlsZSk7XG5cbiAgICAgICAgICAgIHRoaXMuciA9IG1pbigyNTUsIE51bWJlcihjb2xvclsxXSkpICogaW52MjU1O1xuICAgICAgICAgICAgdGhpcy5nID0gbWluKDI1NSwgTnVtYmVyKGNvbG9yWzJdKSkgKiBpbnYyNTU7XG4gICAgICAgICAgICB0aGlzLmIgPSBtaW4oMjU1LCBOdW1iZXIoY29sb3JbM10pKSAqIGludjI1NTtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmdiMTAwLnRlc3Qoc3R5bGUpKSB7XG4gICAgICAgICAgICB2YXIgY29sb3IgPSByZ2IxMDAuZXhlYyhzdHlsZSk7XG5cbiAgICAgICAgICAgIHRoaXMuciA9IG1pbigxMDAsIE51bWJlcihjb2xvclsxXSkpICogaW52MTAwO1xuICAgICAgICAgICAgdGhpcy5nID0gbWluKDEwMCwgTnVtYmVyKGNvbG9yWzJdKSkgKiBpbnYxMDA7XG4gICAgICAgICAgICB0aGlzLmIgPSBtaW4oMTAwLCBOdW1iZXIoY29sb3JbM10pKSAqIGludjEwMDtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaGV4Ni50ZXN0KHN0eWxlKSkge1xuXG4gICAgICAgICAgICB0aGlzLnIgPSBwYXJzZUludChzdHlsZS5zdWJzdHIoMSwgMiksIDE2KSAqIGludjI1NTtcbiAgICAgICAgICAgIHRoaXMuZyA9IHBhcnNlSW50KHN0eWxlLnN1YnN0cigzLCAyKSwgMTYpICogaW52MjU1O1xuICAgICAgICAgICAgdGhpcy5iID0gcGFyc2VJbnQoc3R5bGUuc3Vic3RyKDUsIDIpLCAxNikgKiBpbnYyNTU7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGhleDMudGVzdChzdHlsZSkpIHtcbiAgICAgICAgICAgIHN0eWxlID0gc3R5bGUucmVwbGFjZShoZXgzdG82LCBoZXgzdG82U3RyaW5nKTtcblxuICAgICAgICAgICAgdGhpcy5yID0gcGFyc2VJbnQoc3R5bGUuc3Vic3RyKDEsIDIpLCAxNikgKiBpbnYyNTU7XG4gICAgICAgICAgICB0aGlzLmcgPSBwYXJzZUludChzdHlsZS5zdWJzdHIoMywgMiksIDE2KSAqIGludjI1NTtcbiAgICAgICAgICAgIHRoaXMuYiA9IHBhcnNlSW50KHN0eWxlLnN1YnN0cig1LCAyKSwgMTYpICogaW52MjU1O1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjb2xvck5hbWUudGVzdChzdHlsZSkpIHtcbiAgICAgICAgICAgIHN0eWxlID0gY29sb3JOYW1lc1tzdHlsZV07XG5cbiAgICAgICAgICAgIHRoaXMuciA9IHBhcnNlSW50KHN0eWxlLnN1YnN0cigxLCAyKSwgMTYpICogaW52MjU1O1xuICAgICAgICAgICAgdGhpcy5nID0gcGFyc2VJbnQoc3R5bGUuc3Vic3RyKDMsIDIpLCAxNikgKiBpbnYyNTU7XG4gICAgICAgICAgICB0aGlzLmIgPSBwYXJzZUludChzdHlsZS5zdWJzdHIoNSwgMiksIDE2KSAqIGludjI1NTtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xufSgpO1xuXG4vKipcbiAqIEBtZXRob2QgdG9IRVhcbiAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gKiByZXR1cm5zIHRoaXMgY29sb3IgaW4gSEVYIGZvcm1hdFxuICogQHJldHVybiBDb2xvclxuICovXG5Db2xvci5wcm90b3R5cGUudG9IRVggPSBmdW5jdGlvbiAoKSB7XG5cbiAgICBpZiAodGhpcy5yICE9PSB0aGlzLl9yIHx8IHRoaXMuZyAhPT0gdGhpcy5fZyB8fCB0aGlzLmIgIT09IHRoaXMuX2IpIHtcbiAgICAgICAgdmFyIGhleFIgPSBzaW5nbGVUb0hFWCh0aGlzLnIpLFxuICAgICAgICAgICAgaGV4RyA9IHNpbmdsZVRvSEVYKHRoaXMuZyksXG4gICAgICAgICAgICBoZXhCID0gc2luZ2xlVG9IRVgodGhpcy5iKTtcblxuICAgICAgICB0aGlzLl9yID0gdGhpcy5yO1xuICAgICAgICB0aGlzLl9nID0gdGhpcy5nO1xuICAgICAgICB0aGlzLl9iID0gdGhpcy5iO1xuICAgICAgICB0aGlzLl9oZXggPSBcIiNcIiArIGhleFIgKyBoZXhHICsgaGV4QjtcbiAgICAgICAgdGhpcy5fcmdiID0gXCJyZ2IoXCIgKyBmbG9vcihjbGFtcDAxKHRoaXMucikgKiAyNTYpICsgXCIsXCIgKyBmbG9vcihjbGFtcDAxKHRoaXMuZykgKiAyNTYpICsgXCIsXCIgKyBmbG9vcihjbGFtcDAxKHRoaXMuYikgKiAyNTYpICsgXCIpXCI7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX2hleDtcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b1JHQlxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIHJldHVybnMgdGhpcyBjb2xvciBpbiBSR0IgZm9ybWF0XG4gKiBAcmV0dXJuIENvbG9yXG4gKi9cbkNvbG9yLnByb3RvdHlwZS50b1JHQiA9IGZ1bmN0aW9uICgpIHtcblxuICAgIGlmICh0aGlzLnIgIT09IHRoaXMuX3IgfHwgdGhpcy5nICE9PSB0aGlzLl9nIHx8IHRoaXMuYiAhPT0gdGhpcy5fYikge1xuICAgICAgICB2YXIgciA9IGZsb29yKGNsYW1wMDEodGhpcy5yKSAqIDI1NiksXG4gICAgICAgICAgICBnID0gZmxvb3IoY2xhbXAwMSh0aGlzLmcpICogMjU2KSxcbiAgICAgICAgICAgIGIgPSBmbG9vcihjbGFtcDAxKHRoaXMuYikgKiAyNTYpO1xuXG4gICAgICAgIHRoaXMuX3IgPSB0aGlzLnI7XG4gICAgICAgIHRoaXMuX2cgPSB0aGlzLmc7XG4gICAgICAgIHRoaXMuX2IgPSB0aGlzLmI7XG4gICAgICAgIHRoaXMuX3JnYiA9IFwicmdiKFwiICsgciArIFwiLFwiICsgZyArIFwiLFwiICsgYiArIFwiKVwiO1xuICAgICAgICB0aGlzLl9oZXggPSBcIiNcIiArIHNpbmdsZVRvSEVYKHRoaXMucikgKyBzaW5nbGVUb0hFWCh0aGlzLmcpICsgc2luZ2xlVG9IRVgodGhpcy5iKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fcmdiO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGFkZFxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIGFkZHMgb3RoZXIncyB2YWx1ZXMgdG8gdGhpc1xuICogQHBhcmFtIENvbG9yIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQ29sb3IucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy5yICs9IG90aGVyLnI7XG4gICAgdGhpcy5nICs9IG90aGVyLmc7XG4gICAgdGhpcy5iICs9IG90aGVyLmI7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjYWRkXG4gKiBAbWVtYmVyb2YgT2Rpbi5Db2xvclxuICogYWRkcyBhIGFuZCBiIHRvZ2V0aGVyIHNhdmVzIGl0IGluIHRoaXNcbiAqIEBwYXJhbSBDb2xvciBhXG4gKiBAcGFyYW0gQ29sb3IgYlxuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5jYWRkID0gZnVuY3Rpb24gKGEsIGIpIHtcblxuICAgIHRoaXMuciA9IGEuciArIGIucjtcbiAgICB0aGlzLmcgPSBhLmcgKyBiLmc7XG4gICAgdGhpcy5iID0gYS5iICsgYi5iO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2FkZFxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIGFkZHMgc2NhbGFyIHZhbHVlIHRvIHRoaXNcbiAqIEBwYXJhbSBOdW1iZXIgc1xuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5zYWRkID0gZnVuY3Rpb24gKHMpIHtcblxuICAgIHRoaXMuciArPSBzO1xuICAgIHRoaXMuZyArPSBzO1xuICAgIHRoaXMuYiArPSBzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc3ViXG4gKiBAbWVtYmVyb2YgT2Rpbi5Db2xvclxuICogc3VidHJhY3RzIG90aGVyJ3MgdmFsdWVzIGZyb20gdGhpc1xuICogQHBhcmFtIENvbG9yIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQ29sb3IucHJvdG90eXBlLnN1YiA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy5yIC09IG90aGVyLnI7XG4gICAgdGhpcy5nIC09IG90aGVyLmc7XG4gICAgdGhpcy5iIC09IG90aGVyLmI7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjc3ViXG4gKiBAbWVtYmVyb2YgT2Rpbi5Db2xvclxuICogc3VidHJhY3RzIGIgZnJvbSBhIHNhdmVzIGl0IGluIHRoaXNcbiAqIEBwYXJhbSBDb2xvciBhXG4gKiBAcGFyYW0gQ29sb3IgYlxuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5jc3ViID0gZnVuY3Rpb24gKGEsIGIpIHtcblxuICAgIHRoaXMuciA9IGEuciAtIGIucjtcbiAgICB0aGlzLmcgPSBhLmcgLSBiLmc7XG4gICAgdGhpcy5iID0gYS5iIC0gYi5iO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc3N1YlxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIHN1YnRyYWN0cyB0aGlzIGJ5IGEgc2NhbGFyIHZhbHVlXG4gKiBAcGFyYW0gTnVtYmVyIHNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5Db2xvci5wcm90b3R5cGUuc3N1YiA9IGZ1bmN0aW9uIChzKSB7XG5cbiAgICB0aGlzLnIgLT0gcztcbiAgICB0aGlzLmcgLT0gcztcbiAgICB0aGlzLmIgLT0gcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIG11bFxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIG11bGlwbGVzIHRoaXMncyB2YWx1ZXMgYnkgb3RoZXInc1xuICogQHBhcmFtIENvbG9yIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQ29sb3IucHJvdG90eXBlLm11bCA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy5yICo9IG90aGVyLnI7XG4gICAgdGhpcy5nICo9IG90aGVyLmc7XG4gICAgdGhpcy5iICo9IG90aGVyLmI7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjbXVsXG4gKiBAbWVtYmVyb2YgT2Rpbi5Db2xvclxuICogbXVsaXBsZXMgYSBhbmQgYiBzYXZlcyBpdCBpbiB0aGlzXG4gKiBAcGFyYW0gQ29sb3IgYVxuICogQHBhcmFtIENvbG9yIGJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5Db2xvci5wcm90b3R5cGUuY211bCA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cbiAgICB0aGlzLnIgPSBhLnIgKiBiLnI7XG4gICAgdGhpcy5nID0gYS5nICogYi5nO1xuICAgIHRoaXMuYiA9IGEuYiAqIGIuYjtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNtdWxcbiAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gKiBtdWxpcGxlcyB0aGlzIGJ5IGEgc2NhbGFyIHZhbHVlXG4gKiBAcGFyYW0gTnVtYmVyIHNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5Db2xvci5wcm90b3R5cGUuc211bCA9IGZ1bmN0aW9uIChzKSB7XG5cbiAgICB0aGlzLnIgKj0gcztcbiAgICB0aGlzLmcgKj0gcztcbiAgICB0aGlzLmIgKj0gcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGRpdlxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIGRpdmlkZXMgdGhpcydzIHZhbHVlcyBieSBvdGhlcidzXG4gKiBAcGFyYW0gQ29sb3Igb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5Db2xvci5wcm90b3R5cGUuZGl2ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIHggPSBvdGhlci5yLFxuICAgICAgICB5ID0gb3RoZXIuZyxcbiAgICAgICAgeiA9IG90aGVyLmI7XG5cbiAgICB0aGlzLnIgKj0geCAhPT0gMC4wID8gMS4wIC8geCA6IDAuMDtcbiAgICB0aGlzLmcgKj0geSAhPT0gMC4wID8gMS4wIC8geSA6IDAuMDtcbiAgICB0aGlzLmIgKj0geiAhPT0gMC4wID8gMS4wIC8geiA6IDAuMDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNkaXZcbiAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gKiBkaXZpZGVzIGIgZnJvbSBhIHNhdmVzIGl0IGluIHRoaXNcbiAqIEBwYXJhbSBDb2xvciBhXG4gKiBAcGFyYW0gQ29sb3IgYlxuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5jZGl2ID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICB2YXIgeCA9IGIucixcbiAgICAgICAgeSA9IGIuZyxcbiAgICAgICAgeiA9IGIuYjtcblxuICAgIHRoaXMuciA9IHggIT09IDAuMCA/IGEuciAvIHggOiAwLjA7XG4gICAgdGhpcy5nID0geSAhPT0gMC4wID8gYS5nIC8geSA6IDAuMDtcbiAgICB0aGlzLmIgPSB6ICE9PSAwLjAgPyBhLmIgLyB6IDogMC4wO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2RpdlxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIGRpdmlkZXMgdGhpcyBieSBzY2FsYXIgdmFsdWVcbiAqIEBwYXJhbSBOdW1iZXIgc1xuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5zZGl2ID0gZnVuY3Rpb24gKHMpIHtcbiAgICBzID0gcyA9PT0gMC4wID8gMC4wIDogMS4wIC8gcztcblxuICAgIHRoaXMuciAqPSBzO1xuICAgIHRoaXMuZyAqPSBzO1xuICAgIHRoaXMuYiAqPSBzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbGVuZ3RoXG4gKiBAbWVtYmVyb2YgT2Rpbi5Db2xvclxuICogcmV0dXJucyBsZW5ndGggb2YgdGhpc1xuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHIgPSB0aGlzLnIsXG4gICAgICAgIGcgPSB0aGlzLmcsXG4gICAgICAgIGIgPSB0aGlzLmIsXG4gICAgICAgIGwgPSByICogciArIGcgKiBnICsgYiAqIGI7XG5cbiAgICByZXR1cm4gbCA+IDAuMCA/IDEuMCAvIHNxcnQobCkgOiAwLjA7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbGVuZ3RoU3FcbiAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gKiByZXR1cm5zIGxlbmd0aCBzcXVhcmVkIG9mIHRoaXNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5Db2xvci5wcm90b3R5cGUubGVuZ3RoU3EgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHIgPSB0aGlzLnIsXG4gICAgICAgIGcgPSB0aGlzLmcsXG4gICAgICAgIGIgPSB0aGlzLmI7XG5cbiAgICByZXR1cm4gciAqIHIgKyBnICogZyArIGIgKiBiO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIG5vcm1hbGl6ZVxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIHJldHVybnMgdGhpcyB3aXRoIGEgbGVuZ3RoIG9mIDFcbiAqIEByZXR1cm4gdGhpc1xuICovXG5Db2xvci5wcm90b3R5cGUubm9ybWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciByID0gdGhpcy5yLFxuICAgICAgICBnID0gdGhpcy5nLFxuICAgICAgICBiID0gdGhpcy5iLFxuICAgICAgICBsID0gciAqIHIgKyBnICogZyArIGIgKiBiO1xuXG4gICAgbCA9IGwgPiAwLjAgPyAxLjAgLyBzcXJ0KGwpIDogMC4wO1xuXG4gICAgdGhpcy5yICo9IGw7XG4gICAgdGhpcy5nICo9IGw7XG4gICAgdGhpcy5iICo9IGw7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjbm9ybWFsaXplXG4gKiBAbWVtYmVyb2YgT2Rpbi5Db2xvclxuICogZW5zdXJlcyB0aGF0IGVhY2ggdmFsdWUgaXMgbm8gbGFyZ2VyIHRoYW4gMVxuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5jbm9ybWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciByID0gdGhpcy5yLFxuICAgICAgICBnID0gdGhpcy5nLFxuICAgICAgICBiID0gdGhpcy5iO1xuXG4gICAgdGhpcy5yID0gciA+IDEuMCA/IDEuMCA6IHI7XG4gICAgdGhpcy5nID0gZyA+IDEuMCA/IDEuMCA6IGc7XG4gICAgdGhpcy5iID0gYiA+IDEuMCA/IDEuMCA6IGI7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBsZXJwXG4gKiBAbWVtYmVyb2YgT2Rpbi5Db2xvclxuICogbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiB0aGlzIGFuZCBvdGhlciBieSB4XG4gKiBAcGFyYW0gQ29sb3Igb3RoZXJcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHJldHVybiBDb2xvclxuICovXG5Db2xvci5wcm90b3R5cGUubGVycCA9IGZ1bmN0aW9uIChvdGhlciwgeCkge1xuXG4gICAgdGhpcy5yICs9IChvdGhlci5yIC0gdGhpcy5yKSAqIHg7XG4gICAgdGhpcy5nICs9IChvdGhlci5nIC0gdGhpcy5nKSAqIHg7XG4gICAgdGhpcy5iICs9IChvdGhlci5iIC0gdGhpcy5iKSAqIHg7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjbGVycFxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIGxpbmVhciBpbnRlcnBvbGF0aW9uIGJldHdlZW4gYSBhbmQgYiBieSB4XG4gKiBAcGFyYW0gQ29sb3IgYVxuICogQHBhcmFtIENvbG9yIGJcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHJldHVybiBDb2xvclxuICovXG5Db2xvci5wcm90b3R5cGUuY2xlcnAgPSBmdW5jdGlvbiAoYSwgYiwgeCkge1xuICAgIHZhciBheCA9IGEucixcbiAgICAgICAgYXkgPSBhLmcsXG4gICAgICAgIGF6ID0gYS5iO1xuXG4gICAgdGhpcy5yID0gYXggKyAoYi5yIC0gYXgpICogeDtcbiAgICB0aGlzLmcgPSBheSArIChiLmcgLSBheSkgKiB4O1xuICAgIHRoaXMuYiA9IGF6ICsgKGIuYiAtIGF6KSAqIHg7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtaW5cbiAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gKiByZXR1cm5zIG1pbiB2YWx1ZXMgZnJvbSB0aGlzIGFuZCBvdGhlciB2ZWN0b3JcbiAqIEBwYXJhbSBDb2xvciBvdGhlclxuICogQHJldHVybiBDb2xvclxuICovXG5Db2xvci5wcm90b3R5cGUubWluID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIGFyID0gdGhpcy5yLFxuICAgICAgICBhZyA9IHRoaXMuZyxcbiAgICAgICAgYWIgPSB0aGlzLmIsXG4gICAgICAgIGJyID0gb3RoZXIucixcbiAgICAgICAgYmcgPSBvdGhlci5nLFxuICAgICAgICBiYiA9IG90aGVyLmI7XG5cbiAgICB0aGlzLnIgPSBiciA8IGFyID8gYnIgOiBhcjtcbiAgICB0aGlzLmcgPSBiZyA8IGFnID8gYmcgOiBhZztcbiAgICB0aGlzLmIgPSBiYiA8IGFiID8gYmIgOiBhYjtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIG1heFxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIHJldHVybnMgbWF4IHZhbHVlcyBmcm9tIHRoaXMgYW5kIG90aGVyIHZlY3RvclxuICogQHBhcmFtIENvbG9yIG90aGVyXG4gKiBAcmV0dXJuIENvbG9yXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5tYXggPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYXIgPSB0aGlzLnIsXG4gICAgICAgIGFnID0gdGhpcy5nLFxuICAgICAgICBhYiA9IHRoaXMuYixcbiAgICAgICAgYnIgPSBvdGhlci5yLFxuICAgICAgICBiZyA9IG90aGVyLmcsXG4gICAgICAgIGJiID0gb3RoZXIuYjtcblxuICAgIHRoaXMuciA9IGJyID4gYXIgPyBiciA6IGFyO1xuICAgIHRoaXMuZyA9IGJnID4gYWcgPyBiZyA6IGFnO1xuICAgIHRoaXMuYiA9IGJiID4gYWIgPyBiYiA6IGFiO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbVZlYzJcbiAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gKiBzZXRzIHZhbHVlcyBmcm9tIFZlYzJcbiAqIEBwYXJhbSBWZWMyIHZcbiAqIEByZXR1cm4gdGhpc1xuICovXG5Db2xvci5wcm90b3R5cGUuZnJvbVZlYzIgPSBmdW5jdGlvbiAodikge1xuXG4gICAgdGhpcy5yID0gdi54O1xuICAgIHRoaXMuZyA9IHYueTtcbiAgICB0aGlzLmIgPSAwLjA7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tVmVjM1xuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIHNldHMgdmFsdWVzIGZyb20gVmVjM1xuICogQHBhcmFtIFZlYzMgdlxuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5mcm9tVmVjMyA9IGZ1bmN0aW9uICh2KSB7XG5cbiAgICB0aGlzLnIgPSB2Lng7XG4gICAgdGhpcy5nID0gdi55O1xuICAgIHRoaXMuYiA9IHYuejtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21WZWM0XG4gKiBAbWVtYmVyb2YgT2Rpbi5Db2xvclxuICogc2V0cyB2YWx1ZXMgZnJvbSBWZWM0XG4gKiBAcGFyYW0gVmVjNCB2XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuQ29sb3IucHJvdG90eXBlLmZyb21WZWM0ID0gQ29sb3IucHJvdG90eXBlLmZyb21WZWMzO1xuXG4vKipcbiAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gKiBAcGFyYW0gT2Rpbi5Db2xvciBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHJldHVybiAhKFxuICAgIHRoaXMuciAhPT0gb3RoZXIuciB8fFxuICAgIHRoaXMuZyAhPT0gb3RoZXIuZyB8fFxuICAgIHRoaXMuYiAhPT0gb3RoZXIuYlxuICAgICk7XG59O1xuXG4vKipcbiAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gKiBAcGFyYW0gT2Rpbi5Db2xvciBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5ub3RFcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHJldHVybiAoXG4gICAgdGhpcy5yICE9PSBvdGhlci5yIHx8XG4gICAgdGhpcy5nICE9PSBvdGhlci5nIHx8XG4gICAgdGhpcy5iICE9PSBvdGhlci5iXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tSlNPTlxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIHNldHMgdmFsdWVzIGZyb20gSlNPTiBvYmplY3RcbiAqIEBwYXJhbSBPYmplY3QganNvblxuICogQHJldHVybiB0aGlzXG4gKi9cbkNvbG9yLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG5cbiAgICB0aGlzLnIgPSBqc29uLnI7XG4gICAgdGhpcy5nID0ganNvbi5nO1xuICAgIHRoaXMuYiA9IGpzb24uYjtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRvSlNPTlxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIHJldHVybnMganNvbiBvYmplY3Qgb2YgdGhpc1xuICogQHJldHVybiBPYmplY3RcbiAqL1xuQ29sb3IucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiB8fCAoanNvbiA9IHt9KTtcblxuICAgIGpzb24uX2NsYXNzTmFtZSA9IFwiQ29sb3JcIjtcbiAgICBqc29uLnIgPSB0aGlzLnI7XG4gICAganNvbi5nID0gdGhpcy5nO1xuICAgIGpzb24uYiA9IHRoaXMuYjtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21BcnJheVxuICogQG1lbWJlcm9mIE9kaW4uQ29sb3JcbiAqIHNldHMgdmFsdWVzIGZyb20gQXJyYXkgb2JqZWN0XG4gKiBAcGFyYW0gQXJyYXkgYXJyYXlcbiAqIEByZXR1cm4gdGhpc1xuICovXG5Db2xvci5wcm90b3R5cGUuZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFycmF5KSB7XG5cbiAgICB0aGlzLnIgPSBhcnJheVswXTtcbiAgICB0aGlzLmcgPSBhcnJheVsxXTtcbiAgICB0aGlzLmIgPSBhcnJheVsyXTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRvQXJyYXlcbiAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gKiByZXR1cm5zIGFycmF5IG9iamVjdCBvZiB0aGlzXG4gKiBAcmV0dXJuIEFycmF5XG4gKi9cbkNvbG9yLnByb3RvdHlwZS50b0FycmF5ID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgYXJyYXkgfHwgKGFycmF5ID0gW10pO1xuXG4gICAgYXJyYXlbMF0gPSB0aGlzLnI7XG4gICAgYXJyYXlbMV0gPSB0aGlzLmc7XG4gICAgYXJyYXlbMl0gPSB0aGlzLmI7XG5cbiAgICByZXR1cm4gYXJyYXk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdG9TdHJpbmdcbiAqIEBtZW1iZXJvZiBPZGluLkNvbG9yXG4gKiByZXR1cm5zIHN0cmluZyBvZiB0aGlzXG4gKiBAcmV0dXJuIFN0cmluZ1xuICovXG5Db2xvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gXCJDb2xvciggXCIgKyB0aGlzLnIgKyBcIiwgXCIgKyB0aGlzLmcgKyBcIiwgXCIgKyB0aGlzLmIgKyBcIiApXCI7XG59O1xuXG5cbmZ1bmN0aW9uIHNpbmdsZVRvSEVYKHZhbHVlKSB7XG4gICAgdmFyIHN0ciA9ICh+fihjbGFtcDAxKHZhbHVlKSAqIDI1NSkpLnRvU3RyaW5nKDE2KTtcbiAgICByZXR1cm4gc3RyLmxlbmd0aCA9PT0gMSA/IFwiMFwiICsgc3RyIDogc3RyO1xufVxuXG5cbnZhciBjb2xvck5hbWVzID0gQ29sb3IuY29sb3JOYW1lcyA9IHtcbiAgICBhbGljZWJsdWU6IFwiI2YwZjhmZlwiLFxuICAgIGFudGlxdWV3aGl0ZTogXCIjZmFlYmQ3XCIsXG4gICAgYXF1YTogXCIjMDBmZmZmXCIsXG4gICAgYXF1YW1hcmluZTogXCIjN2ZmZmQ0XCIsXG4gICAgYXp1cmU6IFwiI2YwZmZmZlwiLFxuICAgIGJlaWdlOiBcIiNmNWY1ZGNcIixcbiAgICBiaXNxdWU6IFwiI2ZmZTRjNFwiLFxuICAgIGJsYWNrOiBcIiMwMDAwMDBcIixcbiAgICBibGFuY2hlZGFsbW9uZDogXCIjZmZlYmNkXCIsXG4gICAgYmx1ZTogXCIjMDAwMGZmXCIsXG4gICAgYmx1ZXZpb2xldDogXCIjOGEyYmUyXCIsXG4gICAgYnJvd246IFwiI2E1MmEyYVwiLFxuICAgIGJ1cmx5d29vZDogXCIjZGViODg3XCIsXG4gICAgY2FkZXRibHVlOiBcIiM1ZjllYTBcIixcbiAgICBjaGFydHJldXNlOiBcIiM3ZmZmMDBcIixcbiAgICBjaG9jb2xhdGU6IFwiI2QyNjkxZVwiLFxuICAgIGNvcmFsOiBcIiNmZjdmNTBcIixcbiAgICBjb3JuZmxvd2VyYmx1ZTogXCIjNjQ5NWVkXCIsXG4gICAgY29ybnNpbGs6IFwiI2ZmZjhkY1wiLFxuICAgIGNyaW1zb246IFwiI2RjMTQzY1wiLFxuICAgIGN5YW46IFwiIzAwZmZmZlwiLFxuICAgIGRhcmtibHVlOiBcIiMwMDAwOGJcIixcbiAgICBkYXJrY3lhbjogXCIjMDA4YjhiXCIsXG4gICAgZGFya2dvbGRlbnJvZDogXCIjYjg4NjBiXCIsXG4gICAgZGFya2dyYXk6IFwiI2E5YTlhOVwiLFxuICAgIGRhcmtncmVlbjogXCIjMDA2NDAwXCIsXG4gICAgZGFya2toYWtpOiBcIiNiZGI3NmJcIixcbiAgICBkYXJrbWFnZW50YTogXCIjOGIwMDhiXCIsXG4gICAgZGFya29saXZlZ3JlZW46IFwiIzU1NmIyZlwiLFxuICAgIGRhcmtvcmFuZ2U6IFwiI2ZmOGMwMFwiLFxuICAgIGRhcmtvcmNoaWQ6IFwiIzk5MzJjY1wiLFxuICAgIGRhcmtyZWQ6IFwiIzhiMDAwMFwiLFxuICAgIGRhcmtzYWxtb246IFwiI2U5OTY3YVwiLFxuICAgIGRhcmtzZWFncmVlbjogXCIjOGZiYzhmXCIsXG4gICAgZGFya3NsYXRlYmx1ZTogXCIjNDgzZDhiXCIsXG4gICAgZGFya3NsYXRlZ3JheTogXCIjMmY0ZjRmXCIsXG4gICAgZGFya3R1cnF1b2lzZTogXCIjMDBjZWQxXCIsXG4gICAgZGFya3Zpb2xldDogXCIjOTQwMGQzXCIsXG4gICAgZGVlcHBpbms6IFwiI2ZmMTQ5M1wiLFxuICAgIGRlZXBza3libHVlOiBcIiMwMGJmZmZcIixcbiAgICBkaW1ncmF5OiBcIiM2OTY5NjlcIixcbiAgICBkb2RnZXJibHVlOiBcIiMxZTkwZmZcIixcbiAgICBmaXJlYnJpY2s6IFwiI2IyMjIyMlwiLFxuICAgIGZsb3JhbHdoaXRlOiBcIiNmZmZhZjBcIixcbiAgICBmb3Jlc3RncmVlbjogXCIjMjI4YjIyXCIsXG4gICAgZnVjaHNpYTogXCIjZmYwMGZmXCIsXG4gICAgZ2FpbnNib3JvOiBcIiNkY2RjZGNcIixcbiAgICBnaG9zdHdoaXRlOiBcIiNmOGY4ZmZcIixcbiAgICBnb2xkOiBcIiNmZmQ3MDBcIixcbiAgICBnb2xkZW5yb2Q6IFwiI2RhYTUyMFwiLFxuICAgIGdyYXk6IFwiIzgwODA4MFwiLFxuICAgIGdyZWVuOiBcIiMwMDgwMDBcIixcbiAgICBncmVlbnllbGxvdzogXCIjYWRmZjJmXCIsXG4gICAgZ3JleTogXCIjODA4MDgwXCIsXG4gICAgaG9uZXlkZXc6IFwiI2YwZmZmMFwiLFxuICAgIGhvdHBpbms6IFwiI2ZmNjliNFwiLFxuICAgIGluZGlhbnJlZDogXCIjY2Q1YzVjXCIsXG4gICAgaW5kaWdvOiBcIiM0YjAwODJcIixcbiAgICBpdm9yeTogXCIjZmZmZmYwXCIsXG4gICAga2hha2k6IFwiI2YwZTY4Y1wiLFxuICAgIGxhdmVuZGVyOiBcIiNlNmU2ZmFcIixcbiAgICBsYXZlbmRlcmJsdXNoOiBcIiNmZmYwZjVcIixcbiAgICBsYXduZ3JlZW46IFwiIzdjZmMwMFwiLFxuICAgIGxlbW9uY2hpZmZvbjogXCIjZmZmYWNkXCIsXG4gICAgbGlnaHRibHVlOiBcIiNhZGQ4ZTZcIixcbiAgICBsaWdodGNvcmFsOiBcIiNmMDgwODBcIixcbiAgICBsaWdodGN5YW46IFwiI2UwZmZmZlwiLFxuICAgIGxpZ2h0Z29sZGVucm9keWVsbG93OiBcIiNmYWZhZDJcIixcbiAgICBsaWdodGdyZXk6IFwiI2QzZDNkM1wiLFxuICAgIGxpZ2h0Z3JlZW46IFwiIzkwZWU5MFwiLFxuICAgIGxpZ2h0cGluazogXCIjZmZiNmMxXCIsXG4gICAgbGlnaHRzYWxtb246IFwiI2ZmYTA3YVwiLFxuICAgIGxpZ2h0c2VhZ3JlZW46IFwiIzIwYjJhYVwiLFxuICAgIGxpZ2h0c2t5Ymx1ZTogXCIjODdjZWZhXCIsXG4gICAgbGlnaHRzbGF0ZWdyYXk6IFwiIzc3ODg5OVwiLFxuICAgIGxpZ2h0c3RlZWxibHVlOiBcIiNiMGM0ZGVcIixcbiAgICBsaWdodHllbGxvdzogXCIjZmZmZmUwXCIsXG4gICAgbGltZTogXCIjMDBmZjAwXCIsXG4gICAgbGltZWdyZWVuOiBcIiMzMmNkMzJcIixcbiAgICBsaW5lbjogXCIjZmFmMGU2XCIsXG4gICAgbWFnZW50YTogXCIjZmYwMGZmXCIsXG4gICAgbWFyb29uOiBcIiM4MDAwMDBcIixcbiAgICBtZWRpdW1hcXVhbWFyaW5lOiBcIiM2NmNkYWFcIixcbiAgICBtZWRpdW1ibHVlOiBcIiMwMDAwY2RcIixcbiAgICBtZWRpdW1vcmNoaWQ6IFwiI2JhNTVkM1wiLFxuICAgIG1lZGl1bXB1cnBsZTogXCIjOTM3MGQ4XCIsXG4gICAgbWVkaXVtc2VhZ3JlZW46IFwiIzNjYjM3MVwiLFxuICAgIG1lZGl1bXNsYXRlYmx1ZTogXCIjN2I2OGVlXCIsXG4gICAgbWVkaXVtc3ByaW5nZ3JlZW46IFwiIzAwZmE5YVwiLFxuICAgIG1lZGl1bXR1cnF1b2lzZTogXCIjNDhkMWNjXCIsXG4gICAgbWVkaXVtdmlvbGV0cmVkOiBcIiNjNzE1ODVcIixcbiAgICBtaWRuaWdodGJsdWU6IFwiIzE5MTk3MFwiLFxuICAgIG1pbnRjcmVhbTogXCIjZjVmZmZhXCIsXG4gICAgbWlzdHlyb3NlOiBcIiNmZmU0ZTFcIixcbiAgICBtb2NjYXNpbjogXCIjZmZlNGI1XCIsXG4gICAgbmF2YWpvd2hpdGU6IFwiI2ZmZGVhZFwiLFxuICAgIG5hdnk6IFwiIzAwMDA4MFwiLFxuICAgIG9sZGxhY2U6IFwiI2ZkZjVlNlwiLFxuICAgIG9saXZlOiBcIiM4MDgwMDBcIixcbiAgICBvbGl2ZWRyYWI6IFwiIzZiOGUyM1wiLFxuICAgIG9yYW5nZTogXCIjZmZhNTAwXCIsXG4gICAgb3JhbmdlcmVkOiBcIiNmZjQ1MDBcIixcbiAgICBvcmNoaWQ6IFwiI2RhNzBkNlwiLFxuICAgIHBhbGVnb2xkZW5yb2Q6IFwiI2VlZThhYVwiLFxuICAgIHBhbGVncmVlbjogXCIjOThmYjk4XCIsXG4gICAgcGFsZXR1cnF1b2lzZTogXCIjYWZlZWVlXCIsXG4gICAgcGFsZXZpb2xldHJlZDogXCIjZDg3MDkzXCIsXG4gICAgcGFwYXlhd2hpcDogXCIjZmZlZmQ1XCIsXG4gICAgcGVhY2hwdWZmOiBcIiNmZmRhYjlcIixcbiAgICBwZXJ1OiBcIiNjZDg1M2ZcIixcbiAgICBwaW5rOiBcIiNmZmMwY2JcIixcbiAgICBwbHVtOiBcIiNkZGEwZGRcIixcbiAgICBwb3dkZXJibHVlOiBcIiNiMGUwZTZcIixcbiAgICBwdXJwbGU6IFwiIzgwMDA4MFwiLFxuICAgIHJlZDogXCIjZmYwMDAwXCIsXG4gICAgcm9zeWJyb3duOiBcIiNiYzhmOGZcIixcbiAgICByb3lhbGJsdWU6IFwiIzQxNjllMVwiLFxuICAgIHNhZGRsZWJyb3duOiBcIiM4YjQ1MTNcIixcbiAgICBzYWxtb246IFwiI2ZhODA3MlwiLFxuICAgIHNhbmR5YnJvd246IFwiI2Y0YTQ2MFwiLFxuICAgIHNlYWdyZWVuOiBcIiMyZThiNTdcIixcbiAgICBzZWFzaGVsbDogXCIjZmZmNWVlXCIsXG4gICAgc2llbm5hOiBcIiNhMDUyMmRcIixcbiAgICBzaWx2ZXI6IFwiI2MwYzBjMFwiLFxuICAgIHNreWJsdWU6IFwiIzg3Y2VlYlwiLFxuICAgIHNsYXRlYmx1ZTogXCIjNmE1YWNkXCIsXG4gICAgc2xhdGVncmF5OiBcIiM3MDgwOTBcIixcbiAgICBzbm93OiBcIiNmZmZhZmFcIixcbiAgICBzcHJpbmdncmVlbjogXCIjMDBmZjdmXCIsXG4gICAgc3RlZWxibHVlOiBcIiM0NjgyYjRcIixcbiAgICB0YW46IFwiI2QyYjQ4Y1wiLFxuICAgIHRlYWw6IFwiIzAwODA4MFwiLFxuICAgIHRoaXN0bGU6IFwiI2Q4YmZkOFwiLFxuICAgIHRvbWF0bzogXCIjZmY2MzQ3XCIsXG4gICAgdHVycXVvaXNlOiBcIiM0MGUwZDBcIixcbiAgICB2aW9sZXQ6IFwiI2VlODJlZVwiLFxuICAgIHdoZWF0OiBcIiNmNWRlYjNcIixcbiAgICB3aGl0ZTogXCIjZmZmZmZmXCIsXG4gICAgd2hpdGVzbW9rZTogXCIjZjVmNWY1XCIsXG4gICAgeWVsbG93OiBcIiNmZmZmMDBcIixcbiAgICB5ZWxsb3dncmVlbjogXCIjOWFjZDMyXCJcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBDb2xvcjtcbiIsInZhciBNYXRoZiA9IHJlcXVpcmUoXCIuL21hdGhmXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGNvcyA9IE1hdGguY29zLFxuICAgIHNpbiA9IE1hdGguc2luLFxuICAgIGF0YW4yID0gTWF0aC5hdGFuMjtcblxuLyoqXG4gKiBAY2xhc3MgTWF0MlxuICogMngyIG1hdHJpeFxuICogQHBhcmFtIE51bWJlciBtMTFcbiAqIEBwYXJhbSBOdW1iZXIgbTEyXG4gKiBAcGFyYW0gTnVtYmVyIG0yMVxuICogQHBhcmFtIE51bWJlciBtMjJcbiAqL1xuZnVuY3Rpb24gTWF0MihtMTEsIG0xMiwgbTIxLCBtMjIpIHtcbiAgICB2YXIgdGUgPSBuZXcgRmxvYXQzMkFycmF5KDQpO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IEZsb2F0MzJBcnJheSBlbGVtZW50c1xuICAgICAqIEBtZW1iZXJvZiBPZGluLk1hdDJcbiAgICAgKi9cbiAgICB0aGlzLmVsZW1lbnRzID0gdGU7XG5cbiAgICB0ZVswXSA9IG0xMSAhPSB1bmRlZmluZWQgPyBtMTEgOiAxLjA7XG4gICAgdGVbMl0gPSBtMTIgfHwgMC4wO1xuICAgIHRlWzFdID0gbTIxIHx8IDAuMDtcbiAgICB0ZVszXSA9IG0yMiAhPSB1bmRlZmluZWQgPyBtMjIgOiAxLjA7XG59XG5cbk1hdGhmLl9jbGFzc2VzW1wiTWF0MlwiXSA9IE1hdDI7XG5cbi8qKlxuICogQG1ldGhvZCBjbG9uZVxuICogQG1lbWJlcm9mIE9kaW4uTWF0MlxuICogcmV0dXJucyBuZXcgaW5zdGFuY2Ugb2YgdGhpc1xuICogQHJldHVybiBNYXQyXG4gKi9cbk1hdDIucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICByZXR1cm4gbmV3IE1hdDIoXG4gICAgICAgIHRlWzBdLCB0ZVsxXSxcbiAgICAgICAgdGVbMl0sIHRlWzNdXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjb3B5XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQyXG4gKiBjb3BpZXMgb3RoZXJcbiAqIEBwYXJhbSBNYXQyIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0Mi5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIG1lID0gb3RoZXIuZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IG1lWzBdO1xuICAgIHRlWzFdID0gbWVbMV07XG4gICAgdGVbMl0gPSBtZVsyXTtcbiAgICB0ZVszXSA9IG1lWzNdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQyXG4gKiBzZXRzIHZhbHVlcyBvZiB0aGlzXG4gKiBAcGFyYW0gTnVtYmVyIG0xMVxuICogQHBhcmFtIE51bWJlciBtMTJcbiAqIEBwYXJhbSBOdW1iZXIgbTIxXG4gKiBAcGFyYW0gTnVtYmVyIG0yMlxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChtMTEsIG0xMiwgbTIxLCBtMjIpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgdGVbMF0gPSBtMTE7XG4gICAgdGVbMl0gPSBtMTI7XG4gICAgdGVbMV0gPSBtMjE7XG4gICAgdGVbM10gPSBtMjI7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtdWxcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDJcbiAqIG11bGlwbGVzIHRoaXMncyB2YWx1ZXMgYnkgb3RoZXInc1xuICogQHBhcmFtIE1hdDIgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQyLnByb3RvdHlwZS5tdWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYWUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBiZSA9IG90aGVyLmVsZW1lbnRzLFxuXG4gICAgICAgIGExMSA9IGFlWzBdLFxuICAgICAgICBhMTIgPSBhZVsyXSxcbiAgICAgICAgYTIxID0gYWVbMV0sXG4gICAgICAgIGEyMiA9IGFlWzNdLFxuXG4gICAgICAgIGIxMSA9IGJlWzBdLFxuICAgICAgICBiMTIgPSBiZVsyXSxcbiAgICAgICAgYjIxID0gYmVbMV0sXG4gICAgICAgIGIyMiA9IGJlWzNdO1xuXG4gICAgYWVbMF0gPSBhMTEgKiBiMTEgKyBhMjEgKiBiMTI7XG4gICAgYWVbMV0gPSBhMTIgKiBiMTEgKyBhMjIgKiBiMTI7XG5cbiAgICBhZVsyXSA9IGExMSAqIGIyMSArIGEyMSAqIGIyMjtcbiAgICBhZVszXSA9IGExMiAqIGIyMSArIGEyMiAqIGIyMjtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIG1tdWxcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDJcbiAqIG11bGlwbGVzIGEgYW5kIGIgc2F2ZXMgaXQgaW4gdGhpc1xuICogQHBhcmFtIE1hdDIgYVxuICogQHBhcmFtIE1hdDIgYlxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDIucHJvdG90eXBlLm1tdWwgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIGFlID0gYS5lbGVtZW50cyxcbiAgICAgICAgYmUgPSBiLmVsZW1lbnRzLFxuXG4gICAgICAgIGExMSA9IGFlWzBdLFxuICAgICAgICBhMTIgPSBhZVsyXSxcbiAgICAgICAgYTIxID0gYWVbMV0sXG4gICAgICAgIGEyMiA9IGFlWzNdLFxuXG4gICAgICAgIGIxMSA9IGJlWzBdLFxuICAgICAgICBiMTIgPSBiZVsyXSxcbiAgICAgICAgYjIxID0gYmVbMV0sXG4gICAgICAgIGIyMiA9IGJlWzNdO1xuXG4gICAgdGVbMF0gPSBhMTEgKiBiMTEgKyBhMjEgKiBiMTI7XG4gICAgdGVbMV0gPSBhMTIgKiBiMTEgKyBhMjIgKiBiMTI7XG5cbiAgICB0ZVsyXSA9IGExMSAqIGIyMSArIGEyMSAqIGIyMjtcbiAgICB0ZVszXSA9IGExMiAqIGIyMSArIGEyMiAqIGIyMjtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNtdWxcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDJcbiAqIG11bGlwbGVzIHRoaXMgYnkgYSBzY2FsYXIgdmFsdWVcbiAqIEBwYXJhbSBOdW1iZXIgc1xuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDIucHJvdG90eXBlLnNtdWwgPSBmdW5jdGlvbiAocykge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICB0ZVswXSAqPSBzO1xuICAgIHRlWzFdICo9IHM7XG4gICAgdGVbMl0gKj0gcztcbiAgICB0ZVszXSAqPSBzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2RpdlxuICogQG1lbWJlcm9mIE9kaW4uTWF0MlxuICogZGl2aWRlcyB0aGlzIGJ5IHNjYWxhciB2YWx1ZVxuICogQHBhcmFtIE51bWJlciBzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0Mi5wcm90b3R5cGUuc2RpdiA9IGZ1bmN0aW9uIChzKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHMgPSBzICE9PSAwLjAgPyAxLjAgLyBzIDogMS4wO1xuXG4gICAgdGVbMF0gKj0gcztcbiAgICB0ZVsxXSAqPSBzO1xuICAgIHRlWzJdICo9IHM7XG4gICAgdGVbM10gKj0gcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGlkZW50aXR5XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQyXG4gKiBpZGVudGl0eSBtYXRyaXhcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQyLnByb3RvdHlwZS5pZGVudGl0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgdGVbMF0gPSAxO1xuICAgIHRlWzFdID0gMC4wO1xuICAgIHRlWzJdID0gMC4wO1xuICAgIHRlWzNdID0gMTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHplcm9cbiAqIEBtZW1iZXJvZiBPZGluLk1hdDJcbiAqIHplcm8gbWF0cml4XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0Mi5wcm90b3R5cGUuemVybyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgdGVbMF0gPSAwLjA7XG4gICAgdGVbMV0gPSAwLjA7XG4gICAgdGVbMl0gPSAwLjA7XG4gICAgdGVbM10gPSAwLjA7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBkZXRlcm1pbmFudFxuICogQG1lbWJlcm9mIE9kaW4uTWF0MlxuICogcmV0dXJucyB0aGUgZGV0ZXJtaW5hbnQgb2YgdGhpc1xuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDIucHJvdG90eXBlLmRldGVybWluYW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICByZXR1cm4gdGVbMF0gKiB0ZVszXSAtIHRlWzJdICogdGVbMV07XG59O1xuXG4vKipcbiAqIEBtZXRob2QgaW52ZXJzZVxuICogQG1lbWJlcm9mIE9kaW4uTWF0MlxuICogcmV0dXJucyB0aGUgaW52ZXJzZSBvZiB0aGlzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0Mi5wcm90b3R5cGUuaW52ZXJzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuXG4gICAgICAgIG0xMSA9IHRlWzBdLFxuICAgICAgICBtMTIgPSB0ZVsyXSxcbiAgICAgICAgbTIxID0gdGVbMV0sXG4gICAgICAgIG0yMiA9IHRlWzNdLFxuXG4gICAgICAgIGRldCA9IG0xMSAqIG0yMiAtIG0xMiAqIG0yMTtcblxuICAgIGlmIChkZXQgPT09IDAuMCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pZGVudGl0eSgpO1xuICAgIH1cbiAgICBkZXQgPSAxLjAgLyBkZXQ7XG5cbiAgICB0ZVswXSA9IG0yMiAqIGRldDtcbiAgICB0ZVsxXSA9IC1tMTIgKiBkZXQ7XG4gICAgdGVbMl0gPSAtbTIxICogZGV0O1xuICAgIHRlWzNdID0gbTExICogZGV0O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgaW52ZXJzZU1hdFxuICogQG1lbWJlcm9mIE9kaW4uTWF0MlxuICogcmV0dXJucyB0aGUgaW52ZXJzZSBvZiBvdGhlclxuICogQHBhcmFtIE1hdDIgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQyLnByb3RvdHlwZS5pbnZlcnNlTWF0ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgbWUgPSBvdGhlci5lbGVtZW50cyxcblxuICAgICAgICBtMTEgPSBtZVswXSxcbiAgICAgICAgbTEyID0gbWVbMl0sXG4gICAgICAgIG0yMSA9IG1lWzFdLFxuICAgICAgICBtMjIgPSBtZVszXSxcblxuICAgICAgICBkZXQgPSBtMTEgKiBtMjIgLSBtMTIgKiBtMjE7XG5cbiAgICBpZiAoZGV0ID09PSAwLjApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaWRlbnRpdHkoKTtcbiAgICB9XG4gICAgZGV0ID0gMS4wIC8gZGV0O1xuXG4gICAgdGVbMF0gPSBtMjIgKiBkZXQ7XG4gICAgdGVbMV0gPSAtbTEyICogZGV0O1xuICAgIHRlWzJdID0gLW0yMSAqIGRldDtcbiAgICB0ZVszXSA9IG0xMSAqIGRldDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRyYW5zcG9zZVxuICogQG1lbWJlcm9mIE9kaW4uTWF0MlxuICogdHJhbnNwb3NlcyB0aGlzIG1hdHJpeFxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDIucHJvdG90eXBlLnRyYW5zcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICB0bXA7XG5cbiAgICB0bXAgPSB0ZVsxXTtcbiAgICB0ZVsxXSA9IHRlWzJdO1xuICAgIHRlWzJdID0gdG1wO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0VHJhY2VcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDJcbiAqIHNldHMgdGhlIGRpYWdvbmFsIG9mIG1hdHJpeFxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcGFyYW0gTnVtYmVyIHlcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQyLnByb3RvdHlwZS5zZXRUcmFjZSA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHRlWzBdID0geDtcbiAgICB0ZVszXSA9IHk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZXRSb3RhdGlvblxuICogQG1lbWJlcm9mIE9kaW4uTWF0MlxuICogc2V0cyB0aGUgcm90YXRpb24gaW4gcmFkaWFucyB0aGlzXG4gKiBAcGFyYW0gTnVtYmVyIGFuZ2xlXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0Mi5wcm90b3R5cGUuc2V0Um90YXRpb24gPSBmdW5jdGlvbiAoYW5nbGUpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBjID0gY29zKGFuZ2xlKSxcbiAgICAgICAgcyA9IHNpbihhbmdsZSk7XG5cbiAgICB0ZVswXSA9IGM7XG4gICAgdGVbMV0gPSBzO1xuICAgIHRlWzJdID0gLXM7XG4gICAgdGVbM10gPSBjO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZ2V0Um90YXRpb25cbiAqIEBtZW1iZXJvZiBPZGluLk1hdDJcbiAqIHJldHVybnMgdGhlIHJvdGF0aW9uIGluIHJhZGlhbnMgb2YgdGhpc1xuICogQHJldHVybiBOdW1iZXJcbiAqL1xuTWF0Mi5wcm90b3R5cGUuZ2V0Um90YXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHJldHVybiBhdGFuMih0ZVsxXSwgdGVbMF0pO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHJvdGF0ZVxuICogQG1lbWJlcm9mIE9kaW4uTWF0MlxuICogcm90YXRlcyB0aGlzIGJ5IGFuZ2xlIGluIHJhZGlhbnNcbiAqIEBwYXJhbSBOdW1iZXIgYW5nbGVcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQyLnByb3RvdHlwZS5yb3RhdGUgPSBmdW5jdGlvbiAoYW5nbGUpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuXG4gICAgICAgIG0xMSA9IHRlWzBdLFxuICAgICAgICBtMTIgPSB0ZVsyXSxcbiAgICAgICAgbTIxID0gdGVbMV0sXG4gICAgICAgIG0yMiA9IHRlWzNdLFxuXG4gICAgICAgIHMgPSBzaW4oYW5nbGUpLFxuICAgICAgICBjID0gc2luKGFuZ2xlKTtcblxuICAgIHRlWzBdID0gbTExICogYyArIG0xMiAqIHM7XG4gICAgdGVbMV0gPSBtMTEgKiAtcyArIG0xMiAqIGM7XG4gICAgdGVbMl0gPSBtMjEgKiBjICsgbTIyICogcztcbiAgICB0ZVszXSA9IG0yMSAqIC1zICsgbTIyICogYztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21NYXQzXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQyXG4gKiBzZXRzIHRoaXMgZnJvbSBNYXQzXG4gKiBAcGFyYW0gTWF0MyBtXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0Mi5wcm90b3R5cGUuZnJvbU1hdDMgPSBmdW5jdGlvbiAobSkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIG1lID0gbS5lbGVtZW50cztcblxuICAgIHRlWzBdID0gbWVbMF07XG4gICAgdGVbMV0gPSBtZVsxXTtcbiAgICB0ZVsyXSA9IG1lWzNdO1xuICAgIHRlWzNdID0gbWVbNF07XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tTWF0NFxuICogQG1lbWJlcm9mIE9kaW4uTWF0MlxuICogc2V0cyB0aGlzIGZyb20gTWF0NFxuICogQHBhcmFtIE1hdDQgbVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDIucHJvdG90eXBlLmZyb21NYXQ0ID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBtZSA9IG0uZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IG1lWzBdO1xuICAgIHRlWzFdID0gbWVbMV07XG4gICAgdGVbMl0gPSBtZVs0XTtcbiAgICB0ZVszXSA9IG1lWzVdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDJcbiAqIEBwYXJhbSBPZGluLk1hdDIgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQyLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYWUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBiZSA9IG90aGVyLmVsZW1lbnRzO1xuXG4gICAgcmV0dXJuICEoXG4gICAgYWVbMF0gIT09IGJlWzBdIHx8XG4gICAgYWVbMV0gIT09IGJlWzFdIHx8XG4gICAgYWVbMl0gIT09IGJlWzJdIHx8XG4gICAgYWVbM10gIT09IGJlWzNdXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1lbWJlcm9mIE9kaW4uTWF0MlxuICogQHBhcmFtIE9kaW4uTWF0MiBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDIucHJvdG90eXBlLm5vdEVxdWFscyA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciBhZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIGJlID0gb3RoZXIuZWxlbWVudHM7XG5cbiAgICByZXR1cm4gKFxuICAgIGFlWzBdICE9PSBiZVswXSB8fFxuICAgIGFlWzFdICE9PSBiZVsxXSB8fFxuICAgIGFlWzJdICE9PSBiZVsyXSB8fFxuICAgIGFlWzNdICE9PSBiZVszXVxuICAgICk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbUpTT05cbiAqIEBtZW1iZXJvZiBPZGluLk1hdDJcbiAqIHNldHMgdmFsdWVzIGZyb20gSlNPTiBvYmplY3RcbiAqIEBwYXJhbSBPYmplY3QganNvblxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDIucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBtZSA9IGpzb24uZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IG1lWzBdO1xuICAgIHRlWzFdID0gbWVbMV07XG4gICAgdGVbMl0gPSBtZVsyXTtcbiAgICB0ZVszXSA9IG1lWzNdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdG9KU09OXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQyXG4gKiByZXR1cm5zIGpzb24gb2JqZWN0IG9mIHRoaXNcbiAqIEByZXR1cm4gT2JqZWN0XG4gKi9cbk1hdDIucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiB8fCAoanNvbiA9IHt9KTtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBqZSA9IGpzb24uZWxlbWVudHMgfHwgKGpzb24uZWxlbWVudHMgPSBbXSk7XG5cbiAgICBqc29uLl9jbGFzc05hbWUgPSBcIk1hdDJcIjtcbiAgICBqZVswXSA9IHRlWzBdO1xuICAgIGplWzFdID0gdGVbMV07XG4gICAgamVbMl0gPSB0ZVsyXTtcbiAgICBqZVszXSA9IHRlWzNdO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbUFycmF5XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQyXG4gKiBzZXRzIHZhbHVlcyBmcm9tIEFycmF5IG9iamVjdFxuICogQHBhcmFtIE9iamVjdCBqc29uXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0Mi5wcm90b3R5cGUuZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHRlWzBdID0gYXJyYXlbMF07XG4gICAgdGVbMV0gPSBhcnJheVsxXTtcbiAgICB0ZVsyXSA9IGFycmF5WzJdO1xuICAgIHRlWzNdID0gYXJyYXlbM107XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b0FycmF5XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQyXG4gKiByZXR1cm5zIGFycmF5IG9iamVjdCBvZiB0aGlzXG4gKiBAcmV0dXJuIE9iamVjdFxuICovXG5NYXQyLnByb3RvdHlwZS50b0FycmF5ID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgYXJyYXkgfHwgKGFycmF5ID0gW10pO1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICBhcnJheVswXSA9IHRlWzBdO1xuICAgIGFycmF5WzFdID0gdGVbMV07XG4gICAgYXJyYXlbMl0gPSB0ZVsyXTtcbiAgICBhcnJheVszXSA9IHRlWzNdO1xuXG4gICAgcmV0dXJuIGFycmF5O1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRvU3RyaW5nXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQyXG4gKiByZXR1cm5zIHN0cmluZyBvZiB0aGlzXG4gKiBAcmV0dXJuIFN0cmluZ1xuICovXG5NYXQyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgcmV0dXJuIChcbiAgICBcIk1hdDJbIFwiICsgdGVbMF0gKyBcIiwgXCIgKyB0ZVsyXSArIFwiXVxcblwiICtcbiAgICBcIiAgICAgWyBcIiArIHRlWzFdICsgXCIsIFwiICsgdGVbM10gKyBcIl1cIlxuICAgICk7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gTWF0MjtcbiIsInZhciBNYXRoZiA9IHJlcXVpcmUoXCIuL21hdGhmXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGNvcyA9IE1hdGguY29zLFxuICAgIHNpbiA9IE1hdGguc2luO1xuXG4vKipcbiAqIEBjbGFzcyBNYXQzXG4gKiAzeDMgbWF0cml4XG4gKiBAcGFyYW0gTnVtYmVyIG0xMVxuICogQHBhcmFtIE51bWJlciBtMTJcbiAqIEBwYXJhbSBOdW1iZXIgbTEzXG4gKiBAcGFyYW0gTnVtYmVyIG0yMVxuICogQHBhcmFtIE51bWJlciBtMjJcbiAqIEBwYXJhbSBOdW1iZXIgbTIzXG4gKiBAcGFyYW0gTnVtYmVyIG0zMVxuICogQHBhcmFtIE51bWJlciBtMzJcbiAqIEBwYXJhbSBOdW1iZXIgbTMzXG4gKi9cbmZ1bmN0aW9uIE1hdDMobTExLCBtMTIsIG0xMywgbTIxLCBtMjIsIG0yMywgbTMxLCBtMzIsIG0zMykge1xuICAgIHZhciB0ZSA9IG5ldyBGbG9hdDMyQXJyYXkoOSk7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgRmxvYXQzMkFycmF5IGVsZW1lbnRzXG4gICAgICogQG1lbWJlcm9mIE9kaW4uTWF0M1xuICAgICAqL1xuICAgIHRoaXMuZWxlbWVudHMgPSB0ZTtcblxuICAgIHRlWzBdID0gbTExICE9IHVuZGVmaW5lZCA/IG0xMSA6IDEuMDtcbiAgICB0ZVszXSA9IG0xMiB8fCAwLjA7XG4gICAgdGVbNl0gPSBtMTMgfHwgMC4wO1xuICAgIHRlWzFdID0gbTIxIHx8IDAuMDtcbiAgICB0ZVs0XSA9IG0yMiAhPSB1bmRlZmluZWQgPyBtMjIgOiAxLjA7XG4gICAgdGVbN10gPSBtMjMgfHwgMC4wO1xuICAgIHRlWzJdID0gbTMxIHx8IDAuMDtcbiAgICB0ZVs1XSA9IG0zMiB8fCAwLjA7XG4gICAgdGVbOF0gPSBtMzMgIT0gdW5kZWZpbmVkID8gbTMzIDogMS4wO1xufVxuXG5NYXRoZi5fY2xhc3Nlc1tcIk1hdDNcIl0gPSBNYXQzO1xuXG4vKipcbiAqIEBtZXRob2QgY2xvbmVcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDNcbiAqIHJldHVybnMgbmV3IGluc3RhbmNlIG9mIHRoaXNcbiAqIEByZXR1cm4gTWF0M1xuICovXG5NYXQzLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgcmV0dXJuIG5ldyBNYXQzKFxuICAgICAgICB0ZVswXSwgdGVbM10sIHRlWzZdLFxuICAgICAgICB0ZVsxXSwgdGVbNF0sIHRlWzddLFxuICAgICAgICB0ZVsyXSwgdGVbNV0sIHRlWzhdXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjb3B5XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBjb3BpZXMgb3RoZXJcbiAqIEBwYXJhbSBNYXQzIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0My5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIG1lID0gb3RoZXIuZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IG1lWzBdO1xuICAgIHRlWzFdID0gbWVbMV07XG4gICAgdGVbMl0gPSBtZVsyXTtcbiAgICB0ZVszXSA9IG1lWzNdO1xuICAgIHRlWzRdID0gbWVbNF07XG4gICAgdGVbNV0gPSBtZVs1XTtcbiAgICB0ZVs2XSA9IG1lWzZdO1xuICAgIHRlWzddID0gbWVbN107XG4gICAgdGVbOF0gPSBtZVs4XTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNldFxuICogQG1lbWJlcm9mIE9kaW4uTWF0M1xuICogc2V0cyB2YWx1ZXMgb2YgdGhpc1xuICogQHBhcmFtIE51bWJlciBtMTFcbiAqIEBwYXJhbSBOdW1iZXIgbTEyXG4gKiBAcGFyYW0gTnVtYmVyIG0xM1xuICogQHBhcmFtIE51bWJlciBtMjFcbiAqIEBwYXJhbSBOdW1iZXIgbTIyXG4gKiBAcGFyYW0gTnVtYmVyIG0yM1xuICogQHBhcmFtIE51bWJlciBtMzFcbiAqIEBwYXJhbSBOdW1iZXIgbTMyXG4gKiBAcGFyYW0gTnVtYmVyIG0zM1xuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChtMTEsIG0xMiwgbTEzLCBtMjEsIG0yMiwgbTIzLCBtMzEsIG0zMiwgbTMzKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHRlWzBdID0gbTExO1xuICAgIHRlWzNdID0gbTEyO1xuICAgIHRlWzZdID0gbTEzO1xuICAgIHRlWzFdID0gbTIxO1xuICAgIHRlWzRdID0gbTIyO1xuICAgIHRlWzddID0gbTIzO1xuICAgIHRlWzJdID0gbTMxO1xuICAgIHRlWzVdID0gbTMyO1xuICAgIHRlWzhdID0gbTMzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbXVsXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBtdWxpcGxlcyB0aGlzJ3MgdmFsdWVzIGJ5IG90aGVyJ3NcbiAqIEBwYXJhbSBNYXQzIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0My5wcm90b3R5cGUubXVsID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIGFlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgYmUgPSBvdGhlci5lbGVtZW50cyxcblxuICAgICAgICBhMTEgPSBhZVswXSxcbiAgICAgICAgYTEyID0gYWVbM10sXG4gICAgICAgIGExMyA9IGFlWzZdLFxuICAgICAgICBhMjEgPSBhZVsxXSxcbiAgICAgICAgYTIyID0gYWVbNF0sXG4gICAgICAgIGEyMyA9IGFlWzddLFxuICAgICAgICBhMzEgPSBhZVsyXSxcbiAgICAgICAgYTMyID0gYWVbNV0sXG4gICAgICAgIGEzMyA9IGFlWzhdLFxuXG4gICAgICAgIGIxMSA9IGJlWzBdLFxuICAgICAgICBiMTIgPSBiZVszXSxcbiAgICAgICAgYjEzID0gYmVbNl0sXG4gICAgICAgIGIyMSA9IGJlWzFdLFxuICAgICAgICBiMjIgPSBiZVs0XSxcbiAgICAgICAgYjIzID0gYmVbN10sXG4gICAgICAgIGIzMSA9IGJlWzJdLFxuICAgICAgICBiMzIgPSBiZVs1XSxcbiAgICAgICAgYjMzID0gYmVbOF07XG5cbiAgICBhZVswXSA9IGExMSAqIGIxMSArIGEyMSAqIGIxMiArIGEzMSAqIGIxMztcbiAgICBhZVszXSA9IGExMiAqIGIxMSArIGEyMiAqIGIxMiArIGEzMiAqIGIxMztcbiAgICBhZVs2XSA9IGExMyAqIGIxMSArIGEyMyAqIGIxMiArIGEzMyAqIGIxMztcblxuICAgIGFlWzFdID0gYTExICogYjIxICsgYTIxICogYjIyICsgYTMxICogYjIzO1xuICAgIGFlWzRdID0gYTEyICogYjIxICsgYTIyICogYjIyICsgYTMyICogYjIzO1xuICAgIGFlWzddID0gYTEzICogYjIxICsgYTIzICogYjIyICsgYTMzICogYjIzO1xuXG4gICAgYWVbMl0gPSBhMTEgKiBiMzEgKyBhMjEgKiBiMzIgKyBhMzEgKiBiMzM7XG4gICAgYWVbNV0gPSBhMTIgKiBiMzEgKyBhMjIgKiBiMzIgKyBhMzIgKiBiMzM7XG4gICAgYWVbOF0gPSBhMTMgKiBiMzEgKyBhMjMgKiBiMzIgKyBhMzMgKiBiMzM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtbXVsXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBtdWxpcGxlcyBhIGFuZCBiIHNhdmVzIGl0IGluIHRoaXNcbiAqIEBwYXJhbSBNYXQzIGFcbiAqIEBwYXJhbSBNYXQzIGJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5tbXVsID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBhZSA9IGEuZWxlbWVudHMsXG4gICAgICAgIGJlID0gYi5lbGVtZW50cyxcblxuICAgICAgICBhMTEgPSBhZVswXSxcbiAgICAgICAgYTEyID0gYWVbM10sXG4gICAgICAgIGExMyA9IGFlWzZdLFxuICAgICAgICBhMjEgPSBhZVsxXSxcbiAgICAgICAgYTIyID0gYWVbNF0sXG4gICAgICAgIGEyMyA9IGFlWzddLFxuICAgICAgICBhMzEgPSBhZVsyXSxcbiAgICAgICAgYTMyID0gYWVbNV0sXG4gICAgICAgIGEzMyA9IGFlWzhdLFxuXG4gICAgICAgIGIxMSA9IGJlWzBdLFxuICAgICAgICBiMTIgPSBiZVszXSxcbiAgICAgICAgYjEzID0gYmVbNl0sXG4gICAgICAgIGIyMSA9IGJlWzFdLFxuICAgICAgICBiMjIgPSBiZVs0XSxcbiAgICAgICAgYjIzID0gYmVbN10sXG4gICAgICAgIGIzMSA9IGJlWzJdLFxuICAgICAgICBiMzIgPSBiZVs1XSxcbiAgICAgICAgYjMzID0gYmVbOF07XG5cbiAgICB0ZVswXSA9IGExMSAqIGIxMSArIGEyMSAqIGIxMiArIGEzMSAqIGIxMztcbiAgICB0ZVszXSA9IGExMiAqIGIxMSArIGEyMiAqIGIxMiArIGEzMiAqIGIxMztcbiAgICB0ZVs2XSA9IGExMyAqIGIxMSArIGEyMyAqIGIxMiArIGEzMyAqIGIxMztcblxuICAgIHRlWzFdID0gYTExICogYjIxICsgYTIxICogYjIyICsgYTMxICogYjIzO1xuICAgIHRlWzRdID0gYTEyICogYjIxICsgYTIyICogYjIyICsgYTMyICogYjIzO1xuICAgIHRlWzddID0gYTEzICogYjIxICsgYTIzICogYjIyICsgYTMzICogYjIzO1xuXG4gICAgdGVbMl0gPSBhMTEgKiBiMzEgKyBhMjEgKiBiMzIgKyBhMzEgKiBiMzM7XG4gICAgdGVbNV0gPSBhMTIgKiBiMzEgKyBhMjIgKiBiMzIgKyBhMzIgKiBiMzM7XG4gICAgdGVbOF0gPSBhMTMgKiBiMzEgKyBhMjMgKiBiMzIgKyBhMzMgKiBiMzM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzbXVsXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBtdWxpcGxlcyB0aGlzIGJ5IGEgc2NhbGFyIHZhbHVlXG4gKiBAcGFyYW0gTnVtYmVyIHNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5zbXVsID0gZnVuY3Rpb24gKHMpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgdGVbMF0gKj0gcztcbiAgICB0ZVsxXSAqPSBzO1xuICAgIHRlWzJdICo9IHM7XG4gICAgdGVbM10gKj0gcztcbiAgICB0ZVs0XSAqPSBzO1xuICAgIHRlWzVdICo9IHM7XG4gICAgdGVbNl0gKj0gcztcbiAgICB0ZVs3XSAqPSBzO1xuICAgIHRlWzhdICo9IHM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZGl2XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBkaXZpZGVzIHRoaXMgYnkgc2NhbGFyIHZhbHVlXG4gKiBAcGFyYW0gTnVtYmVyIHNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5zZGl2ID0gZnVuY3Rpb24gKHMpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgcyA9IHMgPT09IDAuMCA/IDAuMCA6IDEuMCAvIHM7XG5cbiAgICB0ZVswXSAqPSBzO1xuICAgIHRlWzFdICo9IHM7XG4gICAgdGVbMl0gKj0gcztcbiAgICB0ZVszXSAqPSBzO1xuICAgIHRlWzRdICo9IHM7XG4gICAgdGVbNV0gKj0gcztcbiAgICB0ZVs2XSAqPSBzO1xuICAgIHRlWzddICo9IHM7XG4gICAgdGVbOF0gKj0gcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGlkZW50aXR5XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBpZGVudGl0eSBtYXRyaXhcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5pZGVudGl0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgdGVbMF0gPSAxO1xuICAgIHRlWzFdID0gMC4wO1xuICAgIHRlWzJdID0gMC4wO1xuICAgIHRlWzNdID0gMC4wO1xuICAgIHRlWzRdID0gMTtcbiAgICB0ZVs1XSA9IDAuMDtcbiAgICB0ZVs2XSA9IDAuMDtcbiAgICB0ZVs3XSA9IDAuMDtcbiAgICB0ZVs4XSA9IDE7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB6ZXJvXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiB6ZXJvIG1hdHJpeFxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMucHJvdG90eXBlLnplcm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHRlWzBdID0gMC4wO1xuICAgIHRlWzFdID0gMC4wO1xuICAgIHRlWzJdID0gMC4wO1xuICAgIHRlWzNdID0gMC4wO1xuICAgIHRlWzRdID0gMC4wO1xuICAgIHRlWzVdID0gMC4wO1xuICAgIHRlWzZdID0gMC4wO1xuICAgIHRlWzddID0gMC4wO1xuICAgIHRlWzhdID0gMC4wO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZGV0ZXJtaW5hbnRcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDNcbiAqIHJldHVybnMgdGhlIGRldGVybWluYW50IG9mIHRoaXNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5kZXRlcm1pbmFudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuXG4gICAgICAgIGEgPSB0ZVswXSxcbiAgICAgICAgYiA9IHRlWzFdLFxuICAgICAgICBjID0gdGVbMl0sXG4gICAgICAgIGQgPSB0ZVszXSxcbiAgICAgICAgZSA9IHRlWzRdLFxuICAgICAgICBmID0gdGVbNV0sXG4gICAgICAgIGcgPSB0ZVs2XSxcbiAgICAgICAgaCA9IHRlWzddLFxuICAgICAgICBpID0gdGVbOF07XG5cbiAgICByZXR1cm4gYSAqIGUgKiBpIC0gYSAqIGYgKiBoIC0gYiAqIGQgKiBpICsgYiAqIGYgKiBnICsgYyAqIGQgKiBoIC0gYyAqIGUgKiBnO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGludmVyc2VcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDNcbiAqIHJldHVybnMgdGhlIGludmVyc2Ugb2YgdGhpc1xuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgbTExID0gdGVbMF0sXG4gICAgICAgIG0xMiA9IHRlWzNdLFxuICAgICAgICBtMTMgPSB0ZVs2XSxcbiAgICAgICAgbTIxID0gdGVbMV0sXG4gICAgICAgIG0yMiA9IHRlWzRdLFxuICAgICAgICBtMjMgPSB0ZVs3XSxcbiAgICAgICAgbTMxID0gdGVbMl0sXG4gICAgICAgIG0zMiA9IHRlWzVdLFxuICAgICAgICBtMzMgPSB0ZVs4XSxcblxuICAgICAgICBtMCA9IG0yMiAqIG0zMyAtIG0yMyAqIG0zMixcbiAgICAgICAgbTMgPSBtMTMgKiBtMzIgLSBtMTIgKiBtMzMsXG4gICAgICAgIG02ID0gbTEyICogbTIzIC0gbTEzICogbTIyLFxuXG4gICAgICAgIGRldCA9IG0xMSAqIG0wICsgbTIxICogbTMgKyBtMzEgKiBtNjtcblxuICAgIGlmIChkZXQgPT09IDAuMCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pZGVudGl0eSgpO1xuICAgIH1cbiAgICBkZXQgPSAxLjAgLyBkZXQ7XG5cbiAgICB0ZVswXSA9IG0wICogZGV0O1xuICAgIHRlWzFdID0gKG0yMyAqIG0zMSAtIG0yMSAqIG0zMykgKiBkZXQ7XG4gICAgdGVbMl0gPSAobTIxICogbTMyIC0gbTIyICogbTMxKSAqIGRldDtcblxuICAgIHRlWzNdID0gbTMgKiBkZXQ7XG4gICAgdGVbNF0gPSAobTExICogbTMzIC0gbTEzICogbTMxKSAqIGRldDtcbiAgICB0ZVs1XSA9IChtMTIgKiBtMzEgLSBtMTEgKiBtMzIpICogZGV0O1xuXG4gICAgdGVbNl0gPSBtNiAqIGRldDtcbiAgICB0ZVs3XSA9IChtMTMgKiBtMjEgLSBtMTEgKiBtMjMpICogZGV0O1xuICAgIHRlWzhdID0gKG0xMSAqIG0yMiAtIG0xMiAqIG0yMSkgKiBkZXQ7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBpbnZlcnNlTWF0XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiByZXR1cm5zIHRoZSBpbnZlcnNlIG9mIG90aGVyXG4gKiBAcGFyYW0gTWF0MyBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMucHJvdG90eXBlLmludmVyc2VNYXQgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBtZSA9IG90aGVyLmVsZW1lbnRzLFxuICAgICAgICBtMTEgPSBtZVswXSxcbiAgICAgICAgbTEyID0gbWVbM10sXG4gICAgICAgIG0xMyA9IG1lWzZdLFxuICAgICAgICBtMjEgPSBtZVsxXSxcbiAgICAgICAgbTIyID0gbWVbNF0sXG4gICAgICAgIG0yMyA9IG1lWzddLFxuICAgICAgICBtMzEgPSBtZVsyXSxcbiAgICAgICAgbTMyID0gbWVbNV0sXG4gICAgICAgIG0zMyA9IG1lWzhdLFxuXG4gICAgICAgIG0wID0gbTIyICogbTMzIC0gbTIzICogbTMyLFxuICAgICAgICBtMyA9IG0xMyAqIG0zMiAtIG0xMiAqIG0zMyxcbiAgICAgICAgbTYgPSBtMTIgKiBtMjMgLSBtMTMgKiBtMjIsXG5cbiAgICAgICAgZGV0ID0gbTExICogbTAgKyBtMjEgKiBtMyArIG0zMSAqIG02O1xuXG4gICAgaWYgKGRldCA9PT0gMC4wKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlkZW50aXR5KCk7XG4gICAgfVxuICAgIGRldCA9IDEuMCAvIGRldDtcblxuICAgIHRlWzBdID0gbTAgKiBkZXQ7XG4gICAgdGVbMV0gPSAobTIzICogbTMxIC0gbTIxICogbTMzKSAqIGRldDtcbiAgICB0ZVsyXSA9IChtMjEgKiBtMzIgLSBtMjIgKiBtMzEpICogZGV0O1xuXG4gICAgdGVbM10gPSBtMyAqIGRldDtcbiAgICB0ZVs0XSA9IChtMTEgKiBtMzMgLSBtMTMgKiBtMzEpICogZGV0O1xuICAgIHRlWzVdID0gKG0xMiAqIG0zMSAtIG0xMSAqIG0zMikgKiBkZXQ7XG5cbiAgICB0ZVs2XSA9IG02ICogZGV0O1xuICAgIHRlWzddID0gKG0xMyAqIG0yMSAtIG0xMSAqIG0yMykgKiBkZXQ7XG4gICAgdGVbOF0gPSAobTExICogbTIyIC0gbTEyICogbTIxKSAqIGRldDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGludmVyc2VNYXQ0XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiByZXR1cm5zIHRoZSBpbnZlcnNlIG9mIGEgTWF0NFxuICogQHBhcmFtIE1hdDQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5pbnZlcnNlTWF0NCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIG1lID0gb3RoZXIuZWxlbWVudHMsXG4gICAgICAgIG0xMSA9IG1lWzBdLFxuICAgICAgICBtMTIgPSBtZVs0XSxcbiAgICAgICAgbTEzID0gbWVbOF0sXG4gICAgICAgIG0yMSA9IG1lWzFdLFxuICAgICAgICBtMjIgPSBtZVs1XSxcbiAgICAgICAgbTIzID0gbWVbOV0sXG4gICAgICAgIG0zMSA9IG1lWzJdLFxuICAgICAgICBtMzIgPSBtZVs2XSxcbiAgICAgICAgbTMzID0gbWVbMTBdLFxuXG4gICAgICAgIG0wID0gbTIyICogbTMzIC0gbTIzICogbTMyLFxuICAgICAgICBtMyA9IG0xMyAqIG0zMiAtIG0xMiAqIG0zMyxcbiAgICAgICAgbTYgPSBtMTIgKiBtMjMgLSBtMTMgKiBtMjIsXG5cbiAgICAgICAgZGV0ID0gbTExICogbTAgKyBtMjEgKiBtMyArIG0zMSAqIG02O1xuXG4gICAgaWYgKGRldCA9PT0gMC4wKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlkZW50aXR5KCk7XG4gICAgfVxuICAgIGRldCA9IDEuMCAvIGRldDtcblxuICAgIHRlWzBdID0gbTAgKiBkZXQ7XG4gICAgdGVbMV0gPSAobTIzICogbTMxIC0gbTIxICogbTMzKSAqIGRldDtcbiAgICB0ZVsyXSA9IChtMjEgKiBtMzIgLSBtMjIgKiBtMzEpICogZGV0O1xuXG4gICAgdGVbM10gPSBtMyAqIGRldDtcbiAgICB0ZVs0XSA9IChtMTEgKiBtMzMgLSBtMTMgKiBtMzEpICogZGV0O1xuICAgIHRlWzVdID0gKG0xMiAqIG0zMSAtIG0xMSAqIG0zMikgKiBkZXQ7XG5cbiAgICB0ZVs2XSA9IG02ICogZGV0O1xuICAgIHRlWzddID0gKG0xMyAqIG0yMSAtIG0xMSAqIG0yMykgKiBkZXQ7XG4gICAgdGVbOF0gPSAobTExICogbTIyIC0gbTEyICogbTIxKSAqIGRldDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRyYW5zcG9zZVxuICogQG1lbWJlcm9mIE9kaW4uTWF0M1xuICogdHJhbnNwb3NlcyB0aGlzIG1hdHJpeFxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMucHJvdG90eXBlLnRyYW5zcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICB0bXA7XG5cbiAgICB0bXAgPSB0ZVsxXTtcbiAgICB0ZVsxXSA9IHRlWzNdO1xuICAgIHRlWzNdID0gdG1wO1xuICAgIHRtcCA9IHRlWzJdO1xuICAgIHRlWzJdID0gdGVbNl07XG4gICAgdGVbNl0gPSB0bXA7XG4gICAgdG1wID0gdGVbNV07XG4gICAgdGVbNV0gPSB0ZVs3XTtcbiAgICB0ZVs3XSA9IHRtcDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNldFRyYWNlXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBzZXRzIHRoZSBkaWFnb25hbCBvZiBtYXRyaXhcbiAqIEBwYXJhbSBWZWMzIHZcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5zZXRUcmFjZSA9IGZ1bmN0aW9uICh2KSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHRlWzBdID0gdi54O1xuICAgIHRlWzRdID0gdi55O1xuICAgIHRlWzhdID0gdi56O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2NhbGVcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDNcbiAqIHNjYWxlcyB0aGlzIGJ5IHZlY3RvclxuICogQHBhcmFtIFZlYzMgdlxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMucHJvdG90eXBlLnNjYWxlID0gZnVuY3Rpb24gKHYpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICB4ID0gdi54LFxuICAgICAgICB5ID0gdi55LFxuICAgICAgICB6ID0gdi56O1xuXG4gICAgdGVbMF0gKj0geDtcbiAgICB0ZVszXSAqPSB5O1xuICAgIHRlWzZdICo9IHo7XG4gICAgdGVbMV0gKj0geDtcbiAgICB0ZVs0XSAqPSB5O1xuICAgIHRlWzddICo9IHo7XG4gICAgdGVbMl0gKj0geDtcbiAgICB0ZVs1XSAqPSB5O1xuICAgIHRlWzhdICo9IHo7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtYWtlU2NhbGVcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDNcbiAqIG1ha2VzIHRoaXMgYSBzY2FsZSBtYXRyaXhcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHBhcmFtIE51bWJlciB5XG4gKiBAcGFyYW0gTnVtYmVyIHpcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5tYWtlU2NhbGUgPSBmdW5jdGlvbiAoeCwgeSwgeikge1xuXG4gICAgcmV0dXJuIHRoaXMuc2V0KFxuICAgICAgICB4LCAwLjAsIDAuMCxcbiAgICAgICAgMC4wLCB5LCAwLjAsXG4gICAgICAgIDAuMCwgMC4wLCB6XG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtYWtlUm90YXRpb25YXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBtYWtlcyB0aGlzIGEgcm90YXRpb24gbWF0cml4IGFsb25nIHggYXhpc1xuICogQHBhcmFtIE51bWJlciBhbmdsZVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMucHJvdG90eXBlLm1ha2VSb3RhdGlvblggPSBmdW5jdGlvbiAoYW5nbGUpIHtcbiAgICB2YXIgYyA9IGNvcyhhbmdsZSksXG4gICAgICAgIHMgPSBzaW4oYW5nbGUpO1xuXG4gICAgcmV0dXJuIHRoaXMuc2V0KFxuICAgICAgICAxLCAwLjAsIDAuMCxcbiAgICAgICAgMC4wLCBjLCAtcyxcbiAgICAgICAgMC4wLCBzLCBjXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtYWtlUm90YXRpb25ZXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBtYWtlcyB0aGlzIGEgcm90YXRpb24gbWF0cml4IGFsb25nIHkgYXhpc1xuICogQHBhcmFtIE51bWJlciBhbmdsZVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMucHJvdG90eXBlLm1ha2VSb3RhdGlvblkgPSBmdW5jdGlvbiAoYW5nbGUpIHtcbiAgICB2YXIgYyA9IGNvcyhhbmdsZSksXG4gICAgICAgIHMgPSBzaW4oYW5nbGUpO1xuXG4gICAgcmV0dXJuIHRoaXMuc2V0KFxuICAgICAgICBjLCAwLjAsIHMsXG4gICAgICAgIDAuMCwgMSwgMC4wLCAtcywgMC4wLCBjXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtYWtlUm90YXRpb25aXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBtYWtlcyB0aGlzIGEgcm90YXRpb24gbWF0cml4IGFsb25nIHogYXhpc1xuICogQHBhcmFtIE51bWJlciBhbmdsZVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMucHJvdG90eXBlLm1ha2VSb3RhdGlvblogPSBmdW5jdGlvbiAoYW5nbGUpIHtcbiAgICB2YXIgYyA9IGNvcyhhbmdsZSksXG4gICAgICAgIHMgPSBzaW4oYW5nbGUpO1xuXG4gICAgcmV0dXJuIHRoaXMuc2V0KFxuICAgICAgICBjLCAtcywgMC4wLFxuICAgICAgICBzLCBjLCAwLjAsXG4gICAgICAgIDAuMCwgMC4wLCAxXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tTWF0MlxuICogQG1lbWJlcm9mIE9kaW4uTWF0M1xuICogc2V0cyB0aGlzIGZyb20gTWF0MlxuICogQHBhcmFtIE1hdDIgbVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMucHJvdG90eXBlLmZyb21NYXQyID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBtZSA9IG0uZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IG1lWzBdO1xuICAgIHRlWzFdID0gbWVbMV07XG4gICAgdGVbMl0gPSAwLjA7XG4gICAgdGVbM10gPSBtZVsyXTtcbiAgICB0ZVs0XSA9IG1lWzNdO1xuICAgIHRlWzVdID0gMC4wO1xuICAgIHRlWzZdID0gMC4wO1xuICAgIHRlWzddID0gMC4wO1xuICAgIHRlWzhdID0gMTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21NYXQ0XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBzZXRzIHRoaXMgZnJvbSBNYXQ0XG4gKiBAcGFyYW0gTWF0MiBtXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0My5wcm90b3R5cGUuZnJvbU1hdDQgPSBmdW5jdGlvbiAobSkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIG1lID0gbS5lbGVtZW50cztcblxuICAgIHRlWzBdID0gbWVbMF07XG4gICAgdGVbMV0gPSBtZVsxXTtcbiAgICB0ZVsyXSA9IG1lWzJdO1xuICAgIHRlWzNdID0gbWVbNF07XG4gICAgdGVbNF0gPSBtZVs1XTtcbiAgICB0ZVs1XSA9IG1lWzZdO1xuICAgIHRlWzZdID0gbWVbOF07XG4gICAgdGVbN10gPSBtZVs5XTtcbiAgICB0ZVs4XSA9IG1lWzEwXTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21RdWF0XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBzZXRzIHJvdGF0aW9uIG9mIHRoaXMgZnJvbSBxdWF0ZXJpYW5cbiAqIEBwYXJhbSBRdWF0IHFcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5mcm9tUXVhdCA9IGZ1bmN0aW9uIChxKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgeCA9IHEueCxcbiAgICAgICAgeSA9IHEueSxcbiAgICAgICAgeiA9IHEueixcbiAgICAgICAgdyA9IHEudyxcbiAgICAgICAgeDIgPSB4ICsgeCxcbiAgICAgICAgeTIgPSB5ICsgeSxcbiAgICAgICAgejIgPSB6ICsgeixcbiAgICAgICAgeHggPSB4ICogeDIsXG4gICAgICAgIHh5ID0geCAqIHkyLFxuICAgICAgICB4eiA9IHggKiB6MixcbiAgICAgICAgeXkgPSB5ICogeTIsXG4gICAgICAgIHl6ID0geSAqIHoyLFxuICAgICAgICB6eiA9IHogKiB6MixcbiAgICAgICAgd3ggPSB3ICogeDIsXG4gICAgICAgIHd5ID0gdyAqIHkyLFxuICAgICAgICB3eiA9IHcgKiB6MjtcblxuICAgIHRlWzBdID0gMSAtICh5eSArIHp6KTtcbiAgICB0ZVsxXSA9IHh5ICsgd3o7XG4gICAgdGVbMl0gPSB4eiAtIHd5O1xuXG4gICAgdGVbM10gPSB4eSAtIHd6O1xuICAgIHRlWzRdID0gMSAtICh4eCArIHp6KTtcbiAgICB0ZVs1XSA9IHl6ICsgd3g7XG5cbiAgICB0ZVs2XSA9IHh6ICsgd3k7XG4gICAgdGVbN10gPSB5eiAtIHd4O1xuICAgIHRlWzhdID0gMSAtICh4eCArIHl5KTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBAcGFyYW0gT2Rpbi5NYXQzIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0My5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIGFlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgYmUgPSBvdGhlci5lbGVtZW50cztcblxuICAgIHJldHVybiAhKFxuICAgIGFlWzBdICE9PSBiZVswXSB8fFxuICAgIGFlWzFdICE9PSBiZVsxXSB8fFxuICAgIGFlWzJdICE9PSBiZVsyXSB8fFxuICAgIGFlWzNdICE9PSBiZVszXSB8fFxuICAgIGFlWzRdICE9PSBiZVs0XSB8fFxuICAgIGFlWzVdICE9PSBiZVs1XSB8fFxuICAgIGFlWzZdICE9PSBiZVs2XSB8fFxuICAgIGFlWzddICE9PSBiZVs3XSB8fFxuICAgIGFlWzhdICE9PSBiZVs4XVxuICAgICk7XG59O1xuXG4vKipcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDNcbiAqIEBwYXJhbSBPZGluLk1hdDMgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5ub3RFcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYWUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBiZSA9IG90aGVyLmVsZW1lbnRzO1xuXG4gICAgcmV0dXJuIChcbiAgICBhZVswXSAhPT0gYmVbMF0gfHxcbiAgICBhZVsxXSAhPT0gYmVbMV0gfHxcbiAgICBhZVsyXSAhPT0gYmVbMl0gfHxcbiAgICBhZVszXSAhPT0gYmVbM10gfHxcbiAgICBhZVs0XSAhPT0gYmVbNF0gfHxcbiAgICBhZVs1XSAhPT0gYmVbNV0gfHxcbiAgICBhZVs2XSAhPT0gYmVbNl0gfHxcbiAgICBhZVs3XSAhPT0gYmVbN10gfHxcbiAgICBhZVs4XSAhPT0gYmVbOF1cbiAgICApO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21KU09OXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiBzZXRzIHZhbHVlcyBmcm9tIEpTT04gb2JqZWN0XG4gKiBAcGFyYW0gT2JqZWN0IGpzb25cbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgbWUgPSBqc29uLmVsZW1lbnRzO1xuXG4gICAgdGVbMF0gPSBtZVswXTtcbiAgICB0ZVsxXSA9IG1lWzFdO1xuICAgIHRlWzJdID0gbWVbMl07XG4gICAgdGVbM10gPSBtZVszXTtcbiAgICB0ZVs0XSA9IG1lWzRdO1xuICAgIHRlWzVdID0gbWVbNV07XG4gICAgdGVbNl0gPSBtZVs2XTtcbiAgICB0ZVs3XSA9IG1lWzddO1xuICAgIHRlWzhdID0gbWVbOF07XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b0pTT05cbiAqIEBtZW1iZXJvZiBPZGluLk1hdDNcbiAqIHJldHVybnMganNvbiBvYmplY3Qgb2YgdGhpc1xuICogQHBhcmFtIEFycmF5IGFycmF5XG4gKiBAcmV0dXJuIE9iamVjdFxuICovXG5NYXQzLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gfHwgKGpzb24gPSB7fSk7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgamUgPSBqc29uLmVsZW1lbnRzIHx8IChqc29uLmVsZW1lbnRzID0gW10pO1xuXG4gICAganNvbi5fY2xhc3NOYW1lID0gXCJNYXQzXCI7XG4gICAgamVbMF0gPSB0ZVswXTtcbiAgICBqZVsxXSA9IHRlWzFdO1xuICAgIGplWzJdID0gdGVbMl07XG4gICAgamVbM10gPSB0ZVszXTtcbiAgICBqZVs0XSA9IHRlWzRdO1xuICAgIGplWzVdID0gdGVbNV07XG4gICAgamVbNl0gPSB0ZVs2XTtcbiAgICBqZVs3XSA9IHRlWzddO1xuICAgIGplWzhdID0gdGVbOF07XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tQXJyYXlcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDNcbiAqIHNldHMgdmFsdWVzIGZyb20gQXJyYXkgb2JqZWN0XG4gKiBAcGFyYW0gT2JqZWN0IGpzb25cbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzLnByb3RvdHlwZS5mcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgdGVbMF0gPSBhcnJheVswXTtcbiAgICB0ZVsxXSA9IGFycmF5WzFdO1xuICAgIHRlWzJdID0gYXJyYXlbMl07XG4gICAgdGVbM10gPSBhcnJheVszXTtcbiAgICB0ZVs0XSA9IGFycmF5WzRdO1xuICAgIHRlWzVdID0gYXJyYXlbNV07XG4gICAgdGVbNl0gPSBhcnJheVs2XTtcbiAgICB0ZVs3XSA9IGFycmF5WzddO1xuICAgIHRlWzhdID0gYXJyYXlbOF07XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b0FycmF5XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzXG4gKiByZXR1cm5zIGFycmF5IG9iamVjdCBvZiB0aGlzXG4gKiBAcmV0dXJuIE9iamVjdFxuICovXG5NYXQzLnByb3RvdHlwZS50b0FycmF5ID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgYXJyYXkgfHwgKGFycmF5ID0gW10pO1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICBhcnJheVswXSA9IHRlWzBdO1xuICAgIGFycmF5WzFdID0gdGVbMV07XG4gICAgYXJyYXlbMl0gPSB0ZVsyXTtcbiAgICBhcnJheVszXSA9IHRlWzNdO1xuICAgIGFycmF5WzRdID0gdGVbNF07XG4gICAgYXJyYXlbNV0gPSB0ZVs1XTtcbiAgICBhcnJheVs2XSA9IHRlWzZdO1xuICAgIGFycmF5WzddID0gdGVbN107XG4gICAgYXJyYXlbOF0gPSB0ZVs4XTtcblxuICAgIHJldHVybiBhcnJheTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b1N0cmluZ1xuICogQG1lbWJlcm9mIE9kaW4uTWF0M1xuICogcmV0dXJucyBzdHJpbmcgb2YgdGhpc1xuICogQHJldHVybiBTdHJpbmdcbiAqL1xuTWF0My5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHJldHVybiAoXG4gICAgXCJNYXQzW1wiICsgdGVbMF0gKyBcIiwgXCIgKyB0ZVszXSArIFwiLCBcIiArIHRlWzZdICsgXCJdXFxuXCIgK1xuICAgIFwiICAgICBbXCIgKyB0ZVsxXSArIFwiLCBcIiArIHRlWzRdICsgXCIsIFwiICsgdGVbN10gKyBcIl1cXG5cIiArXG4gICAgXCIgICAgIFtcIiArIHRlWzJdICsgXCIsIFwiICsgdGVbNV0gKyBcIiwgXCIgKyB0ZVs4XSArIFwiXVwiXG4gICAgKTtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBNYXQzO1xuIiwidmFyIE1hdGhmID0gcmVxdWlyZShcIi4vbWF0aGZcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgc3FydCA9IE1hdGguc3FydCxcbiAgICBjb3MgPSBNYXRoLmNvcyxcbiAgICBzaW4gPSBNYXRoLnNpbixcbiAgICBhdGFuMiA9IE1hdGguYXRhbjI7XG5cbi8qKlxuICogQGNsYXNzIE1hdDMyXG4gKiAzeDIgbWF0cml4XG4gKiBAcGFyYW0gTnVtYmVyIG0xMVxuICogQHBhcmFtIE51bWJlciBtMTJcbiAqIEBwYXJhbSBOdW1iZXIgbTEzXG4gKiBAcGFyYW0gTnVtYmVyIG0yMVxuICogQHBhcmFtIE51bWJlciBtMjJcbiAqIEBwYXJhbSBOdW1iZXIgbTIzXG4gKi9cbmZ1bmN0aW9uIE1hdDMyKG0xMSwgbTEyLCBtMTMsIG0yMSwgbTIyLCBtMjMpIHtcbiAgICB2YXIgdGUgPSBuZXcgRmxvYXQzMkFycmF5KDYpO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IEZsb2F0MzJBcnJheSBlbGVtZW50c1xuICAgICAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gICAgICovXG4gICAgdGhpcy5lbGVtZW50cyA9IHRlO1xuXG4gICAgdGVbMF0gPSBtMTEgIT0gdW5kZWZpbmVkID8gbTExIDogMS4wO1xuICAgIHRlWzJdID0gbTEyIHx8IDAuMDtcbiAgICB0ZVs0XSA9IG0xMyB8fCAwLjA7XG4gICAgdGVbMV0gPSBtMjEgfHwgMC4wO1xuICAgIHRlWzNdID0gbTIyICE9IHVuZGVmaW5lZCA/IG0yMiA6IDEuMDtcbiAgICB0ZVs1XSA9IG0yMyB8fCAwLjA7XG59XG5cbk1hdGhmLl9jbGFzc2VzW1wiTWF0MzJcIl0gPSBNYXQzMjtcblxuLyoqXG4gKiBAbWV0aG9kIGNsb25lXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogcmV0dXJucyBuZXcgaW5zdGFuY2Ugb2YgdGhpc1xuICogQHJldHVybiBNYXQzMlxuICovXG5NYXQzMi5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHJldHVybiBuZXcgTWF0MzIoXG4gICAgICAgIHRlWzBdLCB0ZVsxXSwgdGVbMl0sXG4gICAgICAgIHRlWzNdLCB0ZVs0XSwgdGVbNV1cbiAgICApO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNvcHlcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiBjb3BpZXMgb3RoZXJcbiAqIEBwYXJhbSBNYXQzMiBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMyLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgbWUgPSBvdGhlci5lbGVtZW50cztcblxuICAgIHRlWzBdID0gbWVbMF07XG4gICAgdGVbMV0gPSBtZVsxXTtcbiAgICB0ZVsyXSA9IG1lWzJdO1xuICAgIHRlWzNdID0gbWVbM107XG4gICAgdGVbNF0gPSBtZVs0XTtcbiAgICB0ZVs1XSA9IG1lWzVdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogc2V0cyB2YWx1ZXMgb2YgdGhpc1xuICogQHBhcmFtIE51bWJlciBtMTFcbiAqIEBwYXJhbSBOdW1iZXIgbTEyXG4gKiBAcGFyYW0gTnVtYmVyIG0xM1xuICogQHBhcmFtIE51bWJlciBtMjFcbiAqIEBwYXJhbSBOdW1iZXIgbTIyXG4gKiBAcGFyYW0gTnVtYmVyIG0yM1xuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobTExLCBtMTIsIG0xMywgbTIxLCBtMjIsIG0yMykge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IG0xMTtcbiAgICB0ZVsyXSA9IG0xMjtcbiAgICB0ZVs0XSA9IG0xMztcbiAgICB0ZVsxXSA9IG0yMTtcbiAgICB0ZVszXSA9IG0yMjtcbiAgICB0ZVs1XSA9IG0yMztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIG11bFxuICogQG1lbWJlcm9mIE9kaW4uTWF0MzJcbiAqIG11bGlwbGVzIHRoaXMncyB2YWx1ZXMgYnkgb3RoZXInc1xuICogQHBhcmFtIE1hdDMyIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0MzIucHJvdG90eXBlLm11bCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciBhZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIGJlID0gb3RoZXIuZWxlbWVudHMsXG5cbiAgICAgICAgYTExID0gYWVbMF0sXG4gICAgICAgIGExMiA9IGFlWzJdLFxuICAgICAgICBhMTMgPSBhZVs0XSxcbiAgICAgICAgYTIxID0gYWVbMV0sXG4gICAgICAgIGEyMiA9IGFlWzNdLFxuICAgICAgICBhMjMgPSBhZVs1XSxcblxuICAgICAgICBiMTEgPSBiZVswXSxcbiAgICAgICAgYjEyID0gYmVbMl0sXG4gICAgICAgIGIxMyA9IGJlWzRdLFxuICAgICAgICBiMjEgPSBiZVsxXSxcbiAgICAgICAgYjIyID0gYmVbM10sXG4gICAgICAgIGIyMyA9IGJlWzVdO1xuXG4gICAgYWVbMF0gPSBhMTEgKiBiMTEgKyBhMjEgKiBiMTI7XG4gICAgYWVbMl0gPSBhMTIgKiBiMTEgKyBhMjIgKiBiMTI7XG5cbiAgICBhZVsxXSA9IGExMSAqIGIyMSArIGEyMSAqIGIyMjtcbiAgICBhZVszXSA9IGExMiAqIGIyMSArIGEyMiAqIGIyMjtcblxuICAgIGFlWzRdID0gYTExICogYjEzICsgYTEyICogYjIzICsgYTEzO1xuICAgIGFlWzVdID0gYTIxICogYjEzICsgYTIyICogYjIzICsgYTIzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbW11bFxuICogQG1lbWJlcm9mIE9kaW4uTWF0MzJcbiAqIG11bGlwbGVzIGEgYW5kIGIgc2F2ZXMgaXQgaW4gdGhpc1xuICogQHBhcmFtIE1hdDMyIGFcbiAqIEBwYXJhbSBNYXQzMiBiXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0MzIucHJvdG90eXBlLm1tdWwgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIGFlID0gYS5lbGVtZW50cyxcbiAgICAgICAgYmUgPSBiLmVsZW1lbnRzLFxuXG4gICAgICAgIGExMSA9IGFlWzBdLFxuICAgICAgICBhMTIgPSBhZVsyXSxcbiAgICAgICAgYTEzID0gYWVbNF0sXG4gICAgICAgIGEyMSA9IGFlWzFdLFxuICAgICAgICBhMjIgPSBhZVszXSxcbiAgICAgICAgYTIzID0gYWVbNV0sXG5cbiAgICAgICAgYjExID0gYmVbMF0sXG4gICAgICAgIGIxMiA9IGJlWzJdLFxuICAgICAgICBiMTMgPSBiZVs0XSxcbiAgICAgICAgYjIxID0gYmVbMV0sXG4gICAgICAgIGIyMiA9IGJlWzNdLFxuICAgICAgICBiMjMgPSBiZVs1XTtcblxuICAgIHRlWzBdID0gYTExICogYjExICsgYTIxICogYjEyO1xuICAgIHRlWzJdID0gYTEyICogYjExICsgYTIyICogYjEyO1xuXG4gICAgdGVbMV0gPSBhMTEgKiBiMjEgKyBhMjEgKiBiMjI7XG4gICAgdGVbM10gPSBhMTIgKiBiMjEgKyBhMjIgKiBiMjI7XG5cbiAgICB0ZVs0XSA9IGExMSAqIGIxMyArIGExMiAqIGIyMyArIGExMztcbiAgICB0ZVs1XSA9IGEyMSAqIGIxMyArIGEyMiAqIGIyMyArIGEyMztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNtdWxcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiBtdWxpcGxlcyB0aGlzIGJ5IGEgc2NhbGFyIHZhbHVlXG4gKiBAcGFyYW0gTnVtYmVyIHNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzMi5wcm90b3R5cGUuc211bCA9IGZ1bmN0aW9uIChzKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHRlWzBdICo9IHM7XG4gICAgdGVbMV0gKj0gcztcbiAgICB0ZVsyXSAqPSBzO1xuICAgIHRlWzNdICo9IHM7XG4gICAgdGVbNF0gKj0gcztcbiAgICB0ZVs1XSAqPSBzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2RpdlxuICogQG1lbWJlcm9mIE9kaW4uTWF0MzJcbiAqIGRpdmlkZXMgdGhpcyBieSBzY2FsYXIgdmFsdWVcbiAqIEBwYXJhbSBOdW1iZXIgc1xuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMyLnByb3RvdHlwZS5zZGl2ID0gZnVuY3Rpb24gKHMpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgcyA9IHMgIT09IDAuMCA/IDEuMCAvIHMgOiAxLjA7XG5cbiAgICB0ZVswXSAqPSBzO1xuICAgIHRlWzFdICo9IHM7XG4gICAgdGVbMl0gKj0gcztcbiAgICB0ZVszXSAqPSBzO1xuICAgIHRlWzRdICo9IHM7XG4gICAgdGVbNV0gKj0gcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGlkZW50aXR5XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogaWRlbnRpdHkgbWF0cml4XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0MzIucHJvdG90eXBlLmlkZW50aXR5ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IDE7XG4gICAgdGVbMV0gPSAwLjA7XG4gICAgdGVbMl0gPSAwLjA7XG4gICAgdGVbM10gPSAxO1xuICAgIHRlWzRdID0gMC4wO1xuICAgIHRlWzVdID0gMC4wO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgemVyb1xuICogQG1lbWJlcm9mIE9kaW4uTWF0MzJcbiAqIHplcm8gbWF0cml4XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0MzIucHJvdG90eXBlLnplcm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHRlWzBdID0gMC4wO1xuICAgIHRlWzFdID0gMC4wO1xuICAgIHRlWzJdID0gMC4wO1xuICAgIHRlWzNdID0gMC4wO1xuICAgIHRlWzRdID0gMC4wO1xuICAgIHRlWzVdID0gMC4wO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZGV0ZXJtaW5hbnRcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiByZXR1cm5zIHRoZSBkZXRlcm1pbmFudCBvZiB0aGlzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0MzIucHJvdG90eXBlLmRldGVybWluYW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICByZXR1cm4gdGVbMF0gKiB0ZVszXSAtIHRlWzJdICogdGVbMV07XG59O1xuXG4vKipcbiAqIEBtZXRob2QgaW52ZXJzZVxuICogQG1lbWJlcm9mIE9kaW4uTWF0MzJcbiAqIHJldHVybnMgdGhlIGludmVyc2Ugb2YgdGhpc1xuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMyLnByb3RvdHlwZS5pbnZlcnNlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG5cbiAgICAgICAgbTExID0gdGVbMF0sXG4gICAgICAgIG0xMiA9IHRlWzJdLFxuICAgICAgICBtMTMgPSB0ZVs0XSxcbiAgICAgICAgbTIxID0gdGVbMV0sXG4gICAgICAgIG0yMiA9IHRlWzNdLFxuICAgICAgICBtMjMgPSB0ZVs1XSxcblxuICAgICAgICBkZXQgPSBtMTEgKiBtMjIgLSBtMTIgKiBtMjE7XG5cbiAgICBpZiAoZGV0ID09PSAwLjApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaWRlbnRpdHkoKTtcbiAgICB9XG4gICAgZGV0ID0gMS4wIC8gZGV0O1xuXG4gICAgdGVbMF0gPSBtMjIgKiBkZXQ7XG4gICAgdGVbMV0gPSAtbTEyICogZGV0O1xuICAgIHRlWzJdID0gLW0yMSAqIGRldDtcbiAgICB0ZVszXSA9IG0xMSAqIGRldDtcblxuICAgIHRlWzRdID0gKG0yMSAqIG0yMyAtIG0yMiAqIG0xMykgKiBkZXQ7XG4gICAgdGVbNV0gPSAtKG0xMSAqIG0yMyAtIG0xMiAqIG0xMykgKiBkZXQ7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBpbnZlcnNlTWF0XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogcmV0dXJucyB0aGUgaW52ZXJzZSBvZiBvdGhlclxuICogQHBhcmFtIE1hdDMyIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0MzIucHJvdG90eXBlLmludmVyc2VNYXQgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBtZSA9IG90aGVyLmVsZW1lbnRzLFxuXG4gICAgICAgIG0xMSA9IG1lWzBdLFxuICAgICAgICBtMTIgPSBtZVsyXSxcbiAgICAgICAgbTEzID0gbWVbNF0sXG4gICAgICAgIG0yMSA9IG1lWzFdLFxuICAgICAgICBtMjIgPSBtZVszXSxcbiAgICAgICAgbTIzID0gbWVbNV0sXG5cbiAgICAgICAgZGV0ID0gbTExICogbTIyIC0gbTEyICogbTIxO1xuXG4gICAgaWYgKGRldCA9PT0gMC4wKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlkZW50aXR5KCk7XG4gICAgfVxuICAgIGRldCA9IDEuMCAvIGRldDtcblxuICAgIHRlWzBdID0gbTIyICogZGV0O1xuICAgIHRlWzFdID0gLW0xMiAqIGRldDtcbiAgICB0ZVsyXSA9IC1tMjEgKiBkZXQ7XG4gICAgdGVbM10gPSBtMTEgKiBkZXQ7XG5cbiAgICB0ZVs0XSA9IChtMjEgKiBtMjMgLSBtMjIgKiBtMTMpICogZGV0O1xuICAgIHRlWzVdID0gLShtMTEgKiBtMjMgLSBtMTIgKiBtMTMpICogZGV0O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdHJhbnNwb3NlXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogdHJhbnNwb3NlcyB0aGlzIG1hdHJpeFxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMyLnByb3RvdHlwZS50cmFuc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgdG1wO1xuXG4gICAgdG1wID0gdGVbMV07XG4gICAgdGVbMV0gPSB0ZVsyXTtcbiAgICB0ZVsyXSA9IHRtcDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNldFRyYWNlXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogc2V0cyB0aGUgZGlhZ29uYWwgb2YgbWF0cml4XG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEBwYXJhbSBOdW1iZXIgeVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMyLnByb3RvdHlwZS5zZXRUcmFjZSA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHRlWzBdID0geDtcbiAgICB0ZVszXSA9IHk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBsb29rQXRcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiBtYWtlcyBtYXRyaXggbG9vayBmcm9tIGV5ZSB0byB0YXJnZXRcbiAqIEBwYXJhbSBWZWMyIGV5ZVxuICogQHBhcmFtIFZlYzIgdGFyZ2V0XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0MzIucHJvdG90eXBlLmxvb2tBdCA9IGZ1bmN0aW9uIChleWUsIHRhcmdldCkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIHggPSB0YXJnZXQueCAtIGV5ZS54LFxuICAgICAgICB5ID0gdGFyZ2V0LnkgLSBleWUueSxcbiAgICAgICAgYSA9IGF0YW4yKHksIHgpIC0gSEFMRl9QSSxcbiAgICAgICAgYyA9IGNvcyhhKSxcbiAgICAgICAgcyA9IHNpbihhKTtcblxuICAgIHRlWzBdID0gYztcbiAgICB0ZVsxXSA9IHM7XG4gICAgdGVbMl0gPSAtcztcbiAgICB0ZVszXSA9IGM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjb21wb3NlXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogc2V0cyBtYXRyaXggZnJvbSBwb3NpdGlvbiwgc2NhbGUsIGFuZCBhbiBhbmdsZSBpbiByYWRpYW5zXG4gKiBAcGFyYW0gVmVjMiBwb3NpdGlvblxuICogQHBhcmFtIFZlYzIgc2NhbGVcbiAqIEBwYXJhbSBOdW1iZXIgYW5nbGVcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzMi5wcm90b3R5cGUuY29tcG9zZSA9IGZ1bmN0aW9uIChwb3NpdGlvbiwgc2NhbGUsIGFuZ2xlKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgc3ggPSBzY2FsZS54LFxuICAgICAgICBzeSA9IHNjYWxlLnksXG4gICAgICAgIGMgPSBjb3MoYW5nbGUpLFxuICAgICAgICBzID0gc2luKGFuZ2xlKTtcblxuICAgIHRlWzBdID0gYyAqIHN4O1xuICAgIHRlWzFdID0gcyAqIHN4O1xuICAgIHRlWzJdID0gLXMgKiBzeTtcbiAgICB0ZVszXSA9IGMgKiBzeTtcblxuICAgIHRlWzRdID0gcG9zaXRpb24ueDtcbiAgICB0ZVs1XSA9IHBvc2l0aW9uLnk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBkZWNvbXBvc2VcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiBnZXRzIG1hdHJpeCBwb3NpdGlvbiwgc2NhbGUsIGFuZCByZXR1cm5zIGl0cyBhbmdsZSBpbiByYWRpYW5zXG4gKiBAcGFyYW0gVmVjMiBwb3NpdGlvblxuICogQHBhcmFtIFZlYzIgc2NhbGVcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdDMyLnByb3RvdHlwZS5kZWNvbXBvc2UgPSBmdW5jdGlvbiAocG9zaXRpb24sIHNjYWxlKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgbTExID0gdGVbMF0sXG4gICAgICAgIG0xMiA9IHRlWzFdLFxuICAgICAgICBzeCA9IHNjYWxlLnNldChtMTEsIG0xMikubGVuZ3RoKCksXG4gICAgICAgIHN5ID0gc2NhbGUuc2V0KHRlWzJdLCB0ZVszXSkubGVuZ3RoKCk7XG5cbiAgICBwb3NpdGlvbi54ID0gdGVbNF07XG4gICAgcG9zaXRpb24ueSA9IHRlWzVdO1xuXG4gICAgc2NhbGUueCA9IHN4O1xuICAgIHNjYWxlLnkgPSBzeTtcblxuICAgIHJldHVybiBhdGFuMihtMTIsIG0xMSk7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0Um90YXRpb25cbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiBzZXRzIHRoZSByb3RhdGlvbiBpbiByYWRpYW5zIHRoaXNcbiAqIEBwYXJhbSBOdW1iZXIgYW5nbGVcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzMi5wcm90b3R5cGUuc2V0Um90YXRpb24gPSBmdW5jdGlvbiAoYW5nbGUpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBjID0gY29zKGFuZ2xlKSxcbiAgICAgICAgcyA9IHNpbihhbmdsZSk7XG5cbiAgICB0ZVswXSA9IGM7XG4gICAgdGVbMV0gPSBzO1xuICAgIHRlWzJdID0gLXM7XG4gICAgdGVbM10gPSBjO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZ2V0Um90YXRpb25cbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiByZXR1cm5zIHRoZSByb3RhdGlvbiBpbiByYWRpYW5zIG9mIHRoaXNcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdDMyLnByb3RvdHlwZS5nZXRSb3RhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgcmV0dXJuIGF0YW4yKHRlWzFdLCB0ZVswXSk7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0UG9zaXRpb25cbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiBzZXRzIHRoZSBwb3NpdGlvbiBvZiB0aGlzXG4gKiBAcGFyYW0gVmVjMiB2XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0MzIucHJvdG90eXBlLnNldFBvc2l0aW9uID0gZnVuY3Rpb24gKHYpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgdGVbNF0gPSB2Lng7XG4gICAgdGVbNV0gPSB2Lnk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBnZXRQb3NpdGlvblxuICogQG1lbWJlcm9mIE9kaW4uTWF0MzJcbiAqIGdldHMgdGhlIHBvc2l0aW9uIG9mIHRoaXNcbiAqIEBwYXJhbSBWZWMyIHZcbiAqIEByZXR1cm4gVmVjMlxuICovXG5NYXQzMi5wcm90b3R5cGUuZ2V0UG9zaXRpb24gPSBmdW5jdGlvbiAodikge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICB2LnggPSB0ZVs0XTtcbiAgICB2LnkgPSB0ZVs1XTtcblxuICAgIHJldHVybiB2O1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGV4dHJhY3RQb3NpdGlvblxuICogQG1lbWJlcm9mIE9kaW4uTWF0MzJcbiAqIGdldHMgcG9zaXRpb24gZnJvbSBvdGhlciBzYXZlcyBpdCBpbiB0aGlzXG4gKiBAcGFyYW0gTWF0MzIgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzMi5wcm90b3R5cGUuZXh0cmFjdFBvc2l0aW9uID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgbWUgPSBvdGhlci5lbGVtZW50cztcblxuICAgIHRlWzRdID0gbWVbNF07XG4gICAgdGVbNV0gPSBtZVs1XTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGV4dHJhY3RSb3RhdGlvblxuICogQG1lbWJlcm9mIE9kaW4uTWF0MzJcbiAqIGdldHMgcm90YXRpb24gZnJvbSBvdGhlciBzYXZlcyBpdCBpbiB0aGlzXG4gKiBAcGFyYW0gTWF0MzIgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzMi5wcm90b3R5cGUuZXh0cmFjdFJvdGF0aW9uID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgbWUgPSBvdGhlci5lbGVtZW50cyxcblxuICAgICAgICBtMTEgPSBtZVswXSxcbiAgICAgICAgbTEyID0gbWVbMl0sXG4gICAgICAgIG0yMSA9IG1lWzFdLFxuICAgICAgICBtMjIgPSBtZVszXSxcblxuICAgICAgICB4ID0gbTExICogbTExICsgbTIxICogbTIxLFxuICAgICAgICB5ID0gbTEyICogbTEyICsgbTIyICogbTIyLFxuXG4gICAgICAgIHN4ID0geCA+IDAuMCA/IDEuMCAvIHNxcnQoeCkgOiAwLjAsXG4gICAgICAgIHN5ID0geSA+IDAuMCA/IDEuMCAvIHNxcnQoeSkgOiAwLjA7XG5cbiAgICB0ZVswXSA9IG0xMSAqIHN4O1xuICAgIHRlWzFdID0gbTIxICogc3g7XG5cbiAgICB0ZVsyXSA9IG0xMiAqIHN5O1xuICAgIHRlWzNdID0gbTIyICogc3k7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0cmFuc2xhdGVcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiB0cmFuc2xhdGVzIG1hdHJpeCBieSB2ZWN0b3JcbiAqIEBwYXJhbSBWZWMyIHZcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzMi5wcm90b3R5cGUudHJhbnNsYXRlID0gZnVuY3Rpb24gKHYpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICB4ID0gdi54LFxuICAgICAgICB5ID0gdi55O1xuXG4gICAgdGVbNF0gPSB0ZVswXSAqIHggKyB0ZVsyXSAqIHkgKyB0ZVs0XTtcbiAgICB0ZVs1XSA9IHRlWzFdICogeCArIHRlWzNdICogeSArIHRlWzVdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgcm90YXRlXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogcm90YXRlcyB0aGlzIGJ5IGFuZ2xlIGluIHJhZGlhbnNcbiAqIEBwYXJhbSBOdW1iZXIgYW5nbGVcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzMi5wcm90b3R5cGUucm90YXRlID0gZnVuY3Rpb24gKGFuZ2xlKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcblxuICAgICAgICBtMTEgPSB0ZVswXSxcbiAgICAgICAgbTEyID0gdGVbMl0sXG4gICAgICAgIG0yMSA9IHRlWzFdLFxuICAgICAgICBtMjIgPSB0ZVszXSxcblxuICAgICAgICBzID0gc2luKGFuZ2xlKSxcbiAgICAgICAgYyA9IHNpbihhbmdsZSk7XG5cbiAgICB0ZVswXSA9IG0xMSAqIGMgKyBtMTIgKiBzO1xuICAgIHRlWzFdID0gbTExICogLXMgKyBtMTIgKiBjO1xuICAgIHRlWzJdID0gbTIxICogYyArIG0yMiAqIHM7XG4gICAgdGVbM10gPSBtMjEgKiAtcyArIG0yMiAqIGM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzY2FsZVxuICogQG1lbWJlcm9mIE9kaW4uTWF0MzJcbiAqIHNjYWxlcyBtYXRyaXggYnkgdmVjdG9yXG4gKiBAcGFyYW0gVmVjMiB2XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0MzIucHJvdG90eXBlLnNjYWxlID0gZnVuY3Rpb24gKHYpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICB4ID0gdi54LFxuICAgICAgICB5ID0gdi55O1xuXG4gICAgdGVbMF0gKj0geDtcbiAgICB0ZVsxXSAqPSB4O1xuICAgIHRlWzRdICo9IHg7XG5cbiAgICB0ZVsyXSAqPSB5O1xuICAgIHRlWzNdICo9IHk7XG4gICAgdGVbNV0gKj0geTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIG9ydGhvZ3JhcGhpY1xuICogQG1lbWJlcm9mIE9kaW4uTWF0MzJcbiAqIG1ha2VzIG9ydGhvZ3JhcGhpYyBtYXRyaXhcbiAqIEBwYXJhbSBOdW1iZXIgbGVmdFxuICogQHBhcmFtIE51bWJlciByaWdodFxuICogQHBhcmFtIE51bWJlciBib3R0b21cbiAqIEBwYXJhbSBOdW1iZXIgdG9wXG4gKiBAcmV0dXJuIE1hdDMyXG4gKi9cbk1hdDMyLnByb3RvdHlwZS5vcnRob2dyYXBoaWMgPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQsIHRvcCwgYm90dG9tKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgdyA9IHJpZ2h0IC0gbGVmdCxcbiAgICAgICAgaCA9IHRvcCAtIGJvdHRvbSxcblxuICAgICAgICB4ID0gKHJpZ2h0ICsgbGVmdCkgLyB3LFxuICAgICAgICB5ID0gKHRvcCArIGJvdHRvbSkgLyBoO1xuXG4gICAgdGVbMF0gPSAyIC8gdztcbiAgICB0ZVsxXSA9IDAuMDtcbiAgICB0ZVsyXSA9IDAuMDtcbiAgICB0ZVszXSA9IDIgLyBoO1xuICAgIHRlWzRdID0gLXg7XG4gICAgdGVbNV0gPSAteTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21NYXQzXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogc2V0cyB0aGlzIGZyb20gTWF0M1xuICogQHBhcmFtIE1hdDMgbVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMyLnByb3RvdHlwZS5mcm9tTWF0MyA9IGZ1bmN0aW9uIChtKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgbWUgPSBtLmVsZW1lbnRzO1xuXG4gICAgdGVbMF0gPSBtZVswXTtcbiAgICB0ZVsxXSA9IG1lWzFdO1xuICAgIHRlWzJdID0gbWVbM107XG4gICAgdGVbM10gPSBtZVs0XTtcbiAgICB0ZVs0XSA9IDAuMDtcbiAgICB0ZVs1XSA9IDAuMDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21NYXQ0XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogc2V0cyB0aGlzIGZyb20gTWF0NFxuICogQHBhcmFtIE1hdDQgbVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMyLnByb3RvdHlwZS5mcm9tTWF0NCA9IGZ1bmN0aW9uIChtKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgbWUgPSBtLmVsZW1lbnRzO1xuXG4gICAgdGVbMF0gPSBtZVswXTtcbiAgICB0ZVsxXSA9IG1lWzFdO1xuICAgIHRlWzJdID0gbWVbNF07XG4gICAgdGVbM10gPSBtZVs1XTtcbiAgICB0ZVs0XSA9IG1lWzEyXTtcbiAgICB0ZVs1XSA9IG1lWzEzXTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogQHBhcmFtIE9kaW4uTWF0MzIgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQzMi5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIGFlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgYmUgPSBvdGhlci5lbGVtZW50cztcblxuICAgIHJldHVybiAhKFxuICAgIGFlWzBdICE9PSBiZVswXSB8fFxuICAgIGFlWzFdICE9PSBiZVsxXSB8fFxuICAgIGFlWzJdICE9PSBiZVsyXSB8fFxuICAgIGFlWzNdICE9PSBiZVszXSB8fFxuICAgIGFlWzRdICE9PSBiZVs0XSB8fFxuICAgIGFlWzVdICE9PSBiZVs1XVxuICAgICk7XG59O1xuXG4vKipcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiBAcGFyYW0gT2Rpbi5NYXQzMiBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDMyLnByb3RvdHlwZS5ub3RFcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYWUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBiZSA9IG90aGVyLmVsZW1lbnRzO1xuXG4gICAgcmV0dXJuIChcbiAgICBhZVswXSAhPT0gYmVbMF0gfHxcbiAgICBhZVsxXSAhPT0gYmVbMV0gfHxcbiAgICBhZVsyXSAhPT0gYmVbMl0gfHxcbiAgICBhZVszXSAhPT0gYmVbM10gfHxcbiAgICBhZVs0XSAhPT0gYmVbNF0gfHxcbiAgICBhZVs1XSAhPT0gYmVbNV1cbiAgICApO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21KU09OXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXQzMlxuICogc2V0cyB2YWx1ZXMgZnJvbSBKU09OIG9iamVjdFxuICogQHBhcmFtIE9iamVjdCBqc29uXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0MzIucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBtZSA9IGpzb24uZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IG1lWzBdO1xuICAgIHRlWzFdID0gbWVbMV07XG4gICAgdGVbMl0gPSBtZVsyXTtcbiAgICB0ZVszXSA9IG1lWzNdO1xuICAgIHRlWzRdID0gbWVbNF07XG4gICAgdGVbNV0gPSBtZVs1XTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRvSlNPTlxuICogQG1lbWJlcm9mIE9kaW4uTWF0MzJcbiAqIHJldHVybnMganNvbiBvYmplY3Qgb2YgdGhpc1xuICogQHJldHVybiBPYmplY3RcbiAqL1xuTWF0MzIucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiB8fCAoanNvbiA9IHt9KTtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBqZSA9IGpzb24uZWxlbWVudHMgfHwgKGpzb24uZWxlbWVudHMgPSBbXSk7XG5cbiAgICBqc29uLl9jbGFzc05hbWUgPSBcIk1hdDMyXCI7XG4gICAgamVbMF0gPSB0ZVswXTtcbiAgICBqZVsxXSA9IHRlWzFdO1xuICAgIGplWzJdID0gdGVbMl07XG4gICAgamVbM10gPSB0ZVszXTtcbiAgICBqZVs0XSA9IHRlWzRdO1xuICAgIGplWzVdID0gdGVbNV07XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tQXJyYXlcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiBzZXRzIHZhbHVlcyBmcm9tIEFycmF5IG9iamVjdFxuICogQHBhcmFtIE9iamVjdCBqc29uXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0MzIucHJvdG90eXBlLmZyb21BcnJheSA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IGFycmF5WzBdO1xuICAgIHRlWzFdID0gYXJyYXlbMV07XG4gICAgdGVbMl0gPSBhcnJheVsyXTtcbiAgICB0ZVszXSA9IGFycmF5WzNdO1xuICAgIHRlWzRdID0gYXJyYXlbNF07XG4gICAgdGVbNV0gPSBhcnJheVs1XTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRvQXJyYXlcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiByZXR1cm5zIGFycmF5IG9iamVjdCBvZiB0aGlzXG4gKiBAcmV0dXJuIE9iamVjdFxuICovXG5NYXQzMi5wcm90b3R5cGUudG9BcnJheSA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgIGFycmF5IHx8IChhcnJheSA9IFtdKTtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgYXJyYXlbMF0gPSB0ZVswXTtcbiAgICBhcnJheVsxXSA9IHRlWzFdO1xuICAgIGFycmF5WzJdID0gdGVbMl07XG4gICAgYXJyYXlbM10gPSB0ZVszXTtcbiAgICBhcnJheVs0XSA9IHRlWzRdO1xuICAgIGFycmF5WzVdID0gdGVbNV07XG5cbiAgICByZXR1cm4gYXJyYXk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdG9TdHJpbmdcbiAqIEBtZW1iZXJvZiBPZGluLk1hdDMyXG4gKiByZXR1cm5zIHN0cmluZyBvZiB0aGlzXG4gKiBAcmV0dXJuIFN0cmluZ1xuICovXG5NYXQzMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHJldHVybiAoXG4gICAgXCJNYXQzMlsgXCIgKyB0ZVswXSArIFwiLCBcIiArIHRlWzJdICsgXCIsIFwiICsgdGVbNF0gKyBcIl1cXG5cIiArXG4gICAgXCIgICAgIFsgXCIgKyB0ZVsxXSArIFwiLCBcIiArIHRlWzNdICsgXCIsIFwiICsgdGVbNV0gKyBcIl1cIlxuICAgICk7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gTWF0MzI7XG4iLCJ2YXIgTWF0aGYgPSByZXF1aXJlKFwiLi9tYXRoZlwiKTtcbnZhciBWZWMzID0gcmVxdWlyZShcIi4vdmVjM1wiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBzcXJ0ID0gTWF0aC5zcXJ0LFxuICAgIGNvcyA9IE1hdGguY29zLFxuICAgIHNpbiA9IE1hdGguc2luLFxuICAgIHRhbiA9IE1hdGgudGFuO1xuXG4vKipcbiAqIEBjbGFzcyBNYXQ0XG4gKiA0eDQgbWF0cml4XG4gKiBAcGFyYW0gTnVtYmVyIG0xMVxuICogQHBhcmFtIE51bWJlciBtMTJcbiAqIEBwYXJhbSBOdW1iZXIgbTEzXG4gKiBAcGFyYW0gTnVtYmVyIG0xNFxuICogQHBhcmFtIE51bWJlciBtMjFcbiAqIEBwYXJhbSBOdW1iZXIgbTIyXG4gKiBAcGFyYW0gTnVtYmVyIG0yM1xuICogQHBhcmFtIE51bWJlciBtMjRcbiAqIEBwYXJhbSBOdW1iZXIgbTMxXG4gKiBAcGFyYW0gTnVtYmVyIG0zMlxuICogQHBhcmFtIE51bWJlciBtMzNcbiAqIEBwYXJhbSBOdW1iZXIgbTM0XG4gKiBAcGFyYW0gTnVtYmVyIG00MVxuICogQHBhcmFtIE51bWJlciBtNDJcbiAqIEBwYXJhbSBOdW1iZXIgbTQzXG4gKiBAcGFyYW0gTnVtYmVyIG00NFxuICovXG5mdW5jdGlvbiBNYXQ0KG0xMSwgbTEyLCBtMTMsIG0xNCwgbTIxLCBtMjIsIG0yMywgbTI0LCBtMzEsIG0zMiwgbTMzLCBtMzQsIG00MSwgbTQyLCBtNDMsIG00NCkge1xuICAgIHZhciB0ZSA9IG5ldyBGbG9hdDMyQXJyYXkoMTYpO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IEZsb2F0MzJBcnJheSBlbGVtZW50c1xuICAgICAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAgICAgKi9cbiAgICB0aGlzLmVsZW1lbnRzID0gdGU7XG5cbiAgICB0ZVswXSA9IG0xMSAhPSB1bmRlZmluZWQgPyBtMTEgOiAxLjA7XG4gICAgdGVbNF0gPSBtMTIgfHwgMC4wO1xuICAgIHRlWzhdID0gbTEzIHx8IDAuMDtcbiAgICB0ZVsxMl0gPSBtMTQgfHwgMC4wO1xuICAgIHRlWzFdID0gbTIxIHx8IDAuMDtcbiAgICB0ZVs1XSA9IG0yMiAhPSB1bmRlZmluZWQgPyBtMjIgOiAxLjA7XG4gICAgdGVbOV0gPSBtMjMgfHwgMC4wO1xuICAgIHRlWzEzXSA9IG0yNCB8fCAwLjA7XG4gICAgdGVbMl0gPSBtMzEgfHwgMC4wO1xuICAgIHRlWzZdID0gbTMyIHx8IDAuMDtcbiAgICB0ZVsxMF0gPSBtMzMgIT0gdW5kZWZpbmVkID8gbTMzIDogMS4wO1xuICAgIHRlWzE0XSA9IG0zNCB8fCAwLjA7XG4gICAgdGVbM10gPSBtNDEgfHwgMC4wO1xuICAgIHRlWzddID0gbTQyIHx8IDAuMDtcbiAgICB0ZVsxMV0gPSBtNDMgfHwgMC4wO1xuICAgIHRlWzE1XSA9IG00NCAhPSB1bmRlZmluZWQgPyBtNDQgOiAxLjA7XG59XG5cbk1hdGhmLl9jbGFzc2VzW1wiTWF0NFwiXSA9IE1hdDQ7XG5cbi8qKlxuICogQG1ldGhvZCBjbG9uZVxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogcmV0dXJucyBuZXcgaW5zdGFuY2Ugb2YgdGhpc1xuICogQHJldHVybiBNYXQ0XG4gKi9cbk1hdDQucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICByZXR1cm4gbmV3IE1hdDQoXG4gICAgICAgIHRlWzBdLCB0ZVs0XSwgdGVbOF0sIHRlWzEyXSxcbiAgICAgICAgdGVbMV0sIHRlWzVdLCB0ZVs5XSwgdGVbMTNdLFxuICAgICAgICB0ZVsyXSwgdGVbNl0sIHRlWzEwXSwgdGVbMTRdLFxuICAgICAgICB0ZVszXSwgdGVbN10sIHRlWzExXSwgdGVbMTVdXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjb3B5XG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBjb3BpZXMgb3RoZXJcbiAqIEBwYXJhbSBNYXQ0IG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIG1lID0gb3RoZXIuZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IG1lWzBdO1xuICAgIHRlWzFdID0gbWVbMV07XG4gICAgdGVbMl0gPSBtZVsyXTtcbiAgICB0ZVszXSA9IG1lWzNdO1xuICAgIHRlWzRdID0gbWVbNF07XG4gICAgdGVbNV0gPSBtZVs1XTtcbiAgICB0ZVs2XSA9IG1lWzZdO1xuICAgIHRlWzddID0gbWVbN107XG4gICAgdGVbOF0gPSBtZVs4XTtcbiAgICB0ZVs5XSA9IG1lWzldO1xuICAgIHRlWzEwXSA9IG1lWzEwXTtcbiAgICB0ZVsxMV0gPSBtZVsxMV07XG4gICAgdGVbMTJdID0gbWVbMTJdO1xuICAgIHRlWzEzXSA9IG1lWzEzXTtcbiAgICB0ZVsxNF0gPSBtZVsxNF07XG4gICAgdGVbMTVdID0gbWVbMTVdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0XG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBzZXRzIHZhbHVlcyBvZiB0aGlzXG4gKiBAcGFyYW0gTnVtYmVyIG0xMVxuICogQHBhcmFtIE51bWJlciBtMTJcbiAqIEBwYXJhbSBOdW1iZXIgbTEzXG4gKiBAcGFyYW0gTnVtYmVyIG0xNFxuICogQHBhcmFtIE51bWJlciBtMjFcbiAqIEBwYXJhbSBOdW1iZXIgbTIyXG4gKiBAcGFyYW0gTnVtYmVyIG0yM1xuICogQHBhcmFtIE51bWJlciBtMjRcbiAqIEBwYXJhbSBOdW1iZXIgbTMxXG4gKiBAcGFyYW0gTnVtYmVyIG0zMlxuICogQHBhcmFtIE51bWJlciBtMzNcbiAqIEBwYXJhbSBOdW1iZXIgbTM0XG4gKiBAcGFyYW0gTnVtYmVyIG00MVxuICogQHBhcmFtIE51bWJlciBtNDJcbiAqIEBwYXJhbSBOdW1iZXIgbTQzXG4gKiBAcGFyYW0gTnVtYmVyIG00NFxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChtMTEsIG0xMiwgbTEzLCBtMTQsIG0yMSwgbTIyLCBtMjMsIG0yNCwgbTMxLCBtMzIsIG0zMywgbTM0LCBtNDEsIG00MiwgbTQzLCBtNDQpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgdGVbMF0gPSBtMTE7XG4gICAgdGVbNF0gPSBtMTI7XG4gICAgdGVbOF0gPSBtMTM7XG4gICAgdGVbMTJdID0gbTE0O1xuICAgIHRlWzFdID0gbTIxO1xuICAgIHRlWzVdID0gbTIyO1xuICAgIHRlWzldID0gbTIzO1xuICAgIHRlWzEzXSA9IG0yNDtcbiAgICB0ZVsyXSA9IG0zMTtcbiAgICB0ZVs2XSA9IG0zMjtcbiAgICB0ZVsxMF0gPSBtMzM7XG4gICAgdGVbMTRdID0gbTM0O1xuICAgIHRlWzNdID0gbTQxO1xuICAgIHRlWzddID0gbTQyO1xuICAgIHRlWzExXSA9IG00MztcbiAgICB0ZVsxNV0gPSBtNDQ7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtdWxcbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIG11bGlwbGVzIHRoaXMncyB2YWx1ZXMgYnkgb3RoZXInc1xuICogQHBhcmFtIE1hdDQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5tdWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYWUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBiZSA9IG90aGVyLmVsZW1lbnRzLFxuXG4gICAgICAgIGExMSA9IGFlWzBdLFxuICAgICAgICBhMTIgPSBhZVs0XSxcbiAgICAgICAgYTEzID0gYWVbOF0sXG4gICAgICAgIGExNCA9IGFlWzEyXSxcbiAgICAgICAgYTIxID0gYWVbMV0sXG4gICAgICAgIGEyMiA9IGFlWzVdLFxuICAgICAgICBhMjMgPSBhZVs5XSxcbiAgICAgICAgYTI0ID0gYWVbMTNdLFxuICAgICAgICBhMzEgPSBhZVsyXSxcbiAgICAgICAgYTMyID0gYWVbNl0sXG4gICAgICAgIGEzMyA9IGFlWzEwXSxcbiAgICAgICAgYTM0ID0gYWVbMTRdLFxuICAgICAgICBhNDEgPSBhZVszXSxcbiAgICAgICAgYTQyID0gYWVbN10sXG4gICAgICAgIGE0MyA9IGFlWzExXSxcbiAgICAgICAgYTQ0ID0gYWVbMTVdLFxuXG4gICAgICAgIGIxMSA9IGJlWzBdLFxuICAgICAgICBiMTIgPSBiZVs0XSxcbiAgICAgICAgYjEzID0gYmVbOF0sXG4gICAgICAgIGIxNCA9IGJlWzEyXSxcbiAgICAgICAgYjIxID0gYmVbMV0sXG4gICAgICAgIGIyMiA9IGJlWzVdLFxuICAgICAgICBiMjMgPSBiZVs5XSxcbiAgICAgICAgYjI0ID0gYmVbMTNdLFxuICAgICAgICBiMzEgPSBiZVsyXSxcbiAgICAgICAgYjMyID0gYmVbNl0sXG4gICAgICAgIGIzMyA9IGJlWzEwXSxcbiAgICAgICAgYjM0ID0gYmVbMTRdLFxuICAgICAgICBiNDEgPSBiZVszXSxcbiAgICAgICAgYjQyID0gYmVbN10sXG4gICAgICAgIGI0MyA9IGJlWzExXSxcbiAgICAgICAgYjQ0ID0gYmVbMTVdO1xuXG4gICAgYWVbMF0gPSBhMTEgKiBiMTEgKyBhMTIgKiBiMjEgKyBhMTMgKiBiMzEgKyBhMTQgKiBiNDE7XG4gICAgYWVbNF0gPSBhMTEgKiBiMTIgKyBhMTIgKiBiMjIgKyBhMTMgKiBiMzIgKyBhMTQgKiBiNDI7XG4gICAgYWVbOF0gPSBhMTEgKiBiMTMgKyBhMTIgKiBiMjMgKyBhMTMgKiBiMzMgKyBhMTQgKiBiNDM7XG4gICAgYWVbMTJdID0gYTExICogYjE0ICsgYTEyICogYjI0ICsgYTEzICogYjM0ICsgYTE0ICogYjQ0O1xuXG4gICAgYWVbMV0gPSBhMjEgKiBiMTEgKyBhMjIgKiBiMjEgKyBhMjMgKiBiMzEgKyBhMjQgKiBiNDE7XG4gICAgYWVbNV0gPSBhMjEgKiBiMTIgKyBhMjIgKiBiMjIgKyBhMjMgKiBiMzIgKyBhMjQgKiBiNDI7XG4gICAgYWVbOV0gPSBhMjEgKiBiMTMgKyBhMjIgKiBiMjMgKyBhMjMgKiBiMzMgKyBhMjQgKiBiNDM7XG4gICAgYWVbMTNdID0gYTIxICogYjE0ICsgYTIyICogYjI0ICsgYTIzICogYjM0ICsgYTI0ICogYjQ0O1xuXG4gICAgYWVbMl0gPSBhMzEgKiBiMTEgKyBhMzIgKiBiMjEgKyBhMzMgKiBiMzEgKyBhMzQgKiBiNDE7XG4gICAgYWVbNl0gPSBhMzEgKiBiMTIgKyBhMzIgKiBiMjIgKyBhMzMgKiBiMzIgKyBhMzQgKiBiNDI7XG4gICAgYWVbMTBdID0gYTMxICogYjEzICsgYTMyICogYjIzICsgYTMzICogYjMzICsgYTM0ICogYjQzO1xuICAgIGFlWzE0XSA9IGEzMSAqIGIxNCArIGEzMiAqIGIyNCArIGEzMyAqIGIzNCArIGEzNCAqIGI0NDtcblxuICAgIGFlWzNdID0gYTQxICogYjExICsgYTQyICogYjIxICsgYTQzICogYjMxICsgYTQ0ICogYjQxO1xuICAgIGFlWzddID0gYTQxICogYjEyICsgYTQyICogYjIyICsgYTQzICogYjMyICsgYTQ0ICogYjQyO1xuICAgIGFlWzExXSA9IGE0MSAqIGIxMyArIGE0MiAqIGIyMyArIGE0MyAqIGIzMyArIGE0NCAqIGI0MztcbiAgICBhZVsxNV0gPSBhNDEgKiBiMTQgKyBhNDIgKiBiMjQgKyBhNDMgKiBiMzQgKyBhNDQgKiBiNDQ7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtbXVsXG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBtdWxpcGxlcyBhIGFuZCBiIHNhdmVzIGl0IGluIHRoaXNcbiAqIEBwYXJhbSBNYXQ0IGFcbiAqIEBwYXJhbSBNYXQ0IGJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5tbXVsID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBhZSA9IGEuZWxlbWVudHMsXG4gICAgICAgIGJlID0gYi5lbGVtZW50cyxcblxuICAgICAgICBhMTEgPSBhZVswXSxcbiAgICAgICAgYTEyID0gYWVbNF0sXG4gICAgICAgIGExMyA9IGFlWzhdLFxuICAgICAgICBhMTQgPSBhZVsxMl0sXG4gICAgICAgIGEyMSA9IGFlWzFdLFxuICAgICAgICBhMjIgPSBhZVs1XSxcbiAgICAgICAgYTIzID0gYWVbOV0sXG4gICAgICAgIGEyNCA9IGFlWzEzXSxcbiAgICAgICAgYTMxID0gYWVbMl0sXG4gICAgICAgIGEzMiA9IGFlWzZdLFxuICAgICAgICBhMzMgPSBhZVsxMF0sXG4gICAgICAgIGEzNCA9IGFlWzE0XSxcbiAgICAgICAgYTQxID0gYWVbM10sXG4gICAgICAgIGE0MiA9IGFlWzddLFxuICAgICAgICBhNDMgPSBhZVsxMV0sXG4gICAgICAgIGE0NCA9IGFlWzE1XSxcblxuICAgICAgICBiMTEgPSBiZVswXSxcbiAgICAgICAgYjEyID0gYmVbNF0sXG4gICAgICAgIGIxMyA9IGJlWzhdLFxuICAgICAgICBiMTQgPSBiZVsxMl0sXG4gICAgICAgIGIyMSA9IGJlWzFdLFxuICAgICAgICBiMjIgPSBiZVs1XSxcbiAgICAgICAgYjIzID0gYmVbOV0sXG4gICAgICAgIGIyNCA9IGJlWzEzXSxcbiAgICAgICAgYjMxID0gYmVbMl0sXG4gICAgICAgIGIzMiA9IGJlWzZdLFxuICAgICAgICBiMzMgPSBiZVsxMF0sXG4gICAgICAgIGIzNCA9IGJlWzE0XSxcbiAgICAgICAgYjQxID0gYmVbM10sXG4gICAgICAgIGI0MiA9IGJlWzddLFxuICAgICAgICBiNDMgPSBiZVsxMV0sXG4gICAgICAgIGI0NCA9IGJlWzE1XTtcblxuICAgIHRlWzBdID0gYTExICogYjExICsgYTEyICogYjIxICsgYTEzICogYjMxICsgYTE0ICogYjQxO1xuICAgIHRlWzRdID0gYTExICogYjEyICsgYTEyICogYjIyICsgYTEzICogYjMyICsgYTE0ICogYjQyO1xuICAgIHRlWzhdID0gYTExICogYjEzICsgYTEyICogYjIzICsgYTEzICogYjMzICsgYTE0ICogYjQzO1xuICAgIHRlWzEyXSA9IGExMSAqIGIxNCArIGExMiAqIGIyNCArIGExMyAqIGIzNCArIGExNCAqIGI0NDtcblxuICAgIHRlWzFdID0gYTIxICogYjExICsgYTIyICogYjIxICsgYTIzICogYjMxICsgYTI0ICogYjQxO1xuICAgIHRlWzVdID0gYTIxICogYjEyICsgYTIyICogYjIyICsgYTIzICogYjMyICsgYTI0ICogYjQyO1xuICAgIHRlWzldID0gYTIxICogYjEzICsgYTIyICogYjIzICsgYTIzICogYjMzICsgYTI0ICogYjQzO1xuICAgIHRlWzEzXSA9IGEyMSAqIGIxNCArIGEyMiAqIGIyNCArIGEyMyAqIGIzNCArIGEyNCAqIGI0NDtcblxuICAgIHRlWzJdID0gYTMxICogYjExICsgYTMyICogYjIxICsgYTMzICogYjMxICsgYTM0ICogYjQxO1xuICAgIHRlWzZdID0gYTMxICogYjEyICsgYTMyICogYjIyICsgYTMzICogYjMyICsgYTM0ICogYjQyO1xuICAgIHRlWzEwXSA9IGEzMSAqIGIxMyArIGEzMiAqIGIyMyArIGEzMyAqIGIzMyArIGEzNCAqIGI0MztcbiAgICB0ZVsxNF0gPSBhMzEgKiBiMTQgKyBhMzIgKiBiMjQgKyBhMzMgKiBiMzQgKyBhMzQgKiBiNDQ7XG5cbiAgICB0ZVszXSA9IGE0MSAqIGIxMSArIGE0MiAqIGIyMSArIGE0MyAqIGIzMSArIGE0NCAqIGI0MTtcbiAgICB0ZVs3XSA9IGE0MSAqIGIxMiArIGE0MiAqIGIyMiArIGE0MyAqIGIzMiArIGE0NCAqIGI0MjtcbiAgICB0ZVsxMV0gPSBhNDEgKiBiMTMgKyBhNDIgKiBiMjMgKyBhNDMgKiBiMzMgKyBhNDQgKiBiNDM7XG4gICAgdGVbMTVdID0gYTQxICogYjE0ICsgYTQyICogYjI0ICsgYTQzICogYjM0ICsgYTQ0ICogYjQ0O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc211bFxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogbXVsaXBsZXMgdGhpcyBieSBhIHNjYWxhciB2YWx1ZVxuICogQHBhcmFtIE51bWJlciBzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUuc211bCA9IGZ1bmN0aW9uIChzKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHRlWzBdICo9IHM7XG4gICAgdGVbMV0gKj0gcztcbiAgICB0ZVsyXSAqPSBzO1xuICAgIHRlWzNdICo9IHM7XG4gICAgdGVbNF0gKj0gcztcbiAgICB0ZVs1XSAqPSBzO1xuICAgIHRlWzZdICo9IHM7XG4gICAgdGVbN10gKj0gcztcbiAgICB0ZVs4XSAqPSBzO1xuICAgIHRlWzldICo9IHM7XG4gICAgdGVbMTBdICo9IHM7XG4gICAgdGVbMTFdICo9IHM7XG4gICAgdGVbMTJdICo9IHM7XG4gICAgdGVbMTNdICo9IHM7XG4gICAgdGVbMTRdICo9IHM7XG4gICAgdGVbMTVdICo9IHM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZGl2XG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBkaXZpZGVzIHRoaXMgYnkgc2NhbGFyIHZhbHVlXG4gKiBAcGFyYW0gTnVtYmVyIHNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5zZGl2ID0gZnVuY3Rpb24gKHMpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgcyA9IHMgIT09IDAuMCA/IDEuMCAvIHMgOiAxLjA7XG5cbiAgICB0ZVswXSAqPSBzO1xuICAgIHRlWzFdICo9IHM7XG4gICAgdGVbMl0gKj0gcztcbiAgICB0ZVszXSAqPSBzO1xuICAgIHRlWzRdICo9IHM7XG4gICAgdGVbNV0gKj0gcztcbiAgICB0ZVs2XSAqPSBzO1xuICAgIHRlWzddICo9IHM7XG4gICAgdGVbOF0gKj0gcztcbiAgICB0ZVs5XSAqPSBzO1xuICAgIHRlWzEwXSAqPSBzO1xuICAgIHRlWzExXSAqPSBzO1xuICAgIHRlWzEyXSAqPSBzO1xuICAgIHRlWzEzXSAqPSBzO1xuICAgIHRlWzE0XSAqPSBzO1xuICAgIHRlWzE1XSAqPSBzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgaWRlbnRpdHlcbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIGlkZW50aXR5IG1hdHJpeFxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLmlkZW50aXR5ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IDE7XG4gICAgdGVbMV0gPSAwLjA7XG4gICAgdGVbMl0gPSAwLjA7XG4gICAgdGVbM10gPSAwLjA7XG4gICAgdGVbNF0gPSAwLjA7XG4gICAgdGVbNV0gPSAxO1xuICAgIHRlWzZdID0gMC4wO1xuICAgIHRlWzddID0gMC4wO1xuICAgIHRlWzhdID0gMC4wO1xuICAgIHRlWzldID0gMC4wO1xuICAgIHRlWzEwXSA9IDE7XG4gICAgdGVbMTFdID0gMC4wO1xuICAgIHRlWzEyXSA9IDAuMDtcbiAgICB0ZVsxM10gPSAwLjA7XG4gICAgdGVbMTRdID0gMC4wO1xuICAgIHRlWzE1XSA9IDE7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB6ZXJvXG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiB6ZXJvIG1hdHJpeFxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLnplcm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHRlWzBdID0gMC4wO1xuICAgIHRlWzFdID0gMC4wO1xuICAgIHRlWzJdID0gMC4wO1xuICAgIHRlWzNdID0gMC4wO1xuICAgIHRlWzRdID0gMC4wO1xuICAgIHRlWzVdID0gMC4wO1xuICAgIHRlWzZdID0gMC4wO1xuICAgIHRlWzddID0gMC4wO1xuICAgIHRlWzhdID0gMC4wO1xuICAgIHRlWzldID0gMC4wO1xuICAgIHRlWzEwXSA9IDAuMDtcbiAgICB0ZVsxMV0gPSAwLjA7XG4gICAgdGVbMTJdID0gMC4wO1xuICAgIHRlWzEzXSA9IDAuMDtcbiAgICB0ZVsxNF0gPSAwLjA7XG4gICAgdGVbMTVdID0gMC4wO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZGV0ZXJtaW5hbnRcbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIHJldHVybnMgdGhlIGRldGVybWluYW50IG9mIHRoaXNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5kZXRlcm1pbmFudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbTExID0gYWVbMF0sXG4gICAgICAgIG0xMiA9IGFlWzRdLFxuICAgICAgICBtMTMgPSBhZVs4XSxcbiAgICAgICAgbTE0ID0gYWVbMTJdLFxuICAgICAgICBtMjEgPSBhZVsxXSxcbiAgICAgICAgbTIyID0gYWVbNV0sXG4gICAgICAgIG0yMyA9IGFlWzldLFxuICAgICAgICBtMjQgPSBhZVsxM10sXG4gICAgICAgIG0zMSA9IGFlWzJdLFxuICAgICAgICBtMzIgPSBhZVs2XSxcbiAgICAgICAgbTMzID0gYWVbMTBdLFxuICAgICAgICBtMzQgPSBhZVsxNF0sXG4gICAgICAgIG00MSA9IGFlWzNdLFxuICAgICAgICBtNDIgPSBhZVs3XSxcbiAgICAgICAgbTQzID0gYWVbMTFdLFxuICAgICAgICBtNDQgPSBhZVsxNV07XG5cbiAgICByZXR1cm4gKFxuICAgIG00MSAqIChtMTQgKiBtMjMgKiBtMzIgLSBtMTMgKiBtMjQgKiBtMzIgLSBtMTQgKiBtMjIgKiBtMzMgKyBtMTIgKiBtMjQgKiBtMzMgKyBtMTMgKiBtMjIgKiBtMzQgLSBtMTIgKiBtMjMgKiBtMzQpICtcbiAgICBtNDIgKiAobTExICogbTIzICogbTM0IC0gbTExICogbTI0ICogbTMzICsgbTE0ICogbTIxICogbTMzIC0gbTEzICogbTIxICogbTM0ICsgbTEzICogbTI0ICogbTMxIC0gbTE0ICogbTIzICogbTMxKSArXG4gICAgbTQzICogKG0xMSAqIG0yNCAqIG0zMiAtIG0xMSAqIG0yMiAqIG0zNCAtIG0xNCAqIG0yMSAqIG0zMiArIG0xMiAqIG0yMSAqIG0zNCArIG0xNCAqIG0yMiAqIG0zMSAtIG0xMiAqIG0yNCAqIG0zMSkgK1xuICAgIG00NCAqICgtbTEzICogbTIyICogbTMxIC0gbTExICogbTIzICogbTMyICsgbTExICogbTIyICogbTMzICsgbTEzICogbTIxICogbTMyIC0gbTEyICogbTIxICogbTMzICsgbTEyICogbTIzICogbTMxKVxuICAgICk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgaW52ZXJzZVxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogcmV0dXJucyB0aGUgaW52ZXJzZSBvZiB0aGlzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUuaW52ZXJzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuXG4gICAgICAgIG0xMSA9IHRlWzBdLFxuICAgICAgICBtMTIgPSB0ZVs0XSxcbiAgICAgICAgbTEzID0gdGVbOF0sXG4gICAgICAgIG0xNCA9IHRlWzEyXSxcbiAgICAgICAgbTIxID0gdGVbMV0sXG4gICAgICAgIG0yMiA9IHRlWzVdLFxuICAgICAgICBtMjMgPSB0ZVs5XSxcbiAgICAgICAgbTI0ID0gdGVbMTNdLFxuICAgICAgICBtMzEgPSB0ZVsyXSxcbiAgICAgICAgbTMyID0gdGVbNl0sXG4gICAgICAgIG0zMyA9IHRlWzEwXSxcbiAgICAgICAgbTM0ID0gdGVbMTRdLFxuICAgICAgICBtNDEgPSB0ZVszXSxcbiAgICAgICAgbTQyID0gdGVbN10sXG4gICAgICAgIG00MyA9IHRlWzExXSxcbiAgICAgICAgbTQ0ID0gdGVbMTVdLFxuXG4gICAgICAgIG1lMCA9IG0yMyAqIG0zNCAqIG00MiAtIG0yNCAqIG0zMyAqIG00MiArIG0yNCAqIG0zMiAqIG00MyAtIG0yMiAqIG0zNCAqIG00MyAtIG0yMyAqIG0zMiAqIG00NCArIG0yMiAqIG0zMyAqIG00NCxcbiAgICAgICAgbWU0ID0gbTE0ICogbTMzICogbTQyIC0gbTEzICogbTM0ICogbTQyIC0gbTE0ICogbTMyICogbTQzICsgbTEyICogbTM0ICogbTQzICsgbTEzICogbTMyICogbTQ0IC0gbTEyICogbTMzICogbTQ0LFxuICAgICAgICBtZTggPSBtMTMgKiBtMjQgKiBtNDIgLSBtMTQgKiBtMjMgKiBtNDIgKyBtMTQgKiBtMjIgKiBtNDMgLSBtMTIgKiBtMjQgKiBtNDMgLSBtMTMgKiBtMjIgKiBtNDQgKyBtMTIgKiBtMjMgKiBtNDQsXG4gICAgICAgIG1lMTIgPSBtMTQgKiBtMjMgKiBtMzIgLSBtMTMgKiBtMjQgKiBtMzIgLSBtMTQgKiBtMjIgKiBtMzMgKyBtMTIgKiBtMjQgKiBtMzMgKyBtMTMgKiBtMjIgKiBtMzQgLSBtMTIgKiBtMjMgKiBtMzQsXG5cbiAgICAgICAgZGV0ID0gbTExICogbWUwICsgbTIxICogbWU0ICsgbTMxICogbWU4ICsgbTQxICogbWUxMjtcblxuICAgIGlmIChkZXQgPT09IDAuMCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pZGVudGl0eSgpO1xuICAgIH1cbiAgICBkZXQgPSAxLjAgLyBkZXQ7XG5cbiAgICB0ZVswXSA9IG1lMCAqIGRldDtcbiAgICB0ZVs0XSA9IG1lNCAqIGRldDtcbiAgICB0ZVs4XSA9IG1lOCAqIGRldDtcbiAgICB0ZVsxMl0gPSBtZTEyICogZGV0O1xuICAgIHRlWzFdID0gKG0yNCAqIG0zMyAqIG00MSAtIG0yMyAqIG0zNCAqIG00MSAtIG0yNCAqIG0zMSAqIG00MyArIG0yMSAqIG0zNCAqIG00MyArIG0yMyAqIG0zMSAqIG00NCAtIG0yMSAqIG0zMyAqIG00NCkgKiBkZXQ7XG4gICAgdGVbNV0gPSAobTEzICogbTM0ICogbTQxIC0gbTE0ICogbTMzICogbTQxICsgbTE0ICogbTMxICogbTQzIC0gbTExICogbTM0ICogbTQzIC0gbTEzICogbTMxICogbTQ0ICsgbTExICogbTMzICogbTQ0KSAqIGRldDtcbiAgICB0ZVs5XSA9IChtMTQgKiBtMjMgKiBtNDEgLSBtMTMgKiBtMjQgKiBtNDEgLSBtMTQgKiBtMjEgKiBtNDMgKyBtMTEgKiBtMjQgKiBtNDMgKyBtMTMgKiBtMjEgKiBtNDQgLSBtMTEgKiBtMjMgKiBtNDQpICogZGV0O1xuICAgIHRlWzEzXSA9IChtMTMgKiBtMjQgKiBtMzEgLSBtMTQgKiBtMjMgKiBtMzEgKyBtMTQgKiBtMjEgKiBtMzMgLSBtMTEgKiBtMjQgKiBtMzMgLSBtMTMgKiBtMjEgKiBtMzQgKyBtMTEgKiBtMjMgKiBtMzQpICogZGV0O1xuICAgIHRlWzJdID0gKG0yMiAqIG0zNCAqIG00MSAtIG0yNCAqIG0zMiAqIG00MSArIG0yNCAqIG0zMSAqIG00MiAtIG0yMSAqIG0zNCAqIG00MiAtIG0yMiAqIG0zMSAqIG00NCArIG0yMSAqIG0zMiAqIG00NCkgKiBkZXQ7XG4gICAgdGVbNl0gPSAobTE0ICogbTMyICogbTQxIC0gbTEyICogbTM0ICogbTQxIC0gbTE0ICogbTMxICogbTQyICsgbTExICogbTM0ICogbTQyICsgbTEyICogbTMxICogbTQ0IC0gbTExICogbTMyICogbTQ0KSAqIGRldDtcbiAgICB0ZVsxMF0gPSAobTEyICogbTI0ICogbTQxIC0gbTE0ICogbTIyICogbTQxICsgbTE0ICogbTIxICogbTQyIC0gbTExICogbTI0ICogbTQyIC0gbTEyICogbTIxICogbTQ0ICsgbTExICogbTIyICogbTQ0KSAqIGRldDtcbiAgICB0ZVsxNF0gPSAobTE0ICogbTIyICogbTMxIC0gbTEyICogbTI0ICogbTMxIC0gbTE0ICogbTIxICogbTMyICsgbTExICogbTI0ICogbTMyICsgbTEyICogbTIxICogbTM0IC0gbTExICogbTIyICogbTM0KSAqIGRldDtcbiAgICB0ZVszXSA9IChtMjMgKiBtMzIgKiBtNDEgLSBtMjIgKiBtMzMgKiBtNDEgLSBtMjMgKiBtMzEgKiBtNDIgKyBtMjEgKiBtMzMgKiBtNDIgKyBtMjIgKiBtMzEgKiBtNDMgLSBtMjEgKiBtMzIgKiBtNDMpICogZGV0O1xuICAgIHRlWzddID0gKG0xMiAqIG0zMyAqIG00MSAtIG0xMyAqIG0zMiAqIG00MSArIG0xMyAqIG0zMSAqIG00MiAtIG0xMSAqIG0zMyAqIG00MiAtIG0xMiAqIG0zMSAqIG00MyArIG0xMSAqIG0zMiAqIG00MykgKiBkZXQ7XG4gICAgdGVbMTFdID0gKG0xMyAqIG0yMiAqIG00MSAtIG0xMiAqIG0yMyAqIG00MSAtIG0xMyAqIG0yMSAqIG00MiArIG0xMSAqIG0yMyAqIG00MiArIG0xMiAqIG0yMSAqIG00MyAtIG0xMSAqIG0yMiAqIG00MykgKiBkZXQ7XG4gICAgdGVbMTVdID0gKG0xMiAqIG0yMyAqIG0zMSAtIG0xMyAqIG0yMiAqIG0zMSArIG0xMyAqIG0yMSAqIG0zMiAtIG0xMSAqIG0yMyAqIG0zMiAtIG0xMiAqIG0yMSAqIG0zMyArIG0xMSAqIG0yMiAqIG0zMykgKiBkZXQ7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBpbnZlcnNlTWF0XG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiByZXR1cm5zIHRoZSBpbnZlcnNlIG9mIG90aGVyXG4gKiBAcGFyYW0gTWF0NCBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLmludmVyc2VNYXQgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBtZSA9IG90aGVyLmVsZW1lbnRzLFxuXG4gICAgICAgIG0xMSA9IG1lWzBdLFxuICAgICAgICBtMTIgPSBtZVs0XSxcbiAgICAgICAgbTEzID0gbWVbOF0sXG4gICAgICAgIG0xNCA9IG1lWzEyXSxcbiAgICAgICAgbTIxID0gbWVbMV0sXG4gICAgICAgIG0yMiA9IG1lWzVdLFxuICAgICAgICBtMjMgPSBtZVs5XSxcbiAgICAgICAgbTI0ID0gbWVbMTNdLFxuICAgICAgICBtMzEgPSBtZVsyXSxcbiAgICAgICAgbTMyID0gbWVbNl0sXG4gICAgICAgIG0zMyA9IG1lWzEwXSxcbiAgICAgICAgbTM0ID0gbWVbMTRdLFxuICAgICAgICBtNDEgPSBtZVszXSxcbiAgICAgICAgbTQyID0gbWVbN10sXG4gICAgICAgIG00MyA9IG1lWzExXSxcbiAgICAgICAgbTQ0ID0gbWVbMTVdLFxuXG4gICAgICAgIG1lMCA9IG0yMyAqIG0zNCAqIG00MiAtIG0yNCAqIG0zMyAqIG00MiArIG0yNCAqIG0zMiAqIG00MyAtIG0yMiAqIG0zNCAqIG00MyAtIG0yMyAqIG0zMiAqIG00NCArIG0yMiAqIG0zMyAqIG00NCxcbiAgICAgICAgbWU0ID0gbTE0ICogbTMzICogbTQyIC0gbTEzICogbTM0ICogbTQyIC0gbTE0ICogbTMyICogbTQzICsgbTEyICogbTM0ICogbTQzICsgbTEzICogbTMyICogbTQ0IC0gbTEyICogbTMzICogbTQ0LFxuICAgICAgICBtZTggPSBtMTMgKiBtMjQgKiBtNDIgLSBtMTQgKiBtMjMgKiBtNDIgKyBtMTQgKiBtMjIgKiBtNDMgLSBtMTIgKiBtMjQgKiBtNDMgLSBtMTMgKiBtMjIgKiBtNDQgKyBtMTIgKiBtMjMgKiBtNDQsXG4gICAgICAgIG1lMTIgPSBtMTQgKiBtMjMgKiBtMzIgLSBtMTMgKiBtMjQgKiBtMzIgLSBtMTQgKiBtMjIgKiBtMzMgKyBtMTIgKiBtMjQgKiBtMzMgKyBtMTMgKiBtMjIgKiBtMzQgLSBtMTIgKiBtMjMgKiBtMzQsXG5cbiAgICAgICAgZGV0ID0gbTExICogbWUwICsgbTIxICogbWU0ICsgbTMxICogbWU4ICsgbTQxICogbWUxMjtcblxuICAgIGlmIChkZXQgPT09IDAuMCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pZGVudGl0eSgpO1xuICAgIH1cbiAgICBkZXQgPSAxLjAgLyBkZXQ7XG5cbiAgICB0ZVswXSA9IG1lMCAqIGRldDtcbiAgICB0ZVs0XSA9IG1lNCAqIGRldDtcbiAgICB0ZVs4XSA9IG1lOCAqIGRldDtcbiAgICB0ZVsxMl0gPSBtZTEyICogZGV0O1xuICAgIHRlWzFdID0gKG0yNCAqIG0zMyAqIG00MSAtIG0yMyAqIG0zNCAqIG00MSAtIG0yNCAqIG0zMSAqIG00MyArIG0yMSAqIG0zNCAqIG00MyArIG0yMyAqIG0zMSAqIG00NCAtIG0yMSAqIG0zMyAqIG00NCkgKiBkZXQ7XG4gICAgdGVbNV0gPSAobTEzICogbTM0ICogbTQxIC0gbTE0ICogbTMzICogbTQxICsgbTE0ICogbTMxICogbTQzIC0gbTExICogbTM0ICogbTQzIC0gbTEzICogbTMxICogbTQ0ICsgbTExICogbTMzICogbTQ0KSAqIGRldDtcbiAgICB0ZVs5XSA9IChtMTQgKiBtMjMgKiBtNDEgLSBtMTMgKiBtMjQgKiBtNDEgLSBtMTQgKiBtMjEgKiBtNDMgKyBtMTEgKiBtMjQgKiBtNDMgKyBtMTMgKiBtMjEgKiBtNDQgLSBtMTEgKiBtMjMgKiBtNDQpICogZGV0O1xuICAgIHRlWzEzXSA9IChtMTMgKiBtMjQgKiBtMzEgLSBtMTQgKiBtMjMgKiBtMzEgKyBtMTQgKiBtMjEgKiBtMzMgLSBtMTEgKiBtMjQgKiBtMzMgLSBtMTMgKiBtMjEgKiBtMzQgKyBtMTEgKiBtMjMgKiBtMzQpICogZGV0O1xuICAgIHRlWzJdID0gKG0yMiAqIG0zNCAqIG00MSAtIG0yNCAqIG0zMiAqIG00MSArIG0yNCAqIG0zMSAqIG00MiAtIG0yMSAqIG0zNCAqIG00MiAtIG0yMiAqIG0zMSAqIG00NCArIG0yMSAqIG0zMiAqIG00NCkgKiBkZXQ7XG4gICAgdGVbNl0gPSAobTE0ICogbTMyICogbTQxIC0gbTEyICogbTM0ICogbTQxIC0gbTE0ICogbTMxICogbTQyICsgbTExICogbTM0ICogbTQyICsgbTEyICogbTMxICogbTQ0IC0gbTExICogbTMyICogbTQ0KSAqIGRldDtcbiAgICB0ZVsxMF0gPSAobTEyICogbTI0ICogbTQxIC0gbTE0ICogbTIyICogbTQxICsgbTE0ICogbTIxICogbTQyIC0gbTExICogbTI0ICogbTQyIC0gbTEyICogbTIxICogbTQ0ICsgbTExICogbTIyICogbTQ0KSAqIGRldDtcbiAgICB0ZVsxNF0gPSAobTE0ICogbTIyICogbTMxIC0gbTEyICogbTI0ICogbTMxIC0gbTE0ICogbTIxICogbTMyICsgbTExICogbTI0ICogbTMyICsgbTEyICogbTIxICogbTM0IC0gbTExICogbTIyICogbTM0KSAqIGRldDtcbiAgICB0ZVszXSA9IChtMjMgKiBtMzIgKiBtNDEgLSBtMjIgKiBtMzMgKiBtNDEgLSBtMjMgKiBtMzEgKiBtNDIgKyBtMjEgKiBtMzMgKiBtNDIgKyBtMjIgKiBtMzEgKiBtNDMgLSBtMjEgKiBtMzIgKiBtNDMpICogZGV0O1xuICAgIHRlWzddID0gKG0xMiAqIG0zMyAqIG00MSAtIG0xMyAqIG0zMiAqIG00MSArIG0xMyAqIG0zMSAqIG00MiAtIG0xMSAqIG0zMyAqIG00MiAtIG0xMiAqIG0zMSAqIG00MyArIG0xMSAqIG0zMiAqIG00MykgKiBkZXQ7XG4gICAgdGVbMTFdID0gKG0xMyAqIG0yMiAqIG00MSAtIG0xMiAqIG0yMyAqIG00MSAtIG0xMyAqIG0yMSAqIG00MiArIG0xMSAqIG0yMyAqIG00MiArIG0xMiAqIG0yMSAqIG00MyAtIG0xMSAqIG0yMiAqIG00MykgKiBkZXQ7XG4gICAgdGVbMTVdID0gKG0xMiAqIG0yMyAqIG0zMSAtIG0xMyAqIG0yMiAqIG0zMSArIG0xMyAqIG0yMSAqIG0zMiAtIG0xMSAqIG0yMyAqIG0zMiAtIG0xMiAqIG0yMSAqIG0zMyArIG0xMSAqIG0yMiAqIG0zMykgKiBkZXQ7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0cmFuc3Bvc2VcbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIHRyYW5zcG9zZXMgdGhpcyBtYXRyaXhcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS50cmFuc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgdG1wO1xuXG4gICAgdG1wID0gdGVbMV07XG4gICAgdGVbMV0gPSB0ZVs0XTtcbiAgICB0ZVs0XSA9IHRtcDtcbiAgICB0bXAgPSB0ZVsyXTtcbiAgICB0ZVsyXSA9IHRlWzhdO1xuICAgIHRlWzhdID0gdG1wO1xuICAgIHRtcCA9IHRlWzZdO1xuICAgIHRlWzZdID0gdGVbOV07XG4gICAgdGVbOV0gPSB0bXA7XG5cbiAgICB0bXAgPSB0ZVszXTtcbiAgICB0ZVszXSA9IHRlWzEyXTtcbiAgICB0ZVsxMl0gPSB0bXA7XG4gICAgdG1wID0gdGVbN107XG4gICAgdGVbN10gPSB0ZVsxM107XG4gICAgdGVbMTNdID0gdG1wO1xuICAgIHRtcCA9IHRlWzExXTtcbiAgICB0ZVsxMV0gPSB0ZVsxNF07XG4gICAgdGVbMTRdID0gdG1wO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0VHJhY2VcbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIHNldHMgdGhlIGRpYWdvbmFsIG9mIG1hdHJpeFxuICogQHBhcmFtIFZlYzQgdlxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLnNldFRyYWNlID0gZnVuY3Rpb24gKHYpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICB3ID0gdi53O1xuXG4gICAgdGVbMF0gPSB2Lng7XG4gICAgdGVbNV0gPSB2Lnk7XG4gICAgdGVbMTBdID0gdi56O1xuICAgIHRlWzE1XSA9IHcgIT0gdW5kZWZpbmVkID8gdyA6IDEuMDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGxvb2tBdFxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogbWFrZXMgbWF0cml4IGxvb2sgZnJvbSBleWUgYXQgdGFyZ2V0IGFsb25nIHVwIHZlY3RvclxuICogQHBhcmFtIFZlYzMgZXllXG4gKiBAcGFyYW0gVmVjMyB0YXJnZXRcbiAqIEBwYXJhbSBWZWMzIHVwXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUubG9va0F0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBkdXAgPSBuZXcgVmVjMygwLjAsIDAuMCwgMS4wKSxcbiAgICAgICAgeCA9IG5ldyBWZWMzLFxuICAgICAgICB5ID0gbmV3IFZlYzMsXG4gICAgICAgIHogPSBuZXcgVmVjMztcblxuICAgIHJldHVybiBmdW5jdGlvbiAoZXllLCB0YXJnZXQsIHVwKSB7XG4gICAgICAgIHVwIHx8ICh1cCA9IGR1cCk7XG4gICAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICAgICAgei52c3ViKGV5ZSwgdGFyZ2V0KS5ub3JtYWxpemUoKTtcbiAgICAgICAgaWYgKHoubGVuZ3RoKCkgPT09IDAuMCkgei56ID0gMS4wO1xuXG4gICAgICAgIHgudmNyb3NzKHVwLCB6KS5ub3JtYWxpemUoKTtcblxuICAgICAgICBpZiAoeC5sZW5ndGgoKSA9PT0gMC4wKSB7XG4gICAgICAgICAgICB6LnggKz0gMC4wMDAwMDE7XG4gICAgICAgICAgICB4LnZjcm9zcyh1cCwgeikubm9ybWFsaXplKCk7XG4gICAgICAgIH1cblxuICAgICAgICB5LnZjcm9zcyh6LCB4KTtcblxuXG4gICAgICAgIHRlWzBdID0geC54O1xuICAgICAgICB0ZVs0XSA9IHkueDtcbiAgICAgICAgdGVbOF0gPSB6Lng7XG4gICAgICAgIHRlWzFdID0geC55O1xuICAgICAgICB0ZVs1XSA9IHkueTtcbiAgICAgICAgdGVbOV0gPSB6Lnk7XG4gICAgICAgIHRlWzJdID0geC56O1xuICAgICAgICB0ZVs2XSA9IHkuejtcbiAgICAgICAgdGVbMTBdID0gei56O1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG59KCk7XG5cbi8qKlxuICogQG1ldGhvZCBjb21wb3NlXG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBzZXRzIG1hdHJpeCBmcm9tIHBvc2l0aW9uLCBzY2FsZSwgYW5kIHF1YXRlcm5pb25cbiAqIEBwYXJhbSBWZWMzIHBvc2l0aW9uXG4gKiBAcGFyYW0gVmVjMyBzY2FsZVxuICogQHBhcmFtIFF1YXQgcm90YXRpb25cbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5jb21wb3NlID0gZnVuY3Rpb24gKHBvc2l0aW9uLCBzY2FsZSwgcm90YXRpb24pIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICB4ID0gcm90YXRpb24ueCxcbiAgICAgICAgeSA9IHJvdGF0aW9uLnksXG4gICAgICAgIHogPSByb3RhdGlvbi56LFxuICAgICAgICB3ID0gcm90YXRpb24udyxcbiAgICAgICAgeDIgPSB4ICsgeCxcbiAgICAgICAgeTIgPSB5ICsgeSxcbiAgICAgICAgejIgPSB6ICsgeixcbiAgICAgICAgeHggPSB4ICogeDIsXG4gICAgICAgIHh5ID0geCAqIHkyLFxuICAgICAgICB4eiA9IHggKiB6MixcbiAgICAgICAgeXkgPSB5ICogeTIsXG4gICAgICAgIHl6ID0geSAqIHoyLFxuICAgICAgICB6eiA9IHogKiB6MixcbiAgICAgICAgd3ggPSB3ICogeDIsXG4gICAgICAgIHd5ID0gdyAqIHkyLFxuICAgICAgICB3eiA9IHcgKiB6MixcblxuICAgICAgICBzeCA9IHNjYWxlLngsXG4gICAgICAgIHN5ID0gc2NhbGUueSxcbiAgICAgICAgc3ogPSBzY2FsZS56O1xuXG4gICAgdGVbMF0gPSAoMS4wIC0gKHl5ICsgenopKSAqIHN4O1xuICAgIHRlWzRdID0gKHh5IC0gd3opICogc3k7XG4gICAgdGVbOF0gPSAoeHogKyB3eSkgKiBzejtcblxuICAgIHRlWzFdID0gKHh5ICsgd3opICogc3g7XG4gICAgdGVbNV0gPSAoMS4wIC0gKHh4ICsgenopKSAqIHN5O1xuICAgIHRlWzldID0gKHl6IC0gd3gpICogc3o7XG5cbiAgICB0ZVsyXSA9ICh4eiAtIHd5KSAqIHN4O1xuICAgIHRlWzZdID0gKHl6ICsgd3gpICogc3k7XG4gICAgdGVbMTBdID0gKDEuMCAtICh4eCArIHl5KSkgKiBzejtcblxuICAgIHRlWzNdID0gMC4wO1xuICAgIHRlWzddID0gMC4wO1xuICAgIHRlWzExXSA9IDAuMDtcblxuICAgIHRlWzEyXSA9IHBvc2l0aW9uLng7XG4gICAgdGVbMTNdID0gcG9zaXRpb24ueTtcbiAgICB0ZVsxNF0gPSBwb3NpdGlvbi56O1xuICAgIHRlWzE1XSA9IDEuMDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGRlY29tcG9zZVxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogZ2V0cyBtYXRyaXggcG9zaXRpb24sIHNjYWxlLCBxdWF0ZXJuaW9uXG4gKiBAcGFyYW0gVmVjMyBwb3NpdGlvblxuICogQHBhcmFtIFZlYzMgc2NhbGVcbiAqIEBwYXJhbSBRdWF0IHF1YXRlcm5pb25cbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5kZWNvbXBvc2UgPSBmdW5jdGlvbiAocG9zaXRpb24sIHNjYWxlLCBxdWF0ZXJuaW9uKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcblxuICAgICAgICBtMTEgPSB0ZVswXSxcbiAgICAgICAgbTEyID0gdGVbNF0sXG4gICAgICAgIG0xMyA9IHRlWzhdLFxuICAgICAgICBtMjEgPSB0ZVsxXSxcbiAgICAgICAgbTIyID0gdGVbNV0sXG4gICAgICAgIG0yMyA9IHRlWzldLFxuICAgICAgICBtMzEgPSB0ZVsyXSxcbiAgICAgICAgbTMyID0gdGVbNl0sXG4gICAgICAgIG0zMyA9IHRlWzEwXSxcbiAgICAgICAgdHJhY2UsIHggPSAwLjAsXG4gICAgICAgIHkgPSAwLjAsXG4gICAgICAgIHogPSAwLjAsXG4gICAgICAgIHcgPSAxLFxuICAgICAgICBzLFxuXG4gICAgICAgIHN4ID0gc2NhbGUuc2V0KG0xMSwgbTIxLCBtMzEpLmxlbmd0aCgpLFxuICAgICAgICBzeSA9IHNjYWxlLnNldChtMTIsIG0yMiwgbTMyKS5sZW5ndGgoKSxcbiAgICAgICAgc3ogPSBzY2FsZS5zZXQobTEzLCBtMjMsIG0zMykubGVuZ3RoKCksXG5cbiAgICAgICAgaW52U3ggPSAxIC8gc3gsXG4gICAgICAgIGludlN5ID0gMSAvIHN5LFxuICAgICAgICBpbnZTeiA9IDEgLyBzejtcblxuICAgIHNjYWxlLnggPSBzeDtcbiAgICBzY2FsZS55ID0gc3k7XG4gICAgc2NhbGUueiA9IHN6O1xuXG4gICAgcG9zaXRpb24ueCA9IHRlWzEyXTtcbiAgICBwb3NpdGlvbi55ID0gdGVbMTNdO1xuICAgIHBvc2l0aW9uLnogPSB0ZVsxNF07XG5cbiAgICBtMTEgKj0gaW52U3g7XG4gICAgbTEyICo9IGludlN5O1xuICAgIG0xMyAqPSBpbnZTejtcbiAgICBtMjEgKj0gaW52U3g7XG4gICAgbTIyICo9IGludlN5O1xuICAgIG0yMyAqPSBpbnZTejtcbiAgICBtMzEgKj0gaW52U3g7XG4gICAgbTMyICo9IGludlN5O1xuICAgIG0zMyAqPSBpbnZTejtcblxuICAgIHRyYWNlID0gbTExICsgbTIyICsgbTMzO1xuXG4gICAgaWYgKHRyYWNlID4gMC4wKSB7XG4gICAgICAgIHMgPSAwLjUgLyBzcXJ0KHRyYWNlICsgMS4wKTtcblxuICAgICAgICB3ID0gMC4yNSAvIHM7XG4gICAgICAgIHggPSAobTMyIC0gbTIzKSAqIHM7XG4gICAgICAgIHkgPSAobTEzIC0gbTMxKSAqIHM7XG4gICAgICAgIHogPSAobTIxIC0gbTEyKSAqIHM7XG4gICAgfSBlbHNlIGlmIChtMTEgPiBtMjIgJiYgbTExID4gbTMzKSB7XG4gICAgICAgIHMgPSAyLjAgKiBzcXJ0KDEuMCArIG0xMSAtIG0yMiAtIG0zMyk7XG5cbiAgICAgICAgdyA9IChtMzIgLSBtMjMpIC8gcztcbiAgICAgICAgeCA9IDAuMjUgKiBzO1xuICAgICAgICB5ID0gKG0xMiArIG0yMSkgLyBzO1xuICAgICAgICB6ID0gKG0xMyArIG0zMSkgLyBzO1xuICAgIH0gZWxzZSBpZiAobTIyID4gbTMzKSB7XG4gICAgICAgIHMgPSAyLjAgKiBzcXJ0KDEuMCArIG0yMiAtIG0xMSAtIG0zMyk7XG5cbiAgICAgICAgdyA9IChtMTMgLSBtMzEpIC8gcztcbiAgICAgICAgeCA9IChtMTIgKyBtMjEpIC8gcztcbiAgICAgICAgeSA9IDAuMjUgKiBzO1xuICAgICAgICB6ID0gKG0yMyArIG0zMikgLyBzO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHMgPSAyLjAgKiBzcXJ0KDEuMCArIG0zMyAtIG0xMSAtIG0yMik7XG5cbiAgICAgICAgdyA9IChtMjEgLSBtMTIpIC8gcztcbiAgICAgICAgeCA9IChtMTMgKyBtMzEpIC8gcztcbiAgICAgICAgeSA9IChtMjMgKyBtMzIpIC8gcztcbiAgICAgICAgeiA9IDAuMjUgKiBzO1xuICAgIH1cblxuICAgIHF1YXRlcm5pb24ueCA9IHg7XG4gICAgcXVhdGVybmlvbi55ID0geTtcbiAgICBxdWF0ZXJuaW9uLncgPSB3O1xuICAgIHF1YXRlcm5pb24ueiA9IHo7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZXRQb3NpdGlvblxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogc2V0cyBwb3NpdGlvbiBvZiBtYXRyaXhcbiAqIEBwYXJhbSBWZWMzIHZcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5zZXRQb3NpdGlvbiA9IGZ1bmN0aW9uICh2KSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgeiA9IHYuejtcblxuICAgIHRlWzEyXSA9IHYueDtcbiAgICB0ZVsxM10gPSB2Lnk7XG4gICAgdGVbMTRdID0geiAhPSB1bmRlZmluZWQgPyB6IDogMC4wO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZXh0cmFjdFBvc2l0aW9uXG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBnZXRzIHBvc2l0aW9uIGZyb20gb3RoZXIgc2F2ZXMgaXQgaW4gdGhpc1xuICogQHBhcmFtIE1hdDQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5leHRyYWN0UG9zaXRpb24gPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBtZSA9IG90aGVyLmVsZW1lbnRzO1xuXG4gICAgdGVbMTJdID0gbWVbMTJdO1xuICAgIHRlWzEzXSA9IG1lWzEzXTtcbiAgICB0ZVsxNF0gPSBtZVsxNF07XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBleHRyYWN0Um90YXRpb25cbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIGdldHMgcm90YXRpb24gZnJvbSBvdGhlciBzYXZlcyBpdCBpbiB0aGlzXG4gKiBAcGFyYW0gTWF0NCBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLmV4dHJhY3RSb3RhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmVjID0gbmV3IFZlYzMoKTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgICAgIG1lID0gb3RoZXIuZWxlbWVudHMsXG5cbiAgICAgICAgICAgIGx4ID0gdmVjLnNldChtZVswXSwgbWVbMV0sIG1lWzJdKS5sZW5ndGhTcSgpLFxuICAgICAgICAgICAgbHkgPSB2ZWMuc2V0KG1lWzRdLCBtZVs1XSwgbWVbNl0pLmxlbmd0aFNxKCksXG4gICAgICAgICAgICBseiA9IHZlYy5zZXQobWVbOF0sIG1lWzldLCBtZVsxMF0pLmxlbmd0aFNxKCksXG5cbiAgICAgICAgICAgIHNjYWxlWCA9IGx4ID4gMC4wID8gMS4wIC8gc3FydChseCkgOiAwLjAsXG4gICAgICAgICAgICBzY2FsZVkgPSBseSA+IDAuMCA/IDEuMCAvIHNxcnQobHkpIDogMC4wLFxuICAgICAgICAgICAgc2NhbGVaID0gbHogPiAwLjAgPyAxLjAgLyBzcXJ0KGx6KSA6IDAuMDtcblxuICAgICAgICB0ZVswXSA9IG1lWzBdICogc2NhbGVYO1xuICAgICAgICB0ZVsxXSA9IG1lWzFdICogc2NhbGVYO1xuICAgICAgICB0ZVsyXSA9IG1lWzJdICogc2NhbGVYO1xuXG4gICAgICAgIHRlWzRdID0gbWVbNF0gKiBzY2FsZVk7XG4gICAgICAgIHRlWzVdID0gbWVbNV0gKiBzY2FsZVk7XG4gICAgICAgIHRlWzZdID0gbWVbNl0gKiBzY2FsZVk7XG5cbiAgICAgICAgdGVbOF0gPSBtZVs4XSAqIHNjYWxlWjtcbiAgICAgICAgdGVbOV0gPSBtZVs5XSAqIHNjYWxlWjtcbiAgICAgICAgdGVbMTBdID0gbWVbMTBdICogc2NhbGVaO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG59KCk7XG5cbi8qKlxuICogQG1ldGhvZCBleHRyYWN0Um90YXRpb25TY2FsZVxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogZ2V0cyByb3RhdGlvbiB3aXRoIHNjYWxlIGZyb20gb3RoZXIgc2F2ZXMgaXQgaW4gdGhpc1xuICogQHBhcmFtIE1hdDQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5leHRyYWN0Um90YXRpb25TY2FsZSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIG1lID0gb3RoZXIuZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IG1lWzBdO1xuICAgIHRlWzFdID0gbWVbMV07XG4gICAgdGVbMl0gPSBtZVsyXTtcblxuICAgIHRlWzRdID0gbWVbNF07XG4gICAgdGVbNV0gPSBtZVs1XTtcbiAgICB0ZVs2XSA9IG1lWzZdO1xuXG4gICAgdGVbOF0gPSBtZVs4XTtcbiAgICB0ZVs5XSA9IG1lWzldO1xuICAgIHRlWzEwXSA9IG1lWzEwXTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRyYW5zbGF0ZVxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogdHJhbnNsYXRlcyBtYXRyaXggYnkgdmVjdG9yXG4gKiBAcGFyYW0gVmVjMyB2XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUudHJhbnNsYXRlID0gZnVuY3Rpb24gKHYpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICB4ID0gdi54LFxuICAgICAgICB5ID0gdi55LFxuICAgICAgICB6ID0gdi56IHx8IDAuMDtcblxuICAgIHRlWzEyXSA9IHRlWzBdICogeCArIHRlWzRdICogeSArIHRlWzhdICogeiArIHRlWzEyXTtcbiAgICB0ZVsxM10gPSB0ZVsxXSAqIHggKyB0ZVs1XSAqIHkgKyB0ZVs5XSAqIHogKyB0ZVsxM107XG4gICAgdGVbMTRdID0gdGVbMl0gKiB4ICsgdGVbNl0gKiB5ICsgdGVbMTBdICogeiArIHRlWzE0XTtcbiAgICB0ZVsxNV0gPSB0ZVszXSAqIHggKyB0ZVs3XSAqIHkgKyB0ZVsxMV0gKiB6ICsgdGVbMTVdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2NhbGVcbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIHNjYWxlcyBtYXRyaXggYnkgdmVjdG9yXG4gKiBAcGFyYW0gVmVjMyB2XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUuc2NhbGUgPSBmdW5jdGlvbiAodikge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIHggPSB2LngsXG4gICAgICAgIHkgPSB2LnksXG4gICAgICAgIHogPSB2Lno7XG5cbiAgICB0ZVswXSAqPSB4O1xuICAgIHRlWzRdICo9IHk7XG4gICAgdGVbOF0gKj0gejtcbiAgICB0ZVsxXSAqPSB4O1xuICAgIHRlWzVdICo9IHk7XG4gICAgdGVbOV0gKj0gejtcbiAgICB0ZVsyXSAqPSB4O1xuICAgIHRlWzZdICo9IHk7XG4gICAgdGVbMTBdICo9IHo7XG4gICAgdGVbM10gKj0geDtcbiAgICB0ZVs3XSAqPSB5O1xuICAgIHRlWzExXSAqPSB6O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgcm90YXRlWFxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogcm90YXRlcyBtYXRyaXggYWxvbmcgeCBheGlzIGJ5IGFuZ2xlXG4gKiBAcGFyYW0gTnVtYmVyIGFuZ2xlXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUucm90YXRlWCA9IGZ1bmN0aW9uIChhbmdsZSkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIG0xMiA9IHRlWzRdLFxuICAgICAgICBtMjIgPSB0ZVs1XSxcbiAgICAgICAgbTMyID0gdGVbNl0sXG4gICAgICAgIG00MiA9IHRlWzddLFxuICAgICAgICBtMTMgPSB0ZVs4XSxcbiAgICAgICAgbTIzID0gdGVbOV0sXG4gICAgICAgIG0zMyA9IHRlWzEwXSxcbiAgICAgICAgbTQzID0gdGVbMTFdLFxuICAgICAgICBjID0gY29zKGFuZ2xlKSxcbiAgICAgICAgcyA9IHNpbihhbmdsZSk7XG5cbiAgICB0ZVs0XSA9IGMgKiBtMTIgKyBzICogbTEzO1xuICAgIHRlWzVdID0gYyAqIG0yMiArIHMgKiBtMjM7XG4gICAgdGVbNl0gPSBjICogbTMyICsgcyAqIG0zMztcbiAgICB0ZVs3XSA9IGMgKiBtNDIgKyBzICogbTQzO1xuXG4gICAgdGVbOF0gPSBjICogbTEzIC0gcyAqIG0xMjtcbiAgICB0ZVs5XSA9IGMgKiBtMjMgLSBzICogbTIyO1xuICAgIHRlWzEwXSA9IGMgKiBtMzMgLSBzICogbTMyO1xuICAgIHRlWzExXSA9IGMgKiBtNDMgLSBzICogbTQyO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgcm90YXRlWVxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogcm90YXRlcyBtYXRyaXggYWxvbmcgeSBheGlzIGJ5IGFuZ2xlXG4gKiBAcGFyYW0gTnVtYmVyIGFuZ2xlXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUucm90YXRlWSA9IGZ1bmN0aW9uIChhbmdsZSkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIG0xMSA9IHRlWzBdLFxuICAgICAgICBtMjEgPSB0ZVsxXSxcbiAgICAgICAgbTMxID0gdGVbMl0sXG4gICAgICAgIG00MSA9IHRlWzNdLFxuICAgICAgICBtMTMgPSB0ZVs4XSxcbiAgICAgICAgbTIzID0gdGVbOV0sXG4gICAgICAgIG0zMyA9IHRlWzEwXSxcbiAgICAgICAgbTQzID0gdGVbMTFdLFxuICAgICAgICBjID0gY29zKGFuZ2xlKSxcbiAgICAgICAgcyA9IHNpbihhbmdsZSk7XG5cbiAgICB0ZVswXSA9IGMgKiBtMTEgLSBzICogbTEzO1xuICAgIHRlWzFdID0gYyAqIG0yMSAtIHMgKiBtMjM7XG4gICAgdGVbMl0gPSBjICogbTMxIC0gcyAqIG0zMztcbiAgICB0ZVszXSA9IGMgKiBtNDEgLSBzICogbTQzO1xuXG4gICAgdGVbOF0gPSBjICogbTEzICsgcyAqIG0xMTtcbiAgICB0ZVs5XSA9IGMgKiBtMjMgKyBzICogbTIxO1xuICAgIHRlWzEwXSA9IGMgKiBtMzMgKyBzICogbTMxO1xuICAgIHRlWzExXSA9IGMgKiBtNDMgKyBzICogbTQxO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgcm90YXRlWlxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogcm90YXRlcyBtYXRyaXggYWxvbmcgeiBheGlzIGJ5IGFuZ2xlXG4gKiBAcGFyYW0gTnVtYmVyIGFuZ2xlXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUucm90YXRlWiA9IGZ1bmN0aW9uIChhbmdsZSkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIG0xMSA9IHRlWzBdLFxuICAgICAgICBtMjEgPSB0ZVsxXSxcbiAgICAgICAgbTMxID0gdGVbMl0sXG4gICAgICAgIG00MSA9IHRlWzNdLFxuICAgICAgICBtMTIgPSB0ZVs0XSxcbiAgICAgICAgbTIyID0gdGVbNV0sXG4gICAgICAgIG0zMiA9IHRlWzZdLFxuICAgICAgICBtNDIgPSB0ZVs3XSxcbiAgICAgICAgYyA9IGNvcyhhbmdsZSksXG4gICAgICAgIHMgPSBzaW4oYW5nbGUpO1xuXG4gICAgdGVbMF0gPSBjICogbTExICsgcyAqIG0xMjtcbiAgICB0ZVsxXSA9IGMgKiBtMjEgKyBzICogbTIyO1xuICAgIHRlWzJdID0gYyAqIG0zMSArIHMgKiBtMzI7XG4gICAgdGVbM10gPSBjICogbTQxICsgcyAqIG00MjtcblxuICAgIHRlWzRdID0gYyAqIG0xMiAtIHMgKiBtMTE7XG4gICAgdGVbNV0gPSBjICogbTIyIC0gcyAqIG0yMTtcbiAgICB0ZVs2XSA9IGMgKiBtMzIgLSBzICogbTMxO1xuICAgIHRlWzddID0gYyAqIG00MiAtIHMgKiBtNDE7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtYWtlVHJhbnNsYXRpb25cbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIG1ha2VzIHRoaXMgYSB0cmFuc2xhdGlvbiBtYXRyaXhcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHBhcmFtIE51bWJlciB5XG4gKiBAcGFyYW0gTnVtYmVyIHpcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5tYWtlVHJhbnNsYXRpb24gPSBmdW5jdGlvbiAoeCwgeSwgeikge1xuXG4gICAgcmV0dXJuIHRoaXMuc2V0KFxuICAgICAgICAxLCAwLjAsIDAuMCwgeCxcbiAgICAgICAgMC4wLCAxLCAwLjAsIHksXG4gICAgICAgIDAuMCwgMC4wLCAxLCB6LFxuICAgICAgICAwLjAsIDAuMCwgMC4wLCAxXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtYWtlU2NhbGVcbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIG1ha2VzIHRoaXMgYSBzY2FsZSBtYXRyaXhcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHBhcmFtIE51bWJlciB5XG4gKiBAcGFyYW0gTnVtYmVyIHpcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5tYWtlU2NhbGUgPSBmdW5jdGlvbiAoeCwgeSwgeikge1xuXG4gICAgcmV0dXJuIHRoaXMuc2V0KFxuICAgICAgICB4LCAwLjAsIDAuMCwgMC4wLFxuICAgICAgICAwLjAsIHksIDAuMCwgMC4wLFxuICAgICAgICAwLjAsIDAuMCwgeiwgMC4wLFxuICAgICAgICAwLjAsIDAuMCwgMC4wLCAxXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtYWtlUm90YXRpb25YXG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBtYWtlcyB0aGlzIGEgcm90YXRpb24gbWF0cml4IGFsb25nIHggYXhpc1xuICogQHBhcmFtIE51bWJlciBhbmdsZVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLm1ha2VSb3RhdGlvblggPSBmdW5jdGlvbiAoYW5nbGUpIHtcbiAgICB2YXIgYyA9IGNvcyhhbmdsZSksXG4gICAgICAgIHMgPSBzaW4oYW5nbGUpO1xuXG4gICAgcmV0dXJuIHRoaXMuc2V0KFxuICAgICAgICAxLCAwLjAsIDAuMCwgMC4wLFxuICAgICAgICAwLjAsIGMsIC1zLCAwLjAsXG4gICAgICAgIDAuMCwgcywgYywgMC4wLFxuICAgICAgICAwLjAsIDAuMCwgMC4wLCAxXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtYWtlUm90YXRpb25ZXG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBtYWtlcyB0aGlzIGEgcm90YXRpb24gbWF0cml4IGFsb25nIHkgYXhpc1xuICogQHBhcmFtIE51bWJlciBhbmdsZVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLm1ha2VSb3RhdGlvblkgPSBmdW5jdGlvbiAoYW5nbGUpIHtcbiAgICB2YXIgYyA9IGNvcyhhbmdsZSksXG4gICAgICAgIHMgPSBzaW4oYW5nbGUpO1xuXG4gICAgcmV0dXJuIHRoaXMuc2V0KFxuICAgICAgICBjLCAwLjAsIHMsIDAuMCxcbiAgICAgICAgMC4wLCAxLCAwLjAsIDAuMCwgLXMsIDAuMCwgYywgMC4wLFxuICAgICAgICAwLjAsIDAuMCwgMC4wLCAxXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtYWtlUm90YXRpb25aXG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBtYWtlcyB0aGlzIGEgcm90YXRpb24gbWF0cml4IGFsb25nIHogYXhpc1xuICogQHBhcmFtIE51bWJlciBhbmdsZVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLm1ha2VSb3RhdGlvblogPSBmdW5jdGlvbiAoYW5nbGUpIHtcbiAgICB2YXIgYyA9IGNvcyhhbmdsZSksXG4gICAgICAgIHMgPSBzaW4oYW5nbGUpO1xuXG4gICAgcmV0dXJuIHRoaXMuc2V0KFxuICAgICAgICBjLCAtcywgMC4wLCAwLjAsXG4gICAgICAgIHMsIGMsIDAuMCwgMC4wLFxuICAgICAgICAwLjAsIDAuMCwgMSwgMC4wLFxuICAgICAgICAwLjAsIDAuMCwgMC4wLCAxXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcnVzdHVtXG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBtYWtlcyBmcnVzdHVtIG1hdHJpeFxuICogQHBhcmFtIE51bWJlciBsZWZ0XG4gKiBAcGFyYW0gTnVtYmVyIHJpZ2h0XG4gKiBAcGFyYW0gTnVtYmVyIGJvdHRvbVxuICogQHBhcmFtIE51bWJlciB0b3BcbiAqIEBwYXJhbSBOdW1iZXIgbmVhclxuICogQHBhcmFtIE51bWJlciBmYXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5mcnVzdHVtID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0LCB0b3AsIGJvdHRvbSwgbmVhciwgZmFyKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgeCA9IDIgKiBuZWFyIC8gKHJpZ2h0IC0gbGVmdCksXG4gICAgICAgIHkgPSAyICogbmVhciAvICh0b3AgLSBib3R0b20pLFxuXG4gICAgICAgIGEgPSAocmlnaHQgKyBsZWZ0KSAvIChyaWdodCAtIGxlZnQpLFxuICAgICAgICBiID0gKHRvcCArIGJvdHRvbSkgLyAodG9wIC0gYm90dG9tKSxcbiAgICAgICAgYyA9IC0oZmFyICsgbmVhcikgLyAoZmFyIC0gbmVhciksXG4gICAgICAgIGQgPSAtMiAqIGZhciAqIG5lYXIgLyAoZmFyIC0gbmVhcik7XG5cbiAgICB0ZVswXSA9IHg7XG4gICAgdGVbNF0gPSAwLjA7XG4gICAgdGVbOF0gPSBhO1xuICAgIHRlWzEyXSA9IDAuMDtcbiAgICB0ZVsxXSA9IDAuMDtcbiAgICB0ZVs1XSA9IHk7XG4gICAgdGVbOV0gPSBiO1xuICAgIHRlWzEzXSA9IDAuMDtcbiAgICB0ZVsyXSA9IDAuMDtcbiAgICB0ZVs2XSA9IDAuMDtcbiAgICB0ZVsxMF0gPSBjO1xuICAgIHRlWzE0XSA9IGQ7XG4gICAgdGVbM10gPSAwLjA7XG4gICAgdGVbN10gPSAwLjA7XG4gICAgdGVbMTFdID0gLTE7XG4gICAgdGVbMTVdID0gMC4wO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgcGVyc3BlY3RpdmVcbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIG1ha2VzIHBlcnNwZWN0aXZlIG1hdHJpeFxuICogQHBhcmFtIE51bWJlciBmb3ZcbiAqIEBwYXJhbSBOdW1iZXIgYXNwZWN0XG4gKiBAcGFyYW0gTnVtYmVyIG5lYXJcbiAqIEBwYXJhbSBOdW1iZXIgZmFyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUucGVyc3BlY3RpdmUgPSBmdW5jdGlvbiAoZm92LCBhc3BlY3QsIG5lYXIsIGZhcikge1xuICAgIHZhciB5bWF4ID0gbmVhciAqIHRhbihmb3YgKiAwLjUpLFxuICAgICAgICB5bWluID0gLXltYXgsXG4gICAgICAgIHhtaW4gPSB5bWluICogYXNwZWN0LFxuICAgICAgICB4bWF4ID0geW1heCAqIGFzcGVjdDtcblxuICAgIHJldHVybiB0aGlzLmZydXN0dW0oeG1pbiwgeG1heCwgeW1heCwgeW1pbiwgbmVhciwgZmFyKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBvcnRob2dyYXBoaWNcbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIG1ha2VzIG9ydGhvZ3JhcGhpYyBtYXRyaXhcbiAqIEBwYXJhbSBOdW1iZXIgbGVmdFxuICogQHBhcmFtIE51bWJlciByaWdodFxuICogQHBhcmFtIE51bWJlciBib3R0b21cbiAqIEBwYXJhbSBOdW1iZXIgdG9wXG4gKiBAcGFyYW0gTnVtYmVyIG5lYXJcbiAqIEBwYXJhbSBOdW1iZXIgZmFyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUub3J0aG9ncmFwaGljID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0LCB0b3AsIGJvdHRvbSwgbmVhciwgZmFyKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgdyA9IHJpZ2h0IC0gbGVmdCxcbiAgICAgICAgaCA9IHRvcCAtIGJvdHRvbSxcbiAgICAgICAgcCA9IGZhciAtIG5lYXIsXG5cbiAgICAgICAgeCA9IChyaWdodCArIGxlZnQpIC8gdyxcbiAgICAgICAgeSA9ICh0b3AgKyBib3R0b20pIC8gaCxcbiAgICAgICAgeiA9IChmYXIgKyBuZWFyKSAvIHA7XG5cbiAgICB0ZVswXSA9IDIgLyB3O1xuICAgIHRlWzFdID0gMC4wO1xuICAgIHRlWzJdID0gMC4wO1xuICAgIHRlWzNdID0gMC4wO1xuICAgIHRlWzRdID0gMC4wO1xuICAgIHRlWzVdID0gMiAvIGg7XG4gICAgdGVbNl0gPSAwLjA7XG4gICAgdGVbN10gPSAwLjBcbiAgICB0ZVs4XSA9IDAuMDtcbiAgICB0ZVs5XSA9IDAuMDtcbiAgICB0ZVsxMF0gPSAtMiAvIHA7XG4gICAgdGVbMTFdID0gMC4wO1xuICAgIHRlWzEyXSA9IC14O1xuICAgIHRlWzEzXSA9IC15O1xuICAgIHRlWzE0XSA9IC16O1xuICAgIHRlWzE1XSA9IDE7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tTWF0MlxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogc2V0cyB0aGlzIGZyb20gTWF0MlxuICogQHBhcmFtIE1hdDIgbVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLmZyb21NYXQyID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBtZSA9IG0uZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IG1lWzBdO1xuICAgIHRlWzFdID0gbWVbMV07XG4gICAgdGVbMl0gPSAwLjA7XG4gICAgdGVbM10gPSAwLjA7XG4gICAgdGVbNF0gPSBtZVsyXTtcbiAgICB0ZVs1XSA9IG1lWzNdO1xuICAgIHRlWzZdID0gMC4wO1xuICAgIHRlWzddID0gMC4wO1xuICAgIHRlWzhdID0gMC4wO1xuICAgIHRlWzldID0gMC4wO1xuICAgIHRlWzEwXSA9IDE7XG4gICAgdGVbMTFdID0gMC4wO1xuICAgIHRlWzEyXSA9IDAuMDtcbiAgICB0ZVsxM10gPSAwLjA7XG4gICAgdGVbMTRdID0gMC4wO1xuICAgIHRlWzE1XSA9IDE7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tTWF0MzJcbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIHNldHMgdGhpcyBmcm9tIE1hdDMyXG4gKiBAcGFyYW0gTWF0MzIgbVxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLmZyb21NYXQzMiA9IGZ1bmN0aW9uIChtKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgbWUgPSBtLmVsZW1lbnRzO1xuXG4gICAgdGVbMF0gPSBtZVswXTtcbiAgICB0ZVsxXSA9IG1lWzFdO1xuICAgIHRlWzJdID0gMC4wO1xuICAgIHRlWzNdID0gMC4wO1xuICAgIHRlWzRdID0gbWVbMl07XG4gICAgdGVbNV0gPSBtZVszXTtcbiAgICB0ZVs2XSA9IDAuMDtcbiAgICB0ZVs3XSA9IDAuMDtcbiAgICB0ZVs4XSA9IDAuMDtcbiAgICB0ZVs5XSA9IDAuMDtcbiAgICB0ZVsxMF0gPSAxO1xuICAgIHRlWzExXSA9IDAuMDtcbiAgICB0ZVsxMl0gPSBtZVs0XTtcbiAgICB0ZVsxM10gPSBtZVs1XTtcbiAgICB0ZVsxNF0gPSAwLjA7XG4gICAgdGVbMTVdID0gMTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21NYXQzXG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBzZXRzIHRoaXMgZnJvbSBNYXQzXG4gKiBAcGFyYW0gTWF0MyBtXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUuZnJvbU1hdDMgPSBmdW5jdGlvbiAobSkge1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIG1lID0gbS5lbGVtZW50cztcblxuICAgIHRlWzBdID0gbWVbMF07XG4gICAgdGVbMV0gPSBtZVsxXTtcbiAgICB0ZVsyXSA9IG1lWzJdO1xuICAgIHRlWzNdID0gMC4wO1xuICAgIHRlWzRdID0gbWVbM107XG4gICAgdGVbNV0gPSBtZVs0XTtcbiAgICB0ZVs2XSA9IG1lWzVdO1xuICAgIHRlWzddID0gMC4wO1xuICAgIHRlWzhdID0gbWVbNl07XG4gICAgdGVbOV0gPSBtZVs3XTtcbiAgICB0ZVsxMF0gPSBtZVs4XTtcbiAgICB0ZVsxMV0gPSAwLjA7XG4gICAgdGVbMTJdID0gMC4wO1xuICAgIHRlWzEzXSA9IDAuMDtcbiAgICB0ZVsxNF0gPSAwLjA7XG4gICAgdGVbMTVdID0gMTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21RdWF0XG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBzZXRzIHJvdGF0aW9uIG9mIHRoaXMgZnJvbSBxdWF0ZXJpYW5cbiAqIEBwYXJhbSBRdWF0IHFcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5mcm9tUXVhdCA9IGZ1bmN0aW9uIChxKSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cyxcbiAgICAgICAgeCA9IHEueCxcbiAgICAgICAgeSA9IHEueSxcbiAgICAgICAgeiA9IHEueixcbiAgICAgICAgdyA9IHEudyxcbiAgICAgICAgeDIgPSB4ICsgeCxcbiAgICAgICAgeTIgPSB5ICsgeSxcbiAgICAgICAgejIgPSB6ICsgeixcbiAgICAgICAgeHggPSB4ICogeDIsXG4gICAgICAgIHh5ID0geCAqIHkyLFxuICAgICAgICB4eiA9IHggKiB6MixcbiAgICAgICAgeXkgPSB5ICogeTIsXG4gICAgICAgIHl6ID0geSAqIHoyLFxuICAgICAgICB6eiA9IHogKiB6MixcbiAgICAgICAgd3ggPSB3ICogeDIsXG4gICAgICAgIHd5ID0gdyAqIHkyLFxuICAgICAgICB3eiA9IHcgKiB6MjtcblxuICAgIHRlWzBdID0gMSAtICh5eSArIHp6KTtcbiAgICB0ZVs0XSA9IHh5IC0gd3o7XG4gICAgdGVbOF0gPSB4eiArIHd5O1xuXG4gICAgdGVbMV0gPSB4eSArIHd6O1xuICAgIHRlWzVdID0gMSAtICh4eCArIHp6KTtcbiAgICB0ZVs5XSA9IHl6IC0gd3g7XG5cbiAgICB0ZVsyXSA9IHh6IC0gd3k7XG4gICAgdGVbNl0gPSB5eiArIHd4O1xuICAgIHRlWzEwXSA9IDEgLSAoeHggKyB5eSk7XG5cbiAgICB0ZVszXSA9IDAuMDtcbiAgICB0ZVs3XSA9IDAuMDtcbiAgICB0ZVsxMV0gPSAwLjA7XG5cbiAgICB0ZVsxMl0gPSAwLjA7XG4gICAgdGVbMTNdID0gMC4wO1xuICAgIHRlWzE0XSA9IDAuMDtcbiAgICB0ZVsxNV0gPSAxO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIEBwYXJhbSBYaWFuLk1hdDQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5NYXQ0LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYWUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBiZSA9IG90aGVyLmVsZW1lbnRzO1xuXG4gICAgcmV0dXJuICEoXG4gICAgYWVbMF0gIT09IGJlWzBdIHx8XG4gICAgYWVbMV0gIT09IGJlWzFdIHx8XG4gICAgYWVbMl0gIT09IGJlWzJdIHx8XG4gICAgYWVbM10gIT09IGJlWzNdIHx8XG4gICAgYWVbNF0gIT09IGJlWzRdIHx8XG4gICAgYWVbNV0gIT09IGJlWzVdIHx8XG4gICAgYWVbNl0gIT09IGJlWzZdIHx8XG4gICAgYWVbN10gIT09IGJlWzddIHx8XG4gICAgYWVbOF0gIT09IGJlWzhdIHx8XG4gICAgYWVbOV0gIT09IGJlWzldIHx8XG4gICAgYWVbMTBdICE9PSBiZVsxMF0gfHxcbiAgICBhZVsxMV0gIT09IGJlWzExXSB8fFxuICAgIGFlWzEyXSAhPT0gYmVbMTJdIHx8XG4gICAgYWVbMTNdICE9PSBiZVsxM10gfHxcbiAgICBhZVsxNF0gIT09IGJlWzE0XSB8fFxuICAgIGFlWzE1XSAhPT0gYmVbMTVdXG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1lbWJlcm9mIFhpYW4uTWF0NFxuICogQHBhcmFtIFhpYW4uTWF0NCBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLm5vdEVxdWFscyA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciBhZSA9IHRoaXMuZWxlbWVudHMsXG4gICAgICAgIGJlID0gb3RoZXIuZWxlbWVudHM7XG5cbiAgICByZXR1cm4gKFxuICAgIGFlWzBdICE9PSBiZVswXSB8fFxuICAgIGFlWzFdICE9PSBiZVsxXSB8fFxuICAgIGFlWzJdICE9PSBiZVsyXSB8fFxuICAgIGFlWzNdICE9PSBiZVszXSB8fFxuICAgIGFlWzRdICE9PSBiZVs0XSB8fFxuICAgIGFlWzVdICE9PSBiZVs1XSB8fFxuICAgIGFlWzZdICE9PSBiZVs2XSB8fFxuICAgIGFlWzddICE9PSBiZVs3XSB8fFxuICAgIGFlWzhdICE9PSBiZVs4XSB8fFxuICAgIGFlWzldICE9PSBiZVs5XSB8fFxuICAgIGFlWzEwXSAhPT0gYmVbMTBdIHx8XG4gICAgYWVbMTFdICE9PSBiZVsxMV0gfHxcbiAgICBhZVsxMl0gIT09IGJlWzEyXSB8fFxuICAgIGFlWzEzXSAhPT0gYmVbMTNdIHx8XG4gICAgYWVbMTRdICE9PSBiZVsxNF0gfHxcbiAgICBhZVsxNV0gIT09IGJlWzE1XVxuICAgICk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbUpTT05cbiAqIEBtZW1iZXJvZiBYaWFuLk1hdDRcbiAqIHNldHMgdmFsdWVzIGZyb20gSlNPTiBvYmplY3RcbiAqIEBwYXJhbSBPYmplY3QganNvblxuICogQHJldHVybiB0aGlzXG4gKi9cbk1hdDQucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBtZSA9IGpzb24uZWxlbWVudHM7XG5cbiAgICB0ZVswXSA9IG1lWzBdO1xuICAgIHRlWzFdID0gbWVbMV07XG4gICAgdGVbMl0gPSBtZVsyXTtcbiAgICB0ZVszXSA9IG1lWzNdO1xuICAgIHRlWzRdID0gbWVbNF07XG4gICAgdGVbNV0gPSBtZVs1XTtcbiAgICB0ZVs2XSA9IG1lWzZdO1xuICAgIHRlWzddID0gbWVbN107XG4gICAgdGVbOF0gPSBtZVs4XTtcbiAgICB0ZVs5XSA9IG1lWzldO1xuICAgIHRlWzEwXSA9IG1lWzEwXTtcbiAgICB0ZVsxMV0gPSBtZVsxMV07XG4gICAgdGVbMTJdID0gbWVbMTJdO1xuICAgIHRlWzEzXSA9IG1lWzEzXTtcbiAgICB0ZVsxNF0gPSBtZVsxNF07XG4gICAgdGVbMTVdID0gbWVbMTVdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdG9KU09OXG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiByZXR1cm5zIGpzb24gb2JqZWN0IG9mIHRoaXNcbiAqIEByZXR1cm4gT2JqZWN0XG4gKi9cbk1hdDQucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiB8fCAoanNvbiA9IHt9KTtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLFxuICAgICAgICBqZSA9IGpzb24uZWxlbWVudHMgfHwgKGpzb24uZWxlbWVudHMgPSBbXSk7XG5cbiAgICBqc29uLl9jbGFzc05hbWUgPSBcIk1hdDRcIjtcbiAgICBqZVswXSA9IHRlWzBdO1xuICAgIGplWzFdID0gdGVbMV07XG4gICAgamVbMl0gPSB0ZVsyXTtcbiAgICBqZVszXSA9IHRlWzNdO1xuICAgIGplWzRdID0gdGVbNF07XG4gICAgamVbNV0gPSB0ZVs1XTtcbiAgICBqZVs2XSA9IHRlWzZdO1xuICAgIGplWzddID0gdGVbN107XG4gICAgamVbOF0gPSB0ZVs4XTtcbiAgICBqZVs5XSA9IHRlWzldO1xuICAgIGplWzEwXSA9IHRlWzEwXTtcbiAgICBqZVsxMV0gPSB0ZVsxMV07XG4gICAgamVbMTJdID0gdGVbMTJdO1xuICAgIGplWzEzXSA9IHRlWzEzXTtcbiAgICBqZVsxNF0gPSB0ZVsxNF07XG4gICAgamVbMTVdID0gdGVbMTVdO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbUFycmF5XG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiBzZXRzIHZhbHVlcyBmcm9tIEFycmF5IG9iamVjdFxuICogQHBhcmFtIE9iamVjdCBqc29uXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuTWF0NC5wcm90b3R5cGUuZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcblxuICAgIHRlWzBdID0gYXJyYXlbMF07XG4gICAgdGVbMV0gPSBhcnJheVsxXTtcbiAgICB0ZVsyXSA9IGFycmF5WzJdO1xuICAgIHRlWzNdID0gYXJyYXlbM107XG4gICAgdGVbNF0gPSBhcnJheVs0XTtcbiAgICB0ZVs1XSA9IGFycmF5WzVdO1xuICAgIHRlWzZdID0gYXJyYXlbNl07XG4gICAgdGVbN10gPSBhcnJheVs3XTtcbiAgICB0ZVs4XSA9IGFycmF5WzhdO1xuICAgIHRlWzldID0gYXJyYXlbOV07XG4gICAgdGVbMTBdID0gYXJyYXlbMTBdO1xuICAgIHRlWzExXSA9IGFycmF5WzExXTtcbiAgICB0ZVsxMl0gPSBhcnJheVsxMl07XG4gICAgdGVbMTNdID0gYXJyYXlbMTNdO1xuICAgIHRlWzE0XSA9IGFycmF5WzE0XTtcbiAgICB0ZVsxNV0gPSBhcnJheVsxNV07XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b0FycmF5XG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiByZXR1cm5zIGFycmF5IG9iamVjdCBvZiB0aGlzXG4gKiBAcmV0dXJuIE9iamVjdFxuICovXG5NYXQ0LnByb3RvdHlwZS50b0FycmF5ID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgYXJyYXkgfHwgKGFycmF5ID0gW10pO1xuICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICBhcnJheVswXSA9IHRlWzBdO1xuICAgIGFycmF5WzFdID0gdGVbMV07XG4gICAgYXJyYXlbMl0gPSB0ZVsyXTtcbiAgICBhcnJheVszXSA9IHRlWzNdO1xuICAgIGFycmF5WzRdID0gdGVbNF07XG4gICAgYXJyYXlbNV0gPSB0ZVs1XTtcbiAgICBhcnJheVs2XSA9IHRlWzZdO1xuICAgIGFycmF5WzddID0gdGVbN107XG4gICAgYXJyYXlbOF0gPSB0ZVs4XTtcbiAgICBhcnJheVs5XSA9IHRlWzldO1xuICAgIGFycmF5WzEwXSA9IHRlWzEwXTtcbiAgICBhcnJheVsxMV0gPSB0ZVsxMV07XG4gICAgYXJyYXlbMTJdID0gdGVbMTJdO1xuICAgIGFycmF5WzEzXSA9IHRlWzEzXTtcbiAgICBhcnJheVsxNF0gPSB0ZVsxNF07XG4gICAgYXJyYXlbMTVdID0gdGVbMTVdO1xuXG4gICAgcmV0dXJuIGFycmF5O1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRvU3RyaW5nXG4gKiBAbWVtYmVyb2YgWGlhbi5NYXQ0XG4gKiByZXR1cm5zIHN0cmluZyBvZiB0aGlzXG4gKiBAcmV0dXJuIFN0cmluZ1xuICovXG5NYXQ0LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgcmV0dXJuIChcbiAgICBcIk1hdDRbXCIgKyB0ZVswXSArIFwiLCBcIiArIHRlWzRdICsgXCIsIFwiICsgdGVbOF0gKyBcIiwgXCIgKyB0ZVsxMl0gKyBcIl1cXG5cIiArXG4gICAgXCIgICAgIFtcIiArIHRlWzFdICsgXCIsIFwiICsgdGVbNV0gKyBcIiwgXCIgKyB0ZVs5XSArIFwiLCBcIiArIHRlWzEzXSArIFwiXVxcblwiICtcbiAgICBcIiAgICAgW1wiICsgdGVbMl0gKyBcIiwgXCIgKyB0ZVs2XSArIFwiLCBcIiArIHRlWzEwXSArIFwiLCBcIiArIHRlWzE0XSArIFwiXVxcblwiICtcbiAgICBcIiAgICAgW1wiICsgdGVbM10gKyBcIiwgXCIgKyB0ZVs3XSArIFwiLCBcIiArIHRlWzExXSArIFwiLCBcIiArIHRlWzE1XSArIFwiXVwiXG4gICAgKTtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBNYXQ0O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIHJhbmRvbSA9IE1hdGgucmFuZG9tLFxuICAgIGFicyA9IE1hdGguYWJzLFxuICAgIGNvcyA9IE1hdGguY29zLFxuICAgIHBvdyA9IE1hdGgucG93LFxuICAgIGZsb29yID0gTWF0aC5mbG9vcixcbiAgICBjZWlsID0gTWF0aC5jZWlsLFxuICAgIGF0YW4yID0gTWF0aC5hdGFuMixcbiAgICBFUFNJTE9OID0gMC4wMDAwMDEsXG4gICAgUEkgPSAzLjE0MTU5MjY1MzU4OTc5MzIzODQ2MjY0MzM4MzI3OTUwMjg4NDE5NjgsXG4gICAgVFdPX1BJID0gUEkgKiAyLFxuICAgIEhBTEZfUEkgPSBQSSAqIDAuNSxcbiAgICBUT19SQURTID0gUEkgLyAxODAuMCxcbiAgICBUT19ERUdTID0gMTgwLjAgLyBQSSxcbiAgICBrZXlzID0gT2JqZWN0LmtleXMsXG4gICAgbW9kdWxvLCBjbGFtcDAxLCBzdGFuZGFyZFJhZGlhbiwgc3RhbmRhcmRBbmdsZSwgcmFkc1RvRGVncztcblxuXG4vKipcbiAqIEBjbGFzcyBNYXRoZlxuICogY29sbGVjdGlvbiBvZiBjb21tb24gbWF0aCBmdW5jdGlvbnNcbiAqL1xuZnVuY3Rpb24gTWF0aGYoKSB7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIFBJXG4gICAgICogVGhlIGluZmFtb3VzIDMuMTQxNTkyNjUzNTg5NzkzMjM4NDYyNjQzMzgzMjc5NTAuMDI4ODQxOTY4XG4gICAgICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAgICAgKi9cbiAgICB0aGlzLlBJID0gUEk7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIFRXT19QSVxuICAgICAqIDIgKiBQSVxuICAgICAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gICAgICovXG4gICAgdGhpcy5UV09fUEkgPSBUV09fUEk7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIEhBTEZfUElcbiAgICAgKiBQSSAvIDJcbiAgICAgKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICAgICAqL1xuICAgIHRoaXMuSEFMRl9QSSA9IEhBTEZfUEk7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIEVQU0lMT05cbiAgICAgKiBBIHNtYWxsIG51bWJlciB2YWx1ZVxuICAgICAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gICAgICovXG4gICAgdGhpcy5FUFNJTE9OID0gRVBTSUxPTjtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBOdW1iZXIgVE9fUkFEU1xuICAgICAqIERlZ3JlZXMgdG8gcmFkaWFucyBjb252ZXJzaW9uIGNvbnN0YW50XG4gICAgICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAgICAgKi9cbiAgICB0aGlzLlRPX1JBRFMgPSBUT19SQURTO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciBUT19ERUdTXG4gICAgICogUmFkaWFucyB0byBkZWdyZWVzIGNvbnZlcnNpb24gY29uc3RhbnRcbiAgICAgKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICAgICAqL1xuICAgIHRoaXMuVE9fREVHUyA9IFRPX0RFR1M7XG59XG5cbk1hdGhmLnByb3RvdHlwZS5fY2xhc3NlcyA9IHt9O1xuXG5NYXRoZi5wcm90b3R5cGUuYWNvcyA9IE1hdGguYWNvcztcbk1hdGhmLnByb3RvdHlwZS5hc2luID0gTWF0aC5hc2luO1xuTWF0aGYucHJvdG90eXBlLmF0YW4gPSBNYXRoLmF0YW47XG5NYXRoZi5wcm90b3R5cGUuYXRhbjIgPSBNYXRoLmF0YW4yO1xuXG5NYXRoZi5wcm90b3R5cGUuY29zID0gTWF0aC5jb3M7XG5NYXRoZi5wcm90b3R5cGUuc2luID0gTWF0aC5zaW47XG5NYXRoZi5wcm90b3R5cGUudGFuID0gTWF0aC50YW47XG5cbk1hdGhmLnByb3RvdHlwZS5hYnMgPSBNYXRoLmFicztcbk1hdGhmLnByb3RvdHlwZS5jZWlsID0gTWF0aC5jZWlsO1xuTWF0aGYucHJvdG90eXBlLmV4cCA9IE1hdGguZXhwO1xuTWF0aGYucHJvdG90eXBlLmZsb29yID0gTWF0aC5mbG9vcjtcbk1hdGhmLnByb3RvdHlwZS5sb2cgPSBNYXRoLmxvZztcbk1hdGhmLnByb3RvdHlwZS5tYXggPSBNYXRoLm1heDtcbk1hdGhmLnByb3RvdHlwZS5taW4gPSBNYXRoLm1pbjtcbk1hdGhmLnByb3RvdHlwZS5wb3cgPSBNYXRoLnBvdztcbk1hdGhmLnByb3RvdHlwZS5yYW5kb20gPSBNYXRoLnJhbmRvbTtcbk1hdGhmLnByb3RvdHlwZS5yb3VuZCA9IE1hdGgucm91bmQ7XG5NYXRoZi5wcm90b3R5cGUuc3FydCA9IE1hdGguc3FydDtcblxuLyoqXG4gKiBAbWV0aG9kIGVxdWFsc1xuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIHJldHVybnMgaWYgYSA9IGIgd2l0aGluIHNvbWUgdmFsdWUsIGRlZmF1bHRzIHRvIE1hdGhmLkVQU0lMT05cbiAqIEBwYXJhbSBOdW1iZXIgYVxuICogQHBhcmFtIE51bWJlciBiXG4gKiBAcGFyYW0gTnVtYmVyIGVcbiAqIEByZXR1cm4gQm9vbGVhblxuICovXG5NYXRoZi5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKGEsIGIsIGUpIHtcblxuICAgIHJldHVybiBhYnMoYSAtIGIpIDwgKGUgfHwgRVBTSUxPTik7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbW9kdWxvXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICogcmV0dXJucyByZW1haW5kZXIgb2YgYSAvIGJcbiAqIEBwYXJhbSBOdW1iZXIgYVxuICogQHBhcmFtIE51bWJlciBiXG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5NYXRoZi5wcm90b3R5cGUubW9kdWxvID0gbW9kdWxvID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICB2YXIgciA9IGEgJSBiO1xuXG4gICAgcmV0dXJuIChyICogYiA8IDAuMCkgPyByICsgYiA6IHI7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc3RhbmRhcmRSYWRpYW5cbiAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gKiBjb252ZXJ0ZXMgeCB0byByYWRpYW4gd2hlcmUgMC4wIDw9IHggPCAyUElcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuTWF0aGYucHJvdG90eXBlLnN0YW5kYXJkUmFkaWFuID0gc3RhbmRhcmRSYWRpYW4gPSBmdW5jdGlvbiAoeCkge1xuXG4gICAgcmV0dXJuIG1vZHVsbyh4LCBUV09fUEkpO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHN0YW5kYXJkQW5nbGVcbiAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gKiBjb252ZXJ0ZXMgeCB0byBhbmdsZSB3aGVyZSAwLjAgPD0geCA8IDM2MC4wXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5zdGFuZGFyZEFuZ2xlID0gc3RhbmRhcmRBbmdsZSA9IGZ1bmN0aW9uICh4KSB7XG5cbiAgICByZXR1cm4gbW9kdWxvKHgsIDM2MC4wKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzaWduXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICogZ2V0cyBzaWduIG9mIHhcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuTWF0aGYucHJvdG90eXBlLnNpZ24gPSBmdW5jdGlvbiAoeCkge1xuXG4gICAgcmV0dXJuIHggPCAwID8gLTEgOiAxO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNsYW1wXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICogY2xhbXAgeCBiZXR3ZWVuIG1pbiBhbmQgbWF4XG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEBwYXJhbSBOdW1iZXIgbWluXG4gKiBAcGFyYW0gTnVtYmVyIG1heFxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuTWF0aGYucHJvdG90eXBlLmNsYW1wID0gZnVuY3Rpb24gKHgsIG1pbiwgbWF4KSB7XG5cbiAgICByZXR1cm4geCA8IG1pbiA/IG1pbiA6IHggPiBtYXggPyBtYXggOiB4O1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNsYW1wQm90dG9tXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICogY2xhbXAgeCBiZXR3ZWVuIG1pbiBhbmQgSW5maW5pdHlcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHBhcmFtIE51bWJlciBtaW5cbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5jbGFtcEJvdHRvbSA9IGZ1bmN0aW9uICh4LCBtaW4pIHtcblxuICAgIHJldHVybiB4IDwgbWluID8gbWluIDogeDtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjbGFtcFRvcFxuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIGNsYW1wIHggYmV0d2VlbiAtSW5maW5pdHkgYW5kIG1heFxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcGFyYW0gTnVtYmVyIG1heFxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuTWF0aGYucHJvdG90eXBlLmNsYW1wVG9wID0gZnVuY3Rpb24gKHgsIG1heCkge1xuXG4gICAgcmV0dXJuIHggPiBtYXggPyBtYXggOiB4O1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNsYW1wMDFcbiAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gKiBjbGFtcCB4IGJldHdlZW4gMC4wIGFuZCAxXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5jbGFtcDAxID0gY2xhbXAwMSA9IGZ1bmN0aW9uICh4KSB7XG5cbiAgICByZXR1cm4geCA8IDAuMCA/IDAuMCA6IHggPiAxID8gMSA6IHg7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdHJ1bmNhdGVcbiAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gKiB0cnVuY2F0ZSB4IHRvIGhhdmUgbiBudW1iZXIgb2YgZGVjaWFsIHBsYWNlc1xuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcGFyYW0gTnVtYmVyIG5cbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS50cnVuY2F0ZSA9IGZ1bmN0aW9uICh4LCBuKSB7XG4gICAgdmFyIHAgPSBwb3coMTAuMCwgbiksXG4gICAgICAgIG51bSA9IHggKiBwO1xuXG4gICAgcmV0dXJuIChudW0gPCAwLjAgPyBjZWlsKG51bSkgOiBmbG9vcihudW0pKSAvIHA7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbGVycFxuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIGxpbmVhciBpbnRlcnBvbGF0aW9uIGJldHdlZW4gYSBhbmQgYiBieSB4XG4gKiBAcGFyYW0gTnVtYmVyIGFcbiAqIEBwYXJhbSBOdW1iZXIgYlxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5NYXRoZi5wcm90b3R5cGUubGVycCA9IGZ1bmN0aW9uIChhLCBiLCB4KSB7XG5cbiAgICByZXR1cm4gYSArIChiIC0gYSkgKiB4O1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGxlcnBBbmdsZVxuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIGxpbmVhciBpbnRlcnBvbGF0aW9uIGJldHdlZW4gYSBhbmQgYiBieSB4IGluc3VyZXMgMC4wIDw9IHggPCAyUElcbiAqIEBwYXJhbSBOdW1iZXIgYVxuICogQHBhcmFtIE51bWJlciBiXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5sZXJwQW5nbGUgPSBmdW5jdGlvbiAoYSwgYiwgeCkge1xuXG4gICAgcmV0dXJuIHN0YW5kYXJkUmFkaWFuKGEgKyAoYiAtIGEpICogeCk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgY29zTGVycFxuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIGNvc2luZSBpbnRlcnBvbGF0aW9uIGJldHdlZW4gYSBhbmQgYiBieSB4XG4gKiBAcGFyYW0gTnVtYmVyIGFcbiAqIEBwYXJhbSBOdW1iZXIgYlxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5NYXRoZi5wcm90b3R5cGUubGVycENvcyA9IGZ1bmN0aW9uIChhLCBiLCB4KSB7XG4gICAgdmFyIGZ0ID0geCAqIFBJLFxuICAgICAgICBmID0gKDEuMCAtIGNvcyhmdCkpICogMC41O1xuXG4gICAgcmV0dXJuIGEgKiAoMS4wIC0gZikgKyBiICogZjtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBsZXJwQ3ViaWNcbiAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gKiBjdWJpYyBpbnRlcnBvbGF0aW9uIGJldHdlZW4gdjEgYW5kIHYyIGJ5IHhcbiAqIEBwYXJhbSBOdW1iZXIgdjBcbiAqIEBwYXJhbSBOdW1iZXIgdjFcbiAqIEBwYXJhbSBOdW1iZXIgdjJcbiAqIEBwYXJhbSBOdW1iZXIgdjNcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuTWF0aGYucHJvdG90eXBlLmxlcnBDdWJpYyA9IGZ1bmN0aW9uICh2MCwgdjEsIHYyLCB2MywgeCkge1xuICAgIHYwIHx8ICh2MCA9IHYxKTtcbiAgICB2MyB8fCAodjMgPSB2Mik7XG4gICAgdmFyIFAgPSAodjMgLSB2MikgLSAodjAgLSB2MSksXG4gICAgICAgIFEgPSAodjAgLSB2MSkgLSBQLFxuICAgICAgICBSID0gdjIgLSB2MCxcbiAgICAgICAgUyA9IHYxLFxuXG4gICAgICAgIFB4ID0gUCAqIHgsXG4gICAgICAgIFF4ID0gUSAqIHgsXG4gICAgICAgIFJ4ID0gUiAqIHg7XG5cbiAgICByZXR1cm4gKFB4ICogUHggKiBQeCkgKyAoUXggKiBReCkgKyBSeCArIFM7XG59O1xuXG4vKipcbiAqIHNtb290aCBzdGVwLCBpZiBpbnB1dCBpcyBiZXR3ZWVuIG1pbiBhbmQgbWF4IHRoaXMgcmV0dXJucyBhIHZhbHVlIHByb3BvcnRpb25hdGVseSBiZXR3ZWVuIDAuMCBhbmQgMVxuICogQG1ldGhvZCBzbW9vdGhTdGVwXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcGFyYW0gTnVtYmVyIG1pblxuICogQHBhcmFtIE51bWJlciBtYXhcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5zbW9vdGhTdGVwID0gZnVuY3Rpb24gKHgsIG1pbiwgbWF4KSB7XG4gICAgaWYgKHggPD0gbWluKSByZXR1cm4gMC4wO1xuICAgIGlmICh4ID49IG1heCkgcmV0dXJuIDE7XG5cbiAgICB4ID0gKHggLSBtaW4pIC8gKG1heCAtIG1pbik7XG5cbiAgICByZXR1cm4geCAqIHggKiAoMyAtIDIgKiB4KTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzbW9vdGhlclN0ZXBcbiAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gKiBzbW9vdGhlciBzdGVwLCBpZiBpbnB1dCBpcyBiZXR3ZWVuIG1pbiBhbmQgbWF4IHRoaXMgcmV0dXJucyBhIHZhbHVlIHByb3BvcnRpb25hdGVseSBiZXR3ZWVuIDAuMCBhbmQgMVxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcGFyYW0gTnVtYmVyIG1pblxuICogQHBhcmFtIE51bWJlciBtYXhcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5zbW9vdGhlclN0ZXAgPSBmdW5jdGlvbiAoeCwgbWluLCBtYXgpIHtcbiAgICBpZiAoeCA8PSBtaW4pIHJldHVybiAwLjA7XG4gICAgaWYgKHggPj0gbWF4KSByZXR1cm4gMTtcblxuICAgIHggPSAoeCAtIG1pbikgLyAobWF4IC0gbWluKTtcblxuICAgIHJldHVybiB4ICogeCAqIHggKiAoeCAqICh4ICogNiAtIDE1KSArIDEwLjApO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHBpbmdQb25nXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICogUGluZ1BvbmdzIHRoZSB2YWx1ZSB4LCBzbyB0aGF0IGl0IGlzIG5ldmVyIGxhcmdlciB0aGFuIGxlbmd0aCBhbmQgbmV2ZXIgc21hbGxlciB0aGFuIDAuMC5cbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHBhcmFtIE51bWJlciBsZW5ndGhcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5waW5nUG9uZyA9IGZ1bmN0aW9uICh4LCBsZW5ndGgpIHtcbiAgICBsZW5ndGggfHwgKGxlbmd0aCA9IDEpO1xuXG4gICAgcmV0dXJuIGxlbmd0aCAtIGFicyh4ICUgKDIgKiBsZW5ndGgpIC0gbGVuZ3RoKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBkZWdzVG9SYWRzXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICogY29udmVydGVzIGRlZ3JlZXMgdG8gcmFkaWFuc1xuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5NYXRoZi5wcm90b3R5cGUuZGVnc1RvUmFkcyA9IGZ1bmN0aW9uICh4KSB7XG5cbiAgICByZXR1cm4gc3RhbmRhcmRSYWRpYW4oeCAqIFRPX1JBRFMpO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHJhZHNUb0RlZ3NcbiAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gKiBjb252ZXJ0ZXMgcmFkaWFucyB0byBkZWdyZWVzXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5yYWRzVG9EZWdzID0gcmFkc1RvRGVncyA9IGZ1bmN0aW9uICh4KSB7XG5cbiAgICByZXR1cm4gc3RhbmRhcmRBbmdsZSh4ICogVE9fREVHUyk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgcmFuZEludFxuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIHJldHVybnMgcmFuZG9tIG51bWJlciBiZXR3ZWVuIG1pbiBhbmQgbWF4XG4gKiBAcGFyYW0gTnVtYmVyIG1pblxuICogQHBhcmFtIE51bWJlciBtYXhcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5yYW5kSW50ID0gZnVuY3Rpb24gKG1pbiwgbWF4KSB7XG5cbiAgICByZXR1cm4gZmxvb3IobWluICsgKHJhbmRvbSgpICogKG1heCArIDEgLSBtaW4pKSk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgcmFuZEZsb2F0XG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICogcmV0dXJucyByYW5kb20gbnVtYmVyIGJldHdlZW4gbWluIGFuZCBtYXhcbiAqIEBwYXJhbSBOdW1iZXIgbWluXG4gKiBAcGFyYW0gTnVtYmVyIG1heFxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuTWF0aGYucHJvdG90eXBlLnJhbmRGbG9hdCA9IGZ1bmN0aW9uIChtaW4sIG1heCkge1xuXG4gICAgcmV0dXJuIG1pbiArIChyYW5kb20oKSAqIChtYXggLSBtaW4pKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCByYW5kU2lnblxuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIHJldHVybnMgZWl0aGVyIC0xIG9yIDFcbiAqIEBwYXJhbSBOdW1iZXIgbWluXG4gKiBAcGFyYW0gTnVtYmVyIG1heFxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuTWF0aGYucHJvdG90eXBlLnJhbmRTaWduID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIHJhbmRvbSgpIDwgMC41ID8gMSA6IC0xO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHJhbmRDaG9pY2VcbiAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gKiByZXR1cm5zIHJhbmRvbSBpdGVtIGZyb20gYXJyYXlcbiAqIEBwYXJhbSBBcnJheSBhcnJheVxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuTWF0aGYucHJvdG90eXBlLnJhbmRDaG9pY2UgPSBmdW5jdGlvbiAoYXJyYXkpIHtcblxuICAgIHJldHVybiBhcnJheVsocmFuZG9tKCkgKiBhcnJheS5sZW5ndGgpIHwgMC4wXTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzaHVmZmxlXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICogc2h1ZmZsZXMgYXJyYXlcbiAqIEBwYXJhbSBBcnJheSBhcnJheVxuICogQHJldHVybiBBcnJheVxuICovXG5NYXRoZi5wcm90b3R5cGUuc2h1ZmZsZSA9IGZ1bmN0aW9uIChhcnJheSkge1xuXG4gICAgZm9yICh2YXIgaiwgeCwgaSA9IGFycmF5Lmxlbmd0aDsgaTsgaiA9IChyYW5kb20oKSAqIGkpIHwgMC4wLCB4ID0gYXJyYXlbLS1pXSwgYXJyYXlbaV0gPSBhcnJheVtqXSwgYXJyYXlbal0gPSB4KTtcbiAgICByZXR1cm4gYXJyYXk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgcmFuZEFyZ1xuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIHJldHVybnMgcmFuZG9tIGFyZ3VtZW50IGZyb20gYXJndW1lbnRzXG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5NYXRoZi5wcm90b3R5cGUucmFuZEFyZyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiBhcmd1bWVudHNbKHJhbmRvbSgpICogYXJndW1lbnRzLmxlbmd0aCkgfCAwLjBdO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHJhbmRDaG9pY2VPYmplY3RcbiAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gKiByZXR1cm5zIHJhbmRvbSBrZXkgZnJvbSBvYmplY3RcbiAqIEBwYXJhbSBPYmplY3Qgb2JqXG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5NYXRoZi5wcm90b3R5cGUucmFuZENob2ljZU9iamVjdCA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICB2YXIgYXJyYXkgPSBrZXlzKG9iaik7XG5cbiAgICByZXR1cm4gYXJyYXlbKHJhbmRvbSgpICogYXJyYXkubGVuZ3RoKSB8IDAuMF07XG59O1xuXG4vKipcbiAqIEBtZXRob2QgaXNQb3dlck9mVHdvXG4gKiBAbWVtYmVyb2YgT2Rpbi5NYXRoZlxuICogY2hlY2tzIGlmIHggaXMgYSBwb3dlciBvZiAyXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5pc1Bvd2VyT2ZUd28gPSBmdW5jdGlvbiAoeCkge1xuXG4gICAgcmV0dXJuICh4ICYgLXgpID09PSB4O1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZsb29yUG93ZXJPZlR3b1xuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIHJldHVybnMgbnVtYmVyJ3MgZmxvb3IgcG93ZXIgb2YgMlxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5NYXRoZi5wcm90b3R5cGUuZmxvb3JQb3dlck9mVHdvID0gZnVuY3Rpb24gKHgpIHtcbiAgICB2YXIgaSA9IDIsXG4gICAgICAgIHByZXY7XG5cbiAgICB3aGlsZSAoaSA8IHgpIHtcbiAgICAgICAgcHJldiA9IGk7XG4gICAgICAgIGkgKj0gMjtcbiAgICB9XG5cbiAgICByZXR1cm4gcHJldjtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjZWlsUG93ZXJPZlR3b1xuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIHJldHVybnMgbnVtYmVyJ3MgY2VpbCBwb3dlciBvZiAyXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5jZWlsUG93ZXJPZlR3byA9IGZ1bmN0aW9uICh4KSB7XG4gICAgdmFyIGkgPSAyO1xuXG4gICAgd2hpbGUgKGkgPCB4KSB7XG4gICAgICAgIGkgKj0gMjtcbiAgICB9XG5cbiAgICByZXR1cm4gaTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tSlNPTlxuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIHJldHVybnMgTWF0aCBjbGFzcyBiYXNlZCBvbiBqc29uIF9jbGFzc05hbWVcbiAqIEBwYXJhbSBPYmplY3QganNvblxuICogQHJldHVybiBNQVRIX0NMQVNTXG4gKi9cbk1hdGhmLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG5cbiAgICByZXR1cm4gbmV3IHRoaXMuX2NsYXNzZXNbanNvbi5fY2xhc3NOYW1lXSgpLmZyb21KU09OKGpzb24pO1xufTtcblxuXG4vKipcbiAqIEBtZXRob2QgZGlyZWN0aW9uQW5nbGVcbiAqIEBtZW1iZXJvZiBPZGluLk1hdGhmXG4gKiByZXR1cm5zIGRpcmVjdGlvbiBzdHJpbmcgb2YgYW4gYW5nbGUgaW4gcmFkaWFuc1xuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcGFyYW0gTnVtYmVyIHlcbiAqIEByZXR1cm4gU3RyaW5nXG4gKi9cblxudmFyIG4yMjUgPSAwLjM5MjY5OTA4MTY5ODcyNDE0LFxuICAgIG42NzUgPSAxLjE3ODA5NzI0NTA5NjE3MjQsXG4gICAgbjExMjUgPSAxLjk2MzQ5NTQwODQ5MzYyMDcsXG4gICAgbjE1NzUgPSAyLjc0ODg5MzU3MTg5MTA2OSxcbiAgICBuMjAyNSA9IDMuNTM0MjkxNzM1Mjg4NTE3MyxcbiAgICBuMjQ3NSA9IDQuMzE5Njg5ODk4Njg1OTY2LFxuICAgIG4yOTI1ID0gNS4xMDUwODgwNjIwODM0MTQsXG4gICAgbjMzNzUgPSA1Ljg5MDQ4NjIyNTQ4MDg2MjUsXG5cbiAgICBSSUdIVCA9IFwicmlnaHRcIixcbiAgICBVUF9SSUdIVCA9IFwidXBfcmlnaHRcIixcbiAgICBVUCA9IFwidXBcIixcbiAgICBVUF9MRUZUID0gXCJ1cF9sZWZ0XCIsXG4gICAgTEVGVCA9IFwibGVmdFwiLFxuICAgIERPV05fTEVGVCA9IFwiZG93bl9sZWZ0XCIsXG4gICAgRE9XTiA9IFwiZG93blwiLFxuICAgIERPV05fUklHSFQgPSBcImRvd25fcmlnaHRcIjtcblxuTWF0aGYucHJvdG90eXBlLmRpcmVjdGlvbkFuZ2xlID0gZnVuY3Rpb24gKGEpIHtcbiAgICBhID0gc3RhbmRhcmRSYWRpYW4oYSk7XG5cbiAgICBpZiAoYSA+PSBuMzM3NSAmJiBhIDwgbjIyNSkgcmV0dXJuIFJJR0hUO1xuICAgIGlmIChhID49IG4yMjUgJiYgYSA8IG42NzUpIHJldHVybiBVUF9SSUdIVDtcbiAgICBpZiAoYSA+PSBuNjc1ICYmIGEgPCBuMTEyNSkgcmV0dXJuIFVQO1xuICAgIGlmIChhID49IG4xMTI1ICYmIGEgPCBuMTU3NSkgcmV0dXJuIFVQX0xFRlQ7XG4gICAgaWYgKGEgPj0gbjE1NzUgJiYgYSA8IG4yMDI1KSByZXR1cm4gTEVGVDtcbiAgICBpZiAoYSA+PSBuMjAyNSAmJiBhIDwgbjI0NzUpIHJldHVybiBET1dOX0xFRlQ7XG4gICAgaWYgKGEgPj0gbjI0NzUgJiYgYSA8IG4yOTI1KSByZXR1cm4gRE9XTjtcbiAgICBpZiAoYSA+PSBuMjkyNSAmJiBhIDwgbjMzNzUpIHJldHVybiBET1dOX1JJR0hUO1xuXG4gICAgcmV0dXJuIFJJR0hUO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGRpcmVjdGlvblxuICogQG1lbWJlcm9mIE9kaW4uTWF0aGZcbiAqIHJldHVybnMgZGlyZWN0aW9uIHN0cmluZyBmcm9tIGFuIHggYW5kIGEgeSBjb29yZGluYXRlXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEBwYXJhbSBOdW1iZXIgeVxuICogQHJldHVybiBTdHJpbmdcbiAqL1xuTWF0aGYucHJvdG90eXBlLmRpcmVjdGlvbiA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgdmFyIGEgPSBzdGFuZGFyZFJhZGlhbihhdGFuMih5LCB4KSk7XG5cbiAgICBpZiAoYSA+PSBuMzM3NSAmJiBhIDwgbjIyNSkgcmV0dXJuIFJJR0hUO1xuICAgIGlmIChhID49IG4yMjUgJiYgYSA8IG42NzUpIHJldHVybiBVUF9SSUdIVDtcbiAgICBpZiAoYSA+PSBuNjc1ICYmIGEgPCBuMTEyNSkgcmV0dXJuIFVQO1xuICAgIGlmIChhID49IG4xMTI1ICYmIGEgPCBuMTU3NSkgcmV0dXJuIFVQX0xFRlQ7XG4gICAgaWYgKGEgPj0gbjE1NzUgJiYgYSA8IG4yMDI1KSByZXR1cm4gTEVGVDtcbiAgICBpZiAoYSA+PSBuMjAyNSAmJiBhIDwgbjI0NzUpIHJldHVybiBET1dOX0xFRlQ7XG4gICAgaWYgKGEgPj0gbjI0NzUgJiYgYSA8IG4yOTI1KSByZXR1cm4gRE9XTjtcbiAgICBpZiAoYSA+PSBuMjkyNSAmJiBhIDwgbjMzNzUpIHJldHVybiBET1dOX1JJR0hUO1xuXG4gICAgcmV0dXJuIFJJR0hUO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBNYXRoZjtcbiIsInZhciBNYXRoZiA9IHJlcXVpcmUoXCIuL21hdGhmXCIpO1xudmFyIFZlYzMgPSByZXF1aXJlKFwiLi92ZWMzXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGFicyA9IE1hdGguYWJzLFxuICAgIHNxcnQgPSBNYXRoLnNxcnQsXG4gICAgYWNvcyA9IE1hdGguYWNvcyxcbiAgICBzaW4gPSBNYXRoLnNpbixcbiAgICBjb3MgPSBNYXRoLmNvcyxcbiAgICBFUFNJTE9OID0gTWF0aGYuRVBTSUxPTjtcblxuLyoqXG4gKiBAY2xhc3MgUXVhdFxuICogcXVhdGVybmlvblxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcGFyYW0gTnVtYmVyIHlcbiAqIEBwYXJhbSBOdW1iZXIgelxuICogQHBhcmFtIE51bWJlciB3XG4gKi9cbmZ1bmN0aW9uIFF1YXQoeCwgeSwgeiwgdykge1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciB4XG4gICAgICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICAgICAqL1xuICAgIHRoaXMueCA9IHggfHwgMC4wO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciB5XG4gICAgICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICAgICAqL1xuICAgIHRoaXMueSA9IHkgfHwgMC4wO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciB6XG4gICAgICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICAgICAqL1xuICAgIHRoaXMueiA9IHogfHwgMC4wO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciB3XG4gICAgICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICAgICAqL1xuICAgIHRoaXMudyA9IHcgIT0gdW5kZWZpbmVkID8gdyA6IDEuMDtcbn1cblxuTWF0aGYuX2NsYXNzZXNbXCJRdWF0XCJdID0gUXVhdDtcblxuLyoqXG4gKiBAbWV0aG9kIGNsb25lXG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiByZXR1cm5zIG5ldyBpbnN0YW5jZSBvZiB0aGlzXG4gKiBAcmV0dXJuIFF1YXRcbiAqL1xuUXVhdC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gbmV3IFF1YXQodGhpcy54LCB0aGlzLnksIHRoaXMueiwgdGhpcy53KTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjb3B5XG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiBjb3BpZXMgb3RoZXJcbiAqIEBwYXJhbSBRdWF0IG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy54ID0gb3RoZXIueDtcbiAgICB0aGlzLnkgPSBvdGhlci55O1xuICAgIHRoaXMueiA9IG90aGVyLno7XG4gICAgdGhpcy53ID0gb3RoZXIudztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNldFxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogc2V0cyB2YWx1ZXMgb2YgdGhpc1xuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcGFyYW0gTnVtYmVyIHlcbiAqIEBwYXJhbSBOdW1iZXIgelxuICogQHBhcmFtIE51bWJlciB3XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHgsIHksIHosIHcpIHtcblxuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICB0aGlzLnogPSB6O1xuICAgIHRoaXMudyA9IHc7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtdWxcbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIG11bGlwbGVzIHRoaXMncyB2YWx1ZXMgYnkgb3RoZXInc1xuICogQHBhcmFtIFF1YXQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5tdWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYXggPSB0aGlzLngsXG4gICAgICAgIGF5ID0gdGhpcy55LFxuICAgICAgICBheiA9IHRoaXMueixcbiAgICAgICAgYXcgPSB0aGlzLncsXG4gICAgICAgIGJ4ID0gb3RoZXIueCxcbiAgICAgICAgYnkgPSBvdGhlci55LFxuICAgICAgICBieiA9IG90aGVyLnosXG4gICAgICAgIGJ3ID0gb3RoZXIudztcblxuICAgIHRoaXMueCA9IGF4ICogYncgKyBhdyAqIGJ4ICsgYXkgKiBieiAtIGF6ICogYnk7XG4gICAgdGhpcy55ID0gYXkgKiBidyArIGF3ICogYnkgKyBheiAqIGJ4IC0gYXggKiBiejtcbiAgICB0aGlzLnogPSBheiAqIGJ3ICsgYXcgKiBieiArIGF4ICogYnkgLSBheSAqIGJ4O1xuICAgIHRoaXMudyA9IGF3ICogYncgLSBheCAqIGJ4IC0gYXkgKiBieSAtIGF6ICogYno7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBxbXVsXG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiBtdWxpcGxlcyBhIGFuZCBiIHNhdmVzIGl0IGluIHRoaXNcbiAqIEBwYXJhbSBRdWF0IGFcbiAqIEBwYXJhbSBRdWF0IGJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5xbXVsID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICB2YXIgYXggPSBhLngsXG4gICAgICAgIGF5ID0gYS55LFxuICAgICAgICBheiA9IGEueixcbiAgICAgICAgYXcgPSBhLncsXG4gICAgICAgIGJ4ID0gYi54LFxuICAgICAgICBieSA9IGIueSxcbiAgICAgICAgYnogPSBiLnosXG4gICAgICAgIGJ3ID0gYi53O1xuXG4gICAgdGhpcy54ID0gYXggKiBidyArIGF3ICogYnggKyBheSAqIGJ6IC0gYXogKiBieTtcbiAgICB0aGlzLnkgPSBheSAqIGJ3ICsgYXcgKiBieSArIGF6ICogYnggLSBheCAqIGJ6O1xuICAgIHRoaXMueiA9IGF6ICogYncgKyBhdyAqIGJ6ICsgYXggKiBieSAtIGF5ICogYng7XG4gICAgdGhpcy53ID0gYXcgKiBidyAtIGF4ICogYnggLSBheSAqIGJ5IC0gYXogKiBiejtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGRpdlxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogZGl2aWRlcyB0aGlzJ3MgdmFsdWVzIGJ5IG90aGVyJ3NcbiAqIEBwYXJhbSBRdWF0IG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUuZGl2ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIGF4ID0gdGhpcy54LFxuICAgICAgICBheSA9IHRoaXMueSxcbiAgICAgICAgYXogPSB0aGlzLnosXG4gICAgICAgIGF3ID0gdGhpcy53LFxuICAgICAgICBieCA9IC1vdGhlci54LFxuICAgICAgICBieSA9IC1vdGhlci55LFxuICAgICAgICBieiA9IC1vdGhlci56LFxuICAgICAgICBidyA9IG90aGVyLnc7XG5cbiAgICB0aGlzLnggPSBheCAqIGJ3ICsgYXcgKiBieCArIGF5ICogYnogLSBheiAqIGJ5O1xuICAgIHRoaXMueSA9IGF5ICogYncgKyBhdyAqIGJ5ICsgYXogKiBieCAtIGF4ICogYno7XG4gICAgdGhpcy56ID0gYXogKiBidyArIGF3ICogYnogKyBheCAqIGJ5IC0gYXkgKiBieDtcbiAgICB0aGlzLncgPSBhdyAqIGJ3IC0gYXggKiBieCAtIGF5ICogYnkgLSBheiAqIGJ6O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgcWRpdlxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogZGl2aWRlcyBiIGZyb20gYSBzYXZlcyBpdCBpbiB0aGlzXG4gKiBAcGFyYW0gUXVhdCBhXG4gKiBAcGFyYW0gUXVhdCBiXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUucWRpdiA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgdmFyIGF4ID0gYS54LFxuICAgICAgICBheSA9IGEueSxcbiAgICAgICAgYXogPSBhLnosXG4gICAgICAgIGF3ID0gYS53LFxuICAgICAgICBieCA9IC1iLngsXG4gICAgICAgIGJ5ID0gLWIueSxcbiAgICAgICAgYnogPSAtYi56LFxuICAgICAgICBidyA9IGIudztcblxuICAgIHRoaXMueCA9IGF4ICogYncgKyBhdyAqIGJ4ICsgYXkgKiBieiAtIGF6ICogYnk7XG4gICAgdGhpcy55ID0gYXkgKiBidyArIGF3ICogYnkgKyBheiAqIGJ4IC0gYXggKiBiejtcbiAgICB0aGlzLnogPSBheiAqIGJ3ICsgYXcgKiBieiArIGF4ICogYnkgLSBheSAqIGJ4O1xuICAgIHRoaXMudyA9IGF3ICogYncgLSBheCAqIGJ4IC0gYXkgKiBieSAtIGF6ICogYno7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBsZW5ndGhcbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIHJldHVybnMgdGhlIGxlbmd0aCBvZiB0aGlzXG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5RdWF0LnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHggPSB0aGlzLngsXG4gICAgICAgIHkgPSB0aGlzLnksXG4gICAgICAgIHogPSB0aGlzLnosXG4gICAgICAgIHcgPSB0aGlzLncsXG4gICAgICAgIGxzcSA9IHggKiB4ICsgeSAqIHkgKyB6ICogeiArIHcgKiB3O1xuXG4gICAgcmV0dXJuIGxzcSA+IDAuMCA/IHNxcnQobHNxKSA6IDAuMDtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBsZW5ndGhTcVxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogcmV0dXJucyB0aGUgc3F1YXJlZCBsZW5ndGggb2YgdGhpc1xuICogQHJldHVybiBOdW1iZXJcbiAqL1xuUXVhdC5wcm90b3R5cGUubGVuZ3RoU3EgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHggPSB0aGlzLngsXG4gICAgICAgIHkgPSB0aGlzLnksXG4gICAgICAgIHogPSB0aGlzLnosXG4gICAgICAgIHcgPSB0aGlzLnc7XG5cbiAgICByZXR1cm4geCAqIHggKyB5ICogeSArIHogKiB6ICsgdyAqIHc7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgbm9ybWFsaXplXG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiByZXR1cm5zIHRoaXMgd2l0aCBhIGxlbmd0aCBvZiAxXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUubm9ybWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICB6ID0gdGhpcy56LFxuICAgICAgICB3ID0gdGhpcy53LFxuICAgICAgICBsID0geCAqIHggKyB5ICogeSArIHogKiB6ICsgdyAqIHc7XG5cbiAgICBsID0gbCA+IDAuMCA/IDEuMCAvIHNxcnQobCkgOiAwLjA7XG5cbiAgICB0aGlzLnggKj0gbDtcbiAgICB0aGlzLnkgKj0gbDtcbiAgICB0aGlzLnogKj0gbDtcbiAgICB0aGlzLncgKj0gbDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGludmVyc2VcbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIHJldHVybnMgdGhlIGludmVyc2Ugb2YgdGhpc1xuICogQHJldHVybiB0aGlzXG4gKi9cblF1YXQucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHggPSB0aGlzLngsXG4gICAgICAgIHkgPSB0aGlzLnksXG4gICAgICAgIHogPSB0aGlzLnosXG4gICAgICAgIHcgPSB0aGlzLncsXG4gICAgICAgIGQgPSB4ICogeCArIHkgKiB5ICsgeiAqIHogKyB3ICogdyxcbiAgICAgICAgaW52RCA9IGQgPiAwLjAgPyAxLjAgLyBkIDogMC4wO1xuXG4gICAgdGhpcy54ICo9IC1pbnZEO1xuICAgIHRoaXMueSAqPSAtaW52RDtcbiAgICB0aGlzLnogKj0gLWludkQ7XG4gICAgdGhpcy53ICo9IGludkQ7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBpbnZlcnNlUXVhdFxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogcmV0dXJucyB0aGUgaW52ZXJzZSBvZiBvdGhlclxuICogQHBhcmFtIFF1YXQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5pbnZlcnNlUXVhdCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciB4ID0gb3RoZXIueCxcbiAgICAgICAgeSA9IG90aGVyLnksXG4gICAgICAgIHogPSBvdGhlci56LFxuICAgICAgICB3ID0gb3RoZXIudyxcbiAgICAgICAgZCA9IHggKiB4ICsgeSAqIHkgKyB6ICogeiArIHcgKiB3LFxuICAgICAgICBpbnZEID0gZCA+IDAuMCA/IDEuMCAvIGQgOiAwLjA7XG5cbiAgICB0aGlzLnggPSAteCAqIGludkQ7XG4gICAgdGhpcy55ID0gLXkgKiBpbnZEO1xuICAgIHRoaXMueiA9IC16ICogaW52RDtcbiAgICB0aGlzLncgPSB3ICogaW52RDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNvbmp1Z2F0ZVxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogdGhpcyBmYXN0ZXIgdGhhbiBpbnZlcnNlLCBpZiBxdWF0IGlzIG5vcm1hbGl6ZWQgYW5kIHByb2R1Y2VzIHRoZSBzYW1lIHJlc3VsdFxuICogQHJldHVybiB0aGlzXG4gKi9cblF1YXQucHJvdG90eXBlLmNvbmp1Z2F0ZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMueCA9IC10aGlzLng7XG4gICAgdGhpcy55ID0gLXRoaXMueTtcbiAgICB0aGlzLnogPSAtdGhpcy56O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgY2FsY3VsYXRlV1xuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogY2FsY3VsYXRlcyB3IGNvbXBvbmVudCBvZiBxdWF0XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUuY2FsY3VsYXRlVyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgeCA9IHRoaXMueCxcbiAgICAgICAgeSA9IHRoaXMueSxcbiAgICAgICAgeiA9IHRoaXMuejtcblxuICAgIHRoaXMudyA9IC1zcXJ0KGFicygxIC0geCAqIHggLSB5ICogeSAtIHogKiB6KSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBsZXJwXG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiBsaW5lYXIgaW50ZXJwb2xhdGlvbiBiZXR3ZWVuIHRoaXMgYW5kIG90aGVyIGJ5IHhcbiAqIEBwYXJhbSBRdWF0IG90aGVyXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5sZXJwID0gZnVuY3Rpb24gKG90aGVyLCB4KSB7XG5cbiAgICB0aGlzLnggKz0gKG90aGVyLnggLSB0aGlzLngpICogeDtcbiAgICB0aGlzLnkgKz0gKG90aGVyLnkgLSB0aGlzLnkpICogeDtcbiAgICB0aGlzLnogKz0gKG90aGVyLnogLSB0aGlzLnopICogeDtcbiAgICB0aGlzLncgKz0gKG90aGVyLncgLSB0aGlzLncpICogeDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHFsZXJwXG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiBsaW5lYXIgaW50ZXJwb2xhdGlvbiBiZXR3ZWVuIGEgYW5kIGIgYnkgeFxuICogQHBhcmFtIFF1YXQgYVxuICogQHBhcmFtIFF1YXQgYlxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUucWxlcnAgPSBmdW5jdGlvbiAoYSwgYiwgeCkge1xuICAgIHZhciBheCA9IGEueCxcbiAgICAgICAgYXkgPSBhLnksXG4gICAgICAgIGF6ID0gYS56LFxuICAgICAgICBhdyA9IGEudztcblxuICAgIHRoaXMueCA9IGF4ICsgKGIueCAtIGF4KSAqIHg7XG4gICAgdGhpcy55ID0gYXkgKyAoYi55IC0gYXkpICogeDtcbiAgICB0aGlzLnogPSBheiArIChiLnogLSBheikgKiB4O1xuICAgIHRoaXMudyA9IGF3ICsgKGIudyAtIGF3KSAqIHg7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBubGVycFxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogZmFzdGVyIGJ1dCBsZXNzIGFjY3VyYXRlIHRoYW4gc2xlcnBcbiAqIEBwYXJhbSBRdWF0IG90aGVyXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5ubGVycCA9IGZ1bmN0aW9uIChvdGhlciwgeCkge1xuXG4gICAgdGhpcy54ICs9IChvdGhlci54IC0gdGhpcy54KSAqIHg7XG4gICAgdGhpcy55ICs9IChvdGhlci55IC0gdGhpcy55KSAqIHg7XG4gICAgdGhpcy56ICs9IChvdGhlci56IC0gdGhpcy56KSAqIHg7XG4gICAgdGhpcy53ICs9IChvdGhlci53IC0gdGhpcy53KSAqIHg7XG5cbiAgICByZXR1cm4gdGhpcy5ub3JtYWxpemUoKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBxbmxlcnBcbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIGZhc3RlciBidXQgbGVzcyBhY2N1cmF0ZSB0aGFuIHFzbGVycFxuICogQHBhcmFtIFF1YXQgYVxuICogQHBhcmFtIFF1YXQgYlxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUucW5sZXJwID0gZnVuY3Rpb24gKGEsIGIsIHgpIHtcbiAgICB2YXIgYXggPSBhLngsXG4gICAgICAgIGF5ID0gYS55LFxuICAgICAgICBheiA9IGEueixcbiAgICAgICAgYXcgPSBhLnc7XG5cbiAgICB0aGlzLnggPSBheCArIChiLnggLSBheCkgKiB4O1xuICAgIHRoaXMueSA9IGF5ICsgKGIueSAtIGF5KSAqIHg7XG4gICAgdGhpcy56ID0gYXogKyAoYi56IC0gYXopICogeDtcbiAgICB0aGlzLncgPSBhdyArIChiLncgLSBhdykgKiB4O1xuXG4gICAgcmV0dXJuIHRoaXMubm9ybWFsaXplKCk7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2xlcnBcbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIHNwaGVyaWNhbCBsaW5lYXIgSW50ZXJwb2xhdGlvbiBvZiB0aGlzIGFuZCBvdGhlciBieSB4XG4gKiBAcGFyYW0gUXVhdCBvdGhlclxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUuc2xlcnAgPSBmdW5jdGlvbiAob3RoZXIsIHgpIHtcbiAgICB2YXIgYXggPSB0aGlzLngsXG4gICAgICAgIGF5ID0gdGhpcy55LFxuICAgICAgICBheiA9IHRoaXMueixcbiAgICAgICAgYXcgPSB0aGlzLncsXG4gICAgICAgIGJ4ID0gb3RoZXIueCxcbiAgICAgICAgYnkgPSBvdGhlci55LFxuICAgICAgICBieiA9IG90aGVyLnosXG4gICAgICAgIGJ3ID0gb3RoZXIudyxcblxuICAgICAgICBvbWVnYSwgc2lub20sIHNjYWxlMCwgc2NhbGUxLFxuICAgICAgICBjb3NvbSA9IGF4ICogYnggKyBheSAqIGJ5ICsgYXogKiBieiArIGF3ICogYnc7XG5cbiAgICBpZiAoY29zb20gPCAwLjApIHtcbiAgICAgICAgY29zb20gKj0gLTE7XG4gICAgICAgIGJ4ICo9IC0xO1xuICAgICAgICBieSAqPSAtMTtcbiAgICAgICAgYnogKj0gLTE7XG4gICAgICAgIGJ3ICo9IC0xO1xuICAgIH1cblxuICAgIGlmICgxIC0gY29zb20gPiBFUFNJTE9OKSB7XG4gICAgICAgIG9tZWdhID0gYWNvcyhjb3NvbSk7XG4gICAgICAgIHNpbm9tID0gMSAvIHNpbihvbWVnYSk7XG4gICAgICAgIHNjYWxlMCA9IHNpbigoMSAtIHgpICogb21lZ2EpICogc2lub207XG4gICAgICAgIHNjYWxlMSA9IHNpbih4ICogb21lZ2EpICogc2lub207XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2NhbGUwID0gMSAtIHg7XG4gICAgICAgIHNjYWxlMSA9IHg7XG4gICAgfVxuXG4gICAgdGhpcy54ID0gc2NhbGUwICogYXggKyBzY2FsZTEgKiBieDtcbiAgICB0aGlzLnkgPSBzY2FsZTAgKiBheSArIHNjYWxlMSAqIGJ5O1xuICAgIHRoaXMueiA9IHNjYWxlMCAqIGF6ICsgc2NhbGUxICogYno7XG4gICAgdGhpcy53ID0gc2NhbGUwICogYXcgKyBzY2FsZTEgKiBidztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHFzbGVycFxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogc3BoZXJpY2FsIGxpbmVhciBJbnRlcnBvbGF0aW9uIGJldHdlZW4gYSBhbmQgYiBieSB4XG4gKiBAcGFyYW0gUXVhdCBhXG4gKiBAcGFyYW0gUXVhdCBiXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5xc2xlcnAgPSBmdW5jdGlvbiAoYSwgYiwgeCkge1xuICAgIHZhciBheCA9IGEueCxcbiAgICAgICAgYXkgPSBhLnksXG4gICAgICAgIGF6ID0gYS56LFxuICAgICAgICBhdyA9IGEudyxcbiAgICAgICAgYnggPSBiLngsXG4gICAgICAgIGJ5ID0gYi55LFxuICAgICAgICBieiA9IGIueixcbiAgICAgICAgYncgPSBiLncsXG5cbiAgICAgICAgb21lZ2EsIHNpbm9tLCBzY2FsZTAsIHNjYWxlMSxcbiAgICAgICAgY29zb20gPSBheCAqIGJ4ICsgYXkgKiBieSArIGF6ICogYnogKyBhdyAqIGJ3O1xuXG4gICAgaWYgKGNvc29tIDwgMC4wKSB7XG4gICAgICAgIGNvc29tICo9IC0xO1xuICAgICAgICBieCAqPSAtMTtcbiAgICAgICAgYnkgKj0gLTE7XG4gICAgICAgIGJ6ICo9IC0xO1xuICAgICAgICBidyAqPSAtMTtcbiAgICB9XG5cbiAgICBpZiAoMSAtIGNvc29tID4gRVBTSUxPTikge1xuICAgICAgICBvbWVnYSA9IGFjb3MoY29zb20pO1xuICAgICAgICBzaW5vbSA9IDEgLyBzaW4ob21lZ2EpO1xuICAgICAgICBzY2FsZTAgPSBzaW4oKDEgLSB4KSAqIG9tZWdhKSAqIHNpbm9tO1xuICAgICAgICBzY2FsZTEgPSBzaW4oeCAqIG9tZWdhKSAqIHNpbm9tO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHNjYWxlMCA9IDEgLSB4O1xuICAgICAgICBzY2FsZTEgPSB4O1xuICAgIH1cblxuICAgIHRoaXMueCA9IHNjYWxlMCAqIGF4ICsgc2NhbGUxICogYng7XG4gICAgdGhpcy55ID0gc2NhbGUwICogYXkgKyBzY2FsZTEgKiBieTtcbiAgICB0aGlzLnogPSBzY2FsZTAgKiBheiArIHNjYWxlMSAqIGJ6O1xuICAgIHRoaXMudyA9IHNjYWxlMCAqIGF3ICsgc2NhbGUxICogYnc7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBxZG90XG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiBkb3QgcHJvZHVjdCBvZiB0d28gcXVhdHMsIGNhbiBiZSBjYWxsZWQgYXMgYSBzdGF0aWMgZnVuY3Rpb24gUXVhdC5xZG90KCBhLCBiIClcbiAqIEBwYXJhbSBRdWF0IGFcbiAqIEBwYXJhbSBRdWF0IGJcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cblF1YXQucWRvdCA9IFF1YXQucHJvdG90eXBlLnFkb3QgPSBmdW5jdGlvbiAoYSwgYikge1xuXG4gICAgcmV0dXJuIGEueCAqIGIueCArIGEueSAqIGIueSArIGEueiAqIGIueiArIGEudyAqIGIudztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBkb3RcbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIGRvdCBwcm9kdWN0IG9mIHRoaXMgYW5kIG90aGVyXG4gKiBAcGFyYW0gUXVhdCBvdGhlclxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuUXVhdC5wcm90b3R5cGUuZG90ID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICByZXR1cm4gdGhpcy54ICogb3RoZXIueCArIHRoaXMueSAqIG90aGVyLnkgKyB0aGlzLnogKiBvdGhlci56ICsgdGhpcy53ICogb3RoZXIudztcbn07XG5cbi8qKlxuICogQG1ldGhvZCByb3RhdGlvblhcbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIGdldHMgcXVhdCdzIHggcm90YXRpb24gYXMgYW4gZXVsYXIgYW5nbGVcbiAqIEBwYXJhbSBOdW1iZXIgYW5nbGVcbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5yb3RhdGlvblggPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHcgPSB0aGlzLnc7XG5cbiAgICByZXR1cm4gdGhpcy54IC8gc3FydCgxIC0gKHcgKiB3KSk7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgcm90YXRpb25ZXG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiBnZXRzIHF1YXQncyB5IHJvdGF0aW9uIGFzIGFuIGV1bGFyIGFuZ2xlXG4gKiBAcGFyYW0gTnVtYmVyIGFuZ2xlXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUucm90YXRpb25ZID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB3ID0gdGhpcy53O1xuXG4gICAgcmV0dXJuIHRoaXMueSAvIHNxcnQoMSAtICh3ICogdykpO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHJvdGF0aW9uWlxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogZ2V0cyBxdWF0J3MgeiByb3RhdGlvbiBhcyBhbiBldWxhciBhbmdsZVxuICogQHBhcmFtIE51bWJlciBhbmdsZVxuICogQHJldHVybiB0aGlzXG4gKi9cblF1YXQucHJvdG90eXBlLnJvdGF0aW9uWiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdyA9IHRoaXMudztcblxuICAgIHJldHVybiB0aGlzLnogLyBzcXJ0KDEgLSAodyAqIHcpKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCByb3RhdGVYXG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiBzZXRzIHF1YXQncyB4IHJvdGF0aW9uXG4gKiBAcGFyYW0gTnVtYmVyIGFuZ2xlXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUucm90YXRlWCA9IGZ1bmN0aW9uIChhbmdsZSkge1xuICAgIHZhciBoYWxmQW5nbGUgPSBhbmdsZSAqIDAuNSxcbiAgICAgICAgeCA9IHRoaXMueCxcbiAgICAgICAgeSA9IHRoaXMueSxcbiAgICAgICAgeiA9IHRoaXMueixcbiAgICAgICAgdyA9IHRoaXMudyxcbiAgICAgICAgcyA9IHNpbihoYWxmQW5nbGUpLFxuICAgICAgICBjID0gY29zKGhhbGZBbmdsZSk7XG5cbiAgICB0aGlzLnggPSB4ICogYyArIHcgKiBzO1xuICAgIHRoaXMueSA9IHkgKiBjICsgeiAqIHM7XG4gICAgdGhpcy56ID0geiAqIGMgLSB5ICogcztcbiAgICB0aGlzLncgPSB3ICogYyAtIHggKiBzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgcm90YXRlWVxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogc2V0cyBxdWF0J3MgeSByb3RhdGlvblxuICogQHBhcmFtIE51bWJlciBhbmdsZVxuICogQHJldHVybiB0aGlzXG4gKi9cblF1YXQucHJvdG90eXBlLnJvdGF0ZVkgPSBmdW5jdGlvbiAoYW5nbGUpIHtcbiAgICB2YXIgaGFsZkFuZ2xlID0gYW5nbGUgKiAwLjUsXG4gICAgICAgIHggPSB0aGlzLngsXG4gICAgICAgIHkgPSB0aGlzLnksXG4gICAgICAgIHogPSB0aGlzLnosXG4gICAgICAgIHcgPSB0aGlzLncsXG4gICAgICAgIHMgPSBzaW4oaGFsZkFuZ2xlKSxcbiAgICAgICAgYyA9IGNvcyhoYWxmQW5nbGUpO1xuXG4gICAgdGhpcy54ID0geCAqIGMgLSB6ICogcztcbiAgICB0aGlzLnkgPSB5ICogYyArIHcgKiBzO1xuICAgIHRoaXMueiA9IHogKiBjICsgeCAqIHM7XG4gICAgdGhpcy53ID0gdyAqIGMgLSB5ICogcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHJvdGF0ZVpcbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIHNldHMgcXVhdCdzIHogcm90YXRpb25cbiAqIEBwYXJhbSBOdW1iZXIgYW5nbGVcbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5yb3RhdGVaID0gZnVuY3Rpb24gKGFuZ2xlKSB7XG4gICAgdmFyIGhhbGZBbmdsZSA9IGFuZ2xlICogMC41LFxuICAgICAgICB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICB6ID0gdGhpcy56LFxuICAgICAgICB3ID0gdGhpcy53LFxuICAgICAgICBzID0gc2luKGhhbGZBbmdsZSksXG4gICAgICAgIGMgPSBjb3MoaGFsZkFuZ2xlKTtcblxuICAgIHRoaXMueCA9IHggKiBjICsgeSAqIHM7XG4gICAgdGhpcy55ID0geSAqIGMgLSB4ICogcztcbiAgICB0aGlzLnogPSB6ICogYyArIHcgKiBzO1xuICAgIHRoaXMudyA9IHcgKiBjIC0geiAqIHM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCByb3RhdGVcbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIHJvdGF0ZXMgcXVhdCBieSB6IHRoZW4geCB0aGVuIHkgaW4gdGhhdCBvcmRlclxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcGFyYW0gTnVtYmVyIHlcbiAqIEBwYXJhbSBOdW1iZXIgelxuICogQHJldHVybiB0aGlzXG4gKi9cblF1YXQucHJvdG90eXBlLnJvdGF0ZSA9IGZ1bmN0aW9uICh4LCB5LCB6KSB7XG5cbiAgICB0aGlzLnJvdGF0ZVooeik7XG4gICAgdGhpcy5yb3RhdGVYKHgpO1xuICAgIHRoaXMucm90YXRlWSh5KTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGxvb2tSb3RhdGlvblxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogY3JlYXRlcyBhIHJvdGF0aW9uIHdpdGggdGhlIHNwZWNpZmllZCBmb3J3YXJkIGFuZCB1cHdhcmRzIGRpcmVjdGlvbnNcbiAqIEBwYXJhbSBWZWMzIGZvcndhcmRcbiAqIEBwYXJhbSBWZWMzIHVwXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUubG9va1JvdGF0aW9uID0gZnVuY3Rpb24gKGZvcndhcmQsIHVwKSB7XG4gICAgdmFyIGZ4ID0gZm9yd2FyZC54LFxuICAgICAgICBmeSA9IGZvcndhcmQueSxcbiAgICAgICAgZnogPSBmb3J3YXJkLnosXG4gICAgICAgIHV4ID0gdXAueCxcbiAgICAgICAgdXkgPSB1cC55LFxuICAgICAgICB1eiA9IHVwLnosXG5cbiAgICAgICAgYXggPSB1eSAqIGZ6IC0gdXogKiBmeSxcbiAgICAgICAgYXkgPSB1eiAqIGZ4IC0gdXggKiBmeixcbiAgICAgICAgYXogPSB1eCAqIGZ5IC0gdXkgKiBmeCxcblxuICAgICAgICBkID0gKDEuMCArIHV4ICogZnggKyB1eSAqIGZ5ICsgdXogKiBmeikgKiAyLjAsXG4gICAgICAgIGRzcSA9IGQgKiBkLFxuICAgICAgICBzID0gMS4wIC8gZHNxO1xuXG4gICAgdGhpcy54ID0gYXggKiBzO1xuICAgIHRoaXMueSA9IGF5ICogcztcbiAgICB0aGlzLnogPSBheiAqIHM7XG4gICAgdGhpcy53ID0gZHNxICogMC41O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbUF4aXNBbmdsZVxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogc2V0cyBxdWF0IGZyb20gYXhpcyBhbmQgYW5nbGVcbiAqIEBwYXJhbSBWZWMzIGF4aXNcbiAqIEBwYXJhbSBOdW1iZXIgYW5nbGVcbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5mcm9tQXhpc0FuZ2xlID0gZnVuY3Rpb24gKGF4aXMsIGFuZ2xlKSB7XG4gICAgdmFyIGhhbGZBbmdsZSA9IGFuZ2xlICogMC41LFxuICAgICAgICBzID0gc2luKGhhbGZBbmdsZSk7XG5cbiAgICB0aGlzLnggPSBheGlzLnggKiBzO1xuICAgIHRoaXMueSA9IGF4aXMueSAqIHM7XG4gICAgdGhpcy56ID0gYXhpcy56ICogcztcbiAgICB0aGlzLncgPSBjb3MoaGFsZkFuZ2xlKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21WZWMzc1xuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogc2V0cyBxdWF0IGZyb20gdHdvIHZlY3RvcnNcbiAqIEBwYXJhbSBWZWMzIHVcbiAqIEBwYXJhbSBWZWMzIHZcbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5mcm9tVmVjM3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGEgPSBuZXcgVmVjMztcblxuICAgIHJldHVybiBmdW5jdGlvbiAodSwgdikge1xuICAgICAgICBhLnZjcm9zcyh1LCB2KTtcblxuICAgICAgICB0aGlzLnggPSBhLng7XG4gICAgICAgIHRoaXMueSA9IGEueTtcbiAgICAgICAgdGhpcy56ID0gYS56O1xuICAgICAgICB0aGlzLncgPSBzcXJ0KHUubGVuZ3RoU3EoKSAqIHYubGVuZ3RoU3EoKSkgKyB1LmRvdCh2KTtcblxuICAgICAgICByZXR1cm4gdGhpcy5ub3JtYWxpemUoKTtcbiAgICB9O1xufSgpO1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbU1hdDNcbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIHNldHMgdmFsdWVzIGZyb20gTWF0M1xuICogQHBhcmFtIE1hdDMgbVxuICogQHJldHVybiB0aGlzXG4gKi9cblF1YXQucHJvdG90eXBlLmZyb21NYXQzID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgdGUgPSBtLmVsZW1lbnRzLFxuICAgICAgICBtMTEgPSB0ZVswXSxcbiAgICAgICAgbTEyID0gdGVbM10sXG4gICAgICAgIG0xMyA9IHRlWzZdLFxuICAgICAgICBtMjEgPSB0ZVsxXSxcbiAgICAgICAgbTIyID0gdGVbNF0sXG4gICAgICAgIG0yMyA9IHRlWzddLFxuICAgICAgICBtMzEgPSB0ZVsyXSxcbiAgICAgICAgbTMyID0gdGVbNV0sXG4gICAgICAgIG0zMyA9IHRlWzhdLFxuICAgICAgICB0cmFjZSA9IG0xMSArIG0yMiArIG0zMyxcbiAgICAgICAgcywgaW52UztcblxuICAgIGlmICh0cmFjZSA+IDAuMCkge1xuICAgICAgICBzID0gMC41IC8gc3FydCh0cmFjZSArIDEuMCk7XG5cbiAgICAgICAgdGhpcy53ID0gMC4yNSAvIHM7XG4gICAgICAgIHRoaXMueCA9IChtMzIgLSBtMjMpICogcztcbiAgICAgICAgdGhpcy55ID0gKG0xMyAtIG0zMSkgKiBzO1xuICAgICAgICB0aGlzLnogPSAobTIxIC0gbTEyKSAqIHM7XG4gICAgfSBlbHNlIGlmIChtMTEgPiBtMjIgJiYgbTExID4gbTMzKSB7XG4gICAgICAgIHMgPSAyLjAgKiBzcXJ0KDEuMCArIG0xMSAtIG0yMiAtIG0zMyk7XG4gICAgICAgIGludlMgPSAxLjAgLyBzO1xuXG4gICAgICAgIHRoaXMudyA9IChtMzIgLSBtMjMpICogaW52UztcbiAgICAgICAgdGhpcy54ID0gMC4yNSAqIHM7XG4gICAgICAgIHRoaXMueSA9IChtMTIgKyBtMjEpICogaW52UztcbiAgICAgICAgdGhpcy56ID0gKG0xMyArIG0zMSkgKiBpbnZTO1xuICAgIH0gZWxzZSBpZiAobTIyID4gbTMzKSB7XG4gICAgICAgIHMgPSAyLjAgKiBzcXJ0KDEuMCArIG0yMiAtIG0xMSAtIG0zMyk7XG4gICAgICAgIGludlMgPSAxLjAgLyBzO1xuXG4gICAgICAgIHRoaXMudyA9IChtMTMgLSBtMzEpICogaW52UztcbiAgICAgICAgdGhpcy54ID0gKG0xMiArIG0yMSkgKiBpbnZTO1xuICAgICAgICB0aGlzLnkgPSAwLjI1ICogcztcbiAgICAgICAgdGhpcy56ID0gKG0yMyArIG0zMikgKiBpbnZTO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHMgPSAyLjAgKiBzcXJ0KDEuMCArIG0zMyAtIG0xMSAtIG0yMik7XG4gICAgICAgIGludlMgPSAxLjAgLyBzO1xuXG4gICAgICAgIHRoaXMudyA9IChtMjEgLSBtMTIpICogaW52UztcbiAgICAgICAgdGhpcy54ID0gKG0xMyArIG0zMSkgKiBpbnZTO1xuICAgICAgICB0aGlzLnkgPSAobTIzICsgbTMyKSAqIGludlM7XG4gICAgICAgIHRoaXMueiA9IDAuMjUgKiBzO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21NYXQ0XG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiBzZXRzIHZhbHVlcyBmcm9tIE1hdDRcbiAqIEBwYXJhbSBNYXQ0IG1cbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5mcm9tTWF0NCA9IGZ1bmN0aW9uIChtKSB7XG4gICAgdmFyIHRlID0gbS5lbGVtZW50cyxcbiAgICAgICAgbTExID0gdGVbMF0sXG4gICAgICAgIG0xMiA9IHRlWzRdLFxuICAgICAgICBtMTMgPSB0ZVs4XSxcbiAgICAgICAgbTIxID0gdGVbMV0sXG4gICAgICAgIG0yMiA9IHRlWzVdLFxuICAgICAgICBtMjMgPSB0ZVs5XSxcbiAgICAgICAgbTMxID0gdGVbMl0sXG4gICAgICAgIG0zMiA9IHRlWzZdLFxuICAgICAgICBtMzMgPSB0ZVsxMF0sXG4gICAgICAgIHRyYWNlID0gbTExICsgbTIyICsgbTMzLFxuICAgICAgICBzLCBpbnZTO1xuXG4gICAgaWYgKHRyYWNlID4gMC4wKSB7XG4gICAgICAgIHMgPSAwLjUgLyBzcXJ0KHRyYWNlICsgMSk7XG5cbiAgICAgICAgdGhpcy53ID0gMC4yNSAvIHM7XG4gICAgICAgIHRoaXMueCA9IChtMzIgLSBtMjMpICogcztcbiAgICAgICAgdGhpcy55ID0gKG0xMyAtIG0zMSkgKiBzO1xuICAgICAgICB0aGlzLnogPSAobTIxIC0gbTEyKSAqIHM7XG4gICAgfSBlbHNlIGlmIChtMTEgPiBtMjIgJiYgbTExID4gbTMzKSB7XG4gICAgICAgIHMgPSAyLjAgKiBzcXJ0KDEuMCArIG0xMSAtIG0yMiAtIG0zMyk7XG4gICAgICAgIGludlMgPSAxLjAgLyBzO1xuXG4gICAgICAgIHRoaXMudyA9IChtMzIgLSBtMjMpICogaW52UztcbiAgICAgICAgdGhpcy54ID0gMC4yNSAqIHM7XG4gICAgICAgIHRoaXMueSA9IChtMTIgKyBtMjEpICogaW52UztcbiAgICAgICAgdGhpcy56ID0gKG0xMyArIG0zMSkgKiBpbnZTO1xuICAgIH0gZWxzZSBpZiAobTIyID4gbTMzKSB7XG4gICAgICAgIHMgPSAyLjAgKiBzcXJ0KDEuMCArIG0yMiAtIG0xMSAtIG0zMyk7XG4gICAgICAgIGludlMgPSAxLjAgLyBzO1xuXG4gICAgICAgIHRoaXMudyA9IChtMTMgLSBtMzEpICogaW52UztcbiAgICAgICAgdGhpcy54ID0gKG0xMiArIG0yMSkgKiBpbnZTO1xuICAgICAgICB0aGlzLnkgPSAwLjI1ICogcztcbiAgICAgICAgdGhpcy56ID0gKG0yMyArIG0zMikgKiBpbnZTO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHMgPSAyLjAgKiBzcXJ0KDEuMCArIG0zMyAtIG0xMSAtIG0yMik7XG4gICAgICAgIGludlMgPSAxLjAgLyBzO1xuXG4gICAgICAgIHRoaXMudyA9IChtMjEgLSBtMTIpICogaW52UztcbiAgICAgICAgdGhpcy54ID0gKG0xMyArIG0zMSkgKiBpbnZTO1xuICAgICAgICB0aGlzLnkgPSAobTIzICsgbTMyKSAqIGludlM7XG4gICAgICAgIHRoaXMueiA9IDAuMjUgKiBzO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21BcnJheVxuICogQG1lbWJlcm9mIE9kaW4uUXVhdFxuICogc2V0cyB2YWx1ZXMgZnJvbSBhcnJheVxuICogQHBhcmFtIEFycmF5IGFycmF5XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUuZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFycmF5KSB7XG5cbiAgICB0aGlzLnggPSBhcnJheVswXTtcbiAgICB0aGlzLnkgPSBhcnJheVsxXTtcbiAgICB0aGlzLnogPSBhcnJheVsyXTtcbiAgICB0aGlzLncgPSBhcnJheVszXTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiBAcGFyYW0gT2Rpbi5RdWF0IG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuUXVhdC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICByZXR1cm4gIShcbiAgICB0aGlzLnggIT09IG90aGVyLnggfHxcbiAgICB0aGlzLnkgIT09IG90aGVyLnkgfHxcbiAgICB0aGlzLnogIT09IG90aGVyLnogfHxcbiAgICB0aGlzLncgIT09IG90aGVyLndcbiAgICApO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21KU09OXG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiBzZXRzIHZhbHVlcyBmcm9tIEpTT04gb2JqZWN0XG4gKiBAcGFyYW0gT2JqZWN0IGpzb25cbiAqIEByZXR1cm4gdGhpc1xuICovXG5RdWF0LnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG5cbiAgICB0aGlzLnggPSBqc29uLng7XG4gICAgdGhpcy55ID0ganNvbi55O1xuICAgIHRoaXMueiA9IGpzb24uejtcbiAgICB0aGlzLncgPSBqc29uLnc7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b0FycmF5XG4gKiBAbWVtYmVyb2YgT2Rpbi5RdWF0XG4gKiByZXR1cm5zIGFycmF5IG9mIHRoaXNcbiAqIEByZXR1cm4gT2JqZWN0XG4gKi9cblF1YXQucHJvdG90eXBlLnRvQXJyYXkgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICBhcnJheSB8fCAoYXJyYXkgPSBbXSk7XG5cbiAgICBhcnJheVswXSA9IHRoaXMueDtcbiAgICBhcnJheVsxXSA9IHRoaXMueTtcbiAgICBhcnJheVsyXSA9IHRoaXMuejtcbiAgICBhcnJheVszXSA9IHRoaXMudztcblxuICAgIHJldHVybiBhcnJheTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b0pTT05cbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIHJldHVybnMganNvbiBvYmplY3Qgb2YgdGhpc1xuICogQHJldHVybiBPYmplY3RcbiAqL1xuUXVhdC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0ge30pO1xuXG4gICAganNvbi5fY2xhc3NOYW1lID0gXCJRdWF0XCI7XG4gICAganNvbi54ID0gdGhpcy54O1xuICAgIGpzb24ueSA9IHRoaXMueTtcbiAgICBqc29uLnogPSB0aGlzLno7XG4gICAganNvbi53ID0gdGhpcy53O1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdG9TdHJpbmdcbiAqIEBtZW1iZXJvZiBPZGluLlF1YXRcbiAqIHJldHVybnMgc3RyaW5nIG9mIHRoaXNcbiAqIEByZXR1cm4gU3RyaW5nXG4gKi9cblF1YXQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIFwiUXVhdCggXCIgKyB0aGlzLnggKyBcIiwgXCIgKyB0aGlzLnkgKyBcIiwgXCIgKyB0aGlzLnogKyBcIiwgXCIgKyB0aGlzLncgKyBcIiApXCI7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUXVhdDtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcblxuXG5mdW5jdGlvbiBSZWN0KHgsIHksIHdpZHRoLCBoZWlnaHQpIHtcblxuICAgIHRoaXMuX3ggPSB4IHx8IDAuMDtcbiAgICB0aGlzLl95ID0geSB8fCAwLjA7XG4gICAgdGhpcy5fd2lkdGggPSB3aWR0aCB8fCAwLjA7XG4gICAgdGhpcy5faGVpZ2h0ID0gaGVpZ2h0IHx8IDAuMDtcblxuICAgIHRoaXMuX3hNaW4gPSB0aGlzLl94O1xuICAgIHRoaXMuX3hNYXggPSB0aGlzLl94ICsgdGhpcy5fd2lkdGg7XG4gICAgdGhpcy5feU1pbiA9IHRoaXMuX3k7XG4gICAgdGhpcy5feU1heCA9IHRoaXMuX3kgKyB0aGlzLl9oZWlnaHQ7XG59XG5cbmRlZmluZVByb3BlcnR5KFJlY3QucHJvdG90eXBlLCBcInhcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5feDtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3ggPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5feE1pbiA9IHZhbHVlO1xuICAgICAgICB0aGlzLl94TWF4ID0gdmFsdWUgKyB0aGlzLl93aWR0aDtcbiAgICB9XG59KTtcbmRlZmluZVByb3BlcnR5KFJlY3QucHJvdG90eXBlLCBcInlcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5feTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3kgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5feU1pbiA9IHZhbHVlO1xuICAgICAgICB0aGlzLl95TWF4ID0gdmFsdWUgKyB0aGlzLl9oZWlnaHQ7XG4gICAgfVxufSk7XG5kZWZpbmVQcm9wZXJ0eShSZWN0LnByb3RvdHlwZSwgXCJ3aWR0aFwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl93aWR0aDtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3dpZHRoID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX3hNYXggPSB0aGlzLl94TWluICsgdmFsdWU7XG4gICAgfVxufSk7XG5kZWZpbmVQcm9wZXJ0eShSZWN0LnByb3RvdHlwZSwgXCJoZWlnaHRcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faGVpZ2h0O1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5faGVpZ2h0ID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX3lNYXggPSB0aGlzLl95TWluICsgdmFsdWU7XG4gICAgfVxufSk7XG5kZWZpbmVQcm9wZXJ0eShSZWN0LnByb3RvdHlwZSwgXCJ4TWluXCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3hNaW47XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl94TWluID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX3ggPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5fd2lkdGggPSB0aGlzLl94TWF4IC0gdGhpcy5feE1pbjtcbiAgICAgICAgdGhpcy5feE1heCA9IHZhbHVlICsgdGhpcy5fd2lkdGg7XG4gICAgfVxufSk7XG5kZWZpbmVQcm9wZXJ0eShSZWN0LnByb3RvdHlwZSwgXCJ4TWF4XCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3hNYXg7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl94TWF4ID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX3dpZHRoID0gdmFsdWUgLSB0aGlzLl94TWluO1xuICAgIH1cbn0pO1xuZGVmaW5lUHJvcGVydHkoUmVjdC5wcm90b3R5cGUsIFwieU1pblwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl95TWluO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5feU1pbiA9IHZhbHVlO1xuICAgICAgICB0aGlzLl95ID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX2hlaWdodCA9IHRoaXMuX3lNYXggLSB0aGlzLl95TWluO1xuICAgICAgICB0aGlzLl95TWF4ID0gdmFsdWUgKyB0aGlzLl9oZWlnaHQ7XG4gICAgfVxufSk7XG5kZWZpbmVQcm9wZXJ0eShSZWN0LnByb3RvdHlwZSwgXCJ5TWF4XCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3lNYXg7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl95TWF4ID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX2hlaWdodCA9IHZhbHVlIC0gdGhpcy5feU1pbjtcbiAgICB9XG59KTtcbmRlZmluZVByb3BlcnR5KFJlY3QucHJvdG90eXBlLCBcInpcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy53aWR0aDtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMud2lkdGggPSB2YWx1ZTtcbiAgICB9XG59KTtcbmRlZmluZVByb3BlcnR5KFJlY3QucHJvdG90eXBlLCBcIndcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmhlaWdodCA9IHZhbHVlO1xuICAgIH1cbn0pO1xuXG5cblJlY3QucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIG5ldyBSZWN0KHRoaXMueCwgdGhpcy55LCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG59O1xuXG5cblJlY3QucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMuX3ggPSBvdGhlci5feDtcbiAgICB0aGlzLl95ID0gb3RoZXIuX3k7XG4gICAgdGhpcy5fd2lkdGggPSBvdGhlci5fd2lkdGg7XG4gICAgdGhpcy5faGVpZ2h0ID0gb3RoZXIuX2hlaWdodDtcblxuICAgIHRoaXMuX3hNaW4gPSBvdGhlci5feE1pbjtcbiAgICB0aGlzLl94TWF4ID0gb3RoZXIuX3hNYXg7XG4gICAgdGhpcy5feU1pbiA9IG90aGVyLl95TWluO1xuICAgIHRoaXMuX3lNYXggPSBvdGhlci5feU1heDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5SZWN0LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuXG4gICAgdGhpcy54ID0geDtcbiAgICB0aGlzLnkgPSB5O1xuICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5SZWN0LnByb3RvdHlwZS5jZW50ZXIgPSBmdW5jdGlvbiAodikge1xuXG4gICAgdi54ID0gdGhpcy5feCArIHRoaXMuX3dpZHRoICogMC41O1xuICAgIHYueSA9IHRoaXMuX3kgKyB0aGlzLl9oZWlnaHQgKiAwLjU7XG5cbiAgICByZXR1cm4gdjtcbn07XG5cblxuUmVjdC5wcm90b3R5cGUuaW50ZXJzZWN0cyA9IGZ1bmN0aW9uIChyZWN0KSB7XG5cbiAgICByZXR1cm4gIShcbiAgICByZWN0Ll94TWF4IDwgdGhpcy5feE1pbiB8fCByZWN0Ll94TWluID4gdGhpcy5feE1heCB8fFxuICAgIHJlY3QuX3lNYXggPCB0aGlzLl95TWluIHx8IHJlY3QuX3lNaW4gPiB0aGlzLl95TWF4XG4gICAgKTtcbn07XG5cblxuUmVjdC5wcm90b3R5cGUuY29udGFpbnMgPSBmdW5jdGlvbiAocG9pbnQpIHtcbiAgICB2YXIgeCA9IHBvaW50LngsXG4gICAgICAgIHkgPSBwb2ludC55O1xuXG4gICAgcmV0dXJuICEoXG4gICAgeCA8IHRoaXMuX3hNaW4gfHwgeCA+IHRoaXMuX3hNYXggfHxcbiAgICB5IDwgdGhpcy5feU1pbiB8fCB5ID4gdGhpcy5feU1heFxuICAgICk7XG59O1xuXG5cblJlY3QucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiB8fCAoanNvbiA9IHt9KTtcblxuICAgIGpzb24ueCA9IHRoaXMuX3g7XG4gICAganNvbi55ID0gdGhpcy5feTtcbiAgICBqc29uLndpZHRoID0gdGhpcy5fd2lkdGg7XG4gICAganNvbi5oZWlnaHQgPSB0aGlzLl9oZWlnaHQ7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuUmVjdC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuXG4gICAgdGhpcy54ID0ganNvbi54O1xuICAgIHRoaXMueSA9IGpzb24ueTtcbiAgICB0aGlzLndpZHRoID0ganNvbi53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IGpzb24uaGVpZ2h0O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblJlY3QucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIFwiUmVjdCggXCIgKyB0aGlzLl94ICsgXCIsIFwiICsgdGhpcy5feSArIFwiLCBcIiArIHRoaXMuX3dpZHRoICsgXCIsIFwiICsgdGhpcy5faGVpZ2h0ICsgXCIgKVwiO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFJlY3Q7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuXG52YXIgZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG5cblxuZnVuY3Rpb24gUmVjdE9mZnNldChsZWZ0LCByaWdodCwgdG9wLCBib3R0b20pIHtcblxuICAgIHRoaXMubGVmdCA9IGxlZnQgfHwgMC4wO1xuICAgIHRoaXMucmlnaHQgPSByaWdodCB8fCAwLjA7XG4gICAgdGhpcy50b3AgPSB0b3AgfHwgMC4wO1xuICAgIHRoaXMuYm90dG9tID0gYm90dG9tIHx8IDAuMDtcbn1cblxuXG5kZWZpbmVQcm9wZXJ0eShSZWN0T2Zmc2V0LnByb3RvdHlwZSwgXCJob3Jpem9udGFsXCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0ICsgdGhpcy5yaWdodDtcbiAgICB9XG59KTtcblxuXG5kZWZpbmVQcm9wZXJ0eShSZWN0T2Zmc2V0LnByb3RvdHlwZSwgXCJ2ZXJ0aWNhbFwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMudG9wICsgdGhpcy5ib3R0b207XG4gICAgfVxufSk7XG5cblxuUmVjdE9mZnNldC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gbmV3IFJlY3RPZmZzZXQodGhpcy5sZWZ0LCB0aGlzLnJpZ2h0LCB0aGlzLnRvcCwgdGhpcy5ib3R0b20pO1xufTtcblxuXG5SZWN0T2Zmc2V0LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICB0aGlzLmxlZnQgPSBvdGhlci5sZWZ0O1xuICAgIHRoaXMucmlnaHQgPSBvdGhlci5yaWdodDtcbiAgICB0aGlzLnRvcCA9IG90aGVyLnRvcDtcbiAgICB0aGlzLmJvdHRvbSA9IG90aGVyLmJvdHRvbTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5SZWN0T2Zmc2V0LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQsIHRvcCwgYm90dG9tKSB7XG5cbiAgICB0aGlzLmxlZnQgPSBsZWZ0O1xuICAgIHRoaXMucmlnaHQgPSByaWdodDtcbiAgICB0aGlzLnRvcCA9IHRvcDtcbiAgICB0aGlzLmJvdHRvbSA9IGJvdHRvbTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5SZWN0T2Zmc2V0LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAocmVjdCkge1xuXG4gICAgcmVjdC54TWluIC09IHRoaXMubGVmdDtcbiAgICByZWN0LnhNYXggKz0gdGhpcy5yaWdodDtcbiAgICByZWN0LnlNaW4gLT0gdGhpcy50b3A7XG4gICAgcmVjdC55TWF4ICs9IHRoaXMuYm90dG9tO1xuXG4gICAgcmV0dXJuIHJlY3Q7XG59O1xuXG5cblJlY3RPZmZzZXQucHJvdG90eXBlLnN1YiA9IGZ1bmN0aW9uIChyZWN0KSB7XG5cbiAgICByZWN0LnhNaW4gKz0gdGhpcy5sZWZ0O1xuICAgIHJlY3QueE1heCAtPSB0aGlzLnJpZ2h0O1xuICAgIHJlY3QueU1pbiArPSB0aGlzLnRvcDtcbiAgICByZWN0LnlNYXggLT0gdGhpcy5ib3R0b207XG5cbiAgICByZXR1cm4gcmVjdDtcbn07XG5cblxuUmVjdE9mZnNldC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0ge30pO1xuXG4gICAganNvbi5sZWZ0ID0gdGhpcy5sZWZ0O1xuICAgIGpzb24ucmlnaHQgPSB0aGlzLnJpZ2h0O1xuICAgIGpzb24udG9wID0gdGhpcy50b3A7XG4gICAganNvbi5ib3R0b20gPSB0aGlzLmJvdHRvbTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5SZWN0T2Zmc2V0LnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG5cbiAgICB0aGlzLmxlZnQgPSBqc29uLmxlZnQ7XG4gICAgdGhpcy5yaWdodCA9IGpzb24ucmlnaHQ7XG4gICAgdGhpcy50b3AgPSBqc29uLnRvcDtcbiAgICB0aGlzLmJvdHRvbSA9IGpzb24uYm90dG9tO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblJlY3RPZmZzZXQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIFwiUmVjdE9mZnNldCggXCIgKyB0aGlzLmxlZnQgKyBcIiwgXCIgKyB0aGlzLnJpZ2h0ICsgXCIsIFwiICsgdGhpcy50b3AgKyBcIiwgXCIgKyB0aGlzLmJvdHRvbSArIFwiIClcIjtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBSZWN0T2Zmc2V0O1xuIiwidmFyIE1hdGhmID0gcmVxdWlyZShcIi4vbWF0aGZcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgc3FydCA9IE1hdGguc3FydDtcblxuLyoqXG4gKiBAY2xhc3MgVmVjMlxuICogMmQgdmVjdG9yXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEBwYXJhbSBOdW1iZXIgeVxuICovXG5mdW5jdGlvbiBWZWMyKHgsIHkpIHtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBOdW1iZXIgeFxuICAgICAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAgICAgKi9cbiAgICB0aGlzLnggPSB4IHx8IDAuMDtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBOdW1iZXIgeVxuICAgICAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAgICAgKi9cbiAgICB0aGlzLnkgPSB5IHx8IDAuMDtcbn1cblxuTWF0aGYuX2NsYXNzZXNbXCJWZWMyXCJdID0gVmVjMjtcblxuLyoqXG4gKiBAbWV0aG9kIGNsb25lXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiByZXR1cm5zIG5ldyBpbnN0YW5jZSBvZiB0aGlzXG4gKiBAcmV0dXJuIFZlYzJcbiAqL1xuVmVjMi5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gbmV3IFZlYzIodGhpcy54LCB0aGlzLnkpO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNvcHlcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIGNvcGllcyBvdGhlclxuICogQHBhcmFtIFZlYzIgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICB0aGlzLnggPSBvdGhlci54O1xuICAgIHRoaXMueSA9IG90aGVyLnk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZXRcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHNldHMgdmFsdWVzIG9mIHRoaXNcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHBhcmFtIE51bWJlciB5XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHgsIHkpIHtcblxuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGFkZFxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogYWRkcyBvdGhlcidzIHZhbHVlcyB0byB0aGlzXG4gKiBAcGFyYW0gVmVjMiBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy54ICs9IG90aGVyLng7XG4gICAgdGhpcy55ICs9IG90aGVyLnk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB2YWRkXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiBhZGRzIGEgYW5kIGIgdG9nZXRoZXIgc2F2ZXMgaXQgaW4gdGhpc1xuICogQHBhcmFtIFZlYzIgYVxuICogQHBhcmFtIFZlYzIgYlxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzIucHJvdG90eXBlLnZhZGQgPSBmdW5jdGlvbiAoYSwgYikge1xuXG4gICAgdGhpcy54ID0gYS54ICsgYi54O1xuICAgIHRoaXMueSA9IGEueSArIGIueTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNhZGRcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIGFkZHMgc2NhbGFyIHZhbHVlIHRvIHRoaXNcbiAqIEBwYXJhbSBOdW1iZXIgc1xuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzIucHJvdG90eXBlLnNhZGQgPSBmdW5jdGlvbiAocykge1xuXG4gICAgdGhpcy54ICs9IHM7XG4gICAgdGhpcy55ICs9IHM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzdWJcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHN1YnRyYWN0cyBvdGhlcidzIHZhbHVlcyBmcm9tIHRoaXNcbiAqIEBwYXJhbSBWZWMyIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUuc3ViID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICB0aGlzLnggLT0gb3RoZXIueDtcbiAgICB0aGlzLnkgLT0gb3RoZXIueTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHZzdWJcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHN1YnRyYWN0cyBiIGZyb20gYSBzYXZlcyBpdCBpbiB0aGlzXG4gKiBAcGFyYW0gVmVjMiBhXG4gKiBAcGFyYW0gVmVjMiBiXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUudnN1YiA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cbiAgICB0aGlzLnggPSBhLnggLSBiLng7XG4gICAgdGhpcy55ID0gYS55IC0gYi55O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc3N1YlxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogc3VidHJhY3RzIHRoaXMgYnkgYSBzY2FsYXIgdmFsdWVcbiAqIEBwYXJhbSBOdW1iZXIgc1xuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzIucHJvdG90eXBlLnNzdWIgPSBmdW5jdGlvbiAocykge1xuXG4gICAgdGhpcy54IC09IHM7XG4gICAgdGhpcy55IC09IHM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtdWxcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIG11bGlwbGVzIHRoaXMncyB2YWx1ZXMgYnkgb3RoZXInc1xuICogQHBhcmFtIFZlYzIgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS5tdWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMueCAqPSBvdGhlci54O1xuICAgIHRoaXMueSAqPSBvdGhlci55O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgdm11bFxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogbXVsaXBsZXMgYSBhbmQgYiBzYXZlcyBpdCBpbiB0aGlzXG4gKiBAcGFyYW0gVmVjMiBhXG4gKiBAcGFyYW0gVmVjMiBiXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUudm11bCA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cbiAgICB0aGlzLnggPSBhLnggKiBiLng7XG4gICAgdGhpcy55ID0gYS55ICogYi55O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc211bFxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogbXVsaXBsZXMgdGhpcyBieSBhIHNjYWxhciB2YWx1ZVxuICogQHBhcmFtIE51bWJlciBzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUuc211bCA9IGZ1bmN0aW9uIChzKSB7XG5cbiAgICB0aGlzLnggKj0gcztcbiAgICB0aGlzLnkgKj0gcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGRpdlxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogZGl2aWRlcyB0aGlzJ3MgdmFsdWVzIGJ5IG90aGVyJ3NcbiAqIEBwYXJhbSBWZWMyIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUuZGl2ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIHggPSBvdGhlci54LFxuICAgICAgICB5ID0gb3RoZXIueTtcblxuICAgIHRoaXMueCAqPSB4ICE9PSAwLjAgPyAxLjAgLyB4IDogMC4wO1xuICAgIHRoaXMueSAqPSB5ICE9PSAwLjAgPyAxLjAgLyB5IDogMC4wO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdmRpdlxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogZGl2aWRlcyBiIGZyb20gYSBzYXZlcyBpdCBpbiB0aGlzXG4gKiBAcGFyYW0gVmVjMiBhXG4gKiBAcGFyYW0gVmVjMiBiXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUudmRpdiA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgdmFyIHggPSBiLngsXG4gICAgICAgIHkgPSBiLnk7XG5cbiAgICB0aGlzLnggPSB4ICE9PSAwLjAgPyBhLnggLyB4IDogMC4wO1xuICAgIHRoaXMueSA9IHkgIT09IDAuMCA/IGEueSAvIHkgOiAwLjA7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZGl2XG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiBkaXZpZGVzIHRoaXMgYnkgc2NhbGFyIHZhbHVlXG4gKiBAcGFyYW0gTnVtYmVyIHNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS5zZGl2ID0gZnVuY3Rpb24gKHMpIHtcbiAgICBzID0gcyA9PT0gMC4wID8gMC4wIDogMS4wIC8gcztcblxuICAgIHRoaXMueCAqPSBzO1xuICAgIHRoaXMueSAqPSBzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbGVuZ3RoXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiByZXR1cm5zIHRoZSBsZW5ndGggb2YgdGhpc1xuICogQHJldHVybiBOdW1iZXJcbiAqL1xuVmVjMi5wcm90b3R5cGUubGVuZ3RoID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICBsc3EgPSB4ICogeCArIHkgKiB5O1xuXG4gICAgaWYgKGxzcSA9PT0gMSkgcmV0dXJuIDE7XG5cbiAgICByZXR1cm4gbHNxID4gMC4wID8gc3FydChsc3EpIDogMC4wO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGxlbmd0aFNxXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiByZXR1cm5zIHRoZSBzcXVhcmVkIGxlbmd0aCBvZiB0aGlzXG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5WZWMyLnByb3RvdHlwZS5sZW5ndGhTcSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgeCA9IHRoaXMueCxcbiAgICAgICAgeSA9IHRoaXMueTtcblxuICAgIHJldHVybiB4ICogeCArIHkgKiB5O1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNldExlbmd0aFxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogc2V0cyB0aGlzIHNvIGl0cyBtYWduaXR1ZGUgaXMgZXF1YWwgdG8gbGVuZ3RoXG4gKiBAcGFyYW0gTnVtYmVyIGxlbmd0aFxuICogQHJldHVybiBWZWMyXG4gKi9cblZlYzIucHJvdG90eXBlLnNldExlbmd0aCA9IGZ1bmN0aW9uIChsZW5ndGgpIHtcbiAgICB2YXIgeCA9IHRoaXMueCxcbiAgICAgICAgeSA9IHRoaXMueSxcbiAgICAgICAgbCA9IHggKiB4ICsgeSAqIHk7XG5cbiAgICBpZiAobCA9PT0gMSkge1xuICAgICAgICB0aGlzLnggKj0gbGVuZ3RoO1xuICAgICAgICB0aGlzLnkgKj0gbGVuZ3RoO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGwgPSBsID4gMC4wID8gMS4wIC8gc3FydChsKSA6IDAuMDtcblxuICAgIHRoaXMueCAqPSBsICogbGVuZ3RoO1xuICAgIHRoaXMueSAqPSBsICogbGVuZ3RoO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgbm9ybWFsaXplXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiByZXR1cm5zIHRoaXMgd2l0aCBhIGxlbmd0aCBvZiAxXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUubm9ybWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICBsID0geCAqIHggKyB5ICogeTtcblxuICAgIGlmIChsID09PSAxKSByZXR1cm4gdGhpcztcblxuICAgIGwgPSBsID4gMC4wID8gMS4wIC8gc3FydChsKSA6IDAuMDtcblxuICAgIHRoaXMueCAqPSBsO1xuICAgIHRoaXMueSAqPSBsO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgb3J0aG9Ob3JtYWxpemVcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHJldHVybnMgbWFrZXMgdmVjdG9ycyBub3JtYWxpemVkIGFuZCBvcnRob2dvbmFsIHRvIGVhY2ggb3RoZXJcbiAqIEBwYXJhbSBWZWMyIGFcbiAqIEBwYXJhbSBWZWMyIGJcbiAqIEBwYXJhbSBWZWMyIGNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS5vcnRob05vcm1hbGl6ZSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgaWYgKGEubGVuZ3RoU3EoKSAhPT0gMS4wKSBhLm5vcm1hbGl6ZSgpO1xuICAgIGMudmNyb3NzKGEsIGIpO1xuICAgIGlmIChhLmxlbmd0aFNxKCkgPT09IDAuMCkgcmV0dXJuO1xuICAgIGMubm9ybWFsaXplKCk7XG4gICAgYi52Y3Jvc3MoYywgYSk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgaW52ZXJzZVxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogcmV0dXJucyB0aGUgaW52ZXJzZSBvZiB0aGlzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUuaW52ZXJzZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMueCAqPSAtMTtcbiAgICB0aGlzLnkgKj0gLTE7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBpbnZlcnNlVmVjXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiByZXR1cm5zIHRoZSBpbnZlcnNlIG9mIG90aGVyXG4gKiBAcGFyYW0gVmVjMiBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzIucHJvdG90eXBlLmludmVyc2VWZWMgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMueCA9IC1vdGhlci54O1xuICAgIHRoaXMueSA9IC1vdGhlci55O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbGVycFxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiB0aGlzIGFuZCBvdGhlciBieSB4XG4gKiBAcGFyYW0gVmVjMiBvdGhlclxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcmV0dXJuIFZlYzJcbiAqL1xuVmVjMi5wcm90b3R5cGUubGVycCA9IGZ1bmN0aW9uIChvdGhlciwgeCkge1xuXG4gICAgdGhpcy54ICs9IChvdGhlci54IC0gdGhpcy54KSAqIHg7XG4gICAgdGhpcy55ICs9IChvdGhlci55IC0gdGhpcy55KSAqIHg7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB2bGVycFxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiBhIGFuZCBiIGJ5IHhcbiAqIEBwYXJhbSBWZWMyIGFcbiAqIEBwYXJhbSBWZWMyIGJcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHJldHVybiBWZWMyXG4gKi9cblZlYzIucHJvdG90eXBlLnZsZXJwID0gZnVuY3Rpb24gKGEsIGIsIHgpIHtcbiAgICB2YXIgYXggPSBhLngsXG4gICAgICAgIGF5ID0gYS55O1xuXG4gICAgdGhpcy54ID0gYXggKyAoYi54IC0gYXgpICogeDtcbiAgICB0aGlzLnkgPSBheSArIChiLnkgLSBheSkgKiB4O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdmRvdFxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogZG90IHByb2R1Y3Qgb2YgdHdvIHZlY3RvcnMsIGNhbiBiZSBjYWxsZWQgYXMgYSBzdGF0aWMgZnVuY3Rpb24gVmVjMi52ZG90KCBhLCBiIClcbiAqIEBwYXJhbSBWZWMyIGFcbiAqIEBwYXJhbSBWZWMyIGJcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cblZlYzIudmRvdCA9IFZlYzIucHJvdG90eXBlLnZkb3QgPSBmdW5jdGlvbiAoYSwgYikge1xuXG4gICAgcmV0dXJuIGEueCAqIGIueCArIGEueSAqIGIueTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBkb3RcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIGRvdCBwcm9kdWN0IG9mIHRoaXMgYW5kIG90aGVyIHZlY3RvclxuICogQHBhcmFtIFZlYzIgb3RoZXJcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cblZlYzIucHJvdG90eXBlLmRvdCA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgcmV0dXJuIHRoaXMueCAqIG90aGVyLnggKyB0aGlzLnkgKiBvdGhlci55O1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHZjcm9zc1xuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogY3Jvc3MgcHJvZHVjdCBiZXR3ZWVuIGEgdmVjdG9yIGFuZCBiIHZlY3RvciwgY2FuIGJlIGNhbGxlZCBhcyBhIHN0YXRpYyBmdW5jdGlvbiBWZWMyLnZjcm9zcyggYSwgYiApXG4gKiBAcGFyYW0gVmVjMiBhXG4gKiBAcGFyYW0gVmVjMiBiXG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5WZWMyLnZjcm9zcyA9IFZlYzIucHJvdG90eXBlLnZjcm9zcyA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cbiAgICByZXR1cm4gYS54ICogYi55IC0gYS55ICogYi54O1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNyb3NzXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdGhpcyB2ZWN0b3IgYW5kIG90aGVyXG4gKiBAcGFyYW0gVmVjMiBvdGhlclxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuVmVjMi5wcm90b3R5cGUuY3Jvc3MgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHJldHVybiB0aGlzLnggKiBvdGhlci55IC0gdGhpcy55ICogb3RoZXIueDtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBwZXJwXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiBAcGFyYW0gVmVjMiBvdGhlclxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuVmVjMi5wcm90b3R5cGUucGVycCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgeCA9IHRoaXMueCxcbiAgICAgICAgeSA9IHRoaXMueTtcblxuICAgIHRoaXMueCA9IC15O1xuICAgIHRoaXMueSA9IHg7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtaW5cbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHJldHVybnMgbWluIHZhbHVlcyBmcm9tIHRoaXMgYW5kIG90aGVyIHZlY3RvclxuICogQHBhcmFtIFZlYzIgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS5taW4gPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYXggPSB0aGlzLngsXG4gICAgICAgIGF5ID0gdGhpcy55LFxuICAgICAgICBieCA9IG90aGVyLngsXG4gICAgICAgIGJ5ID0gb3RoZXIueTtcblxuICAgIHRoaXMueCA9IGJ4IDwgYXggPyBieCA6IGF4O1xuICAgIHRoaXMueSA9IGJ5IDwgYXkgPyBieSA6IGF5O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbWF4XG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiByZXR1cm5zIG1heCB2YWx1ZXMgZnJvbSB0aGlzIGFuZCBvdGhlciB2ZWN0b3JcbiAqIEBwYXJhbSBWZWMyIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUubWF4ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIGF4ID0gdGhpcy54LFxuICAgICAgICBheSA9IHRoaXMueSxcbiAgICAgICAgYnggPSBvdGhlci54LFxuICAgICAgICBieSA9IG90aGVyLnk7XG5cbiAgICB0aGlzLnggPSBieCA+IGF4ID8gYnggOiBheDtcbiAgICB0aGlzLnkgPSBieSA+IGF5ID8gYnkgOiBheTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNsYW1wXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiBjbGFtcCB2YWx1ZXMgYmV0d2VlbiBtaW4gYW5kIG1heCdzIHZhbHVlc1xuICogQHBhcmFtIFZlYzIgbWluXG4gKiBAcGFyYW0gVmVjMiBtYXhcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS5jbGFtcCA9IGZ1bmN0aW9uIChtaW4sIG1heCkge1xuICAgIHZhciB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICBtaW54ID0gbWluLngsXG4gICAgICAgIG1pbnkgPSBtaW4ueSxcbiAgICAgICAgbWF4eCA9IG1heC54LFxuICAgICAgICBtYXh5ID0gbWF4Lnk7XG5cbiAgICB0aGlzLnggPSB4IDwgbWlueCA/IG1pbnggOiB4ID4gbWF4eCA/IG1heHggOiB4O1xuICAgIHRoaXMueSA9IHkgPCBtaW55ID8gbWlueSA6IHkgPiBtYXh5ID8gbWF4eSA6IHk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0cmFuc2Zvcm1BbmdsZVxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogdHJhbnNmb3JtcyB0aGlzIHdpdGggYW5nbGVcbiAqIEBwYXJhbSBNYXQyIG1cbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS50cmFuc2Zvcm1BbmdsZSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgdmFyIHggPSB0aGlzLngsXG4gICAgICAgIHkgPSB0aGlzLnksXG4gICAgICAgIGMgPSBjb3MoYSksXG4gICAgICAgIHMgPSBzaW4oYSk7XG5cbiAgICB0aGlzLnggPSB4ICogYyAtIHkgKiBzO1xuICAgIHRoaXMueSA9IHggKiBzICsgeSAqIGM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0cmFuc2Zvcm1NYXQyXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiB0cmFuc2Zvcm1zIHRoaXMgd2l0aCBNYXQyXG4gKiBAcGFyYW0gTWF0MiBtXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUudHJhbnNmb3JtTWF0MiA9IGZ1bmN0aW9uIChtKSB7XG4gICAgdmFyIG1lID0gbS5lbGVtZW50cyxcbiAgICAgICAgeCA9IHRoaXMueCxcbiAgICAgICAgeSA9IHRoaXMueTtcblxuICAgIHRoaXMueCA9IHggKiBtZVswXSArIHkgKiBtZVsyXTtcbiAgICB0aGlzLnkgPSB4ICogbWVbMV0gKyB5ICogbWVbM107XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB1bnRyYW5zZm9ybU1hdDJcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHVudHJhbnNmb3JtcyB0aGlzIHdpdGggTWF0MlxuICogQHBhcmFtIE1hdDIgbVxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzIucHJvdG90eXBlLnVudHJhbnNmb3JtTWF0MiA9IGZ1bmN0aW9uIChtKSB7XG4gICAgdmFyIG1lID0gbS5lbGVtZW50cyxcbiAgICAgICAgeCA9IHRoaXMueCxcbiAgICAgICAgeSA9IHRoaXMueTtcblxuICAgIHRoaXMueCA9IHggKiBtZVswXSArIHkgKiBtZVsxXTtcbiAgICB0aGlzLnkgPSB4ICogbWVbMl0gKyB5ICogbWVbM107XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0cmFuc2Zvcm1NYXQzMlxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogdHJhbnNmb3JtcyB0aGlzIHdpdGggTWF0MzJcbiAqIEBwYXJhbSBNYXQzMiBtXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUudHJhbnNmb3JtTWF0MzIgPSBmdW5jdGlvbiAobSkge1xuICAgIHZhciBtZSA9IG0uZWxlbWVudHMsXG4gICAgICAgIHggPSB0aGlzLngsXG4gICAgICAgIHkgPSB0aGlzLnk7XG5cbiAgICB0aGlzLnggPSB4ICogbWVbMF0gKyB5ICogbWVbMl0gKyBtZVs0XTtcbiAgICB0aGlzLnkgPSB4ICogbWVbMV0gKyB5ICogbWVbM10gKyBtZVs1XTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHVudHJhbnNmb3JtTWF0MzJcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHVudHJhbnNmb3JtcyB0aGlzIHdpdGggTWF0MzJcbiAqIEBwYXJhbSBNYXQzMiBtXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUudW50cmFuc2Zvcm1NYXQzMiA9IGZ1bmN0aW9uIChtKSB7XG4gICAgdmFyIG1lID0gbS5lbGVtZW50cyxcbiAgICAgICAgeCA9IHRoaXMueCAtIG1lWzRdLFxuICAgICAgICB5ID0gdGhpcy55IC0gbWVbNV07XG5cbiAgICB0aGlzLnggPSB4ICogbWVbMF0gKyB5ICogbWVbMV07XG4gICAgdGhpcy55ID0geCAqIG1lWzJdICsgeSAqIG1lWzNdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdHJhbnNmb3JtTWF0M1xuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogdHJhbnNmb3JtcyB0aGlzIHdpdGggTWF0M1xuICogQHBhcmFtIE1hdDMgbVxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzIucHJvdG90eXBlLnRyYW5zZm9ybU1hdDMgPSBmdW5jdGlvbiAobSkge1xuICAgIHZhciBtZSA9IG0uZWxlbWVudHMsXG4gICAgICAgIHggPSB0aGlzLngsXG4gICAgICAgIHkgPSB0aGlzLnk7XG5cbiAgICB0aGlzLnggPSB4ICogbWVbMF0gKyB5ICogbWVbM10gKyBtZVs2XTtcbiAgICB0aGlzLnkgPSB4ICogbWVbMV0gKyB5ICogbWVbNF0gKyBtZVs3XTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRyYW5zZm9ybU1hdDRcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHRyYW5zZm9ybXMgdGhpcyB3aXRoIE1hdDRcbiAqIEBwYXJhbSBNYXQ0IG1cbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS50cmFuc2Zvcm1NYXQ0ID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgbWUgPSBtLmVsZW1lbnRzLFxuICAgICAgICB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55O1xuXG4gICAgdGhpcy54ID0geCAqIG1lWzBdICsgeSAqIG1lWzRdICsgbWVbMTJdO1xuICAgIHRoaXMueSA9IHggKiBtZVsxXSArIHkgKiBtZVs1XSArIG1lWzEzXTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRyYW5zZm9ybVByb2plY3Rpb25cbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzNcbiAqIHRyYW5zZm9ybXMgdGhpcyB3aXRoIE1hdDQgcHJvamVjdGlvbiBtYXRyaXhcbiAqIEBwYXJhbSBNYXQ0IG1cbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS50cmFuc2Zvcm1Qcm9qZWN0aW9uID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgbWUgPSBtLmVsZW1lbnRzLFxuICAgICAgICB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICBkID0gMSAvIChtZVszXSAqIHggKyBtZVs3XSAqIHkgKyBtZVsxMV0gKiB6ICsgbWVbMTVdKTtcblxuICAgIHRoaXMueCA9IChtZVswXSAqIHggKyBtZVs0XSAqIHkgKyBtZVsxMl0pICogZDtcbiAgICB0aGlzLnkgPSAobWVbMV0gKiB4ICsgbWVbNV0gKiB5ICsgbWVbMTNdKSAqIGQ7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tVmVjM1xuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogc2V0cyB2YWx1ZXMgZnJvbSBWZWMzXG4gKiBAcGFyYW0gVmVjMyB2XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUuZnJvbVZlYzMgPSBmdW5jdGlvbiAodikge1xuXG4gICAgdGhpcy54ID0gdi54O1xuICAgIHRoaXMueSA9IHYueTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21WZWM0XG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiBzZXRzIHZhbHVlcyBmcm9tIFZlYzRcbiAqIEBwYXJhbSBWZWM0IHZcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS5mcm9tVmVjNCA9IGZ1bmN0aW9uICh2KSB7XG5cbiAgICB0aGlzLnggPSB2Lng7XG4gICAgdGhpcy55ID0gdi55O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgcG9zaXRpb25Gcm9tTWF0MzJcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHNldHMgcG9zaXRpb24gZnJvbSBNYXQzMlxuICogQHBhcmFtIE1hdDMyIG1cbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS5wb3NpdGlvbkZyb21NYXQzMiA9IGZ1bmN0aW9uIChtKSB7XG4gICAgdmFyIG1lID0gbS5lbGVtZW50cztcblxuICAgIHRoaXMueCA9IG1lWzRdO1xuICAgIHRoaXMueSA9IG1lWzVdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgcG9zaXRpb25Gcm9tTWF0NFxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogc2V0cyBwb3NpdGlvbiBmcm9tIE1hdDRcbiAqIEBwYXJhbSBNYXQ0IG1cbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS5wb3NpdGlvbkZyb21NYXQ0ID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgbWUgPSBtLmVsZW1lbnRzO1xuXG4gICAgdGhpcy54ID0gbWVbMTJdO1xuICAgIHRoaXMueSA9IG1lWzEzXTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNjYWxlRnJvbU1hdDJcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHNldHMgdGhpcyBmcm9tIE1hdDIgc2NhbGVcbiAqIEBwYXJhbSBNYXQyIG1cbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMyLnByb3RvdHlwZS5zY2FsZUZyb21NYXQyID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgbWUgPSBtLmVsZW1lbnRzLFxuICAgICAgICB4ID0gdGhpcy5zZXQobWVbMF0sIG1bMl0pLmxlbmd0aCgpLFxuICAgICAgICB5ID0gdGhpcy5zZXQobWVbMV0sIG1bM10pLmxlbmd0aCgpO1xuXG4gICAgdGhpcy54ID0geDtcbiAgICB0aGlzLnkgPSB5O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2NhbGVGcm9tTWF0MzJcbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHNldHMgdGhpcyBmcm9tIE1hdDMyIHNjYWxlXG4gKiBAcGFyYW0gTWF0MzIgbVxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzIucHJvdG90eXBlLnNjYWxlRnJvbU1hdDMyID0gVmVjMi5wcm90b3R5cGUuc2NhbGVGcm9tTWF0MjtcblxuLyoqXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiBAcGFyYW0gWGlhbi5WZWMyIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICByZXR1cm4gIShcbiAgICB0aGlzLnggIT09IG90aGVyLnggfHxcbiAgICB0aGlzLnkgIT09IG90aGVyLnlcbiAgICApO1xufTtcblxuLyoqXG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiBAcGFyYW0gWGlhbi5WZWMyIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMi5wcm90b3R5cGUubm90RXF1YWxzID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICByZXR1cm4gKFxuICAgIHRoaXMueCAhPT0gb3RoZXIueCB8fFxuICAgIHRoaXMueSAhPT0gb3RoZXIueVxuICAgICk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbUpTT05cbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHNldHMgdmFsdWVzIGZyb20gSlNPTiBvYmplY3RcbiAqIEBwYXJhbSBPYmplY3QganNvblxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzIucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcblxuICAgIHRoaXMueCA9IGpzb24ueDtcbiAgICB0aGlzLnkgPSBqc29uLnk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b0pTT05cbiAqIEBtZW1iZXJvZiBYaWFuLlZlYzJcbiAqIHJldHVybnMganNvbiBvYmplY3Qgb2YgdGhpc1xuICogQHJldHVybiBPYmplY3RcbiAqL1xuVmVjMi5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uIHx8IChqc29uID0ge30pO1xuXG4gICAganNvbi5fY2xhc3NOYW1lID0gXCJWZWMyXCI7XG4gICAganNvbi54ID0gdGhpcy54O1xuICAgIGpzb24ueSA9IHRoaXMueTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21BcnJheVxuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogc2V0cyB2YWx1ZXMgZnJvbSBBcnJheSBvYmplY3RcbiAqIEBwYXJhbSBBcnJheSBhcnJheVxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzIucHJvdG90eXBlLmZyb21BcnJheSA9IGZ1bmN0aW9uIChhcnJheSkge1xuXG4gICAgdGhpcy54ID0gYXJyYXlbMF07XG4gICAgdGhpcy55ID0gYXJyYXlbMV07XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b0FycmF5XG4gKiBAbWVtYmVyb2YgWGlhbi5WZWMyXG4gKiByZXR1cm5zIGFycmF5IG9iamVjdCBvZiB0aGlzXG4gKiBAcmV0dXJuIEFycmF5XG4gKi9cblZlYzIucHJvdG90eXBlLnRvQXJyYXkgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICBhcnJheSB8fCAoYXJyYXkgPSBbXSk7XG5cbiAgICBhcnJheVswXSA9IHRoaXMueDtcbiAgICBhcnJheVsxXSA9IHRoaXMueTtcblxuICAgIHJldHVybiBhcnJheTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b1N0cmluZ1xuICogQG1lbWJlcm9mIFhpYW4uVmVjMlxuICogcmV0dXJucyBzdHJpbmcgb2YgdGhpc1xuICogQHJldHVybiBTdHJpbmdcbiAqL1xuVmVjMi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gXCJWZWMyKCBcIiArIHRoaXMueCArIFwiLCBcIiArIHRoaXMueSArIFwiIClcIjtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBWZWMyO1xuIiwidmFyIE1hdGhmID0gcmVxdWlyZShcIi4vbWF0aGZcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgc3FydCA9IE1hdGguc3FydDtcblxuLyoqXG4gKiBAY2xhc3MgVmVjM1xuICogM2QgdmVjdG9yXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEBwYXJhbSBOdW1iZXIgeVxuICogQHBhcmFtIE51bWJlciB6XG4gKi9cbmZ1bmN0aW9uIFZlYzMoeCwgeSwgeikge1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciB4XG4gICAgICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICAgICAqL1xuICAgIHRoaXMueCA9IHggfHwgMC4wO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciB5XG4gICAgICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICAgICAqL1xuICAgIHRoaXMueSA9IHkgfHwgMC4wO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciB6XG4gICAgICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICAgICAqL1xuICAgIHRoaXMueiA9IHogfHwgMC4wO1xufVxuXG5NYXRoZi5fY2xhc3Nlc1tcIlZlYzNcIl0gPSBWZWMzO1xuXG4vKipcbiAqIEBtZXRob2QgY2xvbmVcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIHJldHVybnMgbmV3IGluc3RhbmNlIG9mIHRoaXNcbiAqIEByZXR1cm4gVmVjM1xuICovXG5WZWMzLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiBuZXcgVmVjMyh0aGlzLngsIHRoaXMueSwgdGhpcy56KTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjb3B5XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiBjb3BpZXMgb3RoZXJcbiAqIEBwYXJhbSBWZWMzIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMy5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy54ID0gb3RoZXIueDtcbiAgICB0aGlzLnkgPSBvdGhlci55O1xuICAgIHRoaXMueiA9IG90aGVyLno7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZXRcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIHNldHMgdmFsdWVzIG9mIHRoaXNcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHBhcmFtIE51bWJlciB5XG4gKiBAcGFyYW0gTnVtYmVyIHpcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCwgeSwgeikge1xuXG4gICAgdGhpcy54ID0geDtcbiAgICB0aGlzLnkgPSB5O1xuICAgIHRoaXMueiA9IHo7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBhZGRcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIGFkZHMgb3RoZXIncyB2YWx1ZXMgdG8gdGhpc1xuICogQHBhcmFtIFZlYzMgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMueCArPSBvdGhlci54O1xuICAgIHRoaXMueSArPSBvdGhlci55O1xuICAgIHRoaXMueiArPSBvdGhlci56O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdmFkZFxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogYWRkcyBhIGFuZCBiIHRvZ2V0aGVyIHNhdmVzIGl0IGluIHRoaXNcbiAqIEBwYXJhbSBWZWMzIGFcbiAqIEBwYXJhbSBWZWMzIGJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS52YWRkID0gZnVuY3Rpb24gKGEsIGIpIHtcblxuICAgIHRoaXMueCA9IGEueCArIGIueDtcbiAgICB0aGlzLnkgPSBhLnkgKyBiLnk7XG4gICAgdGhpcy56ID0gYS56ICsgYi56O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2FkZFxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogYWRkcyBzY2FsYXIgdmFsdWUgdG8gdGhpc1xuICogQHBhcmFtIE51bWJlciBzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMy5wcm90b3R5cGUuc2FkZCA9IGZ1bmN0aW9uIChzKSB7XG5cbiAgICB0aGlzLnggKz0gcztcbiAgICB0aGlzLnkgKz0gcztcbiAgICB0aGlzLnogKz0gcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHN1YlxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogc3VidHJhY3RzIG90aGVyJ3MgdmFsdWVzIGZyb20gdGhpc1xuICogQHBhcmFtIFZlYzMgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS5zdWIgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMueCAtPSBvdGhlci54O1xuICAgIHRoaXMueSAtPSBvdGhlci55O1xuICAgIHRoaXMueiAtPSBvdGhlci56O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdnN1YlxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogc3VidHJhY3RzIGIgZnJvbSBhIHNhdmVzIGl0IGluIHRoaXNcbiAqIEBwYXJhbSBWZWMzIGFcbiAqIEBwYXJhbSBWZWMzIGJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS52c3ViID0gZnVuY3Rpb24gKGEsIGIpIHtcblxuICAgIHRoaXMueCA9IGEueCAtIGIueDtcbiAgICB0aGlzLnkgPSBhLnkgLSBiLnk7XG4gICAgdGhpcy56ID0gYS56IC0gYi56O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc3N1YlxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogc3VidHJhY3RzIHRoaXMgYnkgYSBzY2FsYXIgdmFsdWVcbiAqIEBwYXJhbSBOdW1iZXIgc1xuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLnNzdWIgPSBmdW5jdGlvbiAocykge1xuXG4gICAgdGhpcy54IC09IHM7XG4gICAgdGhpcy55IC09IHM7XG4gICAgdGhpcy56IC09IHM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtdWxcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIG11bGlwbGVzIHRoaXMncyB2YWx1ZXMgYnkgb3RoZXInc1xuICogQHBhcmFtIFZlYzMgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS5tdWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMueCAqPSBvdGhlci54O1xuICAgIHRoaXMueSAqPSBvdGhlci55O1xuICAgIHRoaXMueiAqPSBvdGhlci56O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgdm11bFxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogbXVsaXBsZXMgYSBhbmQgYiBzYXZlcyBpdCBpbiB0aGlzXG4gKiBAcGFyYW0gVmVjMyBhXG4gKiBAcGFyYW0gVmVjMyBiXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMy5wcm90b3R5cGUudm11bCA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cbiAgICB0aGlzLnggPSBhLnggKiBiLng7XG4gICAgdGhpcy55ID0gYS55ICogYi55O1xuICAgIHRoaXMueiA9IGEueiAqIGIuejtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNtdWxcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIG11bGlwbGVzIHRoaXMgYnkgYSBzY2FsYXIgdmFsdWVcbiAqIEBwYXJhbSBOdW1iZXIgc1xuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLnNtdWwgPSBmdW5jdGlvbiAocykge1xuXG4gICAgdGhpcy54ICo9IHM7XG4gICAgdGhpcy55ICo9IHM7XG4gICAgdGhpcy56ICo9IHM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBkaXZcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIGRpdmlkZXMgdGhpcydzIHZhbHVlcyBieSBvdGhlcidzXG4gKiBAcGFyYW0gVmVjMyBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLmRpdiA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciB4ID0gb3RoZXIueCxcbiAgICAgICAgeSA9IG90aGVyLnksXG4gICAgICAgIHogPSBvdGhlci56O1xuXG4gICAgdGhpcy54ICo9IHggIT09IDAuMCA/IDEuMCAvIHggOiAwLjA7XG4gICAgdGhpcy55ICo9IHkgIT09IDAuMCA/IDEuMCAvIHkgOiAwLjA7XG4gICAgdGhpcy56ICo9IHogIT09IDAuMCA/IDEuMCAvIHogOiAwLjA7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB2ZGl2XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiBkaXZpZGVzIGIgZnJvbSBhIHNhdmVzIGl0IGluIHRoaXNcbiAqIEBwYXJhbSBWZWMzIGFcbiAqIEBwYXJhbSBWZWMzIGJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS52ZGl2ID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICB2YXIgeCA9IGIueCxcbiAgICAgICAgeSA9IGIueSxcbiAgICAgICAgeiA9IGIuejtcblxuICAgIHRoaXMueCA9IHggIT09IDAuMCA/IGEueCAvIHggOiAwLjA7XG4gICAgdGhpcy55ID0geSAhPT0gMC4wID8gYS55IC8geSA6IDAuMDtcbiAgICB0aGlzLnogPSB6ICE9PSAwLjAgPyBhLnogLyB6IDogMC4wO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2RpdlxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogZGl2aWRlcyB0aGlzIGJ5IHNjYWxhciB2YWx1ZVxuICogQHBhcmFtIE51bWJlciBzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMy5wcm90b3R5cGUuc2RpdiA9IGZ1bmN0aW9uIChzKSB7XG4gICAgcyA9IHMgPT09IDAuMCA/IDAuMCA6IDEuMCAvIHM7XG5cbiAgICB0aGlzLnggKj0gcztcbiAgICB0aGlzLnkgKj0gcztcbiAgICB0aGlzLnogKj0gcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGxlbmd0aFxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogcmV0dXJucyB0aGUgbGVuZ3RoIG9mIHRoaXNcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cblZlYzMucHJvdG90eXBlLmxlbmd0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgeCA9IHRoaXMueCxcbiAgICAgICAgeSA9IHRoaXMueSxcbiAgICAgICAgeiA9IHRoaXMueixcbiAgICAgICAgbHNxID0geCAqIHggKyB5ICogeSArIHogKiB6O1xuXG4gICAgaWYgKGxzcSA9PT0gMSkgcmV0dXJuIDE7XG5cbiAgICByZXR1cm4gbHNxID09PSAwLjAgPyAwLjAgOiBzcXJ0KGxzcSk7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbGVuZ3RoU3FcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIHJldHVybnMgdGhlIHNxdWFyZWQgbGVuZ3RoIG9mIHRoaXNcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cblZlYzMucHJvdG90eXBlLmxlbmd0aFNxID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICB6ID0gdGhpcy56O1xuXG4gICAgcmV0dXJuIHggKiB4ICsgeSAqIHkgKyB6ICogejtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZXRMZW5ndGhcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIHNldHMgdGhpcyBzbyBpdHMgbWFnbml0dWRlIGlzIGVxdWFsIHRvIGxlbmd0aFxuICogQHBhcmFtIE51bWJlciBsZW5ndGhcbiAqIEByZXR1cm4gVmVjM1xuICovXG5WZWMzLnByb3RvdHlwZS5zZXRMZW5ndGggPSBmdW5jdGlvbiAobGVuZ3RoKSB7XG4gICAgdmFyIHggPSB0aGlzLngsXG4gICAgICAgIHkgPSB0aGlzLnksXG4gICAgICAgIHogPSB0aGlzLnosXG4gICAgICAgIGwgPSB4ICogeCArIHkgKiB5ICsgeiAqIHo7XG5cbiAgICBpZiAobCA9PT0gMSkge1xuICAgICAgICB0aGlzLnggKj0gbGVuZ3RoO1xuICAgICAgICB0aGlzLnkgKj0gbGVuZ3RoO1xuICAgICAgICB0aGlzLnogKj0gbGVuZ3RoO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGwgPSBsID4gMC4wID8gMS4wIC8gc3FydChsKSA6IDAuMDtcblxuICAgIHRoaXMueCAqPSBsICogbGVuZ3RoO1xuICAgIHRoaXMueSAqPSBsICogbGVuZ3RoO1xuICAgIHRoaXMueiAqPSBsICogbGVuZ3RoO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgbm9ybWFsaXplXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiByZXR1cm5zIHRoaXMgd2l0aCBhIGxlbmd0aCBvZiAxXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMy5wcm90b3R5cGUubm9ybWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICB6ID0gdGhpcy56LFxuICAgICAgICBsID0geCAqIHggKyB5ICogeSArIHogKiB6O1xuXG4gICAgaWYgKGwgPT09IDEpIHJldHVybiB0aGlzO1xuXG4gICAgbCA9IGwgPiAwLjAgPyAxLjAgLyBzcXJ0KGwpIDogMC4wO1xuXG4gICAgdGhpcy54ICo9IGw7XG4gICAgdGhpcy55ICo9IGw7XG4gICAgdGhpcy56ICo9IGw7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBvcnRob05vcm1hbGl6ZVxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogcmV0dXJucyBtYWtlcyB2ZWN0b3JzIG5vcm1hbGl6ZWQgYW5kIG9ydGhvZ29uYWwgdG8gZWFjaCBvdGhlclxuICogQHBhcmFtIFZlYzMgYVxuICogQHBhcmFtIFZlYzMgYlxuICogQHBhcmFtIFZlYzMgY1xuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLm9ydGhvTm9ybWFsaXplID0gZnVuY3Rpb24gKGEsIGIsIGMpIHtcbiAgICBpZiAoYS5sZW5ndGhTcSgpICE9PSAxLjApIGEubm9ybWFsaXplKCk7XG4gICAgYy52Y3Jvc3MoYSwgYik7XG4gICAgaWYgKGEubGVuZ3RoU3EoKSA9PT0gMC4wKSByZXR1cm47XG4gICAgYy5ub3JtYWxpemUoKTtcbiAgICBiLnZjcm9zcyhjLCBhKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBpbnZlcnNlXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiByZXR1cm5zIHRoZSBpbnZlcnNlIG9mIHRoaXNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS5pbnZlcnNlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy54ICo9IC0xO1xuICAgIHRoaXMueSAqPSAtMTtcbiAgICB0aGlzLnogKj0gLTE7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBpbnZlcnNlVmVjXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiByZXR1cm5zIHRoZSBpbnZlcnNlIG9mIG90aGVyXG4gKiBAcGFyYW0gVmVjMyBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLmludmVyc2VWZWMgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMueCA9IC1vdGhlci54O1xuICAgIHRoaXMueSA9IC1vdGhlci55O1xuICAgIHRoaXMueiA9IC0ob3RoZXIueiB8fCAwKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGxlcnBcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIGxpbmVhciBpbnRlcnBvbGF0aW9uIGJldHdlZW4gdGhpcyBhbmQgb3RoZXIgYnkgeFxuICogQHBhcmFtIFZlYzMgb3RoZXJcbiAqIEBwYXJhbSBOdW1iZXIgeFxuICogQHJldHVybiBWZWMzXG4gKi9cblZlYzMucHJvdG90eXBlLmxlcnAgPSBmdW5jdGlvbiAob3RoZXIsIHgpIHtcblxuICAgIHRoaXMueCArPSAob3RoZXIueCAtIHRoaXMueCkgKiB4O1xuICAgIHRoaXMueSArPSAob3RoZXIueSAtIHRoaXMueSkgKiB4O1xuICAgIHRoaXMueiArPSAob3RoZXIueiAtIHRoaXMueikgKiB4O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdmxlcnBcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIGxpbmVhciBpbnRlcnBvbGF0aW9uIGJldHdlZW4gYSBhbmQgYiBieSB4XG4gKiBAcGFyYW0gVmVjMyBhXG4gKiBAcGFyYW0gVmVjMyBiXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEByZXR1cm4gVmVjM1xuICovXG5WZWMzLnByb3RvdHlwZS52bGVycCA9IGZ1bmN0aW9uIChhLCBiLCB4KSB7XG4gICAgdmFyIGF4ID0gYS54LFxuICAgICAgICBheSA9IGEueSxcbiAgICAgICAgYXogPSBhLno7XG5cbiAgICB0aGlzLnggPSBheCArIChiLnggLSBheCkgKiB4O1xuICAgIHRoaXMueSA9IGF5ICsgKGIueSAtIGF5KSAqIHg7XG4gICAgdGhpcy56ID0gYXogKyAoYi56IC0gYXopICogeDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHZkb3RcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIGRvdCBwcm9kdWN0IG9mIHR3byB2ZWN0b3JzLCBjYW4gYmUgY2FsbGVkIGFzIGEgc3RhdGljIGZ1bmN0aW9uIFZlYzMudmRvdCggYSwgYiApXG4gKiBAcGFyYW0gVmVjMyBhXG4gKiBAcGFyYW0gVmVjMyBiXG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5WZWMzLnZkb3QgPSBWZWMzLnByb3RvdHlwZS52ZG90ID0gZnVuY3Rpb24gKGEsIGIpIHtcblxuICAgIHJldHVybiBhLnggKiBiLnggKyBhLnkgKiBiLnkgKyBhLnogKiBiLno7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZG90XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiBkb3QgcHJvZHVjdCBvZiB0aGlzIGFuZCBvdGhlciB2ZWN0b3JcbiAqIEBwYXJhbSBWZWMzIG90aGVyXG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5WZWMzLnByb3RvdHlwZS5kb3QgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHJldHVybiB0aGlzLnggKiBvdGhlci54ICsgdGhpcy55ICogb3RoZXIueSArIHRoaXMueiAqIG90aGVyLno7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdmNyb3NzXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiBjcm9zcyBwcm9kdWN0IGJldHdlZW4gYSB2ZWN0b3IgYW5kIGIgdmVjdG9yLCBjYW4gYmUgY2FsbGVkIGFzIGEgc3RhdGljIGZ1bmN0aW9uIFZlYzMudmNyb3NzKCBhLCBiIClcbiAqIEBwYXJhbSBWZWMzIGFcbiAqIEBwYXJhbSBWZWMzIGJcbiAqIEByZXR1cm4gTnVtYmVyXG4gKi9cblZlYzMudmNyb3NzID0gVmVjMy5wcm90b3R5cGUudmNyb3NzID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICB2YXIgYXggPSBhLngsXG4gICAgICAgIGF5ID0gYS55LFxuICAgICAgICBheiA9IGEueixcbiAgICAgICAgYnggPSBiLngsXG4gICAgICAgIGJ5ID0gYi55LFxuICAgICAgICBieiA9IGIuejtcblxuICAgIHRoaXMueCA9IGF5ICogYnogLSBheiAqIGJ5O1xuICAgIHRoaXMueSA9IGF6ICogYnggLSBheCAqIGJ6O1xuICAgIHRoaXMueiA9IGF4ICogYnkgLSBheSAqIGJ4O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgY3Jvc3NcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIGNyb3NzIHByb2R1Y3QgYmV0d2VlbiB0aGlzIHZlY3RvciBhbmQgb3RoZXJcbiAqIEBwYXJhbSBWZWMzIG90aGVyXG4gKiBAcmV0dXJuIE51bWJlclxuICovXG5WZWMzLnByb3RvdHlwZS5jcm9zcyA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHZhciBheCA9IHRoaXMueCxcbiAgICAgICAgYXkgPSB0aGlzLnksXG4gICAgICAgIGF6ID0gdGhpcy56LFxuICAgICAgICBieCA9IG90aGVyLngsXG4gICAgICAgIGJ5ID0gb3RoZXIueSxcbiAgICAgICAgYnogPSBvdGhlci56O1xuXG4gICAgdGhpcy54ID0gYXkgKiBieiAtIGF6ICogYnk7XG4gICAgdGhpcy55ID0gYXogKiBieCAtIGF4ICogYno7XG4gICAgdGhpcy56ID0gYXggKiBieSAtIGF5ICogYng7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtaW5cbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIHJldHVybnMgbWluIHZhbHVlcyBmcm9tIHRoaXMgYW5kIG90aGVyIHZlY3RvclxuICogQHBhcmFtIFZlYzMgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS5taW4gPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYXggPSB0aGlzLngsXG4gICAgICAgIGF5ID0gdGhpcy55LFxuICAgICAgICBheiA9IHRoaXMueixcbiAgICAgICAgYnggPSBvdGhlci54LFxuICAgICAgICBieSA9IG90aGVyLnksXG4gICAgICAgIGJ6ID0gb3RoZXIuejtcblxuICAgIHRoaXMueCA9IGJ4IDwgYXggPyBieCA6IGF4O1xuICAgIHRoaXMueSA9IGJ5IDwgYXkgPyBieSA6IGF5O1xuICAgIHRoaXMueiA9IGJ6IDwgYXogPyBieiA6IGF6O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbWF4XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiByZXR1cm5zIG1heCB2YWx1ZXMgZnJvbSB0aGlzIGFuZCBvdGhlciB2ZWN0b3JcbiAqIEBwYXJhbSBWZWMzIG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMy5wcm90b3R5cGUubWF4ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIGF4ID0gdGhpcy54LFxuICAgICAgICBheSA9IHRoaXMueSxcbiAgICAgICAgYXogPSB0aGlzLnosXG4gICAgICAgIGJ4ID0gb3RoZXIueCxcbiAgICAgICAgYnkgPSBvdGhlci55LFxuICAgICAgICBieiA9IG90aGVyLno7XG5cbiAgICB0aGlzLnggPSBieCA+IGF4ID8gYnggOiBheDtcbiAgICB0aGlzLnkgPSBieSA+IGF5ID8gYnkgOiBheTtcbiAgICB0aGlzLnogPSBieiA+IGF6ID8gYnogOiBhejtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNsYW1wXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiBjbGFtcCB2YWx1ZXMgYmV0d2VlbiBtaW4gYW5kIG1heCdzIHZhbHVlc1xuICogQHBhcmFtIFZlYzMgbWluXG4gKiBAcGFyYW0gVmVjMyBtYXhcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS5jbGFtcCA9IGZ1bmN0aW9uIChtaW4sIG1heCkge1xuICAgIHZhciB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICB6ID0gdGhpcy56LFxuICAgICAgICBtaW54ID0gbWluLngsXG4gICAgICAgIG1pbnkgPSBtaW4ueSxcbiAgICAgICAgbWlueiA9IG1pbi56LFxuICAgICAgICBtYXh4ID0gbWF4LngsXG4gICAgICAgIG1heHkgPSBtYXgueSxcbiAgICAgICAgbWF4eiA9IG1heC56O1xuXG4gICAgdGhpcy54ID0geCA8IG1pbnggPyBtaW54IDogeCA+IG1heHggPyBtYXh4IDogeDtcbiAgICB0aGlzLnkgPSB5IDwgbWlueSA/IG1pbnkgOiB5ID4gbWF4eSA/IG1heHkgOiB5O1xuICAgIHRoaXMueiA9IHogPCBtaW56ID8gbWlueiA6IHogPiBtYXh6ID8gbWF4eiA6IHo7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0cmFuc2Zvcm1NYXQzXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiB0cmFuc2Zvcm1zIHRoaXMgd2l0aCBNYXQzXG4gKiBAcGFyYW0gTWF0MyBtXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMy5wcm90b3R5cGUudHJhbnNmb3JtTWF0MyA9IGZ1bmN0aW9uIChtKSB7XG4gICAgdmFyIG1lID0gbS5lbGVtZW50cyxcbiAgICAgICAgeCA9IHRoaXMueCxcbiAgICAgICAgeSA9IHRoaXMueSxcbiAgICAgICAgeiA9IHRoaXMuejtcblxuICAgIHRoaXMueCA9IHggKiBtZVswXSArIHkgKiBtZVszXSArIHogKiBtZVs2XTtcbiAgICB0aGlzLnkgPSB4ICogbWVbMV0gKyB5ICogbWVbNF0gKyB6ICogbWVbN107XG4gICAgdGhpcy56ID0geCAqIG1lWzJdICsgeSAqIG1lWzVdICsgeiAqIG1lWzhdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdHJhbnNmb3JtTWF0NFxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogdHJhbnNmb3JtcyB0aGlzIHdpdGggTWF0NFxuICogQHBhcmFtIE1hdDQgbVxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLnRyYW5zZm9ybU1hdDQgPSBmdW5jdGlvbiAobSkge1xuICAgIHZhciBtZSA9IG0uZWxlbWVudHMsXG4gICAgICAgIHggPSB0aGlzLngsXG4gICAgICAgIHkgPSB0aGlzLnksXG4gICAgICAgIHogPSB0aGlzLno7XG5cbiAgICB0aGlzLnggPSB4ICogbWVbMF0gKyB5ICogbWVbNF0gKyB6ICogbWVbOF0gKyBtZVsxMl07XG4gICAgdGhpcy55ID0geCAqIG1lWzFdICsgeSAqIG1lWzVdICsgeiAqIG1lWzldICsgbWVbMTNdO1xuICAgIHRoaXMueiA9IHggKiBtZVsyXSArIHkgKiBtZVs2XSArIHogKiBtZVsxMF0gKyBtZVsxNF07XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0cmFuc2Zvcm1NYXQ0XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiB0cmFuc2Zvcm1zIHRoaXMgd2l0aCBNYXQ0XG4gKiBAcGFyYW0gTWF0NCBtXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMy5wcm90b3R5cGUudHJhbnNmb3JtTWF0NFJvdGF0aW9uID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgbWUgPSBtLmVsZW1lbnRzLFxuICAgICAgICB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICB6ID0gdGhpcy56O1xuXG4gICAgdGhpcy54ID0geCAqIG1lWzBdICsgeSAqIG1lWzRdICsgeiAqIG1lWzhdO1xuICAgIHRoaXMueSA9IHggKiBtZVsxXSArIHkgKiBtZVs1XSArIHogKiBtZVs5XTtcbiAgICB0aGlzLnogPSB4ICogbWVbMl0gKyB5ICogbWVbNl0gKyB6ICogbWVbMTBdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdHJhbnNmb3JtUHJvamVjdGlvblxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogdHJhbnNmb3JtcyB0aGlzIHdpdGggTWF0NCBwcm9qZWN0aW9uIG1hdHJpeFxuICogQHBhcmFtIE1hdDQgbVxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLnRyYW5zZm9ybVByb2plY3Rpb24gPSBmdW5jdGlvbiAobSkge1xuICAgIHZhciBtZSA9IG0uZWxlbWVudHMsXG4gICAgICAgIHggPSB0aGlzLngsXG4gICAgICAgIHkgPSB0aGlzLnksXG4gICAgICAgIHogPSB0aGlzLnosXG4gICAgICAgIGQgPSAxIC8gKG1lWzNdICogeCArIG1lWzddICogeSArIG1lWzExXSAqIHogKyBtZVsxNV0pO1xuXG4gICAgdGhpcy54ID0gKG1lWzBdICogeCArIG1lWzRdICogeSArIG1lWzhdICogeiArIG1lWzEyXSkgKiBkO1xuICAgIHRoaXMueSA9IChtZVsxXSAqIHggKyBtZVs1XSAqIHkgKyBtZVs5XSAqIHogKyBtZVsxM10pICogZDtcbiAgICB0aGlzLnogPSAobWVbMl0gKiB4ICsgbWVbNl0gKiB5ICsgbWVbMTBdICogeiArIG1lWzE0XSkgKiBkO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdHJhbnNmb3JtUXVhdFxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogdHJhbnNmb3JtcyB0aGlzIHdpdGggUXVhdFxuICogQHBhcmFtIFF1YXQgcVxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLnRyYW5zZm9ybVF1YXQgPSBmdW5jdGlvbiAocSkge1xuICAgIHZhciB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICB6ID0gdGhpcy56LFxuICAgICAgICBxeCA9IHEueCxcbiAgICAgICAgcXkgPSBxLnksXG4gICAgICAgIHF6ID0gcS56LFxuICAgICAgICBxdyA9IHEudyxcblxuICAgICAgICBpeCA9IHF3ICogeCArIHF5ICogeiAtIHF6ICogeSxcbiAgICAgICAgaXkgPSBxdyAqIHkgKyBxeiAqIHggLSBxeCAqIHosXG4gICAgICAgIGl6ID0gcXcgKiB6ICsgcXggKiB5IC0gcXkgKiB4LFxuICAgICAgICBpdyA9IC1xeCAqIHggLSBxeSAqIHkgLSBxeiAqIHo7XG5cbiAgICB0aGlzLnggPSBpeCAqIHF3ICsgaXcgKiAtcXggKyBpeSAqIC1xeiAtIGl6ICogLXF5O1xuICAgIHRoaXMueSA9IGl5ICogcXcgKyBpdyAqIC1xeSArIGl6ICogLXF4IC0gaXggKiAtcXo7XG4gICAgdGhpcy56ID0gaXogKiBxdyArIGl3ICogLXF6ICsgaXggKiAtcXkgLSBpeSAqIC1xeDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21WZWMyXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiBzZXRzIHZhbHVlcyBmcm9tIFZlYzJcbiAqIEBwYXJhbSBWZWMyIHZcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS5mcm9tVmVjMiA9IGZ1bmN0aW9uICh2KSB7XG5cbiAgICB0aGlzLnggPSB2Lng7XG4gICAgdGhpcy55ID0gdi55O1xuICAgIHRoaXMueiA9IDAuMDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21WZWM0XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiBzZXRzIHBvc2l0aW9uIGZyb20gVmVjNFxuICogQHBhcmFtIFZlYzQgdlxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLmZyb21WZWM0ID0gZnVuY3Rpb24gKHYpIHtcblxuICAgIHRoaXMueCA9IHYueDtcbiAgICB0aGlzLnkgPSB2Lnk7XG4gICAgdGhpcy56ID0gdi56O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgcG9zaXRpb25Gcm9tTWF0NFxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogc2V0cyBwb3NpdGlvbiBmcm9tIE1hdDRcbiAqIEBwYXJhbSBNYXQ0IG1cbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS5wb3NpdGlvbkZyb21NYXQ0ID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgbWUgPSBtLmVsZW1lbnRzO1xuXG4gICAgdGhpcy54ID0gbWVbMTJdO1xuICAgIHRoaXMueSA9IG1lWzEzXTtcbiAgICB0aGlzLnogPSBtZVsxNF07XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzY2FsZUZyb21NYXQzXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiBzZXRzIHRoaXMgZnJvbSBNYXQzIHNjYWxlXG4gKiBAcGFyYW0gTWF0MyBtXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjMy5wcm90b3R5cGUuc2NhbGVGcm9tTWF0MyA9IGZ1bmN0aW9uIChtKSB7XG4gICAgdmFyIG1lID0gbS5lbGVtZW50cyxcbiAgICAgICAgeCA9IHRoaXMuc2V0KG1lWzBdLCBtZVszXSwgbWVbNl0pLmxlbmd0aCgpLFxuICAgICAgICB5ID0gdGhpcy5zZXQobWVbMV0sIG1lWzRdLCBtZVs3XSkubGVuZ3RoKCksXG4gICAgICAgIHogPSB0aGlzLnNldChtZVsyXSwgbWVbNV0sIG1lWzhdKS5sZW5ndGgoKTtcblxuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICB0aGlzLnogPSB6O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2NhbGVGcm9tTWF0NFxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogc2V0cyB0aGlzIGZyb20gTWF0NCBzY2FsZVxuICogQHBhcmFtIE1hdDQgbVxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLnNjYWxlRnJvbU1hdDQgPSBmdW5jdGlvbiAobSkge1xuICAgIHZhciBtZSA9IG0uZWxlbWVudHMsXG4gICAgICAgIHggPSB0aGlzLnNldChtZVswXSwgbWVbNF0sIG1lWzhdKS5sZW5ndGgoKSxcbiAgICAgICAgeSA9IHRoaXMuc2V0KG1lWzFdLCBtZVs1XSwgbWVbOV0pLmxlbmd0aCgpLFxuICAgICAgICB6ID0gdGhpcy5zZXQobWVbMl0sIG1lWzZdLCBtZVsxMF0pLmxlbmd0aCgpO1xuXG4gICAgdGhpcy54ID0geDtcbiAgICB0aGlzLnkgPSB5O1xuICAgIHRoaXMueiA9IHo7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogQHBhcmFtIE9kaW4uVmVjMyBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgcmV0dXJuICEoXG4gICAgdGhpcy54ICE9PSBvdGhlci54IHx8XG4gICAgdGhpcy55ICE9PSBvdGhlci55IHx8XG4gICAgdGhpcy56ICE9PSBvdGhlci56XG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogQHBhcmFtIE9kaW4uVmVjMyBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLm5vdEVxdWFscyA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgcmV0dXJuIChcbiAgICB0aGlzLnggIT09IG90aGVyLnggfHxcbiAgICB0aGlzLnkgIT09IG90aGVyLnkgfHxcbiAgICB0aGlzLnogIT09IG90aGVyLnpcbiAgICApO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21KU09OXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiBzZXRzIHZhbHVlcyBmcm9tIEpTT04gb2JqZWN0XG4gKiBAcGFyYW0gT2JqZWN0IGpzb25cbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWMzLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG5cbiAgICB0aGlzLnggPSBqc29uLng7XG4gICAgdGhpcy55ID0ganNvbi55O1xuICAgIHRoaXMueiA9IGpzb24uejtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRvSlNPTlxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogcmV0dXJucyBqc29uIG9iamVjdCBvZiB0aGlzXG4gKiBAcmV0dXJuIE9iamVjdFxuICovXG5WZWMzLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gfHwgKGpzb24gPSB7fSk7XG5cbiAgICBqc29uLl9jbGFzc05hbWUgPSBcIlZlYzNcIjtcbiAgICBqc29uLnggPSB0aGlzLng7XG4gICAganNvbi55ID0gdGhpcy55O1xuICAgIGpzb24ueiA9IHRoaXMuejtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21BcnJheVxuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogc2V0cyB2YWx1ZXMgZnJvbSBBcnJheSBvYmplY3RcbiAqIEBwYXJhbSBBcnJheSBhcnJheVxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzMucHJvdG90eXBlLmZyb21BcnJheSA9IGZ1bmN0aW9uIChhcnJheSkge1xuXG4gICAgdGhpcy54ID0gYXJyYXlbMF07XG4gICAgdGhpcy55ID0gYXJyYXlbMV07XG4gICAgdGhpcy56ID0gYXJyYXlbMl07XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b0FycmF5XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWMzXG4gKiByZXR1cm5zIGFycmF5IG9iamVjdCBvZiB0aGlzXG4gKiBAcmV0dXJuIEFycmF5XG4gKi9cblZlYzMucHJvdG90eXBlLnRvQXJyYXkgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICBhcnJheSB8fCAoYXJyYXkgPSBbXSk7XG5cbiAgICBhcnJheVswXSA9IHRoaXMueDtcbiAgICBhcnJheVsxXSA9IHRoaXMueTtcbiAgICBhcnJheVsyXSA9IHRoaXMuejtcblxuICAgIHJldHVybiBhcnJheTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b1N0cmluZ1xuICogQG1lbWJlcm9mIE9kaW4uVmVjM1xuICogcmV0dXJucyBzdHJpbmcgb2YgdGhpc1xuICogQHJldHVybiBTdHJpbmdcbiAqL1xuVmVjMy5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gXCJWZWMzKCBcIiArIHRoaXMueCArIFwiLCBcIiArIHRoaXMueSArIFwiLCBcIiArIHRoaXMueiArIFwiIClcIjtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBWZWMzO1xuIiwidmFyIE1hdGhmID0gcmVxdWlyZShcIi4vbWF0aGZcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgc3FydCA9IE1hdGguc3FydDtcblxuLyoqXG4gKiBAY2xhc3MgVmVjNFxuICogM2QgdmVjdG9yXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEBwYXJhbSBOdW1iZXIgeVxuICogQHBhcmFtIE51bWJlciB6XG4gKiBAcGFyYW0gTnVtYmVyIHdcbiAqL1xuZnVuY3Rpb24gVmVjNCh4LCB5LCB6LCB3KSB7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIHhcbiAgICAgKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gICAgICovXG4gICAgdGhpcy54ID0geCB8fCAwLjA7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIHlcbiAgICAgKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gICAgICovXG4gICAgdGhpcy55ID0geSB8fCAwLjA7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIHpcbiAgICAgKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gICAgICovXG4gICAgdGhpcy56ID0geiB8fCAwLjA7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIHdcbiAgICAgKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gICAgICovXG4gICAgdGhpcy53ID0gdyAhPSB1bmRlZmluZWQgPyB3IDogMS4wO1xufVxuXG5NYXRoZi5fY2xhc3Nlc1tcIlZlYzRcIl0gPSBWZWM0O1xuXG4vKipcbiAqIEBtZXRob2QgY2xvbmVcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzRcbiAqIHJldHVybnMgbmV3IGluc3RhbmNlIG9mIHRoaXNcbiAqIEByZXR1cm4gVmVjNFxuICovXG5WZWM0LnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiBuZXcgVmVjNCh0aGlzLngsIHRoaXMueSwgdGhpcy56LCB0aGlzLncpO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGNvcHlcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzRcbiAqIGNvcGllcyBvdGhlclxuICogQHBhcmFtIFZlYzQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICB0aGlzLnggPSBvdGhlci54O1xuICAgIHRoaXMueSA9IG90aGVyLnk7XG4gICAgdGhpcy56ID0gb3RoZXIuejtcbiAgICB0aGlzLncgPSBvdGhlci53O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiBzZXRzIHZhbHVlcyBvZiB0aGlzXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEBwYXJhbSBOdW1iZXIgeVxuICogQHBhcmFtIE51bWJlciB6XG4gKiBAcGFyYW0gTnVtYmVyIHdcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCwgeSwgeiwgdykge1xuXG4gICAgdGhpcy54ID0geDtcbiAgICB0aGlzLnkgPSB5O1xuICAgIHRoaXMueiA9IHo7XG4gICAgdGhpcy53ID0gdztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGFkZFxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogYWRkcyBvdGhlcidzIHZhbHVlcyB0byB0aGlzXG4gKiBAcGFyYW0gVmVjNCBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzQucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChvdGhlcikge1xuXG4gICAgdGhpcy54ICs9IG90aGVyLng7XG4gICAgdGhpcy55ICs9IG90aGVyLnk7XG4gICAgdGhpcy56ICs9IG90aGVyLno7XG4gICAgdGhpcy53ICs9IG90aGVyLnc7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB2YWRkXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiBhZGRzIGEgYW5kIGIgdG9nZXRoZXIgc2F2ZXMgaXQgaW4gdGhpc1xuICogQHBhcmFtIFZlYzQgYVxuICogQHBhcmFtIFZlYzQgYlxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzQucHJvdG90eXBlLnZhZGQgPSBmdW5jdGlvbiAoYSwgYikge1xuXG4gICAgdGhpcy54ID0gYS54ICsgYi54O1xuICAgIHRoaXMueSA9IGEueSArIGIueTtcbiAgICB0aGlzLnogPSBhLnogKyBiLno7XG4gICAgdGhpcy53ID0gYS53ICsgYi53O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2FkZFxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogYWRkcyBzY2FsYXIgdmFsdWUgdG8gdGhpc1xuICogQHBhcmFtIE51bWJlciBzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjNC5wcm90b3R5cGUuc2FkZCA9IGZ1bmN0aW9uIChzKSB7XG5cbiAgICB0aGlzLnggKz0gcztcbiAgICB0aGlzLnkgKz0gcztcbiAgICB0aGlzLnogKz0gcztcbiAgICB0aGlzLncgKz0gcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHN1YlxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogc3VidHJhY3RzIG90aGVyJ3MgdmFsdWVzIGZyb20gdGhpc1xuICogQHBhcmFtIFZlYzQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS5zdWIgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMueCAtPSBvdGhlci54O1xuICAgIHRoaXMueSAtPSBvdGhlci55O1xuICAgIHRoaXMueiAtPSBvdGhlci56O1xuICAgIHRoaXMudyAtPSBvdGhlci53O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdnN1YlxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogc3VidHJhY3RzIGIgZnJvbSBhIHNhdmVzIGl0IGluIHRoaXNcbiAqIEBwYXJhbSBWZWM0IGFcbiAqIEBwYXJhbSBWZWM0IGJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS52c3ViID0gZnVuY3Rpb24gKGEsIGIpIHtcblxuICAgIHRoaXMueCA9IGEueCAtIGIueDtcbiAgICB0aGlzLnkgPSBhLnkgLSBiLnk7XG4gICAgdGhpcy56ID0gYS56IC0gYi56O1xuICAgIHRoaXMudyA9IGEudyAtIGIudztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHNzdWJcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzRcbiAqIHN1YnRyYWN0cyB0aGlzIGJ5IGEgc2NhbGFyIHZhbHVlXG4gKiBAcGFyYW0gTnVtYmVyIHNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS5zc3ViID0gZnVuY3Rpb24gKHMpIHtcblxuICAgIHRoaXMueCAtPSBzO1xuICAgIHRoaXMueSAtPSBzO1xuICAgIHRoaXMueiAtPSBzO1xuICAgIHRoaXMudyAtPSBzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbXVsXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiBtdWxpcGxlcyB0aGlzJ3MgdmFsdWVzIGJ5IG90aGVyJ3NcbiAqIEBwYXJhbSBWZWM0IG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjNC5wcm90b3R5cGUubXVsID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICB0aGlzLnggKj0gb3RoZXIueDtcbiAgICB0aGlzLnkgKj0gb3RoZXIueTtcbiAgICB0aGlzLnogKj0gb3RoZXIuejtcbiAgICB0aGlzLncgKj0gb3RoZXIudztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHZtdWxcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzRcbiAqIG11bGlwbGVzIGEgYW5kIGIgc2F2ZXMgaXQgaW4gdGhpc1xuICogQHBhcmFtIFZlYzQgYVxuICogQHBhcmFtIFZlYzQgYlxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzQucHJvdG90eXBlLnZtdWwgPSBmdW5jdGlvbiAoYSwgYikge1xuXG4gICAgdGhpcy54ID0gYS54ICogYi54O1xuICAgIHRoaXMueSA9IGEueSAqIGIueTtcbiAgICB0aGlzLnogPSBhLnogKiBiLno7XG4gICAgdGhpcy53ID0gYS53ICogYi53O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc211bFxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogbXVsaXBsZXMgdGhpcyBieSBhIHNjYWxhciB2YWx1ZVxuICogQHBhcmFtIE51bWJlciBzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjNC5wcm90b3R5cGUuc211bCA9IGZ1bmN0aW9uIChzKSB7XG5cbiAgICB0aGlzLnggKj0gcztcbiAgICB0aGlzLnkgKj0gcztcbiAgICB0aGlzLnogKj0gcztcbiAgICB0aGlzLncgKj0gcztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGRpdlxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogZGl2aWRlcyB0aGlzJ3MgdmFsdWVzIGJ5IG90aGVyJ3NcbiAqIEBwYXJhbSBWZWM0IG90aGVyXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjNC5wcm90b3R5cGUuZGl2ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIHggPSBvdGhlci54LFxuICAgICAgICB5ID0gb3RoZXIueSxcbiAgICAgICAgeiA9IG90aGVyLnosXG4gICAgICAgIHcgPSBvdGhlci53O1xuXG4gICAgdGhpcy54ICo9IHggIT09IDAuMCA/IDEuMCAvIHggOiAwLjA7XG4gICAgdGhpcy55ICo9IHkgIT09IDAuMCA/IDEuMCAvIHkgOiAwLjA7XG4gICAgdGhpcy56ICo9IHogIT09IDAuMCA/IDEuMCAvIHogOiAwLjA7XG4gICAgdGhpcy53ICo9IHcgIT09IDAuMCA/IDEuMCAvIHcgOiAwLjA7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB2ZGl2XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiBkaXZpZGVzIGIgZnJvbSBhIHNhdmVzIGl0IGluIHRoaXNcbiAqIEBwYXJhbSBWZWM0IGFcbiAqIEBwYXJhbSBWZWM0IGJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS52ZGl2ID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICB2YXIgeCA9IGIueCxcbiAgICAgICAgeSA9IGIueSxcbiAgICAgICAgeiA9IGIueixcbiAgICAgICAgdyA9IGIudztcblxuICAgIHRoaXMueCA9IHggIT09IDAuMCA/IGEueCAvIHggOiAwLjA7XG4gICAgdGhpcy55ID0geSAhPT0gMC4wID8gYS55IC8geSA6IDAuMDtcbiAgICB0aGlzLnogPSB6ICE9PSAwLjAgPyBhLnogLyB6IDogMC4wO1xuICAgIHRoaXMudyA9IHcgIT09IDAuMCA/IGEudyAvIHcgOiAwLjA7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBzZGl2XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiBkaXZpZGVzIHRoaXMgYnkgc2NhbGFyIHZhbHVlXG4gKiBAcGFyYW0gTnVtYmVyIHNcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS5zZGl2ID0gZnVuY3Rpb24gKHMpIHtcbiAgICBzID0gcyA9PT0gMC4wID8gMC4wIDogMS4wIC8gcztcblxuICAgIHRoaXMueCAqPSBzO1xuICAgIHRoaXMueSAqPSBzO1xuICAgIHRoaXMueiAqPSBzO1xuICAgIHRoaXMudyAqPSBzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgbGVuZ3RoXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiByZXR1cm5zIHRoZSBsZW5ndGggb2YgdGhpc1xuICogQHJldHVybiBOdW1iZXJcbiAqL1xuVmVjNC5wcm90b3R5cGUubGVuZ3RoID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICB6ID0gdGhpcy56LFxuICAgICAgICB3ID0gdGhpcy53LFxuICAgICAgICBsc3EgPSB4ICogeCArIHkgKiB5ICsgeiAqIHogKyB3ICogdztcblxuICAgIGlmIChsc3EgPT09IDEpIHJldHVybiAxO1xuXG4gICAgcmV0dXJuIGxzcSA+IDAuMCA/IHNxcnQobHNxKSA6IDAuMDtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBsZW5ndGhTcVxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogcmV0dXJucyB0aGUgc3F1YXJlZCBsZW5ndGggb2YgdGhpc1xuICogQHJldHVybiBOdW1iZXJcbiAqL1xuVmVjNC5wcm90b3R5cGUubGVuZ3RoU3EgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHggPSB0aGlzLngsXG4gICAgICAgIHkgPSB0aGlzLnksXG4gICAgICAgIHogPSB0aGlzLnosXG4gICAgICAgIHcgPSB0aGlzLnc7XG5cbiAgICByZXR1cm4geCAqIHggKyB5ICogeSArIHogKiB6ICsgdyAqIHc7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgc2V0TGVuZ3RoXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiBzZXRzIHRoaXMgc28gaXRzIG1hZ25pdHVkZSBpcyBlcXVhbCB0byBsZW5ndGhcbiAqIEBwYXJhbSBOdW1iZXIgbGVuZ3RoXG4gKiBAcmV0dXJuIFZlYzRcbiAqL1xuVmVjNC5wcm90b3R5cGUuc2V0TGVuZ3RoID0gZnVuY3Rpb24gKGxlbmd0aCkge1xuICAgIHZhciB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICB6ID0gdGhpcy56LFxuICAgICAgICB3ID0gdGhpcy53LFxuICAgICAgICBsID0geCAqIHggKyB5ICogeSArIHogKiB6ICsgdyAqIHc7XG5cbiAgICBpZiAobCA9PT0gMSkge1xuICAgICAgICB0aGlzLnggKj0gbGVuZ3RoO1xuICAgICAgICB0aGlzLnkgKj0gbGVuZ3RoO1xuICAgICAgICB0aGlzLnogKj0gbGVuZ3RoO1xuICAgICAgICB0aGlzLncgKj0gbGVuZ3RoO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGwgPSBsID4gMC4wID8gMS4wIC8gc3FydChsKSA6IDAuMDtcblxuICAgIHRoaXMueCAqPSBsICogbGVuZ3RoO1xuICAgIHRoaXMueSAqPSBsICogbGVuZ3RoO1xuICAgIHRoaXMueiAqPSBsICogbGVuZ3RoO1xuICAgIHRoaXMudyAqPSBsICogbGVuZ3RoO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2Qgbm9ybWFsaXplXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiByZXR1cm5zIHRoaXMgd2l0aCBhIGxlbmd0aCBvZiAxXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjNC5wcm90b3R5cGUubm9ybWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICB6ID0gdGhpcy56LFxuICAgICAgICB3ID0gdGhpcy53LFxuICAgICAgICBsID0geCAqIHggKyB5ICogeSArIHogKiB6ICsgdyAqIHc7XG5cbiAgICBpZiAobCA9PT0gMSkgcmV0dXJuIHRoaXM7XG5cbiAgICBsID0gbCA+IDAuMCA/IDEuMCAvIHNxcnQobCkgOiAwLjA7XG5cbiAgICB0aGlzLnggKj0gbDtcbiAgICB0aGlzLnkgKj0gbDtcbiAgICB0aGlzLnogKj0gbDtcbiAgICB0aGlzLncgKj0gbDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIG9ydGhvTm9ybWFsaXplXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiByZXR1cm5zIG1ha2VzIHZlY3RvcnMgbm9ybWFsaXplZCBhbmQgb3J0aG9nb25hbCB0byBlYWNoIG90aGVyXG4gKiBAcGFyYW0gVmVjNCBhXG4gKiBAcGFyYW0gVmVjNCBiXG4gKiBAcGFyYW0gVmVjNCBjXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjNC5wcm90b3R5cGUub3J0aG9Ob3JtYWxpemUgPSBmdW5jdGlvbiAoYSwgYiwgYykge1xuICAgIGlmIChhLmxlbmd0aFNxKCkgIT09IDEuMCkgYS5ub3JtYWxpemUoKTtcbiAgICBjLnZjcm9zcyhhLCBiKTtcbiAgICBpZiAoYS5sZW5ndGhTcSgpID09PSAwLjApIHJldHVybjtcbiAgICBjLm5vcm1hbGl6ZSgpO1xuICAgIGIudmNyb3NzKGMsIGEpO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGludmVyc2VcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzRcbiAqIHJldHVybnMgdGhlIGludmVyc2Ugb2YgdGhpc1xuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzQucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLnggKj0gLTE7XG4gICAgdGhpcy55ICo9IC0xO1xuICAgIHRoaXMueiAqPSAtMTtcbiAgICB0aGlzLncgKj0gLTE7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBpbnZlcnNlVmVjXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiByZXR1cm5zIHRoZSBpbnZlcnNlIG9mIG90aGVyXG4gKiBAcGFyYW0gVmVjNCBvdGhlclxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzQucHJvdG90eXBlLmludmVyc2VWZWMgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHRoaXMueCA9IC1vdGhlci54O1xuICAgIHRoaXMueSA9IC1vdGhlci55O1xuICAgIHRoaXMueiA9IC0ob3RoZXIueiB8fCAwKTtcbiAgICB0aGlzLncgPSAtKG90aGVyLncgfHwgMCk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBsZXJwXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiBsaW5lYXIgaW50ZXJwb2xhdGlvbiBiZXR3ZWVuIHRoaXMgYW5kIG90aGVyIGJ5IHhcbiAqIEBwYXJhbSBWZWM0IG90aGVyXG4gKiBAcGFyYW0gTnVtYmVyIHhcbiAqIEByZXR1cm4gVmVjNFxuICovXG5WZWM0LnByb3RvdHlwZS5sZXJwID0gZnVuY3Rpb24gKG90aGVyLCB4KSB7XG5cbiAgICB0aGlzLnggKz0gKG90aGVyLnggLSB0aGlzLngpICogeDtcbiAgICB0aGlzLnkgKz0gKG90aGVyLnkgLSB0aGlzLnkpICogeDtcbiAgICB0aGlzLnogKz0gKG90aGVyLnogLSB0aGlzLnopICogeDtcbiAgICB0aGlzLncgKz0gKG90aGVyLncgLSB0aGlzLncpICogeDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHZsZXJwXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiBsaW5lYXIgaW50ZXJwb2xhdGlvbiBiZXR3ZWVuIGEgYW5kIGIgYnkgeFxuICogQHBhcmFtIFZlYzQgYVxuICogQHBhcmFtIFZlYzQgYlxuICogQHBhcmFtIE51bWJlciB4XG4gKiBAcmV0dXJuIFZlYzRcbiAqL1xuVmVjNC5wcm90b3R5cGUudmxlcnAgPSBmdW5jdGlvbiAoYSwgYiwgeCkge1xuICAgIHZhciBheCA9IGEueCxcbiAgICAgICAgYXkgPSBhLnksXG4gICAgICAgIGF6ID0gYS56LFxuICAgICAgICBhdyA9IGEudztcblxuICAgIHRoaXMueCA9IGF4ICsgKGIueCAtIGF4KSAqIHg7XG4gICAgdGhpcy55ID0gYXkgKyAoYi55IC0gYXkpICogeDtcbiAgICB0aGlzLnogPSBheiArIChiLnogLSBheikgKiB4O1xuICAgIHRoaXMudyA9IGF3ICsgKGIudyAtIGF3KSAqIHg7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB2ZG90XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiBkb3QgcHJvZHVjdCBvZiB0d28gdmVjdG9ycywgY2FuIGJlIGNhbGxlZCBhcyBhIHN0YXRpYyBmdW5jdGlvbiBWZWM0LnZkb3QoIGEsIGIgKVxuICogQHBhcmFtIFZlYzQgYVxuICogQHBhcmFtIFZlYzQgYlxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuVmVjNC52ZG90ID0gVmVjNC5wcm90b3R5cGUudmRvdCA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cbiAgICByZXR1cm4gYS54ICogYi54ICsgYS55ICogYi55ICsgYS56ICogYi56ICsgYS53ICogYi53O1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGRvdFxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogZG90IHByb2R1Y3Qgb2YgdGhpcyBhbmQgb3RoZXIgdmVjdG9yXG4gKiBAcGFyYW0gVmVjNCBvdGhlclxuICogQHJldHVybiBOdW1iZXJcbiAqL1xuVmVjNC5wcm90b3R5cGUuZG90ID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICByZXR1cm4gdGhpcy54ICogb3RoZXIueCArIHRoaXMueSAqIG90aGVyLnkgKyB0aGlzLnogKiBvdGhlci56ICsgdGhpcy53ICogb3RoZXIudztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtaW5cbiAqIEBtZW1iZXJvZiBPZGluLlZlYzRcbiAqIHJldHVybnMgbWluIHZhbHVlcyBmcm9tIHRoaXMgYW5kIG90aGVyIHZlY3RvclxuICogQHBhcmFtIFZlYzQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS5taW4gPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYXggPSB0aGlzLngsXG4gICAgICAgIGF5ID0gdGhpcy55LFxuICAgICAgICBheiA9IHRoaXMueixcbiAgICAgICAgYXcgPSB0aGlzLncsXG4gICAgICAgIGJ4ID0gb3RoZXIueCxcbiAgICAgICAgYnkgPSBvdGhlci55LFxuICAgICAgICBieiA9IG90aGVyLnosXG4gICAgICAgIGJ3ID0gdGhpcy53O1xuXG4gICAgdGhpcy54ID0gYnggPCBheCA/IGJ4IDogYXg7XG4gICAgdGhpcy55ID0gYnkgPCBheSA/IGJ5IDogYXk7XG4gICAgdGhpcy56ID0gYnogPCBheiA/IGJ6IDogYXo7XG4gICAgdGhpcy53ID0gYncgPCBhdyA/IGJ3IDogYXc7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBtYXhcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzRcbiAqIHJldHVybnMgbWF4IHZhbHVlcyBmcm9tIHRoaXMgYW5kIG90aGVyIHZlY3RvclxuICogQHBhcmFtIFZlYzQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS5tYXggPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYXggPSB0aGlzLngsXG4gICAgICAgIGF5ID0gdGhpcy55LFxuICAgICAgICBheiA9IHRoaXMueixcbiAgICAgICAgYXcgPSB0aGlzLncsXG4gICAgICAgIGJ4ID0gb3RoZXIueCxcbiAgICAgICAgYnkgPSBvdGhlci55LFxuICAgICAgICBieiA9IG90aGVyLnosXG4gICAgICAgIGJ3ID0gdGhpcy53O1xuXG4gICAgdGhpcy54ID0gYnggPiBheCA/IGJ4IDogYXg7XG4gICAgdGhpcy55ID0gYnkgPiBheSA/IGJ5IDogYXk7XG4gICAgdGhpcy56ID0gYnogPiBheiA/IGJ6IDogYXo7XG4gICAgdGhpcy53ID0gYncgPiBhdyA/IGJ3IDogYXc7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBjbGFtcFxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogY2xhbXAgdmFsdWVzIGJldHdlZW4gbWluIGFuZCBtYXgncyB2YWx1ZXNcbiAqIEBwYXJhbSBWZWM0IG1pblxuICogQHBhcmFtIFZlYzQgbWF4XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjNC5wcm90b3R5cGUuY2xhbXAgPSBmdW5jdGlvbiAobWluLCBtYXgpIHtcbiAgICB2YXIgeCA9IHRoaXMueCxcbiAgICAgICAgeSA9IHRoaXMueSxcbiAgICAgICAgeiA9IHRoaXMueixcbiAgICAgICAgdyA9IHRoaXMudyxcbiAgICAgICAgbWlueCA9IG1pbi54LFxuICAgICAgICBtaW55ID0gbWluLnksXG4gICAgICAgIG1pbnogPSBtaW4ueixcbiAgICAgICAgbWludyA9IG1pbi53LFxuICAgICAgICBtYXh4ID0gbWF4LngsXG4gICAgICAgIG1heHkgPSBtYXgueSxcbiAgICAgICAgbWF4eiA9IG1heC56LFxuICAgICAgICBtYXh3ID0gbWF4dztcblxuICAgIHRoaXMueCA9IHggPCBtaW54ID8gbWlueCA6IHggPiBtYXh4ID8gbWF4eCA6IHg7XG4gICAgdGhpcy55ID0geSA8IG1pbnkgPyBtaW55IDogeSA+IG1heHkgPyBtYXh5IDogeTtcbiAgICB0aGlzLnogPSB6IDwgbWlueiA/IG1pbnogOiB6ID4gbWF4eiA/IG1heHogOiB6O1xuICAgIHRoaXMudyA9IHcgPCBtaW53ID8gbWludyA6IHcgPiBtYXh3ID8gbWF4dyA6IHc7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0cmFuc2Zvcm1NYXQ0XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiB0cmFuc2Zvcm1zIHRoaXMgd2l0aCBNYXQ0XG4gKiBAcGFyYW0gTWF0NCBtXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjNC5wcm90b3R5cGUudHJhbnNmb3JtTWF0NCA9IGZ1bmN0aW9uIChtKSB7XG4gICAgdmFyIG1lID0gbS5lbGVtZW50cyxcbiAgICAgICAgeCA9IHRoaXMueCxcbiAgICAgICAgeSA9IHRoaXMueSxcbiAgICAgICAgeiA9IHRoaXMueixcbiAgICAgICAgdyA9IHRoaXMudztcblxuICAgIHRoaXMueCA9IHggKiBtZVswXSArIHkgKiBtZVs0XSArIHogKiBtZVs4XSArIHcgKiBtZVsxMl07XG4gICAgdGhpcy55ID0geCAqIG1lWzFdICsgeSAqIG1lWzVdICsgeiAqIG1lWzldICsgdyAqIG1lWzEzXTtcbiAgICB0aGlzLnogPSB4ICogbWVbMl0gKyB5ICogbWVbNl0gKyB6ICogbWVbMTBdICsgdyAqIG1lWzE0XTtcbiAgICB0aGlzLncgPSB4ICogbWVbM10gKyB5ICogbWVbN10gKyB6ICogbWVbMTFdICsgdyAqIG1lWzE1XTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIHRyYW5zZm9ybVByb2plY3Rpb25cbiAqIEBtZW1iZXJvZiBPZGluLlZlYzNcbiAqIHRyYW5zZm9ybXMgdGhpcyB3aXRoIE1hdDQgcHJvamVjdGlvbiBtYXRyaXhcbiAqIEBwYXJhbSBNYXQ0IG1cbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS50cmFuc2Zvcm1Qcm9qZWN0aW9uID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgbWUgPSBtLmVsZW1lbnRzLFxuICAgICAgICB4ID0gdGhpcy54LFxuICAgICAgICB5ID0gdGhpcy55LFxuICAgICAgICB6ID0gdGhpcy56LFxuICAgICAgICB3ID0gdGhpcy53LFxuICAgICAgICBkID0gMSAvIChtZVszXSAqIHggKyBtZVs3XSAqIHkgKyBtZVsxMV0gKiB6ICsgbWVbMTVdKTtcblxuICAgIHRoaXMueCA9IChtZVswXSAqIHggKyBtZVs0XSAqIHkgKyBtZVs4XSAqIHogKyBtZVsxMl0gKiB3KSAqIGQ7XG4gICAgdGhpcy55ID0gKG1lWzFdICogeCArIG1lWzVdICogeSArIG1lWzldICogeiArIG1lWzEzXSAqIHcpICogZDtcbiAgICB0aGlzLnogPSAobWVbMl0gKiB4ICsgbWVbNl0gKiB5ICsgbWVbMTBdICogeiArIG1lWzE0XSAqIHcpICogZDtcbiAgICB0aGlzLncgPSAobWVbM10gKiB4ICsgbWVbN10gKiB5ICsgbWVbMTFdICogeiArIG1lWzE1XSAqIHcpICogZDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21WZWMyXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiBzZXRzIHZhbHVlcyBmcm9tIFZlYzJcbiAqIEBwYXJhbSBWZWMyIHZcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS5mcm9tVmVjMiA9IGZ1bmN0aW9uICh2KSB7XG5cbiAgICB0aGlzLnggPSB2Lng7XG4gICAgdGhpcy55ID0gdi55O1xuICAgIHRoaXMueiA9IDAuMDtcbiAgICB0aGlzLncgPSAxO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgZnJvbVZlYzNcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzRcbiAqIHNldHMgdmFsdWVzIGZyb20gVmVjM1xuICogQHBhcmFtIFZlYzMgdlxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzQucHJvdG90eXBlLmZyb21WZWMzID0gZnVuY3Rpb24gKHYpIHtcblxuICAgIHRoaXMueCA9IHYueDtcbiAgICB0aGlzLnkgPSB2Lnk7XG4gICAgdGhpcy56ID0gdi56O1xuICAgIHRoaXMudyA9IDE7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tUmVjdFxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogc2V0cyB2YWx1ZXMgZnJvbSBSZWN0XG4gKiBAcGFyYW0gVmVjMyB2XG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjNC5wcm90b3R5cGUuZnJvbVJlY3QgPSBmdW5jdGlvbiAocmVjdCkge1xuXG4gICAgdGhpcy54ID0gcmVjdC54O1xuICAgIHRoaXMueSA9IHJlY3QueTtcbiAgICB0aGlzLnogPSByZWN0LndpZHRoO1xuICAgIHRoaXMudyA9IHJlY3QuaGVpZ2h0O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgcG9zaXRpb25Gcm9tTWF0NFxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogc2V0cyBwb3NpdGlvbiBmcm9tIE1hdDRcbiAqIEBwYXJhbSBNYXQ0IG1cbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS5wb3NpdGlvbkZyb21NYXQ0ID0gZnVuY3Rpb24gKG0pIHtcbiAgICB2YXIgbWUgPSBtLmVsZW1lbnRzO1xuXG4gICAgdGhpcy54ID0gbWVbMTJdO1xuICAgIHRoaXMueSA9IG1lWzEzXTtcbiAgICB0aGlzLnogPSBtZVsxNF07XG4gICAgdGhpcy53ID0gbWVbMTVdO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzRcbiAqIEBwYXJhbSBPZGluLlZlYzQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHJldHVybiAhKFxuICAgIHRoaXMueCAhPT0gb3RoZXIueCB8fFxuICAgIHRoaXMueSAhPT0gb3RoZXIueSB8fFxuICAgIHRoaXMueiAhPT0gb3RoZXIueiB8fFxuICAgIHRoaXMudyAhPT0gb3RoZXIud1xuICAgICk7XG59O1xuXG4vKipcbiAqIEBtZW1iZXJvZiBPZGluLlZlYzRcbiAqIEBwYXJhbSBPZGluLlZlYzQgb3RoZXJcbiAqIEByZXR1cm4gdGhpc1xuICovXG5WZWM0LnByb3RvdHlwZS5ub3RFcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHtcblxuICAgIHJldHVybiAoXG4gICAgdGhpcy54ICE9PSBvdGhlci54IHx8XG4gICAgdGhpcy55ICE9PSBvdGhlci55IHx8XG4gICAgdGhpcy56ICE9PSBvdGhlci56IHx8XG4gICAgdGhpcy53ICE9PSBvdGhlci53XG4gICAgKTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCBmcm9tSlNPTlxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogc2V0cyB2YWx1ZXMgZnJvbSBKU09OIG9iamVjdFxuICogQHBhcmFtIE9iamVjdCBqc29uXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuVmVjNC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuXG4gICAgdGhpcy54ID0ganNvbi54O1xuICAgIHRoaXMueSA9IGpzb24ueTtcbiAgICB0aGlzLnogPSBqc29uLno7XG4gICAgdGhpcy53ID0ganNvbi53O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBtZXRob2QgdG9KU09OXG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiByZXR1cm5zIGpzb24gb2JqZWN0IG9mIHRoaXNcbiAqIEByZXR1cm4gT2JqZWN0XG4gKi9cblZlYzQucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiB8fCAoanNvbiA9IHt9KTtcblxuICAgIGpzb24uX2NsYXNzTmFtZSA9IFwiVmVjNFwiO1xuICAgIGpzb24ueCA9IHRoaXMueDtcbiAgICBqc29uLnkgPSB0aGlzLnk7XG4gICAganNvbi56ID0gdGhpcy56O1xuICAgIGpzb24udyA9IHRoaXMudztcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuLyoqXG4gKiBAbWV0aG9kIGZyb21BcnJheVxuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogc2V0cyB2YWx1ZXMgZnJvbSBBcnJheSBvYmplY3RcbiAqIEBwYXJhbSBBcnJheSBhcnJheVxuICogQHJldHVybiB0aGlzXG4gKi9cblZlYzQucHJvdG90eXBlLmZyb21BcnJheSA9IGZ1bmN0aW9uIChhcnJheSkge1xuXG4gICAgdGhpcy54ID0gYXJyYXlbMF07XG4gICAgdGhpcy55ID0gYXJyYXlbMV07XG4gICAgdGhpcy56ID0gYXJyYXlbMl07XG4gICAgdGhpcy53ID0gYXJyYXlbM107XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b0FycmF5XG4gKiBAbWVtYmVyb2YgT2Rpbi5WZWM0XG4gKiByZXR1cm5zIGFycmF5IG9iamVjdCBvZiB0aGlzXG4gKiBAcmV0dXJuIEFycmF5XG4gKi9cblZlYzQucHJvdG90eXBlLnRvQXJyYXkgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICBhcnJheSB8fCAoYXJyYXkgPSBbXSk7XG5cbiAgICBhcnJheVswXSA9IHRoaXMueDtcbiAgICBhcnJheVsxXSA9IHRoaXMueTtcbiAgICBhcnJheVsyXSA9IHRoaXMuejtcbiAgICBhcnJheVszXSA9IHRoaXMudztcblxuICAgIHJldHVybiBhcnJheTtcbn07XG5cbi8qKlxuICogQG1ldGhvZCB0b1N0cmluZ1xuICogQG1lbWJlcm9mIE9kaW4uVmVjNFxuICogcmV0dXJucyBzdHJpbmcgb2YgdGhpc1xuICogQHJldHVybiBTdHJpbmdcbiAqL1xuVmVjNC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gXCJWZWM0KCBcIiArIHRoaXMueCArIFwiLCBcIiArIHRoaXMueSArIFwiLCBcIiArIHRoaXMueiArIFwiLCBcIiArIHRoaXMudyArIFwiIClcIjtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBWZWM0O1xuIiwidmFyIFAyRW51bXMgPSByZXF1aXJlKFwiLi4vcDJlbnVtc1wiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBNb3Rpb25TdGF0ZSA9IFAyRW51bXMuTW90aW9uU3RhdGUsXG4gICAgU2xlZXBTdGF0ZSA9IFAyRW51bXMuU2xlZXBTdGF0ZTtcblxuXG5mdW5jdGlvbiBQMkJyb2FkcGhhc2UoKSB7XG59XG5cblxuUDJCcm9hZHBoYXNlLnByb3RvdHlwZS5jb2xsaXNpb25zID0gZnVuY3Rpb24gKGJvZGllcywgcGFpcnNpLCBwYWlyc2opIHtcbiAgICB2YXIgbGVuZ3RoID0gYm9kaWVzLmxlbmd0aCxcbiAgICAgICAgYmksIGJqLCBzaGFwZXNpLCBzaGFwZXNqLCBsZW5ndGgsIHNpLCBzaixcbiAgICAgICAgaSA9IGxlbmd0aCxcbiAgICAgICAgaiwgaywgbDtcblxuICAgIHBhaXJzaS5sZW5ndGggPSBwYWlyc2oubGVuZ3RoID0gMDtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgaiA9IDA7XG4gICAgICAgIHdoaWxlIChqICE9PSBpKSB7XG4gICAgICAgICAgICBiaSA9IGJvZGllc1tpXTtcbiAgICAgICAgICAgIGJqID0gYm9kaWVzW2pdO1xuICAgICAgICAgICAgaisrO1xuXG4gICAgICAgICAgICBpZiAoKGJpLm1vdGlvblN0YXRlICE9PSBNb3Rpb25TdGF0ZS5EeW5hbWljICYmIGJqLm1vdGlvblN0YXRlICE9PSBNb3Rpb25TdGF0ZS5EeW5hbWljKSB8fCAoYmkuc2xlZXBTdGF0ZSA9PT0gU2xlZXBTdGF0ZS5TbGVlcGluZyAmJiBiai5zbGVlcFN0YXRlID09PSBTbGVlcFN0YXRlLlNsZWVwaW5nKSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzaGFwZXNpID0gYmkuc2hhcGVzO1xuICAgICAgICAgICAgc2hhcGVzaiA9IGJqLnNoYXBlcztcblxuICAgICAgICAgICAgaWYgKCFiaS5hYWJiLmludGVyc2VjdHMoYmouYWFiYikpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICBrID0gc2hhcGVzaS5sZW5ndGg7XG4gICAgICAgICAgICBsZW5ndGggPSBzaGFwZXNqLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChrLS0pIHtcbiAgICAgICAgICAgICAgICBsID0gbGVuZ3RoO1xuICAgICAgICAgICAgICAgIHdoaWxlIChsLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2kgPSBzaGFwZXNpW2tdO1xuICAgICAgICAgICAgICAgICAgICBzaiA9IHNoYXBlc2pbbF07XG4gICAgICAgICAgICAgICAgICAgIGlmICgoc2kuZmlsdGVyR3JvdXAgJiBzai5maWx0ZXJNYXNrKSA9PT0gMCB8fCAoc2ouZmlsdGVyR3JvdXAgJiBzaS5maWx0ZXJNYXNrKSA9PT0gMCkgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNpLmFhYmIuaW50ZXJzZWN0cyhzai5hYWJiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFpcnNpLnB1c2goc2kpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFpcnNqLnB1c2goc2opO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcblxuXG5QMkJyb2FkcGhhc2UucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiB8fCAoanNvbiA9IHt9KTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5QMkJyb2FkcGhhc2UucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUDJCcm9hZHBoYXNlO1xuIiwidmFyIFAyRW51bXMgPSByZXF1aXJlKFwiLi4vcDJlbnVtc1wiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBmbG9vciA9IE1hdGguZmxvb3IsXG4gICAgZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHksXG4gICAgTW90aW9uU3RhdGUgPSBQMkVudW1zLk1vdGlvblN0YXRlLFxuICAgIFNsZWVwU3RhdGUgPSBQMkVudW1zLlNsZWVwU3RhdGU7XG5cblxuZnVuY3Rpb24gQ2VsbChjb3VudGVyKSB7XG4gICAgQXJyYXkuY2FsbCh0aGlzKTtcbiAgICB0aGlzLl9jb3VudGVyID0gY291bnRlcjtcbn1cblxuQ2VsbC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEFycmF5LnByb3RvdHlwZSk7XG5DZWxsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IENlbGw7XG5cblxuZnVuY3Rpb24gUDJCcm9hZHBoYXNlU3BhdGlhbEhhc2gob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICB0aGlzLl9jZWxsU2l6ZSA9IDA7XG4gICAgdGhpcy5faW52ZXJzZUNlbGxTaXplID0gMDtcblxuICAgIHRoaXMuY2VsbHMgPSB7fTtcbiAgICB0aGlzLmNlbGxEZWF0aEZyYW1lQ291bnQgPSBvcHRzLmNlbGxEZWF0aEZyYW1lQ291bnQgIT0gdW5kZWZpbmVkID8gb3B0cy5jZWxsRGVhdGhGcmFtZUNvdW50IDogMzAwO1xuICAgIHRoaXMuY2VsbFNpemUgPSBvcHRzLmNlbGxTaXplICE9IHVuZGVmaW5lZCA/IG9wdHMuY2VsbFNpemUgOiAxO1xufVxuXG5cbmRlZmluZVByb3BlcnR5KFAyQnJvYWRwaGFzZVNwYXRpYWxIYXNoLnByb3RvdHlwZSwgXCJjZWxsU2l6ZVwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jZWxsU2l6ZTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhbHVlID0gdmFsdWUgPj0gMSA/IHZhbHVlIDogMTtcblxuICAgICAgICB0aGlzLl9jZWxsU2l6ZSA9IGZsb29yKHZhbHVlKTtcbiAgICAgICAgdGhpcy5faW52ZXJzZUNlbGxTaXplID0gMSAvIHRoaXMuX2NlbGxTaXplO1xuICAgIH1cbn0pO1xuXG5cblAyQnJvYWRwaGFzZVNwYXRpYWxIYXNoLnByb3RvdHlwZS5jb2xsaXNpb25zID0gZnVuY3Rpb24gKGJvZGllcywgcGFpcnNpLCBwYWlyc2opIHtcbiAgICB2YXIgY2VsbHMgPSB0aGlzLmNlbGxzLFxuICAgICAgICBjZWxsU2l6ZSA9IHRoaXMuX2NlbGxTaXplLFxuICAgICAgICBjZWxsRGVhdGhGcmFtZUNvdW50ID0gdGhpcy5jZWxsRGVhdGhGcmFtZUNvdW50LFxuICAgICAgICBpbnZlcnNlQ2VsbFNpemUgPSB0aGlzLl9pbnZlcnNlQ2VsbFNpemUsXG4gICAgICAgIGFhYmIsIG1pbiwgbWF4LCBtaW54LCBtaW55LCBib2R5LCBwb3NpdGlvbiwgc2hhcGVzLCBzaGFwZSwgeCwgeSxcbiAgICAgICAgY2VsbCwga2V5LCBzaSwgc2osIGJpLCBiaiwgaSwgaiwgaywgbDtcblxuICAgIGZvciAoa2V5IGluIGNlbGxzKSB7XG4gICAgICAgIGNlbGwgPSBjZWxsc1trZXldO1xuICAgICAgICBpZiAoY2VsbC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGlmIChjZWxsLl9jb3VudGVyLS0gPD0gMCkgZGVsZXRlIGNlbGxzW2tleV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjZWxsLl9jb3VudGVyID0gY2VsbERlYXRoRnJhbWVDb3VudDtcbiAgICAgICAgfVxuICAgICAgICBjZWxsLmxlbmd0aCA9IDA7XG4gICAgfVxuICAgIHBhaXJzaS5sZW5ndGggPSBwYWlyc2oubGVuZ3RoID0gMDtcblxuICAgIGkgPSBib2RpZXMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgYm9keSA9IGJvZGllc1tpXTtcbiAgICAgICAgc2hhcGVzID0gYm9keS5zaGFwZXM7XG4gICAgICAgIGogPSBzaGFwZXMubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoai0tKSB7XG4gICAgICAgICAgICBzaGFwZSA9IHNoYXBlc1tqXTtcbiAgICAgICAgICAgIGFhYmIgPSBzaGFwZS5hYWJiO1xuICAgICAgICAgICAgbWluID0gYWFiYi5taW47XG4gICAgICAgICAgICBtYXggPSBhYWJiLm1heDtcbiAgICAgICAgICAgIG1pbnggPSAobWluLnggKiBpbnZlcnNlQ2VsbFNpemUgfCAwKSAqIGNlbGxTaXplO1xuICAgICAgICAgICAgbWlueSA9IChtaW4ueSAqIGludmVyc2VDZWxsU2l6ZSB8IDApICogY2VsbFNpemU7XG5cbiAgICAgICAgICAgIHggPSBtaW54ICsgKChtYXgueCAtIG1pbi54KSAqIGludmVyc2VDZWxsU2l6ZSB8IDApICogY2VsbFNpemU7XG4gICAgICAgICAgICB5ID0gbWlueSArICgobWF4LnkgLSBtaW4ueSkgKiBpbnZlcnNlQ2VsbFNpemUgfCAwKSAqIGNlbGxTaXplO1xuXG4gICAgICAgICAgICBmb3IgKGsgPSBtaW54OyBrIDw9IHg7IGsgKz0gY2VsbFNpemUpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGwgPSBtaW55OyBsIDw9IHk7IGwgKz0gY2VsbFNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAga2V5ID0gayArIFwiOlwiICsgbDtcbiAgICAgICAgICAgICAgICAgICAgKGNlbGxzW2tleV0gfHwgKGNlbGxzW2tleV0gPSBuZXcgQ2VsbChjZWxsRGVhdGhGcmFtZUNvdW50KSkpLnB1c2goc2hhcGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoa2V5IGluIGNlbGxzKSB7XG4gICAgICAgIGNlbGwgPSBjZWxsc1trZXldO1xuICAgICAgICBpID0gY2VsbC5sZW5ndGg7XG5cbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgaiA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoaiAhPT0gaSkge1xuICAgICAgICAgICAgICAgIHNpID0gY2VsbFtpXTtcbiAgICAgICAgICAgICAgICBzaiA9IGNlbGxbal07XG4gICAgICAgICAgICAgICAgaisrO1xuXG4gICAgICAgICAgICAgICAgYmkgPSBzaS5ib2R5O1xuICAgICAgICAgICAgICAgIGJqID0gc2ouYm9keTtcblxuICAgICAgICAgICAgICAgIGlmIChiaSAmJiBiaikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWJpLmFhYmIuaW50ZXJzZWN0cyhiai5hYWJiKSkgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKChiaS5tb3Rpb25TdGF0ZSAhPT0gTW90aW9uU3RhdGUuRHluYW1pYyAmJiBiai5tb3Rpb25TdGF0ZSAhPT0gTW90aW9uU3RhdGUuRHluYW1pYykgfHwgKGJpLnNsZWVwU3RhdGUgPT09IFNsZWVwU3RhdGUuU2xlZXBpbmcgJiYgYmouc2xlZXBTdGF0ZSA9PT0gU2xlZXBTdGF0ZS5TbGVlcGluZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICgoc2kuZmlsdGVyR3JvdXAgJiBzai5maWx0ZXJNYXNrKSA9PT0gMCB8fCAoc2ouZmlsdGVyR3JvdXAgJiBzaS5maWx0ZXJNYXNrKSA9PT0gMCkgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcGFpcnNpLnB1c2goc2kpO1xuICAgICAgICAgICAgICAgIHBhaXJzai5wdXNoKHNqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn07XG5cblxuUDJCcm9hZHBoYXNlU3BhdGlhbEhhc2gucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiB8fCAoanNvbiA9IHt9KTtcblxuICAgIGpzb24uY2VsbFNpemUgPSB0aGlzLmNlbGxTaXplO1xuICAgIGpzb24uY2VsbERlYXRoRnJhbWVDb3VudCA9IHRoaXMuY2VsbERlYXRoRnJhbWVDb3VudDtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5QMkJyb2FkcGhhc2VTcGF0aWFsSGFzaC5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuXG4gICAgdGhpcy5jZWxsU2l6ZSA9IGpzb24uY2VsbFNpemU7XG4gICAgdGhpcy5jZWxsRGVhdGhGcmFtZUNvdW50ID0ganNvbi5jZWxsRGVhdGhGcmFtZUNvdW50O1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUDJCcm9hZHBoYXNlU3BhdGlhbEhhc2g7XG4iLCJ2YXIgT2JqZWN0UG9vbCA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL29iamVjdF9wb29sXCIpO1xudmFyIE1hdGhmID0gcmVxdWlyZShcIi4uLy4uL21hdGgvbWF0aGZcIik7XG52YXIgVmVjMiA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3ZlYzJcIik7XG52YXIgUDJFbnVtcyA9IHJlcXVpcmUoXCIuLi9wMmVudW1zXCIpO1xudmFyIFAyQ29udGFjdCA9IHJlcXVpcmUoXCIuLi9jb25zdHJhaW50cy9wMmNvbnRhY3RcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgbWluID0gTWF0aC5taW4sXG4gICAgYWJzID0gTWF0aC5hYnMsXG4gICAgc3FydCA9IE1hdGguc3FydCxcblxuICAgIEVQU0lMT04gPSBNYXRoZi5FUFNJTE9OLFxuXG4gICAgQm9keVR5cGUgPSBQMkVudW1zLkJvZHlUeXBlLFxuICAgIFNoYXBlVHlwZSA9IFAyRW51bXMuU2hhcGVUeXBlLFxuXG4gICAgQ09OVEFDVF9QT09MID0gbmV3IE9iamVjdFBvb2woUDJDb250YWN0KTtcblxuXG5mdW5jdGlvbiBjbGVhckNvbnRhY3QoY29udGFjdCkge1xuXG4gICAgY29udGFjdC5iaSA9IGNvbnRhY3QuYmogPSB1bmRlZmluZWQ7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNvbnRhY3QoYmksIGJqLCBlLCB1LCBueCwgbnksIHB4LCBweSwgcywgY29udGFjdHMpIHtcbiAgICB2YXIgYyA9IENPTlRBQ1RfUE9PTC5jcmVhdGUoKSxcbiAgICAgICAgbiA9IGMubixcbiAgICAgICAgcCA9IGMucDtcblxuICAgIGMuYmkgPSBiaTtcbiAgICBjLmJqID0gYmo7XG5cbiAgICBjLmUgPSBlO1xuICAgIGMudSA9IHU7XG5cbiAgICBuLnggPSBueDtcbiAgICBuLnkgPSBueTtcblxuICAgIHAueCA9IHB4O1xuICAgIHAueSA9IHB5O1xuXG4gICAgYy5zID0gcztcblxuICAgIGNvbnRhY3RzLnB1c2goYyk7XG59XG5cbmZ1bmN0aW9uIGNpcmNsZTJDaXJjbGUoc2ksIHNqLCB4aXgsIHhpeSwgcmksIHhqeCwgeGp5LCByaiwgY29udGFjdHMpIHtcbiAgICB2YXIgZHggPSB4anggLSB4aXgsXG4gICAgICAgIGR5ID0geGp5IC0geGl5LFxuICAgICAgICBkaXN0ID0gZHggKiBkeCArIGR5ICogZHksXG4gICAgICAgIGludkRpc3QsIHNlcGFyYXRpb24gPSAwLjAsXG4gICAgICAgIHIgPSByaSArIHJqLFxuICAgICAgICBueCwgbnk7XG5cbiAgICBpZiAoZGlzdCA+IHIgKiByKSByZXR1cm47XG4gICAgaWYgKCFjb2xsaWRlKHNpLCBzaikpIHJldHVybjtcblxuICAgIGlmIChkaXN0IDwgRVBTSUxPTikge1xuICAgICAgICBueCA9IDAuMDtcbiAgICAgICAgbnkgPSAxLjA7XG4gICAgICAgIGludkRpc3QgPSAwLjA7XG4gICAgICAgIHNlcGFyYXRpb24gPSAtcjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBkaXN0ID0gc3FydChkaXN0KTtcbiAgICAgICAgaW52RGlzdCA9IDEuMCAvIGRpc3Q7XG5cbiAgICAgICAgbnggPSBkeCAqIGludkRpc3Q7XG4gICAgICAgIG55ID0gZHkgKiBpbnZEaXN0O1xuXG4gICAgICAgIHNlcGFyYXRpb24gPSBkaXN0IC0gcjtcbiAgICB9XG5cbiAgICBjcmVhdGVDb250YWN0KFxuICAgICAgICBzaS5ib2R5LFxuICAgICAgICBzai5ib2R5LFxuICAgICAgICAxLjAgKyBtaW4oc2kuZWxhc3RpY2l0eSwgc2ouZWxhc3RpY2l0eSksXG4gICAgICAgIG1pbihzaS5mcmljdGlvbiwgc2ouZnJpY3Rpb24pLFxuICAgICAgICBueCxcbiAgICAgICAgbnksXG4gICAgICAgIHhqeCAtIHJqICogbngsXG4gICAgICAgIHhqeSAtIHJqICogbnksXG4gICAgICAgIHNlcGFyYXRpb24sXG4gICAgICAgIGNvbnRhY3RzXG4gICAgKTtcbn1cblxuZnVuY3Rpb24gUDJOZWFycGhhc2UoKSB7XG59XG5cblAyTmVhcnBoYXNlLkNPTlRBQ1RfUE9PTCA9IENPTlRBQ1RfUE9PTDtcblxuXG5QMk5lYXJwaGFzZS5wcm90b3R5cGUuY29sbGlzaW9ucyA9IGZ1bmN0aW9uIChwYWlyc2ksIHBhaXJzaiwgY29udGFjdHMpIHtcbiAgICB2YXIgc2ksIHNqLFxuICAgICAgICBpID0gcGFpcnNpLmxlbmd0aDtcblxuICAgIGNvbnRhY3RzLmxlbmd0aCA9IDA7XG4gICAgQ09OVEFDVF9QT09MLmNsZWFyRm9yRWFjaChjbGVhckNvbnRhY3QpO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBzaSA9IHBhaXJzaVtpXTtcbiAgICAgICAgc2ogPSBwYWlyc2pbaV07XG5cbiAgICAgICAgY29sbGlzaW9uVHlwZShzaSwgc2osIGNvbnRhY3RzKTtcbiAgICB9XG59O1xuXG5cbmZ1bmN0aW9uIGNvbGxpZGUoc2ksIHNqKSB7XG4gICAgdmFyIGJpID0gc2kuYm9keSxcbiAgICAgICAgYmogPSBzai5ib2R5LFxuICAgICAgICBpID0gYmkuX2luZGV4LFxuICAgICAgICBqID0gYmouX2luZGV4LFxuICAgICAgICBzcGFjZSA9IGJpLnNwYWNlIHx8IGJqLnNwYWNlO1xuXG4gICAgaWYgKCFzcGFjZSkgcmV0dXJuIGZhbHNlO1xuICAgIHNwYWNlLmNvbGxpc2lvbk1hdHJpeFNldChpLCBqLCAxLCB0cnVlKTtcblxuICAgIGlmIChzcGFjZS5jb2xsaXNpb25NYXRyaXhHZXQoaSwgaiwgdHJ1ZSkgIT09IHNwYWNlLmNvbGxpc2lvbk1hdHJpeEdldChpLCBqLCBmYWxzZSkpIHtcbiAgICAgICAgYmkud2FrZSgpO1xuICAgICAgICBiai53YWtlKCk7XG5cbiAgICAgICAgYmkuZW1pdChcImNvbGxpZGVcIiwgYmosIHNpLCBzaik7XG4gICAgICAgIGJqLmVtaXQoXCJjb2xsaWRlXCIsIGJpLCBzaiwgc2kpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGJpLndha2UoKTtcbiAgICAgICAgYmoud2FrZSgpO1xuXG4gICAgICAgIGJpLmVtaXQoXCJjb2xsaWRpbmdcIiwgYmosIHNpLCBzaik7XG4gICAgICAgIGJqLmVtaXQoXCJjb2xsaWRpbmdcIiwgYmksIHNqLCBzaSk7XG4gICAgfVxuXG4gICAgaWYgKHNpLmlzVHJpZ2dlciB8fCBzai5pc1RyaWdnZXIpIHJldHVybiBmYWxzZTtcblxuICAgIHJldHVybiB0cnVlO1xufVxuXG5cbmZ1bmN0aW9uIGNpcmNsZUNpcmNsZShzaSwgc2osIGNvbnRhY3RzKSB7XG4gICAgdmFyIHhpID0gc2kucG9zaXRpb24sXG4gICAgICAgIHhqID0gc2oucG9zaXRpb247XG5cbiAgICBjaXJjbGUyQ2lyY2xlKFxuICAgICAgICBzaSxcbiAgICAgICAgc2osXG4gICAgICAgIHhpLngsIHhpLnksIHNpLnJhZGl1cyxcbiAgICAgICAgeGoueCwgeGoueSwgc2oucmFkaXVzLFxuICAgICAgICBjb250YWN0c1xuICAgICk7XG59XG5cblxuZnVuY3Rpb24gc2VnbWVudENpcmNsZShzaSwgc2osIGNvbnRhY3RzKSB7XG4gICAgdmFyIHJpID0gc2kucmFkaXVzLFxuICAgICAgICBhID0gc2kuX2EsXG4gICAgICAgIGIgPSBzaS5fYixcbiAgICAgICAgbiA9IHNpLl9ub3JtYWwsXG4gICAgICAgIGF4ID0gYS54LFxuICAgICAgICBheSA9IGEueSxcbiAgICAgICAgYnggPSBiLngsXG4gICAgICAgIGJ5ID0gYi55LFxuICAgICAgICBueCA9IG4ueCxcbiAgICAgICAgbnkgPSBuLnksXG5cbiAgICAgICAgeGogPSBzai5wb3NpdGlvbixcbiAgICAgICAgeGp4ID0geGoueCxcbiAgICAgICAgeGp5ID0geGoueSxcbiAgICAgICAgcmogPSBzai5yYWRpdXMsXG4gICAgICAgIHIgPSByaSArIHJqLFxuXG4gICAgICAgIGRuID0gKG54ICogeGp4ICsgbnkgKiB4ankpIC0gKGF4ICogbnggKyBheSAqIG55KSxcbiAgICAgICAgZGlzdCA9IGFicyhkbiksXG4gICAgICAgIGR0LCBkdGEsIGR0YiwgZHgsIGR5LCBpbnZEaXN0O1xuXG4gICAgaWYgKGRpc3QgPiByKSByZXR1cm47XG5cbiAgICBkdCA9IHhqeCAqIG55IC0geGp5ICogbng7XG4gICAgZHRhID0gYXggKiBueSAtIGF5ICogbng7XG4gICAgZHRiID0gYnggKiBueSAtIGJ5ICogbng7XG5cbiAgICBpZiAoZHQgPD0gZHRhKSB7XG4gICAgICAgIGlmIChkdCA8IGR0YSAtIHIpIHJldHVybjtcblxuICAgICAgICBkeCA9IHhqeCAtIGF4O1xuICAgICAgICBkeSA9IHhqeSAtIGF5O1xuXG4gICAgICAgIGRpc3QgPSBkeCAqIGR4ICsgZHkgKiBkeTtcbiAgICAgICAgaWYgKGRpc3QgPiByICogcikgcmV0dXJuO1xuXG4gICAgICAgIGRpc3QgPSBkaXN0ID09PSAwLjAgPyAwLjAgOiBzcXJ0KGRpc3QpO1xuICAgICAgICBpbnZEaXN0ID0gZGlzdCA9PT0gMC4wID8gMC4wIDogMS4wIC8gZGlzdDtcblxuICAgICAgICBueCA9IGR4ICogaW52RGlzdDtcbiAgICAgICAgbnkgPSBkeSAqIGludkRpc3Q7XG4gICAgfSBlbHNlIGlmIChkdCA+IGR0Yikge1xuICAgICAgICBpZiAoZHQgPiBkdGIgKyByKSByZXR1cm47XG5cbiAgICAgICAgZHggPSB4anggLSBieDtcbiAgICAgICAgZHkgPSB4ankgLSBieTtcblxuICAgICAgICBkaXN0ID0gZHggKiBkeCArIGR5ICogZHk7XG4gICAgICAgIGlmIChkaXN0ID4gciAqIHIpIHJldHVybjtcblxuICAgICAgICBkaXN0ID0gZGlzdCA9PT0gMC4wID8gMC4wIDogc3FydChkaXN0KTtcbiAgICAgICAgaW52RGlzdCA9IGRpc3QgPT09IDAuMCA/IDAuMCA6IDEuMCAvIGRpc3Q7XG5cbiAgICAgICAgbnggPSBkeCAqIGludkRpc3Q7XG4gICAgICAgIG55ID0gZHkgKiBpbnZEaXN0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChkbiA8IDAuMCkge1xuICAgICAgICAgICAgbnggPSAtbng7XG4gICAgICAgICAgICBueSA9IC1ueTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWNvbGxpZGUoc2ksIHNqKSkgcmV0dXJuO1xuXG4gICAgY3JlYXRlQ29udGFjdChcbiAgICAgICAgc2kuYm9keSxcbiAgICAgICAgc2ouYm9keSxcbiAgICAgICAgMS4wICsgbWluKHNpLmVsYXN0aWNpdHksIHNqLmVsYXN0aWNpdHkpLFxuICAgICAgICBtaW4oc2kuZnJpY3Rpb24sIHNqLmZyaWN0aW9uKSxcbiAgICAgICAgbngsXG4gICAgICAgIG55LFxuICAgICAgICB4anggLSByICogbngsXG4gICAgICAgIHhqeSAtIHIgKiBueSxcbiAgICAgICAgZGlzdCAtIHIsXG4gICAgICAgIGNvbnRhY3RzXG4gICAgKTtcbn1cblxuXG5mdW5jdGlvbiBzZWdtZW50U2VnbWVudChzaSwgc2osIGNvbnRhY3RzKSB7XG4gICAgdmFyIGFpID0gc2kuX2EsXG4gICAgICAgIGFpeCA9IGFpLngsXG4gICAgICAgIGFpeSA9IGFpLnksXG4gICAgICAgIGJpID0gc2kuX2IsXG4gICAgICAgIGJpeCA9IGJpLngsXG4gICAgICAgIGJpeSA9IGJpLnksXG4gICAgICAgIHJpID0gc2kucmFkaXVzLFxuXG4gICAgICAgIGFqID0gc2ouX2EsXG4gICAgICAgIGFqeCA9IGFqLngsXG4gICAgICAgIGFqeSA9IGFqLnksXG4gICAgICAgIGJqID0gc2ouX2IsXG4gICAgICAgIGJqeCA9IGJqLngsXG4gICAgICAgIGJqeSA9IGJqLnksXG4gICAgICAgIHJqID0gc2oucmFkaXVzLFxuICAgICAgICBkMCwgZDEsIGQyLCBkMywgbWksIG1qLCBtLCBzLCB0LCB1eCwgdXksIHZ4LCB2eSwgYW14LCBhbXksIGJteCwgYm15O1xuXG4gICAgc2VnbWVudFNlZ21lbnRBcnJheVswXSA9IGQwID0gc2VnbWVudFBvaW50RGlzdGFuY2VTcShhaXgsIGFpeSwgYml4LCBiaXksIGFqeCwgYWp5KTtcbiAgICBzZWdtZW50U2VnbWVudEFycmF5WzFdID0gZDEgPSBzZWdtZW50UG9pbnREaXN0YW5jZVNxKGFpeCwgYWl5LCBiaXgsIGJpeSwgYmp4LCBiankpO1xuICAgIHNlZ21lbnRTZWdtZW50QXJyYXlbMl0gPSBkMiA9IHNlZ21lbnRQb2ludERpc3RhbmNlU3EoYWp4LCBhanksIGJqeCwgYmp5LCBhaXgsIGFpeSk7XG4gICAgc2VnbWVudFNlZ21lbnRBcnJheVszXSA9IGQzID0gc2VnbWVudFBvaW50RGlzdGFuY2VTcShhangsIGFqeSwgYmp4LCBianksIGJpeCwgYml5KTtcblxuICAgIG1pID0gZDAgPCBkMSA/IDAgOiAxO1xuICAgIG1qID0gZDIgPCBkMyA/IDIgOiAzO1xuICAgIG0gPSBzZWdtZW50U2VnbWVudEFycmF5W21pXSA8IHNlZ21lbnRTZWdtZW50QXJyYXlbbWpdID8gbWkgOiBtajtcblxuICAgIHV4ID0gYml4IC0gYWl4O1xuICAgIHV5ID0gYml5IC0gYWl5O1xuICAgIHZ4ID0gYmp4IC0gYWp4O1xuICAgIHZ5ID0gYmp5IC0gYWp5O1xuXG4gICAgaWYgKG0gPT09IDApIHtcbiAgICAgICAgcyA9ICgoYWp4IC0gYWl4KSAqIHV4ICsgKGFqeSAtIGFpeSkgKiB1eSkgLyAodXggKiB1eCArIHV5ICogdXkpO1xuICAgICAgICBzID0gcyA8IDAgPyAwIDogKHMgPiAxID8gMSA6IHMpO1xuICAgICAgICB0ID0gMDtcbiAgICB9IGVsc2UgaWYgKG0gPT09IDEpIHtcbiAgICAgICAgcyA9ICgoYmp4IC0gYWl4KSAqIHV4ICsgKGJqeSAtIGFpeSkgKiB1eSkgLyAodXggKiB1eCArIHV5ICogdXkpO1xuICAgICAgICBzID0gcyA8IDAgPyAwIDogKHMgPiAxID8gMSA6IHMpO1xuICAgICAgICB0ID0gMTtcbiAgICB9IGVsc2UgaWYgKG0gPT09IDIpIHtcbiAgICAgICAgcyA9IDA7XG4gICAgICAgIHQgPSAoKGFpeCAtIGFqeCkgKiB2eCArIChhaXkgLSBhankpICogdnkpIC8gKHZ4ICogdnggKyB2eSAqIHZ5KTtcbiAgICAgICAgdCA9IHQgPCAwID8gMCA6ICh0ID4gMSA/IDEgOiB0KTtcbiAgICB9IGVsc2UgaWYgKG0gPT09IDMpIHtcbiAgICAgICAgcyA9IDE7XG4gICAgICAgIHQgPSAoKGJpeCAtIGFqeCkgKiB2eCArIChiaXkgLSBhankpICogdnkpIC8gKHZ4ICogdnggKyB2eSAqIHZ5KTtcbiAgICAgICAgdCA9IHQgPCAwID8gMCA6ICh0ID4gMSA/IDEgOiB0KTtcbiAgICB9XG5cbiAgICBhbXggPSBhaXggKyAodXggKiBzKTtcbiAgICBhbXkgPSBhaXkgKyAodXkgKiBzKTtcbiAgICBibXggPSBhanggKyAodnggKiB0KTtcbiAgICBibXkgPSBhankgKyAodnkgKiB0KTtcblxuICAgIGNpcmNsZTJDaXJjbGUoXG4gICAgICAgIHNpLFxuICAgICAgICBzaixcbiAgICAgICAgYW14LCBhbXksIHJpLFxuICAgICAgICBibXgsIGJteSwgcmosXG4gICAgICAgIGNvbnRhY3RzXG4gICAgKTtcbn1cblxuXG5mdW5jdGlvbiBjb252ZXhTZWdtZW50KHNpLCBzaiwgY29udGFjdHMpIHtcbiAgICB2YXIgdmVydGljZXMgPSBzaS5fdmVydGljZXMsXG4gICAgICAgIG5vcm1hbHMgPSBzaS5fbm9ybWFscyxcblxuICAgICAgICBhID0gc2ouX2EsXG4gICAgICAgIGF4ID0gYS54LFxuICAgICAgICBheSA9IGEueSxcbiAgICAgICAgYiA9IHNqLl9iLFxuICAgICAgICBieCA9IGIueCxcbiAgICAgICAgYnkgPSBiLnksXG4gICAgICAgIG5qID0gc2ouX25vcm1hbCxcbiAgICAgICAgcmFkaXVzID0gc2oucmFkaXVzLFxuICAgICAgICBuanggPSBuai54LFxuICAgICAgICBuankgPSBuai55LFxuXG4gICAgICAgIHNlZ0QgPSBuanggKiBheCArIG5qeSAqIGF5LFxuICAgICAgICBtaW5Ob3JtID0gdmFsdWVPbkF4aXModmVydGljZXMsIG5qeCwgbmp5LCBzZWdEKSAtIHJhZGl1cyxcbiAgICAgICAgbWluTmVnID0gdmFsdWVPbkF4aXModmVydGljZXMsIC1uangsIC1uanksIC1zZWdEKSAtIHJhZGl1cyxcbiAgICAgICAgaW5kZXggPSAtMSxcbiAgICAgICAgcG9seU1pbiA9IC1JbmZpbml0eSxcbiAgICAgICAgdiwgbiwgZGlzdCwgaSwgdmF4LCB2YXksIHZieCwgdmJ5LCB1LCBlLCBueCwgbnksIGNvdW50ID0gMDtcblxuICAgIGlmIChtaW5OZWcgPiAwIHx8IG1pbk5vcm0gPiAwKSByZXR1cm47XG5cbiAgICBpID0gdmVydGljZXMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgdiA9IHZlcnRpY2VzW2ldO1xuICAgICAgICBuID0gbm9ybWFsc1tpXTtcbiAgICAgICAgbnggPSBuLng7XG4gICAgICAgIG55ID0gbi55O1xuICAgICAgICBkaXN0ID0gc2VnbWVudFZhbHVlT25BeGlzKGF4LCBheSwgYngsIGJ5LCByYWRpdXMsIG54LCBueSwgKG54ICogdi54ICsgbnkgKiB2LnkpKTtcblxuICAgICAgICBpZiAoZGlzdCA+IDAuMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2UgaWYgKGRpc3QgPiBwb2x5TWluKSB7XG4gICAgICAgICAgICBwb2x5TWluID0gZGlzdDtcbiAgICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpbmRleCA9PT0gLTEpIHJldHVybjtcbiAgICBpZiAoIWNvbGxpZGUoc2ksIHNqKSkgcmV0dXJuO1xuXG4gICAgZSA9IDEuMCArIG1pbihzaS5lbGFzdGljaXR5LCBzai5lbGFzdGljaXR5KTtcbiAgICB1ID0gbWluKHNpLmZyaWN0aW9uLCBzai5mcmljdGlvbik7XG5cbiAgICBuID0gbm9ybWFsc1tpbmRleF07XG4gICAgbnggPSBuLng7XG4gICAgbnkgPSBuLnk7XG5cbiAgICB2YXggPSBheCArICgtbnggKiByYWRpdXMpO1xuICAgIHZheSA9IGF5ICsgKC1ueSAqIHJhZGl1cyk7XG5cbiAgICB2YnggPSBieCArICgtbnggKiByYWRpdXMpO1xuICAgIHZieSA9IGJ5ICsgKC1ueSAqIHJhZGl1cyk7XG5cbiAgICBpZiAoY29udGFpbnModmVydGljZXMsIG5vcm1hbHMsIHZheCwgdmF5KSkge1xuICAgICAgICBjcmVhdGVDb250YWN0KFxuICAgICAgICAgICAgc2kuYm9keSxcbiAgICAgICAgICAgIHNqLmJvZHksXG4gICAgICAgICAgICBlLFxuICAgICAgICAgICAgdSxcbiAgICAgICAgICAgIG54LFxuICAgICAgICAgICAgbnksXG4gICAgICAgICAgICB2YXgsXG4gICAgICAgICAgICB2YXksXG4gICAgICAgICAgICBwb2x5TWluLFxuICAgICAgICAgICAgY29udGFjdHNcbiAgICAgICAgKTtcbiAgICAgICAgY291bnQrKztcbiAgICB9XG4gICAgaWYgKGNvbnRhaW5zKHZlcnRpY2VzLCBub3JtYWxzLCB2YngsIHZieSkpIHtcbiAgICAgICAgY3JlYXRlQ29udGFjdChcbiAgICAgICAgICAgIHNpLmJvZHksXG4gICAgICAgICAgICBzai5ib2R5LFxuICAgICAgICAgICAgZSxcbiAgICAgICAgICAgIHUsXG4gICAgICAgICAgICBueCxcbiAgICAgICAgICAgIG55LFxuICAgICAgICAgICAgdmJ4LFxuICAgICAgICAgICAgdmJ5LFxuICAgICAgICAgICAgcG9seU1pbixcbiAgICAgICAgICAgIGNvbnRhY3RzXG4gICAgICAgICk7XG4gICAgICAgIGNvdW50Kys7XG4gICAgfVxuXG4gICAgaWYgKG1pbk5vcm0gPj0gcG9seU1pbiB8fCBtaW5OZWcgPj0gcG9seU1pbikge1xuICAgICAgICBpZiAobWluTm9ybSA+IG1pbk5lZykge1xuICAgICAgICAgICAgY291bnQgKz0gcG9pbnRzQmVoaW5kU2VnbWVudChzaSwgc2osIGUsIHUsIGF4LCBheSwgYngsIGJ5LCByYWRpdXMsIG54LCBueSwgbWluTm9ybSwgMSwgY29udGFjdHMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY291bnQgKz0gcG9pbnRzQmVoaW5kU2VnbWVudChzaSwgc2osIGUsIHUsIGF4LCBheSwgYngsIGJ5LCByYWRpdXMsIG54LCBueSwgbWluTmVnLCAtMSwgY29udGFjdHMpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG52YXIgc2VnbWVudFNlZ21lbnRBcnJheSA9IFswLjAsIDAuMCwgMC4wLCAwLjBdO1xuXG5mdW5jdGlvbiBwb2ludHNCZWhpbmRTZWdtZW50KHNpLCBzaiwgZSwgdSwgYXgsIGF5LCBieCwgYnksIHJhZGl1cywgbngsIG55LCBkaXN0LCBjb2VmLCBjb250YWN0cykge1xuICAgIHZhciBkdGEgPSBueCAqIGF5IC0gbnkgKiBheCxcbiAgICAgICAgZHRiID0gbnggKiBieSAtIG55ICogYngsXG4gICAgICAgIHZlcnRpY2VzID0gc2kuX3ZlcnRpY2VzLFxuICAgICAgICBpID0gdmVydGljZXMubGVuZ3RoLFxuICAgICAgICB2LCB2eCwgdnksIGR0LFxuICAgICAgICBjb3VudCA9IDA7XG5cbiAgICBueCAqPSBjb2VmO1xuICAgIG55ICo9IGNvZWY7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIHYgPSB2ZXJ0aWNlc1tpXVxuICAgICAgICB2eCA9IHYueDtcbiAgICAgICAgdnkgPSB2Lnk7XG5cbiAgICAgICAgaWYgKCh2eCAqIG54ICsgdnkgKiBueSkgPCAobnggKiBheCArIG55ICogYXkpICogY29lZiArIHJhZGl1cykge1xuICAgICAgICAgICAgZHQgPSBueCAqIHZ5IC0gbnkgKiB2eDtcbiAgICAgICAgICAgIGlmIChkdGEgPj0gZHQgJiYgZHQgPj0gZHRiKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlQ29udGFjdChcbiAgICAgICAgICAgICAgICAgICAgc2kuYm9keSxcbiAgICAgICAgICAgICAgICAgICAgc2ouYm9keSxcbiAgICAgICAgICAgICAgICAgICAgZSxcbiAgICAgICAgICAgICAgICAgICAgdSxcbiAgICAgICAgICAgICAgICAgICAgbngsXG4gICAgICAgICAgICAgICAgICAgIG55LFxuICAgICAgICAgICAgICAgICAgICB2eCxcbiAgICAgICAgICAgICAgICAgICAgdnksXG4gICAgICAgICAgICAgICAgICAgIGRpc3QsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhY3RzXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvdW50O1xufVxuXG5mdW5jdGlvbiBzZWdtZW50UG9pbnREaXN0YW5jZVNxKGF4LCBheSwgYngsIGJ5LCBweCwgcHkpIHtcbiAgICB2YXIgd3ggPSBweCAtIGF4LFxuICAgICAgICB3eSA9IHB5IC0gYXksXG4gICAgICAgIGR4ID0gYnggLSBheCxcbiAgICAgICAgZHkgPSBieSAtIGF5LFxuXG4gICAgICAgIHByb2ogPSB3eCAqIGR4ICsgd3kgKiBkeSxcbiAgICAgICAgdnNxO1xuXG4gICAgaWYgKHByb2ogPD0gMC4wKSByZXR1cm4gd3ggKiB3eCArIHd5ICogd3k7XG5cbiAgICB2c3EgPSBkeCAqIGR4ICsgZHkgKiBkeTtcbiAgICBpZiAocHJvaiA+PSB2c3EpIHJldHVybiAod3ggKiB3eCArIHd5ICogd3kpIC0gMiAqIHByb2ogKyB2c3E7XG5cblxuICAgIHJldHVybiAod3ggKiB3eCArIHd5ICogd3kpIC0gcHJvaiAqIHByb2ogLyB2c3E7XG59XG5cbmZ1bmN0aW9uIHNlZ21lbnRWYWx1ZU9uQXhpcyhheCwgYXksIGJ4LCBieSwgciwgbngsIG55LCBkKSB7XG4gICAgdmFyIGEgPSAobnggKiBheCArIG55ICogYXkpIC0gcixcbiAgICAgICAgYiA9IChueCAqIGJ4ICsgbnkgKiBieSkgLSByO1xuXG4gICAgcmV0dXJuIG1pbihhLCBiKSAtIGQ7XG59XG5cblxuZnVuY3Rpb24gY29udmV4Q2lyY2xlKHNpLCBzaiwgY29udGFjdHMpIHtcbiAgICB2YXIgdmVydGljZXMgPSBzaS5fdmVydGljZXMsXG4gICAgICAgIG5vcm1hbHMgPSBzaS5fbm9ybWFscyxcbiAgICAgICAgeGogPSBzai5wb3NpdGlvbixcbiAgICAgICAgeGp4ID0geGoueCxcbiAgICAgICAgeGp5ID0geGoueSxcbiAgICAgICAgcmFkaXVzID0gc2oucmFkaXVzLFxuXG4gICAgICAgIHZlcnRleCwgbm9ybWFsLCBzLCBzZXBhcmF0aW9uID0gLUluZmluaXR5LFxuICAgICAgICBpbmRleCA9IC0xLFxuICAgICAgICB2MSwgdjIsIHYxeCwgdjF5LCB2MngsIHYyeSwgZXgsIGV5LCBkeCwgZHksIHUsIGRpc3QsIGludkRpc3QsXG5cbiAgICAgICAgbngsIG55LFxuICAgICAgICBpID0gdmVydGljZXMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICB2ZXJ0ZXggPSB2ZXJ0aWNlc1tpXTtcbiAgICAgICAgbm9ybWFsID0gbm9ybWFsc1tpXTtcbiAgICAgICAgcyA9IG5vcm1hbC54ICogKHhqeCAtIHZlcnRleC54KSArIG5vcm1hbC55ICogKHhqeSAtIHZlcnRleC55KTtcblxuICAgICAgICBpZiAocyA+IHJhZGl1cykgcmV0dXJuO1xuXG4gICAgICAgIGlmIChzID4gc2VwYXJhdGlvbikge1xuICAgICAgICAgICAgc2VwYXJhdGlvbiA9IHM7XG4gICAgICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoaW5kZXggPT09IC0xKSByZXR1cm47XG5cbiAgICBub3JtYWwgPSBub3JtYWxzW2luZGV4XTtcbiAgICBueCA9IG5vcm1hbC54O1xuICAgIG55ID0gbm9ybWFsLnk7XG5cbiAgICB2MSA9IHZlcnRpY2VzW2luZGV4XTtcbiAgICB2MXggPSB2MS54O1xuICAgIHYxeSA9IHYxLnk7XG4gICAgdjIgPSB2ZXJ0aWNlc1tpbmRleCArIDFdIHx8IHZlcnRpY2VzWzBdO1xuICAgIHYyeCA9IHYyLng7XG4gICAgdjJ5ID0gdjIueTtcblxuICAgIGV4ID0gdjJ4IC0gdjF4O1xuICAgIGV5ID0gdjJ5IC0gdjF5O1xuXG4gICAgZHggPSB4anggLSB2MXg7XG4gICAgZHkgPSB4ankgLSB2MXk7XG5cbiAgICB1ID0gKGV4ICogZHggKyBleSAqIGR5KSAvIChleCAqIGV4ICsgZXkgKiBleSk7XG5cbiAgICBpZiAodSA8IDAuMCkge1xuICAgICAgICBkeCA9IHhqeCAtIHYxeDtcbiAgICAgICAgZHkgPSB4ankgLSB2MXk7XG5cbiAgICAgICAgZGlzdCA9IGR4ICogZHggKyBkeSAqIGR5O1xuICAgICAgICBpZiAoZGlzdCA+IHJhZGl1cyAqIHJhZGl1cykgcmV0dXJuO1xuXG4gICAgICAgIGRpc3QgPSBzcXJ0KGRpc3QpO1xuICAgICAgICBpbnZEaXN0ID0gZGlzdCA+IDAuMCA/IDEuMCAvIGRpc3QgOiAwLjA7XG5cbiAgICAgICAgbnggPSBkeCAqIGludkRpc3Q7XG4gICAgICAgIG55ID0gZHkgKiBpbnZEaXN0O1xuICAgIH0gZWxzZSBpZiAodSA+IDEuMCkge1xuICAgICAgICBkeCA9IHhqeCAtIHYyeDtcbiAgICAgICAgZHkgPSB4ankgLSB2Mnk7XG5cbiAgICAgICAgZGlzdCA9IGR4ICogZHggKyBkeSAqIGR5O1xuICAgICAgICBpZiAoZGlzdCA+IHJhZGl1cyAqIHJhZGl1cykgcmV0dXJuO1xuXG4gICAgICAgIGRpc3QgPSBzcXJ0KGRpc3QpO1xuICAgICAgICBpbnZEaXN0ID0gZGlzdCA+IDAuMCA/IDEuMCAvIGRpc3QgOiAwLjA7XG5cbiAgICAgICAgbnggPSBkeCAqIGludkRpc3Q7XG4gICAgICAgIG55ID0gZHkgKiBpbnZEaXN0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG5vcm1hbCA9IG5vcm1hbHNbaW5kZXhdO1xuICAgICAgICBueCA9IG5vcm1hbC54O1xuICAgICAgICBueSA9IG5vcm1hbC55O1xuXG4gICAgICAgIGRpc3QgPSBzZXBhcmF0aW9uO1xuICAgIH1cbiAgICBpZiAoIWNvbGxpZGUoc2ksIHNqKSkgcmV0dXJuO1xuXG4gICAgY3JlYXRlQ29udGFjdChcbiAgICAgICAgc2kuYm9keSxcbiAgICAgICAgc2ouYm9keSxcbiAgICAgICAgMS4wICsgbWluKHNpLmVsYXN0aWNpdHksIHNqLmVsYXN0aWNpdHkpLFxuICAgICAgICBtaW4oc2kuZnJpY3Rpb24sIHNqLmZyaWN0aW9uKSxcbiAgICAgICAgbngsXG4gICAgICAgIG55LFxuICAgICAgICB4anggLSByYWRpdXMgKiBueCxcbiAgICAgICAgeGp5IC0gcmFkaXVzICogbnksXG4gICAgICAgIGRpc3QgLSByYWRpdXMsXG4gICAgICAgIGNvbnRhY3RzXG4gICAgKTtcbn1cblxuXG5mdW5jdGlvbiBjb250YWlucyh2ZXJ0aWNlcywgbm9ybWFscywgcHgsIHB5KSB7XG4gICAgdmFyIG4sIG54LCBueSwgdiwgdngsIHZ5LFxuICAgICAgICBpID0gdmVydGljZXMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBuID0gbm9ybWFsc1tpXTtcbiAgICAgICAgbnggPSBuLng7XG4gICAgICAgIG55ID0gbi55O1xuICAgICAgICB2ID0gdmVydGljZXNbaV07XG4gICAgICAgIHZ4ID0gdi54O1xuICAgICAgICB2eSA9IHYueTtcblxuICAgICAgICBpZiAoKG54ICogcHggKyBueSAqIHB5KSAtIChueCAqIHZ4ICsgbnkgKiB2eSkgPiAwKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG59XG5cblxuZnVuY3Rpb24gZmluZENvbnRhY3RzKHNpLCBzaiwgbm9ybWFsLCBkaXN0LCBjb250YWN0cykge1xuICAgIGlmICghY29sbGlkZShzaSwgc2opKSByZXR1cm47XG4gICAgdmFyIHZlcnRpY2VzaSA9IHNpLl92ZXJ0aWNlcyxcbiAgICAgICAgbm9ybWFsc2kgPSBzaS5fbm9ybWFscyxcbiAgICAgICAgdmVydGljZXNqID0gc2ouX3ZlcnRpY2VzLFxuICAgICAgICBub3JtYWxzaiA9IHNqLl9ub3JtYWxzLFxuICAgICAgICB2LCB2eCwgdnksXG4gICAgICAgIG54ID0gbm9ybWFsLngsXG4gICAgICAgIG55ID0gbm9ybWFsLnksXG5cbiAgICAgICAgZSA9IDEuMCArIG1pbihzaS5lbGFzdGljaXR5LCBzai5lbGFzdGljaXR5KSxcbiAgICAgICAgdSA9IG1pbihzaS5mcmljdGlvbiwgc2ouZnJpY3Rpb24pLFxuXG4gICAgICAgIGk7XG5cbiAgICBpID0gdmVydGljZXNpLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIHYgPSB2ZXJ0aWNlc2lbaV07XG4gICAgICAgIHZ4ID0gdi54O1xuICAgICAgICB2eSA9IHYueTtcblxuICAgICAgICBpZiAoY29udGFpbnModmVydGljZXNqLCBub3JtYWxzaiwgdngsIHZ5KSkge1xuICAgICAgICAgICAgY3JlYXRlQ29udGFjdChcbiAgICAgICAgICAgICAgICBzaS5ib2R5LFxuICAgICAgICAgICAgICAgIHNqLmJvZHksXG4gICAgICAgICAgICAgICAgZSxcbiAgICAgICAgICAgICAgICB1LFxuICAgICAgICAgICAgICAgIG54LFxuICAgICAgICAgICAgICAgIG55LFxuICAgICAgICAgICAgICAgIHZ4LFxuICAgICAgICAgICAgICAgIHZ5LFxuICAgICAgICAgICAgICAgIGRpc3QsXG4gICAgICAgICAgICAgICAgY29udGFjdHNcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpID0gdmVydGljZXNqLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIHYgPSB2ZXJ0aWNlc2pbaV07XG4gICAgICAgIHZ4ID0gdi54O1xuICAgICAgICB2eSA9IHYueTtcblxuICAgICAgICBpZiAoY29udGFpbnModmVydGljZXNpLCBub3JtYWxzaSwgdngsIHZ5KSkge1xuICAgICAgICAgICAgY3JlYXRlQ29udGFjdChcbiAgICAgICAgICAgICAgICBzaS5ib2R5LFxuICAgICAgICAgICAgICAgIHNqLmJvZHksXG4gICAgICAgICAgICAgICAgZSxcbiAgICAgICAgICAgICAgICB1LFxuICAgICAgICAgICAgICAgIG54LFxuICAgICAgICAgICAgICAgIG55LFxuICAgICAgICAgICAgICAgIHZ4LFxuICAgICAgICAgICAgICAgIHZ5LFxuICAgICAgICAgICAgICAgIGRpc3QsXG4gICAgICAgICAgICAgICAgY29udGFjdHNcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuZnVuY3Rpb24gdmFsdWVPbkF4aXModmVydGljZXMsIG54LCBueSwgZCkge1xuICAgIHZhciB2LCBtID0gSW5maW5pdHksXG4gICAgICAgIGkgPSB2ZXJ0aWNlcy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIHYgPSB2ZXJ0aWNlc1tpXTtcbiAgICAgICAgbSA9IG1pbihtLCBueCAqIHYueCArIG55ICogdi55KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbSAtIGQ7XG59XG5cblxudmFyIGxhc3RNaW5NU0EgPSAwLjA7XG5cbmZ1bmN0aW9uIGZpbmRNU0Eoc2ksIHNqKSB7XG4gICAgdmFyIHZlcnRpY2VzaSA9IHNpLl92ZXJ0aWNlcyxcbiAgICAgICAgbm9ybWFsc2kgPSBzaS5fbm9ybWFscyxcbiAgICAgICAgY291bnRpID0gbm9ybWFsc2kubGVuZ3RoLFxuICAgICAgICB2ZXJ0aWNlc2ogPSBzai5fdmVydGljZXMsXG5cbiAgICAgICAgbiwgdiwgZGlzdCwgbWluID0gLUluZmluaXR5LFxuICAgICAgICBpbmRleCA9IC0xLFxuICAgICAgICBpID0gY291bnRpO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBuID0gbm9ybWFsc2lbaV07XG4gICAgICAgIHYgPSB2ZXJ0aWNlc2lbaV07XG5cbiAgICAgICAgZGlzdCA9IHZhbHVlT25BeGlzKHZlcnRpY2Vzaiwgbi54LCBuLnksIChuLnggKiB2LnggKyBuLnkgKiB2LnkpKTtcblxuICAgICAgICBpZiAoZGlzdCA+IDAuMCkgcmV0dXJuIC0xO1xuXG4gICAgICAgIGlmIChkaXN0ID4gbWluKSB7XG4gICAgICAgICAgICBtaW4gPSBkaXN0O1xuICAgICAgICAgICAgaW5kZXggPSBpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbGFzdE1pbk1TQSA9IG1pbjtcbiAgICByZXR1cm4gaW5kZXg7XG59XG5cblxuZnVuY3Rpb24gY29udmV4Q29udmV4KHNpLCBzaiwgY29udGFjdHMpIHtcbiAgICB2YXIgaW5kZXhpLCBtaW5pLCBpbmRleGosIG1pbmo7XG5cbiAgICBpbmRleGkgPSBmaW5kTVNBKHNpLCBzaik7XG4gICAgaWYgKGluZGV4aSA8IDApIHJldHVybjtcbiAgICBtaW5pID0gbGFzdE1pbk1TQTtcblxuICAgIGluZGV4aiA9IGZpbmRNU0Eoc2osIHNpKTtcbiAgICBpZiAoaW5kZXhqIDwgMCkgcmV0dXJuO1xuICAgIG1pbmogPSBsYXN0TWluTVNBO1xuXG4gICAgaWYgKG1pbmkgPiBtaW5qKSB7XG4gICAgICAgIGZpbmRDb250YWN0cyhzaSwgc2osIHNpLl9ub3JtYWxzW2luZGV4aV0sIG1pbmksIGNvbnRhY3RzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBmaW5kQ29udGFjdHMoc2osIHNpLCBzai5fbm9ybWFsc1tpbmRleGpdLCBtaW5qLCBjb250YWN0cyk7XG4gICAgfVxufVxuXG5cbmZ1bmN0aW9uIGNvbGxpc2lvblR5cGUoc2ksIHNqLCBjb250YWN0cykge1xuICAgIHZhciBzaVR5cGUgPSBzaS50eXBlLFxuICAgICAgICBzalR5cGUgPSBzai50eXBlO1xuXG4gICAgaWYgKHNpVHlwZSA9PT0gU2hhcGVUeXBlLkNpcmNsZSkge1xuXG4gICAgICAgIGlmIChzalR5cGUgPT09IFNoYXBlVHlwZS5DaXJjbGUpIHtcbiAgICAgICAgICAgIGNpcmNsZUNpcmNsZShzaSwgc2osIGNvbnRhY3RzKTtcbiAgICAgICAgfSBlbHNlIGlmIChzalR5cGUgPT09IFNoYXBlVHlwZS5TZWdtZW50KSB7XG4gICAgICAgICAgICBzZWdtZW50Q2lyY2xlKHNqLCBzaSwgY29udGFjdHMpO1xuICAgICAgICB9IGVsc2UgaWYgKHNqVHlwZSA9PT0gU2hhcGVUeXBlLkNvbnZleCkge1xuICAgICAgICAgICAgY29udmV4Q2lyY2xlKHNqLCBzaSwgY29udGFjdHMpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChzaVR5cGUgPT09IFNoYXBlVHlwZS5Db252ZXgpIHtcblxuICAgICAgICBpZiAoc2pUeXBlID09PSBTaGFwZVR5cGUuQ2lyY2xlKSB7XG4gICAgICAgICAgICBjb252ZXhDaXJjbGUoc2ksIHNqLCBjb250YWN0cyk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2pUeXBlID09PSBTaGFwZVR5cGUuU2VnbWVudCkge1xuICAgICAgICAgICAgY29udmV4U2VnbWVudChzaSwgc2osIGNvbnRhY3RzKTtcbiAgICAgICAgfSBlbHNlIGlmIChzalR5cGUgPT09IFNoYXBlVHlwZS5Db252ZXgpIHtcbiAgICAgICAgICAgIGNvbnZleENvbnZleChzaSwgc2osIGNvbnRhY3RzKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAoc2lUeXBlID09PSBTaGFwZVR5cGUuU2VnbWVudCkge1xuXG4gICAgICAgIGlmIChzalR5cGUgPT09IFNoYXBlVHlwZS5DaXJjbGUpIHtcbiAgICAgICAgICAgIHNlZ21lbnRDaXJjbGUoc2ksIHNqLCBjb250YWN0cyk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2pUeXBlID09PSBTaGFwZVR5cGUuU2VnbWVudCkge1xuICAgICAgICAgICAgc2VnbWVudFNlZ21lbnQoc2ksIHNqLCBjb250YWN0cyk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2pUeXBlID09PSBTaGFwZVR5cGUuQ29udmV4KSB7XG4gICAgICAgICAgICBjb252ZXhTZWdtZW50KHNqLCBzaSwgY29udGFjdHMpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cbm1vZHVsZS5leHBvcnRzID0gUDJOZWFycGhhc2U7XG4iLCJ2YXIgRXZlbnRFbWl0dGVyID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvZXZlbnRfZW1pdHRlclwiKTtcblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBjbGFzcyBQMkNvbnN0cmFpbnRcbiAqIEBleHRlbmRzIENsYXNzXG4gKiBAYnJpZWYgMmQgY29udGFjdCBlcXVhdGlvblxuICovXG5mdW5jdGlvbiBQMkNvbnN0cmFpbnQoYmksIGJqKSB7XG5cbiAgICBFdmVudEVtaXR0ZXIuY2FsbCh0aGlzKTtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBQMkJvZHkgYmpcbiAgICAgKiBAbWVtYmVyb2YgUDJDb25zdHJhaW50XG4gICAgICovXG4gICAgdGhpcy5iaSA9IGJpO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IFAyQm9keSBialxuICAgICAqIEBtZW1iZXJvZiBQMkNvbnN0cmFpbnRcbiAgICAgKi9cbiAgICB0aGlzLmJqID0gYmo7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgQXJyYXkgZXF1YXRpb25zXG4gICAgICogQG1lbWJlcm9mIFAyQ29uc3RyYWludFxuICAgICAqL1xuICAgIHRoaXMuZXF1YXRpb25zID0gW107XG59XG5cbkV2ZW50RW1pdHRlci5leHRlbmQoUDJDb25zdHJhaW50KTtcblxuXG5QMkNvbnN0cmFpbnQucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcblxufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFAyQ29uc3RyYWludDtcbiIsInZhciBDbGFzcyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2NsYXNzXCIpO1xudmFyIE1hdGhmID0gcmVxdWlyZShcIi4uLy4uL21hdGgvbWF0aGZcIik7XG52YXIgVmVjMiA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3ZlYzJcIik7XG52YXIgUDJFcXVhdGlvbiA9IHJlcXVpcmUoXCIuLi9jb25zdHJhaW50cy9wMmVxdWF0aW9uXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuLyoqXG4gKiBAY2xhc3MgUDJDb250YWN0XG4gKiBAZXh0ZW5kcyBQMkVxdWF0aW9uXG4gKiBAYnJpZWYgMmQgY29udGFjdCBlcXVhdGlvblxuICovXG5mdW5jdGlvbiBQMkNvbnRhY3QoKSB7XG5cbiAgICBQMkVxdWF0aW9uLmNhbGwodGhpcyk7XG5cbiAgICB0aGlzLm1pbkZvcmNlID0gMC4wO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IFZlYzIgcFxuICAgICAqIEBtZW1iZXJvZiBQMkNvbnRhY3RcbiAgICAgKi9cbiAgICB0aGlzLnAgPSBuZXcgVmVjMjtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBWZWMyIG5cbiAgICAgKiBAbWVtYmVyb2YgUDJDb250YWN0XG4gICAgICovXG4gICAgdGhpcy5uID0gbmV3IFZlYzI7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIHNcbiAgICAgKiBAbWVtYmVyb2YgUDJDb250YWN0XG4gICAgICovXG4gICAgdGhpcy5zID0gMC4wO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciBlXG4gICAgICogQG1lbWJlcm9mIFAyQ29udGFjdFxuICAgICAqL1xuICAgIHRoaXMuZSA9IDEuMDtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBOdW1iZXIgdVxuICAgICAqIEBtZW1iZXJvZiBQMkNvbnRhY3RcbiAgICAgKi9cbiAgICB0aGlzLnUgPSAxLjA7XG5cbiAgICB0aGlzLnJpID0gbmV3IFZlYzI7XG4gICAgdGhpcy5yaiA9IG5ldyBWZWMyO1xuXG4gICAgdGhpcy5yaXhuID0gMDtcbiAgICB0aGlzLnJqeG4gPSAwO1xufVxuXG5QMkVxdWF0aW9uLmV4dGVuZChQMkNvbnRhY3QpO1xuXG5cblAyQ29udGFjdC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChoKSB7XG4gICAgdmFyIGJpID0gdGhpcy5iaSxcbiAgICAgICAgYmogPSB0aGlzLmJqLFxuXG4gICAgICAgIHAgPSB0aGlzLnAsXG4gICAgICAgIHB4ID0gcC54LFxuICAgICAgICBweSA9IHAueSxcbiAgICAgICAgbiA9IHRoaXMubixcbiAgICAgICAgbnggPSBuLngsXG4gICAgICAgIG55ID0gbi55LFxuXG4gICAgICAgIHhpID0gYmkucG9zaXRpb24sXG4gICAgICAgIHhqID0gYmoucG9zaXRpb24sXG5cbiAgICAgICAgcmkgPSB0aGlzLnJpLFxuICAgICAgICByaXggPSBweCAtIHhpLngsXG4gICAgICAgIHJpeSA9IHB5IC0geGkueSxcblxuICAgICAgICByaiA9IHRoaXMucmosXG4gICAgICAgIHJqeCA9IHB4IC0geGoueCxcbiAgICAgICAgcmp5ID0gcHkgLSB4ai55LFxuXG4gICAgICAgIHJpeG4gPSByaXggKiBueSAtIHJpeSAqIG54LFxuICAgICAgICByanhuID0gcmp4ICogbnkgLSByankgKiBueDtcblxuICAgIHJpLnggPSByaXg7XG4gICAgcmkueSA9IHJpeTtcblxuICAgIHJqLnggPSByang7XG4gICAgcmoueSA9IHJqeTtcblxuICAgIHRoaXMucml4biA9IHJpeG47XG4gICAgdGhpcy5yanhuID0gcmp4bjtcblxuICAgIHRoaXMubGFtYmRhID0gMDtcbiAgICB0aGlzLmNhbGN1bGF0ZUIoaCk7XG4gICAgdGhpcy5jYWxjdWxhdGVDKCk7XG59O1xuXG5cblAyQ29udGFjdC5wcm90b3R5cGUuY2FsY3VsYXRlQiA9IGZ1bmN0aW9uIChoKSB7XG4gICAgdmFyIGJpID0gdGhpcy5iaSxcbiAgICAgICAgYmogPSB0aGlzLmJqLFxuXG4gICAgICAgIG4gPSB0aGlzLm4sXG4gICAgICAgIG54ID0gbi54LFxuICAgICAgICBueSA9IG4ueSxcblxuICAgICAgICB2aSA9IGJpLnZlbG9jaXR5LFxuICAgICAgICB3aSA9IGJpLmFuZ3VsYXJWZWxvY2l0eSxcbiAgICAgICAgZmkgPSBiaS5mb3JjZSxcbiAgICAgICAgdGkgPSBiaS50b3JxdWUsXG4gICAgICAgIGludk1pID0gYmkuaW52TWFzcyxcbiAgICAgICAgaW52SWkgPSBiaS5pbnZJbmVydGlhLFxuXG4gICAgICAgIHZqID0gYmoudmVsb2NpdHksXG4gICAgICAgIHdqID0gYmouYW5ndWxhclZlbG9jaXR5LFxuICAgICAgICBmaiA9IGJqLmZvcmNlLFxuICAgICAgICB0aiA9IGJqLnRvcnF1ZSxcbiAgICAgICAgaW52TWogPSBiai5pbnZNYXNzLFxuICAgICAgICBpbnZJaiA9IGJqLmludkluZXJ0aWEsXG5cbiAgICAgICAgcmkgPSB0aGlzLnJpLFxuICAgICAgICByaXggPSByaS54LFxuICAgICAgICByaXkgPSByaS55LFxuICAgICAgICByaiA9IHRoaXMucmosXG4gICAgICAgIHJqeCA9IHJqLngsXG4gICAgICAgIHJqeSA9IHJqLnksXG5cbiAgICAgICAgZSA9IHRoaXMuZSxcblxuICAgICAgICBHcSA9IHRoaXMucyxcblxuICAgICAgICBHV3ggPSB2ai54ICsgKC13aiAqIHJqeSkgLSB2aS54IC0gKC13aSAqIHJpeSksXG4gICAgICAgIEdXeSA9IHZqLnkgKyAod2ogKiByangpIC0gdmkueSAtICh3aSAqIHJpeCksXG4gICAgICAgIEdXID0gZSAqIEdXeCAqIG54ICsgZSAqIEdXeSAqIG55LFxuXG4gICAgICAgIEdpTWZ4ID0gZmoueCAqIGludk1qICsgKC10aiAqIGludklqICogcmp5KSAtIGZpLnggKiBpbnZNaSAtICgtdGkgKiBpbnZJaSAqIHJpeSksXG4gICAgICAgIEdpTWZ5ID0gZmoueSAqIGludk1qICsgKHRqICogaW52SWogKiByangpIC0gZmkueSAqIGludk1pIC0gKHRpICogaW52SWkgKiByaXgpLFxuICAgICAgICBHaU1mID0gR2lNZnggKiBueCArIEdpTWZ5ICogbnk7XG5cbiAgICB0aGlzLkIgPSAtdGhpcy5hICogR3EgLSB0aGlzLmIgKiBHVyAtIGggKiBHaU1mO1xufTtcblxuXG5QMkNvbnRhY3QucHJvdG90eXBlLmNhbGN1bGF0ZUMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGJpID0gdGhpcy5iaSxcbiAgICAgICAgYmogPSB0aGlzLmJqLFxuXG4gICAgICAgIHJpeG4gPSB0aGlzLnJpeG4sXG4gICAgICAgIHJqeG4gPSB0aGlzLnJqeG4sXG5cbiAgICAgICAgaW52SWkgPSBiaS5pbnZJbmVydGlhLFxuICAgICAgICBpbnZJaiA9IGJqLmludkluZXJ0aWEsXG5cbiAgICAgICAgQyA9IGJpLmludk1hc3MgKyBiai5pbnZNYXNzICsgdGhpcy5lcHNpbG9uICsgaW52SWkgKiByaXhuICogcml4biArIGludklqICogcmp4biAqIHJqeG47XG5cbiAgICB0aGlzLmludkMgPSBDID09PSAwID8gMCA6IDEgLyBDO1xufTtcblxuXG5QMkNvbnRhY3QucHJvdG90eXBlLmNhbGN1bGF0ZUdXbGFtYmRhID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBiaSA9IHRoaXMuYmksXG4gICAgICAgIGJqID0gdGhpcy5iaixcblxuICAgICAgICBuID0gdGhpcy5uLFxuXG4gICAgICAgIHZsYW1iZGFpID0gYmkudmxhbWJkYSxcbiAgICAgICAgd2xhbWJkYWkgPSBiaS53bGFtYmRhLFxuICAgICAgICB2bGFtYmRhaiA9IGJqLnZsYW1iZGEsXG4gICAgICAgIHdsYW1iZGFqID0gYmoud2xhbWJkYSxcblxuICAgICAgICB1bGFtYmRheCA9IHZsYW1iZGFqLnggLSB2bGFtYmRhaS54LFxuICAgICAgICB1bGFtYmRheSA9IHZsYW1iZGFqLnkgLSB2bGFtYmRhaS55LFxuXG4gICAgICAgIEdXbGFtYmRhID0gdWxhbWJkYXggKiBuLnggKyB1bGFtYmRheSAqIG4ueTtcblxuICAgIGlmICh3bGFtYmRhaSAhPSB1bmRlZmluZWQpIEdXbGFtYmRhIC09IHdsYW1iZGFpICogdGhpcy5yaXhuO1xuICAgIGlmICh3bGFtYmRhaiAhPSB1bmRlZmluZWQpIEdXbGFtYmRhICs9IHdsYW1iZGFqICogdGhpcy5yanhuO1xuXG4gICAgcmV0dXJuIEdXbGFtYmRhO1xufTtcblxuXG5QMkNvbnRhY3QucHJvdG90eXBlLmFkZFRvTGFtYmRhID0gZnVuY3Rpb24gKGRlbHRhTGFtYmRhKSB7XG4gICAgdmFyIGJpID0gdGhpcy5iaSxcbiAgICAgICAgYmogPSB0aGlzLmJqLFxuXG4gICAgICAgIG4gPSB0aGlzLm4sXG4gICAgICAgIG54ID0gbi54LFxuICAgICAgICBueSA9IG4ueSxcblxuICAgICAgICBpbnZNaSA9IGJpLmludk1hc3MsXG4gICAgICAgIHZsYW1iZGFpID0gYmkudmxhbWJkYSxcbiAgICAgICAgaW52TWogPSBiai5pbnZNYXNzLFxuICAgICAgICB2bGFtYmRhaiA9IGJqLnZsYW1iZGE7XG5cbiAgICB2bGFtYmRhaS54IC09IGRlbHRhTGFtYmRhICogaW52TWkgKiBueDtcbiAgICB2bGFtYmRhaS55IC09IGRlbHRhTGFtYmRhICogaW52TWkgKiBueTtcblxuICAgIHZsYW1iZGFqLnggKz0gZGVsdGFMYW1iZGEgKiBpbnZNaiAqIG54O1xuICAgIHZsYW1iZGFqLnkgKz0gZGVsdGFMYW1iZGEgKiBpbnZNaiAqIG55O1xuXG4gICAgaWYgKGJpLndsYW1iZGEgIT0gdW5kZWZpbmVkKSBiaS53bGFtYmRhIC09IGRlbHRhTGFtYmRhICogYmkuaW52SW5lcnRpYSAqIHRoaXMucml4bjtcbiAgICBpZiAoYmoud2xhbWJkYSAhPSB1bmRlZmluZWQpIGJqLndsYW1iZGEgKz0gZGVsdGFMYW1iZGEgKiBiai5pbnZJbmVydGlhICogdGhpcy5yanhuO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFAyQ29udGFjdDtcbiIsInZhciBQMkNvbnN0cmFpbnQgPSByZXF1aXJlKFwiLi9wMmNvbnN0cmFpbnRcIik7XG52YXIgUDJDb250YWN0ID0gcmVxdWlyZShcIi4vcDJjb250YWN0XCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIHNxcnQgPSBNYXRoLnNxcnQ7XG5cblxuLyoqXG4gKiBAY2xhc3MgUDJEaXN0YW5jZUNvbnN0cmFpbnRcbiAqIEBleHRlbmRzIFAyQ29uc3RyYWludFxuICogQGJyaWVmIDJkIGNvbnRhY3QgZXF1YXRpb25cbiAqL1xuZnVuY3Rpb24gUDJEaXN0YW5jZUNvbnN0cmFpbnQoYmksIGJqLCBkaXN0YW5jZSwgbWF4Rm9yY2UpIHtcblxuICAgIFAyQ29uc3RyYWludC5jYWxsKHRoaXMsIGJpLCBiaik7XG5cbiAgICB0aGlzLmRpc3RhbmNlID0gZGlzdGFuY2UgfHwgKGRpc3RhbmNlID0gMSk7XG4gICAgbWF4Rm9yY2UgfHwgKG1heEZvcmNlID0gMWU2KTtcblxuICAgIHZhciBkaXN0YW5jZUVxdWF0aW9uID0gdGhpcy5fZGlzdGFuY2VFcXVhdGlvbiA9IG5ldyBQMkNvbnRhY3QoKTtcbiAgICBkaXN0YW5jZUVxdWF0aW9uLmJpID0gYmk7XG4gICAgZGlzdGFuY2VFcXVhdGlvbi5iaiA9IGJqO1xuICAgIGRpc3RhbmNlRXF1YXRpb24ubWluRm9yY2UgPSAtbWF4Rm9yY2U7XG4gICAgZGlzdGFuY2VFcXVhdGlvbi5tYXhGb3JjZSA9IG1heEZvcmNlO1xuICAgIGNvbnNvbGUubG9nKGRpc3RhbmNlRXF1YXRpb24pO1xuXG4gICAgdGhpcy5lcXVhdGlvbnMucHVzaChkaXN0YW5jZUVxdWF0aW9uKTtcbn1cblxuUDJDb25zdHJhaW50LmV4dGVuZChQMkRpc3RhbmNlQ29uc3RyYWludCk7XG5cblxuUDJEaXN0YW5jZUNvbnN0cmFpbnQucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGlzdGFuY2VFcXVhdGlvbiA9IHRoaXMuX2Rpc3RhbmNlRXF1YXRpb24sXG4gICAgICAgIGRpc3RhbmNlID0gdGhpcy5kaXN0YW5jZSxcbiAgICAgICAgYmkgPSB0aGlzLmJpLFxuICAgICAgICBiaiA9IHRoaXMuYmosXG4gICAgICAgIG4gPSBkaXN0YW5jZUVxdWF0aW9uLm4sXG4gICAgICAgIHJpID0gZGlzdGFuY2VFcXVhdGlvbi5yaSxcbiAgICAgICAgcmogPSBkaXN0YW5jZUVxdWF0aW9uLnJqLFxuICAgICAgICB4aSA9IGJpLnBvc2l0aW9uLFxuICAgICAgICB4aiA9IGJqLnBvc2l0aW9uLFxuICAgICAgICBueCA9IHhqLnggLSB4aS54LFxuICAgICAgICBueSA9IHhqLnkgLSB4aS55LFxuICAgICAgICBsZW4gPSBueCAqIG54ICsgbnkgKiBueSxcbiAgICAgICAgaW52TGVuID0gbGVuID09PSAwID8gMCA6IDEgLyAobGVuID0gc3FydChsZW4pKVxuXG4gICAgbnggKj0gaW52TGVuO1xuICAgIG55ICo9IGludkxlbjtcbiAgICBuLnggPSBueDtcbiAgICBuLnkgPSBueTtcblxuICAgIHJpLnggPSBueCAqIGRpc3RhbmNlICogMC41O1xuICAgIHJpLnkgPSBueSAqIGRpc3RhbmNlICogMC41O1xuXG4gICAgcmoueCA9IG54ICogZGlzdGFuY2UgKiAtMC41O1xuICAgIHJqLnkgPSBueSAqIGRpc3RhbmNlICogLTAuNTtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBQMkRpc3RhbmNlQ29uc3RyYWludDtcbiIsInZhciBFdmVudEVtaXR0ZXIgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9ldmVudF9lbWl0dGVyXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQGNsYXNzIFAyRXF1YXRpb25cbiAqIEBleHRlbmRzIENsYXNzXG4gKiBAYnJpZWYgMmQgY29udGFjdCBlcXVhdGlvblxuICovXG5mdW5jdGlvbiBQMkVxdWF0aW9uKCkge1xuXG4gICAgRXZlbnRFbWl0dGVyLmNhbGwodGhpcyk7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgUDJCb2R5IGJqXG4gICAgICogQG1lbWJlcm9mIFAyRXF1YXRpb25cbiAgICAgKi9cbiAgICB0aGlzLmJpID0gdW5kZWZpbmVkO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IFAyQm9keSBialxuICAgICAqIEBtZW1iZXJvZiBQMkVxdWF0aW9uXG4gICAgICovXG4gICAgdGhpcy5iaiA9IHVuZGVmaW5lZDtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBOdW1iZXIgbWluRm9yY2VcbiAgICAgKiBAbWVtYmVyb2YgUDJFcXVhdGlvblxuICAgICAqL1xuICAgIHRoaXMubWluRm9yY2UgPSAtTnVtYmVyLk1BWF9WQUxVRTtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBOdW1iZXIgbWF4Rm9yY2VcbiAgICAgKiBAbWVtYmVyb2YgUDJFcXVhdGlvblxuICAgICAqL1xuICAgIHRoaXMubWF4Rm9yY2UgPSBOdW1iZXIuTUFYX1ZBTFVFO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IE51bWJlciByZWxheGF0aW9uXG4gICAgICogQGJyaWVmIG51bWJlciBvZiB0aW1lc3RlcHMgaXQgdGFrZXN0byBzdGFiaWxpemUgdGhlIGNvbnN0cmFpbnRcbiAgICAgKiBAbWVtYmVyb2YgUDJFcXVhdGlvblxuICAgICAqL1xuICAgIHRoaXMucmVsYXhhdGlvbiA9IDQ7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIHN0aWZmbmVzc1xuICAgICAqIEBicmllZiBzcHJpbmcgY29uc3RhbnRcbiAgICAgKiBAbWVtYmVyb2YgUDJFcXVhdGlvblxuICAgICAqL1xuICAgIHRoaXMuc3RpZmZuZXNzID0gMWU2O1xuXG4gICAgdGhpcy5hID0gMDtcbiAgICB0aGlzLmIgPSAwO1xuICAgIHRoaXMuZXBzaWxvbiA9IDA7XG5cbiAgICB0aGlzLmxhbWJkYSA9IDA7XG4gICAgdGhpcy5CID0gMDtcbiAgICB0aGlzLmludkMgPSAwO1xufVxuXG5FdmVudEVtaXR0ZXIuZXh0ZW5kKFAyRXF1YXRpb24pO1xuXG5cblAyRXF1YXRpb24ucHJvdG90eXBlLnVwZGF0ZUNvbnN0YW50cyA9IGZ1bmN0aW9uIChoKSB7XG4gICAgdmFyIGsgPSB0aGlzLnN0aWZmbmVzcyxcbiAgICAgICAgZCA9IHRoaXMucmVsYXhhdGlvbjtcblxuICAgIHRoaXMuYSA9IDQuMCAvIChoICogKDEuMCArIDQuMCAqIGQpKTtcbiAgICB0aGlzLmIgPSAoNC4wICogZCkgLyAoMS4wICsgNC4wICogZCk7XG4gICAgdGhpcy5lcHNpbG9uID0gNC4wIC8gKGggKiBoICogayAqICgxLjAgKyA0LjAgKiBkKSk7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUDJFcXVhdGlvbjtcbiIsInZhciBDbGFzcyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2NsYXNzXCIpO1xudmFyIE1hdGhmID0gcmVxdWlyZShcIi4uLy4uL21hdGgvbWF0aGZcIik7XG52YXIgVmVjMiA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3ZlYzJcIik7XG52YXIgUDJFcXVhdGlvbiA9IHJlcXVpcmUoXCIuL3AyZXF1YXRpb25cIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG4vKipcbiAqIEBjbGFzcyBQMkZyaWN0aW9uXG4gKiBAZXh0ZW5kcyBQMkVxdWF0aW9uXG4gKiBAYnJpZWYgMmQgY29udGFjdCBlcXVhdGlvblxuICovXG5mdW5jdGlvbiBQMkZyaWN0aW9uKCkge1xuXG4gICAgUDJFcXVhdGlvbi5jYWxsKHRoaXMpO1xuXG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IFZlYzIgcFxuICAgICAqIEBtZW1iZXJvZiBQMkZyaWN0aW9uXG4gICAgICovXG4gICAgdGhpcy5wID0gbmV3IFZlYzI7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgVmVjMiB0XG4gICAgICogQG1lbWJlcm9mIFAyRnJpY3Rpb25cbiAgICAgKi9cbiAgICB0aGlzLnQgPSBuZXcgVmVjMjtcblxuICAgIHRoaXMucmkgPSBuZXcgVmVjMjtcbiAgICB0aGlzLnJqID0gbmV3IFZlYzI7XG5cbiAgICB0aGlzLnJpeHQgPSAwO1xuICAgIHRoaXMucmp4dCA9IDA7XG59XG5cblAyRXF1YXRpb24uZXh0ZW5kKFAyRnJpY3Rpb24pO1xuXG5cblAyRnJpY3Rpb24ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoaCkge1xuICAgIHZhciBiaSA9IHRoaXMuYmksXG4gICAgICAgIGJqID0gdGhpcy5iaixcblxuICAgICAgICBwID0gdGhpcy5wLFxuICAgICAgICBweCA9IHAueCxcbiAgICAgICAgcHkgPSBwLnksXG4gICAgICAgIHQgPSB0aGlzLnQsXG4gICAgICAgIHR4ID0gdC54LFxuICAgICAgICB0eSA9IHQueSxcblxuICAgICAgICB4aSA9IGJpLnBvc2l0aW9uLFxuICAgICAgICB4aiA9IGJqLnBvc2l0aW9uLFxuXG4gICAgICAgIHJpID0gdGhpcy5yaSxcbiAgICAgICAgcml4ID0gcHggLSB4aS54LFxuICAgICAgICByaXkgPSBweSAtIHhpLnksXG5cbiAgICAgICAgcmogPSB0aGlzLnJqLFxuICAgICAgICByanggPSBweCAtIHhqLngsXG4gICAgICAgIHJqeSA9IHB5IC0geGoueSxcblxuICAgICAgICByaXh0ID0gcml4ICogdHkgLSByaXkgKiB0eCxcbiAgICAgICAgcmp4dCA9IHJqeCAqIHR5IC0gcmp5ICogdHg7XG5cbiAgICByaS54ID0gcml4O1xuICAgIHJpLnkgPSByaXk7XG5cbiAgICByai54ID0gcmp4O1xuICAgIHJqLnkgPSByank7XG5cbiAgICB0aGlzLnJpeHQgPSByaXh0O1xuICAgIHRoaXMucmp4dCA9IHJqeHQ7XG5cbiAgICB0aGlzLmxhbWJkYSA9IDA7XG4gICAgdGhpcy5jYWxjdWxhdGVCKGgpO1xuICAgIHRoaXMuY2FsY3VsYXRlQygpO1xufTtcblxuXG5QMkZyaWN0aW9uLnByb3RvdHlwZS5jYWxjdWxhdGVCID0gZnVuY3Rpb24gKGgpIHtcbiAgICB2YXIgYmkgPSB0aGlzLmJpLFxuICAgICAgICBiaiA9IHRoaXMuYmosXG5cbiAgICAgICAgdCA9IHRoaXMudCxcbiAgICAgICAgdHggPSB0LngsXG4gICAgICAgIHR5ID0gdC55LFxuXG4gICAgICAgIHZpID0gYmkudmVsb2NpdHksXG4gICAgICAgIHdpID0gYmkuYW5ndWxhclZlbG9jaXR5LFxuICAgICAgICBmaSA9IGJpLmZvcmNlLFxuICAgICAgICB0aSA9IGJpLnRvcnF1ZSxcbiAgICAgICAgaW52TWkgPSBiaS5pbnZNYXNzLFxuICAgICAgICBpbnZJaSA9IGJpLmludkluZXJ0aWEsXG5cbiAgICAgICAgdmogPSBiai52ZWxvY2l0eSxcbiAgICAgICAgd2ogPSBiai5hbmd1bGFyVmVsb2NpdHksXG4gICAgICAgIGZqID0gYmouZm9yY2UsXG4gICAgICAgIHRqID0gYmoudG9ycXVlLFxuICAgICAgICBpbnZNaiA9IGJqLmludk1hc3MsXG4gICAgICAgIGludklqID0gYmouaW52SW5lcnRpYSxcblxuICAgICAgICByaSA9IHRoaXMucmksXG4gICAgICAgIHJpeCA9IHJpLngsXG4gICAgICAgIHJpeSA9IHJpLnksXG4gICAgICAgIHJqID0gdGhpcy5yaixcbiAgICAgICAgcmp4ID0gcmoueCxcbiAgICAgICAgcmp5ID0gcmoueSxcblxuICAgICAgICBHcSA9IDAsXG5cbiAgICAgICAgR1d4ID0gdmoueCArICgtd2ogKiByankpIC0gdmkueCAtICgtd2kgKiByaXkpLFxuICAgICAgICBHV3kgPSB2ai55ICsgKHdqICogcmp4KSAtIHZpLnkgLSAod2kgKiByaXgpLFxuICAgICAgICBHVyA9IEdXeCAqIHR4ICsgR1d5ICogdHksXG5cbiAgICAgICAgR2lNZnggPSBmai54ICogaW52TWogKyAoLXRqICogaW52SWogKiByankpIC0gZmkueCAqIGludk1pIC0gKC10aSAqIGludklpICogcml5KSxcbiAgICAgICAgR2lNZnkgPSBmai55ICogaW52TWogKyAodGogKiBpbnZJaiAqIHJqeCkgLSBmaS55ICogaW52TWkgLSAodGkgKiBpbnZJaSAqIHJpeCksXG4gICAgICAgIEdpTWYgPSBHaU1meCAqIHR4ICsgR2lNZnkgKiB0eTtcblxuICAgIHRoaXMuQiA9IC10aGlzLmEgKiBHcSAtIHRoaXMuYiAqIEdXIC0gaCAqIEdpTWY7XG59O1xuXG5cblAyRnJpY3Rpb24ucHJvdG90eXBlLmNhbGN1bGF0ZUMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGJpID0gdGhpcy5iaSxcbiAgICAgICAgYmogPSB0aGlzLmJqLFxuXG4gICAgICAgIHJpeHQgPSB0aGlzLnJpeHQsXG4gICAgICAgIHJqeHQgPSB0aGlzLnJqeHQsXG5cbiAgICAgICAgaW52SWkgPSBiaS5pbnZJbmVydGlhLFxuICAgICAgICBpbnZJaiA9IGJqLmludkluZXJ0aWEsXG5cbiAgICAgICAgQyA9IGJpLmludk1hc3MgKyBiai5pbnZNYXNzICsgdGhpcy5lcHNpbG9uICsgaW52SWkgKiByaXh0ICogcml4dCArIGludklqICogcmp4dCAqIHJqeHQ7XG5cbiAgICB0aGlzLmludkMgPSBDID09PSAwID8gMCA6IDEgLyBDO1xufTtcblxuXG5QMkZyaWN0aW9uLnByb3RvdHlwZS5jYWxjdWxhdGVHV2xhbWJkYSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYmkgPSB0aGlzLmJpLFxuICAgICAgICBiaiA9IHRoaXMuYmosXG5cbiAgICAgICAgdCA9IHRoaXMudCxcblxuICAgICAgICB2bGFtYmRhaSA9IGJpLnZsYW1iZGEsXG4gICAgICAgIHdsYW1iZGFpID0gYmkud2xhbWJkYSxcbiAgICAgICAgdmxhbWJkYWogPSBiai52bGFtYmRhLFxuICAgICAgICB3bGFtYmRhaiA9IGJqLndsYW1iZGEsXG5cbiAgICAgICAgdWxhbWJkYXggPSB2bGFtYmRhai54IC0gdmxhbWJkYWkueCxcbiAgICAgICAgdWxhbWJkYXkgPSB2bGFtYmRhai55IC0gdmxhbWJkYWkueSxcblxuICAgICAgICBHV2xhbWJkYSA9IHVsYW1iZGF4ICogdC54ICsgdWxhbWJkYXkgKiB0Lnk7XG5cbiAgICBpZiAod2xhbWJkYWkgIT0gdW5kZWZpbmVkKSBHV2xhbWJkYSAtPSB3bGFtYmRhaSAqIHRoaXMucml4dDtcbiAgICBpZiAod2xhbWJkYWogIT0gdW5kZWZpbmVkKSBHV2xhbWJkYSArPSB3bGFtYmRhaiAqIHRoaXMucmp4dDtcblxuICAgIHJldHVybiBHV2xhbWJkYTtcbn07XG5cblxuUDJGcmljdGlvbi5wcm90b3R5cGUuYWRkVG9MYW1iZGEgPSBmdW5jdGlvbiAoZGVsdGFMYW1iZGEpIHtcbiAgICB2YXIgYmkgPSB0aGlzLmJpLFxuICAgICAgICBiaiA9IHRoaXMuYmosXG5cbiAgICAgICAgdCA9IHRoaXMudCxcbiAgICAgICAgdHggPSB0LngsXG4gICAgICAgIHR5ID0gdC55LFxuXG4gICAgICAgIGludk1pID0gYmkuaW52TWFzcyxcbiAgICAgICAgdmxhbWJkYWkgPSBiaS52bGFtYmRhLFxuICAgICAgICBpbnZNaiA9IGJqLmludk1hc3MsXG4gICAgICAgIHZsYW1iZGFqID0gYmoudmxhbWJkYTtcblxuICAgIHZsYW1iZGFpLnggLT0gZGVsdGFMYW1iZGEgKiBpbnZNaSAqIHR4O1xuICAgIHZsYW1iZGFpLnkgLT0gZGVsdGFMYW1iZGEgKiBpbnZNaSAqIHR5O1xuXG4gICAgdmxhbWJkYWoueCArPSBkZWx0YUxhbWJkYSAqIGludk1qICogdHg7XG4gICAgdmxhbWJkYWoueSArPSBkZWx0YUxhbWJkYSAqIGludk1qICogdHk7XG5cbiAgICBpZiAoYmkud2xhbWJkYSAhPSB1bmRlZmluZWQpIGJpLndsYW1iZGEgLT0gZGVsdGFMYW1iZGEgKiBiaS5pbnZJbmVydGlhICogdGhpcy5yaXh0O1xuICAgIGlmIChiai53bGFtYmRhICE9IHVuZGVmaW5lZCkgYmoud2xhbWJkYSArPSBkZWx0YUxhbWJkYSAqIGJqLmludkluZXJ0aWEgKiB0aGlzLnJqeHQ7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUDJGcmljdGlvbjtcbiIsInZhciBDbGFzcyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2NsYXNzXCIpO1xudmFyIFAyRW51bXMgPSByZXF1aXJlKFwiLi4vcDJlbnVtc1wiKTtcbnZhciBQMlNoYXBlID0gcmVxdWlyZShcIi4vcDJzaGFwZVwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBTaGFwZVR5cGUgPSBQMkVudW1zLlNoYXBlVHlwZSxcblxuICAgIGFicyA9IE1hdGguYWJzLFxuICAgIFBJID0gTWF0aC5QSTtcblxuXG5mdW5jdGlvbiBQMkNpcmNsZShvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIFAyU2hhcGUuY2FsbCh0aGlzLCBvcHRzKTtcblxuICAgIHRoaXMudHlwZSA9IFNoYXBlVHlwZS5DaXJjbGU7XG4gICAgdGhpcy5yYWRpdXMgPSBvcHRzLnJhZGl1cyAhPSB1bmRlZmluZWQgPyBhYnMob3B0cy5yYWRpdXMpIDogMC41O1xufVxuXG5QMlNoYXBlLmV4dGVuZChQMkNpcmNsZSk7XG5cblxuUDJDaXJjbGUucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICBQMlNoYXBlLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcywgb3RoZXIpO1xuXG4gICAgdGhpcy5yYWRpdXMgPSBvdGhlci5yYWRpdXM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuUDJDaXJjbGUucHJvdG90eXBlLnBvaW50UXVlcnkgPSBmdW5jdGlvbiAocCkge1xuICAgIHZhciB4ID0gdGhpcy5wb3NpdGlvbixcbiAgICAgICAgZHggPSB4LnggLSBwLngsXG4gICAgICAgIGR5ID0geC55IC0gcC55LFxuICAgICAgICByID0gdGhpcy5yYWRpdXM7XG5cbiAgICByZXR1cm4gKGR4ICogZHggKyBkeSAqIGR5KSA8IHIgKiByO1xufTtcblxuXG5QMkNpcmNsZS5wcm90b3R5cGUuY2VudHJvaWQgPSBmdW5jdGlvbiAodikge1xuICAgIHZhciBsb2NhbFBvc2l0aW9uID0gdGhpcy5sb2NhbFBvc2l0aW9uO1xuXG4gICAgdi54ID0gbG9jYWxQb3NpdGlvbi54O1xuICAgIHYueSA9IGxvY2FsUG9zaXRpb24ueTtcblxuICAgIHJldHVybiB2O1xufTtcblxuXG5QMkNpcmNsZS5wcm90b3R5cGUuYXJlYSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgciA9IHRoaXMucmFkaXVzO1xuXG4gICAgcmV0dXJuIFBJICogKHIgKiByKTtcbn07XG5cblxuUDJDaXJjbGUucHJvdG90eXBlLmluZXJ0aWEgPSBmdW5jdGlvbiAobWFzcykge1xuICAgIHZhciByID0gdGhpcy5yYWRpdXMsXG4gICAgICAgIGxvY2FsUG9zaXRpb24gPSB0aGlzLmxvY2FsUG9zaXRpb24sXG4gICAgICAgIGx4ID0gbG9jYWxQb3NpdGlvbi54LFxuICAgICAgICBseSA9IGxvY2FsUG9zaXRpb24ueTtcblxuICAgIHJldHVybiBtYXNzICogKChyICogciAqIDAuNSkgKyAobHggKiBseCArIGx5ICogbHkpKTtcbn07XG5cblxuUDJDaXJjbGUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChtYXRyaXgpIHtcbiAgICB2YXIgbG9jYWxNYXRyaXggPSB0aGlzLm1hdHJpeCxcbiAgICAgICAgbWF0cml4V29ybGQgPSB0aGlzLm1hdHJpeFdvcmxkLFxuICAgICAgICBsb2NhbFBvc2l0aW9uID0gdGhpcy5sb2NhbFBvc2l0aW9uLFxuICAgICAgICBwb3MgPSB0aGlzLnBvc2l0aW9uLFxuICAgICAgICByID0gdGhpcy5yYWRpdXMsXG4gICAgICAgIGFhYmIgPSB0aGlzLmFhYmIsXG4gICAgICAgIG1pbiA9IGFhYmIubWluLFxuICAgICAgICBtYXggPSBhYWJiLm1heCxcbiAgICAgICAgeCwgeTtcblxuICAgIGxvY2FsTWF0cml4LnNldFJvdGF0aW9uKHRoaXMubG9jYWxSb3RhdGlvbik7XG4gICAgbG9jYWxNYXRyaXguc2V0UG9zaXRpb24obG9jYWxQb3NpdGlvbik7XG4gICAgbWF0cml4V29ybGQubW11bChtYXRyaXgsIGxvY2FsTWF0cml4KTtcblxuICAgIHBvcy54ID0gbG9jYWxQb3NpdGlvbi54O1xuICAgIHBvcy55ID0gbG9jYWxQb3NpdGlvbi55O1xuICAgIHBvcy50cmFuc2Zvcm1NYXQzMihtYXRyaXgpO1xuICAgIHggPSBwb3MueDtcbiAgICB5ID0gcG9zLnk7XG5cbiAgICBtaW4ueCA9IHggLSByO1xuICAgIG1pbi55ID0geSAtIHI7XG4gICAgbWF4LnggPSB4ICsgcjtcbiAgICBtYXgueSA9IHkgKyByO1xufTtcblxuXG5QMkNpcmNsZS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gUDJTaGFwZS5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICBqc29uLnJhZGl1cyA9IHRoaXMucmFkaXVzO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cblAyQ2lyY2xlLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgUDJTaGFwZS5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIHRoaXMucmFkaXVzID0ganNvbi5yYWRpdXM7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBQMkNpcmNsZTtcbiIsInZhciBWZWMyID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjMlwiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi4vLi4vYmFzZS9sb2dcIik7XG52YXIgUDJFbnVtcyA9IHJlcXVpcmUoXCIuLi9wMmVudW1zXCIpO1xudmFyIFAyU2hhcGUgPSByZXF1aXJlKFwiLi9wMnNoYXBlXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIFNoYXBlVHlwZSA9IFAyRW51bXMuU2hhcGVUeXBlO1xuXG5cbmZ1bmN0aW9uIFAyQ29udmV4KG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgUDJTaGFwZS5jYWxsKHRoaXMsIG9wdHMpO1xuXG4gICAgdGhpcy50eXBlID0gU2hhcGVUeXBlLkNvbnZleDtcblxuICAgIHRoaXMudmVydGljZXMgPSBvcHRzLnZlcnRpY2VzICE9IHVuZGVmaW5lZCA/IG9wdHMudmVydGljZXMgOiBbXG4gICAgICAgIG5ldyBWZWMyKDAuNSwgMC41KSxcbiAgICAgICAgbmV3IFZlYzIoLTAuNSwgMC41KSxcbiAgICAgICAgbmV3IFZlYzIoLTAuNSwgLTAuNSksXG4gICAgICAgIG5ldyBWZWMyKDAuNSwgLTAuNSlcbiAgICBdO1xuXG4gICAgaWYgKCFQMkNvbnZleC52YWxpZGF0ZVZlcnRpY2VzKHRoaXMudmVydGljZXMpKSB7XG4gICAgICAgIGxvZy53YXJuKFwiUDJDb252ZXguY29uc3RydWN0b3I6IHBhc3NlZCB2ZXJ0aWNlcyBhcmUgaW52YWxpZCwgY3JlYXRpbmcgY29udmV4IGh1bGwgZnJvbSB2ZXJ0aWNlcyB3aXRoIGdpZnQgd3JhcHBpbmcgYWxnb3JpdGhtXCIpO1xuICAgICAgICB0aGlzLnZlcnRpY2VzID0gUDJDb252ZXguY3JlYXRlQ29udmV4SHVsbCh0aGlzLnZlcnRpY2VzKTtcbiAgICB9XG5cbiAgICB0aGlzLm5vcm1hbHMgPSBbXTtcblxuICAgIHRoaXMuX3ZlcnRpY2VzID0gW107XG4gICAgdGhpcy5fbm9ybWFscyA9IFtdO1xuXG4gICAgdmFyIHZlcnRpY2VzID0gdGhpcy52ZXJ0aWNlcyxcbiAgICAgICAgd3ZlcnRzID0gdGhpcy5fdmVydGljZXMsXG4gICAgICAgIG5vcm1hbHMgPSB0aGlzLm5vcm1hbHMsXG4gICAgICAgIHdub3JtcyA9IHRoaXMuX25vcm1hbHMsXG4gICAgICAgIHYxLCB2MixcbiAgICAgICAgaTtcblxuICAgIGkgPSB2ZXJ0aWNlcy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICB2MSA9IHZlcnRpY2VzW2ldO1xuICAgICAgICB2MiA9IHZlcnRpY2VzW2kgKyAxXSB8fCB2ZXJ0aWNlc1swXTtcblxuICAgICAgICBub3JtYWxzW2ldID0gbmV3IFZlYzIodjIueSAtIHYxLnksIC0odjIueCAtIHYxLngpKS5ub3JtYWxpemUoKTtcblxuICAgICAgICB3dmVydHNbaV0gPSBuZXcgVmVjMih2MSk7XG4gICAgICAgIHdub3Jtc1tpXSA9IG5ldyBWZWMyKG5vcm1hbHNbaV0pO1xuICAgIH1cbn1cblxuUDJTaGFwZS5leHRlbmQoUDJDb252ZXgpO1xuXG5cblAyQ29udmV4LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgUDJTaGFwZS5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsIG90aGVyKTtcbiAgICB2YXIgdmVydGljZXMgPSBvdGhlci52ZXJ0aWNlcyxcbiAgICAgICAgbm9ybWFscyA9IG90aGVyLm5vcm1hbHMsXG4gICAgICAgIGk7XG5cbiAgICB0aGlzLnZlcnRpY2VzLmxlbmd0aCA9IHRoaXMubm9ybWFscy5sZW5ndGggPSB0aGlzLl92ZXJ0aWNlcy5sZW5ndGggPSB0aGlzLl9ub3JtYWxzLmxlbmd0aCA9IDA7XG5cbiAgICBpID0gdmVydGljZXMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHRoaXMudmVydGljZXNbaV0gPSB2ZXJ0aWNlc1tpXS5jbG9uZSgpO1xuXG4gICAgaSA9IG5vcm1hbHMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHRoaXMubm9ybWFsc1tpXSA9IG5vcm1hbHNbaV0uY2xvbmUoKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5QMkNvbnZleC5wcm90b3R5cGUucG9pbnRRdWVyeSA9IGZ1bmN0aW9uIChwKSB7XG4gICAgaWYgKCF0aGlzLmFhYmIuY29udGFpbnMocCkpIHJldHVybiBmYWxzZTtcbiAgICB2YXIgdmVydGljZXMgPSB0aGlzLl92ZXJ0aWNlcyxcbiAgICAgICAgbm9ybWFscyA9IHRoaXMuX25vcm1hbHMsXG4gICAgICAgIHB4ID0gcC54LFxuICAgICAgICBweSA9IHAueSxcbiAgICAgICAgbiwgbngsIG55LCB2LCB2eCwgdnksXG4gICAgICAgIGkgPSB2ZXJ0aWNlcy5sZW5ndGg7XG4gICAgO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBuID0gbm9ybWFsc1tpXTtcbiAgICAgICAgbnggPSBuLng7XG4gICAgICAgIG55ID0gbi55O1xuICAgICAgICB2ID0gdmVydGljZXNbaV07XG4gICAgICAgIHZ4ID0gdi54O1xuICAgICAgICB2eSA9IHYueTtcblxuICAgICAgICBpZiAoKG54ICogcHggKyBueSAqIHB5KSAtIChueCAqIHZ4ICsgbnkgKiB2eSkgPiAwKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG59XG5cblxuUDJDb252ZXgucHJvdG90eXBlLmNlbnRyb2lkID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB2MSA9IG5ldyBWZWMyLFxuICAgICAgICB2MiA9IG5ldyBWZWMyLFxuICAgICAgICB2c3VtID0gbmV3IFZlYzI7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgdmFyIGxvY2FsUG9zaXRpb24gPSB0aGlzLmxvY2FsUG9zaXRpb24sXG4gICAgICAgICAgICB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMsXG4gICAgICAgICAgICBsZW4gPSB2ZXJ0aWNlcy5sZW5ndGgsXG4gICAgICAgICAgICB2MXgsIHYxeSwgdjJ4LCB2MnksIGFyZWEgPSAwLFxuICAgICAgICAgICAgY3Jvc3MsXG4gICAgICAgICAgICBpID0gbGVuO1xuXG4gICAgICAgIHZzdW0ueCA9IHZzdW0ueSA9IDA7XG5cbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgdjEudmFkZChsb2NhbFBvc2l0aW9uLCB2ZXJ0aWNlc1tpXSk7XG4gICAgICAgICAgICB2Mi52YWRkKGxvY2FsUG9zaXRpb24sIHZlcnRpY2VzWyhpICsgMSkgJSBsZW5dKTtcblxuICAgICAgICAgICAgdjF4ID0gdjEueDtcbiAgICAgICAgICAgIHYxeSA9IHYxLnk7XG4gICAgICAgICAgICB2MnggPSB2Mi54O1xuICAgICAgICAgICAgdjJ5ID0gdjIueTtcblxuICAgICAgICAgICAgY3Jvc3MgPSB2MXggKiB2MnkgLSB2MXkgKiB2Mng7XG4gICAgICAgICAgICBhcmVhICs9IGNyb3NzO1xuXG4gICAgICAgICAgICB2c3VtLnggKz0gKHYxeCArIHYyeCkgKiBjcm9zcztcbiAgICAgICAgICAgIHZzdW0ueSArPSAodjF5ICsgdjJ5KSAqIGNyb3NzO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHYuY29weSh2c3VtKS5zbXVsKDEgLyAoMyAqIGFyZWEpKTtcbiAgICB9O1xufSgpO1xuXG5cblAyQ29udmV4LnByb3RvdHlwZS5hcmVhID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMsXG4gICAgICAgIGxlbiA9IHZlcnRpY2VzLmxlbmd0aCxcbiAgICAgICAgdjEsIHYyLCBhcmVhID0gMCxcbiAgICAgICAgaSA9IGxlbjtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgdjEgPSB2ZXJ0aWNlc1tpXTtcbiAgICAgICAgdjIgPSB2ZXJ0aWNlc1soaSArIDEpICUgbGVuXTtcblxuICAgICAgICBhcmVhICs9IHYxLnggKiB2Mi55IC0gdjEueSAqIHYyLng7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFyZWEgKiAwLjU7XG59O1xuXG5cblAyQ29udmV4LnByb3RvdHlwZS5pbmVydGlhID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB2MSA9IG5ldyBWZWMyLFxuICAgICAgICB2MiA9IG5ldyBWZWMyO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYXNzKSB7XG4gICAgICAgIHZhciBsb2NhbFBvc2l0aW9uID0gdGhpcy5sb2NhbFBvc2l0aW9uLFxuICAgICAgICAgICAgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzLFxuICAgICAgICAgICAgbGVuID0gdmVydGljZXMubGVuZ3RoLFxuICAgICAgICAgICAgdjF4LCB2MXksIHYyeCwgdjJ5LCBhID0gMCxcbiAgICAgICAgICAgIGIgPSAwLFxuICAgICAgICAgICAgc3VtMSA9IDAsXG4gICAgICAgICAgICBzdW0yID0gMCxcbiAgICAgICAgICAgIGkgPSBsZW47XG5cbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgdjEudmFkZChsb2NhbFBvc2l0aW9uLCB2ZXJ0aWNlc1tpXSk7XG4gICAgICAgICAgICB2Mi52YWRkKGxvY2FsUG9zaXRpb24sIHZlcnRpY2VzWyhpICsgMSkgJSBsZW5dKTtcblxuICAgICAgICAgICAgdjF4ID0gdjEueDtcbiAgICAgICAgICAgIHYxeSA9IHYxLnk7XG4gICAgICAgICAgICB2MnggPSB2Mi54O1xuICAgICAgICAgICAgdjJ5ID0gdjIueTtcblxuICAgICAgICAgICAgYSA9IHYyeCAqIHYxeSAtIHYyeSAqIHYxeDtcbiAgICAgICAgICAgIGIgPSAodjF4ICogdjF4ICsgdjF5ICogdjF5KSArICh2MXggKiB2MnggKyB2MXkgKiB2MnkpICsgKHYyeCAqIHYyeCArIHYyeSAqIHYyeSk7XG5cbiAgICAgICAgICAgIHN1bTEgKz0gYSAqIGI7XG4gICAgICAgICAgICBzdW0yICs9IGE7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gKG1hc3MgKiBzdW0xKSAvICg2ICogc3VtMik7XG4gICAgfTtcbn0oKTtcblxuXG5QMkNvbnZleC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKG1hdHJpeCkge1xuICAgIHZhciBsb2NhbE1hdHJpeCA9IHRoaXMubWF0cml4LFxuICAgICAgICBtYXRyaXhXb3JsZCA9IHRoaXMubWF0cml4V29ybGQsXG4gICAgICAgIGxvY2FsUG9zID0gdGhpcy5sb2NhbFBvc2l0aW9uLFxuXG4gICAgICAgIHZlcnRpY2VzID0gdGhpcy52ZXJ0aWNlcyxcbiAgICAgICAgbm9ybWFscyA9IHRoaXMubm9ybWFscyxcbiAgICAgICAgcG9zID0gdGhpcy5wb3NpdGlvbixcblxuICAgICAgICBhYWJiID0gdGhpcy5hYWJiLFxuICAgICAgICBtaW4gPSBhYWJiLm1pbixcbiAgICAgICAgbWF4ID0gYWFiYi5tYXgsXG4gICAgICAgIG1pbnggPSBJbmZpbml0eSxcbiAgICAgICAgbWlueSA9IEluZmluaXR5LFxuICAgICAgICBtYXh4ID0gLUluZmluaXR5LFxuICAgICAgICBtYXh5ID0gLUluZmluaXR5LFxuXG4gICAgICAgIHdub3JtcyA9IHRoaXMuX25vcm1hbHMsXG4gICAgICAgIHdub3JtLCB3dmVydHMgPSB0aGlzLl92ZXJ0aWNlcyxcbiAgICAgICAgd3ZlcnQsIHgsIHksXG4gICAgICAgIGkgPSB2ZXJ0aWNlcy5sZW5ndGg7XG5cbiAgICBsb2NhbE1hdHJpeC5zZXRSb3RhdGlvbih0aGlzLmxvY2FsUm90YXRpb24pO1xuICAgIGxvY2FsTWF0cml4LnNldFBvc2l0aW9uKGxvY2FsUG9zKTtcbiAgICBtYXRyaXhXb3JsZC5tbXVsKG1hdHJpeCwgbG9jYWxNYXRyaXgpO1xuXG4gICAgcG9zLnggPSBsb2NhbFBvcy54O1xuICAgIHBvcy55ID0gbG9jYWxQb3MueTtcbiAgICBwb3MudHJhbnNmb3JtTWF0MzIobWF0cml4KTtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgd3ZlcnQgPSB3dmVydHNbaV0gfHwgKHd2ZXJ0c1tpXSA9IG5ldyBWZWMyKTtcbiAgICAgICAgd25vcm0gPSB3bm9ybXNbaV0gfHwgKHdub3Jtc1tpXSA9IG5ldyBWZWMyKTtcblxuICAgICAgICB3bm9ybS5jb3B5KG5vcm1hbHNbaV0pLnRyYW5zZm9ybU1hdDIobWF0cml4V29ybGQpO1xuICAgICAgICB3dmVydC5jb3B5KHZlcnRpY2VzW2ldKS50cmFuc2Zvcm1NYXQzMihtYXRyaXhXb3JsZCk7XG4gICAgICAgIHggPSB3dmVydC54O1xuICAgICAgICB5ID0gd3ZlcnQueTtcblxuICAgICAgICBtaW54ID0geCA8IG1pbnggPyB4IDogbWlueDtcbiAgICAgICAgbWlueSA9IHkgPCBtaW55ID8geSA6IG1pbnk7XG5cbiAgICAgICAgbWF4eCA9IHggPiBtYXh4ID8geCA6IG1heHg7XG4gICAgICAgIG1heHkgPSB5ID4gbWF4eSA/IHkgOiBtYXh5O1xuICAgIH1cblxuICAgIG1pbi54ID0gbWlueDtcbiAgICBtaW4ueSA9IG1pbnk7XG4gICAgbWF4LnggPSBtYXh4O1xuICAgIG1heC55ID0gbWF4eTtcbn07XG5cblxuUDJDb252ZXgucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiA9IFAyU2hhcGUucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuICAgIHZhciB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMsXG4gICAgICAgIG5vcm1hbHMgPSB0aGlzLm5vcm1hbHMsXG4gICAgICAgIGpzb25WZXJ0aWNlcyA9IGpzb24udmVydGljZXMgfHwgKGpzb24udmVydGljZXMgPSBbXSksXG4gICAgICAgIGpzb25Ob3JtYWxzID0ganNvbi5ub3JtYWxzIHx8IChqc29uLm5vcm1hbHMgPSBbXSksXG4gICAgICAgIGk7XG5cbiAgICBpID0gdmVydGljZXMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIGpzb25WZXJ0aWNlc1tpXSA9IHZlcnRpY2VzW2ldLnRvSlNPTihqc29uVmVydGljZXNbaV0pO1xuXG4gICAgaSA9IG5vcm1hbHMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIGpzb25Ob3JtYWxzW2ldID0gbm9ybWFsc1tpXS50b0pTT04oanNvbk5vcm1hbHNbaV0pO1xuXG4gICAgcmV0dXJuIGpzb247XG59O1xuXG5cblAyQ29udmV4LnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgUDJTaGFwZS5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcbiAgICB2YXIgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzLFxuICAgICAgICBub3JtYWxzID0gdGhpcy5ub3JtYWxzLFxuICAgICAgICBqc29uVmVydGljZXMgPSBqc29uLnZlcnRpY2VzLFxuICAgICAgICBqc29uTm9ybWFscyA9IGpzb24ubm9ybWFscyxcbiAgICAgICAgdmVydGljZXNMZW5ndGggPSBqc29uVmVydGljZXMubGVuZ3RoLFxuICAgICAgICBub3JtYWxzTGVuZ3RoID0ganNvbk5vcm1hbHMubGVuZ3RoLFxuICAgICAgICBpO1xuXG4gICAgdmVydGljZXMubGVuZ3RoID0gdGhpcy5fdmVydGljZXMubGVuZ3RoID0gdmVydGljZXNMZW5ndGg7XG4gICAgbm9ybWFscy5sZW5ndGggPSB0aGlzLl9ub3JtYWxzLmxlbmd0aCA9IG5vcm1hbHNMZW5ndGg7XG5cbiAgICBpID0gdmVydGljZXNMZW5ndGg7XG4gICAgd2hpbGUgKGktLSkgdmVydGljZXNbaV0gPSAodmVydGljZXNbaV0gfHwgbmV3IFZlYzIoKSkuZnJvbUpTT04oanNvblZlcnRpY2VzW2ldKTtcblxuICAgIGkgPSBub3JtYWxzTGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIG5vcm1hbHNbaV0gPSAobm9ybWFsc1tpXSB8fCBuZXcgVmVjMigpKS5mcm9tSlNPTihqc29uTm9ybWFsc1tpXSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuUDJDb252ZXgudmFsaWRhdGVWZXJ0aWNlcyA9IFAyQ29udmV4LnByb3RvdHlwZS52YWxpZGF0ZVZlcnRpY2VzID0gZnVuY3Rpb24gKHZlcnRpY2VzKSB7XG4gICAgdmFyIGxlbiA9IHZlcnRpY2VzLmxlbmd0aCxcbiAgICAgICAgYSwgYiwgYngsIGJ5LCBjLCBhYngsIGFieSwgYmN4LCBiY3ksXG4gICAgICAgIGk7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgYSA9IHZlcnRpY2VzW2ldO1xuICAgICAgICBiID0gdmVydGljZXNbKGkgKyAxKSAlIGxlbl07XG4gICAgICAgIGJ4ID0gYi54O1xuICAgICAgICBieSA9IGIueTtcbiAgICAgICAgYyA9IHZlcnRpY2VzWyhpICsgMikgJSBsZW5dO1xuXG4gICAgICAgIGFieCA9IGJ4IC0gYS54O1xuICAgICAgICBhYnkgPSBieSAtIGEueTtcbiAgICAgICAgYmN4ID0gYy54IC0gYng7XG4gICAgICAgIGJjeSA9IGMueSAtIGJ5O1xuXG4gICAgICAgIGlmICgoYmN4ICogYWJ5IC0gYmN5ICogYWJ4KSA+IDApIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cblxuUDJDb252ZXguY3JlYXRlQ29udmV4SHVsbCA9IFAyQ29udmV4LnByb3RvdHlwZS5jcmVhdGVDb252ZXhIdWxsID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBodWxsID0gW10sXG4gICAgICAgIHIgPSBuZXcgVmVjMjtcblxuICAgIHJldHVybiBmdW5jdGlvbiAocG9pbnRzKSB7XG4gICAgICAgIHZhciBybWkgPSAwLFxuICAgICAgICAgICAgcm14ID0gLUluZmluaXR5LFxuICAgICAgICAgICAgbiA9IHBvaW50cy5sZW5ndGgsXG4gICAgICAgICAgICB2LCB2eCwgdnksXG4gICAgICAgICAgICBpaCwgaWUsIG0gPSAwLFxuICAgICAgICAgICAgYywgbmV3UG9pbnRzID0gW10sXG4gICAgICAgICAgICBmYWlsZWQgPSBmYWxzZSxcbiAgICAgICAgICAgIGk7XG5cbiAgICAgICAgZm9yIChpID0gbjsgaS0tOykge1xuICAgICAgICAgICAgdiA9IHBvaW50c1tpXTtcbiAgICAgICAgICAgIHZ4ID0gdi54O1xuICAgICAgICAgICAgdnkgPSB2Lnk7XG5cbiAgICAgICAgICAgIGlmICh2eCA+IHJteCB8fCAodnggPT0gcm14ICYmIHZ5IDwgcG9pbnRzW3JtaV0ueSkpIHtcbiAgICAgICAgICAgICAgICBybWkgPSBpO1xuICAgICAgICAgICAgICAgIHJteCA9IHZ4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaHVsbC5sZW5ndGggPSAwO1xuICAgICAgICBpaCA9IHJtaTtcblxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgaHVsbFttXSA9IGloO1xuXG4gICAgICAgICAgICBpZSA9IDA7XG4gICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGllID09PSBpaCkge1xuICAgICAgICAgICAgICAgICAgICBpZSA9IGk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHIudnN1Yihwb2ludHNbaWVdLCBwb2ludHNbaHVsbFttXV0pO1xuICAgICAgICAgICAgICAgIHYudnN1Yihwb2ludHNbaV0sIHBvaW50c1todWxsW21dXSk7XG4gICAgICAgICAgICAgICAgYyA9IHYuY3Jvc3Mocik7XG5cbiAgICAgICAgICAgICAgICBpZiAoYyA8IDApIGllID0gaTtcblxuICAgICAgICAgICAgICAgIGlmIChjID09PSAwICYmIHYubGVuU3EoKSA+IHIubGVuU3EoKSkge1xuICAgICAgICAgICAgICAgICAgICBpZSA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtKys7XG4gICAgICAgICAgICBpaCA9IGllO1xuXG4gICAgICAgICAgICBpZiAobSA+IG4pIHtcbiAgICAgICAgICAgICAgICBmYWlsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGllID09PSBybWkpIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZhaWxlZCkge1xuICAgICAgICAgICAgTG9nLndhcm4oXCJQMkNvbnZleC5jb25zdHJ1Y3RvcjogZ2lmdCB3cmFwcGluZyBhbGdvcml0aG0gZmFpbGVkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBuZXcgVmVjMigwLjUsIDAuNSksXG4gICAgICAgICAgICAgICAgbmV3IFZlYzIoLTAuNSwgMC41KSxcbiAgICAgICAgICAgICAgICBuZXcgVmVjMigtMC41LCAtMC41KSxcbiAgICAgICAgICAgICAgICBuZXcgVmVjMigwLjUsIC0wLjUpXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChpID0gbTsgaS0tOykge1xuICAgICAgICAgICAgbmV3UG9pbnRzLnB1c2gocG9pbnRzW2h1bGxbaV1dKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghUDJDb252ZXgudmFsaWRhdGVWZXJ0aWNlcyhuZXdQb2ludHMpKSB7XG4gICAgICAgICAgICBMb2cud2FybihcIlAyQ29udmV4LmNvbnN0cnVjdG9yOiBnaWZ0IHdyYXBwaW5nIGFsZ29yaXRobSBmYWlsZWRcIik7XG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIG5ldyBWZWMyKDAuNSwgMC41KSxcbiAgICAgICAgICAgICAgICBuZXcgVmVjMigtMC41LCAwLjUpLFxuICAgICAgICAgICAgICAgIG5ldyBWZWMyKC0wLjUsIC0wLjUpLFxuICAgICAgICAgICAgICAgIG5ldyBWZWMyKDAuNSwgLTAuNSlcbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3UG9pbnRzO1xuICAgIH07XG59KCk7XG5cblxubW9kdWxlLmV4cG9ydHMgPSBQMkNvbnZleDtcbiIsInZhciBWZWMyID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjMlwiKTtcbnZhciBQMkNvbnZleCA9IHJlcXVpcmUoXCIuL3AyY29udmV4XCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZnVuY3Rpb24gUDJSZWN0KG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgdmFyIGV4dGVudHMgPSBvcHRzLmV4dGVudHMgfHwgbmV3IFZlYzIoMC41LCAwLjUpLFxuICAgICAgICB4ID0gZXh0ZW50cy54LFxuICAgICAgICB5ID0gZXh0ZW50cy55O1xuXG4gICAgb3B0cy52ZXJ0aWNlcyA9IFtcbiAgICAgICAgbmV3IFZlYzIoeCwgeSksXG4gICAgICAgIG5ldyBWZWMyKC14LCB5KSxcbiAgICAgICAgbmV3IFZlYzIoLXgsIC15KSxcbiAgICAgICAgbmV3IFZlYzIoeCwgLXkpXG4gICAgXTtcblxuICAgIFAyQ29udmV4LmNhbGwodGhpcywgb3B0cyk7XG5cbiAgICB0aGlzLmV4dGVudHMgPSBleHRlbnRzO1xufVxuXG5QMkNvbnZleC5leHRlbmQoUDJSZWN0KTtcblxuXG5QMlJlY3QucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiA9IFAyQ29udmV4LnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIGpzb24uZXh0ZW50cyA9IHRoaXMuZXh0ZW50cy50b0pTT04oanNvbi5leHRlbnRzKTtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5QMlJlY3QucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBQMkNvbnZleC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIHRoaXMuZXh0ZW50cy5mcm9tSlNPTihqc29uLmV4dGVudHMpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUDJSZWN0O1xuIiwidmFyIENsYXNzID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvY2xhc3NcIik7XG52YXIgQUFCQjIgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9hYWJiMlwiKTtcbnZhciBWZWMyID0gcmVxdWlyZShcIi4uLy4uL21hdGgvdmVjMlwiKTtcbnZhciBNYXQzMiA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL21hdDMyXCIpO1xudmFyIExvZyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2xvZ1wiKTtcbnZhciBQMkVudW1zID0gcmVxdWlyZShcIi4uL3AyZW51bXNcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgVFdPX1BJID0gTWF0aC5QSSAqIDIsXG4gICAgcG93ID0gTWF0aC5wb3csXG5cbiAgICBCb2R5VHlwZSA9IFAyRW51bXMuQm9keVR5cGUsXG4gICAgTW90aW9uU3RhdGUgPSBQMkVudW1zLk1vdGlvblN0YXRlLFxuICAgIFNsZWVwU3RhdGUgPSBQMkVudW1zLlNsZWVwU3RhdGU7XG5cblxuZnVuY3Rpb24gUDJSaWdpZGJvZHkob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBDbGFzcy5jYWxsKHRoaXMsIG9wdHMpO1xuXG4gICAgdGhpcy50eXBlID0gQm9keVR5cGUuUmlnaWRCb2R5O1xuICAgIHRoaXMuX2luZGV4ID0gLTE7XG5cbiAgICB0aGlzLnNwYWNlID0gdW5kZWZpbmVkO1xuXG4gICAgdGhpcy5wb3NpdGlvbiA9IG9wdHMucG9zaXRpb24gIT0gdW5kZWZpbmVkID8gb3B0cy5wb3NpdGlvbiA6IG5ldyBWZWMyO1xuICAgIHRoaXMudmVsb2NpdHkgPSBvcHRzLnZlbG9jaXR5ICE9IHVuZGVmaW5lZCA/IG9wdHMudmVsb2NpdHkgOiBuZXcgVmVjMjtcbiAgICB0aGlzLmZvcmNlID0gbmV3IFZlYzI7XG5cbiAgICB0aGlzLnJvdGF0aW9uID0gb3B0cy5yb3RhdGlvbiAhPSB1bmRlZmluZWQgPyBvcHRzLnJvdGF0aW9uIDogMDtcbiAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IG9wdHMuYW5ndWxhclZlbG9jaXR5ICE9IHVuZGVmaW5lZCA/IG9wdHMuYW5ndWxhclZlbG9jaXR5IDogMDtcbiAgICB0aGlzLnRvcnF1ZSA9IDA7XG5cbiAgICB0aGlzLmxpbmVhckRhbXBpbmcgPSBvcHRzLmxpbmVhckRhbXBpbmcgIT0gdW5kZWZpbmVkID8gb3B0cy5saW5lYXJEYW1waW5nIDogMC4wMTtcbiAgICB0aGlzLmFuZ3VsYXJEYW1waW5nID0gb3B0cy5hbmd1bGFyRGFtcGluZyAhPSB1bmRlZmluZWQgPyBvcHRzLmFuZ3VsYXJEYW1waW5nIDogVFdPX1BJICogMC4wMTtcblxuICAgIHRoaXMubWF0cml4ID0gbmV3IE1hdDMyKCk7XG4gICAgdGhpcy5hYWJiID0gbmV3IEFBQkIyO1xuXG4gICAgdGhpcy5tYXNzID0gb3B0cy5tYXNzICE9IHVuZGVmaW5lZCA/IG9wdHMubWFzcyA6IDAuMDtcbiAgICB0aGlzLmludk1hc3MgPSB0aGlzLm1hc3MgPiAwLjAgPyAxLjAgLyB0aGlzLm1hc3MgOiAwLjA7XG5cbiAgICB0aGlzLmluZXJ0aWEgPSAwO1xuICAgIHRoaXMuaW52SW5lcnRpYSA9IDA7XG5cbiAgICB0aGlzLnNoYXBlcyA9IFtdO1xuXG4gICAgdGhpcy5tb3Rpb25TdGF0ZSA9IG9wdHMubW90aW9uU3RhdGUgIT0gdW5kZWZpbmVkID8gb3B0cy5tb3Rpb25TdGF0ZSA6IE1vdGlvblN0YXRlLlN0YXRpYztcblxuICAgIHRoaXMuYWxsb3dTbGVlcCA9IG9wdHMuYWxsb3dTbGVlcCAhPSB1bmRlZmluZWQgPyAhIW9wdHMuYWxsb3dTbGVlcCA6IHRydWU7XG4gICAgdGhpcy5zbGVlcFN0YXRlID0gU2xlZXBTdGF0ZS5Bd2FrZTtcblxuICAgIHRoaXMuc2xlZXBWZWxvY2l0eUxpbWl0ID0gb3B0cy5zbGVlcFZlbG9jaXR5TGltaXQgIT0gdW5kZWZpbmVkID8gISFvcHRzLnNsZWVwVmVsb2NpdHlMaW1pdCA6IDAuMDE7XG4gICAgdGhpcy5zbGVlcFRpbWVMaW1pdCA9IG9wdHMuc2xlZXBUaW1lTGltaXQgIT0gdW5kZWZpbmVkID8gISFvcHRzLnNsZWVwVGltZUxpbWl0IDogMS4wO1xuICAgIHRoaXMuc2xlZXBBbmd1bGFyVmVsb2NpdHlMaW1pdCA9IG9wdHMuc2xlZXBBbmd1bGFyVmVsb2NpdHlMaW1pdCAhPSB1bmRlZmluZWQgPyAhIW9wdHMuc2xlZXBBbmd1bGFyVmVsb2NpdHlMaW1pdCA6IFRXT19QSSAqIDAuMDE7XG5cbiAgICB0aGlzLnVzZXJEYXRhID0gdW5kZWZpbmVkO1xuXG4gICAgdGhpcy5fc2xlZXBUaW1lID0gMC4wO1xuICAgIHRoaXMuX2xhc3RTbGVlcHlUaW1lID0gMC4wO1xuXG4gICAgdGhpcy52bGFtYmRhID0gbmV3IFZlYzI7XG4gICAgdGhpcy53bGFtYmRhID0gMDtcblxuICAgIGlmIChvcHRzLnNoYXBlKSB0aGlzLmFkZFNoYXBlKG9wdHMuc2hhcGUpO1xuICAgIGlmIChvcHRzLnNoYXBlcykgdGhpcy5hZGRTaGFwZXMuYXBwbHkodGhpcywgb3B0cy5zaGFwZXMpO1xufVxuXG5DbGFzcy5leHRlbmQoUDJSaWdpZGJvZHkpO1xuXG5cblAyUmlnaWRib2R5LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIHNoYXBlcyA9IG90aGVyLnNoYXBlcyxcbiAgICAgICAgaSA9IHNoYXBlcy5sZW5ndGg7XG5cbiAgICB0aGlzLmNsZWFyKCk7XG5cbiAgICB0aGlzLm1vdGlvblN0YXRlID0gb3RoZXIubW90aW9uU3RhdGU7XG5cbiAgICB0aGlzLnBvc2l0aW9uLmNvcHkob3RoZXIucG9zaXRpb24pO1xuICAgIHRoaXMudmVsb2NpdHkuY29weShvdGhlci52ZWxvY2l0eSk7XG4gICAgdGhpcy5mb3JjZS5jb3B5KG90aGVyLmZvcmNlKTtcblxuICAgIHRoaXMubGluZWFyRGFtcGluZyA9IG90aGVyLmxpbmVhckRhbXBpbmc7XG5cbiAgICB0aGlzLm1hc3MgPSBvdGhlci5tYXNzO1xuICAgIHRoaXMuaW52TWFzcyA9IG90aGVyLmludk1hc3M7XG5cbiAgICB0aGlzLmFsbG93U2xlZXAgPSBvdGhlci5hbGxvd1NsZWVwO1xuICAgIHRoaXMuc2xlZXBTdGF0ZSA9IG90aGVyLnNsZWVwU3RhdGU7XG5cbiAgICB0aGlzLnJvdGF0aW9uID0gb3RoZXIucm90YXRpb247XG4gICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkgPSBvdGhlci5hbmd1bGFyVmVsb2NpdHk7XG4gICAgdGhpcy50b3JxdWUgPSBvdGhlci50b3JxdWU7XG5cbiAgICB0aGlzLmFuZ3VsYXJEYW1waW5nID0gb3RoZXIuYW5ndWxhckRhbXBpbmc7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLmFkZFNoYXBlKHNoYXBlc1tpXS5jbG9uZSgpKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG52YXIgVkVDMl9TQ0FMRSA9IG5ldyBWZWMyKDEuMCwgMS4wKTtcblAyUmlnaWRib2R5LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzaGFwZXMgPSB0aGlzLnNoYXBlcyxcbiAgICAgICAgbWF0cml4ID0gdGhpcy5tYXRyaXgsXG4gICAgICAgIGFhYmIgPSB0aGlzLmFhYmIsXG4gICAgICAgIHNoYXBlLFxuICAgICAgICBpID0gc2hhcGVzLmxlbmd0aDtcblxuICAgIG1hdHJpeC5jb21wb3NlKHRoaXMucG9zaXRpb24sIFZFQzJfU0NBTEUsIHRoaXMucm90YXRpb24pO1xuICAgIGFhYmIuY2xlYXIoKTtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgc2hhcGUgPSBzaGFwZXNbaV07XG4gICAgICAgIHNoYXBlLnVwZGF0ZShtYXRyaXgpO1xuICAgICAgICBhYWJiLnVuaW9uKHNoYXBlLmFhYmIpO1xuICAgIH1cblxuICAgIHRoaXMucmVzZXRNYXNzRGF0YSgpO1xufTtcblxuXG5QMlJpZ2lkYm9keS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGR0KSB7XG4gICAgaWYgKHRoaXMubW90aW9uU3RhdGUgPT09IE1vdGlvblN0YXRlLlN0YXRpYykgcmV0dXJuO1xuICAgIHZhciBzaGFwZXMgPSB0aGlzLnNoYXBlcyxcbiAgICAgICAgZm9yY2UgPSB0aGlzLmZvcmNlLFxuICAgICAgICBpbnZNYXNzID0gdGhpcy5pbnZNYXNzLFxuICAgICAgICBwb3MgPSB0aGlzLnBvc2l0aW9uLFxuICAgICAgICB2ZWwgPSB0aGlzLnZlbG9jaXR5LFxuICAgICAgICBsaW5lYXJEYW1waW5nID0gcG93KDEgLSB0aGlzLmxpbmVhckRhbXBpbmcsIGR0KSxcbiAgICAgICAgbWF0cml4ID0gdGhpcy5tYXRyaXgsXG4gICAgICAgIGFhYmIgPSB0aGlzLmFhYmIsXG4gICAgICAgIHNoYXBlLFxuICAgICAgICBpO1xuXG4gICAgdmVsLnggKz0gZm9yY2UueCAqIGludk1hc3MgKiBkdDtcbiAgICB2ZWwueSArPSBmb3JjZS55ICogaW52TWFzcyAqIGR0O1xuICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5ICs9IHRoaXMudG9ycXVlICogdGhpcy5pbnZJbmVydGlhICogZHQ7XG5cbiAgICBmb3JjZS54ID0gZm9yY2UueSA9IHRoaXMudG9ycXVlID0gMDtcblxuICAgIHZlbC54ICo9IGxpbmVhckRhbXBpbmc7XG4gICAgdmVsLnkgKj0gbGluZWFyRGFtcGluZztcblxuICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5ICo9IHBvdygxIC0gdGhpcy5hbmd1bGFyRGFtcGluZywgZHQpO1xuXG4gICAgaWYgKHRoaXMuc2xlZXBTdGF0ZSAhPT0gU2xlZXBTdGF0ZS5TbGVlcGluZykge1xuXG4gICAgICAgIHBvcy54ICs9IHZlbC54ICogZHQ7XG4gICAgICAgIHBvcy55ICs9IHZlbC55ICogZHQ7XG5cbiAgICAgICAgdGhpcy5yb3RhdGlvbiArPSB0aGlzLmFuZ3VsYXJWZWxvY2l0eSAqIGR0O1xuXG4gICAgICAgIG1hdHJpeC5jb21wb3NlKHBvcywgVkVDMl9TQ0FMRSwgdGhpcy5yb3RhdGlvbik7XG4gICAgICAgIGFhYmIuY2xlYXIoKTtcblxuICAgICAgICBpID0gc2hhcGVzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgc2hhcGUgPSBzaGFwZXNbaV07XG4gICAgICAgICAgICBzaGFwZS51cGRhdGUobWF0cml4KTtcbiAgICAgICAgICAgIGFhYmIudW5pb24oc2hhcGUuYWFiYik7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5cblAyUmlnaWRib2R5LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2hhcGVzID0gdGhpcy5zaGFwZXMsXG4gICAgICAgIGkgPSBzaGFwZXMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkgdGhpcy5yZW1vdmVTaGFwZShzaGFwZXNbaV0pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblAyUmlnaWRib2R5LnByb3RvdHlwZS5hcHBseUZvcmNlID0gZnVuY3Rpb24gKGZvcmNlLCB3b3JsZFBvaW50KSB7XG4gICAgaWYgKHRoaXMubW90aW9uU3RhdGUgPT09IE1vdGlvblN0YXRlLlN0YXRpYykgcmV0dXJuO1xuICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IFNsZWVwU3RhdGUuU2xlZXBpbmcpIHRoaXMud2FrZSgpO1xuICAgIHZhciBwb3MgPSB0aGlzLnBvc2l0aW9uLFxuICAgICAgICBmID0gdGhpcy5mb3JjZSxcbiAgICAgICAgZnggPSBmb3JjZS54LFxuICAgICAgICBmeSA9IGZvcmNlLnksXG4gICAgICAgIHB4LCBweTtcblxuICAgIHdvcmxkUG9pbnQgPSB3b3JsZFBvaW50IHx8IHBvcztcblxuICAgIHB4ID0gd29ybGRQb2ludC54IC0gcG9zLng7XG4gICAgcHkgPSB3b3JsZFBvaW50LnkgLSBwb3MueTtcblxuICAgIGYueCArPSBmeDtcbiAgICBmLnkgKz0gZnk7XG5cbiAgICB0aGlzLnRvcnF1ZSArPSBweCAqIGZ5IC0gcHkgKiBmeDtcbn07XG5cblxuUDJSaWdpZGJvZHkucHJvdG90eXBlLmFwcGx5VG9ycXVlID0gZnVuY3Rpb24gKHRvcnF1ZSkge1xuICAgIGlmICh0aGlzLm1vdGlvblN0YXRlID09PSBNb3Rpb25TdGF0ZS5TdGF0aWMpIHJldHVybjtcbiAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBTbGVlcFN0YXRlLlNsZWVwaW5nKSB0aGlzLndha2UoKTtcblxuICAgIHRoaXMudG9ycXVlICs9IHRvcnF1ZTtcbn07XG5cblxuUDJSaWdpZGJvZHkucHJvdG90eXBlLmFwcGx5SW1wdWxzZSA9IGZ1bmN0aW9uIChpbXB1bHNlLCB3b3JsZFBvaW50KSB7XG4gICAgaWYgKHRoaXMubW90aW9uU3RhdGUgPT09IE1vdGlvblN0YXRlLlN0YXRpYykgcmV0dXJuO1xuICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IFNsZWVwU3RhdGUuU2xlZXBpbmcpIHRoaXMud2FrZSgpO1xuICAgIHZhciBwb3MgPSB0aGlzLnBvc2l0aW9uLFxuICAgICAgICBpbnZNYXNzID0gdGhpcy5pbnZNYXNzLFxuICAgICAgICB2ZWxvY2l0eSA9IHRoaXMudmVsb2NpdHksXG4gICAgICAgIGl4ID0gaW1wdWxzZS54LFxuICAgICAgICBpeSA9IGltcHVsc2UueSxcbiAgICAgICAgcHgsIHB5O1xuXG4gICAgd29ybGRQb2ludCA9IHdvcmxkUG9pbnQgfHwgcG9zO1xuXG4gICAgcHggPSB3b3JsZFBvaW50LnggLSBwb3MueDtcbiAgICBweSA9IHdvcmxkUG9pbnQueSAtIHBvcy55O1xuXG4gICAgdmVsb2NpdHkueCArPSBpeCAqIGludk1hc3M7XG4gICAgdmVsb2NpdHkueSArPSBpeSAqIGludk1hc3M7XG5cbiAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSArPSAocHggKiBpeSAtIHB5ICogaXgpICogdGhpcy5pbnZJbmVydGlhO1xufTtcblxuXG5QMlJpZ2lkYm9keS5wcm90b3R5cGUuYXBwbHlWZWxvY2l0eSA9IGZ1bmN0aW9uICh2ZWxvY2l0eSkge1xuICAgIGlmICh0aGlzLm1vdGlvblN0YXRlID09PSBNb3Rpb25TdGF0ZS5TdGF0aWMpIHJldHVybjtcbiAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBTbGVlcFN0YXRlLlNsZWVwaW5nKSB0aGlzLndha2UoKTtcbiAgICB2YXIgdmVsID0gdGhpcy52ZWxvY2l0eTtcblxuICAgIHZlbC54ICs9IHZlbG9jaXR5Lng7XG4gICAgdmVsLnkgKz0gdmVsb2NpdHkueTtcbn07XG5cblxuUDJSaWdpZGJvZHkucHJvdG90eXBlLmFwcGx5QW5ndWxhclZlbG9jaXR5ID0gZnVuY3Rpb24gKGFuZ3VsYXJWZWxvY2l0eSkge1xuICAgIGlmICh0aGlzLm1vdGlvblN0YXRlID09PSBNb3Rpb25TdGF0ZS5TdGF0aWMpIHJldHVybjtcbiAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBTbGVlcFN0YXRlLlNsZWVwaW5nKSB0aGlzLndha2UoKTtcblxuICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5ICs9IGFuZ3VsYXJWZWxvY2l0eTtcbn07XG5cblxudmFyIHRvdGFsQ2VudHJvaWQgPSBuZXcgVmVjMixcbiAgICBjZW50cm9pZCA9IG5ldyBWZWMyO1xuUDJSaWdpZGJvZHkucHJvdG90eXBlLnJlc2V0TWFzc0RhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMubW90aW9uU3RhdGUgIT09IE1vdGlvblN0YXRlLkR5bmFtaWMpIHJldHVybjtcbiAgICB2YXIgc2hhcGVzID0gdGhpcy5zaGFwZXMsXG4gICAgICAgIHNoYXBlLFxuICAgICAgICB0b3RhbE1hc3MgPSAwLFxuICAgICAgICB0b3RhbEluZXJ0aWEgPSAwLFxuICAgICAgICBtYXNzLCBpbmVydGlhLFxuICAgICAgICBpO1xuXG4gICAgdG90YWxDZW50cm9pZC54ID0gdG90YWxDZW50cm9pZC55ID0gMDtcblxuICAgIGkgPSBzaGFwZXMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgc2hhcGUgPSBzaGFwZXNbaV07XG5cbiAgICAgICAgc2hhcGUuY2VudHJvaWQoY2VudHJvaWQpO1xuICAgICAgICBtYXNzID0gc2hhcGUuYXJlYSgpICogc2hhcGUuZGVuc2l0eTtcbiAgICAgICAgaW5lcnRpYSA9IHNoYXBlLmluZXJ0aWEobWFzcyk7XG5cbiAgICAgICAgdG90YWxDZW50cm9pZC5hZGQoY2VudHJvaWQuc211bChtYXNzKSk7XG4gICAgICAgIHRvdGFsTWFzcyArPSBtYXNzO1xuICAgICAgICB0b3RhbEluZXJ0aWEgKz0gaW5lcnRpYTtcbiAgICB9XG5cbiAgICBjZW50cm9pZC5jb3B5KHRvdGFsQ2VudHJvaWQuc2Rpdih0b3RhbE1hc3MpKTtcblxuICAgIHRoaXMuc2V0TWFzcyh0b3RhbE1hc3MpO1xuICAgIHRoaXMuc2V0SW5lcnRpYSh0b3RhbEluZXJ0aWEgLSB0b3RhbE1hc3MgKiBjZW50cm9pZC5sZW5ndGhTcSgpKTtcbn07XG5cblxuUDJSaWdpZGJvZHkucHJvdG90eXBlLnNldE1vdGlvblN0YXRlID0gZnVuY3Rpb24gKG1vdGlvblN0YXRlKSB7XG4gICAgaWYgKHRoaXMubW90aW9uU3RhdGUgPT09IG1vdGlvblN0YXRlKSByZXR1cm47XG5cbiAgICB0aGlzLm1vdGlvblN0YXRlID0gbW90aW9uU3RhdGU7XG5cbiAgICB0aGlzLnZlbG9jaXR5LnNldCgwLCAwKTtcbiAgICB0aGlzLmZvcmNlLnNldCgwLCAwKTtcbiAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IHRoaXMudG9ycXVlID0gMDtcblxuICAgIHRoaXMud2FrZSgpO1xufTtcblxuXG5QMlJpZ2lkYm9keS5wcm90b3R5cGUuc2V0SW5lcnRpYSA9IGZ1bmN0aW9uIChpbmVydGlhKSB7XG5cbiAgICB0aGlzLmluZXJ0aWEgPSBpbmVydGlhO1xuICAgIHRoaXMuaW52SW5lcnRpYSA9IGluZXJ0aWEgPiAwLjAgPyAxLjAgLyBpbmVydGlhIDogMC4wO1xufTtcblxuXG5QMlJpZ2lkYm9keS5wcm90b3R5cGUuc2V0TWFzcyA9IGZ1bmN0aW9uIChtYXNzKSB7XG5cbiAgICB0aGlzLm1hc3MgPSBtYXNzO1xuICAgIHRoaXMuaW52TWFzcyA9IG1hc3MgPiAwLjAgPyAxLjAgLyBtYXNzIDogMC4wO1xufTtcblxuXG5QMlJpZ2lkYm9keS5wcm90b3R5cGUuaXNBd2FrZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiB0aGlzLnNsZWVwU3RhdGUgPT09IFNsZWVwU3RhdGUuQXdha2U7XG59O1xuXG5cblAyUmlnaWRib2R5LnByb3RvdHlwZS5pc1NsZWVweSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiB0aGlzLnNsZWVwU3RhdGUgPT09IFNsZWVwU3RhdGUuU2xlZXB5O1xufTtcblxuXG5QMlJpZ2lkYm9keS5wcm90b3R5cGUuaXNTbGVlcGluZyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiB0aGlzLnNsZWVwU3RhdGUgPT09IFNsZWVwU3RhdGUuU2xlZXBpbmc7XG59O1xuXG5cblAyUmlnaWRib2R5LnByb3RvdHlwZS5pc1N0YXRpYyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiB0aGlzLm1vdGlvblN0YXRlID09PSBNb3Rpb25TdGF0ZS5TdGF0aWM7XG59O1xuXG5cblAyUmlnaWRib2R5LnByb3RvdHlwZS5pc0R5bmFtaWMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICByZXR1cm4gdGhpcy5tb3Rpb25TdGF0ZSA9PT0gTW90aW9uU3RhdGUuRHluYW1pYztcbn07XG5cblxuUDJSaWdpZGJvZHkucHJvdG90eXBlLmlzS2luZW1hdGljID0gZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIHRoaXMubW90aW9uU3RhdGUgPT09IE1vdGlvblN0YXRlLktpbmVtYXRpYztcbn07XG5cblxuUDJSaWdpZGJvZHkucHJvdG90eXBlLndha2UgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBTbGVlcFN0YXRlLlNsZWVwaW5nKSB0aGlzLmVtaXQoXCJ3YWtlXCIpO1xuICAgIHRoaXMuc2xlZXBTdGF0ZSA9IFNsZWVwU3RhdGUuQXdha2U7XG59O1xuXG5cblAyUmlnaWRib2R5LnByb3RvdHlwZS5zbGVlcCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgIT09IFNsZWVwU3RhdGUuU2xlZXBpbmcpIHRoaXMuZW1pdChcInNsZWVwXCIpO1xuICAgIHRoaXMuc2xlZXBTdGF0ZSA9IFNsZWVwU3RhdGUuU2xlZXBpbmc7XG59O1xuXG5cblAyUmlnaWRib2R5LnByb3RvdHlwZS5hZGRTaGFwZSA9IGZ1bmN0aW9uIChzaGFwZSkge1xuICAgIHZhciBzaGFwZXMgPSB0aGlzLnNoYXBlcyxcbiAgICAgICAgaW5kZXggPSBzaGFwZXMuaW5kZXhPZihzaGFwZSk7XG5cbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIHNoYXBlLmJvZHkgPSB0aGlzO1xuXG4gICAgICAgIHNoYXBlcy5wdXNoKHNoYXBlKTtcblxuICAgICAgICBpZiAodGhpcy5zcGFjZSkge1xuICAgICAgICAgICAgc2hhcGUudXBkYXRlKHRoaXMubWF0cml4KTtcbiAgICAgICAgICAgIHRoaXMucmVzZXRNYXNzRGF0YSgpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgTG9nLmVycm9yKFwiUDJSaWdpZGJvZHkuYWRkU2hhcGU6IFNoYXBlIGFscmVhZHkgYXR0YWNoZWQgdG8gQm9keVwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuUDJSaWdpZGJvZHkucHJvdG90eXBlLmFkZFNoYXBlcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIGZvciAodmFyIGkgPSBhcmd1bWVudHMubGVuZ3RoOyBpLS07KSB0aGlzLmFkZFNoYXBlKGFyZ3VtZW50c1tpXSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblAyUmlnaWRib2R5LnByb3RvdHlwZS5yZW1vdmVTaGFwZSA9IGZ1bmN0aW9uIChzaGFwZSkge1xuICAgIHZhciBzaGFwZXMgPSB0aGlzLnNoYXBlcyxcbiAgICAgICAgaW5kZXggPSBzaGFwZXMuaW5kZXhPZihzaGFwZSk7XG5cbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgIHNoYXBlLmJvZHkgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgc2hhcGVzLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICAgICAgaWYgKHRoaXMuc3BhY2UpIHRoaXMucmVzZXRNYXNzRGF0YSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIlAyUmlnaWRib2R5LnJlbW92ZVNoYXBlOiBTaGFwZSBub3QgYXR0YWNoZWQgdG8gQm9keVwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuUDJSaWdpZGJvZHkucHJvdG90eXBlLnJlbW92ZVNoYXBlcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIGZvciAodmFyIGkgPSBhcmd1bWVudHMubGVuZ3RoOyBpLS07KSB0aGlzLnJlbW92ZVNoYXBlKGFyZ3VtZW50c1tpXSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblAyUmlnaWRib2R5LnByb3RvdHlwZS5mb3JFYWNoU2hhcGUgPSBmdW5jdGlvbiAoZm4sIGN0eCkge1xuICAgIHZhciBzaGFwZXMgPSB0aGlzLnNoYXBlcyxcbiAgICAgICAgaSA9IHNoYXBlcy5sZW5ndGg7XG5cbiAgICBpZiAoY3R4KSB7XG4gICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgIGlmIChmbi5jYWxsKGN0eCwgc2hhcGVzW2ldLCBpLCBzaGFwZXMpID09PSBmYWxzZSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBpZiAoZm4oc2hhcGVzW2ldLCBpLCBzaGFwZXMpID09PSBmYWxzZSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuUDJSaWdpZGJvZHkucHJvdG90eXBlLnNsZWVwVGljayA9IGZ1bmN0aW9uICh0aW1lKSB7XG5cbiAgICBpZiAodGhpcy5hbGxvd1NsZWVwKSB7XG4gICAgICAgIHZhciBzbGVlcFN0YXRlID0gdGhpcy5zbGVlcFN0YXRlLFxuICAgICAgICAgICAgdmVsU3EgPSB0aGlzLnZlbG9jaXR5Lmxlbmd0aFNxKCksXG4gICAgICAgICAgICBzbGVlcFZlbG9jaXR5TGltaXQgPSB0aGlzLnNsZWVwVmVsb2NpdHlMaW1pdCAqIHRoaXMuc2xlZXBWZWxvY2l0eUxpbWl0LFxuICAgICAgICAgICAgYVZlbCA9IHRoaXMuYW5ndWxhclZlbG9jaXR5LFxuICAgICAgICAgICAgc2xlZXBBbmd1bGFyVmVsb2NpdHlMaW1pdCA9IHRoaXMuc2xlZXBBbmd1bGFyVmVsb2NpdHlMaW1pdDtcblxuICAgICAgICBpZiAoc2xlZXBTdGF0ZSA9PT0gU2xlZXBTdGF0ZS5Bd2FrZSAmJiAodmVsU3EgPCBzbGVlcFZlbG9jaXR5TGltaXQgJiYgYVZlbCA8IHNsZWVwQW5ndWxhclZlbG9jaXR5TGltaXQpKSB7XG4gICAgICAgICAgICB0aGlzLnNsZWVwU3RhdGUgPSBTbGVlcFN0YXRlLlNsZWVweTtcbiAgICAgICAgICAgIHRoaXMuX3NsZWVwVGltZSA9IHRpbWU7XG4gICAgICAgIH0gZWxzZSBpZiAoc2xlZXBTdGF0ZSA9PT0gU2xlZXBTdGF0ZS5TbGVlcHkgJiYgKHZlbFNxID4gc2xlZXBWZWxvY2l0eUxpbWl0IHx8IGFWZWwgPiBzbGVlcEFuZ3VsYXJWZWxvY2l0eUxpbWl0KSkge1xuICAgICAgICAgICAgdGhpcy53YWtlKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2xlZXBTdGF0ZSA9PT0gU2xlZXBTdGF0ZS5TbGVlcHkgJiYgKHRpbWUgLSB0aGlzLl9sYXN0U2xlZXB5VGltZSkgPiB0aGlzLnNsZWVwVGltZUxpbWl0KSB7XG4gICAgICAgICAgICB0aGlzLnNsZWVwKCk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5cblAyUmlnaWRib2R5LnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDbGFzcy5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbik7XG4gICAgdmFyIHNoYXBlcyA9IHRoaXMuc2hhcGVzLFxuICAgICAgICBqc29uU2hhcGVzID0ganNvbi5zaGFwZXMgfHwgKGpzb24uc2hhcGVzID0gW10pLFxuICAgICAgICBpID0gc2hhcGVzLmxlbmd0aDtcblxuICAgIGpzb24ucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uLnRvSlNPTihqc29uLnBvc2l0aW9uKTtcbiAgICBqc29uLnZlbG9jaXR5ID0gdGhpcy52ZWxvY2l0eS50b0pTT04oanNvbi52ZWxvY2l0eSk7XG4gICAganNvbi5mb3JjZSA9IHRoaXMuZm9yY2UudG9KU09OKGpzb24uZm9yY2UpO1xuXG4gICAganNvbi5yb3RhdGlvbiA9IHRoaXMucm90YXRpb247XG4gICAganNvbi5hbmd1bGFyVmVsb2NpdHkgPSB0aGlzLmFuZ3VsYXJWZWxvY2l0eTtcbiAgICBqc29uLnRvcnF1ZSA9IHRoaXMudG9ycXVlO1xuXG4gICAganNvbi5tb3Rpb25TdGF0ZSA9IHRoaXMubW90aW9uU3RhdGU7XG5cbiAgICBqc29uLmxpbmVhckRhbXBpbmcgPSB0aGlzLmxpbmVhckRhbXBpbmc7XG5cbiAgICBqc29uLm1hc3MgPSB0aGlzLm1hc3M7XG4gICAganNvbi5pbnZNYXNzID0gdGhpcy5pbnZNYXNzO1xuXG4gICAganNvbi5hbGxvd1NsZWVwID0gdGhpcy5hbGxvd1NsZWVwO1xuICAgIGpzb24uc2xlZXBTdGF0ZSA9IHRoaXMuc2xlZXBTdGF0ZTtcblxuICAgIGpzb24uYW5ndWxhckRhbXBpbmcgPSB0aGlzLmFuZ3VsYXJEYW1waW5nO1xuXG4gICAgd2hpbGUgKGktLSkganNvblNoYXBlc1tpXSA9IHNoYXBlc1tpXS50b0pTT04oanNvblNoYXBlc1tpXSk7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuUDJSaWdpZGJvZHkucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBDbGFzcy5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcbiAgICB2YXIganNvblNoYXBlcyA9IGpzb24uc2hhcGVzIHx8IChqc29uLnNoYXBlcyA9IFtdKSxcbiAgICAgICAgaSA9IGpzb25TaGFwZXMubGVuZ3RoO1xuXG4gICAgdGhpcy5wb3NpdGlvbi5mcm9tSlNPTihqc29uLnBvc2l0aW9uKTtcbiAgICB0aGlzLnZlbG9jaXR5LmZyb21KU09OKGpzb24udmVsb2NpdHkpO1xuICAgIHRoaXMuZm9yY2UuZnJvbUpTT04oanNvbi5mb3JjZSk7XG5cbiAgICB0aGlzLnJvdGF0aW9uID0ganNvbi5yb3RhdGlvbjtcbiAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IGpzb24uYW5ndWxhclZlbG9jaXR5O1xuICAgIHRoaXMudG9ycXVlID0ganNvbi50b3JxdWU7XG5cbiAgICB0aGlzLm1vdGlvblN0YXRlID0ganNvbi5tb3Rpb25TdGF0ZTtcblxuICAgIHRoaXMubGluZWFyRGFtcGluZyA9IGpzb24ubGluZWFyRGFtcGluZztcblxuICAgIHRoaXMubWFzcyA9IGpzb24ubWFzcztcbiAgICB0aGlzLmludk1hc3MgPSBqc29uLmludk1hc3M7XG5cbiAgICB0aGlzLmFsbG93U2xlZXAgPSBqc29uLmFsbG93U2xlZXA7XG4gICAgdGhpcy5zbGVlcFN0YXRlID0ganNvbi5zbGVlcFN0YXRlO1xuXG4gICAgdGhpcy5hbmd1bGFyRGFtcGluZyA9IGpzb24uYW5ndWxhckRhbXBpbmc7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLmFkZFNoYXBlKENsYXNzLmZyb21KU09OKGpzb25TaGFwZXNbaV0pKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFAyUmlnaWRib2R5O1xuIiwidmFyIENsYXNzID0gcmVxdWlyZShcIi4uLy4uL2Jhc2UvY2xhc3NcIik7XG52YXIgVmVjMiA9IHJlcXVpcmUoXCIuLi8uLi9tYXRoL3ZlYzJcIik7XG52YXIgUDJFbnVtcyA9IHJlcXVpcmUoXCIuLi9wMmVudW1zXCIpO1xudmFyIFAyU2hhcGUgPSByZXF1aXJlKFwiLi9wMnNoYXBlXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIFNoYXBlVHlwZSA9IFAyRW51bXMuU2hhcGVUeXBlLFxuXG4gICAgYWJzID0gTWF0aC5hYnMsXG4gICAgc3FydCA9IE1hdGguc3FydCxcbiAgICBQSSA9IE1hdGguUEk7XG5cblxuZnVuY3Rpb24gUDJTZWdtZW50KG9wdHMpIHtcbiAgICBvcHRzIHx8IChvcHRzID0ge30pO1xuXG4gICAgUDJTaGFwZS5jYWxsKHRoaXMsIG9wdHMpO1xuXG4gICAgdGhpcy50eXBlID0gU2hhcGVUeXBlLlNlZ21lbnQ7XG5cbiAgICB0aGlzLmEgPSBvcHRzLmEgIT0gdW5kZWZpbmVkID8gb3B0cy5hIDogbmV3IFZlYzIoLTAuNSwgMC4wKTtcbiAgICB0aGlzLmIgPSBvcHRzLmIgIT0gdW5kZWZpbmVkID8gb3B0cy5iIDogbmV3IFZlYzIoMC41LCAwLjApO1xuXG4gICAgdGhpcy5fYSA9IHRoaXMuYS5jbG9uZSgpO1xuICAgIHRoaXMuX2IgPSB0aGlzLmIuY2xvbmUoKTtcbiAgICB0aGlzLl9ub3JtYWwgPSBuZXcgVmVjMigpLnZzdWIodGhpcy5fYiwgdGhpcy5fYSkucGVycCgpLm5vcm1hbGl6ZSgpO1xuXG4gICAgdGhpcy5yYWRpdXMgPSBvcHRzLnJhZGl1cyAhPSB1bmRlZmluZWQgPyBhYnMob3B0cy5yYWRpdXMpIDogMC41O1xufVxuXG5QMlNoYXBlLmV4dGVuZChQMlNlZ21lbnQpO1xuXG5cblAyU2VnbWVudC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIFAyU2hhcGUucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLCBvdGhlcik7XG5cbiAgICB0aGlzLmEuY29weShvdGhlci5hKTtcbiAgICB0aGlzLmIuY29weShvdGhlci5iKTtcblxuICAgIHRoaXMucmFkaXVzID0gb3RoZXIucmFkaXVzO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblAyU2VnbWVudC5wcm90b3R5cGUucG9pbnRRdWVyeSA9IGZ1bmN0aW9uIChwKSB7XG4gICAgaWYgKCF0aGlzLmFhYmIuY29udGFpbnMocCkpIHJldHVybiBmYWxzZTtcbiAgICB2YXIgciA9IHRoaXMucmFkaXVzLFxuICAgICAgICBhID0gdGhpcy5fYSxcbiAgICAgICAgYiA9IHRoaXMuX2IsXG4gICAgICAgIG4gPSB0aGlzLl9ub3JtYWwsXG4gICAgICAgIGF4ID0gYS54LFxuICAgICAgICBheSA9IGEueSxcbiAgICAgICAgYnggPSBiLngsXG4gICAgICAgIGJ5ID0gYi55LFxuICAgICAgICBueCA9IG4ueCxcbiAgICAgICAgbnkgPSBuLnksXG4gICAgICAgIHB4ID0gcC54LFxuICAgICAgICBweSA9IHAueSxcblxuICAgICAgICBkbiA9IChueCAqIHB4ICsgbnkgKiBweSkgLSAoYXggKiBueCArIGF5ICogbnkpLFxuICAgICAgICBkaXN0ID0gYWJzKGRuKSxcbiAgICAgICAgZHQsIGR0YSwgZHRiLCBkeCwgZHk7XG5cbiAgICBpZiAoZGlzdCA+IHIpIHJldHVybiBmYWxzZTtcblxuICAgIGR0ID0gcHggKiBueSAtIHB5ICogbng7XG4gICAgZHRhID0gYXggKiBueSAtIGF5ICogbng7XG4gICAgZHRiID0gYnggKiBueSAtIGJ5ICogbng7XG5cbiAgICBpZiAoZHQgPD0gZHRhKSB7XG4gICAgICAgIGlmIChkdCA8IGR0YSAtIHIpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBkeCA9IHB4IC0gYXg7XG4gICAgICAgIGR5ID0gcHkgLSBheTtcblxuICAgICAgICByZXR1cm4gKGR4ICogZHggKyBkeSAqIGR5KSA8IChyICogcik7XG4gICAgfSBlbHNlIGlmIChkdCA+IGR0Yikge1xuICAgICAgICBpZiAoZHQgPiBkdGIgKyByKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgZHggPSBweCAtIGJ4O1xuICAgICAgICBkeSA9IHB5IC0gYnk7XG5cbiAgICAgICAgcmV0dXJuIChkeCAqIGR4ICsgZHkgKiBkeSkgPCAociAqIHIpO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xufTtcblxuXG5QMlNlZ21lbnQucHJvdG90eXBlLmNlbnRyb2lkID0gZnVuY3Rpb24gKHYpIHtcbiAgICB2YXIgbG9jYWxQb3NpdGlvbiA9IHRoaXMubG9jYWxQb3NpdGlvbixcbiAgICAgICAgYSA9IHRoaXMuYSxcbiAgICAgICAgYiA9IHRoaXMuYjtcblxuICAgIHYueCA9IGxvY2FsUG9zaXRpb24ueCArIChhLnggKyBiLngpICogMC41O1xuICAgIHYueSA9IGxvY2FsUG9zaXRpb24ueSArIChhLnkgKyBiLnkpICogMC41O1xuXG4gICAgcmV0dXJuIHY7XG59O1xuXG5cblAyU2VnbWVudC5wcm90b3R5cGUuYXJlYSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYSA9IHRoaXMuYSxcbiAgICAgICAgYiA9IHRoaXMuYixcbiAgICAgICAgciA9IHRoaXMucmFkaXVzLFxuICAgICAgICBhYnggPSBiLnggLSBhLngsXG4gICAgICAgIGFieSA9IGIueSAtIGEueSxcbiAgICAgICAgbCA9IGFieCAqIGFieCArIGFieSAqIGFieTtcblxuICAgIGwgPSBsID09PSAwLjAgPyAwLjAgOiBzcXJ0KGwpO1xuXG4gICAgcmV0dXJuIHIgKiAoUEkgKiByICsgMiAqIGwpO1xufTtcblxuXG52YXIgaW52MTIgPSAxLjAgLyAxMi4wO1xuUDJTZWdtZW50LnByb3RvdHlwZS5pbmVydGlhID0gZnVuY3Rpb24gKG1hc3MpIHtcbiAgICB2YXIgbG9jYWxQb3NpdGlvbiA9IHRoaXMubG9jYWxQb3NpdGlvbixcbiAgICAgICAgbHggPSBsb2NhbFBvc2l0aW9uLngsXG4gICAgICAgIGx5ID0gbG9jYWxQb3NpdGlvbi55LFxuICAgICAgICBhID0gdGhpcy5hLFxuICAgICAgICBiID0gdGhpcy5iLFxuICAgICAgICBheCA9IGx4ICsgYS54LFxuICAgICAgICBheSA9IGx5ICsgYS55LFxuICAgICAgICBieCA9IGx4ICsgYi54LFxuICAgICAgICBieSA9IGx5ICsgYi55LFxuICAgICAgICBhYnggPSBieCAtIGF4LFxuICAgICAgICBhYnkgPSBieSAtIGF5LFxuICAgICAgICBsc3EgPSBhYnggKiBhYnggKyBhYnkgKiBhYnksXG4gICAgICAgIHggPSAoYXggKyBieCkgKiAwLjUsXG4gICAgICAgIHkgPSAoYXkgKyBieSkgKiAwLjU7XG5cbiAgICByZXR1cm4gbWFzcyAqIChsc3EgKiBpbnYxMiArICh4ICogeCArIHkgKiB5KSk7XG59O1xuXG5cbnZhciBWRUMyX1NDQUxFID0gbmV3IFZlYzIoMS4wLCAxLjApO1xuUDJTZWdtZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAobWF0cml4KSB7XG4gICAgdmFyIGxvY2FsTWF0cml4ID0gdGhpcy5tYXRyaXgsXG4gICAgICAgIG1hdHJpeFdvcmxkID0gdGhpcy5tYXRyaXhXb3JsZCxcbiAgICAgICAgbG9jYWxQb3MgPSB0aGlzLmxvY2FsUG9zaXRpb24sXG4gICAgICAgIHBvcyA9IHRoaXMucG9zaXRpb24sXG4gICAgICAgIF9hID0gdGhpcy5fYSxcbiAgICAgICAgX2IgPSB0aGlzLl9iLFxuICAgICAgICBfbm9ybWFsID0gdGhpcy5fbm9ybWFsLFxuICAgICAgICBhID0gdGhpcy5hLFxuICAgICAgICBiID0gdGhpcy5iLFxuICAgICAgICByYWRpdXMgPSB0aGlzLnJhZGl1cyxcbiAgICAgICAgYWFiYiA9IHRoaXMuYWFiYixcbiAgICAgICAgbWluID0gYWFiYi5taW4sXG4gICAgICAgIG1heCA9IGFhYmIubWF4LFxuICAgICAgICBsLCByLCBiLCB0O1xuXG4gICAgbG9jYWxNYXRyaXguY29tcG9zZShsb2NhbFBvcywgVkVDMl9TQ0FMRSwgdGhpcy5sb2NhbFJvdGF0aW9uKTtcbiAgICBtYXRyaXhXb3JsZC5tbXVsKG1hdHJpeCwgbG9jYWxNYXRyaXgpO1xuXG4gICAgcG9zLnggPSBsb2NhbFBvcy54O1xuICAgIHBvcy55ID0gbG9jYWxQb3MueTtcbiAgICBwb3MudHJhbnNmb3JtTWF0MzIobWF0cml4KTtcblxuICAgIF9hLnggPSBhLng7XG4gICAgX2EueSA9IGEueTtcbiAgICBfYS50cmFuc2Zvcm1NYXQzMihtYXRyaXgpO1xuXG4gICAgX2IueCA9IGIueDtcbiAgICBfYi55ID0gYi55O1xuICAgIF9iLnRyYW5zZm9ybU1hdDMyKG1hdHJpeCk7XG5cbiAgICBfbm9ybWFsLnggPSAtKF9iLnkgLSBfYS55KTtcbiAgICBfbm9ybWFsLnkgPSBfYi54IC0gX2EueDtcbiAgICBfbm9ybWFsLm5vcm1hbGl6ZSgpO1xuXG4gICAgaWYgKF9hLnggPCBfYi54KSB7XG4gICAgICAgIGwgPSBfYS54O1xuICAgICAgICByID0gX2IueDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBsID0gX2IueDtcbiAgICAgICAgciA9IF9hLng7XG4gICAgfVxuXG4gICAgaWYgKF9hLnkgPCBfYi55KSB7XG4gICAgICAgIGIgPSBfYS55O1xuICAgICAgICB0ID0gX2IueTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBiID0gX2IueTtcbiAgICAgICAgdCA9IF9hLnk7XG4gICAgfVxuXG4gICAgbWluLnggPSBsIC0gcmFkaXVzO1xuICAgIG1pbi55ID0gYiAtIHJhZGl1cztcbiAgICBtYXgueCA9IHIgKyByYWRpdXM7XG4gICAgbWF4LnkgPSB0ICsgcmFkaXVzO1xufTtcblxuXG5QMlNlZ21lbnQucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAganNvbiA9IFAyU2hhcGUucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi5hID0gdGhpcy5hLnRvSlNPTihqc29uLmEpO1xuICAgIGpzb24uYiA9IHRoaXMuYi50b0pTT04oanNvbi5iKTtcblxuICAgIGpzb24ucmFkaXVzID0gdGhpcy5yYWRpdXM7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuUDJTZWdtZW50LnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgUDJTaGFwZS5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLCBqc29uKTtcblxuICAgIHRoaXMuYS5mcm9tSlNPTihqc29uLmEpO1xuICAgIHRoaXMuYi5mcm9tSlNPTihqc29uLmIpO1xuXG4gICAgdGhpcy5yYWRpdXMgPSBqc29uLnJhZGl1cztcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFAyU2VnbWVudDtcbiIsInZhciBDbGFzcyA9IHJlcXVpcmUoXCIuLi8uLi9iYXNlL2NsYXNzXCIpO1xudmFyIFZlYzIgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC92ZWMyXCIpO1xudmFyIE1hdDMyID0gcmVxdWlyZShcIi4uLy4uL21hdGgvbWF0MzJcIik7XG52YXIgQUFCQjIgPSByZXF1aXJlKFwiLi4vLi4vbWF0aC9hYWJiMlwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIFAyU2hhcGUob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBDbGFzcy5jYWxsKHRoaXMpO1xuXG4gICAgdGhpcy50eXBlID0gLTE7XG5cbiAgICB0aGlzLmJvZHkgPSB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLmRlbnNpdHkgPSBvcHRzLmRlbnNpdHkgIT0gdW5kZWZpbmVkID8gb3B0cy5kZW5zaXR5IDogMTtcblxuICAgIHRoaXMubG9jYWxQb3NpdGlvbiA9IG9wdHMucG9zaXRpb24gIT0gdW5kZWZpbmVkID8gb3B0cy5wb3NpdGlvbiA6IG5ldyBWZWMyO1xuICAgIHRoaXMubG9jYWxSb3RhdGlvbiA9IG9wdHMucm90YXRpb24gIT0gdW5kZWZpbmVkID8gb3B0cy5yb3RhdGlvbiA6IDA7XG5cbiAgICB0aGlzLnBvc2l0aW9uID0gbmV3IFZlYzI7XG4gICAgdGhpcy5yb3RhdGlvbiA9IDA7XG5cbiAgICB0aGlzLm1hdHJpeCA9IG5ldyBNYXQzMjtcbiAgICB0aGlzLm1hdHJpeFdvcmxkID0gbmV3IE1hdDMyO1xuXG4gICAgdGhpcy5mcmljdGlvbiA9IG9wdHMuZnJpY3Rpb24gIT0gdW5kZWZpbmVkID8gb3B0cy5mcmljdGlvbiA6IDAuNTtcbiAgICB0aGlzLmVsYXN0aWNpdHkgPSBvcHRzLmVsYXN0aWNpdHkgIT0gdW5kZWZpbmVkID8gb3B0cy5lbGFzdGljaXR5IDogMC4yNTtcblxuICAgIHRoaXMuaXNUcmlnZ2VyID0gb3B0cy5pc1RyaWdnZXIgIT0gdW5kZWZpbmVkID8gISFvcHRzLmlzVHJpZ2dlciA6IGZhbHNlO1xuXG4gICAgdGhpcy5maWx0ZXJNYXNrID0gb3B0cy5maWx0ZXJNYXNrICE9IHVuZGVmaW5lZCA/IG9wdHMuZmlsdGVyTWFzayA6IDE7XG4gICAgdGhpcy5maWx0ZXJHcm91cCA9IG9wdHMuZmlsdGVyR3JvdXAgIT0gdW5kZWZpbmVkID8gb3B0cy5maWx0ZXJHcm91cCA6IDE7XG5cbiAgICB0aGlzLmFhYmIgPSBuZXcgQUFCQjI7XG59XG5cbkNsYXNzLmV4dGVuZChQMlNoYXBlKTtcblxuXG5QMlNoYXBlLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cbiAgICB0aGlzLmRlbnNpdHkgPSBvdGhlci5kZW5zaXR5O1xuXG4gICAgdGhpcy5sb2NhbFBvc2l0aW9uLmNvcHkob3RoZXIubG9jYWxQb3NpdGlvbik7XG4gICAgdGhpcy5sb2NhbFJvdGF0aW9uID0gb3RoZXIubG9jYWxSb3RhdGlvbjtcblxuICAgIHRoaXMuZnJpY3Rpb24gPSBvdGhlci5mcmljdGlvbjtcbiAgICB0aGlzLmVsYXN0aWNpdHkgPSBvdGhlci5lbGFzdGljaXR5O1xuXG4gICAgdGhpcy5pc1RyaWdnZXIgPSBvdGhlci5pc1RyaWdnZXI7XG5cbiAgICB0aGlzLmZpbHRlck1hc2sgPSBvdGhlci5maWx0ZXJNYXNrO1xuICAgIHRoaXMuZmlsdGVyR3JvdXAgPSBvdGhlci5maWx0ZXJHcm91cDtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5QMlNoYXBlLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIGpzb24gPSBDbGFzcy5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICBqc29uLmRlbnNpdHkgPSB0aGlzLmRlbnNpdHk7XG5cbiAgICBqc29uLmxvY2FsUG9zaXRpb24gPSB0aGlzLmxvY2FsUG9zaXRpb24udG9KU09OKGpzb24ubG9jYWxQb3NpdGlvbik7XG4gICAganNvbi5sb2NhbFJvdGF0aW9uID0gdGhpcy5sb2NhbFJvdGF0aW9uO1xuXG4gICAganNvbi5mcmljdGlvbiA9IHRoaXMuZnJpY3Rpb247XG4gICAganNvbi5lbGFzdGljaXR5ID0gdGhpcy5lbGFzdGljaXR5O1xuXG4gICAganNvbi5pc1RyaWdnZXIgPSB0aGlzLmlzVHJpZ2dlcjtcblxuICAgIGpzb24uZmlsdGVyTWFzayA9IHRoaXMuZmlsdGVyTWFzaztcbiAgICBqc29uLmZpbHRlckdyb3VwID0gdGhpcy5maWx0ZXJHcm91cDtcblxuICAgIHJldHVybiBqc29uO1xufTtcblxuXG5QMlNoYXBlLnByb3RvdHlwZS5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgQ2xhc3MucHJvdG90eXBlLmZyb21KU09OLmNhbGwodGhpcywganNvbik7XG5cbiAgICB0aGlzLmRlbnNpdHkgPSBqc29uLmRlbnNpdHk7XG5cbiAgICB0aGlzLmxvY2FsUG9zaXRpb24uZnJvbUpTT04oanNvbi5sb2NhbFBvc2l0aW9uKTtcbiAgICB0aGlzLmxvY2FsUm90YXRpb24gPSBqc29uLmxvY2FsUm90YXRpb247XG5cbiAgICB0aGlzLmZyaWN0aW9uID0ganNvbi5mcmljdGlvbjtcbiAgICB0aGlzLmVsYXN0aWNpdHkgPSBqc29uLmVsYXN0aWNpdHk7XG5cbiAgICB0aGlzLmlzVHJpZ2dlciA9IGpzb24uaXNUcmlnZ2VyO1xuXG4gICAgdGhpcy5maWx0ZXJNYXNrID0ganNvbi5maWx0ZXJNYXNrO1xuICAgIHRoaXMuZmlsdGVyR3JvdXAgPSBqc29uLmZpbHRlckdyb3VwO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUDJTaGFwZTtcbiIsInZhciBFbnVtID0gcmVxdWlyZShcIi4uL2Jhc2UvZW51bVwiKTtcblwidXNlIHN0cmljdFwiO1xuXG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIEJvZHlUeXBlOiBuZXcgRW51bShcIlBhcnRpY2xlIFJpZ2lkQm9keVwiKSxcbiAgICBTaGFwZVR5cGU6IG5ldyBFbnVtKFwiQ29udmV4IENpcmNsZSBTZWdtZW50XCIpLFxuICAgIE1vdGlvblN0YXRlOiBuZXcgRW51bShcIkR5bmFtaWMgU3RhdGljIEtpbmVtYXRpY1wiKSxcbiAgICBTbGVlcFN0YXRlOiBuZXcgRW51bShcIkF3YWtlIFNsZWVweSBTbGVlcGluZ1wiKVxufTtcbiIsInZhciBNYXRoZiA9IHJlcXVpcmUoXCIuLi9tYXRoL21hdGhmXCIpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGNsYW1wID0gTWF0aGYuY2xhbXA7XG5cbi8qKlxuICogQGNsYXNzIFAyU29sdmVyXG4gKiBAYnJpZWYgV29ybGQgU29sdmVyXG4gKiBAcGFyYW0gT2JqZWN0IG9wdHMgc2V0cyBDbGFzcyBwcm9wZXJ0aWVzIGZyb20gcGFzc2VkIE9iamVjdFxuICovXG5mdW5jdGlvbiBQMlNvbHZlcihvcHRzKSB7XG4gICAgb3B0cyB8fCAob3B0cyA9IHt9KTtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBOdW1iZXIgaXRlcmF0aW9uc1xuICAgICAqIEBicmllZiBtYXggbnVtYmVyIG9mIGl0ZXJhdGlvbnNcbiAgICAgKiBAbWVtYmVyb2YgUDJTb2x2ZXJcbiAgICAgKi9cbiAgICB0aGlzLml0ZXJhdGlvbnMgPSBvcHRzLml0ZXJhdGlvbnMgIT0gdW5kZWZpbmVkID8gb3B0cy5pdGVyYXRpb25zIDogMTA7XG5cbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkgTnVtYmVyIHRvbGVyYW5jZVxuICAgICAqIEBtZW1iZXJvZiBQMlNvbHZlclxuICAgICAqL1xuICAgIHRoaXMudG9sZXJhbmNlID0gb3B0cy50b2xlcmFuY2UgIT0gdW5kZWZpbmVkID8gb3B0cy50b2xlcmFuY2UgOiAxZS02O1xufVxuXG4vKipcbiAqIEBtZXRob2Qgc29sdmVcbiAqIEBtZW1iZXJvZiBQMlNvbHZlclxuICogQGJyaWVmIHNvbHZlcyBhbGwgZXF1YXRpb25zXG4gKiBAcGFyYW0gTnVtYmVyIGhcbiAqIEBwYXJhbSBBcnJheSBlcXVhdGlvbnNcbiAqL1xuUDJTb2x2ZXIucHJvdG90eXBlLnNvbHZlID0gZnVuY3Rpb24gKGgsIGVxdWF0aW9ucykge1xuICAgIHZhciBudW0gPSBlcXVhdGlvbnMubGVuZ3RoLFxuICAgICAgICBlcSwgYmksIGJqLFxuICAgICAgICB2bGFtYmRhaSwgdmxhbWJkYWosIHZpLCB2aixcbiAgICAgICAgaXRlcmF0aW9ucyA9IHRoaXMuaXRlcmF0aW9ucyxcbiAgICAgICAgaXRlciA9IDAsXG4gICAgICAgIHRvbGVyYW5jZVNxID0gdGhpcy50b2xlcmFuY2UgKiB0aGlzLnRvbGVyYW5jZSxcbiAgICAgICAgR1dsYW1iZGEsIGxhbWJkYSwgZGVsdGFMYW1iZGEsIGRlbHRhTGFtYmRhVG90YWwsXG4gICAgICAgIGksIGo7XG5cbiAgICBpZiAobnVtID4gLTEpIHtcblxuICAgICAgICBpID0gbnVtO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBlcSA9IGVxdWF0aW9uc1tpXTtcblxuICAgICAgICAgICAgZXEudXBkYXRlQ29uc3RhbnRzKGgpO1xuICAgICAgICAgICAgZXEuaW5pdChoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGkgPSBpdGVyYXRpb25zO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG5cbiAgICAgICAgICAgIGl0ZXIrKztcbiAgICAgICAgICAgIGRlbHRhTGFtYmRhVG90YWwgPSAwO1xuXG4gICAgICAgICAgICBqID0gbnVtO1xuICAgICAgICAgICAgd2hpbGUgKGotLSkge1xuICAgICAgICAgICAgICAgIGVxID0gZXF1YXRpb25zW2pdO1xuXG4gICAgICAgICAgICAgICAgR1dsYW1iZGEgPSBlcS5jYWxjdWxhdGVHV2xhbWJkYSgpO1xuICAgICAgICAgICAgICAgIGxhbWJkYSA9IGVxLmxhbWJkYTtcbiAgICAgICAgICAgICAgICBkZWx0YUxhbWJkYSA9IGVxLmludkMgKiAoZXEuQiAtIEdXbGFtYmRhIC0gZXEuZXBzaWxvbiAqIGxhbWJkYSk7XG5cbiAgICAgICAgICAgICAgICBlcS5sYW1iZGEgPSBjbGFtcChsYW1iZGEgKyBkZWx0YUxhbWJkYSwgZXEubWluRm9yY2UsIGVxLm1heEZvcmNlKTtcbiAgICAgICAgICAgICAgICBkZWx0YUxhbWJkYSA9IGVxLmxhbWJkYSAtIGxhbWJkYTtcblxuICAgICAgICAgICAgICAgIGVxLmFkZFRvTGFtYmRhKGRlbHRhTGFtYmRhKTtcbiAgICAgICAgICAgICAgICBkZWx0YUxhbWJkYVRvdGFsICs9IGRlbHRhTGFtYmRhO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZGVsdGFMYW1iZGFUb3RhbCAqIGRlbHRhTGFtYmRhVG90YWwgPCB0b2xlcmFuY2VTcSkgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBpID0gbnVtO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBlcSA9IGVxdWF0aW9uc1tpXTtcblxuICAgICAgICAgICAgYmkgPSBlcS5iaTtcbiAgICAgICAgICAgIHZpID0gYmkudmVsb2NpdHk7XG4gICAgICAgICAgICB2bGFtYmRhaSA9IGJpLnZsYW1iZGE7XG4gICAgICAgICAgICBiaiA9IGVxLmJqO1xuICAgICAgICAgICAgdmogPSBiai52ZWxvY2l0eTtcbiAgICAgICAgICAgIHZsYW1iZGFqID0gYmoudmxhbWJkYTtcblxuICAgICAgICAgICAgdmkueCArPSB2bGFtYmRhaS54O1xuICAgICAgICAgICAgdmkueSArPSB2bGFtYmRhaS55O1xuXG4gICAgICAgICAgICB2ai54ICs9IHZsYW1iZGFqLng7XG4gICAgICAgICAgICB2ai55ICs9IHZsYW1iZGFqLnk7XG5cbiAgICAgICAgICAgIHZsYW1iZGFpLnggPSB2bGFtYmRhaS55ID0gdmxhbWJkYWoueCA9IHZsYW1iZGFqLnkgPSAwO1xuXG4gICAgICAgICAgICBpZiAoYmkud2xhbWJkYSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBiaS5hbmd1bGFyVmVsb2NpdHkgKz0gYmkud2xhbWJkYTtcbiAgICAgICAgICAgICAgICBiaS53bGFtYmRhID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiai53bGFtYmRhICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGJqLmFuZ3VsYXJWZWxvY2l0eSArPSBiai53bGFtYmRhO1xuICAgICAgICAgICAgICAgIGJqLndsYW1iZGEgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGl0ZXI7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUDJTb2x2ZXI7IiwidmFyIENsYXNzID0gcmVxdWlyZShcIi4uL2Jhc2UvY2xhc3NcIik7XG52YXIgVGltZSA9IHJlcXVpcmUoXCIuLi9iYXNlL3RpbWVcIik7XG52YXIgT2JqZWN0UG9vbCA9IHJlcXVpcmUoXCIuLi9iYXNlL29iamVjdF9wb29sXCIpO1xudmFyIFZlYzIgPSByZXF1aXJlKFwiLi4vbWF0aC92ZWMyXCIpO1xudmFyIFAyRW51bXMgPSByZXF1aXJlKFwiLi9wMmVudW1zXCIpO1xudmFyIFAyU29sdmVyID0gcmVxdWlyZShcIi4vcDJzb2x2ZXJcIik7XG52YXIgUDJCcm9hZHBoYXNlID0gcmVxdWlyZShcIi4vY29sbGlzaW9uL3AyYnJvYWRwaGFzZVwiKTtcbnZhciBQMk5lYXJwaGFzZSA9IHJlcXVpcmUoXCIuL2NvbGxpc2lvbi9wMm5lYXJwaGFzZVwiKTtcbnZhciBQMkZyaWN0aW9uID0gcmVxdWlyZShcIi4vY29uc3RyYWludHMvcDJmcmljdGlvblwiKTtcbnZhciBMb2cgPSByZXF1aXJlKFwiLi4vYmFzZS9sb2dcIik7XG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgbm93ID0gVGltZS5ub3csXG4gICAgTW90aW9uU3RhdGUgPSBQMkVudW1zLk1vdGlvblN0YXRlLFxuXG4gICAgRlJJQ1RJT05fUE9PTCA9IG5ldyBPYmplY3RQb29sKFAyRnJpY3Rpb24pO1xuXG5cbmZ1bmN0aW9uIFAyU3BhY2Uob3B0cykge1xuICAgIG9wdHMgfHwgKG9wdHMgPSB7fSk7XG5cbiAgICBDbGFzcy5jYWxsKHRoaXMsIG9wdHMpO1xuXG4gICAgdGhpcy51c2VHcmF2aXR5ID0gb3B0cy51c2VHcmF2aXR5ICE9IHVuZGVmaW5lZCA/ICEhb3B0cy51c2VHcmF2aXR5IDogdHJ1ZTtcbiAgICB0aGlzLmdyYXZpdHkgPSBvcHRzLmdyYXZpdHkgIT0gdW5kZWZpbmVkID8gb3B0cy5ncmF2aXR5IDogbmV3IFZlYzIoMC4wLCAtOS44MDEpO1xuXG4gICAgdGhpcy50aW1lID0gMC4wO1xuXG4gICAgdGhpcy5icm9hZHBoYXNlID0gbmV3IFAyU3BhY2UuRGVmYXVsdEJyb2FkUGhhc2Uob3B0cy5icm9hZHBoYXNlKTtcbiAgICB0aGlzLm5lYXJwaGFzZSA9IG5ldyBQMlNwYWNlLkRlZmF1bHROZWFyUGhhc2Uob3B0cy5uZWFycGhhc2UpO1xuXG4gICAgdGhpcy5zb2x2ZXIgPSBuZXcgUDJTcGFjZS5EZWZhdWx0U29sdmVyKG9wdHMuc29sdmVyKTtcblxuICAgIHRoaXMuYm9kaWVzID0gW107XG4gICAgdGhpcy5fYm9keUhhc2ggPSB7fTtcblxuICAgIHRoaXMuX3BhaXJzaSA9IFtdO1xuICAgIHRoaXMuX3BhaXJzaiA9IFtdO1xuXG4gICAgdGhpcy5jb250YWN0cyA9IFtdO1xuICAgIHRoaXMuZnJpY3Rpb25zID0gW107XG4gICAgdGhpcy5jb25zdHJhaW50cyA9IFtdO1xuXG4gICAgdGhpcy5fY29sbGlzaW9uTWF0cml4ID0gW107XG4gICAgdGhpcy5fY29sbGlzaW9uTWF0cml4UHJldmlvdXMgPSBbXTtcblxuICAgIHRoaXMuc3RhdHMgPSB7XG4gICAgICAgIHN0ZXA6IDAuMCxcbiAgICAgICAgc29sdmU6IDAuMCxcbiAgICAgICAgaW50ZWdyYXRlOiAwLjAsXG4gICAgICAgIG5lYXJwaGFzZTogMC4wLFxuICAgICAgICBicm9hZHBoYXNlOiAwLjBcbiAgICB9O1xufVxuXG5DbGFzcy5leHRlbmQoUDJTcGFjZSk7XG5cblxuUDJTcGFjZS5EZWZhdWx0QnJvYWRQaGFzZSA9IFAyQnJvYWRwaGFzZTtcblAyU3BhY2UuRGVmYXVsdE5lYXJQaGFzZSA9IFAyTmVhcnBoYXNlO1xuUDJTcGFjZS5EZWZhdWx0U29sdmVyID0gUDJTb2x2ZXI7XG5QMlNwYWNlLkZSSUNUSU9OX1BPT0wgPSBGUklDVElPTl9QT09MO1xuXG5cblAyU3BhY2UucHJvdG90eXBlLmNvbGxpc2lvbk1hdHJpeEdldCA9IGZ1bmN0aW9uIChpLCBqLCBjdXJyZW50KSB7XG4gICAgdmFyIHRtcCA9IGo7XG5cbiAgICBpZiAoaiA+IGkpIHtcbiAgICAgICAgaiA9IGk7XG4gICAgICAgIGkgPSB0bXA7XG4gICAgfVxuICAgIGkgPSAoaSAqIChpICsgMSkgPj4gMSkgKyBqIC0gMTtcblxuICAgIHJldHVybiAoY3VycmVudCA9PT0gdW5kZWZpbmVkIHx8IGN1cnJlbnQpID8gdGhpcy5fY29sbGlzaW9uTWF0cml4W2ldIDogdGhpcy5fY29sbGlzaW9uTWF0cml4UHJldmlvdXNbaV07XG59O1xuXG5cblAyU3BhY2UucHJvdG90eXBlLmNvbGxpc2lvbk1hdHJpeFNldCA9IGZ1bmN0aW9uIChpLCBqLCB2YWx1ZSwgY3VycmVudCkge1xuICAgIHZhciB0bXAgPSBqO1xuXG4gICAgaWYgKGogPiBpKSB7XG4gICAgICAgIGogPSBpO1xuICAgICAgICBpID0gdG1wO1xuICAgIH1cblxuICAgIGkgPSAoaSAqIChpICsgMSkgPj4gMSkgKyBqIC0gMTtcblxuICAgIGlmIChjdXJyZW50ID09IHVuZGVmaW5lZCB8fCBjdXJyZW50KSB7XG4gICAgICAgIHRoaXMuX2NvbGxpc2lvbk1hdHJpeFtpXSA9IHZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2NvbGxpc2lvbk1hdHJpeFByZXZpb3VzW2ldID0gdmFsdWU7XG4gICAgfVxufTtcblxuXG5QMlNwYWNlLnByb3RvdHlwZS5jb2xsaXNpb25NYXRyaXhUaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBjb2xsaXNpb25NYXRyaXggPSB0aGlzLl9jb2xsaXNpb25NYXRyaXhQcmV2aW91cyxcbiAgICAgICAgaTtcblxuICAgIHRoaXMuX2NvbGxpc2lvbk1hdHJpeFByZXZpb3VzID0gdGhpcy5fY29sbGlzaW9uTWF0cml4O1xuICAgIHRoaXMuX2NvbGxpc2lvbk1hdHJpeCA9IGNvbGxpc2lvbk1hdHJpeDtcblxuICAgIGkgPSBjb2xsaXNpb25NYXRyaXgubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIGNvbGxpc2lvbk1hdHJpeFtpXSA9IDA7XG59O1xuXG5cblAyU3BhY2UucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBib2RpZXMgPSB0aGlzLmJvZGllcyxcbiAgICAgICAgaSA9IGJvZGllcy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLnJlbW92ZUJvZHkoYm9kaWVzW2ldKTtcblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5QMlNwYWNlLnByb3RvdHlwZS5hZGRCb2R5ID0gZnVuY3Rpb24gKGJvZHkpIHtcbiAgICB2YXIgYm9kaWVzID0gdGhpcy5ib2RpZXMsXG4gICAgICAgIGluZGV4ID0gYm9kaWVzLmluZGV4T2YoYm9keSk7XG5cbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIGJvZGllcy5wdXNoKGJvZHkpO1xuICAgICAgICB0aGlzLl9ib2R5SGFzaFtib2R5Ll9pZF0gPSBib2R5O1xuXG4gICAgICAgIGJvZHkuc3BhY2UgPSB0aGlzO1xuICAgICAgICBib2R5Ll9pbmRleCA9IGJvZGllcy5sZW5ndGggLSAxO1xuXG4gICAgICAgIGJvZHkuaW5pdCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIlAyU3BhY2UuYWRkQm9keTogQm9keSBhbHJlYWR5IG1lbWJlciBvZiBQMlNwYWNlXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5QMlNwYWNlLnByb3RvdHlwZS5hZGRCb2RpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGkgPSBhcmd1bWVudHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkgdGhpcy5hZGRCb2R5KGFyZ3VtZW50c1tpXSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblAyU3BhY2UucHJvdG90eXBlLnJlbW92ZUJvZHkgPSBmdW5jdGlvbiAoYm9keSkge1xuICAgIHZhciBib2RpZXMgPSB0aGlzLmJvZGllcyxcbiAgICAgICAgaW5kZXggPSBib2RpZXMuaW5kZXhPZihib2R5KTtcblxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgYm9keS5zcGFjZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgYm9keS5faW5kZXggPSAtMTtcblxuICAgICAgICBib2RpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5fYm9keUhhc2hbYm9keS5faWRdID0gdW5kZWZpbmVkO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIlAyU3BhY2UuYWRkQm9keTogQm9keSBub3QgbWVtYmVyIG9mIFAyU3BhY2VcIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cblAyU3BhY2UucHJvdG90eXBlLnJlbW92ZUJvZGllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB0aGlzLnJlbW92ZUJvZHkoYXJndW1lbnRzW2ldKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cblxuUDJTcGFjZS5wcm90b3R5cGUuYWRkQ29uc3RyYWludCA9IGZ1bmN0aW9uIChjb25zdHJhaW50KSB7XG4gICAgdmFyIGNvbnN0cmFpbnRzID0gdGhpcy5jb25zdHJhaW50cyxcbiAgICAgICAgaW5kZXggPSBjb25zdHJhaW50cy5pbmRleE9mKGNvbnN0cmFpbnQpO1xuXG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICBjb25zdHJhaW50cy5wdXNoKGNvbnN0cmFpbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIExvZy5lcnJvcihcIlAyU3BhY2UuYWRkQ29uc3RyYWludDogQ29uc3RyYWludCBhbHJlYWR5IG1lbWJlciBvZiBQMlNwYWNlXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5QMlNwYWNlLnByb3RvdHlwZS5yZW1vdmVDb25zdHJhaW50ID0gZnVuY3Rpb24gKGNvbnN0cmFpbnQpIHtcbiAgICB2YXIgY29uc3RyYWludHMgPSB0aGlzLmNvbnN0cmFpbnRzLFxuICAgICAgICBpbmRleCA9IGNvbnN0cmFpbnRzLmluZGV4T2YoY29uc3RyYWludCk7XG5cbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgIGNvbnN0cmFpbnRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgTG9nLmVycm9yKFwiUDJTcGFjZS5yZW1vdmVDb25zdHJhaW50OiBDb25zdHJhaW50IG5vdCBhIG1lbWJlciBvZiBQMlNwYWNlXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufTtcblxuXG5QMlNwYWNlLnByb3RvdHlwZS5maW5kQm9keUJ5UG9pbnQgPSBmdW5jdGlvbiAocCkge1xuICAgIHZhciBib2RpZXMgPSB0aGlzLmJvZGllcyxcbiAgICAgICAgYm9keSwgc2hhcGVzLCBzaGFwZSxcbiAgICAgICAgaSA9IGJvZGllcy5sZW5ndGgsXG4gICAgICAgIGo7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGJvZHkgPSBib2RpZXNbaV07XG4gICAgICAgIGlmICghYm9keSkgY29udGludWU7XG5cbiAgICAgICAgc2hhcGVzID0gYm9keS5zaGFwZXM7XG4gICAgICAgIGogPSBzaGFwZXMubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoai0tKSB7XG4gICAgICAgICAgICBzaGFwZSA9IHNoYXBlc1tqXTtcbiAgICAgICAgICAgIGlmICghc2hhcGUpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICBpZiAoc2hhcGUucG9pbnRRdWVyeShwKSkgcmV0dXJuIGJvZHk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuXG5QMlNwYWNlLnByb3RvdHlwZS5maW5kQm9keUJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcblxuICAgIHJldHVybiB0aGlzLl9ib2R5SGFzaFtpZF07XG59O1xuXG5cblAyU3BhY2UucHJvdG90eXBlLnN0ZXAgPSBmdW5jdGlvbiAoZHQpIHtcbiAgICB2YXIgc3RlcFN0YXJ0ID0gbm93KCksXG4gICAgICAgIHN0YXRzID0gdGhpcy5zdGF0cyxcbiAgICAgICAgZyA9IHRoaXMuZ3Jhdml0eSxcbiAgICAgICAgZ3ggPSBnLngsXG4gICAgICAgIGd5ID0gZy55LFxuICAgICAgICBib2RpZXMgPSB0aGlzLmJvZGllcyxcbiAgICAgICAgbnVtQm9kaWVzID0gYm9kaWVzLmxlbmd0aCxcbiAgICAgICAgc29sdmVyID0gdGhpcy5zb2x2ZXIsXG4gICAgICAgIGNvbnN0cmFpbnRzID0gdGhpcy5jb25zdHJhaW50cyxcbiAgICAgICAgcGFpcnNpID0gdGhpcy5fcGFpcnNpLFxuICAgICAgICBwYWlyc2ogPSB0aGlzLl9wYWlyc2osXG4gICAgICAgIGNvbnRhY3RzID0gdGhpcy5jb250YWN0cyxcbiAgICAgICAgZnJpY3Rpb25zID0gdGhpcy5mcmljdGlvbnMsXG4gICAgICAgIGNvbnN0cmFpbnQsIHRpbWUsIHN0YXJ0LCBib2R5LCBmb3JjZSwgbWFzcyxcbiAgICAgICAgYmksIGJqLCBjLCBjcCwgY24sIHUsIHNsaXBGb3JjZSwgZmMsIGZjcCwgZmN0LFxuICAgICAgICBpO1xuXG4gICAgdGltZSA9IHRoaXMudGltZSArPSBkdDtcblxuICAgIGlmICh0aGlzLnVzZUdyYXZpdHkpIHtcbiAgICAgICAgaSA9IG51bUJvZGllcztcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgYm9keSA9IGJvZGllc1tpXTtcblxuICAgICAgICAgICAgaWYgKGJvZHkubW90aW9uU3RhdGUgPT09IE1vdGlvblN0YXRlLkR5bmFtaWMpIHtcbiAgICAgICAgICAgICAgICBmb3JjZSA9IGJvZHkuZm9yY2U7XG4gICAgICAgICAgICAgICAgbWFzcyA9IGJvZHkubWFzcztcblxuICAgICAgICAgICAgICAgIGZvcmNlLnggKz0gZ3ggKiBtYXNzO1xuICAgICAgICAgICAgICAgIGZvcmNlLnkgKz0gZ3kgKiBtYXNzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5jb2xsaXNpb25NYXRyaXhUaWNrKCk7XG5cbiAgICBzdGFydCA9IG5vdygpO1xuICAgIHRoaXMuYnJvYWRwaGFzZS5jb2xsaXNpb25zKGJvZGllcywgcGFpcnNpLCBwYWlyc2opO1xuICAgIHN0YXRzLmJyb2FkcGhhc2UgPSBub3coKSAtIHN0YXJ0O1xuXG4gICAgc3RhcnQgPSBub3coKTtcbiAgICB0aGlzLm5lYXJwaGFzZS5jb2xsaXNpb25zKHBhaXJzaSwgcGFpcnNqLCBjb250YWN0cyk7XG4gICAgc3RhdHMubmVhcnBoYXNlID0gbm93KCkgLSBzdGFydDtcblxuICAgIHN0YXJ0ID0gbm93KCk7XG4gICAgc29sdmVyLnNvbHZlKGR0LCBjb250YWN0cyk7XG5cbiAgICBGUklDVElPTl9QT09MLmNsZWFyKCk7XG4gICAgZnJpY3Rpb25zLmxlbmd0aCA9IDA7XG5cbiAgICBpID0gY29udGFjdHMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgYyA9IGNvbnRhY3RzW2ldO1xuXG4gICAgICAgIGlmIChjLnUgPiAwLjApIHtcbiAgICAgICAgICAgIGJpID0gYy5iaTtcbiAgICAgICAgICAgIGJqID0gYy5iajtcbiAgICAgICAgICAgIGZjID0gRlJJQ1RJT05fUE9PTC5jcmVhdGUoKTtcbiAgICAgICAgICAgIHUgPSBjLnU7XG5cbiAgICAgICAgICAgIHNsaXBGb3JjZSA9IHUgKiBjLmxhbWJkYTtcbiAgICAgICAgICAgIGZjLm1pbkZvcmNlID0gLXNsaXBGb3JjZTtcbiAgICAgICAgICAgIGZjLm1heEZvcmNlID0gc2xpcEZvcmNlO1xuXG4gICAgICAgICAgICBmYy5iaSA9IGJpO1xuICAgICAgICAgICAgZmMuYmogPSBiajtcblxuICAgICAgICAgICAgY3AgPSBjLnA7XG4gICAgICAgICAgICBmY3AgPSBmYy5wO1xuXG4gICAgICAgICAgICBmY3AueCA9IGNwLng7XG4gICAgICAgICAgICBmY3AueSA9IGNwLnk7XG5cbiAgICAgICAgICAgIGNuID0gYy5uO1xuICAgICAgICAgICAgZmN0ID0gZmMudDtcblxuICAgICAgICAgICAgZmN0LnggPSAtY24ueTtcbiAgICAgICAgICAgIGZjdC55ID0gY24ueDtcblxuICAgICAgICAgICAgZnJpY3Rpb25zLnB1c2goZmMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc29sdmVyLnNvbHZlKGR0LCBmcmljdGlvbnMpO1xuXG4gICAgaSA9IGNvbnN0cmFpbnRzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbnN0cmFpbnQgPSBjb25zdHJhaW50c1tpXTtcbiAgICAgICAgY29uc3RyYWludC51cGRhdGUoKTtcbiAgICAgICAgc29sdmVyLnNvbHZlKGR0LCBjb25zdHJhaW50LmVxdWF0aW9ucyk7XG4gICAgfVxuICAgIHN0YXRzLnNvbHZlID0gbm93KCkgLSBzdGFydDtcblxuICAgIHN0YXJ0ID0gbm93KCk7XG4gICAgaSA9IG51bUJvZGllcztcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGJvZHkgPSBib2RpZXNbaV07XG4gICAgICAgIGlmICghYm9keSkgY29udGludWU7XG5cbiAgICAgICAgYm9keS51cGRhdGUoZHQpO1xuICAgICAgICBib2R5LnNsZWVwVGljayh0aW1lKTtcbiAgICB9XG4gICAgc3RhdHMuaW50ZWdyYXRlID0gbm93KCkgLSBzdGFydDtcblxuICAgIHN0YXRzLnN0ZXAgPSBub3coKSAtIHN0ZXBTdGFydDtcbn07XG5cblxuUDJTcGFjZS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICBqc29uID0gQ2xhc3MucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAganNvbi51c2VHcmF2aXR5ID0gdGhpcy51c2VHcmF2aXR5O1xuICAgIGpzb24uZ3Jhdml0eSA9IHRoaXMuZ3Jhdml0eS50b0pTT04oanNvbi5ncmF2aXR5KTtcbiAgICBqc29uLmJyb2FkcGhhc2UgPSB0aGlzLmJyb2FkcGhhc2UudG9KU09OKGpzb24uYnJvYWRwaGFzZSk7XG5cbiAgICByZXR1cm4ganNvbjtcbn07XG5cblxuUDJTcGFjZS5wcm90b3R5cGUuZnJvbUpTT04gPSBmdW5jdGlvbiAoanNvbikge1xuICAgIENsYXNzLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsIGpzb24pO1xuXG4gICAgdGhpcy51c2VHcmF2aXR5ID0ganNvbi51c2VHcmF2aXR5O1xuICAgIHRoaXMuZ3Jhdml0eS5mcm9tSlNPTihqc29uLmdyYXZpdHkpO1xuICAgIHRoaXMuYnJvYWRwaGFzZS5mcm9tSlNPTihqc29uLmJyb2FkcGhhc2UpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUDJTcGFjZTtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG5cbmZ1bmN0aW9uIFBoeXMyRCgpIHtcblxuICAgIHRoaXMuUDJCcm9hZHBoYXNlID0gcmVxdWlyZShcIi4vY29sbGlzaW9uL3AyYnJvYWRwaGFzZVwiKTtcbiAgICB0aGlzLlAyQnJvYWRwaGFzZVNwYXRpYWxIYXNoID0gcmVxdWlyZShcIi4vY29sbGlzaW9uL3AyYnJvYWRwaGFzZV9zcGF0aWFsaGFzaFwiKTtcbiAgICB0aGlzLlAyTmVhcnBoYXNlID0gcmVxdWlyZShcIi4vY29sbGlzaW9uL3AybmVhcnBoYXNlXCIpO1xuXG4gICAgdGhpcy5QMkNpcmNsZSA9IHJlcXVpcmUoXCIuL29iamVjdHMvcDJjaXJjbGVcIik7XG4gICAgdGhpcy5QMkNvbnZleCA9IHJlcXVpcmUoXCIuL29iamVjdHMvcDJjb252ZXhcIik7XG4gICAgdGhpcy5QMlJlY3QgPSByZXF1aXJlKFwiLi9vYmplY3RzL3AycmVjdFwiKTtcbiAgICB0aGlzLlAyUmlnaWRib2R5ID0gcmVxdWlyZShcIi4vb2JqZWN0cy9wMnJpZ2lkYm9keVwiKTtcbiAgICB0aGlzLlAyU2VnbWVudCA9IHJlcXVpcmUoXCIuL29iamVjdHMvcDJzZWdtZW50XCIpO1xuICAgIHRoaXMuUDJTaGFwZSA9IHJlcXVpcmUoXCIuL29iamVjdHMvcDJzaGFwZVwiKTtcblxuICAgIHRoaXMuUDJDb25zdHJhaW50ID0gcmVxdWlyZShcIi4vY29uc3RyYWludHMvcDJjb25zdHJhaW50XCIpO1xuICAgIHRoaXMuUDJEaXN0YW5jZUNvbnN0cmFpbnQgPSByZXF1aXJlKFwiLi9jb25zdHJhaW50cy9wMmRpc3RhbmNlX2NvbnN0cmFpbnRcIik7XG5cbiAgICB0aGlzLlAyRW51bXMgPSByZXF1aXJlKFwiLi9wMmVudW1zXCIpO1xuICAgIHRoaXMuUDJTcGFjZSA9IHJlcXVpcmUoXCIuL3Ayc3BhY2VcIik7XG59XG5cblxubW9kdWxlLmV4cG9ydHMgPSBuZXcgUGh5czJEO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIERldmljZSA9IHJlcXVpcmUoXCIuL2Jhc2UvZGV2aWNlXCIpLFxuICAgIFRpbWUgPSByZXF1aXJlKFwiLi9iYXNlL3RpbWVcIiksXG4gICAgbm93ID0gVGltZS5ub3csXG5cbiAgICBJU19TRVJWRVIgPSAhKHR5cGVvZih3aW5kb3cpICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdy5kb2N1bWVudCksXG4gICAgSVNfQ0xJRU5UID0gIUlTX1NFUlZFUixcblxuICAgIGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuXG5cbmlmIChEZXZpY2UubW9iaWxlKSB7XG4gICAgd2luZG93Lm9uZXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSwgcGFnZSwgbGluZSkge1xuICAgICAgICBhbGVydChcImxpbmU6IFwiICsgbGluZSArIFwiLCBwYWdlOiBcIiArIHBhZ2UgKyBcIlxcbm1lc3NhZ2U6IFwiICsgbWVzc2FnZSk7XG4gICAgfTtcbn1cblxuXG4vKipcbiAqIEhvbGRzIGFsbCBhY2Nlc3NpYmxlIENsYXNzZXNcbiAqIEBjbGFzcyBYaWFuXG4gKi9cbmZ1bmN0aW9uIFhpYW4oKSB7XG5cbiAgICB0aGlzLlBoeXMyRCA9IHJlcXVpcmUoXCIuL3BoeXMyZC9waHlzMmRcIik7XG5cbiAgICB0aGlzLkF1ZGlvQ3R4ID0gcmVxdWlyZShcIi4vYmFzZS9hdWRpb19jdHhcIik7XG4gICAgdGhpcy5DbGFzcyA9IHJlcXVpcmUoXCIuL2Jhc2UvY2xhc3NcIik7XG4gICAgdGhpcy5EZXZpY2UgPSByZXF1aXJlKFwiLi9iYXNlL2RldmljZVwiKTtcbiAgICB0aGlzLkRvbSA9IHJlcXVpcmUoXCIuL2Jhc2UvZG9tXCIpO1xuICAgIHRoaXMuRW51bSA9IHJlcXVpcmUoXCIuL2Jhc2UvZW51bVwiKTtcbiAgICB0aGlzLkV2ZW50RW1pdHRlciA9IHJlcXVpcmUoXCIuL2Jhc2UvZXZlbnRfZW1pdHRlclwiKTtcbiAgICB0aGlzLk9iamVjdFBvb2wgPSByZXF1aXJlKFwiLi9iYXNlL29iamVjdF9wb29sXCIpO1xuICAgIHRoaXMucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gcmVxdWlyZShcIi4vYmFzZS9yZXF1ZXN0X2FuaW1hdGlvbl9mcmFtZVwiKTtcbiAgICB0aGlzLmlvID0gcmVxdWlyZShcIi4vYmFzZS9zb2NrZXQuaW9cIik7XG4gICAgdGhpcy5UaW1lID0gcmVxdWlyZShcIi4vYmFzZS90aW1lXCIpO1xuICAgIHRoaXMudXRpbCA9IHJlcXVpcmUoXCIuL2Jhc2UvdXRpbFwiKTtcbiAgICAvL1xuICAgIHRoaXMuU2hhZGVyID0gcmVxdWlyZShcIi4vY29yZS9hc3NldHMvc2hhZGVycy9zaGFkZXJcIik7XG4gICAgdGhpcy5TaGFkZXJMaWIgPSByZXF1aXJlKFwiLi9jb3JlL2Fzc2V0cy9zaGFkZXJzL3NoYWRlcl9saWJcIik7XG4gICAgdGhpcy5Bc3NldCA9IHJlcXVpcmUoXCIuL2NvcmUvYXNzZXRzL2Fzc2V0XCIpO1xuICAgIHRoaXMuQXNzZXRMb2FkZXIgPSByZXF1aXJlKFwiLi9jb3JlL2Fzc2V0cy9hc3NldF9sb2FkZXJcIik7XG4gICAgdGhpcy5Bc3NldHMgPSByZXF1aXJlKFwiLi9jb3JlL2Fzc2V0cy9hc3NldHNcIik7XG4gICAgdGhpcy5BdWRpb0NsaXAgPSByZXF1aXJlKFwiLi9jb3JlL2Fzc2V0cy9hdWRpb19jbGlwXCIpO1xuICAgIHRoaXMuTWF0ZXJpYWwgPSByZXF1aXJlKFwiLi9jb3JlL2Fzc2V0cy9tYXRlcmlhbFwiKTtcbiAgICB0aGlzLk1lc2ggPSByZXF1aXJlKFwiLi9jb3JlL2Fzc2V0cy9tZXNoXCIpO1xuICAgIHRoaXMuU3ByaXRlU2hlZXQgPSByZXF1aXJlKFwiLi9jb3JlL2Fzc2V0cy9zcHJpdGVfc2hlZXRcIik7XG4gICAgdGhpcy5UZXh0dXJlID0gcmVxdWlyZShcIi4vY29yZS9hc3NldHMvdGV4dHVyZVwiKTtcbiAgICB0aGlzLlRleHR1cmVDdWJlID0gcmVxdWlyZShcIi4vY29yZS9hc3NldHMvdGV4dHVyZV9jdWJlXCIpO1xuICAgIC8vXG4gICAgdGhpcy5Cb25lQ29tcG9uZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL2NvcmUvY29tcG9uZW50X21hbmFnZXJzL2JvbmVfY29tcG9uZW50X21hbmFnZXJcIik7XG4gICAgdGhpcy5DYW1lcmEyRENvbXBvbmVudE1hbmFnZXIgPSByZXF1aXJlKFwiLi9jb3JlL2NvbXBvbmVudF9tYW5hZ2Vycy9jYW1lcmFfMmRfY29tcG9uZW50X21hbmFnZXJcIik7XG4gICAgdGhpcy5DYW1lcmFDb21wb25lbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vY29yZS9jb21wb25lbnRfbWFuYWdlcnMvY2FtZXJhX2NvbXBvbmVudF9tYW5hZ2VyXCIpO1xuICAgIHRoaXMuQ29tcG9uZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL2NvcmUvY29tcG9uZW50X21hbmFnZXJzL2NvbXBvbmVudF9tYW5hZ2VyXCIpO1xuICAgIHRoaXMuTGlnaHRDb21wb25lbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vY29yZS9jb21wb25lbnRfbWFuYWdlcnMvbGlnaHRfY29tcG9uZW50X21hbmFnZXJcIik7XG4gICAgdGhpcy5NZXNoQW5pbWF0aW9uQ29tcG9uZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL2NvcmUvY29tcG9uZW50X21hbmFnZXJzL21lc2hfYW5pbWF0aW9uX2NvbXBvbmVudF9tYW5hZ2VyXCIpO1xuICAgIHRoaXMuTWVzaEZpbHRlckNvbXBvbmVudE1hbmFnZXIgPSByZXF1aXJlKFwiLi9jb3JlL2NvbXBvbmVudF9tYW5hZ2Vycy9tZXNoX2ZpbHRlcl9jb21wb25lbnRfbWFuYWdlclwiKTtcbiAgICB0aGlzLlNwcml0ZUNvbXBvbmVudE1hbmFnZXIgPSByZXF1aXJlKFwiLi9jb3JlL2NvbXBvbmVudF9tYW5hZ2Vycy9zcHJpdGVfY29tcG9uZW50X21hbmFnZXJcIik7XG4gICAgdGhpcy5UcmFuc2Zvcm0yRENvbXBvbmVudE1hbmFnZXIgPSByZXF1aXJlKFwiLi9jb3JlL2NvbXBvbmVudF9tYW5hZ2Vycy90cmFuc2Zvcm1fMmRfY29tcG9uZW50X21hbmFnZXJcIik7XG4gICAgdGhpcy5UcmFuc2Zvcm1Db21wb25lbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vY29yZS9jb21wb25lbnRfbWFuYWdlcnMvdHJhbnNmb3JtX2NvbXBvbmVudF9tYW5hZ2VyXCIpO1xuXG4gICAgdGhpcy5QYXJ0aWNsZVN5c3RlbSA9IHJlcXVpcmUoXCIuL2NvcmUvY29tcG9uZW50cy9wYXJ0aWNsZV9zeXN0ZW0vcGFydGljbGVfc3lzdGVtXCIpO1xuICAgIHRoaXMuQXVkaW9Tb3VyY2UgPSByZXF1aXJlKFwiLi9jb3JlL2NvbXBvbmVudHMvYXVkaW9fc291cmNlXCIpO1xuICAgIHRoaXMuQ2FtZXJhID0gcmVxdWlyZShcIi4vY29yZS9jb21wb25lbnRzL2NhbWVyYVwiKTtcbiAgICB0aGlzLkNhbWVyYTJEID0gcmVxdWlyZShcIi4vY29yZS9jb21wb25lbnRzL2NhbWVyYV8yZFwiKTtcbiAgICB0aGlzLkNvbXBvbmVudCA9IHJlcXVpcmUoXCIuL2NvcmUvY29tcG9uZW50cy9jb21wb25lbnRcIik7XG4gICAgdGhpcy5HVUlUZXh0ID0gcmVxdWlyZShcIi4vY29yZS9jb21wb25lbnRzL2d1aV90ZXh0XCIpO1xuICAgIHRoaXMuR1VJVGV4dHVyZSA9IHJlcXVpcmUoXCIuL2NvcmUvY29tcG9uZW50cy9ndWlfdGV4dHVyZVwiKTtcbiAgICB0aGlzLkxpZ2h0ID0gcmVxdWlyZShcIi4vY29yZS9jb21wb25lbnRzL2xpZ2h0XCIpO1xuICAgIHRoaXMuTWVzaEFuaW1hdGlvbiA9IHJlcXVpcmUoXCIuL2NvcmUvY29tcG9uZW50cy9tZXNoX2FuaW1hdGlvblwiKTtcbiAgICB0aGlzLk1lc2hGaWx0ZXIgPSByZXF1aXJlKFwiLi9jb3JlL2NvbXBvbmVudHMvbWVzaF9maWx0ZXJcIik7XG4gICAgdGhpcy5PcmJpdENvbnRyb2wgPSByZXF1aXJlKFwiLi9jb3JlL2NvbXBvbmVudHMvb3JiaXRfY29udHJvbFwiKTtcbiAgICB0aGlzLlJpZ2lkQm9keTJEID0gcmVxdWlyZShcIi4vY29yZS9jb21wb25lbnRzL3JpZ2lkX2JvZHlfMmRcIik7XG4gICAgdGhpcy5TcHJpdGUgPSByZXF1aXJlKFwiLi9jb3JlL2NvbXBvbmVudHMvc3ByaXRlXCIpO1xuICAgIHRoaXMuU3ByaXRlQW5pbWF0aW9uID0gcmVxdWlyZShcIi4vY29yZS9jb21wb25lbnRzL3Nwcml0ZV9hbmltYXRpb25cIik7XG4gICAgdGhpcy5UcmFuc2Zvcm0gPSByZXF1aXJlKFwiLi9jb3JlL2NvbXBvbmVudHMvdHJhbnNmb3JtXCIpO1xuICAgIHRoaXMuVHJhbnNmb3JtMkQgPSByZXF1aXJlKFwiLi9jb3JlL2NvbXBvbmVudHMvdHJhbnNmb3JtXzJkXCIpO1xuICAgIC8vXG4gICAgdGhpcy5CYXNlR2FtZSA9IHJlcXVpcmUoXCIuL2NvcmUvZ2FtZS9iYXNlX2dhbWVcIik7XG4gICAgLy90aGlzLkNsaWVudEdhbWUgPSByZXF1aXJlKFwiLi9jb3JlL2dhbWUvY2xpZW50X2dhbWVcIik7XG4gICAgdGhpcy5HYW1lID0gcmVxdWlyZShcIi4vY29yZS9nYW1lL2dhbWVcIik7XG4gICAgdGhpcy5Db25maWcgPSByZXF1aXJlKFwiLi9iYXNlL2NvbmZpZ1wiKTtcbiAgICB0aGlzLkxvZyA9IHJlcXVpcmUoXCIuL2Jhc2UvbG9nXCIpO1xuICAgIC8vXG4gICAgdGhpcy5HVUlDb21wb25lbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vY29yZS9ndWkvY29tcG9uZW50X21hbmFnZXJzL2d1aV9jb21wb25lbnRfbWFuYWdlclwiKTtcblxuICAgIHRoaXMuR1VJQ29tcG9uZW50ID0gcmVxdWlyZShcIi4vY29yZS9ndWkvY29tcG9uZW50cy9ndWlfY29tcG9uZW50XCIpO1xuICAgIC8vdGhpcy5HVUlDb250ZW50ID0gcmVxdWlyZShcIi4vY29yZS9ndWkvY29tcG9uZW50cy9ndWlfY29udGVudFwiKTtcbiAgICB0aGlzLkdVSVRyYW5zZm9ybSA9IHJlcXVpcmUoXCIuL2NvcmUvZ3VpL2NvbXBvbmVudHMvZ3VpX3RyYW5zZm9ybVwiKTtcbiAgICAvL1xuICAgIHRoaXMuR1VJID0gcmVxdWlyZShcIi4vY29yZS9ndWkvZ3VpXCIpO1xuICAgIHRoaXMuR1VJT2JqZWN0ID0gcmVxdWlyZShcIi4vY29yZS9ndWkvZ3VpX29iamVjdFwiKTtcbiAgICAvL3RoaXMuR1VJU3R5bGUgPSByZXF1aXJlKFwiLi9jb3JlL2d1aS9ndWlfc3R5bGVcIik7XG4gICAgLy90aGlzLkdVSVN0eWxlU3RhdGUgPSByZXF1aXJlKFwiLi9jb3JlL2d1aS9ndWlfc3R5bGVfc3RhdGVcIik7XG4gICAgLy9cbiAgICB0aGlzLkhhbmRsZXIgPSByZXF1aXJlKFwiLi9jb3JlL2lucHV0L2hhbmRsZXJcIik7XG4gICAgdGhpcy5JbnB1dCA9IHJlcXVpcmUoXCIuL2NvcmUvaW5wdXQvaW5wdXRcIik7XG4gICAgLy9cbiAgICB0aGlzLkNhbnZhcyA9IHJlcXVpcmUoXCIuL2NvcmUvcmVuZGVyZXIvY2FudmFzXCIpO1xuICAgIHRoaXMuUmVuZGVyVGFyZ2V0ID0gcmVxdWlyZShcIi4vY29yZS9yZW5kZXJlci9yZW5kZXJfdGFyZ2V0XCIpO1xuICAgIHRoaXMuUmVuZGVyZXIgPSByZXF1aXJlKFwiLi9jb3JlL3JlbmRlcmVyL3JlbmRlcmVyXCIpO1xuICAgIHRoaXMuU2hhZGVyQ2h1bmtzID0gcmVxdWlyZShcIi4vY29yZS9yZW5kZXJlci9zaGFkZXJfY2h1bmtzXCIpO1xuXG4gICAgdGhpcy5Xb3JsZCA9IHJlcXVpcmUoXCIuL2NvcmUvd29ybGQvd29ybGRcIik7XG4gICAgdGhpcy5Xb3JsZDJEID0gcmVxdWlyZShcIi4vY29yZS93b3JsZC93b3JsZF8yZFwiKTtcbiAgICAvL1xuICAgIHRoaXMuRW51bXMgPSByZXF1aXJlKFwiLi9jb3JlL2VudW1zXCIpO1xuICAgIHRoaXMuR2FtZU9iamVjdCA9IHJlcXVpcmUoXCIuL2NvcmUvZ2FtZV9vYmplY3RcIik7XG4gICAgdGhpcy5QcmVmYWIgPSByZXF1aXJlKFwiLi9jb3JlL3ByZWZhYlwiKTtcbiAgICB0aGlzLlNjZW5lID0gcmVxdWlyZShcIi4vY29yZS9zY2VuZVwiKTtcbiAgICAvL1xuICAgIHRoaXMuQUFCQjIgPSByZXF1aXJlKFwiLi9tYXRoL2FhYmIyXCIpO1xuICAgIHRoaXMuQUFCQjMgPSByZXF1aXJlKFwiLi9tYXRoL2FhYmIzXCIpO1xuICAgIHRoaXMuQ29sb3IgPSByZXF1aXJlKFwiLi9tYXRoL2NvbG9yXCIpO1xuICAgIHRoaXMuTWF0MiA9IHJlcXVpcmUoXCIuL21hdGgvbWF0MlwiKTtcbiAgICB0aGlzLk1hdDMgPSByZXF1aXJlKFwiLi9tYXRoL21hdDNcIik7XG4gICAgdGhpcy5NYXQzMiA9IHJlcXVpcmUoXCIuL21hdGgvbWF0MzJcIik7XG4gICAgdGhpcy5NYXQ0ID0gcmVxdWlyZShcIi4vbWF0aC9tYXQ0XCIpO1xuICAgIHRoaXMuTWF0aGYgPSByZXF1aXJlKFwiLi9tYXRoL21hdGhmXCIpO1xuICAgIHRoaXMuUXVhdCA9IHJlcXVpcmUoXCIuL21hdGgvcXVhdFwiKTtcbiAgICB0aGlzLlJlY3QgPSByZXF1aXJlKFwiLi9tYXRoL3JlY3RcIik7XG4gICAgdGhpcy5SZWN0T2Zmc2V0ID0gcmVxdWlyZShcIi4vbWF0aC9yZWN0X29mZnNldFwiKTtcbiAgICB0aGlzLlZlYzIgPSByZXF1aXJlKFwiLi9tYXRoL3ZlYzJcIik7XG4gICAgdGhpcy5WZWMzID0gcmVxdWlyZShcIi4vbWF0aC92ZWMzXCIpO1xuICAgIHRoaXMuVmVjNCA9IHJlcXVpcmUoXCIuL21hdGgvdmVjNFwiKTtcbn1cblxuXG5kZWZpbmVQcm9wZXJ0eShYaWFuLnByb3RvdHlwZSwgXCJpc1NlcnZlclwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBJU19TRVJWRVI7XG4gICAgfVxufSk7XG5cblxuZGVmaW5lUHJvcGVydHkoWGlhbi5wcm90b3R5cGUsIFwiaXNDbGllbnRcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gSVNfQ0xJRU5UO1xuICAgIH1cbn0pO1xuXG5cbi8qKlxuICogYXR0YWNoZXMgWGlhbiB0byB3aW5kb3cvZ2xvYmFsIGFuZCBhbGwgc3ViY2xhc3Nlc1xuICovXG5YaWFuLnByb3RvdHlwZS5nbG9iYWxpemUgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gdGhpcykgd2luZG93W2tleV0gPSB0aGlzW2tleV07XG4gICAgd2luZG93LlhpYW4gPSB0aGlzO1xufTtcblxuLyoqXG4gKiBiZW5jaG1hcmtzIGZ1bmN0aW9uIGNvbnNvbGUubG9ncyBudW1iZXIgb2Ygb3BlcmF0aW9ucyAvIHNlY29uZFxuICogQHBhcmFtIFN0cmluZyBuYW1lXG4gKiBAcGFyYW0gRnVuY3Rpb24gZm5cbiAqL1xuWGlhbi5wcm90b3R5cGUuYmVuY2htYXJrID0gZnVuY3Rpb24gKG5hbWUsIGZuLCB0aW1lcykge1xuICAgIHRpbWVzIHx8ICh0aW1lcyA9IDEwMDApO1xuICAgIHZhciBzdGFydCA9IDAuMCxcbiAgICAgICAgdGltZSA9IDAuMCxcbiAgICAgICAgaSA9IHRpbWVzO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBzdGFydCA9IG5vdygpO1xuICAgICAgICBmbigpO1xuICAgICAgICB0aW1lICs9IG5vdygpIC0gc3RhcnQ7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2cobmFtZSArIFwiOlxcblxcdFwiICsgdGltZXMgLyB0aW1lICsgXCIgKG9wcy9zZWMpXFxuXFx0XCIgKyB0aW1lIC8gdGltZXMgKyBcIihhdmcvY2FsbClcIik7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IFhpYW4oKTtcbiJdfQ==
